"use strict";(()=>{var t,K,D,a,G,N,W,x={126409:(t,K,D)=>{D.d(K,{A:()=>a});const a={container:"container--00764",canvas:"canvas--0ee18"}},426782:(t,K,D)=>{D.d(K,{A:()=>a});const a={container:"container--727e8",maxSizeFull:"maxSizeFull--3c948",useMediaContainer:"useMediaContainer--c1a8b"}},114712:t=>{function K(t,K,a){a=a||2;var N,W,x,b,i,z,Z,w=K&&K.length,m=w?K[0]*a:t.length,u=D(t,0,m,a,!0),d=[];if(!u||u.next===u.prev)return d;if(w&&(u=function(t,K,a,G){var N,W,x,b=[];for(N=0,W=K.length;N<W;N++)(x=D(t,K[N]*G,N<W-1?K[N+1]*G:t.length,G,!1))===x.next&&(x.steiner=!0),b.push(I(x));for(b.sort(n),N=0;N<b.length;N++)a=e(b[N],a);return a}(t,K,u,a)),t.length>80*a){N=x=t[0],W=b=t[1];for(var E=a;E<m;E+=a)(i=t[E])<N&&(N=i),(z=t[E+1])<W&&(W=z),i>x&&(x=i),z>b&&(b=z);Z=0!==(Z=Math.max(x-N,b-W))?32767/Z:0}return G(u,d,a,N,W,Z,0),d}function D(t,K,D,a,G){var N,W;if(G===h(t,K,D,a)>0)for(N=K;N<D;N+=a)W=y(N,t[N],t[N+1],W);else for(N=D-a;N>=K;N-=a)W=y(N,t[N],t[N+1],W);return W&&u(W,W.next)&&(q(W),W=W.next),W}function a(t,K){if(!t)return t;K||(K=t);var D,a=t;do{if(D=!1,a.steiner||!u(a,a.next)&&0!==m(a.prev,a,a.next))a=a.next;else{if(q(a),(a=K=a.prev)===a.next)break;D=!0}}while(D||a!==K);return K}function G(t,K,D,n,e,i,I){if(t){!I&&i&&function(t,K,D,a){var G=t;do{0===G.z&&(G.z=z(G.x,G.y,K,D,a)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next}while(G!==t);G.prevZ.nextZ=null,G.prevZ=null,function(t){var K,D,a,G,N,W,x,b,n=1;do{for(D=t,t=null,N=null,W=0;D;){for(W++,a=D,x=0,K=0;K<n&&(x++,a=a.nextZ);K++);for(b=n;x>0||b>0&&a;)0!==x&&(0===b||!a||D.z<=a.z)?(G=D,D=D.nextZ,x--):(G=a,a=a.nextZ,b--),N?N.nextZ=G:t=G,G.prevZ=N,N=G;D=a}N.nextZ=null,n*=2}while(W>1)}(G)}(t,n,e,i);for(var Z,w,m=t;t.prev!==t.next;)if(Z=t.prev,w=t.next,i?W(t,n,e,i):N(t))K.push(Z.i/D|0),K.push(t.i/D|0),K.push(w.i/D|0),q(t),t=w.next,m=w.next;else if((t=w)===m){I?1===I?G(t=x(a(t),K,D),K,D,n,e,i,2):2===I&&b(t,K,D,n,e,i):G(a(t),K,D,n,e,i,1);break}}}function N(t){var K=t.prev,D=t,a=t.next;if(m(K,D,a)>=0)return!1;for(var G=K.x,N=D.x,W=a.x,x=K.y,b=D.y,n=a.y,e=G<N?G<W?G:W:N<W?N:W,i=x<b?x<n?x:n:b<n?b:n,z=G>N?G>W?G:W:N>W?N:W,I=x>b?x>n?x:n:b>n?b:n,w=a.next;w!==K;){if(w.x>=e&&w.x<=z&&w.y>=i&&w.y<=I&&Z(G,x,N,b,W,n,w.x,w.y)&&m(w.prev,w,w.next)>=0)return!1;w=w.next}return!0}function W(t,K,D,a){var G=t.prev,N=t,W=t.next;if(m(G,N,W)>=0)return!1;for(var x=G.x,b=N.x,n=W.x,e=G.y,i=N.y,I=W.y,w=x<b?x<n?x:n:b<n?b:n,u=e<i?e<I?e:I:i<I?i:I,d=x>b?x>n?x:n:b>n?b:n,E=e>i?e>I?e:I:i>I?i:I,l=z(w,u,K,D,a),Q=z(d,E,K,D,a),P=t.prevZ,y=t.nextZ;P&&P.z>=l&&y&&y.z<=Q;){if(P.x>=w&&P.x<=d&&P.y>=u&&P.y<=E&&P!==G&&P!==W&&Z(x,e,b,i,n,I,P.x,P.y)&&m(P.prev,P,P.next)>=0)return!1;if(P=P.prevZ,y.x>=w&&y.x<=d&&y.y>=u&&y.y<=E&&y!==G&&y!==W&&Z(x,e,b,i,n,I,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;P&&P.z>=l;){if(P.x>=w&&P.x<=d&&P.y>=u&&P.y<=E&&P!==G&&P!==W&&Z(x,e,b,i,n,I,P.x,P.y)&&m(P.prev,P,P.next)>=0)return!1;P=P.prevZ}for(;y&&y.z<=Q;){if(y.x>=w&&y.x<=d&&y.y>=u&&y.y<=E&&y!==G&&y!==W&&Z(x,e,b,i,n,I,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function x(t,K,D){var G=t;do{var N=G.prev,W=G.next.next;!u(N,W)&&d(N,G,G.next,W)&&Q(N,W)&&Q(W,N)&&(K.push(N.i/D|0),K.push(G.i/D|0),K.push(W.i/D|0),q(G),q(G.next),G=t=W),G=G.next}while(G!==t);return a(G)}function b(t,K,D,N,W,x){var b=t;do{for(var n=b.next.next;n!==b.prev;){if(b.i!==n.i&&w(b,n)){var e=P(b,n);return b=a(b,b.next),e=a(e,e.next),G(b,K,D,N,W,x,0),void G(e,K,D,N,W,x,0)}n=n.next}b=b.next}while(b!==t)}function n(t,K){return t.x-K.x}function e(t,K){var D=function(t,K){var D,a=K,G=t.x,N=t.y,W=-1/0;do{if(N<=a.y&&N>=a.next.y&&a.next.y!==a.y){var x=a.x+(N-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(x<=G&&x>W&&(W=x,D=a.x<a.next.x?a:a.next,x===G))return D}a=a.next}while(a!==K);if(!D)return null;var b,n=D,e=D.x,z=D.y,I=1/0;a=D;do{G>=a.x&&a.x>=e&&G!==a.x&&Z(N<z?G:W,N,e,z,N<z?W:G,N,a.x,a.y)&&(b=Math.abs(N-a.y)/(G-a.x),Q(a,t)&&(b<I||b===I&&(a.x>D.x||a.x===D.x&&i(D,a)))&&(D=a,I=b)),a=a.next}while(a!==n);return D}(t,K);if(!D)return K;var G=P(D,t);return a(G,G.next),a(D,D.next)}function i(t,K){return m(t.prev,t,K.prev)<0&&m(K.next,t,t.next)<0}function z(t,K,D,a,G){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-D)*G|0)|t<<8))|t<<4))|t<<2))|t<<1))|(K=1431655765&((K=858993459&((K=252645135&((K=16711935&((K=(K-a)*G|0)|K<<8))|K<<4))|K<<2))|K<<1))<<1}function I(t){var K=t,D=t;do{(K.x<D.x||K.x===D.x&&K.y<D.y)&&(D=K),K=K.next}while(K!==t);return D}function Z(t,K,D,a,G,N,W,x){return(G-W)*(K-x)>=(t-W)*(N-x)&&(t-W)*(a-x)>=(D-W)*(K-x)&&(D-W)*(N-x)>=(G-W)*(a-x)}function w(t,K){return t.next.i!==K.i&&t.prev.i!==K.i&&!function(t,K){var D=t;do{if(D.i!==t.i&&D.next.i!==t.i&&D.i!==K.i&&D.next.i!==K.i&&d(D,D.next,t,K))return!0;D=D.next}while(D!==t);return!1}(t,K)&&(Q(t,K)&&Q(K,t)&&function(t,K){var D=t,a=!1,G=(t.x+K.x)/2,N=(t.y+K.y)/2;do{D.y>N!=D.next.y>N&&D.next.y!==D.y&&G<(D.next.x-D.x)*(N-D.y)/(D.next.y-D.y)+D.x&&(a=!a),D=D.next}while(D!==t);return a}(t,K)&&(m(t.prev,t,K.prev)||m(t,K.prev,K))||u(t,K)&&m(t.prev,t,t.next)>0&&m(K.prev,K,K.next)>0)}function m(t,K,D){return(K.y-t.y)*(D.x-K.x)-(K.x-t.x)*(D.y-K.y)}function u(t,K){return t.x===K.x&&t.y===K.y}function d(t,K,D,a){var G=l(m(t,K,D)),N=l(m(t,K,a)),W=l(m(D,a,t)),x=l(m(D,a,K));return G!==N&&W!==x||!(0!==G||!E(t,D,K))||!(0!==N||!E(t,a,K))||!(0!==W||!E(D,t,a))||!(0!==x||!E(D,K,a))}function E(t,K,D){return K.x<=Math.max(t.x,D.x)&&K.x>=Math.min(t.x,D.x)&&K.y<=Math.max(t.y,D.y)&&K.y>=Math.min(t.y,D.y)}function l(t){return t>0?1:t<0?-1:0}function Q(t,K){return m(t.prev,t,t.next)<0?m(t,K,t.next)>=0&&m(t,t.prev,K)>=0:m(t,K,t.prev)<0||m(t,t.next,K)<0}function P(t,K){var D=new X(t.i,t.x,t.y),a=new X(K.i,K.x,K.y),G=t.next,N=K.prev;return t.next=K,K.prev=t,D.next=G,G.prev=D,a.next=D,D.prev=a,N.next=a,a.prev=N,a}function y(t,K,D,a){var G=new X(t,K,D);return a?(G.next=a.next,G.prev=a,a.next.prev=G,a.next=G):(G.prev=G,G.next=G),G}function q(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function X(t,K,D){this.i=t,this.x=K,this.y=D,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function h(t,K,D,a){for(var G=0,N=K,W=D-a;N<D;N+=a)G+=(t[W]-t[N])*(t[N+1]+t[W+1]),W=N;return G}t.exports=K,t.exports["default"]=K,K.deviation=function(t,K,D,a){var G=K&&K.length,N=G?K[0]*D:t.length,W=Math.abs(h(t,0,N,D));if(G)for(var x=0,b=K.length;x<b;x++){var n=K[x]*D,e=x<b-1?K[x+1]*D:t.length;W-=Math.abs(h(t,n,e,D))}var i=0;for(x=0;x<a.length;x+=3){var z=a[x]*D,I=a[x+1]*D,Z=a[x+2]*D;i+=Math.abs((t[z]-t[Z])*(t[I+1]-t[z+1])-(t[z]-t[I])*(t[Z+1]-t[z+1]))}return 0===W&&0===i?0:Math.abs((i-W)/W)},K.flatten=function(t){for(var K=t[0][0].length,D={vertices:[],holes:[],dimensions:K},a=0,G=0;G<t.length;G++){for(var N=0;N<t[G].length;N++)for(var W=0;W<K;W++)D.vertices.push(t[G][N][W]);G>0&&(a+=t[G-1].length,D.holes.push(a))}return D}},976438:t=>{var K=Object.prototype.hasOwnProperty,D="~";function a(){}function G(t,K,D){this.fn=t,this.context=K,this.once=D||!1}function N(t,K,a,N,W){if("function"!=typeof a)throw new TypeError("The listener must be a function");var x=new G(a,N||t,W),b=D?D+K:K;return t._events[b]?t._events[b].fn?t._events[b]=[t._events[b],x]:t._events[b].push(x):(t._events[b]=x,t._eventsCount++),t}function W(t,K){0==--t._eventsCount?t._events=new a:delete t._events[K]}function x(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(D=!1)),x.prototype.eventNames=function(){var t,a,G=[];if(0===this._eventsCount)return G;for(a in t=this._events)K.call(t,a)&&G.push(D?a.slice(1):a);return Object.getOwnPropertySymbols?G.concat(Object.getOwnPropertySymbols(t)):G},x.prototype.listeners=function(t){var K=D?D+t:t,a=this._events[K];if(!a)return[];if(a.fn)return[a.fn];for(var G=0,N=a.length,W=new Array(N);G<N;G++)W[G]=a[G].fn;return W},x.prototype.listenerCount=function(t){var K=D?D+t:t,a=this._events[K];return a?a.fn?1:a.length:0},x.prototype.emit=function(t,K,a,G,N,W){var x=D?D+t:t;if(!this._events[x])return!1;var b,n,e=this._events[x],i=arguments.length;if(e.fn){switch(e.once&&this.removeListener(t,e.fn,void 0,!0),i){case 1:return e.fn.call(e.context),!0;case 2:return e.fn.call(e.context,K),!0;case 3:return e.fn.call(e.context,K,a),!0;case 4:return e.fn.call(e.context,K,a,G),!0;case 5:return e.fn.call(e.context,K,a,G,N),!0;case 6:return e.fn.call(e.context,K,a,G,N,W),!0}for(n=1,b=new Array(i-1);n<i;n++)b[n-1]=arguments[n];e.fn.apply(e.context,b)}else{var z,I=e.length;for(n=0;n<I;n++)switch(e[n].once&&this.removeListener(t,e[n].fn,void 0,!0),i){case 1:e[n].fn.call(e[n].context);break;case 2:e[n].fn.call(e[n].context,K);break;case 3:e[n].fn.call(e[n].context,K,a);break;case 4:e[n].fn.call(e[n].context,K,a,G);break;default:if(!b)for(z=1,b=new Array(i-1);z<i;z++)b[z-1]=arguments[z];e[n].fn.apply(e[n].context,b)}}return!0},x.prototype.on=function(t,K,D){return N(this,t,K,D,!1)},x.prototype.once=function(t,K,D){return N(this,t,K,D,!0)},x.prototype.removeListener=function(t,K,a,G){var N=D?D+t:t;if(!this._events[N])return this;if(!K)return W(this,N),this;var x=this._events[N];if(x.fn)x.fn!==K||G&&!x.once||a&&x.context!==a||W(this,N);else{for(var b=0,n=[],e=x.length;b<e;b++)(x[b].fn!==K||G&&!x[b].once||a&&x[b].context!==a)&&n.push(x[b]);n.length?this._events[N]=1===n.length?n[0]:n:W(this,N)}return this},x.prototype.removeAllListeners=function(t){var K;return t?(K=D?D+t:t,this._events[K]&&W(this,K)):(this._events=new a,this._eventsCount=0),this},x.prototype.off=x.prototype.removeListener,x.prototype.addListener=x.prototype.on,x.prefixed=D,x.EventEmitter=x,1&&(t.exports=x)},379303:t=>{t.exports=function(t){var G=[];return t.replace(D,(function(t,D,N){var W=D.toLowerCase();for(N=function(t){var K=t.match(a);return K?K.map(Number):[]}(N),"m"==W&&N.length>2&&(G.push([D].concat(N.splice(0,2))),W="l",D="m"==D?"l":"L");1;){if(N.length==K[W])return N.unshift(D),G.push(N);if(N.length<K[W])throw new Error("malformed path data");G.push([D].concat(N.splice(0,K[W])))}})),G};var K={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},D=/([astvzqmhlc])([^astvzqmhlc]*)/gi,a=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},267913:(t,K,D)=>{var a=D(228651),G=D(926601),N=G(a("String.prototype.indexOf"));t.exports=function(t,K){var D=a(t,!!K);return"function"==typeof D&&N(t,".prototype.")>-1?G(D):D}},926601:(t,K,D)=>{var a=D(605049),G=D(228651),N=D(486255),W=D(96785),x=G("%Function.prototype.apply%"),b=G("%Function.prototype.call%"),n=G("%Reflect.apply%",!0)||a.call(b,x),e=D(956649),i=G("%Math.max%");t.exports=function(t){if("function"!=typeof t)throw new W("a function is required");var K=n(a,b,arguments);return N(K,1+i(0,t.length-(arguments.length-1)),!0)};var z=function(){return n(a,x,arguments)};e?e(t.exports,"apply",{value:z}):t.exports.apply=z},589295:(t,K,D)=>{var a=D(956649),G=D(657770),N=D(96785),W=D(668109);t.exports=function(t,K,D){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new N("`obj` must be an object or a function`");if("string"!=typeof K&&"symbol"!=typeof K)throw new N("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new N("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new N("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new N("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new N("`loose`, if provided, must be a boolean");var x=arguments.length>3?arguments[3]:null,b=arguments.length>4?arguments[4]:null,n=arguments.length>5?arguments[5]:null,e=arguments.length>6&&arguments[6],i=!!W&&W(t,K);if(a)a(t,K,{configurable:null===n&&i?i.configurable:!n,enumerable:null===x&&i?i.enumerable:!x,value:D,writable:null===b&&i?i.writable:!b});else{if(!e&&(x||b||n))throw new G("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");t[K]=D}}},65402:(t,K,D)=>{var a=D(301654);K.__esModule=!0,K["default"]=void 0;var G=function(){};a(D(450679)).default&&(G=document.addEventListener?function(t,K,D,a){return t.removeEventListener(K,D,a||!1)}:document.attachEvent?function(t,K,D){return t.detachEvent("on"+K,D)}:void 0);var N=G;K["default"]=N,t.exports=K["default"]},609622:(t,K,D)=>{var a=D(301654);K.__esModule=!0,K["default"]=void 0;var G=function(){};a(D(450679)).default&&(G=document.addEventListener?function(t,K,D,a){return t.addEventListener(K,D,a||!1)}:document.attachEvent?function(t,K,D){return t.attachEvent("on"+K,(function(K){(K=K||window.event).target=K.target||K.srcElement,K.currentTarget=t,D.call(t,K)}))}:void 0);var N=G;K["default"]=N,t.exports=K["default"]},427728:(t,K,D)=>{var a=D(301654);K.__esModule=!0,K["default"]=K.animationEnd=K.animationDelay=K.animationTiming=K.animationDuration=K.animationName=K.transitionEnd=K.transitionDuration=K.transitionDelay=K.transitionTiming=K.transitionProperty=K.transform=void 0;var G,N,W,x,b,n,e,i,z,I,Z,w=a(D(450679)),m="transform";if(K.transform=m,K.animationEnd=W,K.transitionEnd=N,K.transitionDelay=e,K.transitionTiming=n,K.transitionDuration=b,K.transitionProperty=x,K.animationDelay=Z,K.animationTiming=I,K.animationDuration=z,K.animationName=i,w.default){var u=function(){for(var t,K,D=document.createElement("div").style,a={O:function(t){return"o"+t.toLowerCase()},Moz:function(t){return t.toLowerCase()},Webkit:function(t){return"webkit"+t},ms:function(t){return"MS"+t}},G=Object.keys(a),N="",W=0;W<G.length;W++){var x=G[W];if(x+"TransitionProperty"in D){N="-"+x.toLowerCase(),t=a[x]("TransitionEnd"),K=a[x]("AnimationEnd");break}}return!t&&"transitionProperty"in D&&(t="transitionend"),!K&&"animationName"in D&&(K="animationend"),D=null,{animationEnd:K,transitionEnd:t,prefix:N}}();G=u.prefix,K.transitionEnd=N=u.transitionEnd,K.animationEnd=W=u.animationEnd,K.transform=m=G+"-"+m,K.transitionProperty=x=G+"-transition-property",K.transitionDuration=b=G+"-transition-duration",K.transitionDelay=e=G+"-transition-delay",K.transitionTiming=n=G+"-transition-timing-function",K.animationName=i=G+"-animation-name",K.animationDuration=z=G+"-animation-duration",K.animationTiming=I=G+"-animation-delay",K.animationDelay=Z=G+"-animation-timing-function"}var d={transform:m,end:N,property:x,timing:n,delay:e,duration:b};K["default"]=d},450679:(t,K)=>{K.__esModule=!0,K["default"]=void 0;var D=!("undefined"==typeof window||!window.document||!window.document.createElement);K["default"]=D,t.exports=K["default"]},827700:t=>{function K(t,K,a){a=a||2;var N,W,x,b,i,z,Z,w=K&&K.length,m=w?K[0]*a:t.length,u=D(t,0,m,a,!0),d=[];if(!u||u.next===u.prev)return d;if(w&&(u=function(t,K,a,G){var N,W,x,b=[];for(N=0,W=K.length;N<W;N++)(x=D(t,K[N]*G,N<W-1?K[N+1]*G:t.length,G,!1))===x.next&&(x.steiner=!0),b.push(I(x));for(b.sort(n),N=0;N<b.length;N++)a=e(b[N],a);return a}(t,K,u,a)),t.length>80*a){N=x=t[0],W=b=t[1];for(var E=a;E<m;E+=a)(i=t[E])<N&&(N=i),(z=t[E+1])<W&&(W=z),i>x&&(x=i),z>b&&(b=z);Z=0!==(Z=Math.max(x-N,b-W))?32767/Z:0}return G(u,d,a,N,W,Z,0),d}function D(t,K,D,a,G){var N,W;if(G===h(t,K,D,a)>0)for(N=K;N<D;N+=a)W=y(N,t[N],t[N+1],W);else for(N=D-a;N>=K;N-=a)W=y(N,t[N],t[N+1],W);return W&&u(W,W.next)&&(q(W),W=W.next),W}function a(t,K){if(!t)return t;K||(K=t);var D,a=t;do{if(D=!1,a.steiner||!u(a,a.next)&&0!==m(a.prev,a,a.next))a=a.next;else{if(q(a),(a=K=a.prev)===a.next)break;D=!0}}while(D||a!==K);return K}function G(t,K,D,n,e,i,I){if(t){!I&&i&&function(t,K,D,a){var G=t;do{0===G.z&&(G.z=z(G.x,G.y,K,D,a)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next}while(G!==t);G.prevZ.nextZ=null,G.prevZ=null,function(t){var K,D,a,G,N,W,x,b,n=1;do{for(D=t,t=null,N=null,W=0;D;){for(W++,a=D,x=0,K=0;K<n&&(x++,a=a.nextZ);K++);for(b=n;x>0||b>0&&a;)0!==x&&(0===b||!a||D.z<=a.z)?(G=D,D=D.nextZ,x--):(G=a,a=a.nextZ,b--),N?N.nextZ=G:t=G,G.prevZ=N,N=G;D=a}N.nextZ=null,n*=2}while(W>1)}(G)}(t,n,e,i);for(var Z,w,m=t;t.prev!==t.next;)if(Z=t.prev,w=t.next,i?W(t,n,e,i):N(t))K.push(Z.i/D|0),K.push(t.i/D|0),K.push(w.i/D|0),q(t),t=w.next,m=w.next;else if((t=w)===m){I?1===I?G(t=x(a(t),K,D),K,D,n,e,i,2):2===I&&b(t,K,D,n,e,i):G(a(t),K,D,n,e,i,1);break}}}function N(t){var K=t.prev,D=t,a=t.next;if(m(K,D,a)>=0)return!1;for(var G=K.x,N=D.x,W=a.x,x=K.y,b=D.y,n=a.y,e=G<N?G<W?G:W:N<W?N:W,i=x<b?x<n?x:n:b<n?b:n,z=G>N?G>W?G:W:N>W?N:W,I=x>b?x>n?x:n:b>n?b:n,w=a.next;w!==K;){if(w.x>=e&&w.x<=z&&w.y>=i&&w.y<=I&&Z(G,x,N,b,W,n,w.x,w.y)&&m(w.prev,w,w.next)>=0)return!1;w=w.next}return!0}function W(t,K,D,a){var G=t.prev,N=t,W=t.next;if(m(G,N,W)>=0)return!1;for(var x=G.x,b=N.x,n=W.x,e=G.y,i=N.y,I=W.y,w=x<b?x<n?x:n:b<n?b:n,u=e<i?e<I?e:I:i<I?i:I,d=x>b?x>n?x:n:b>n?b:n,E=e>i?e>I?e:I:i>I?i:I,l=z(w,u,K,D,a),Q=z(d,E,K,D,a),P=t.prevZ,y=t.nextZ;P&&P.z>=l&&y&&y.z<=Q;){if(P.x>=w&&P.x<=d&&P.y>=u&&P.y<=E&&P!==G&&P!==W&&Z(x,e,b,i,n,I,P.x,P.y)&&m(P.prev,P,P.next)>=0)return!1;if(P=P.prevZ,y.x>=w&&y.x<=d&&y.y>=u&&y.y<=E&&y!==G&&y!==W&&Z(x,e,b,i,n,I,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;P&&P.z>=l;){if(P.x>=w&&P.x<=d&&P.y>=u&&P.y<=E&&P!==G&&P!==W&&Z(x,e,b,i,n,I,P.x,P.y)&&m(P.prev,P,P.next)>=0)return!1;P=P.prevZ}for(;y&&y.z<=Q;){if(y.x>=w&&y.x<=d&&y.y>=u&&y.y<=E&&y!==G&&y!==W&&Z(x,e,b,i,n,I,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function x(t,K,D){var G=t;do{var N=G.prev,W=G.next.next;!u(N,W)&&d(N,G,G.next,W)&&Q(N,W)&&Q(W,N)&&(K.push(N.i/D|0),K.push(G.i/D|0),K.push(W.i/D|0),q(G),q(G.next),G=t=W),G=G.next}while(G!==t);return a(G)}function b(t,K,D,N,W,x){var b=t;do{for(var n=b.next.next;n!==b.prev;){if(b.i!==n.i&&w(b,n)){var e=P(b,n);return b=a(b,b.next),e=a(e,e.next),G(b,K,D,N,W,x,0),void G(e,K,D,N,W,x,0)}n=n.next}b=b.next}while(b!==t)}function n(t,K){return t.x-K.x}function e(t,K){var D=function(t,K){var D,a=K,G=t.x,N=t.y,W=-1/0;do{if(N<=a.y&&N>=a.next.y&&a.next.y!==a.y){var x=a.x+(N-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(x<=G&&x>W&&(W=x,D=a.x<a.next.x?a:a.next,x===G))return D}a=a.next}while(a!==K);if(!D)return null;var b,n=D,e=D.x,z=D.y,I=1/0;a=D;do{G>=a.x&&a.x>=e&&G!==a.x&&Z(N<z?G:W,N,e,z,N<z?W:G,N,a.x,a.y)&&(b=Math.abs(N-a.y)/(G-a.x),Q(a,t)&&(b<I||b===I&&(a.x>D.x||a.x===D.x&&i(D,a)))&&(D=a,I=b)),a=a.next}while(a!==n);return D}(t,K);if(!D)return K;var G=P(D,t);return a(G,G.next),a(D,D.next)}function i(t,K){return m(t.prev,t,K.prev)<0&&m(K.next,t,t.next)<0}function z(t,K,D,a,G){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-D)*G|0)|t<<8))|t<<4))|t<<2))|t<<1))|(K=1431655765&((K=858993459&((K=252645135&((K=16711935&((K=(K-a)*G|0)|K<<8))|K<<4))|K<<2))|K<<1))<<1}function I(t){var K=t,D=t;do{(K.x<D.x||K.x===D.x&&K.y<D.y)&&(D=K),K=K.next}while(K!==t);return D}function Z(t,K,D,a,G,N,W,x){return(G-W)*(K-x)>=(t-W)*(N-x)&&(t-W)*(a-x)>=(D-W)*(K-x)&&(D-W)*(N-x)>=(G-W)*(a-x)}function w(t,K){return t.next.i!==K.i&&t.prev.i!==K.i&&!function(t,K){var D=t;do{if(D.i!==t.i&&D.next.i!==t.i&&D.i!==K.i&&D.next.i!==K.i&&d(D,D.next,t,K))return!0;D=D.next}while(D!==t);return!1}(t,K)&&(Q(t,K)&&Q(K,t)&&function(t,K){var D=t,a=!1,G=(t.x+K.x)/2,N=(t.y+K.y)/2;do{D.y>N!=D.next.y>N&&D.next.y!==D.y&&G<(D.next.x-D.x)*(N-D.y)/(D.next.y-D.y)+D.x&&(a=!a),D=D.next}while(D!==t);return a}(t,K)&&(m(t.prev,t,K.prev)||m(t,K.prev,K))||u(t,K)&&m(t.prev,t,t.next)>0&&m(K.prev,K,K.next)>0)}function m(t,K,D){return(K.y-t.y)*(D.x-K.x)-(K.x-t.x)*(D.y-K.y)}function u(t,K){return t.x===K.x&&t.y===K.y}function d(t,K,D,a){var G=l(m(t,K,D)),N=l(m(t,K,a)),W=l(m(D,a,t)),x=l(m(D,a,K));return G!==N&&W!==x||!(0!==G||!E(t,D,K))||!(0!==N||!E(t,a,K))||!(0!==W||!E(D,t,a))||!(0!==x||!E(D,K,a))}function E(t,K,D){return K.x<=Math.max(t.x,D.x)&&K.x>=Math.min(t.x,D.x)&&K.y<=Math.max(t.y,D.y)&&K.y>=Math.min(t.y,D.y)}function l(t){return t>0?1:t<0?-1:0}function Q(t,K){return m(t.prev,t,t.next)<0?m(t,K,t.next)>=0&&m(t,t.prev,K)>=0:m(t,K,t.prev)<0||m(t,t.next,K)<0}function P(t,K){var D=new X(t.i,t.x,t.y),a=new X(K.i,K.x,K.y),G=t.next,N=K.prev;return t.next=K,K.prev=t,D.next=G,G.prev=D,a.next=D,D.prev=a,N.next=a,a.prev=N,a}function y(t,K,D,a){var G=new X(t,K,D);return a?(G.next=a.next,G.prev=a,a.next.prev=G,a.next=G):(G.prev=G,G.next=G),G}function q(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function X(t,K,D){this.i=t,this.x=K,this.y=D,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function h(t,K,D,a){for(var G=0,N=K,W=D-a;N<D;N+=a)G+=(t[W]-t[N])*(t[N+1]+t[W+1]),W=N;return G}t.exports=K,t.exports["default"]=K,K.deviation=function(t,K,D,a){var G=K&&K.length,N=G?K[0]*D:t.length,W=Math.abs(h(t,0,N,D));if(G)for(var x=0,b=K.length;x<b;x++){var n=K[x]*D,e=x<b-1?K[x+1]*D:t.length;W-=Math.abs(h(t,n,e,D))}var i=0;for(x=0;x<a.length;x+=3){var z=a[x]*D,I=a[x+1]*D,Z=a[x+2]*D;i+=Math.abs((t[z]-t[Z])*(t[I+1]-t[z+1])-(t[z]-t[I])*(t[Z+1]-t[z+1]))}return 0===W&&0===i?0:Math.abs((i-W)/W)},K.flatten=function(t){for(var K=t[0][0].length,D={vertices:[],holes:[],dimensions:K},a=0,G=0;G<t.length;G++){for(var N=0;N<t[G].length;N++)for(var W=0;W<K;W++)D.vertices.push(t[G][N][W]);G>0&&(a+=t[G-1].length,D.holes.push(a))}return D}},956649:(t,K,D)=>{var a=D(228651)("%Object.defineProperty%",!0)||!1;if(a)try{a({},"a",{value:1})}catch(t){a=!1}t.exports=a},729055:t=>{t.exports=EvalError},515293:t=>{t.exports=Error},218888:t=>{t.exports=RangeError},447900:t=>{t.exports=ReferenceError},657770:t=>{t.exports=SyntaxError},96785:t=>{t.exports=TypeError},254055:t=>{t.exports=URIError},812719:t=>{var K="Function.prototype.bind called on incompatible ",D=Object.prototype.toString,a=Math.max,G="[object Function]",N=function(t,K){for(var D=[],a=0;a<t.length;a+=1)D[a]=t[a];for(var G=0;G<K.length;G+=1)D[G+t.length]=K[G];return D};t.exports=function(t){var W=this;if("function"!=typeof W||D.apply(W)!==G)throw new TypeError(K+W);for(var x,b=function(t){for(var K=[],D=1||0,a=0;D<t.length;D+=1,a+=1)K[a]=t[D];return K}(arguments),n=a(0,W.length-b.length),e=[],i=0;i<n;i++)e[i]="$"+i;if(x=Function("binder","return function ("+function(t,K){for(var D="",a=0;a<t.length;a+=1)D+=t[a],a+1<t.length&&(D+=K);return D}(e,",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof x){var K=W.apply(this,N(b,arguments));return Object(K)===K?K:this}return W.apply(t,N(b,arguments))})),W.prototype){var z=function(){};z.prototype=W.prototype,x.prototype=new z,z.prototype=null}return x}},605049:(t,K,D)=>{var a=D(812719);t.exports=Function.prototype.bind||a},228651:(t,K,D)=>{var a,G=D(515293),N=D(729055),W=D(218888),x=D(447900),b=D(657770),n=D(96785),e=D(254055),i=Function,z=function(t){try{return i('"use strict"; return ('+t+").constructor;")()}catch(t){}},I=Object.getOwnPropertyDescriptor;if(I)try{I({},"")}catch(t){I=null}var Z=function(){throw new n},w=I?function(){try{return Z}catch(t){try{return I(arguments,"callee").get}catch(t){return Z}}}():Z,m=D(173257)(),u=D(885726)(),d=Object.getPrototypeOf||(u?function(t){return t.__proto__}:null),E={},l="undefined"!=typeof Uint8Array&&d?d(Uint8Array):a,Q={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?a:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?a:ArrayBuffer,"%ArrayIteratorPrototype%":m&&d?d([][Symbol.iterator]()):a,"%AsyncFromSyncIteratorPrototype%":a,"%AsyncFunction%":E,"%AsyncGenerator%":E,"%AsyncGeneratorFunction%":E,"%AsyncIteratorPrototype%":E,"%Atomics%":"undefined"==typeof Atomics?a:Atomics,"%BigInt%":"undefined"==typeof BigInt?a:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?a:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?a:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?a:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":G,"%eval%":eval,"%EvalError%":N,"%Float32Array%":"undefined"==typeof Float32Array?a:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?a:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?a:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":E,"%Int8Array%":"undefined"==typeof Int8Array?a:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?a:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?a:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":m&&d?d(d([][Symbol.iterator]())):a,"%JSON%":"object"==typeof JSON?JSON:a,"%Map%":"undefined"==typeof Map?a:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&m&&d?d((new Map)[Symbol.iterator]()):a,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?a:Promise,"%Proxy%":"undefined"==typeof Proxy?a:Proxy,"%RangeError%":W,"%ReferenceError%":x,"%Reflect%":"undefined"==typeof Reflect?a:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?a:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&m&&d?d((new Set)[Symbol.iterator]()):a,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?a:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":m&&d?d(""[Symbol.iterator]()):a,"%Symbol%":m?Symbol:a,"%SyntaxError%":b,"%ThrowTypeError%":w,"%TypedArray%":l,"%TypeError%":n,"%Uint8Array%":"undefined"==typeof Uint8Array?a:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?a:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?a:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?a:Uint32Array,"%URIError%":e,"%WeakMap%":"undefined"==typeof WeakMap?a:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?a:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?a:WeakSet};if(d)try{null.error}catch(t){var P=d(d(t));Q["%Error.prototype%"]=P}var y=function t(K){var D;if("%AsyncFunction%"===K)D=z("async function () {}");else if("%GeneratorFunction%"===K)D=z("function* () {}");else if("%AsyncGeneratorFunction%"===K)D=z("async function* () {}");else if("%AsyncGenerator%"===K){var a=t("%AsyncGeneratorFunction%");a&&(D=a.prototype)}else if("%AsyncIteratorPrototype%"===K){var G=t("%AsyncGenerator%");G&&d&&(D=d(G.prototype))}return Q[K]=D,D},q={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},X=D(605049),h=D(255215),J=X.call(Function.call,Array.prototype.concat),T=X.call(Function.apply,Array.prototype.splice),_=X.call(Function.call,String.prototype.replace),C=X.call(Function.call,String.prototype.slice),H=X.call(Function.call,RegExp.prototype.exec),o=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,U=/\\(\\)?/g,V=function(t,K){var D,a=t;if(h(q,a)&&(a="%"+(D=q[a])[0]+"%"),h(Q,a)){var G=Q[a];if(G===E&&(G=y(a)),void 0===G&&!K)throw new n("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:D,name:a,value:G}}throw new b("intrinsic "+t+" does not exist!")};t.exports=function(t,K){if("string"!=typeof t||0===t.length)throw new n("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof K)throw new n('"allowMissing" argument must be a boolean');if(null===H(/^%?[^%]*%?$/,t))throw new b("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var D=function(t){var K=C(t,0,1),D=C(t,-1);if("%"===K&&"%"!==D)throw new b("invalid intrinsic syntax, expected closing `%`");if("%"===D&&"%"!==K)throw new b("invalid intrinsic syntax, expected opening `%`");var a=[];return _(t,o,(function(t,K,D,G){a[a.length]=D?_(G,U,"$1"):K||t})),a}(t),a=D.length>0?D[0]:"",G=V("%"+a+"%",K),N=G.name,W=G.value,x=!1,e=G.alias;e&&(a=e[0],T(D,J([0,1],e)));for(var i=1,z=!0;i<D.length;i+=1){var Z=D[i],w=C(Z,0,1),m=C(Z,-1);if(('"'===w||"'"===w||"`"===w||'"'===m||"'"===m||"`"===m)&&w!==m)throw new b("property names with quotes must have matching quotes");if("constructor"!==Z&&z||(x=!0),h(Q,N="%"+(a+="."+Z)+"%"))W=Q[N];else if(null!=W){if(!(Z in W)){if(!K)throw new n("base intrinsic for "+t+" exists, but the property is not available.");return}if(I&&i+1>=D.length){var u=I(W,Z);W=(z=!!u)&&"get"in u&&!("originalValue"in u.get)?u.get:W[Z]}else z=h(W,Z),W=W[Z];z&&!x&&(Q[N]=W)}}return W}},668109:(t,K,D)=>{var a=D(228651)("%Object.getOwnPropertyDescriptor%",!0);if(a)try{a([],"length")}catch(t){a=null}t.exports=a},118890:(t,K,D)=>{var a=D(956649),G=function(){return!!a};G.hasArrayLengthDefineBug=function(){if(!a)return null;try{return 1!==a([],"length",{value:1}).length}catch(t){return!0}},t.exports=G},885726:t=>{var K={__proto__:null,foo:{}},D=Object;t.exports=function(){return{__proto__:K}.foo===K.foo&&!(K instanceof D)}},173257:(t,K,D)=>{var a="undefined"!=typeof Symbol&&Symbol,G=D(112843);t.exports=function(){return"function"==typeof a&&"function"==typeof Symbol&&"symbol"==typeof a("foo")&&"symbol"==typeof Symbol("bar")&&G()}},112843:t=>{t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},K=Symbol("test"),D=Object(K);if("string"==typeof K)return!1;if("[object Symbol]"!==Object.prototype.toString.call(K))return!1;if("[object Symbol]"!==Object.prototype.toString.call(D))return!1;var a=42;for(K in t[K]=a,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var G=Object.getOwnPropertySymbols(t);if(1!==G.length||G[0]!==K)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,K))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var N=Object.getOwnPropertyDescriptor(t,K);if(N.value!==a||!0!==N.enumerable)return!1}return!0}},255215:(t,K,D)=>{var a=Function.prototype.call,G=Object.prototype.hasOwnProperty,N=D(605049);t.exports=N.call(a,G)},115937:(t,K,D)=>{var a="function"==typeof Map&&Map.prototype,G=Object.getOwnPropertyDescriptor&&a?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,N=a&&G&&"function"==typeof G.get?G.get:null,W=a&&Map.prototype.forEach,x="function"==typeof Set&&Set.prototype,b=Object.getOwnPropertyDescriptor&&x?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,n=x&&b&&"function"==typeof b.get?b.get:null,e=x&&Set.prototype.forEach,i="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,z="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,I="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,Z=Boolean.prototype.valueOf,w=Object.prototype.toString,m=Function.prototype.toString,u=String.prototype.match,d=String.prototype.slice,E=String.prototype.replace,l=String.prototype.toUpperCase,Q=String.prototype.toLowerCase,P=RegExp.prototype.test,y=Array.prototype.concat,q=Array.prototype.join,X=Array.prototype.slice,h=Math.floor,J="function"==typeof BigInt?BigInt.prototype.valueOf:null,T=Object.getOwnPropertySymbols,_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,C="function"==typeof Symbol&&"object"==typeof Symbol.iterator,H="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===C||"symbol")?Symbol.toStringTag:null,o=Object.prototype.propertyIsEnumerable,U=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function V(t,K){if(t===1/0||t===-1/0||t!=t||t&&t>-1e3&&t<1e3||P.call(/e/,K))return K;var D=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof t){var a=t<0?-h(-t):h(t);if(a!==t){var G=String(a),N=d.call(K,G.length+1);return E.call(G,D,"$&_")+"."+E.call(E.call(N,/([0-9]{3})/g,"$&_"),/_$/,"")}}return E.call(K,D,"$&_")}var s=D(242634),F=s.custom,c=L(F)?F:null;function g(t,K,D){var a="double"===(D.quoteStyle||K)?'"':"'";return a+t+a}function R(t){return E.call(String(t),/"/g,"&quot;")}function A(t){return!("[object Array]"!==$(t)||H&&"object"==typeof t&&H in t)}function Y(t){return!("[object RegExp]"!==$(t)||H&&"object"==typeof t&&H in t)}function L(t){if(C)return t&&"object"==typeof t&&t instanceof Symbol;if("symbol"==typeof t)return!0;if(!t||"object"!=typeof t||!_)return!1;try{return _.call(t),!0}catch(t){}return!1}t.exports=function t(K,D,a,G){var x=D||{};if(f(x,"quoteStyle")&&"single"!==x.quoteStyle&&"double"!==x.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(f(x,"maxStringLength")&&("number"==typeof x.maxStringLength?x.maxStringLength<0&&x.maxStringLength!==1/0:null!==x.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var b=!f(x,"customInspect")||x.customInspect;if("boolean"!=typeof b&&"symbol"!==b)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(f(x,"indent")&&null!==x.indent&&"\t"!==x.indent&&!(parseInt(x.indent,10)===x.indent&&x.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(f(x,"numericSeparator")&&"boolean"!=typeof x.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var w=x.numericSeparator;if(void 0===K)return"undefined";if(null===K)return"null";if("boolean"==typeof K)return K?"true":"false";if("string"==typeof K)return O(K,x);if("number"==typeof K){if(0===K)return 1/0/K>0?"0":"-0";var l=String(K);return w?V(K,l):l}if("bigint"==typeof K){var P=String(K)+"n";return w?V(K,P):P}var h=void 0===x.depth?5:x.depth;if(void 0===a&&(a=0),a>=h&&h>0&&"object"==typeof K)return A(K)?"[Array]":"[Object]";var T,F=function(t,K){var D;if("\t"===t.indent)D="\t";else{if(!("number"==typeof t.indent&&t.indent>0))return null;D=q.call(Array(t.indent+1)," ")}return{base:D,prev:q.call(Array(K+1),D)}}(x,a);if(void 0===G)G=[];else if(B(G,K)>=0)return"[Circular]";function S(K,D,N){if(D&&(G=X.call(G)).push(D),N){var W={depth:x.depth};return f(x,"quoteStyle")&&(W.quoteStyle=x.quoteStyle),t(K,W,a+1,G)}return t(K,x,a+1,G)}if("function"==typeof K&&!Y(K)){var v=function(t){if(t.name)return t.name;var K=u.call(m.call(t),/^function\s*([\w$]+)/);return K?K[1]:null}(K),tt=k(K,S);return"[Function"+(v?": "+v:" (anonymous)")+"]"+(tt.length>0?" { "+q.call(tt,", ")+" }":"")}if(L(K)){var Kt=C?E.call(String(K),/^(Symbol\(.*\))_[^)]*$/,"$1"):_.call(K);return"object"!=typeof K||C?Kt:p(Kt)}if((T=K)&&"object"==typeof T&&("undefined"!=typeof HTMLElement&&T instanceof HTMLElement||"string"==typeof T.nodeName&&"function"==typeof T.getAttribute)){for(var Dt="<"+Q.call(String(K.nodeName)),at=K.attributes||[],Gt=0;Gt<at.length;Gt++)Dt+=" "+at[Gt].name+"="+g(R(at[Gt].value),"double",x);return Dt+=">",K.childNodes&&K.childNodes.length&&(Dt+="..."),Dt+"</"+Q.call(String(K.nodeName))+">"}if(A(K)){if(0===K.length)return"[]";var Nt=k(K,S);return F&&!function(t){for(var K=0;K<t.length;K++)if(B(t[K],"\n")>=0)return!1;return!0}(Nt)?"["+M(Nt,F)+"]":"[ "+q.call(Nt,", ")+" ]"}if(function(t){return!("[object Error]"!==$(t)||H&&"object"==typeof t&&H in t)}(K)){var Wt=k(K,S);return"cause"in Error.prototype||!("cause"in K)||o.call(K,"cause")?0===Wt.length?"["+String(K)+"]":"{ ["+String(K)+"] "+q.call(Wt,", ")+" }":"{ ["+String(K)+"] "+q.call(y.call("[cause]: "+S(K.cause),Wt),", ")+" }"}if("object"==typeof K&&b){if(c&&"function"==typeof K[c]&&s)return s(K,{depth:h-a});if("symbol"!==b&&"function"==typeof K.inspect)return K.inspect()}if(function(t){if(!N||!t||"object"!=typeof t)return!1;try{N.call(t);try{n.call(t)}catch(t){return!0}return t instanceof Map}catch(t){}return!1}(K)){var xt=[];return W&&W.call(K,(function(t,D){xt.push(S(D,K,!0)+" => "+S(t,K))})),r("Map",N.call(K),xt,F)}if(function(t){if(!n||!t||"object"!=typeof t)return!1;try{n.call(t);try{N.call(t)}catch(t){return!0}return t instanceof Set}catch(t){}return!1}(K)){var bt=[];return e&&e.call(K,(function(t){bt.push(S(t,K))})),r("Set",n.call(K),bt,F)}if(function(t){if(!i||!t||"object"!=typeof t)return!1;try{i.call(t,i);try{z.call(t,z)}catch(t){return!0}return t instanceof WeakMap}catch(t){}return!1}(K))return j("WeakMap");if(function(t){if(!z||!t||"object"!=typeof t)return!1;try{z.call(t,z);try{i.call(t,i)}catch(t){return!0}return t instanceof WeakSet}catch(t){}return!1}(K))return j("WeakSet");if(function(t){if(!I||!t||"object"!=typeof t)return!1;try{return I.call(t),!0}catch(t){}return!1}(K))return j("WeakRef");if(function(t){return!("[object Number]"!==$(t)||H&&"object"==typeof t&&H in t)}(K))return p(S(Number(K)));if(function(t){if(!t||"object"!=typeof t||!J)return!1;try{return J.call(t),!0}catch(t){}return!1}(K))return p(S(J.call(K)));if(function(t){return!("[object Boolean]"!==$(t)||H&&"object"==typeof t&&H in t)}(K))return p(Z.call(K));if(function(t){return!("[object String]"!==$(t)||H&&"object"==typeof t&&H in t)}(K))return p(S(String(K)));if("undefined"!=typeof window&&K===window)return"{ [object Window] }";if(K===window)return"{ [object globalThis] }";if(!function(t){return!("[object Date]"!==$(t)||H&&"object"==typeof t&&H in t)}(K)&&!Y(K)){var nt=k(K,S),et=U?U(K)===Object.prototype:K instanceof Object||K.constructor===Object,it=K instanceof Object?"":"null prototype",zt=!et&&H&&Object(K)===K&&H in K?d.call($(K),8,-1):it?"Object":"",It=(et||"function"!=typeof K.constructor?"":K.constructor.name?K.constructor.name+" ":"")+(zt||it?"["+q.call(y.call([],zt||[],it||[]),": ")+"] ":"");return 0===nt.length?It+"{}":F?It+"{"+M(nt,F)+"}":It+"{ "+q.call(nt,", ")+" }"}return String(K)};var S=Object.prototype.hasOwnProperty||function(t){return t in this};function f(t,K){return S.call(t,K)}function $(t){return w.call(t)}function B(t,K){if(t.indexOf)return t.indexOf(K);for(var D=0,a=t.length;D<a;D++)if(t[D]===K)return D;return-1}function O(t,K){if(t.length>K.maxStringLength){var D=t.length-K.maxStringLength,a="... "+D+" more character"+(D>1?"s":"");return O(d.call(t,0,K.maxStringLength),K)+a}return g(E.call(E.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,v),"single",K)}function v(t){var K=t.charCodeAt(0),D={8:"b",9:"t",10:"n",12:"f",13:"r"}[K];return D?"\\"+D:"\\x"+(K<16?"0":"")+l.call(K.toString(16))}function p(t){return"Object("+t+")"}function j(t){return t+" { ? }"}function r(t,K,D,a){return t+" ("+K+") {"+(a?M(D,a):q.call(D,", "))+"}"}function M(t,K){if(0===t.length)return"";var D="\n"+K.prev+K.base;return D+q.call(t,","+D)+"\n"+K.prev}function k(t,K){var D=A(t),a=[];if(D){a.length=t.length;for(var G=0;G<t.length;G++)a[G]=f(t,G)?K(t[G],t):""}var N,W="function"==typeof T?T(t):[];if(C){N={};for(var x=0;x<W.length;x++)N["$"+W[x]]=W[x]}for(var b in t)f(t,b)&&(D&&String(Number(b))===b&&b<t.length||C&&N["$"+b]instanceof Symbol||(P.call(/[^\w$]/,b)?a.push(K(b,t)+": "+K(t[b],t)):a.push(b+": "+K(t[b],t))));if("function"==typeof T)for(var n=0;n<W.length;n++)o.call(t,W[n])&&a.push("["+K(W[n])+"]: "+K(t[W[n]],t));return a}},504825:(t,K,D)=>{var a=D(578278);Object.defineProperty(K,"__esModule",{value:!0}),K["default"]=void 0;var G=a(D(377810)),N=(a(D(746365)),function(t){t.index;var K=t.children;G.default.Children.count(K)});K["default"]=N},454767:(t,K,D)=>{var a=D(578278);Object.defineProperty(K,"__esModule",{value:!0}),K["default"]=function(t){var K,D=t.children,a=t.startIndex,W=t.startX,x=t.pageX,b=t.viewLength,n=t.resistance,e=G.default.Children.count(D)-1,i=a+(W-x)/b;return n?i<0?i=Math.exp(i*N.default.RESISTANCE_COEF)-1:i>e&&(i=e+1-Math.exp((e-i)*N.default.RESISTANCE_COEF)):i<0?K=((i=0)-a)*b+x:i>e&&(K=((i=e)-a)*b+x),{index:i,startX:K}};var G=a(D(377810)),N=a(D(262164))},262164:(t,K)=>{Object.defineProperty(K,"__esModule",{value:!0}),K["default"]=void 0,K["default"]={RESISTANCE_COEF:.6,UNCERTAINTY_THRESHOLD:3}},813659:(t,K,D)=>{var a=D(578278);Object.defineProperty(K,"__esModule",{value:!0}),K["default"]=void 0;var G=a(D(377810));K["default"]=function(t,K){var D=!1,a=function(t){return t?t.key:"empty"};if(t.children.length&&K.children.length){var N=G.default.Children.map(t.children,a)[t.index];null!=N&&N===G.default.Children.map(K.children,a)[K.index]&&(D=!0)}return D}},25706:(t,K,D)=>{var a=D(578278);Object.defineProperty(K,"__esModule",{value:!0}),Object.defineProperty(K,"checkIndexBounds",{enumerable:!0,get:function(){return G.default}}),Object.defineProperty(K,"computeIndex",{enumerable:!0,get:function(){return N.default}}),Object.defineProperty(K,"constant",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(K,"getDisplaySameSlide",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(K,"mod",{enumerable:!0,get:function(){return b.default}});var G=a(D(504825)),N=a(D(454767)),W=a(D(262164)),x=a(D(813659)),b=a(D(981794))},981794:(t,K)=>{Object.defineProperty(K,"__esModule",{value:!0}),K["default"]=void 0;K["default"]=function(t,K){var D=t%K;return D<0?D+K:D}},578278:t=>{t.exports=function(t){return t&&t.__esModule?t:{default:t}}},717284:(t,K,D)=>{var a=D(737202);Object.defineProperty(K,"__esModule",{value:!0}),K.getDomTreeShapes=q,K.findNativeHandler=h,K["default"]=void 0;var G=a(D(609562)),N=a(D(288215)),W=a(D(678967)),x=a(D(704643)),b=a(D(22132)),n=a(D(103088)),e=a(D(7511)),i=a(D(377810)),z=a(D(575826)),I=(a(D(746365)),a(D(427728))),Z=a(D(609622)),w=a(D(65402)),m=D(25706);function u(t,K,D,a){return(0,Z.default)(t,K,D,a),{remove:function(){(0,w.default)(t,K,D,a)}}}var d={direction:"ltr",display:"flex",willChange:"transform"},E={width:"100%",WebkitFlexShrink:0,flexShrink:0,overflow:"auto"},l={root:{x:{overflowX:"hidden"},"x-reverse":{overflowX:"hidden"},y:{overflowY:"hidden"},"y-reverse":{overflowY:"hidden"}},flexDirection:{x:"row","x-reverse":"row-reverse",y:"column","y-reverse":"column-reverse"},transform:{x:function(t){return"translate(".concat(-t,"%, 0)")},"x-reverse":function(t){return"translate(".concat(t,"%, 0)")},y:function(t){return"translate(0, ".concat(-t,"%)")},"y-reverse":function(t){return"translate(0, ".concat(t,"%)")}},length:{x:"width","x-reverse":"width",y:"height","y-reverse":"height"},rotationMatrix:{x:{x:[1,0],y:[0,1]},"x-reverse":{x:[-1,0],y:[0,1]},y:{x:[0,1],y:[1,0]},"y-reverse":{x:[0,-1],y:[1,0]}},scrollPosition:{x:"scrollLeft","x-reverse":"scrollLeft",y:"scrollTop","y-reverse":"scrollTop"},scrollLength:{x:"scrollWidth","x-reverse":"scrollWidth",y:"scrollHeight","y-reverse":"scrollHeight"},clientLength:{x:"clientWidth","x-reverse":"clientWidth",y:"clientHeight","y-reverse":"clientHeight"}};function Q(t,K){var D=K.duration,a=K.easeFunction,G=K.delay;return"".concat(t," ").concat(D," ").concat(a," ").concat(G)}function P(t,K){var D=l.rotationMatrix[K];return{pageX:D.x[0]*t.pageX+D.x[1]*t.pageY,pageY:D.y[0]*t.pageX+D.y[1]*t.pageY}}function y(t){return t.touches=[{pageX:t.pageX,pageY:t.pageY}],t}function q(t,K){for(var D=[];t&&t!==K&&!t.hasAttribute("data-swipeable");){var a=window.getComputedStyle(t);"absolute"===a.getPropertyValue("position")||"hidden"===a.getPropertyValue("overflow-x")?D=[]:(t.clientWidth>0&&t.scrollWidth>t.clientWidth||t.clientHeight>0&&t.scrollHeight>t.clientHeight)&&D.push({element:t,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,clientWidth:t.clientWidth,clientHeight:t.clientHeight,scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}),t=t.parentNode}return D}var X=null;function h(t){var K=t.domTreeShapes,D=t.pageX,a=t.startX,G=t.axis;return K.some((function(t){var K=D>=a;"x"!==G&&"y"!==G||(K=!K);var N=t[l.scrollPosition[G]],W=N>0,x=N+t[l.clientLength[G]]<t[l.scrollLength[G]];return!!(K&&x||!K&&W)&&(X=t.element,!0)}))}var J=function(t){function K(t){var D;return(0,W.default)(this,K),(D=(0,b.default)(this,(0,n.default)(K).call(this,t))).rootNode=null,D.containerNode=null,D.ignoreNextScrollEvents=!1,D.viewLength=0,D.startX=0,D.lastX=0,D.vx=0,D.startY=0,D.isSwiping=void 0,D.started=!1,D.startIndex=0,D.transitionListener=null,D.touchMoveListener=null,D.activeSlide=null,D.indexCurrent=null,D.firstRenderTimeout=null,D.setRootNode=function(t){D.rootNode=t},D.setContainerNode=function(t){D.containerNode=t},D.setActiveSlide=function(t){D.activeSlide=t,D.updateHeight()},D.handleSwipeStart=function(t){var K=D.props.axis,a=P(t.touches[0],K);D.viewLength=D.rootNode.getBoundingClientRect()[l.length[K]],D.startX=a.pageX,D.lastX=a.pageX,D.vx=0,D.startY=a.pageY,D.isSwiping=void 0,D.started=!0;var G=window.getComputedStyle(D.containerNode),N=G.getPropertyValue("-webkit-transform")||G.getPropertyValue("transform");if(N&&"none"!==N){var W=N.split("(")[1].split(")")[0].split(","),x=window.getComputedStyle(D.rootNode),b=P({pageX:parseInt(W[4],10),pageY:parseInt(W[5],10)},K);D.startIndex=-b.pageX/(D.viewLength-parseInt(x.paddingLeft,10)-parseInt(x.paddingRight,10))||0}},D.handleSwipeMove=function(t){if(D.started){if(null===X||X===D.rootNode){var K=D.props,a=K.axis,G=K.children,N=K.ignoreNativeScroll,W=K.onSwitching,x=K.resistance,b=P(t.touches[0],a);if(void 0===D.isSwiping){var n=Math.abs(b.pageX-D.startX),e=Math.abs(b.pageY-D.startY),z=n>e&&n>m.constant.UNCERTAINTY_THRESHOLD;if(!x&&("y"===a||"y-reverse"===a)&&(0===D.indexCurrent&&D.startX<b.pageX||D.indexCurrent===i.default.Children.count(D.props.children)-1&&D.startX>b.pageX))return void(D.isSwiping=!1);if(n>e&&t.preventDefault(),!0===z||e>m.constant.UNCERTAINTY_THRESHOLD)return D.isSwiping=z,void(D.startX=b.pageX)}if(!0===D.isSwiping){t.preventDefault(),D.vx=.5*D.vx+.5*(b.pageX-D.lastX),D.lastX=b.pageX;var I=(0,m.computeIndex)({children:G,resistance:x,pageX:b.pageX,startIndex:D.startIndex,startX:D.startX,viewLength:D.viewLength}),Z=I.index,w=I.startX;if(null===X&&!N&&h({domTreeShapes:q(t.target,D.rootNode),startX:D.startX,pageX:b.pageX,axis:a}))return;w?D.startX=w:null===X&&(X=D.rootNode),D.setIndexCurrent(Z);var u=function(){W&&W(Z,"move")};!D.state.displaySameSlide&&D.state.isDragging||D.setState({displaySameSlide:!1,isDragging:!0},u),u()}}}else D.handleTouchStart(t)},D.handleSwipeEnd=function(){if(X=null,D.started&&(D.started=!1,!0===D.isSwiping)){var t,K=D.state.indexLatest,a=D.indexCurrent,G=K-a;t=Math.abs(D.vx)>D.props.threshold?D.vx>0?Math.floor(a):Math.ceil(a):Math.abs(G)>D.props.hysteresis?G>0?Math.floor(a):Math.ceil(a):K;var N=i.default.Children.count(D.props.children)-1;t<0?t=0:t>N&&(t=N),D.setIndexCurrent(t),D.setState({indexLatest:t,isDragging:!1},(function(){D.props.onSwitching&&D.props.onSwitching(t,"end"),D.props.onChangeIndex&&t!==K&&D.props.onChangeIndex(t,K,{reason:"swipe"}),a===K&&D.handleTransitionEnd()}))}},D.handleTouchStart=function(t){D.props.onTouchStart&&D.props.onTouchStart(t),D.handleSwipeStart(t)},D.handleTouchEnd=function(t){D.props.onTouchEnd&&D.props.onTouchEnd(t),D.handleSwipeEnd(t)},D.handleMouseDown=function(t){D.props.onMouseDown&&D.props.onMouseDown(t),t.persist(),D.handleSwipeStart(y(t))},D.handleMouseUp=function(t){D.props.onMouseUp&&D.props.onMouseUp(t),D.handleSwipeEnd(y(t))},D.handleMouseLeave=function(t){D.props.onMouseLeave&&D.props.onMouseLeave(t),D.started&&D.handleSwipeEnd(y(t))},D.handleMouseMove=function(t){D.props.onMouseMove&&D.props.onMouseMove(t),D.started&&D.handleSwipeMove(y(t))},D.handleScroll=function(t){if(D.props.onScroll&&D.props.onScroll(t),t.target===D.rootNode)if(D.ignoreNextScrollEvents)D.ignoreNextScrollEvents=!1;else{var K=D.state.indexLatest,a=Math.ceil(t.target.scrollLeft/t.target.clientWidth)+K;D.ignoreNextScrollEvents=!0,t.target.scrollLeft=0,D.props.onChangeIndex&&a!==K&&D.props.onChangeIndex(a,K,{reason:"focus"})}},D.updateHeight=function(){if(null!==D.activeSlide){var t=D.activeSlide.children[0];void 0!==t&&void 0!==t.offsetHeight&&D.state.heightLatest!==t.offsetHeight&&D.setState({heightLatest:t.offsetHeight})}},D.state={indexLatest:t.index,isDragging:!1,renderOnlyActive:!t.disableLazyLoading,heightLatest:0,displaySameSlide:!0},D.setIndexCurrent(t.index),D}return(0,e.default)(K,t),(0,x.default)(K,[{key:"getChildContext",value:function(){var t=this;return{swipeableViews:{slideUpdateHeight:function(){t.updateHeight()}}}}},{key:"componentDidMount",value:function(){var t=this;this.transitionListener=u(this.containerNode,I.default.end,(function(K){K.target===t.containerNode&&t.handleTransitionEnd()})),this.touchMoveListener=u(this.rootNode,"touchmove",(function(K){t.props.disabled||t.handleSwipeMove(K)}),{passive:!1}),this.props.disableLazyLoading||(this.firstRenderTimeout=setTimeout((function(){t.setState({renderOnlyActive:!1})}),0)),this.props.action&&this.props.action({updateHeight:this.updateHeight})}},{key:"componentWillReceiveProps",value:function(t){var K=t.index;"number"==typeof K&&K!==this.props.index&&(this.setIndexCurrent(K),this.setState({displaySameSlide:(0,m.getDisplaySameSlide)(this.props,t),indexLatest:K}))}},{key:"componentWillUnmount",value:function(){this.transitionListener.remove(),this.touchMoveListener.remove(),clearTimeout(this.firstRenderTimeout)}},{key:"setIndexCurrent",value:function(t){if(this.props.animateTransitions||this.indexCurrent===t||this.handleTransitionEnd(),this.indexCurrent=t,this.containerNode){var K=this.props.axis,D=l.transform[K](100*t);this.containerNode.style.WebkitTransform=D,this.containerNode.style.transform=D}}},{key:"handleTransitionEnd",value:function(){this.props.onTransitionEnd&&(this.state.displaySameSlide||this.state.isDragging||this.props.onTransitionEnd())}},{key:"render",value:function(){var t,K,D=this,a=this.props,W=(a.action,a.animateHeight),x=a.animateTransitions,b=a.axis,n=a.children,e=a.containerStyle,z=a.disabled,I=(a.disableLazyLoading,a.enableMouseEvents),Z=(a.hysteresis,a.ignoreNativeScroll,a.index,a.onChangeIndex,a.onSwitching,a.onTransitionEnd,a.resistance,a.slideStyle),w=a.slideClassName,m=a.springConfig,u=a.style,P=(a.threshold,(0,N.default)(a,["action","animateHeight","animateTransitions","axis","children","containerStyle","disabled","disableLazyLoading","enableMouseEvents","hysteresis","ignoreNativeScroll","index","onChangeIndex","onSwitching","onTransitionEnd","resistance","slideStyle","slideClassName","springConfig","style","threshold"])),y=this.state,q=y.displaySameSlide,X=y.heightLatest,h=y.indexLatest,J=y.isDragging,T=y.renderOnlyActive,_=z?{}:{onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd},C=!z&&I?{onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseLeave,onMouseMove:this.handleMouseMove}:{},H=(0,G.default)({},E,Z);if(J||!x||q)t="all 0s ease 0s",K="all 0s ease 0s";else if(t=Q("transform",m),K=Q("-webkit-transform",m),0!==X){var o=", ".concat(Q("height",m));t+=o,K+=o}var U={height:null,WebkitFlexDirection:l.flexDirection[b],flexDirection:l.flexDirection[b],WebkitTransition:K,transition:t};if(!T){var V=l.transform[b](100*this.indexCurrent);U.WebkitTransform=V,U.transform=V}return W&&(U.height=X),i.default.createElement("div",(0,G.default)({ref:this.setRootNode,style:(0,G.default)({},l.root[b],u)},P,_,C,{onScroll:this.handleScroll}),i.default.createElement("div",{ref:this.setContainerNode,style:(0,G.default)({},U,d,e),className:"react-swipeable-view-container"},i.default.Children.map(n,(function(t,K){if(T&&K!==h)return null;var a,G=!0;return K===h&&(G=!1,W&&(a=D.setActiveSlide,H.overflowY="hidden")),i.default.createElement("div",{ref:a,style:H,className:w,"aria-hidden":G,"data-swipeable":"true"},t)}))))}}]),K}(i.default.Component);J.displayName="ReactSwipableView",J.propTypes=0?0:{},J.defaultProps={animateHeight:!1,animateTransitions:!0,axis:"x",disabled:!1,disableLazyLoading:!1,enableMouseEvents:!1,hysteresis:.6,ignoreNativeScroll:!1,index:0,threshold:5,springConfig:{duration:"0.35s",easeFunction:"cubic-bezier(0.15, 0.3, 0.25, 1)",delay:"0s"},resistance:!1},J.childContextTypes={swipeableViews:z.default.shape({slideUpdateHeight:z.default.func})};var T=J;K["default"]=T},866302:(t,K,D)=>{var a=D(737202);K.A=void 0;var G=a(D(717284)).default;K.A=G},915755:t=>{t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},678967:t=>{t.exports=function(t,K){if(!(t instanceof K))throw new TypeError("Cannot call a class as a function")}},704643:t=>{function K(t,K){for(var D=0;D<K.length;D++){var a=K[D];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}t.exports=function(t,D,a){return D&&K(t.prototype,D),a&&K(t,a),t}},609562:t=>{function K(){return t.exports=K=Object.assign||function(t){for(var K=1;K<arguments.length;K++){var D=arguments[K];for(var a in D)Object.prototype.hasOwnProperty.call(D,a)&&(t[a]=D[a])}return t},K.apply(this,arguments)}t.exports=K},103088:t=>{function K(D){return t.exports=K=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},K(D)}t.exports=K},7511:(t,K,D)=>{var a=D(308964);t.exports=function(t,K){if("function"!=typeof K&&null!==K)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(K&&K.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),K&&a(t,K)}},737202:t=>{t.exports=function(t){return t&&t.__esModule?t:{default:t}}},288215:(t,K,D)=>{var a=D(326973);t.exports=function(t,K){if(null==t)return{};var D,G,N=a(t,K);if(Object.getOwnPropertySymbols){var W=Object.getOwnPropertySymbols(t);for(G=0;G<W.length;G++)D=W[G],K.indexOf(D)>=0||Object.prototype.propertyIsEnumerable.call(t,D)&&(N[D]=t[D])}return N}},326973:t=>{t.exports=function(t,K){if(null==t)return{};var D,a,G={},N=Object.keys(t);for(a=0;a<N.length;a++)D=N[a],K.indexOf(D)>=0||(G[D]=t[D]);return G}},22132:(t,K,D)=>{var a=D(544634),G=D(915755);t.exports=function(t,K){return!K||"object"!==a(K)&&"function"!=typeof K?G(t):K}},308964:t=>{function K(D,a){return t.exports=K=Object.setPrototypeOf||function(t,K){return t.__proto__=K,t},K(D,a)}t.exports=K},544634:t=>{function K(t){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(t)}function D(a){return"function"==typeof Symbol&&"symbol"===K(Symbol.iterator)?t.exports=D=function(t){return K(t)}:t.exports=D=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":K(t)},D(a)}t.exports=D},486255:(t,K,D)=>{var a=D(228651),G=D(589295),N=D(118890)(),W=D(668109),x=D(96785),b=a("%Math.floor%");t.exports=function(t,K){if("function"!=typeof t)throw new x("`fn` is not a function");if("number"!=typeof K||K<0||K>4294967295||b(K)!==K)throw new x("`length` must be a positive 32-bit integer");var D=arguments.length>2&&!!arguments[2],a=!0,n=!0;if("length"in t&&W){var e=W(t,"length");e&&!e.configurable&&(a=!1),e&&!e.writable&&(n=!1)}return(a||n||!D)&&(N?G(t,"length",K,!0,!0):G(t,"length",K)),t}},338402:(t,K,D)=>{var a=D(228651),G=D(267913),N=D(115937),W=D(96785),x=a("%WeakMap%",!0),b=a("%Map%",!0),n=G("WeakMap.prototype.get",!0),e=G("WeakMap.prototype.set",!0),i=G("WeakMap.prototype.has",!0),z=G("Map.prototype.get",!0),I=G("Map.prototype.set",!0),Z=G("Map.prototype.has",!0),w=function(t,K){for(var D,a=t;null!==(D=a.next);a=D)if(D.key===K)return a.next=D.next,D.next=t.next,t.next=D,D};t.exports=function(){var t,K,D,a={assert:function(t){if(!a.has(t))throw new W("Side channel does not contain "+N(t))},get:function(a){if(x&&a&&("object"==typeof a||"function"==typeof a)){if(t)return n(t,a)}else if(b){if(K)return z(K,a)}else if(D)return function(t,K){var D=w(t,K);return D&&D.value}(D,a)},has:function(a){if(x&&a&&("object"==typeof a||"function"==typeof a)){if(t)return i(t,a)}else if(b){if(K)return Z(K,a)}else if(D)return function(t,K){return!!w(t,K)}(D,a);return!1},set:function(a,G){x&&a&&("object"==typeof a||"function"==typeof a)?(t||(t=new x),e(t,a,G)):b?(K||(K=new b),I(K,a,G)):(D||(D={key:{},next:null}),function(t,K,D){var a=w(t,K);a?a.value=D:t.next={key:K,next:t.next,value:D}}(D,a,G))}};return a}},746365:t=>{var K=function(){};if("production"!="production"){var D=function(t,K){var D=arguments.length;K=new Array(D>1?D-1:0);for(var a=1;a<D;a++)K[a-1]=arguments[a];var G=0,N="Warning: "+t.replace(/%s/g,(function(){return K[G++]}));"undefined"!=typeof console&&console.error(N);try{throw new Error(N)}catch(t){}};K=function(t,K,a){var G=arguments.length;a=new Array(G>2?G-2:0);for(var N=2;N<G;N++)a[N-2]=arguments[N];if(void 0===K)throw new Error("`warning(condition, format, ...args)` requires a warning "+"message argument");t||D.apply(null,[K].concat(a))}}t.exports=K},258055:t=>{var K=Object.prototype.hasOwnProperty,D="~";function a(){}function G(t,K,D){this.fn=t,this.context=K,this.once=D||!1}function N(t,K,a,N,W){if("function"!=typeof a)throw new TypeError("The listener must be a function");var x=new G(a,N||t,W),b=D?D+K:K;return t._events[b]?t._events[b].fn?t._events[b]=[t._events[b],x]:t._events[b].push(x):(t._events[b]=x,t._eventsCount++),t}function W(t,K){0==--t._eventsCount?t._events=new a:delete t._events[K]}function x(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(D=!1)),x.prototype.eventNames=function(){var t,a,G=[];if(0===this._eventsCount)return G;for(a in t=this._events)K.call(t,a)&&G.push(D?a.slice(1):a);return Object.getOwnPropertySymbols?G.concat(Object.getOwnPropertySymbols(t)):G},x.prototype.listeners=function(t){var K=D?D+t:t,a=this._events[K];if(!a)return[];if(a.fn)return[a.fn];for(var G=0,N=a.length,W=new Array(N);G<N;G++)W[G]=a[G].fn;return W},x.prototype.listenerCount=function(t){var K=D?D+t:t,a=this._events[K];return a?a.fn?1:a.length:0},x.prototype.emit=function(t,K,a,G,N,W){var x=D?D+t:t;if(!this._events[x])return!1;var b,n,e=this._events[x],i=arguments.length;if(e.fn){switch(e.once&&this.removeListener(t,e.fn,void 0,!0),i){case 1:return e.fn.call(e.context),!0;case 2:return e.fn.call(e.context,K),!0;case 3:return e.fn.call(e.context,K,a),!0;case 4:return e.fn.call(e.context,K,a,G),!0;case 5:return e.fn.call(e.context,K,a,G,N),!0;case 6:return e.fn.call(e.context,K,a,G,N,W),!0}for(n=1,b=new Array(i-1);n<i;n++)b[n-1]=arguments[n];e.fn.apply(e.context,b)}else{var z,I=e.length;for(n=0;n<I;n++)switch(e[n].once&&this.removeListener(t,e[n].fn,void 0,!0),i){case 1:e[n].fn.call(e[n].context);break;case 2:e[n].fn.call(e[n].context,K);break;case 3:e[n].fn.call(e[n].context,K,a);break;case 4:e[n].fn.call(e[n].context,K,a,G);break;default:if(!b)for(z=1,b=new Array(i-1);z<i;z++)b[z-1]=arguments[z];e[n].fn.apply(e[n].context,b)}}return!0},x.prototype.on=function(t,K,D){return N(this,t,K,D,!1)},x.prototype.once=function(t,K,D){return N(this,t,K,D,!0)},x.prototype.removeListener=function(t,K,a,G){var N=D?D+t:t;if(!this._events[N])return this;if(!K)return W(this,N),this;var x=this._events[N];if(x.fn)x.fn!==K||G&&!x.once||a&&x.context!==a||W(this,N);else{for(var b=0,n=[],e=x.length;b<e;b++)(x[b].fn!==K||G&&!x[b].once||a&&x[b].context!==a)&&n.push(x[b]);n.length?this._events[N]=1===n.length?n[0]:n:W(this,N)}return this},x.prototype.removeAllListeners=function(t){var K;return t?(K=D?D+t:t,this._events[K]&&W(this,K)):(this._events=new a,this._eventsCount=0),this},x.prototype.off=x.prototype.removeListener,x.prototype.addListener=x.prototype.on,x.prefixed=D,x.EventEmitter=x,1&&(t.exports=x)},893776:function(t,K,D){var a;t=D.nmd(t),function(){!0&&K&&K.nodeType,!0&&t&&t.nodeType;var G="object"==typeof window&&window;G.global!==G&&G.window!==G&&G.self;var N,W=2147483647,x=36,b=1,n=26,e=38,i=700,z=72,I=128,Z="-",w=/^xn--/,m=/[^\x20-\x7E]/,u=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},E=x-b,l=Math.floor,Q=String.fromCharCode;function P(t){throw new RangeError(d[t])}function y(t,K){for(var D=t.length,a=[];D--;)a[D]=K(t[D]);return a}function q(t,K){var D=t.split("@"),a="";return D.length>1&&(a=D[0]+"@",t=D[1]),a+y((t=t.replace(u,".")).split("."),K).join(".")}function X(t){for(var K,D,a=[],G=0,N=t.length;G<N;)(K=t.charCodeAt(G++))>=55296&&K<=56319&&G<N?56320==(64512&(D=t.charCodeAt(G++)))?a.push(((1023&K)<<10)+(1023&D)+65536):(a.push(K),G--):a.push(K);return a}function h(t){return y(t,(function(t){var K="";return t>65535&&(K+=Q((t-=65536)>>>10&1023|55296),t=56320|1023&t),K+Q(t)})).join("")}function J(t,K){return t+22+75*(t<26)-((0!=K)<<5)}function T(t,K,D){var a=0;for(t=D?l(t/i):t>>1,t+=l(t/K);t>E*n>>1;a+=x)t=l(t/E);return l(a+(E+1)*t/(t+e))}function _(t){var K,D,a,G,N,e,i,w,m,u,d,E=[],Q=t.length,y=0,q=I,X=z;for((D=t.lastIndexOf(Z))<0&&(D=0),a=0;a<D;++a)t.charCodeAt(a)>=128&&P("not-basic"),E.push(t.charCodeAt(a));for(G=D>0?D+1:0;G<Q;){for(N=y,e=1,i=x;G>=Q&&P("invalid-input"),((w=(d=t.charCodeAt(G++))-48<10?d-22:d-65<26?d-65:d-97<26?d-97:x)>=x||w>l((W-y)/e))&&P("overflow"),y+=w*e,!(w<(m=i<=X?b:i>=X+n?n:i-X));i+=x)e>l(W/(u=x-m))&&P("overflow"),e*=u;X=T(y-N,K=E.length+1,0==N),l(y/K)>W-q&&P("overflow"),q+=l(y/K),y%=K,E.splice(y++,0,q)}return h(E)}function C(t){var K,D,a,G,N,e,i,w,m,u,d,E,y,q,h,_=[];for(E=(t=X(t)).length,K=I,D=0,N=z,e=0;e<E;++e)(d=t[e])<128&&_.push(Q(d));for(a=G=_.length,G&&_.push(Z);a<E;){for(i=W,e=0;e<E;++e)(d=t[e])>=K&&d<i&&(i=d);for(i-K>l((W-D)/(y=a+1))&&P("overflow"),D+=(i-K)*y,K=i,e=0;e<E;++e)if((d=t[e])<K&&++D>W&&P("overflow"),d==K){for(w=D,m=x;!(w<(u=m<=N?b:m>=N+n?n:m-N));m+=x)h=w-u,q=x-u,_.push(Q(J(u+h%q,0))),w=l(h/q);_.push(Q(J(w,0))),N=T(D,y,a==G),D=0,++a}++D,++K}return _.join("")}N={version:"1.4.1",ucs2:{decode:X,encode:h},decode:_,encode:C,toASCII:function(t){return q(t,(function(t){return m.test(t)?"xn--"+C(t):t}))},toUnicode:function(t){return q(t,(function(t){return w.test(t)?_(t.slice(4).toLowerCase()):t}))}},1&&(void 0===(a=function(){return N}.call(K,D,K,t))||(t.exports=a))}()},815304:t=>{var K=String.prototype.replace,D=/%20/g,a="RFC3986";t.exports={default:a,formatters:{RFC1738:function(t){return K.call(t,D,"+")},RFC3986:function(t){return String(t)}},RFC1738:"RFC1738",RFC3986:a}},97976:(t,K,D)=>{var a=D(511125),G=D(346731),N=D(815304);t.exports={formats:N,parse:G,stringify:a}},346731:(t,K,D)=>{var a=D(648193),G=Object.prototype.hasOwnProperty,N=Array.isArray,W={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:a.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1},x=function(t){return t.replace(/&#(\d+);/g,(function(t,K){return String.fromCharCode(parseInt(K,10))}))},b=function(t,K){return t&&"string"==typeof t&&K.comma&&t.indexOf(",")>-1?t.split(","):t},n="utf8=%26%2310003%3B",e="utf8=%E2%9C%93",i=function(t,K,D,a){if(t){var N=D.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,W=/(\[[^[\]]*])/g,x=D.depth>0&&/(\[[^[\]]*])/.exec(N),n=x?N.slice(0,x.index):N,e=[];if(n){if(!D.plainObjects&&G.call(Object.prototype,n)&&!D.allowPrototypes)return;e.push(n)}for(var i=0;D.depth>0&&null!==(x=W.exec(N))&&i<D.depth;){if(i+=1,!D.plainObjects&&G.call(Object.prototype,x[1].slice(1,-1))&&!D.allowPrototypes)return;e.push(x[1])}if(x){if(!0===D.strictDepth)throw new RangeError("Input depth exceeded depth option of "+D.depth+" and strictDepth is true");e.push("["+N.slice(x.index)+"]")}return function(t,K,D,a){for(var G=a?K:b(K,D),N=t.length-1;N>=0;--N){var W,x=t[N];if("[]"===x&&D.parseArrays)W=D.allowEmptyArrays&&(""===G||D.strictNullHandling&&null===G)?[]:[].concat(G);else{W=D.plainObjects?Object.create(null):{};var n="["===x.charAt(0)&&"]"===x.charAt(x.length-1)?x.slice(1,-1):x,e=D.decodeDotInKeys?n.replace(/%2E/g,"."):n,i=parseInt(e,10);D.parseArrays||""!==e?!isNaN(i)&&x!==e&&String(i)===e&&i>=0&&D.parseArrays&&i<=D.arrayLimit?(W=[])[i]=G:"__proto__"!==e&&(W[e]=G):W={0:G}}G=W}return G}(e,K,D,a)}};t.exports=function(t,K){var D=function(t){if(!t)return W;if(void 0!==t.allowEmptyArrays&&"boolean"!=typeof t.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==t.decodeDotInKeys&&"boolean"!=typeof t.decodeDotInKeys)throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==t.decoder&&void 0!==t.decoder&&"function"!=typeof t.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var K=void 0===t.charset?W.charset:t.charset,D=void 0===t.duplicates?W.duplicates:t.duplicates;if("combine"!==D&&"first"!==D&&"last"!==D)throw new TypeError("The duplicates option must be either combine, first, or last");return{allowDots:void 0===t.allowDots?!0===t.decodeDotInKeys||W.allowDots:!!t.allowDots,allowEmptyArrays:"boolean"==typeof t.allowEmptyArrays?!!t.allowEmptyArrays:W.allowEmptyArrays,allowPrototypes:"boolean"==typeof t.allowPrototypes?t.allowPrototypes:W.allowPrototypes,allowSparse:"boolean"==typeof t.allowSparse?t.allowSparse:W.allowSparse,arrayLimit:"number"==typeof t.arrayLimit?t.arrayLimit:W.arrayLimit,charset:K,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:W.charsetSentinel,comma:"boolean"==typeof t.comma?t.comma:W.comma,decodeDotInKeys:"boolean"==typeof t.decodeDotInKeys?t.decodeDotInKeys:W.decodeDotInKeys,decoder:"function"==typeof t.decoder?t.decoder:W.decoder,delimiter:"string"==typeof t.delimiter||a.isRegExp(t.delimiter)?t.delimiter:W.delimiter,depth:"number"==typeof t.depth||!1===t.depth?+t.depth:W.depth,duplicates:D,ignoreQueryPrefix:!0===t.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof t.interpretNumericEntities?t.interpretNumericEntities:W.interpretNumericEntities,parameterLimit:"number"==typeof t.parameterLimit?t.parameterLimit:W.parameterLimit,parseArrays:!1!==t.parseArrays,plainObjects:"boolean"==typeof t.plainObjects?t.plainObjects:W.plainObjects,strictDepth:"boolean"==typeof t.strictDepth?!!t.strictDepth:W.strictDepth,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:W.strictNullHandling}}(K);if(""===t||null==t)return D.plainObjects?Object.create(null):{};for(var z="string"==typeof t?function(t,K){var D={__proto__:null},i=K.ignoreQueryPrefix?t.replace(/^\?/,""):t;i=i.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var z,I=K.parameterLimit===1/0?void 0:K.parameterLimit,Z=i.split(K.delimiter,I),w=-1,m=K.charset;if(K.charsetSentinel)for(z=0;z<Z.length;++z)0===Z[z].indexOf("utf8=")&&(Z[z]===e?m="utf-8":Z[z]===n&&(m="iso-8859-1"),w=z,z=Z.length);for(z=0;z<Z.length;++z)if(z!==w){var u,d,E=Z[z],l=E.indexOf("]="),Q=-1===l?E.indexOf("="):l+1;-1===Q?(u=K.decoder(E,W.decoder,m,"key"),d=K.strictNullHandling?null:""):(u=K.decoder(E.slice(0,Q),W.decoder,m,"key"),d=a.maybeMap(b(E.slice(Q+1),K),(function(t){return K.decoder(t,W.decoder,m,"value")}))),d&&K.interpretNumericEntities&&"iso-8859-1"===m&&(d=x(d)),E.indexOf("[]=")>-1&&(d=N(d)?[d]:d);var P=G.call(D,u);P&&"combine"===K.duplicates?D[u]=a.combine(D[u],d):P&&"last"!==K.duplicates||(D[u]=d)}return D}(t,D):t,I=D.plainObjects?Object.create(null):{},Z=Object.keys(z),w=0;w<Z.length;++w){var m=Z[w],u=i(m,z[m],D,"string"==typeof t);I=a.merge(I,u,D)}return!0===D.allowSparse?I:a.compact(I)}},511125:(t,K,D)=>{var a=D(338402),G=D(648193),N=D(815304),W=Object.prototype.hasOwnProperty,x={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,K){return t+"["+K+"]"},repeat:function(t){return t}},b=Array.isArray,n=Array.prototype.push,e=function(t,K){n.apply(t,b(K)?K:[K])},i=Date.prototype.toISOString,z=N["default"],I={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:G.encode,encodeValuesOnly:!1,format:z,formatter:N.formatters[z],indices:!1,serializeDate:function(t){return i.call(t)},skipNulls:!1,strictNullHandling:!1},Z={},w=function t(K,D,N,W,x,n,i,z,w,m,u,d,E,l,Q,P,y,q){for(var X,h=K,J=q,T=0,_=!1;void 0!==(J=J.get(Z))&&!_;){var C=J.get(K);if(T+=1,void 0!==C){if(C===T)throw new RangeError("Cyclic object value");_=!0}void 0===J.get(Z)&&(T=0)}if("function"==typeof m?h=m(D,h):h instanceof Date?h=E(h):"comma"===N&&b(h)&&(h=G.maybeMap(h,(function(t){return t instanceof Date?E(t):t}))),null===h){if(n)return w&&!P?w(D,I.encoder,y,"key",l):D;h=""}if("string"==typeof(X=h)||"number"==typeof X||"boolean"==typeof X||"symbol"==typeof X||"bigint"==typeof X||G.isBuffer(h))return w?[Q(P?D:w(D,I.encoder,y,"key",l))+"="+Q(w(h,I.encoder,y,"value",l))]:[Q(D)+"="+Q(String(h))];var H,o=[];if(void 0===h)return o;if("comma"===N&&b(h))P&&w&&(h=G.maybeMap(h,w)),H=[{value:h.length>0?h.join(",")||null:void 0}];else if(b(m))H=m;else{var U=Object.keys(h);H=u?U.sort(u):U}var V=z?D.replace(/\./g,"%2E"):D,s=W&&b(h)&&1===h.length?V+"[]":V;if(x&&b(h)&&0===h.length)return s+"[]";for(var F=0;F<H.length;++F){var c=H[F],g="object"==typeof c&&void 0!==c.value?c.value:h[c];if(!i||null!==g){var R=d&&z?c.replace(/\./g,"%2E"):c,A=b(h)?"function"==typeof N?N(s,R):s:s+(d?"."+R:"["+R+"]");q.set(K,T);var Y=a();Y.set(Z,q),e(o,t(g,A,N,W,x,n,i,z,"comma"===N&&P&&b(h)?null:w,m,u,d,E,l,Q,P,y,Y))}}return o};t.exports=function(t,K){var D,G=t,n=function(t){if(!t)return I;if(void 0!==t.allowEmptyArrays&&"boolean"!=typeof t.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==t.encodeDotInKeys&&"boolean"!=typeof t.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==t.encoder&&void 0!==t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");var K=t.charset||I.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var D=N["default"];if(void 0!==t.format){if(!W.call(N.formatters,t.format))throw new TypeError("Unknown format option provided.");D=t.format}var a,G=N.formatters[D],n=I.filter;if(("function"==typeof t.filter||b(t.filter))&&(n=t.filter),a=t.arrayFormat in x?t.arrayFormat:"indices"in t?t.indices?"indices":"repeat":I.arrayFormat,"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var e=void 0===t.allowDots?!0===t.encodeDotInKeys||I.allowDots:!!t.allowDots;return{addQueryPrefix:"boolean"==typeof t.addQueryPrefix?t.addQueryPrefix:I.addQueryPrefix,allowDots:e,allowEmptyArrays:"boolean"==typeof t.allowEmptyArrays?!!t.allowEmptyArrays:I.allowEmptyArrays,arrayFormat:a,charset:K,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:I.charsetSentinel,commaRoundTrip:t.commaRoundTrip,delimiter:void 0===t.delimiter?I.delimiter:t.delimiter,encode:"boolean"==typeof t.encode?t.encode:I.encode,encodeDotInKeys:"boolean"==typeof t.encodeDotInKeys?t.encodeDotInKeys:I.encodeDotInKeys,encoder:"function"==typeof t.encoder?t.encoder:I.encoder,encodeValuesOnly:"boolean"==typeof t.encodeValuesOnly?t.encodeValuesOnly:I.encodeValuesOnly,filter:n,format:D,formatter:G,serializeDate:"function"==typeof t.serializeDate?t.serializeDate:I.serializeDate,skipNulls:"boolean"==typeof t.skipNulls?t.skipNulls:I.skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:I.strictNullHandling}}(K);"function"==typeof n.filter?G=(0,n.filter)("",G):b(n.filter)&&(D=n.filter);var i=[];if("object"!=typeof G||null===G)return"";var z=x[n.arrayFormat],Z="comma"===z&&n.commaRoundTrip;D||(D=Object.keys(G)),n.sort&&D.sort(n.sort);for(var m=a(),u=0;u<D.length;++u){var d=D[u];n.skipNulls&&null===G[d]||e(i,w(G[d],d,z,Z,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,m))}var E=i.join(n.delimiter),l=!0===n.addQueryPrefix?"?":"";return n.charsetSentinel&&("iso-8859-1"===n.charset?l+="utf8=%26%2310003%3B&":l+="utf8=%E2%9C%93&"),E.length>0?l+E:""}},648193:(t,K,D)=>{var a=D(815304),G=Object.prototype.hasOwnProperty,N=Array.isArray,W=function(){for(var t=[],K=0;K<256;++K)t.push("%"+((K<16?"0":"")+K.toString(16)).toUpperCase());return t}(),x=function(t,K){for(var D=K&&K.plainObjects?Object.create(null):{},a=0;a<t.length;++a)void 0!==t[a]&&(D[a]=t[a]);return D},b=1024;t.exports={arrayToObject:x,assign:function(t,K){return Object.keys(K).reduce((function(t,D){return t[D]=K[D],t}),t)},combine:function(t,K){return[].concat(t,K)},compact:function(t){for(var K=[{obj:{o:t},prop:"o"}],D=[],a=0;a<K.length;++a)for(var G=K[a],W=G.obj[G.prop],x=Object.keys(W),b=0;b<x.length;++b){var n=x[b],e=W[n];"object"==typeof e&&null!==e&&-1===D.indexOf(e)&&(K.push({obj:W,prop:n}),D.push(e))}return function(t){for(;t.length>1;){var K=t.pop(),D=K.obj[K.prop];if(N(D)){for(var a=[],G=0;G<D.length;++G)void 0!==D[G]&&a.push(D[G]);K.obj[K.prop]=a}}}(K),t},decode:function(t,K,D){var a=t.replace(/\+/g," ");if("iso-8859-1"===D)return a.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(a)}catch(t){return a}},encode:function(t,K,D,G,N){if(0===t.length)return t;var x=t;if("symbol"==typeof t?x=Symbol.prototype.toString.call(t):"string"!=typeof t&&(x=String(t)),"iso-8859-1"===D)return escape(x).replace(/%u[0-9a-f]{4}/gi,(function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"}));for(var n="",e=0;e<x.length;e+=b){for(var i=x.length>=b?x.slice(e,e+b):x,z=[],I=0;I<i.length;++I){var Z=i.charCodeAt(I);45===Z||46===Z||95===Z||126===Z||Z>=48&&Z<=57||Z>=65&&Z<=90||Z>=97&&Z<=122||N===a.RFC1738&&(40===Z||41===Z)?z[z.length]=i.charAt(I):Z<128?z[z.length]=W[Z]:Z<2048?z[z.length]=W[192|Z>>6]+W[128|63&Z]:Z<55296||Z>=57344?z[z.length]=W[224|Z>>12]+W[128|Z>>6&63]+W[128|63&Z]:(I+=1,Z=65536+((1023&Z)<<10|1023&i.charCodeAt(I)),z[z.length]=W[240|Z>>18]+W[128|Z>>12&63]+W[128|Z>>6&63]+W[128|63&Z])}n+=z.join("")}return n},isBuffer:function(t){return!(!t||"object"!=typeof t||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))},isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},maybeMap:function(t,K){if(N(t)){for(var D=[],a=0;a<t.length;a+=1)D.push(K(t[a]));return D}return K(t)},merge:function t(K,D,a){if(!D)return K;if("object"!=typeof D){if(N(K))K.push(D);else{if(!K||"object"!=typeof K)return[K,D];(a&&(a.plainObjects||a.allowPrototypes)||!G.call(Object.prototype,D))&&(K[D]=!0)}return K}if(!K||"object"!=typeof K)return[K].concat(D);var W=K;return N(K)&&!N(D)&&(W=x(K,a)),N(K)&&N(D)?(D.forEach((function(D,N){if(G.call(K,N)){var W=K[N];W&&"object"==typeof W&&D&&"object"==typeof D?K[N]=t(W,D,a):K.push(D)}else K[N]=D})),K):Object.keys(D).reduce((function(K,N){var W=D[N];return G.call(K,N)?K[N]=t(K[N],W,a):K[N]=W,K}),W)}}},517116:(t,K,D)=>{var a=D(893776);function G(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var N=/^([a-z0-9.+-]+:)/i,W=/:[0-9]*$/,x=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,b=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),n=["'"].concat(b),e=["%","/","?",";","#"].concat(n),i=["/","?","#"],z=255,I=/^[+a-z0-9A-Z_-]{0,63}$/,Z=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,w={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},u={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},d=D(97976);function E(t,K,D){if(t&&"object"==typeof t&&t instanceof G)return t;var a=new G;return a.parse(t,K,D),a}G.prototype.parse=function(t,K,D){if("string"!=typeof t)throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var G=t.indexOf("?"),W=-1!==G&&G<t.indexOf("#")?"?":"#",b=t.split(W);b[0]=b[0].replace(/\\/g,"/");var E=t=b.join(W);if(E=E.trim(),!D&&1===t.split("#").length){var l=x.exec(E);if(l)return this.path=E,this.href=E,this.pathname=l[1],l[2]?(this.search=l[2],this.query=K?d.parse(this.search.substr(1)):this.search.substr(1)):K&&(this.search="",this.query={}),this}var Q=N.exec(E);if(Q){var P=(Q=Q[0]).toLowerCase();this.protocol=P,E=E.substr(Q.length)}if(D||Q||E.match(/^\/\/[^@/]+@[^@/]+/)){var y="//"===E.substr(0,2);!y||Q&&m[Q]||(E=E.substr(2),this.slashes=!0)}if(!m[Q]&&(y||Q&&!u[Q])){for(var q,X,h=-1,J=0;J<i.length;J++)-1!==(T=E.indexOf(i[J]))&&(-1===h||T<h)&&(h=T);for(-1!==(X=-1===h?E.lastIndexOf("@"):E.lastIndexOf("@",h))&&(q=E.slice(0,X),E=E.slice(X+1),this.auth=decodeURIComponent(q)),h=-1,J=0;J<e.length;J++){var T;-1!==(T=E.indexOf(e[J]))&&(-1===h||T<h)&&(h=T)}-1===h&&(h=E.length),this.host=E.slice(0,h),E=E.slice(h),this.parseHost(),this.hostname=this.hostname||"";var _="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!_)for(var C=this.hostname.split(/\./),H=(J=0,C.length);J<H;J++){var o=C[J];if(o&&!o.match(I)){for(var U="",V=0,s=o.length;V<s;V++)o.charCodeAt(V)>127?U+="x":U+=o[V];if(!U.match(I)){var F=C.slice(0,J),c=C.slice(J+1),g=o.match(Z);g&&(F.push(g[1]),c.unshift(g[2])),c.length&&(E="/"+c.join(".")+E),this.hostname=F.join(".");break}}}this.hostname.length>z?this.hostname="":this.hostname=this.hostname.toLowerCase(),_||(this.hostname=a.toASCII(this.hostname));var R=this.port?":"+this.port:"",A=this.hostname||"";this.host=A+R,this.href+=this.host,_&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==E[0]&&(E="/"+E))}if(!w[P])for(J=0,H=n.length;J<H;J++){var Y=n[J];if(-1!==E.indexOf(Y)){var L=encodeURIComponent(Y);L===Y&&(L=escape(Y)),E=E.split(Y).join(L)}}var S=E.indexOf("#");-1!==S&&(this.hash=E.substr(S),E=E.slice(0,S));var f=E.indexOf("?");if(-1!==f?(this.search=E.substr(f),this.query=E.substr(f+1),K&&(this.query=d.parse(this.query)),E=E.slice(0,f)):K&&(this.search="",this.query={}),E&&(this.pathname=E),u[P]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){R=this.pathname||"";var $=this.search||"";this.path=R+$}return this.href=this.format(),this},G.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var K=this.protocol||"",D=this.pathname||"",a=this.hash||"",G=!1,N="";this.host?G=t+this.host:this.hostname&&(G=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(G+=":"+this.port)),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(N=d.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var W=this.search||N&&"?"+N||"";return K&&":"!==K.substr(-1)&&(K+=":"),this.slashes||(!K||u[K])&&!1!==G?(G="//"+(G||""),D&&"/"!==D.charAt(0)&&(D="/"+D)):G||(G=""),a&&"#"!==a.charAt(0)&&(a="#"+a),W&&"?"!==W.charAt(0)&&(W="?"+W),K+G+(D=D.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(W=W.replace("#","%23"))+a},G.prototype.resolve=function(t){return this.resolveObject(E(t,!1,!0)).format()},G.prototype.resolveObject=function(t){if("string"==typeof t){var K=new G;K.parse(t,!1,!0),t=K}for(var D=new G,a=Object.keys(this),N=0;N<a.length;N++){var W=a[N];D[W]=this[W]}if(D.hash=t.hash,""===t.href)return D.href=D.format(),D;if(t.slashes&&!t.protocol){for(var x=Object.keys(t),b=0;b<x.length;b++){var n=x[b];"protocol"!==n&&(D[n]=t[n])}return u[D.protocol]&&D.hostname&&!D.pathname&&(D.pathname="/",D.path=D.pathname),D.href=D.format(),D}if(t.protocol&&t.protocol!==D.protocol){if(!u[t.protocol]){for(var e=Object.keys(t),i=0;i<e.length;i++){var z=e[i];D[z]=t[z]}return D.href=D.format(),D}if(D.protocol=t.protocol,t.host||m[t.protocol])D.pathname=t.pathname;else{for(var I=(t.pathname||"").split("/");I.length&&!(t.host=I.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==I[0]&&I.unshift(""),I.length<2&&I.unshift(""),D.pathname=I.join("/")}if(D.search=t.search,D.query=t.query,D.host=t.host||"",D.auth=t.auth,D.hostname=t.hostname||t.host,D.port=t.port,D.pathname||D.search){var Z=D.pathname||"",w=D.search||"";D.path=Z+w}return D.slashes=D.slashes||t.slashes,D.href=D.format(),D}var d=D.pathname&&"/"===D.pathname.charAt(0),E=t.host||t.pathname&&"/"===t.pathname.charAt(0),l=E||d||D.host&&t.pathname,Q=l,P=D.pathname&&D.pathname.split("/")||[],y=(I=t.pathname&&t.pathname.split("/")||[],D.protocol&&!u[D.protocol]);if(y&&(D.hostname="",D.port=null,D.host&&(""===P[0]?P[0]=D.host:P.unshift(D.host)),D.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===I[0]?I[0]=t.host:I.unshift(t.host)),t.host=null),l=l&&(""===I[0]||""===P[0])),E)D.host=t.host||""===t.host?t.host:D.host,D.hostname=t.hostname||""===t.hostname?t.hostname:D.hostname,D.search=t.search,D.query=t.query,P=I;else if(I.length)P||(P=[]),P.pop(),P=P.concat(I),D.search=t.search,D.query=t.query;else if(null!=t.search)return y&&(D.host=P.shift(),D.hostname=D.host,(T=!!(D.host&&D.host.indexOf("@")>0)&&D.host.split("@"))&&(D.auth=T.shift(),D.hostname=T.shift(),D.host=D.hostname)),D.search=t.search,D.query=t.query,null===D.pathname&&null===D.search||(D.path=(D.pathname?D.pathname:"")+(D.search?D.search:"")),D.href=D.format(),D;if(!P.length)return D.pathname=null,D.search?D.path="/"+D.search:D.path=null,D.href=D.format(),D;for(var q=P.slice(-1)[0],X=(D.host||t.host||P.length>1)&&("."===q||".."===q)||""===q,h=0,J=P.length;J>=0;J--)"."===(q=P[J])?P.splice(J,1):".."===q?(P.splice(J,1),h++):h&&(P.splice(J,1),h--);if(!l&&!Q)for(;h--;h)P.unshift("..");!l||""===P[0]||P[0]&&"/"===P[0].charAt(0)||P.unshift(""),X&&"/"!==P.join("/").substr(-1)&&P.push("");var T,_=""===P[0]||P[0]&&"/"===P[0].charAt(0);return y&&(D.hostname=_?"":P.length?P.shift():"",D.host=D.hostname,(T=!!(D.host&&D.host.indexOf("@")>0)&&D.host.split("@"))&&(D.auth=T.shift(),D.hostname=T.shift(),D.host=D.hostname)),(l=l||D.host&&P.length)&&!_&&P.unshift(""),P.length>0?D.pathname=P.join("/"):(D.pathname=null,D.path=null),null===D.pathname&&null===D.search||(D.path=(D.pathname?D.pathname:"")+(D.search?D.search:"")),D.auth=t.auth||D.auth,D.slashes=D.slashes||t.slashes,D.href=D.format(),D},G.prototype.parseHost=function(){var t=this.host,K=W.exec(t);K&&(":"!==(K=K[0])&&(this.port=K.substr(1)),t=t.substr(0,t.length-K.length)),t&&(this.hostname=t)},K.qg=E,K.hd=function(t,K){return E(t,!1,!0).resolve(K)},K.GP=function(t){return"string"==typeof t&&(t=E(t)),t instanceof G?t.format():G.prototype.format.call(t)}},686872:(t,K,D)=>{D.d(K,{j:()=>T});var a=D(64922),G=D(699695),N=D(377810),W=D(346160),x=D(146265);const b="decisionButton--0fb09",n="isStatic--d2bd5",e="gold--a2a29",i="isSmall--1f3bb",z="desktop--3d2d3",I="darkGoldWithStars--fc3a6",Z="isMobile--bcbbf",w="rngBankersOffer--a9ad2",m="decisionButtonWrapper--d596e",u="enlarged--877ef",d="buttonText--06f7a",E="fading--55640",l="active--3b845",Q="twoLineText--90018",P="withSpacing--db9cc",y={[x.l.Deal]:e,[x.l.Swap]:"grey--1ec8e",[x.l.NoDeal]:"darkGold--b8dd1",[x.l.Play]:e,[x.l.TopUp]:I},q={...y,[x.l.NoDeal]:I},X={[x.l.Deal]:"deal-button",[x.l.Swap]:"swap-button",[x.l.NoDeal]:"no-deal-button",[x.l.Play]:"play-button",[x.l.TopUp]:"top-up-button"};function h(t,K){switch(t){case x.l.Deal:return W.Tl("deal");case x.l.Swap:return K?W.Tl("switch"):W.Tl("switchBriefcase");case x.l.NoDeal:return W.Tl("noDeal");case x.l.Play:return W.Tl("play");case x.l.TopUp:return W.Tl("topUp")}}const J=[x.l.Deal,x.l.Swap,x.l.NoDeal,x.l.Play,x.l.TopUp];class T extends N.PureComponent{render(){const{active:t,fading:K,isMobile:D,isSmall:N,isEnlarged:W,isStatic:e,onClick:I,onMouseLeave:T,onMouseOver:_,type:C,isRng:H}=this.props,o=Math.max(...J.map((t=>t===x.l.Play||t===x.l.TopUp?0:h(t,N).length))),U=N?{width:`${.625*o}em`}:void 0,V=h(C,N),s=V.length>function(t,K,D){const a=9;return D&&K&&t===x.l.Swap?2*a:a}(C,H,D),F=H?q:y;return a.jsx("div",{"data-role":`${X[C]}-wrapper`,className:G.A(m,F[C],{[E]:K,[l]:t,[i]:N,[Z]:D,[z]:!D,[u]:W,[Q]:s,[P]:s&&C===x.l.NoDeal,[w]:H&&(C===x.l.NoDeal||C===x.l.Deal||C===x.l.Swap)}),style:U,children:a.jsx("button",{className:G.A(b,F[C],{[n]:e||N}),"data-role":`${X[C]}${N?"-small":""}`,onClick:I,onMouseOver:_,onMouseLeave:T,children:a.jsx("span",{className:d,children:V})})})}}},146265:(t,K,D)=>{var a;D.d(K,{l:()=>a}),function(t){t["Deal"]="Deal",t["Swap"]="Swap",t["NoDeal"]="NoDeal",t["Play"]="Play",t["TopUp"]="TopUp"}(a||(a={}))},25407:(t,K,D)=>{D.d(K,{Qn:()=>w,iX:()=>Z});var a=D(64922),G=D(699695),N=D(377810),W=D(686872),x=D(667012),b=D(464471),n=D(244160),e=D(787014),i=D(436794),z=D(146265);const I={decisionControls:"decisionControls--5acac",rng:"rng--b4378",mobile:"mobile--6e1b0",column:"column--e65d7",row:"row--dd6b2",landscape:"landscape--f1a53",fading:"fading--49f13",fadingKeyframes:"fadingKeyframes--39bf9"};var Z;(function(t){t["Row"]="row",t["Column"]="column"})(Z||(Z={}));class w extends N.Component{constructor(){super(...arguments),this.state={lastDecision:void 0,showSwapButton:!1},this.handleDeal=this.handleDecision.bind(this,n.PS.Deal),this.handleNoDeal=this.handleDecision.bind(this,n.PS.NoDeal),this.handleSwapBoxes=this.handleDecision.bind(this,n.PS.Swap)}static getDerivedStateFromProps(t){return t.decisionControlsStatus===n.jo.Visible&&void 0!==t.iteration?{showSwapButton:4===t.iteration}:t.decisionControlsStatus===n.jo.Hidden?{showSwapButton:!1}:null}shouldComponentUpdate(t,K){return this.props.iteration!==t.iteration||this.props.orientation!==t.orientation||this.props.decisionControlsStatus!==t.decisionControlsStatus||this.state.lastDecision!==K.lastDecision||this.state.showSwapButton!==K.showSwapButton}componentDidUpdate(t){t.decisionControlsStatus!==n.jo.Visible&&this.props.decisionControlsStatus===n.jo.Visible&&void 0!==this.props.iteration&&(this.props.logClientOfferShown({iteration:this.props.iteration,timeRemaining:this.props.timeRemaining}),this.setState({lastDecision:void 0})),t.decisionControlsStatus===n.jo.Visible&&this.props.decisionControlsStatus===n.jo.Fading&&void 0===this.state.lastDecision&&(this.setState({lastDecision:n.PS.NoDeal}),this.props.playDecisionSound(n.PS.NoDeal))}render(){const{lastDecision:t,showSwapButton:K}=this.state;return a.jsxs("div",{className:G.A(I.decisionControls,[I[this.props.direction||Z.Row]],{[I.landscape]:this.props.orientation===i.t.Landscape,[I.mobile]:this.props.isMobile,[I.fading]:void 0!==t,[I.rng]:this.props.isRng}),children:[a.jsx(W.j,{onClick:this.handleDeal,type:z.l.Deal,active:t===n.PS.Deal,fading:t&&t!==n.PS.Deal,isMobile:this.props.isMobile,isRng:this.props.isRng}),K&&a.jsx(W.j,{onClick:this.handleSwapBoxes,type:z.l.Swap,active:t===n.PS.Swap,fading:t&&t!==n.PS.Swap,isMobile:this.props.isMobile,isRng:this.props.isRng}),a.jsx(W.j,{onClick:this.handleNoDeal,type:z.l.NoDeal,active:t===n.PS.NoDeal,fading:t&&t!==n.PS.NoDeal,isMobile:this.props.isMobile,isRng:this.props.isRng})]})}handleDecision(t){void 0!==this.state.lastDecision||this.props.isDecisionMade||this.props.isDecisionAvailable&&!this.props.isDecisionAvailable()||(this.setState({lastDecision:t}),t!==n.PS.Deal&&this.props.playDecisionSound(t),void 0!==this.props.iteration&&this.props.decisionHandler(t,this.props.iteration))}}e.S((t=>({isDecisionMade:x.Ug(t),playDecisionSound:b.eY})))(w)},415452:(t,K,D)=>{D.d(K,{E:()=>l});var a=D(377810),G=D(282427),N=D(13799),W=D(244160),x=D(967810),b=D(12078),n=D(901577),e=D(562794),i=D(109543),z=D(837557);const I="30em",Z="25em",w="23em",m=375,u=340;var d=D(556392);const E=2e4;function l({isQualificationRound:t,elementRef:K,isLowBalance:D}){const l=G.d4(N.DB).onboardingDisabled(),[Q,P]=a.useState(!1),y=function({bubbleId:t,contentTranslationKey:K,elementRef:D,anchorPosition:W="TopCenter",position:d="TopCenter",withArrow:E,titleTranslationKey:l,showHintsOption:Q,bubbleWidth:P}){const y=n.O(),q=G.wA(),X=G.d4(x.Yq),h=G.d4(e.C8),J=G.d4(e.QV),T=X.onboardingBubbles[t],_=a.useRef(!1),C=a.useCallback((()=>{_.current&&(q(function(t){return(K,D)=>{const a=D();if(N.DB(a).onboardingDisabled())return;const G={...x.Yq(a).onboardingBubbles,[t]:!0};K(x.Ni(G)),K(i.eH(t))}}(t)),_.current=!1)}),[q,t]),H=a.useMemo((()=>{return{id:t,anchorPosition:W,bubbleData:{titleTranslationKey:l,contentTranslationKey:K,position:d,withArrow:E,onClose:C,showHintsOption:Q,bubbleWidth:(D=P,D||(z.DS.IS_PHONE?z.DS.getScreenSize().width<u?w:z.DS.getScreenSize().width<m?Z:I:void 0)),hintsButtonCallback:C}};var D}),[C,t,P,W,l,K,d,E,Q]);return b.w((()=>{D.current&&h&&!T&&_.current&&J===t&&y.onboardingBubbles.addOrUpdate({...H,element:D.current})})),a.useEffect((()=>{h||C()}),[h,C]),{show:a.useCallback((()=>{D.current&&h&&!T&&!_.current&&J!==t&&(y.onboardingBubbles.addOrUpdate({...H,element:D.current}),_.current=!0)}),[y,h,J,T,t,H,D,_]),remove:C}}({bubbleId:W.vI.Spin,contentTranslationKey:"onboarding.welcome",withArrow:!0,showHintsOption:!0,elementRef:K}),q=function(t=E){const K=G.d4(N.AZ),D=G.d4(d.wB),W=G.d4(e.C8),b=G.d4(x.Yq).dondSpinCounter,[n,i]=a.useState(!1),z=a.useRef(0),I=a.useRef(D?W:void 0);return a.useEffect((()=>{if(K&&D&&W)return 0===b?z.current=window.setTimeout((()=>{i(!0)}),t):i(!1),()=>clearTimeout(z.current)}),[K]),a.useEffect((()=>{b>0&&clearTimeout(z.current)}),[b]),a.useEffect((()=>{D&&(void 0===I.current&&(I.current=W),W!==I.current&&(clearTimeout(z.current),I.current=W,i(W)))}),[D,W]),n}();return a.useEffect((()=>{if(l||D||!q||!t)return y.remove(),void P(!1);y.show(),P(!0)}),[q,D,l,t,y]),Q}},382297:(t,K,D)=>{D.d(K,{Gj:()=>N,Wo:()=>G,Zn:()=>a,up:()=>x,z2:()=>W});const a="EvoRussoOne",G="normal",N=[.1,.2,.5,.7,1,2,3,5,8,10,12,15,20,25,50],W=[5,8,8,8,10,10,10,10,15,15,15,20,20,25,50],x=Math.PI/180},967810:(t,K,D)=>{D.d(K,{Dh:()=>l,Hi:()=>m,J0:()=>I,Ni:()=>E,QH:()=>Q,Yq:()=>Z,el:()=>a,uq:()=>P});var a,G=D(706809),N=D(244160),W=D(556392),x=D(499532),b=D(837557),n=D(717236),e=D(554267);(function(t){t["Default"]="default",t["Shown"]="shown",t["Hidden"]="hidden"})(a||(a={}));const i="dealnodeal",z={[N.vI.Spin]:!1},I=t=>({dondSpinCounter:{storageKey:n.$9({game:i,platform:"Common",key:"spinCounter",isRng:!!t}),isValidValue:t=>"number"==typeof t,getDefaultValue:()=>0},dondRingsPromoStatus:{storageKey:n.$9({game:i,platform:"Common",key:"ringsPromoStatus",isRng:!!t}),isValidValue:t=>Object.values(a).includes(t),getDefaultValue:()=>a.Default},dondInstantPromoStatus:{storageKey:n.$9({game:i,platform:"Common",key:"instantPromoStatus",isRng:!!t}),isValidValue:t=>Object.values(a).includes(t),getDefaultValue:()=>a.Default},dondInstantPromoShowedCount:{storageKey:n.$9({game:i,platform:"Common",key:"instantPromoShowedCount",isRng:!!t}),isValidValue:t=>"number"==typeof t,getDefaultValue:()=>0},dondQualificationCounter:{storageKey:n.$9({game:i,platform:"Common",key:"qualificationCounter",isRng:!!t}),isValidValue:t=>"number"==typeof t,getDefaultValue:()=>0},dondTopUpPressedCounter:{storageKey:n.$9({game:i,platform:"Common",key:"topUpPressedCounter",isRng:!!t}),isValidValue:t=>"number"==typeof t,getDefaultValue:()=>0},dondTopUpBoxChangedOnce:{storageKey:n.$9({game:i,platform:"Common",key:"topUpBoxChangedOnce",isRng:!!t}),isValidValue:t=>"boolean"==typeof t,getDefaultValue:()=>!1},dondFirstTimeUser:{storageKey:n.$9({game:i,platform:"Common",key:"firstTimeUser",isRng:!!t}),isValidValue:t=>"boolean"==typeof t,getDefaultValue:()=>!0},topUpBetAmount:{storageKey:n.$9({game:i,platform:"Common",key:"topUpBetAmount",isRng:!!t}),isValidValue:t=>"number"==typeof t&&t>0,getDefaultValue:()=>-1},speedMode:{storageKey:n.$9({game:i,platform:b.DS.PLATFORM,key:"speedMode",isRng:!!t}),isValidValue:t=>t===e.hR.Normal||t===e.hR.Fast,getDefaultValue:()=>e.hR.Normal},onboardingBubbles:{storageKey:n.$9({game:i,platform:"Common",key:"onboardingBubbles",isRng:!!t}),isValidValue:t=>G.A(t),getDefaultValue:()=>z}}),Z=t=>W.Yq(t),w=t=>x.$7(t),m=t=>w({key:"dondRingsPromoStatus",value:t}),u=t=>w({key:"dondQualificationCounter",value:t}),d=t=>w({key:"dondTopUpBoxChangedOnce",value:t}),E=t=>w({key:"onboardingBubbles",value:t});function l(){return(t,K)=>{t(u(Z(K()).dondQualificationCounter+1))}}function Q(){return t=>t(E(z))}function P(){return d(!0)}},356577:(t,K,D)=>{D.d(K,{i:()=>G});var a=D(133609);function G(t){return a.g(t)?[0,1,2,3]:[0,1,2]}},667012:(t,K,D)=>{function a(t){return t.playerActions.topBoxIndex}function G(t){return t.playerActions.topBoxEverChanged}function N(t){return t.playerActions.offerDecisionMade}D.d(K,{DI:()=>G,Ug:()=>N,Vo:()=>a})},433962:(t,K,D)=>{D.d(K,{R:()=>W,y:()=>x});var a=D(13799),G=D(346160),N=D(712011);function W(t,K){return b(t,!1,K)}function x(t,K){return b(t,!0,K)}function b(t,K,D){const W=a.DB(t);let x=K?"graphical_mobileLoadingScreen":"immersive_logo";if(D){const t=`${x}_${G.lr().iso.slice(0,2)}`;W.rawConfig[t]&&(x=t)}return N.d(W.rawConfig[x])||""}},9676:(t,K,D)=>{D.d(K,{W:()=>G});var a=D(13799);const G=D(523219).W0._extend((function(t){return{qualificationSpinMinBet:()=>Number(G.rawConfig.qualification_spin_min_bet)||1,qualificationSpinMaxBet:()=>Number(G.rawConfig.qualification_spin_max_bet)||1e3,qualificationTopUpMinBet:()=>Number(G.rawConfig.qualification_top_up_min_bet)||1,qualificationTopUpMaxBet:()=>Number(G.rawConfig.qualification_top_up_max_bet)||1e3,getQualificationVolumeMultiplier:()=>Number(G.rawConfig.qualification_volume_multiplier)||1,showBoxIndexesDuringQualification:()=>"true"===G.rawConfig.show_box_indexes_during_qualification,getMiddleReelStartDelay:()=>Number(G.rawConfig.middleReelStartDelay)||300,getOuterReelStartDelay:()=>Number(G.rawConfig.outerReelStartDelay)||300,getInnerReelSpinTime:()=>Number(G.rawConfig.innerReelSpinTime)||1600,getMiddleReelSpinTime:()=>Number(G.rawConfig.middleReelSpinTime)||500,getMiddleReelQualifyingSpinTime:()=>Number(G.rawConfig.middleReelQualifyingSpinTime)||700,getOuterReelSpinTime:()=>Number(G.rawConfig.outerReelSpinTime)||400,getOuterReelQualifyingSpinTime:()=>Number(G.rawConfig.outerReelQualifyingSpinTime)||800,getTopUpSpinTime:()=>Number(G.rawConfig.topUpSpinTime)||2e3,getHideOnAirTopUpPressedCount:()=>Number(G.rawConfig.hideOnAirTopUpPressedCount)||5,getHideOnAirQualificationCount:()=>Number(G.rawConfig.hideOnAirQualificationCount)||3,getVideoOverlayDesktopImage:()=>G.rawConfig.videoOverlayDesktopImage,getVideoOverlayMobileImage:()=>G.rawConfig.videoOverlayMobileImage,getRingsPromoMinSpinCount:()=>Number(G.rawConfig.rings_promo_min_spin_count)||3,instantQualificationEnabled:()=>"true"===G.rawConfig.instant_qualification,getRevealDelay:()=>Number(G.rawConfig.box_reveal_delay)||1500,breathingBoxEnabled:()=>"true"===G.rawConfig.breathing_box,getJoinPromoTime:()=>Number(G.rawConfig.join_promo_time)||5e3,getJoinPromoShowLimit:()=>Number(G.rawConfig.join_promo_show_limit)||3,dynamicWinAnimationEnabled:()=>"true"===G.rawConfig.enable_dynamic_win_animation||!1,testingApiEnabled:()=>"true"===G.rawConfig.e2e_test_api,onboardingDisabled:()=>"true"===G.rawConfig.disable_onboarding,bankerReminderInterval:()=>Number(G.rawConfig.banker_reminder_interval)||1e4,getGameAutoResolveTimeout:()=>Number(G.rawConfig.auto_resolve_wait_seconds)||20*60,getTopUpSpinLimit:()=>{const t=100,K=Number(G.rawConfig.topup_spin_limit)||t;return K>t?t:K},reduceSpinTimeDuringSpeedMode:()=>{const t=G.rawConfig.reduce_spin_time_during_speed_mode;return!t||"true"===t},getDecisionTime:()=>Number(G.rawConfig.decision_time)||2e4,lightSweepAnimationInterval:()=>Number(G.rawConfig.light_sweep_animation_interval)||6e3,nearWinDuration:()=>Number(G.rawConfig.near_win_duration)||3e3,nearWinAllowed:()=>"true"===G.rawConfig.near_win_allowed,fastModeDisabled:()=>"true"===G.rawConfig.disable_fast_mode}}));a.DB},189480:(t,K,D)=>{D.d(K,{Mz:()=>G,cQ:()=>N,yh:()=>a}),D(730960);const a="betParams/RINGS_BOUGHT_COUNT_UPDATED",G="betParams/QUALIFICATION_BET_AMOUNT_INDEX_UPDATED",N="betParams/TOP_UP_BET_AMOUNT_INDEX_UPDATED"},438020:(t,K,D)=>{D.d(K,{YE:()=>a});const a="wheel/SET_WHEEL_DEBUG_PROPS"},467380:(t,K,D)=>{D.d(K,{Eh:()=>b,RA:()=>x,sd:()=>e});var a=D(967810);D(356577),D(189480),D(13799),D(185214),D(346160);const G="playerActions/SET_TOP_BOX_INDEX",N="playerActions/SET_TOP_BOX_INTRO_ANIMATION_PLAYING",W="playerActions/WINNING_ANIMATION_STARTED";function x(t,K=!1,D=!1){return N=>{K&&N(a.uq()),N({type:G,payload:t,origin:D?"autoAdjust":void 0})}}function b(){return{type:W}}const n={topBoxIndex:16,topBoxChanged:!1,topBoxEverChanged:!1,hasReceivedSpinResponse:!1,topBoxIntroAnimationPlaying:!1,offerDecisionMade:!1};function e(t=n,K){switch(K.type){case G:return{...t,topBoxIndex:K.payload,topBoxChanged:!0,topBoxEverChanged:!0};case N:return{...t,topBoxIntroAnimationPlaying:K.payload,topBoxChanged:!1,topBoxEverChanged:!1};default:return t}}},434036:(t,K,D)=>{D.d(K,{Ak:()=>N,wr:()=>W});var a=D(764522),G=D(843717);function N(t,K=!1){a.play({src:t,loop:K,volumeGroup:G.ci.Default})}function W(t){a.stopAll(t)}},924958:(t,K,D)=>{var a,G;D.d(K,{t:()=>a}),function(t){t["WheelSpinning"]="SOUND_WHEEL_SPINNING",t["RingHit1"]="SOUND_RING_HIT1",t["RingHit2"]="SOUND_RING_HIT2",t["RingHit3"]="SOUND_RING_HIT3",t["RingMiss"]="SOUND_RING_MISS",t["WheelQualified"]="SOUND_WHEEL_QUALIFIED",t["BetIncrease"]="SOUND_BET_INCREASE",t["BetDecreases"]="SOUND_BET_DECREASE",t["RingsBoughtIncrease"]="SOUND_RINGS_BOUGHT_INCREASE",t["RingsBoughtDecrease"]="SOUND_RINGS_BOUGHT_DECREASE",t["RingBoughtTurn"]="SOUND_RING_BOUGHT_TURN",t["DefaultWheelSpin"]="SOUND_DEFAULT_WHEEL_SPIN",t["VaultDoorSemiOpen"]="VAULT_DOOR_SEMI_OPEN",t["VaultDoorOut"]="VAULT_DOOR_OUT",t["VaultDoorBackIn"]="VAULT_DOOR_BACK_IN",t["TopUpDoorIn"]="TOP_UP_DOOR_IN",t["TopUpDoorOut"]="TOP_UP_DOOR_OUT",t["TopUpWheelSpin"]="SOUND_TOP_UP_WHEEL_SPIN",t["TopUpCoins"]="SOUND_TOP_UP_COINS",t["RightBoxesEliminated"]="SOUND_RIGHT_BOXES_ELIMINATED",t["LeftBoxesEliminated"]="SOUND_LEFT_BOXES_ELIMINATED",t["FinalBoxReveal"]="SOUND_FINAL_BOX_REVEAL",t["YouWin"]="SOUND_YOU_WIN",t["Deal"]="SOUND_DEAL",t["NoDeal"]="SOUND_NO_DEAL",t["SwitchCase"]="SOUND_SWITCH_CASE",t["SelectBox"]="SOUND_SELECT_BOX"}(a||(a={})),function(t){t["Vault"]="MUSIC_VAULT",t["TopUp"]="MUSIC_TOP_UP",t["BankOffer"]="MUSIC_BANK_OFFER",t["Elimination"]="MUSIC_ELIMINATION",t["EliminationIdle"]="MUSIC_ELIMINATION_IDLE"}(G||(G={}))},464471:(t,K,D)=>{D.d(K,{Hi:()=>x,eY:()=>W});var a=D(924958),G=D(434036),N=D(244160);function W(t){G.Ak(function(t){return t===N.PS.Deal?a.t.Deal:t===N.PS.NoDeal||t===N.ni.TopUp||t===N.ni.Play?a.t.NoDeal:a.t.SwitchCase}(t))}function x(){G.Ak(a.t.YouWin)}},244160:(t,K,D)=>{var a,G,N,W,x;D.d(K,{Am:()=>W,Mi:()=>G,PS:()=>n,QZ:()=>N,Qc:()=>a,_Q:()=>Z,bk:()=>x,fg:()=>b,jo:()=>i,ni:()=>e,vI:()=>I}),function(t){t["QualificationRound"]="QualificationRound",t["EliminationRound"]="EliminationRound",t["DecisionRound"]="DecisionRound",t["GameResolved"]="GameResolved"}(a||(a={})),function(t){t["SpinAllowed"]="SpinAllowed",t["Qualified"]="Qualified",t["Participant"]="Participant",t["Decider"]="Decider",t["WaitForNextElimination"]="WaitForNextElimination",t["Winner"]="Winner",t["Looser"]="Looser",t["LeftGameObserver"]="LeftGameObserver",t["LeftGameWinner"]="LeftGameWinner",t["WaitForNextGame"]="WaitForNextGame"}(G||(G={})),function(t){t["Default"]="default",t["TopUp"]="topUp"}(N||(N={})),function(t){t["Default"]="default",t["Spinning"]="spinning",t["Finished"]="finished",t["Hidden"]="hidden"}(W||(W={})),function(t){t["Default"]="default",t["Spinning"]="spinning",t["Finished"]="finished",t["Increased"]="increased"}(x||(x={}));const b=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16];var n,e,i,z,I;function Z(t){return"4"===t}(function(t){t["Deal"]="Deal",t["NoDeal"]="NoDeal",t["Swap"]="Swap"})(n||(n={})),function(t){t["TopUp"]="TopUp",t["Play"]="Play"}(e||(e={})),function(t){t["Visible"]="Visible",t["Hidden"]="Hidden",t["Fading"]="Fading"}(i||(i={})),function(t){t["Spin"]="dealnodeal.spin",t["TopUp"]="dealnodeal.topUp",t["Decision"]="dealnodeal.decide",t["JoinQualification"]="dealnodeal.joinQualification"}(z||(z={})),function(t){t["Spin"]="Spin"}(I||(I={}))},466694:(t,K,D)=>{D.d(K,{s:()=>N});var a=D(382297),G=D(689940);function N(t=16,K=!1){var D,N,W;return(D=a.Gj,N=t-1,W=0,[...D.slice(0,N),W,...D.slice(N)]).reduce(((t,D,a)=>(t[G.W(a+1)]={value:D,eliminated:K},t)),{})}},186198:(t,K,D)=>{function a(t,K,D){const a=function(t,K){const D=K.match(/(,|\.)/g),a=K.match(/(k|K|M|m|\+)/g),G=null!==a?a.length:0,N=null!==D?D.length:0,W=K.length-N,x=K.split(".").length-1;return W+(3!==t.length||1!==x||1!==N||G?Math.floor(N/2):N)+t.length+1}(t,K);return a>D?D/a:1}D.d(K,{M:()=>a})},695620:(t,K,D)=>{D.d(K,{AO:()=>x,cQ:()=>W,fE:()=>b});var a=D(221770),G=D(587698),N=D(584698);function W(t){return t>999999||t%1>0&&t>9999}function x(t){return W(t)?`${a.i(t)}`:`${G.ej(t)}`}function b(t){return N.GP(new Date(t),"M:ss",!0)}},689940:(t,K,D)=>{function a(t){return function(t){return t>=1&&t<=16}(t)?t:t>16?16:1}D.d(K,{W:()=>a})},733780:(t,K,D)=>{D.d(K,{m:()=>G});var a=D(382297);function G(t=1){return a.z2.map((K=>K*t))}},540323:(t,K,D)=>{function a(t){return t%1!=0}D.d(K,{n:()=>a})},133609:(t,K,D)=>{D.d(K,{g:()=>G});var a=D(13799);function G(t){return a.DB(t).instantQualificationEnabled()}},641286:(t,K,D)=>{function a(t,K){const D=parseFloat(String(t));return Number.isNaN(D)?K:D}function G(t,K,D=10){const a=parseInt(String(t),D);return Number.isNaN(a)?K:a}D.d(K,{Q:()=>G,R:()=>a})},12078:(t,K,D)=>{D.d(K,{w:()=>N});var a=D(377810),G=D(886490);function N(t){a.useEffect((()=>{if(t)return G.w9(t)}),[t])}},923148:(t,K,D)=>{function a(t){return new Promise((K=>{setTimeout((()=>K()),t)}))}D.d(K,{u:()=>a})},653086:(t,K,D)=>{D.d(K,{m:()=>m});var a=D(64922),G=D(699695),N=D(377810),W=D(977927),x=D(436794);const b="bonusIntro--190b3",n="background--2f1df",e="portrait--b65d0",i="logoScaleContainer--6b76b",z="logoPerspectiveContainer--137fa",I="logo--c2972",Z="gradientContainer--2ff67",w="visible--3c0de",m=N.memo((({visible:t,orientation:K,logo:D})=>{const m={backgroundImage:`url("${D}")`};return N.useEffect((()=>{if(!t)return;W.A("TopUpEnd");const K=setTimeout((()=>{W.A("DondEnter")}),750);return()=>clearTimeout(K)}),[t]),a.jsxs("div",{className:G.A(b,{[w]:t}),children:[a.jsx("div",{className:G.A(n,{[e]:K===x.t.Portrait})}),a.jsx("div",{className:i,children:a.jsx("div",{className:z,children:a.jsx("div",{style:m,className:G.A(I,{[e]:K===x.t.Portrait})})})}),a.jsx("div",{className:Z})]})}));m.displayName="BonusIntro"},572914:(t,K,D)=>{D.d(K,{R:()=>X});var a=D(64922),G=D(699695),N=D(282427),W=D(170877);const x="gameMessage--395b0",b="narrowTitleBackground--93f70",n="phone--768a2",e="tablet--eb8b9",i="titleGradient--28250",z="title--5aa67",I="subTitleGradient--0aefc",Z="subTitle--76cfd";function w(t){const{title:K,subTitle:D,platform:N,className:w,narrowTitleBackground:m=!1}=t;return a.jsxs("div",{className:G.A(x,w,{[n]:N===W.OD.Phone,[e]:N===W.OD.Tablet,[b]:m}),children:[a.jsx("div",{className:i,children:a.jsx("div",{className:z,children:K})}),D&&a.jsx("div",{className:I,children:a.jsx("div",{className:Z,children:D})})]})}var m=D(872496),u=D(41553),d=D(13799);const E="congratulationMessage--1d272",l="desktop--612dd",Q="mobile--c26da",P="visible--42a9e",y=200,q=u.e(y)((({visible:t,platform:K})=>a.jsx("div",{"data-role":"game-message-wrapper",className:G.A(E,{[P]:t,[l]:K===W.OD.Desktop}),style:{"--disappearDuration":`${y}ms`},children:a.jsx(w,{className:K===W.OD.Desktop?l:Q,platform:K,title:m.T("congratulations"),subTitle:m.T("topUpMessage")})}))),X=t=>{const K=N.d4(d.md);return a.jsx(q,{platform:K,...t})}},873666:(t,K,D)=>{D.d(K,{c:()=>w});var a=D(64922),G=D(699695),N=D(282427),W=D(950535),x=D(909670),b=D(454342),n=D(457626);const e="qualifiedPlayers--72ec0",i="icon--2e04d",z="playerCount--1cef0",I="qualifiedText--c2d68",Z=({playerCount:t,className:K})=>{const D={width:`${t.toString().length}ch`};return a.jsxs("div",{className:G.A(e,K),children:[a.jsx("div",{className:G.A(i),children:a.jsx(x.c,{})}),a.jsx("div",{className:G.A(z),style:D,children:a.jsx(W.q,{count:t})}),a.jsx("div",{className:i,children:a.jsx(b.a,{})}),a.jsx("div",{className:I,children:"Qualified"})]})},w=({className:t})=>{const K=N.d4(n.a);return a.jsx(Z,{className:t,playerCount:K})}},457626:(t,K,D)=>{function a(t){return t.qualifiedPlayersCount}D.d(K,{a:()=>N,x:()=>G});const G=D(160739).Mz(a,(t=>t>0)),N=a},324978:(t,K,D)=>{D.d(K,{S:()=>NK});var a=D(64922),G=D(699695),N=D(377810),W=D(282427),x=D(866302),b=D(241665),n=D(872496),e=D(232737),i=D(901577),z=D(755073),I=D(715907),Z=D(235874),w=D(327299);const m="pageControl--daa97",u="phone--25d7e",d="tablet--2bf9c",E="pageControlItem--f2c22",l="selected--a93cf",Q=({selected:t,index:K,isPhone:D,isTablet:W,onClick:x})=>{const b=N.useCallback((()=>{x(K)}),[x,K]);return a.jsx("div",{onClick:b,className:G.A(E,{[l]:t,[u]:D,[d]:W})})},P=({current:t,total:K,isPhone:D,isTablet:N,onClick:W})=>{const x=[];for(let G=0;G<K;G++)x.push(a.jsx(Q,{index:G,selected:G===t,isPhone:D,isTablet:N,onClick:W},G));return a.jsx("div",{className:G.A(m,{[u]:D,[d]:N}),children:x})},y={customizableButton:{customizable:{mainLight:{gradient:"linear-gradient(rgb(29, 39, 51) 0%, rgba(255, 255, 255, 0) 100%)",gradientDisabled:"linear-gradient(rgba(255, 255, 255, 0.2) 0%, rgba(139, 63, 58) 100%)"},midBody:{strokeColor:"linear-gradient(rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.3) 100%)",strokeColorActivated:"linear-gradient(180deg, rgb(29, 39, 51) 0%, rgb(87, 117, 153) 100%;",gradient:"linear-gradient(rgb(29, 39, 51) 0%, rgb(0, 0, 0) 100%)",gradientActivated:"#2C3C4E",gradientDisabled:"linear-gradient(rgb(249, 162, 114) 0%, rgb(139, 63, 58) 100%)"},border:{baseBorderGradient:"linear-gradient(rgb(248, 227, 155) 0%, rgb(239, 197, 88) 25%, rgb(248, 227, 155) 50%, rgb(239, 197, 88) 75%, rgb(135, 106, 39) 100%"}}}},q="controls--9c209",X="buttonContainer--bb5d8",h="phone--9caf7",J="tablet--0fa94",T="playButton--8291e",_="splash-screen-navigate-forward",C="splash-screen-navigate-backward",H="splash-screen-play",o=t=>{const{currentIndex:K,sectionsCount:D,setCurrentIndex:W,onPlayClick:x,isDesktop:b,isPhone:n,isTablet:e}=t,i=N.useCallback((()=>{W(0===K?D-1:K-1)}),[K,D,W]),z=N.useCallback((()=>{W(K===D-1?0:K+1)}),[K,D,W]);return a.jsxs("div",{className:q,children:[a.jsx(P,{current:K,total:D,isPhone:n,isTablet:e,onClick:W}),a.jsxs("div",{className:G.A(X,{[h]:n,[J]:e}),children:[a.jsx(I.$,{role:C,onClick:i,iconComponent:a.jsx(Z.M,{}),size:b?"M":"S",layerStyles:y.customizableButton}),a.jsx("div",{className:T,children:a.jsx(I.$,{role:H,onClick:x,label:"button.playNow.uppercase",size:b?"M":"S",fitWidth:!0,labelPosition:"Inside",layerStyles:y.customizableButton})}),a.jsx(I.$,{role:_,onClick:z,iconComponent:a.jsx(w.x,{}),size:b?"M":"S",layerStyles:y.customizableButton})]})]})},U=D.p+"images/page1logo.2c7425be.webp",V="page1--53aee",s="logoImg--c05db",F="phone--10517",c="tablet--c0099",g=({isPhone:t,isTablet:K})=>a.jsx("div",{className:G.A(V,{[F]:t,[c]:K}),children:a.jsx("img",{className:s,src:U})}),R="pageNameTextWrapper--2ce23",A="pageNameTextFill--dda28",Y="titleTextWrapper--64f33",L="titleTextFill--4cab0",S="descriptionTextWrapper--f0ecf",f="descriptionTextFill--8e399",$=({text:t,className:K})=>a.jsx("div",{className:G.A(R,K),children:a.jsx("span",{className:A,children:t})}),B=({text:t,className:K})=>a.jsx("div",{className:G.A(Y,K),children:a.jsx("span",{className:L,children:t})}),O=({text:t,className:K})=>a.jsx("div",{className:G.A(S,K),children:a.jsx("span",{className:f,children:t})}),v=D.p+"images/page23scat.9607648d.webp",p=D.p+"images/page2bonus.865f3249.webp",j=D.p+"images/page2casea.c8e8d8db.webp",r=D.p+"images/page2textb.c0c17e7b.webp",M=D.p+"images/page2textb.63067dc3.webp",k=D.p+"images/page2textb.b022ba2a.webp",tt=D.p+"images/page2textb.780f4e44.webp",Kt=D.p+"images/page2wheel.fe5df405.webp",Dt="page2--f7c7b",at="container--73969",Gt="phone--10ac5",Nt="tablet--d4f8e",Wt="element12--fb87b",xt="desktop--41b51",bt="element3--e39b5",nt="img--3ca43",et="scatters--9afae",it="wheel--21966",zt="caseAndPhone--4f7ec",It="bonus--9a580",Zt="titleText--ea1f4",wt="descriptionText--d5515",mt=({isDesktop:t,isPhone:K,isTablet:D})=>a.jsx("div",{className:G.A(Dt,{[xt]:t,[Gt]:K,[Nt]:D}),children:a.jsxs("div",{className:at,children:[a.jsxs("div",{className:Wt,children:[a.jsx("img",{className:nt,src:K?M:r}),a.jsx("img",{className:et,src:v}),a.jsx(B,{text:`1. ${n.T("splashScreen.page2.part1")}`,className:Zt}),a.jsx(O,{text:n.T("splashScreen.page2.info1"),className:wt})]}),a.jsxs("div",{className:Wt,children:[a.jsx("img",{className:nt,src:K?M:r}),a.jsx("img",{className:it,src:Kt}),a.jsx(B,{text:`2. ${n.T("splashScreen.page2.part2")}`,className:Zt}),a.jsx(O,{text:n.T("splashScreen.page2.info2"),className:wt})]}),a.jsxs("div",{className:bt,children:[a.jsx("img",{className:nt,src:K?tt:k}),a.jsx("img",{className:zt,src:j}),a.jsx(B,{text:`3. ${n.T("splashScreen.page2.part3")}`,className:Zt}),a.jsx(O,{text:n.T("splashScreen.page2.info3"),className:wt}),a.jsx("img",{className:It,src:p})]})]})});var ut=D(816340);const dt=D.p+"images/page3symbo.17812e32.webp",Et=D.p+"images/page3textb.e691b5d0.webp",lt=D.p+"images/page3textb.9d2b27f0.webp",Qt=D.p+"images/page3xxxtr.30712167.webp",Pt="page3--6a476",yt="xxxtreme--0d7d7",qt="phone--83bda",Xt="tablet--ca3e9",ht="container--b5d25",Jt="element--cec13",Tt="img--60824",_t="desktop--2ce85",Ct="symbols--0ac77",Ht="scatters--52c70",ot="titleText--ca17d",Ut="descriptionText--1f3c4",Vt=({isDesktop:t,isPhone:K,isTablet:D})=>{const N=W.d4(ut.F);return a.jsxs("div",{className:G.A(Pt,{[_t]:t,[qt]:K,[Xt]:D}),children:[a.jsx("img",{className:yt,src:Qt}),a.jsxs("div",{className:ht,children:[a.jsxs("div",{className:Jt,children:[a.jsx("img",{className:Tt,src:Et}),a.jsx("img",{className:Ct,src:dt}),a.jsx(B,{text:n.T("splashScreen.page3.part1"),className:ot}),a.jsx(O,{text:n.T("splashScreen.page3.info1"),className:Ut})]}),!N&&a.jsxs("div",{className:Jt,children:[a.jsx("img",{className:Tt,src:lt}),a.jsx("img",{className:Ht,src:v}),a.jsx(B,{text:n.T("splashScreen.page3.part2"),className:ot}),a.jsx(O,{text:n.T("splashScreen.page3.info2"),className:Ut})]})]})]})},st=D.p+"images/page4symbo.37974cb7.webp",Ft=D.p+"images/page4symbo.77d8efcb.webp",ct="page4--16b0f",gt="symbolWins--4ab85",Rt="phone--8fb12",At="tablet--5396d",Yt=({isPhone:t,isTablet:K})=>a.jsx("div",{className:G.A(ct,{[Rt]:t,[At]:K}),children:a.jsx("img",{className:gt,src:t?Ft:st})}),Lt=D.p+"images/page5arrow.4600659a.webp",St=D.p+"images/page5winli.0819fcc9.webp",ft=D.p+"images/page5winli.b2fbf207.webp",$t="page5--a2f01",Bt="container--28486",Ot="winLines--2db35",vt="phone--332d0",pt="tablet--8b7bc",jt="descriptionText--7c662",rt="arrow--6166d",Mt=({isPhone:t,isTablet:K})=>a.jsx("div",{className:G.A($t,{[vt]:t,[pt]:K}),children:a.jsxs("div",{className:Bt,children:[a.jsx("img",{className:Ot,src:t?ft:St}),a.jsx(O,{text:n.T("splashScreen.page5.info"),className:jt}),a.jsx("img",{className:rt,src:Lt})]})});var kt=D(686123),tK=D(980168);const KK=D.p+"images/background.a8e8f430.webp",DK=D.p+"images/background.657e2220.webp",aK={splashScreen:"splashScreen--5a24f",hidden:"hidden--638b9",backgroundImageContainer:"backgroundImageContainer--3b21f",blurredBackground:"blurredBackground--3e335",backgroundImage:"backgroundImage--4dfbe",swipeContainer:"swipeContainer--a0c7f",item:"item--95c46",pageNameText:"pageNameText--23f9d",phone:"phone--96aee",tablet:"tablet--3ed37",controlsWrapper:"controlsWrapper--13124"};function GK(t){return n.T(`splashScreen.${t}.title`)}function NK({gamePhase:t,isDesktop:K=!1,isPhone:D=!1,isTablet:n=!1}){const I=W.d4(kt.P$),Z=W.d4(kt.kR),w=W.d4(kt.Q9),[m,u]=function(t){const K=i.O(),[D,a]=N.useState(K.preferences.getObservable(t).value);return N.useEffect((()=>(K.preferences.getObservable(t).subscribe(a,!1),()=>{K.preferences.getObservable(t).unsubscribe(a)})),[]),[D,D=>{a(D),K.preferences.setPreferences({key:t,value:D})}]}("dondFirstTimeUser"),[d,E]=N.useState(0),{log:l}=i.O(),Q=e.y(tK.G),P=N.useCallback((()=>{Q(),u(!1)}),[Q,m]),y=I&&(Z||m),q=N.useCallback((K=>{l(b.Mk({screenFrom:w[d],screenTo:w[K],gamePhase:t})),E(K)}),[d,t,l]);N.useEffect((()=>{l(b.Mk({closedBy:y?void 0:"Play",gamePhase:t}))}),[t,l,y]);const X=N.useMemo((()=>w.map((t=>{const G=function(t){switch(t.page){case"page1":return a.jsx(g,{...t});case"page2":return a.jsx(mt,{...t});case"page3":return a.jsx(Vt,{...t});case"page4":return a.jsx(Yt,{...t});case"page5":return a.jsx(Mt,{...t})}}({page:t,isDesktop:K,isPhone:D,isTablet:n});return a.jsxs("div",{className:aK.item,children:[a.jsx($,{text:GK(t),className:aK.pageNameText}),G]},t)}))),[K,D,n]),h=a.jsx("div",{className:aK.controlsWrapper,children:a.jsx(o,{currentIndex:d,setCurrentIndex:q,sectionsCount:w.length,onPlayClick:P,isDesktop:K,isPhone:D,isTablet:n})});return y?a.jsxs("div",{className:G.A(aK.splashScreen,{[aK.hidden]:!y,[aK.phone]:D,[aK.tablet]:n}),children:[a.jsx("div",{className:G.A(aK.backgroundImageContainer,{[aK.blurredBackground]:0!==d}),children:a.jsx("img",{className:aK.backgroundImage,src:D?DK:KK})}),a.jsx("div",{className:aK.swipeContainer,children:a.jsx(x.A,{style:{height:"100%",width:"100%"},containerStyle:{height:"100%",width:"100%"},axis:"x",enableMouseEvents:!0,index:d,resistance:!0,onChangeIndex:q,children:X})}),K?h:a.jsx(z.MobileSafeContainerConnected,{isRng:!1,children:h})]}):null}NK.displayName="SplashScreen"},980168:(t,K,D)=>{D.d(K,{G:()=>N,l:()=>G});var a=D(711582);function G(){return t=>{t(a.c(!0))}}function N(){return t=>{t(a.c(!1))}}},711582:(t,K,D)=>{D.d(K,{c:()=>G,g:()=>N});const a={isSplashScreenVisible:!1};function G(t){return{type:"SplashScreen/SET_IS_SPLASH_SCREEN_VISIBLE",payload:t}}function N(t=a,K){return"SplashScreen/SET_IS_SPLASH_SCREEN_VISIBLE"===K.type?{...t,isSplashScreenVisible:K.payload}:t}},686123:(t,K,D)=>{D.d(K,{Q9:()=>n,P$:()=>b,kR:()=>x});var a=D(160739),G=D(816340),N=D(13799);const W=["page1","page2","page3","page4","page5"],x=a.Mz((function(t){return t.splashScreen}),(t=>t.isSplashScreenVisible)),b=a.Mz(N.DB,(t=>{var K;return"true"===(null===(K=null==t?void 0:t.rawConfig)||void 0===K?void 0:K.splash_screen_available)})),n=a.Mz(G.K,(t=>t?W:W.filter((t=>"page3"!==t))))},536144:(t,K,D)=>{D.d(K,{xm:()=>Z,IT:()=>m,t$:()=>w,Lu:()=>z,BZ:()=>I,Mx:()=>e});var a=D(302607),G=D(160739),N=D(410878);function W(t){return t.dondWinnersList}const x=G.Mz(W,(t=>t.list)),b=G.Mz(N.GH,x,W,((t,K,{canShow:D})=>"no"!==D&&("yes"===D||K.filter((t=>"winner"===t.type)).map((({screenName:t})=>t)).includes(t))));var n=D(838930);function e(t){return(K,D)=>{K(a.Rq(t)),K(n.v()),b(D())&&K(i())}}function i(){return async(t,K,{getAG:D})=>{const a=D(),G=x(K());a.winnersList.hidden.value&&a.winnersList.setWinners(G)}}function z(){return async(t,K,{getAG:D})=>{D().winnersList.hide(),t(a.Rq([]))}}function I(){return async t=>{t(a.Rq([])),t(a.CZ("yes"))}}function Z(){return async t=>{t(a.CZ("yes")),t(i())}}function w(){return async t=>{t(a.CZ("no")),t(z())}}function m(){return async(t,K)=>{t(a.CZ("only_if_player_in_list")),b(K())&&t(i())}}},302607:(t,K,D)=>{D.d(K,{CZ:()=>N,Rq:()=>G,tO:()=>W});const a={list:[],canShow:"only_if_player_in_list"};function G(t){return{type:"winnersList/SET_WINNERS_LIST",list:t}}function N(t){return{type:"winnersList/SET_CAN_SHOW",value:t}}function W(t=a,K){switch(K.type){case"winnersList/SET_WINNERS_LIST":return{...t,list:K.list};case"winnersList/SET_CAN_SHOW":return{...t,canShow:K.value};default:return t}}},838930:(t,K,D)=>{D.d(K,{F:()=>N,v:()=>G});const a="winnersList/signal/WINNERS_LIST_WAS_UPDATED";function G(){return{type:a}}function N(t){return"object"==typeof t&&null!==t&&"type"in t&&t["type"]===a}},27640:(t,K,D)=>{D.d(K,{E:()=>E});var a=D(64922),G=D(699695),N=D(41553),W=D(587698),x=D(196443),b=D(186198);const n=1.8,e=13,i="amountMessage--56d06",z="withLight--d7534",I="visible--930eb",Z="title--19c24",w="amount--06feb",m="lightContainer--dfad1",u="light--268c7",d=D.p+"images/light.00f85fdc.png",E=N.e(x.c)((({visible:t,currency:K,amount:D,title:N,amountDataRole:E,withLight:l=!1})=>{const Q=K&&void 0!==D?function(t,K){const D=W.ej(K),a=b.M(t,D,e);return{fontSize:`${n*a}em`}}(K,D):{};return a.jsxs("div",{"data-role":"winning-message",className:G.A(i,{[I]:t,[z]:l}),style:{"--disappearDuration":`${x.c}ms`,"--appearDuration":`${x.W}ms`},children:[a.jsx("div",{className:Z,children:N}),a.jsx("dl",{className:w,"data-role":E,style:Q,children:a.jsx("dd",{children:void 0!==D&&W.ej(D,{currencySymbol:K})})}),l&&a.jsx("div",{className:m,children:a.jsx("img",{src:d,alt:"light",className:u})})]})}))},2809:(t,K,D)=>{D.d(K,{q:()=>_});var a=D(64922),G=D(282427),N=D(872443),W=D(555405),x=D(872496),b=D(27640),n=D(699695),e=D(377810),i=D(41553),z=D(436794),I=D(196443);const Z=D.p+"images/bubble.aff94830.png",w=D.p+"images/star.f7b0c8f0.svg",m="container--97eea",u="portrait--4b26e",d="visible--07413",E="countDownLine--8f98a",l="countDownLineForeground--62a15",Q="countDownLineBackground--ee3e6",P="progressWrapper--52dbc",y="countDownTooltip--ea183",q="bg--58a74",X="label--e353b",h="star--de986",J=i.e(I.c)((({visible:t,startTime:K,decisionTime:D,orientation:G,remainingPercent:N})=>{const[W,x]=e.useState(!1),b=e.useRef(null),i=e.useRef(null),J=e.useRef(null),T=e.useRef(null),_=e.useRef(null);return e.useEffect((()=>{let t;const a=()=>{t&&window.cancelAnimationFrame(t);const G=Date.now()-K;let W,n;if(void 0!==N?(W=N/100,n=D*W):(n=Math.max(D-G,0),W=n/D),b.current){const t=100*W;b.current.style.width=`${t}%`}if(i.current){const t=100*(1-W);i.current.style.width=`${t}%`}if(J.current){const t=100*W;J.current.style.left=`${t}%`}if(T.current){const t=Math.ceil(n/1e3);T.current.innerHTML=String(t)}if(_.current){const t=360*((D-n)/1e3);_.current.style.transform=`translate(-50%, -50%) rotate(${t}deg)`}n>0&&void 0===N&&(t=window.requestAnimationFrame(a)),n<I.c&&x(!0),0===n&&t&&(t=void 0)};return a(),()=>{t&&cancelAnimationFrame(t)}}),[D,N,K]),a.jsxs("div",{className:n.A(m,{[u]:G===z.t.Portrait,[d]:t&&!W}),style:{"--disappearDuration":`${I.c}ms`,"--appearDuration":`${I.W}ms`},children:[a.jsxs("div",{className:E,children:[a.jsx("div",{className:l,ref:b}),a.jsx("div",{className:Q,ref:i})]}),a.jsxs("div",{className:P,ref:J,children:[a.jsx("img",{className:n.A(h),src:w,ref:_}),a.jsxs("div",{className:y,children:[a.jsx("img",{src:Z,className:q}),a.jsx("span",{ref:T,className:X})]})]})]})})),T=({visible:t,offer:K,currency:D,decisionTime:G,countdownStartTime:N,orientation:W,countdownRemainingPercent:n})=>a.jsxs("div",{children:[a.jsx(b.E,{title:x.T("bankersOffer"),currency:D,amount:K,amountDataRole:"bankers-offer-decision-amount",visible:t}),a.jsx(J,{visible:t,startTime:N,decisionTime:G,orientation:W,remainingPercent:n})]}),_=t=>{const K=G.d4(W.E9),D=G.d4(W.LF),x=G.d4(N.o2),b=G.d4(W.US),n=G.d4(W.Z6);return a.jsx(T,{...t,visible:K,offer:D,currency:x,decisionTime:b,countdownStartTime:n})}},160163:(t,K,D)=>{D.d(K,{g:()=>I});var a=D(64922),G=D(282427),N=D(232737),W=D(555405),x=D(712787),b=D(912986),n=D(25407),e=D(244160),i=D(436794);const z=({isMobile:t=!1,orientation:K=i.t.Portrait,direction:D=n.iX.Row,decisionControlsStatus:G,decisionHandler:N,showSwapButton:W,isDecisionMade:x})=>G===e.jo.Hidden?null:a.jsx(n.Qn,{isMobile:t,orientation:K,direction:D,decisionControlsStatus:G,decisionHandler:N,iteration:W?4:1,isDecisionMade:x,logClientOfferShown:b.A,playDecisionSound:b.A}),I=t=>{const K=G.d4(W.Ug),D=G.d4(W.Sz),b=G.d4(W.tZ),n=N.y(x.Zc);return a.jsx(z,{...t,decisionControlsStatus:b,decisionHandler:n,showSwapButton:D,isDecisionMade:K})}},719315:(t,K,D)=>{D.d(K,{Z:()=>B});var a=D(64922),G=D(282427),N=D(901577),W=D(872443),x=D(170877),b=D(699695),n=D(146265),e=D(686872),i=D(695620),z=D(950535);const I="decision--6199e",Z="playerCount--1198b",w="mobile--aabbb",m="decisionAmount--e9073",u="isSingleDigitCurrency--5dd5a",d="dots--1aa94",E="dot--c28e3",l="userIcon--eeaef",Q="buttonWrapper--c786e",P={Deal:n.l.Deal,Switch:n.l.Swap,NoDeal:n.l.NoDeal},y=({type:t,decisionInfo:K,currency:D,isMobile:G=!1})=>a.jsxs("div",{className:b.A(I,{[w]:G}),children:[a.jsx("div",{className:Z,children:a.jsx(z.q,{count:K.playersCount||0})}),a.jsx("div",{className:l}),a.jsx("div",{className:Q,children:a.jsx(e.j,{type:P[t],isSmall:!0})}),a.jsxs("div",{className:b.A(m,{[u]:1===D.length}),children:[D," ",K.winAmount?`${i.AO(K.winAmount)}`:a.jsxs("div",{className:d,children:[a.jsx("div",{className:E}),a.jsx("div",{className:E}),a.jsx("div",{className:E}),a.jsx("div",{className:E})]})]})]},`decision-players-${t}`);var q=D(377810);const X=2e3;function h(t,K){const[D,a]=q.useState(t);return q.useEffect((()=>{if(!K){const t=setTimeout((()=>{a({})}),X);return()=>clearTimeout(t)}a(t)}),[t,K]),D}const J="desktopDecisionPlayers--c59a5",T="decision--4e78b",_="deal--25d98",C="noDeal--31663",H="swap--12aa4",o="hidden--e93be",U=({decisionsPlayers:t,isVisible:K,currency:D})=>{const G=h(t,K);return 0!==Object.keys(G).length||K?a.jsx("div",{className:J,children:Object.entries(G).map((([t,G])=>a.jsx("div",{className:b.A(T,{[o]:!K,[_]:"Deal"===t,[C]:"NoDeal"===t,[H]:"Switch"===t}),children:a.jsx(y,{type:t,decisionInfo:G,currency:D})},t)))}):null},V=1500,s={Deal:"NoDeal",NoDeal:"Switch",Switch:"Deal"},F=-1;const c="MobileDecisionPlayers--cb27e",g="decision--9131d",R="active--d5db6",A="alignRight--8f4c6",Y=({decisionsPlayers:t,isVisible:K,currency:D,alignRight:G})=>{const N=h(t,K),W=Object.keys(N),x=function(t){var K;const D=q.useRef(Object.keys(t)),[a,G]=q.useState(null!==(K=D.current[0])&&void 0!==K?K:"Deal"),N=q.useRef(F),W=q.useCallback((()=>{N.current!==F&&clearInterval(N.current),N.current=setInterval((()=>{G((t=>function(t,K){if(0===K.length)return t;let D=t;for(;1;)if(D=s[D],K.includes(D))return D}(t,D.current)))}),V)}),[]);return q.useEffect((()=>{const K=D.current.length;D.current=Object.keys(t),0===K&&0!==D.current.length&&(G(D.current[0]),W())}),[t,W]),q.useEffect((()=>(W(),()=>clearInterval(N.current))),[W]),a}(t);return 0===W.length?null:a.jsx("div",{className:c,children:Object.entries(t).map((([t,N])=>a.jsx("div",{className:b.A(g,{[R]:K&&x===t,[A]:G}),children:a.jsx(y,{type:t,decisionInfo:N,currency:D,isMobile:!0})},t)))})};var L=D(160739);function S(t){return t.decisionPlayers}const f=L.Mz(S,(t=>t.decisions)),$=L.Mz(S,(t=>t.visible)),B=()=>{const{platform:t}=N.O(),K=G.d4(W.o2),D=G.d4(f),b=G.d4($);return t===x.OD.Desktop?a.jsx(U,{decisionsPlayers:D,isVisible:b,currency:K}):a.jsx(Y,{decisionsPlayers:D,isVisible:b,currency:K,alignRight:t===x.OD.Tablet})}},222456:(t,K,D)=>{D.d(K,{Bz:()=>x,a0:()=>W,fP:()=>N,uA:()=>G});var a=D(313085);function G(t){return K=>{K(a.TR(t))}}function N(){return t=>{t(a.TR({})),t(a.Db(!1))}}function W(){return t=>{t(a.Db(!0))}}function x(){return t=>{t(a.Db(!1))}}},313085:(t,K,D)=>{D.d(K,{LV:()=>W,TR:()=>G,Db:()=>N});const a={decisions:{},visible:!1};function G(t){return{type:"decisionType/SET_DECISION_PLAYERS",decisionPlayers:t}}function N(t){return{type:"decisionType/SET_DECISION_PLAYERS_VISIBLE",visible:t}}function W(t=a,K){switch(K.type){case"decisionType/SET_DECISION_PLAYERS":return{...t,decisions:K.decisionPlayers};case"decisionType/SET_DECISION_PLAYERS_VISIBLE":return{...t,visible:K.visible};default:return t}}},448826:(t,K,D)=>{D.d(K,{u:()=>X});var a=D(64922),G=D(282427),N=D(232737),W=D(712787),x=D(555405),b=D(699695),n=D(872496),e=D(41553),i=D(170877),z=D(436794),I=D(715907);const Z="playAgainContolWrapper--48dbd",w="visible--f48f5",m="isPhone--36d6c",u="isTablet--0f849",d="landscape--9d9a1",E="playAgainText--a1c7c";function l(t){return t===i.OD.Desktop?"playAgainButton":"playAgainButtonMobile"}const Q=300,P="#decb7f",y={secondaryGold:{background:{default:"#2d3239",hovered:"#444c59"},text:{default:P,hovered:P},border:{default:"#bca65d"}}},q=e.e(Q)((({visible:t,onPlayAgain:K,platform:D,orientation:G=z.t.Landscape})=>a.jsxs("div",{className:b.A(Z,{[m]:D===i.OD.Phone,[u]:D===i.OD.Tablet,[d]:D!==i.OD.Desktop&&G===z.t.Landscape,[w]:t}),style:{"--disappearDuration":`${Q}ms`},children:[a.jsx("div",{className:E,children:n.T("playAgainText")}),a.jsx(I.$,{htmlLabel:!0,label:l(D),size:"XS",type:"secondaryGold",layerStyles:y,fitWidth:!1,labelPosition:"Inside",onClick:K})]})));q.displayName="PlayAgainButton";const X=({visible:t,orientation:K,platform:D})=>{const b=N.y(W.lZ),n=G.d4(x.$d)&&t;return a.jsx(q,{platform:D,orientation:K,onPlayAgain:b,visible:n})}},118100:(t,K,D)=>{D.d(K,{j:()=>z});var a=D(64922),G=D(282427),N=D(872443),W=D(555405),x=D(872496),b=D(600686),n=D(27640);const e="coinsAndStarsContainer--a2820",i=({visible:t,isMobile:K=!1,currency:D,hasCoins:G,winAmount:N,returnMode:W})=>a.jsxs("div",{children:[G&&t&&!W&&a.jsx("div",{className:e,children:a.jsx(b.pb,{useMediaContainer:K,scale:K?1.5:1})}),a.jsx(n.E,{title:W?x.T("yourReturn"):x.T("youWin"),currency:D,amount:N,amountDataRole:"bankers-offer-you-win-amount",visible:t,withLight:!W})]}),z=({visible:t,isMobile:K})=>{const D=G.d4(W.uO)&&t,x=G.d4(N.o2),b=G.d4(W.$q),n=G.d4(W.ej),e=G.d4(W.Qg);return a.jsx(i,{isMobile:K,visible:D,currency:x,hasCoins:b,winAmount:n,returnMode:!e})}},196443:(t,K,D)=>{D.d(K,{W:()=>G,c:()=>a});const a=D(712787).Mk,G=500},712787:(t,K,D)=>{D.d(K,{AD:()=>d,Mk:()=>E,Nr:()=>u,FH:()=>y,Nb:()=>_,Zc:()=>l,bN:()=>P,lZ:()=>X,gf:()=>q});var a=D(244160),G=D(923148),N=D(40729),W=D(977927),x=D(97908),b=D(179062),n=D(536144),e=D(756437),i=D(170877),z=D(222456);const I={[a.PS.NoDeal]:"NoDeal",[a.PS.Deal]:"Deal",[a.PS.Swap]:"Switch"};var Z=D(1941),w=D(555405);const m={Small:"DondSmallWin",Medium:"DondMediumWin",Large:"DondLargeWin"};function u(){return(t,K,{getAG:D})=>{const G=D();return t(x.I(b.z.Dond)),G.balance.pauseBalanceUpdate(),t(e.aj(1)),t(n.BZ()),()=>{t(Z.Gn(!1)),t(Z.Rw(a.jo.Hidden)),t(Z.uv(!1)),t(Z.wt("unknown")),t(Z.pT(!1)),t(N.AC()),G.balance.resumeBalanceUpdate(),t(z.fP()),t(T("Participant")),t(n.IT())}}}function d({offer:t,decisionTimeRemaining:K,canSwap:D,iteration:N}){return x=>{var b;x(n.Lu()),x(Z.wt("offer")),x(Z.rU(t)),x(Z.Gi(D)),x(Z.k6(N)),x((b=K,async(t,K)=>{const D=w.US(K());t(Z.Gn(!0)),W.A("DondBankOffer"),t(Z.ZX(Date.now()-(D-b))),await G.u(b-E/2),t(Z.Gn(!1))})),x(function(t){return async(K,D)=>{if(K(Z._Q(!1)),K(Z.Rw(a.jo.Visible)),await G.u(t-w.Qk(D())),w.Ug(D())){const t=w.gX(D());a._Q(t)||W.A("DondEliminationBackground")}else W.A("DondEliminationBackground"),K(Z.Rw(a.jo.Fading)),await G.u(E),K(Z.Rw(a.jo.Hidden)),W.A("DondNoDeal")}}(K)),x(J({timeout:K,iteration:N}))}}const E=1e3;function l(t){return async(K,D)=>{const N=w.gX(D());K(Z.Gn(!1)),K(Z._Q(!0)),K(function({iteration:t,decision:K}){return(D,a,{getAG:G})=>{const N=G(),W={type:"dond.decide",args:{iteration:t,decision:I[K]}};N.transport.sendStandardMessage(null,W)}}({iteration:N,decision:t}));const x=a._Q(N);t===a.PS.Deal?(W.A(x?"DondDealFinal":"DondDeal"),K(T("Observer"))):t===a.PS.NoDeal?W.A(x?"DondNoDealFinal":"DondNoDeal"):W.A("DondSwitch"),await G.u(E),K(Z.Rw(a.jo.Hidden))}}const Q=1e4;function P({winAmount:t,bonusRoundWinType:K,bonusRoundWinAmount:D}){return async(a,N,{getAG:x})=>{const b=x(),n=w.mH(N());if(a(Z.wt("resolved")),"offer"!==n)return a(Z.pT(!0)),void b.gameResult.setAmount(t);await G.u(E/2),b.gameResult.setAmount(t);const e=b.balance.available.value;b.balance.setServerBalance(e+t),b.balance.resumeBalanceUpdate(),a(Z.Se(D)),a(Z.uv(!0)),W.A(m[K]),a(Z.pT(!0)),await G.u(Q),a(Z.uv(!1))}}function y({decisionTimeRemaining:t,iteration:K}){return async D=>{W.A("DondBankOfferBackground"),D(Z.k6(K)),D(J({timeout:t,iteration:K})),await G.u(t-E/2),a._Q(K)||W.A("DondEliminationBackground")}}function q(t){return(K,D,{getAG:a})=>{a().balance.setTotalBet(t),"unknown"===w.mH(D())&&K(Z.wt("unresolved"))}}function X(){return async(t,K)=>{t(Z.pT(!1)),w.uO(K())&&(t(Z.uv(!1)),await G.u(E/2)),t(((t,K,{getAG:D})=>{D().transport.sendStandardMessage(null,{type:"dond.returnToQualification"})}))}}const h=5e3;function J({timeout:t,iteration:K}){return async(D,N,{getAG:W})=>{const{platform:x}=W();if(D(z.fP()),D(z.a0()),a._Q(K)){if(x!==i.OD.Desktop)return;D(n.t$()),await G.u(t+h),D(z.Bz()),D(n.xm())}}}function T(t){return K=>{K(Z.e(t))}}function _(){return async(t,K)=>{const D=w.gX(K());a._Q(D)||t(z.Bz())}}},1941:(t,K,D)=>{D.d(K,{wx:()=>m,Gn:()=>x,wt:()=>I,Se:()=>i,Gi:()=>N,ZX:()=>b,Rw:()=>n,_Q:()=>e,k6:()=>W,rU:()=>G,pT:()=>Z,e:()=>w,uv:()=>z});const a={bonusStatus:"unknown",offer:0,canSwap:!1,iteration:"1",countdownStartTime:0,banksOfferVisible:!1,decisionControlsStatus:D(244160).jo.Hidden,isDecisionMade:!1,bonusWinAmount:0,youWinVisible:!1,playAgainVisible:!1,playerStatus:"Participant"};function G(t){return{type:"bonus/SET_OFFER",offer:t}}function N(t){return{type:"bonus/SET_CAN_SWAP",canSwap:t}}function W(t){return{type:"bonus/SET_ITERATION",iteration:t}}function x(t){return{type:"bonus/SET_BANKS_OFFER_VISIBLE",visible:t}}function b(t){return{type:"bonus/SET_COUNTDOWN_START_TIME",startTime:t}}function n(t){return{type:"bonus/SET_DECISION_CONTROLS_STATUS",status:t}}function e(t){return{type:"bonus/SET_IS_DECISION_MADE",isDecisionMade:t}}function i(t){return{type:"bonus/SET_BONUS_WIN_AMOUNT",bonusWinAmount:t}}function z(t){return{type:"bonus/SET_YOU_WIN_VISIBLE",visible:t}}function I(t){return{type:"bonus/SET_STATUS",bonusStatus:t}}function Z(t){return{type:"bonus/SET_PLAY_AGAIN_VISIBLE",visible:t}}function w(t){return{type:"bonus/SET_PLAYER_STATUS",playerStatus:t}}function m(t=a,K){switch(K.type){case"bonus/SET_OFFER":return{...t,offer:K.offer};case"bonus/SET_CAN_SWAP":return{...t,canSwap:K.canSwap};case"bonus/SET_ITERATION":return{...t,iteration:K.iteration};case"bonus/SET_BANKS_OFFER_VISIBLE":return{...t,banksOfferVisible:K.visible};case"bonus/SET_COUNTDOWN_START_TIME":return{...t,countdownStartTime:K.startTime};case"bonus/SET_DECISION_CONTROLS_STATUS":return{...t,decisionControlsStatus:K.status};case"bonus/SET_IS_DECISION_MADE":return{...t,isDecisionMade:K.isDecisionMade};case"bonus/SET_BONUS_WIN_AMOUNT":return{...t,bonusWinAmount:K.bonusWinAmount};case"bonus/SET_YOU_WIN_VISIBLE":return{...t,youWinVisible:K.visible};case"bonus/SET_STATUS":return{...t,bonusStatus:K.bonusStatus};case"bonus/SET_PLAY_AGAIN_VISIBLE":return{...t,playAgainVisible:K.visible};case"bonus/SET_PLAYER_STATUS":return{...t,playerStatus:K.playerStatus};default:return t}}},555405:(t,K,D)=>{D.d(K,{$d:()=>P,$q:()=>E,E9:()=>e,H2:()=>q,LF:()=>x,Qg:()=>l,Qk:()=>z,Sz:()=>b,US:()=>I,Ug:()=>w,Z6:()=>i,ej:()=>m,f9:()=>y,gX:()=>n,mH:()=>Q,tZ:()=>Z,u3:()=>X,uO:()=>u});var a=D(160739),G=D(13799),N=D(170877);function W(t){return t.bonus}const x=a.Mz(W,(t=>t.offer)),b=a.Mz(W,(t=>t.canSwap)),n=a.Mz(W,(t=>t.iteration)),e=a.Mz(W,(t=>t.banksOfferVisible)),i=a.Mz(W,(t=>t.countdownStartTime)),z=a.Mz(G.md,(t=>t===N.OD.Desktop?200:400)),I=a.Mz(G.DB,(t=>t.getDecisionTime())),Z=a.Mz(W,(t=>t.decisionControlsStatus)),w=a.Mz(W,(t=>t.isDecisionMade)),m=a.Mz(W,(t=>t.bonusWinAmount)),u=a.Mz(W,(t=>t.youWinVisible)),d=a.Mz(G.DB,(t=>t.dynamicWinAnimationEnabled())),E=a.Mz(d,m,G.cl,((t,K,D)=>!t||K>D)),l=a.Mz(m,G.cl,G.DB,((t,K,D)=>!D.hideYouWinOnLowCelebration()||void 0!==t&&t>K)),Q=a.Mz(W,(t=>t.bonusStatus)),P=a.Mz(W,(t=>t.playAgainVisible)),y=a.Mz(Q,(t=>"unknown"!==t)),q=a.Mz(Q,(t=>"resolved"===t)),X=a.Mz(W,(t=>t.playerStatus))},805195:(t,K,D)=>{D.d(K,{i:()=>Vt});var a=D(64922),G=D(282427),N=D(667012),W=D(232737),x=D(13799),b=D(872443),n=D(185214),e=D(555405),i=D(377810),z=D(699695),I=D(689940),Z=D(41553),w=D(170877),m=D(587698),u=D(695620),d=D(977927),E=D(710928);const l="boxValueTooltip--f23a5";class Q extends i.PureComponent{constructor(){super(...arguments),this.state={isTooltipShown:!1},this.onClick=()=>{this.props.enabled&&this.props.isPhoneOrTablet&&this.showTooltip()},this.showTooltip=()=>{this.setState({isTooltipShown:!0}),this.autoHideTimer=window.setTimeout((()=>{this.setState({isTooltipShown:!1})}),E.p_)},this.onMouseEnter=()=>{this.props.enabled&&!this.props.isPhoneOrTablet&&this.setState({isTooltipShown:!0})},this.onMouseLeave=()=>{this.props.enabled&&!this.props.isPhoneOrTablet&&this.setState({isTooltipShown:!1})}}static getDerivedStateFromProps(t,K){return t.isTopUp&&t.isSpinning&&K.isTooltipShown?{isTooltipShown:!t.isSpinning}:null}componentDidMount(){this.props.isTopUp&&this.props.isPhoneOrTablet&&this.showTooltip()}render(){return a.jsxs("div",{className:l,onMouseLeave:this.onMouseLeave,onMouseEnter:this.onMouseEnter,onClick:this.onClick,children:[this.props.children,this.props.enabled&&a.jsx(E.m_,{isVisible:this.state.isTooltipShown,horizontalPosition:this.props.horizontalAlignment,verticalPosition:E.Ne.Top,label:this.props.label})]})}componentWillUnmount(){this.autoHideTimer&&window.clearTimeout(this.autoHideTimer)}}function P(t,K){return{"--dond-box-max-chars":`${t+K.length+0}ch`}}const y="box--c7bb7",q="left--43ff7",X="right--987ab",h="highlighted--54130",J="topBoxSwitchAllowed--197cb",T="hoverAllowed--795f0",_="index--8f253",C="content--5a8eb",H="currency--afebb",o="amount--4af4a";var U;(function(t){t["Left"]="left",t["Right"]="right"})(U||(U={}));const V=({index:t,currency:K,value:D,align:G,onClick:N,onMouseEnter:W,topBoxSwitchAllowed:x,highlighted:b,scaledStyles:n,isPhoneOrTablet:e,maxChars:I})=>{const Z=i.useRef(null),w=`box-${t}`,l=m.K3(D),V=i.useRef(D);return i.useEffect((()=>{V.current!==D&&d.A(G===U.Left?"TopUpValueUpdateBlue":"TopUpValueUpdateRed")}),[G,D]),a.jsx(Q,{enabled:u.cQ(D),horizontalAlignment:G===U.Left?E.hV.Left:E.hV.Right,label:`${K} ${D}`,isPhoneOrTablet:e,children:a.jsxs("div",{ref:Z,onMouseEnter:()=>{if(Z.current&&!u.cQ(D)&&x){const t=Z.current.getBoundingClientRect();W(t.left+t.width/2,t.top+t.height/2)}},className:z.A(y,G===U.Left?q:X,{[J]:x,[T]:x&&!e,[h]:b}),style:P(I,K),onClick:()=>{x&&N(t)},"data-role":w,children:[a.jsx("div",{"data-role":`${w}-index`,className:_,children:t}),a.jsxs("div",{"data-role":`${w}-content`,className:C,children:[a.jsx("div",{className:H,style:n.currencyStyles,children:K}),a.jsx("div",{"data-role":`${w}-amount`,className:o,style:n.valueStyles,children:l})]})]})})},s="scene--f7e4a",F="container--2df2e",c="rollForward--9194c",g="left--13e36",R="right--abebd",A="front--56de2",Y="hideFrontWhileRotating--8cc9e",L="hiddenFront--7e29a",S="back--f825a",f="hideBackWhileRotating--221da",$="index--60eee",B="content--0e126",O="eliminated--dea0b",v="currency--3ca55",p="amount--4bb69",j="bottom--dcb21",r="fade--9fd18",M="faded--f662d";function k(t,K,D,G,N){const W=m.K3(K),{currencyStyles:x,valueStyles:b}=G;return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:$,children:t}),a.jsxs("div",{className:z.A(B,{[O]:N}),children:[a.jsx("div",{className:v,style:x,children:D}),a.jsx("div",{className:p,style:b,children:W})]})]})}class tt extends i.PureComponent{constructor(){super(...arguments),this.state={eliminating:!1}}componentDidUpdate(t){t.eliminated||!this.props.eliminated||this.state.eliminating||(this.setState({eliminating:!0}),"Unacceptable"===this.props.lastIterationPlayerStatus?d.A(this.props.align===U.Left?"DondBadBoxEliminated":"DondGoodBoxEliminated"):d.A("Participant"===this.props.lastIterationPlayerStatus?"DondFinalCaseReveal":"DondFinalCaseRevealObserver"))}render(){const t=`animated-box-${this.props.index}`;return a.jsx(Q,{enabled:u.cQ(this.props.value),horizontalAlignment:this.props.align===U.Left?E.hV.Left:E.hV.Right,label:`${this.props.currency} ${this.props.value}`,isPhoneOrTablet:this.props.isPhoneOrTablet,children:a.jsx("div",{"data-role":t,className:z.A(s),style:P(this.props.maxChars,this.props.currency),children:a.jsxs("div",{className:z.A(F,this.props.align===U.Left?g:R,{[c]:this.state.eliminating}),children:[a.jsx("div",{className:z.A(A,this.props.align===U.Left?g:R,{[Y]:this.state.eliminating,[L]:this.props.eliminated}),"data-role":`${t}-front`,children:k(this.props.index,this.props.value,this.props.currency,this.props.scaledStyles,this.props.eliminated)}),a.jsx("div",{className:z.A(S,this.props.align===U.Left?g:R,{[f]:this.state.eliminating}),"data-role":`${t}-back`,children:k(this.props.index,this.props.value,this.props.currency,this.props.scaledStyles)}),a.jsx("div",{"data-role":`${t}-bottom`,className:z.A(j,this.props.align===U.Left?g:R,{[r]:this.state.eliminating,[M]:this.props.eliminated})})]})})})}}var Kt=D(346160);const Dt="decimalSeparator--e1c84",at=({className:t})=>a.jsx("div",{"data-role":"decimals-separator",className:t||Dt,children:Kt.lr().numberSymbols.decimal});var Gt=D(70193),Nt=D(244160),Wt=D(757069);const xt={ribbonContainer:"ribbonContainer--1bbf3",finishing0:"finishing0--ae469",finishing0Keyframes:"finishing0Keyframes--3c80f",finishing1:"finishing1--9d38a",finishing1Keyframes:"finishing1Keyframes--bc09b",finishing2:"finishing2--8ffe4",finishing2Keyframes:"finishing2Keyframes--1069f",finishing3:"finishing3--2ff86",finishing3Keyframes:"finishing3Keyframes--e6aed",finishing4:"finishing4--5a4d0",finishing4Keyframes:"finishing4Keyframes--70b4b",finishing5:"finishing5--63a92",finishing5Keyframes:"finishing5Keyframes--2fbe7",finishing6:"finishing6--763b6",finishing6Keyframes:"finishing6Keyframes--a0549",finishing7:"finishing7--d222b",finishing7Keyframes:"finishing7Keyframes--54eed",finishing8:"finishing8--8a9c3",finishing8Keyframes:"finishing8Keyframes--6495a",finishing9:"finishing9--9b1f8",finishing9Keyframes:"finishing9Keyframes--9ebf0",finishing10:"finishing10--d955d",finishing10Keyframes:"finishing10Keyframes--dc638",increased0:"increased0--d0166",increased0Keyframes:"increased0Keyframes--68300",increased1:"increased1--3934a",increased1Keyframes:"increased1Keyframes--f7354",increased2:"increased2--1be99",increased2Keyframes:"increased2Keyframes--ae0ca",increased3:"increased3--37753",increased3Keyframes:"increased3Keyframes--f147f",increased4:"increased4--1e077",increased4Keyframes:"increased4Keyframes--83817",increased5:"increased5--2cfe4",increased5Keyframes:"increased5Keyframes--2205b",increased6:"increased6--23be6",increased6Keyframes:"increased6Keyframes--9a579",increased7:"increased7--26242",increased7Keyframes:"increased7Keyframes--7706f",increased8:"increased8--53267",increased8Keyframes:"increased8Keyframes--f992d",increased9:"increased9--e5bdb",increased9Keyframes:"increased9Keyframes--c7426",increased10:"increased10--10431",increased10Keyframes:"increased10Keyframes--b40e7",finishingRng0:"finishingRng0--56d5e",finishingrng0Keyframes:"finishingrng0Keyframes--288ab",finishingRng1:"finishingRng1--d54a0",finishingrng1Keyframes:"finishingrng1Keyframes--9d9db",finishingRng2:"finishingRng2--aaeca",finishingrng2Keyframes:"finishingrng2Keyframes--ae3b3",finishingRng3:"finishingRng3--02668",finishingrng3Keyframes:"finishingrng3Keyframes--fdb84",finishingRng4:"finishingRng4--657a8",finishingrng4Keyframes:"finishingrng4Keyframes--b1abe",finishingRng5:"finishingRng5--7fed9",finishingrng5Keyframes:"finishingrng5Keyframes--bc7d4",finishingRng6:"finishingRng6--754f2",finishingrng6Keyframes:"finishingrng6Keyframes--25179",finishingRng7:"finishingRng7--e1def",finishingrng7Keyframes:"finishingrng7Keyframes--0009b",finishingRng8:"finishingRng8--32bcb",finishingrng8Keyframes:"finishingrng8Keyframes--9e268",finishingRng9:"finishingRng9--0c623",finishingrng9Keyframes:"finishingrng9Keyframes--3341c",finishingRng10:"finishingRng10--0b97c",finishingrng10Keyframes:"finishingrng10Keyframes--4036f",spinning:"spinning--04d25",spinKeyframes:"spinKeyframes--0faf8",isRng:"isRng--67e89",spinningRng:"spinningRng--9fa05",spinRngKeyframes:"spinRngKeyframes--0616e"},bt=i.memo((t=>{const{value:K,delay:D,status:G,isRng:N}=t,W=Wt.Z(G),x=null!=K?K:10,b=10*x,n=G!==Nt.bk.Default&&(G!==Nt.bk.Finished||W&&W!==Nt.bk.Finished)?{animationDelay:`-${D+Gt.A(50,150)}ms`}:{backgroundPositionY:`${b}%`},e=`increased${x}`,i=N?`finishingRng${x}`:`finishing${x}`;return a.jsx("div",{style:n,className:z.A(xt.ribbonContainer,{[xt.isRng]:N,[xt.spinning]:!N&&G===Nt.bk.Spinning,[xt.spinningRng]:N&&G===Nt.bk.Spinning,[xt[e]]:G===Nt.bk.Increased,[xt[i]]:W===Nt.bk.Spinning&&G===Nt.bk.Finished})})}),(function(t,K){const{value:D,status:a}=t,G=a===Nt.bk.Default&&K.status===Nt.bk.Increased&&K.value===D;return(a===K.status||D===K.value)&&G}));var nt=D(882695);const et="coinsAndStarsContainer--7d4c4",it="isLeftAlignment--2351b",zt=i.memo((({visible:t,isMobile:K,columnAlignment:D})=>t?a.jsx("div",{className:z.A(et,{[it]:D===U.Left}),children:a.jsx(nt.y,{useMediaContainer:!1,scale:K?.55:1})}):null));zt.displayName="CoinsAndStarsContainer";var It=D(551599);function Zt(t){return t.split("").map((t=>parseInt(t,10)))}const wt="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2225%22%20height%3D%2240%22%20fill%3D%22none%22%3E%3Cpath%20fill%3D%22url%28%23paint0_linear_5007_10885%29%22%20fill-rule%3D%22evenodd%22%20stroke%3D%22url%28%23paint1_linear_5007_10885%29%22%20stroke-width%3D%224%22%20d%3D%22M2%204.53c0-1.737%202.064-2.648%203.348-1.477l16.962%2015.47c.87.793.87%202.162%200%202.955L5.348%2036.947C4.064%2038.117%202%2037.207%202%2035.469V4.531Z%22%20clip-rule%3D%22evenodd%22%2F%3E%3Cdefs%3E%3ClinearGradient%20id%3D%22paint0_linear_5007_10885%22%20x1%3D%222%22%20x2%3D%2225.135%22%20y1%3D%2241.099%22%20y2%3D%2241.099%22%20gradientUnits%3D%22userSpaceOnUse%22%3E%3Cstop%20stop-color%3D%22%23F1CF8E%22%2F%3E%3Cstop%20offset%3D%221%22%20stop-color%3D%22%23FAEAB4%22%2F%3E%3C%2FlinearGradient%3E%3ClinearGradient%20id%3D%22paint1_linear_5007_10885%22%20x1%3D%2223.93%22%20x2%3D%223.603%22%20y1%3D%221.461%22%20y2%3D%221.461%22%20gradientUnits%3D%22userSpaceOnUse%22%3E%3Cstop%20offset%3D%22.012%22%20stop-color%3D%22%23fff%22%2F%3E%3Cstop%20offset%3D%22.993%22%20stop-color%3D%22%23fff%22%2F%3E%3C%2FlinearGradient%3E%3C%2Fdefs%3E%3C%2Fsvg%3E",mt={topBox:"topBox--6e09b",fillerToSetTopBoxHeight:"fillerToSetTopBoxHeight--2f0e2",dumbDivForPreloadImages:"dumbDivForPreloadImages--894a7",box:"box--6afa4",left:"left--ac0e6",right:"right--9448e",withCongratulation:"withCongratulation--59a7c",index:"index--2386f",content:"content--ecaf9",currency:"currency--49001",amount:"amount--5c195",digitContainer:"digitContainer--c2afa",decimalSeparator:"decimalSeparator--89266",pointer:"pointer--6d2c8",animateLeftPointerKeyframes:"animateLeftPointerKeyframes--d02b6",animateRightPointerKeyframes:"animateRightPointerKeyframes--83bf0",animatePointer:"animatePointer--b6ee1",highlightedKeyframes:"highlightedKeyframes--5a866"};function ut(t,K=0,D=Nt.bk.Default,G=!1){const N=function(t,K=0,D=!1,a=2){const G=t.toFixed(a),[N,W]=G.split("."),x=K-N.length,b=x>0?It.A(Array(x),void 0):[],n=D?Zt(W):[];return[...b,...Zt(N),...n]}(t,K,G),W=mt.digitContainer,x=N.map(((t,K)=>a.jsx("div",{className:W,children:a.jsx(bt,{value:t,delay:200*K,status:D,isRng:!1})},`top-wheel-digit-${K}-${t}`)));return G&&x.splice(-2,0,a.jsx(at,{className:mt.decimalSeparator},"top-wheel-decimal-separator")),x}function dt(t){const K=`radial-gradient(circle farthest-side at center, `+`hsl(0, 0%, 30%) 0%, hsl(0, 0%, 30%) 40%, hsl(0, 0%, 0%) 70%, hsl(0, 0%, 0%) 100%)`,D=[`radial-gradient(circle farthest-side at center, `+`hsl(0, 0%, 50%) 0%, hsl(0, 0%, 50%) 40%, hsl(0, 0%, 0%) 70%, hsl(0, 0%, 0%) 100%)`,`radial-gradient(circle farthest-side at center, `+`hsl(0, 0%, 60%) 0%, hsl(0, 0%, 60%) 40%, hsl(0, 0%, 0%) 70%, hsl(0, 0%, 0%) 100%)`,`radial-gradient(circle farthest-side at center, `+`hsl(0, 0%, 70%) 0%, hsl(0, 0%, 70%) 35%, hsl(0, 0%, 0%) 100%, hsl(0, 0%, 0%) 100%)`];return a.jsx("div",{style:{backgroundColor:"hsl(0, 0%, 0%)",width:6,height:6,transition:"background-image 0.1s ease-in-out",backgroundImage:-1===t.stateAt?K:D[t.stateAt%D.length]}})}const Et=({index:t,currency:K,value:D,align:G,hasCoins:N,withCongratulation:W,showDecimals:x=!0,digitsLength:b=2,status:n=Nt.bk.Default,isMobile:e,animatePointer:I})=>{const Z=i.useRef(null),[w,m]=i.useState(0),[u,E]=i.useState(-1),[l,Q]=i.useState(null),P="top-box",y=i.useRef(D);i.useEffect((()=>{y.current!==D&&d.A(G===U.Left?"TopUpValueUpdateBlue":"TopUpValueUpdateRed")}),[G,D]);const q=new Array(10).fill(0),X=new Array(4).fill(0),h=i.useCallback((()=>{E(u+1)}),[u]);return i.useEffect((()=>{l&&(clearInterval(l),Q(null)),W?Q(setInterval(h,120)):E(-1)}),[h,W]),i.useEffect((()=>{if(Z.current){const t=Z.current.getBoundingClientRect();m(t.height)}}),[Z]),a.jsxs("div",{ref:Z,className:z.A(mt.topBox,mt[G]),children:[a.jsx("div",{className:mt.fillerToSetTopBoxHeight}),a.jsxs("div",{className:z.A(mt.box,{[mt.withCongratulation]:W}),"data-role":P,children:[a.jsx("div",{style:{display:"grid",gridAutoFlow:"column",justifyContent:"space-evenly",width:"100%",height:"6px",position:"absolute",top:"-6px"},children:q.map(((t,K)=>a.jsx(dt,{stateAt:-1===u?u:0+K+u},K)))}),a.jsx("div",{style:{display:"grid",gridAutoFlow:"row",alignContent:"space-between",width:"6px",height:w,position:"absolute",left:G===U.Left?"100%":void 0,right:G===U.Right?"100%":void 0},children:X.map(((t,K)=>{const D=q.length;return a.jsx(dt,{stateAt:-1===u?u:D+K+u},K)}))}),a.jsx("div",{className:"BottomBulbs",style:{display:"grid",gridAutoFlow:"column",justifyContent:"space-evenly",width:"100%",height:"6px",position:"absolute",bottom:"-6px"},children:q.map(((t,K)=>{const D=X.length+q.length;return a.jsx(dt,{stateAt:-1===u?u:D+K+u},K)}))}),a.jsx("div",{"data-role":`${P}-index`,className:mt.index,children:t}),a.jsxs("div",{"data-role":`${P}-content`,className:mt.content,children:[a.jsx("div",{className:mt.currency,children:K}),a.jsx("div",{"data-role":`${P}-amount`,"data-value":D,className:mt.amount,children:ut(D,b,n,x)})]}),a.jsx("img",{className:z.A(mt.pointer,{[mt.animatePointer]:I}),src:wt,alt:"pointer"})]}),N&&a.jsx(zt,{isMobile:e,columnAlignment:G,visible:W})]})},lt="boxesContainer--1cb6b",Qt="phone--a290a",Pt="boxWrapper--516f0",yt="boxColumn--e2566",qt="left--c5072",Xt="right--20b06",ht="hideIndices--95dc7",Jt="visible--542cb";function Tt(t){return Object.keys(t).sort(((t,K)=>parseInt(t,10)-parseInt(K,10))).map((K=>t[K]))}const _t="dealnodeal-box-tooltip";class Ct extends i.Component{constructor(){super(...arguments),this.renderTopBox=t=>{const{withCongratulation:K,currency:D,hasCoins:a,topBoxIndex:G,animatePointer:N}=this.props,W=G<9?U.Left:U.Right;return i.createElement(Et,{...t,key:`top-box-${G}`,index:G,currency:D,align:W,hasCoins:a,isMobile:this.isPhone(),withCongratulation:K,animatePointer:N})},this.renderBoxes=(t,K,D,G,N=1)=>{const W="TopUp"===this.props.type,x={currencyStyles:{fontSize:`${D.currencyFontSize}em`},valueStyles:{fontSize:`${D.valueFontSize}em`}},b=function(t,K=10){let D=t.reduce(((t,K)=>Math.max(t,K.length)),Number.MIN_SAFE_INTEGER);return D=Math.max(K,D),D}(t.map((t=>m.K3(t.value))));return t.map(((t,D)=>{const n=I.W(D+N);if(this.props.topBoxIndex===n&&W){const t=Tt(this.props.boxes)[this.props.topBoxIndex-1];return this.renderTopBox(t)}return a.jsx("div",{"data-role":"box-wrapper",className:z.A(Pt),children:W?a.jsx(V,{...t,align:K,index:n,currency:this.props.currency,highlighted:this.props.highlightBoxes[n],topBoxSwitchAllowed:this.props.topBoxSwitchAllowed,onClick:this.onBoxClick,onMouseEnter:this.onBoxMouseEnter,isPhoneOrTablet:!this.isDesktop(),scaledStyles:x,maxChars:b}):a.jsx(tt,{...t,align:K,index:n,currency:this.props.currency,isPhoneOrTablet:!this.isDesktop(),scaledStyles:x,maxChars:b,lastIterationPlayerStatus:G})},n)}))},this.onBoxClick=t=>{const{setTopBoxIndex:K}=this.props;K(t)},this.onBoxMouseEnter=(t,K)=>{const{canShowTooltip:D,gameDimensions:a,addAbsTooltip:G}=this.props;D&&this.isDesktop()&&G({left:t-a.left,top:K-a.top,labelTranslationId:"boxTooltipTopUp",id:_t,hasAnchor:!0})}}render(){const{boxes:t,visible:K}=this.props,D=Tt(t),G=Math.round(D.length/2),N=D.slice(0,G),W=D.slice(G),x={currencyFontSize:1,valueFontSize:1},b=1===D.filter((t=>!t.eliminated)).length?this.props.playerStatus:"Unacceptable";return a.jsxs("div",{"data-role":"boxes-container",className:z.A(lt,{[Qt]:this.isPhone(),[Jt]:!K}),children:[a.jsx("div",{"data-role":"boxes-column-left",className:z.A(yt,qt,{[ht]:this.props.hideIndices}),children:this.renderBoxes(N,U.Left,x,b)}),a.jsx("div",{"data-role":"boxes-column-right",className:z.A(yt,Xt,{[ht]:this.props.hideIndices}),children:this.renderBoxes(W,U.Right,x,b,G+1)})]})}isDesktop(){return this.props.platform===w.OD.Desktop}isPhone(){return this.props.platform===w.OD.Phone}}const Ht=Z.e(300)(Ct);var ot=D(746351),Ut=D(40729);const Vt=({platform:t,type:K,visible:D})=>{const i=G.d4(x.Ay),z=G.d4(b.o2),I=G.d4(ot.Gf),Z=G.d4(N.Vo),w=W.y(Ut.R6),m=G.d4(ot.I3),u=W.y(n.$y),d=!G.d4(N.DI),E=G.d4(ot.Zr),l=G.d4(ot.zj),Q=G.d4(ot.ES),P=G.d4(e.u3);return a.jsx(Ht,{platform:t,gameDimensions:i,currency:z,hideIndices:!1,hasCoins:!0,visible:D,type:K,boxes:I,topBoxIndex:Z,setTopBoxIndex:w,topBoxSwitchAllowed:l,withCongratulation:E,highlightBoxes:m,canShowTooltip:d,addAbsTooltip:u,playerStatus:P,animatePointer:Q})}},40729:(t,K,D)=>{D.d(K,{AC:()=>l,AT:()=>E,R6:()=>u,Sw:()=>i,W:()=>I,XR:()=>e,Yk:()=>d,Yl:()=>m,cU:()=>w});var a=D(467380),G=D(244160),N=D(923148),W=D(977927),x=D(496464),b=D(746351),n=D(65746);function e({boxes:t,multiplier:K=1}){return D=>{D(x.sD(t)),D(x.Up(K))}}const i=100,z=600;function I(){return async(t,K)=>{if(b.Cc(K()))return;const D=[];G.fg.forEach((a=>{const G=(a-1)*i,W=setTimeout((()=>{var K;t((K=a,async(t,D)=>{const a=b.I3(D());t(x.mn({...a,[K]:!0})),await N.u(Z);const G=b.I3(D());t(x.mn({...G,[K]:!1}))}))}),G);D.push(W);const n=setTimeout((()=>{const D=b.zc(K());t(x.L7({...D,[a]:!0}))}),G+z);D.push(n)})),t(x.k3(D)),await N.u(15*i+Z+z),t(x.k3([]))}}const Z=2e3;function w(t){return async K=>{K(x.c3(t))}}function m(){return async t=>{t(x.c3(null))}}function u(t){return async K=>{K(a.RA(t)),K(n.u()),W.A(t<9?"TopUpSelectBlue":"TopUpSelectRed")}}function d(){return async t=>{t(x.jc(!0))}}function E(){return async t=>{t(x.jc(!1))}}function l(){return async(t,K)=>{b.ml(K()).forEach((t=>clearTimeout(t))),t(x.jX())}}},496464:(t,K,D)=>{D.d(K,{oA:()=>w,jX:()=>I,k3:()=>Z,sD:()=>x,jc:()=>z,mn:()=>e,Up:()=>b,L7:()=>n,c3:()=>i});var a=D(244160),G=D(466694);const N=a.fg.reduce(((t,K)=>(t[K]=!1,t)),{}),W={boxes:G.s(),multiplier:1,multiplierApplied:N,highlightBoxes:N,applyMultiplierAndHighlightTimerIds:[],topUpBoxIndex:null,canChangeTopBox:!1};function x(t){return{type:"boxes/SET_BOXES",payload:t}}function b(t){return{type:"boxes/SET_MULTIPLIER",payload:t}}function n(t){return{type:"boxes/SET_MULTIPLIER_APPLIED",payload:t}}function e(t){return{type:"boxes/SET_HIGHLIGHT_BOXES",payload:t}}function i(t){return{type:"boxes/SET_TOP_UP_BOX_INDEX",payload:t}}function z(t){return{type:"boxes/SET_CAN_CHANGE_TOP_BOX",payload:t}}function I(){return{type:"boxes/RESET"}}function Z(t){return{type:"boxes/SET_APPLY_MULTIPLIER_AND_HIGHLIGHT_TIMER_IDS",payload:t}}function w(t=W,K){switch(K.type){case"boxes/SET_BOXES":return{...t,boxes:K.payload};case"boxes/SET_MULTIPLIER":return{...t,multiplier:K.payload};case"boxes/SET_MULTIPLIER_APPLIED":return{...t,multiplierApplied:K.payload};case"boxes/SET_HIGHLIGHT_BOXES":return{...t,highlightBoxes:K.payload};case"boxes/SET_TOP_UP_BOX_INDEX":return{...t,topUpBoxIndex:K.payload};case"boxes/SET_CAN_CHANGE_TOP_BOX":return{...t,canChangeTopBox:K.payload};case"boxes/RESET":return W;case"boxes/SET_APPLY_MULTIPLIER_AND_HIGHLIGHT_TIMER_IDS":return{...t,applyMultiplierAndHighlightTimerIds:K.payload};default:return t}}},746351:(t,K,D)=>{D.d(K,{ml:()=>l,Gf:()=>m,zj:()=>d,I3:()=>i,ES:()=>E,zc:()=>n,Cc:()=>e,Bz:()=>w,Zr:()=>u});var a=D(160739),G=D(667012),N=D(244160),W=D(540323);const x=t=>t.boxes,b=a.Mz(x,(t=>t.multiplier)),n=a.Mz(x,(t=>t.multiplierApplied)),e=a.Mz(x,(t=>N.fg.some((K=>t.multiplierApplied[K])))),i=a.Mz(x,(t=>t.highlightBoxes)),z=a.Mz(x,(t=>t.topUpBoxIndex)),I=a.Mz(x,(t=>t.boxes)),Z=a.Mz(I,b,n,((t,K,D)=>N.fg.reduce(((a,G)=>{return{...a,[G]:{...t[G],value:(N=G,W=t[G].value,D[N]?W:W/K)}};var N,W}),{}))),w=a.Mz(G.Vo,(t=>`${t}`)),m=a.Mz(Z,w,z,((t,K,D)=>{const a=t[K].value,G=t[K].eliminated;return{...t,[K]:{value:a,eliminated:G,status:K===D?N.bk.Increased:N.bk.Default,digitsLength:1,showDecimals:W.n(a)}}})),u=a.Mz(z,(t=>null!==t)),d=a.Mz(x,(t=>t.canChangeTopBox)),E=a.Mz(G.DI,d,((t,K)=>!t&&K)),l=a.Mz(x,(t=>t.applyMultiplierAndHighlightTimerIds))},65746:(t,K,D)=>{D.d(K,{_:()=>N,u:()=>G});const a="boxes/signal/USER_CHANGE_SELECTED_BOX";function G(){return{type:a}}function N(t){return"object"==typeof t&&null!==t&&"type"in t&&t["type"]===a}},950535:(t,K,D)=>{D.d(K,{q:()=>e});var a=D(64922),G=D(699695),N=D(377810);const W=-1,x={currentCount:0,prevCount:0,direction:"none"};function b(t,K){switch(Math.sign(K-t)){case 1:return"increasing";case-1:return"decreasing"}return"none"}const n={animatedCounter:"animatedCounter--8b88c",previousNumber:"previousNumber--067c5",increasing:"increasing--8d75b",moveUpDisappearKeyframes:"moveUpDisappearKeyframes--b5e3a",decreasing:"decreasing--947d3",moveDownDisappearKeyframes:"moveDownDisappearKeyframes--3ad72",currentNumber:"currentNumber--337f0",moveUpAppearKeyframes:"moveUpAppearKeyframes--27930",moveDownAppearKeyframes:"moveDownAppearKeyframes--d3652"},e=({count:t})=>{const{currentCount:K,prevCount:D,direction:e}=function(t){const[K,D]=N.useState(x),a=N.useRef(t),G=N.useRef(t),n=N.useRef(W);G.current=t;const e=()=>{D({currentCount:G.current,prevCount:a.current,direction:b(a.current,G.current)}),a.current=G.current};return N.useEffect((()=>{n.current===W&&(e(),n.current=window.setTimeout((()=>{t!==G.current&&e(),n.current=W}),300))}),[t]),N.useEffect((()=>()=>{clearTimeout(n.current)}),[]),K}(t);return a.jsxs("div",{className:G.A(n.animatedCounter,"none"!==e&&n[e]),children:[a.jsx("div",{className:n.currentNumber,children:K}),a.jsx("div",{className:n.previousNumber,children:D})]},`animated-count-${K}`)}},343298:(t,K,D)=>{D.d(K,{o:()=>qt});var a=D(64922),G=D(377810),N=D(282427),W=D(791839),x=D(79697),b=D(816340),n=D(923968),e=D(346160),i=D(699695),z=D(837557),I=D(653677),Z=D(587698),w=D(671860),m=D(509407),u=D(808432),d=D(525019);const E="red--3ffaa",l="black--f01d3";function Q(t,K,D,G){return a.jsx("use",{xlinkHref:t,x:K,y:D,height:G})}d.z();const P=G.memo((({rank:t,suit:K})=>{let D;switch(t){case"2":case"6":D="36";break;case"3":case"9":D="35";break;case"4":D="34";break;case"5":case"J":D="38";break;case"7":D="40";break;case"8":D="39";break;case"10":D="0";break;case"Q":case"A":D="19";break;default:D="17"}const G=[u.KY.D,u.KY.H].includes(K)?E:l,N=Q(`#rank-${t}`,D,"10","86"),W=Q(`#suit-${u.KY[K]}`,"100","0","106");return a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 184 106",preserveAspectRatio:"xMidYMid meet",className:G,children:[N,W]})}));P.displayName="RankAndSuit";const y="indented--d520e",q="doubleIndented--68144",X="bold--37d87",h="bet--7d654",J="betLimits--3cf27",T="payout--46826",_="ranksAndSuits--7b0b6",C="mobileRanksAndSuits--7a895",H="cardsDelimiter--55498",o="disabled--fc044",U="topPadding--64914",V="rtl--1eee5",s="mobile--a40d9",F="cellContent--e7e92",c="sectionHeader--a6eff",g="hasContent--7f13d",R="middleDataCell--a2446",A="fixedColumnWidths--a60d9",Y="hasBottomBorder--87313",L="hasIncreasedNotch--5fff3",S="hasNotch--42e7b",f="legacyMenuMode--041c5",$=G.memo((t=>{const{betKey:K,betTitle:D,min:N,max:W,payout:x,isIndented:b=!1,areLimitsInlined:n,cards:d,middleComponent:E,hasBottomBorder:l=!0,isMobile:Q=!1,currencySymbol:$="",fixedColumnWidths:B=!0,showPayouts:O=!0,isSectionHeader:v=!1,hasSectionPadding:p=!1,disabled:j=!1,legacyMenuMode:r}=t,M=b&&p,k=i.A({[y]:!M&&(b||p),[q]:M}),tt=void 0===D&&K?a.jsx(I.q,{className:k,"data-role":"title",children:K}):a.jsx("span",{"data-role":"title",className:k,children:null!=D?D:String.fromCharCode(8203)}),Kt=G.useMemo((()=>{if(N&&W)return m.Q({lowerLimit:N,upperLimit:W,currencySymbol:$});const t=null!=N?N:W;return t?Z.ej(t,{currencySymbol:$}):void 0}),[N,W,$]),Dt=G.useMemo((()=>null==d?void 0:d.map(((t,K)=>function(t,K){const D=t.slice(0,-1);let G=null;switch(t.slice(-1)){case"C":G=u.KY.C;break;case"D":G=u.KY.D;break;case"H":G=u.KY.H;break;case"S":G=u.KY.S}return"|"===t?a.jsx("span",{className:H,children:t}):D&&null!==G?a.jsx(P,{rank:D,suit:G},K):null}(t,K)))),[d]),at=!!(D||K||Kt||Dt||E||x);return a.jsxs("tr",{"data-role":`bet-limits_${K}`,className:i.A({[s]:Q,[o]:j,[g]:at,[Y]:l,[A]:B,[S]:z.DS.HAS_NOTCH,[L]:z.DS.IS_IPHONE14_PRO}),children:[a.jsx("td",{className:i.A(h,{[X]:!b&&!Q,[U]:n,[c]:v}),colSpan:n?2:1,children:a.jsxs("div",{className:F,children:[tt,n&&!!Kt&&a.jsxs("span",{className:J,"data-min":N,"data-max":W,"data-role":"limits",children:[w.be,Kt]})]})}),!n&&a.jsx("td",{className:R,children:a.jsx("div",{className:F,children:Dt?a.jsxs("div",{"data-role":"ranks-and-suits",className:i.A(_,{[C]:Q}),children:[...Dt]}):E||!n&&a.jsx("div",{"data-role":"min-max",className:J,"data-min":N,"data-max":W,children:Kt})})}),O&&a.jsx("td",{className:i.A(T,{[U]:n}),children:a.jsx("div",{className:i.A(F,{[f]:r,[V]:e.sU()}),"data-role":"payout",children:x})})]})}));$.displayName="BetLimitsAndPayoutsRow";const B="footerContentWrapper--24329",O="mobile--5a6b8",v=G.memo((({children:t,isMobile:K})=>a.jsx("tr",{"data-role":"bet-limits-footer",children:a.jsx("td",{colSpan:3,className:i.A(B,{[O]:K}),children:t})})));v.displayName="BetLimitsAndPayoutsFooter";var p=D(160739),j=D(443505),r=D(13799);const M=p.Mz(r.DB,j.B,x.Y,((t,K,D)=>{const a=t.getChipAmounts();return{min:Math.min(...a.filter((K=>K>=t.qualificationTopUpMinBet()))),max:Math.min(K.max-D.min,t.qualificationTopUpMaxBet())}})),k="symbolPayouts--816b4",tt="label--0afd3",Kt="mobile--c6ca3",Dt="payoutTableWrapper--c5833",at="payoutTableRow--44e0e",Gt="payoutTableRowLast--345e4",Nt="scatter--df1b4",Wt="payoutScatterLabel--c81f5",xt="payoutScatterMultiplier--c8a98",bt="payoutScatterText--ad641",nt="scatterIcon--9bfef",et=D(540160),it=D(682174),zt=D(207147),It=D(369982),Zt=D(776376),wt=D(458293),mt={Wild:et,Wild2x:it,Wild5x:zt,Scatter:D(437280),Phone:D(611466),Cherry:D(349531),TripleSeven:It,Seven:wt,TripleBar:Zt,Bar:D(647525)},ut={Wild:["symbolPayoutX3","symbolPayout5x"],Wild2x:["symbolPayoutX3","symbolPayout30x"],Wild5x:["symbolPayoutX3","symbolPayout75x"],TripleSeven:["symbolPayoutX3","symbolPayout2x"],TripleBar:["symbolPayoutX3","symbolPayout1x"],Seven:["symbolPayoutX3","symbolPayout1_5x"],Phone:["symbolPayoutX3","symbolPayout5x"],Cherry:["symbolPayoutX3","symbolPayout3x"],Bar:["symbolPayoutX3","symbolPayout0_5x"],Scatter:["symbolPayoutX3",""]},dt=["Wild","Wild2x","Wild5x"],Et=["Phone","Cherry","TripleSeven"],lt=["Seven","TripleBar","Bar"],Qt=["Scatter"],Pt=({symbol:t,label:K})=>a.jsxs("div",{className:Nt,children:[a.jsx("div",{className:nt,style:{backgroundImage:`url(${mt[t]})`},"data-symbol":t}),a.jsxs("div",{className:Wt,children:[a.jsx("span",{className:xt,children:e.Tl(ut[t][0])}),a.jsx("span",{className:bt,children:` = ${e.Tl(null!=K?K:ut[t][1])}`})]})]}),yt=({isMobile:t})=>a.jsxs("div",{className:k,children:[a.jsx("div",{className:i.A(tt,{[Kt]:t}),children:e.Tl("symbolPayouts.uppercase")}),a.jsxs("div",{className:i.A(Dt,{[Kt]:t}),children:[a.jsx("div",{className:at,children:dt.map((t=>a.jsx(Pt,{symbol:t},t)))}),a.jsx("div",{className:at,children:Et.map((t=>a.jsx(Pt,{symbol:t},t)))}),a.jsx("div",{className:at,children:lt.map((t=>a.jsx(Pt,{symbol:t},t)))}),a.jsx("div",{className:i.A(at,Gt),children:Qt.map((t=>a.jsx(Pt,{symbol:t,label:"qualifiesForBonusRound.uppercase"},t)))})]})]}),qt=({isMobile:t})=>{const K=n.V((t=>t.currencySymbol)),D=N.d4(W.K),G=N.d4(W.d),i=N.d4(x.Y),z=N.d4(M),I=N.d4(b.F),Z=!N.d4(b.K),w=a.jsx($,{betKey:"qualification_spin",betTitle:e.Tl("qualification_uppercase"),isIndented:!1,showPayouts:!1,isMobile:t}),m=a.jsx($,{betKey:"qualification_spin",betTitle:e.Tl("qualification_uppercase"),currencySymbol:K,isIndented:!1,showPayouts:!1,isMobile:t,min:i.min,max:i.max}),u=a.jsx($,{betKey:"qualification_noraml_spin",betTitle:e.Tl("normalSpin"),currencySymbol:K,isMobile:t,min:i.min,max:i.max,showPayouts:!1,isIndented:!0}),d=a.jsx($,{betKey:"qualification_xxxtreme_spin",betTitle:e.Tl("xxxtremeSpin"),currencySymbol:K,isMobile:t,min:D.min,max:D.max,showPayouts:!1,isIndented:!0}),E=a.jsx($,{betKey:"qualification_super_xxxtreme_spin",betTitle:e.Tl("superXxxtremeSpin"),currencySymbol:K,isMobile:t,min:G.min,max:G.max,showPayouts:!1,isIndented:!0}),l=a.jsx($,{betKey:"qualification_top_up",betTitle:`${e.Tl("topUp")}*`,currencySymbol:K,isMobile:t,min:z.min,max:z.max,showPayouts:!1});return a.jsxs("tbody",{children:[Z?m:w,!Z&&u,!Z&&d,!I&&!Z&&E,l,a.jsx(v,{isMobile:t,children:a.jsx("div",{children:`*${e.Tl("limitBasedOnBaseBet")}`})}),a.jsx("tr",{children:a.jsx("td",{colSpan:3,children:a.jsx(yt,{isMobile:t})})})]})}},925174:(t,K,D)=>{D.d(K,{H:()=>e});var a=D(64922),G=D(377810),N=D(282427),W=D(241665),x=D(901577),b=D(173674),n=D(836341);const e=({gamePhase:t})=>{const{log:K}=x.O(),D=N.d4(n.P6),e=G.useCallback((a=>{K(W.W4({betFrom:D,betTo:a,status:"Changed",gamePhase:t}))}),[D,t,K]);return a.jsx(b.l,{onStakeSelect:e})}},913611:(t,K,D)=>{D.d(K,{S:()=>i});var a=D(64922),G=D(170877);const N=D.p+"images/desktopfoo.67f754bf.webp",W=D.p+"images/mobilefoot.e3ece14c.webp",x=D.p+"images/tabletfoot.1cb37be4.webp",b="footerBackground--6d1e8",n="footerBackgroundImg--95a77",e={[G.OD.Desktop]:N,[G.OD.Phone]:W,[G.OD.Tablet]:x},i=({platform:t,containerHeightPx:K,bottomPx:D})=>a.jsx("div",{className:b,style:{height:`${K?`${K}px`:void 0}`,bottom:`${D?`${D}px`:0}`},children:a.jsx("img",{src:e[t],className:n})})},840703:(t,K,D)=>{D.d(K,{H:()=>u});var a=D(64922),G=D(282427),N=D(377810),W=D(715907);const x=({onClick:t,enabled:K,activated:D=!1,defaultIcon:G,activatedIcon:N,role:x,tooltip:b,buttonRef:n,onClickDisabled:e,type:i,hideTooltipAfterClick:z=!1,size:I})=>{const Z=K?D?"Activated":"Default":"Disabled",w="Activated"===Z?N:G;return a.jsx(W.g,{buttonRef:n,role:x,onClick:t,onDisabledClick:e,state:Z,type:i,tooltip:b,iconComponent:w,size:I,hideTooltipAfterClick:z})},b=N.forwardRef(((t,K)=>a.jsx(x,{...t,buttonRef:K})));var n=D(686123),e=D(980168),i=D(232737),z=D(13799),I=D(170877),Z=D(704169);const w="infoButtonSpace--4a8f1",m="info-button",u=()=>{const t=G.d4(n.P$),K=G.d4(z.md),D=i.y(e.l);return t?a.jsx(b,{role:m,enabled:!0,defaultIcon:a.jsx(Z.R,{}),onClick:D,type:K===I.OD.Desktop?"secondary":"customizable"}):K===I.OD.Phone?a.jsx("div",{className:w}):null}},802548:(t,K,D)=>{D.d(K,{h:()=>bt});var a=D(64922),G=D(377810),N=D(837557),W=D(170877),x=D(346160),b=D(827424),n=D(48415),e=D(699695),i=D(212429);const z=G.createContext(null);function I(){const t=G.useContext(z);if(!t)throw new i.U8("SpinButton Context must be provided through SpinButtonContext.Provider");return t}const Z="glowAnimation--c2202",w="animating--d6ed2",m=G.memo((()=>{const{state:t}=I(),[K,D]=G.useState(!1);return G.useEffect((()=>()=>{"Activated"===t&&D(!0)}),[t]),a.jsx("div",{"data-role":"spin-button-glow-animation",className:e.A(Z,{[w]:K}),onAnimationEnd:()=>{D(!1)}})}));m.displayName="SpinButtonHighlightAnimation";var u=D(447539),d=D(5519);const E="backPlateContainer--57638",l="inner--f24a2",Q=G.memo((({children:t})=>{const{state:K}=I();return a.jsx("div",{className:E,children:a.jsx("div",{className:l,children:t({buttonState:K})})})}));Q.displayName="BackPlateContainer";const P=({props:t,children:K})=>{const{state:D,disableInteractionAnimation:N,timerDuration:W,disableCtaAnimation:x}=t,[b,n]=G.useState(D),[e,i]=G.useState(void 0);G.useEffect((()=>{n(D)}),[D]);const I=G.useMemo((()=>({state:b,setState:n,disableInteractionAnimation:N,timerDuration:W,animationType:e,setAnimationType:i,disableCtaAnimation:x})),[b,N,W,e,x]);return a.jsx(z.Provider,{value:I,children:K})};P.displayName="SpinButtonContextProvider";var y=D(168855);const q={baseRim:"baseRim--951f1",xxl:"xxl--a3ec2",xl:"xl--5466f",lg:"lg--ac7e0",md:"md--6a510",sm:"sm--954ab",xs:"xs--d5cd6",xxs:"xxs--f663e",xxxs:"xxxs--2f758",spinButton:"spinButton--27e1e",badge:"badge--4cbda",icon:"icon--45c2f",baseStroke:"baseStroke--5710f",baseFill:"baseFill--99827",reactiveWrapper:"reactiveWrapper--0d7c0",reactiveBaseStroke:"reactiveBaseStroke--461c9",reactiveBaseFill:"reactiveBaseFill--ca703",label:"label--fb43f",disabled:"disabled--1bfb6",labelContainer:"labelContainer--555b6",smokePattern:"smokePattern--32576",activated:"activated--c69d3"},X=({layerStyles:t,children:K})=>{const{state:D}=I(),N=y.F(["spinButton"],{spinButton:t}),{handlePointerUp:W,handlePointerLeave:x,handlePointerEnter:b,handlePointerDown:n,handleContextMenu:i}=function(){const{state:t,setState:K,setAnimationType:D,disableInteractionAnimation:a,disableCtaAnimation:N}=I(),W="Disabled"===t,x=N||W?void 0:"cta",b=a||W?void 0:"hover";G.useEffect((()=>{D(x)}),[x,D]);const n=G.useCallback((()=>{W||D(b)}),[b,W,D]),e=G.useCallback((()=>{W||D(x)}),[W,D,x]),i=G.useCallback((t=>{W||(K("Default"),window.removeEventListener("pointerup",i),"touch"===t.pointerType&&D(x))}),[W,K,D,x]),z=G.useCallback((t=>{W||(K("Activated"),window.addEventListener("pointerup",i),"touch"===t.pointerType&&D(b))}),[W,K,i,D,b]),Z=G.useCallback((t=>{t.preventDefault()}),[]);return{handlePointerDown:z,handlePointerEnter:n,handlePointerLeave:e,handlePointerUp:i,handleContextMenu:Z}}();return a.jsx("div",{className:e.A(q.spinButton,{[q.disabled]:"Disabled"===D,[q.activated]:"Activated"===D}),"data-role":"spin-button",onPointerUp:W,onPointerLeave:x,onPointerEnter:b,onPointerDown:n,onContextMenu:i,style:N,children:K})},h="arrows--d98eb",J="disabled--21197",T="spinning--9cdac",_="spinning2--8641f",C=5e3;const H=G.memo((({animationType:t,spinButtonState:K})=>{const D=G.useRef(null),N=G.useId(),W=`top-arrow-${N}`,x=`bottom-arrow-${N}`,{onAnimationEnd:b,animationClass:n}=function({animationType:t,spinButtonState:K}){const D=G.useRef(null),[a,N]=G.useState(!1),{disableInteractionAnimation:W,disableCtaAnimation:x}=I(),b=G.useCallback((()=>{null!==D.current&&clearInterval(D.current)}),[]),{resetAnimation:n,animationClass:e}=function(){const[t,K]=G.useState(T);return{animationClass:t,resetAnimation:()=>{K((t=>t===T?_:T))}}}();return G.useEffect((()=>{"hover"!==t||W||(n(),N(!0),b()),"cta"!==t||x||(D.current=setInterval((()=>{N(!0),n()}),C)),(x&&"cta"===t||"Disabled"===K)&&(b(),N(!1))}),[t,W]),G.useEffect((()=>()=>{b()}),[b]),{onAnimationEnd:()=>{N(!1)},animationClass:a?e:void 0}}({animationType:t,spinButtonState:K});return a.jsx("div",{ref:D,className:e.A(h,n,{[J]:"Disabled"===K}),"data-role":"spin-button-arrows",onAnimationEnd:b,children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 109 109",fill:"none",children:[a.jsxs("g",{opacity:".7",children:[a.jsx("path",{fill:`url(#${W})`,d:"m79.91 12.303 9.04 24.674-25.55-1.545 4.145-5.681c-6.032-3.335-14.873-4.402-26.524-3.2-11.65 1.202-20.31 9.206-25.98 24.01.904-15.598 8.178-26.892 21.823-33.88 11.244-5.758 24.38-5.293 39.408 1.397l3.637-5.775Z"}),a.jsx("path",{fill:`url(#${x})`,d:"m24.758 93.185-3.875-23.693 24.45 3.103-4.987 4.965c5.435 4.233 14.002 6.663 25.702 7.29 11.7.629 21.514-5.926 29.44-19.663-3.343 15.264-12.304 25.282-26.883 30.058-12.015 3.935-24.92 1.43-38.716-7.517l-5.13 5.457Z"})]}),a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:W,x1:"14.575",x2:"57.743",y1:"39.457",y2:"19.526",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"white",stopOpacity:"0"}),a.jsx("stop",{offset:"1",stopColor:"white",stopOpacity:".599"})]}),a.jsxs("linearGradient",{id:x,x1:"94.636",x2:"48.513",y1:"75.224",y2:"89.069",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"white",stopOpacity:"0"}),a.jsx("stop",{offset:"1",stopColor:"white",stopOpacity:".604"})]})]})]})})}));H.displayName="SpinButtonArrows";const o="card--8675e",U="left--a19c5",V="hover--abba8",s="cta--156da",F="right--5e6d3",c="#BEBEBE",g="#ffffff",R=5800,A=G.memo((({spinButtonState:t,animationType:K,suitColor:D=c,backgroundColor:N=g})=>{const W=G.useId(),x=`left-filter-${W}`,b=`right-filter-${W}`,n="Disabled"===t?"0.1":"0.25",{onAnimationEnd:i,internalAnimation:z}=function({animationType:t}){const[K,D]=G.useState(void 0),a=G.useCallback((()=>{D(void 0)}),[D]);return G.useEffect((()=>{let K;return"cta"===t?K=window.setInterval((()=>{D("cta")}),R):D(t),()=>{D(void 0),window.clearInterval(K)}}),[t]),G.useMemo((()=>({onAnimationEnd:a,internalAnimation:K})),[K,a])}({animationType:K});return a.jsx("div",{"data-role":"spin-button-cards",className:e.A({[V]:"hover"===z,[s]:"cta"===z}),onAnimationEnd:i,children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 108 108",children:[a.jsxs("g",{opacity:n,children:[a.jsxs("g",{className:e.A(o,F),children:[a.jsx("g",{filter:`url(#${b})`,children:a.jsx("path",{fill:N,d:"M53.431 23.511c1.353-2.343 4.302-3.172 6.587-1.853L88.982 38.38c2.285 1.32 3.041 4.288 1.689 6.631L65.567 88.489c-1.352 2.343-4.301 3.172-6.586 1.853L30.018 73.62c-2.285-1.32-3.041-4.288-1.689-6.63L53.431 23.51Z"})}),a.jsx("path",{fill:D,d:"M86.337 40.318c-1.091-.63-2.664-.086-3.76.703.136-1.341-.177-2.977-1.27-3.607-1.575-.91-3.395-.305-4.468 1.553a4.394 4.394 0 0 0-.582 2.48c-.007.425.015.849.066 1.269l1.002 7.41 6.918-2.838a9.026 9.026 0 0 0 1.13-.577 4.404 4.404 0 0 0 1.859-1.744c1.07-1.866.679-3.74-.895-4.65ZM44.187 63.325c-1.092-.63-2.664-.086-3.76.703.136-1.34-.178-2.977-1.27-3.607-1.575-.91-3.395-.305-4.468 1.553a4.393 4.393 0 0 0-.583 2.48 9.21 9.21 0 0 0 .067 1.269l1.002 7.41 6.918-2.837a9.04 9.04 0 0 0 1.13-.578 4.404 4.404 0 0 0 1.858-1.744c1.07-1.866.68-3.74-.894-4.65Z"})]}),a.jsxs("g",{className:e.A(o,U),children:[a.jsx("g",{filter:`url(#${x})`,children:a.jsx("path",{fill:N,d:"M23 30.816C23 28.156 25.14 26 27.778 26h33.444C63.861 26 66 28.156 66 30.816v49.368C66 82.844 63.86 85 61.222 85H27.778C25.139 85 23 82.844 23 80.184V30.816Z"})}),a.jsx("path",{fill:D,d:"M60.122 33.732a2.92 2.92 0 0 0-1.3.302 2.83 2.83 0 0 0 1.081-2.203 2.849 2.849 0 0 0-.862-2.015A2.88 2.88 0 0 0 56.997 29a2.864 2.864 0 0 0-2.894 2.831 2.83 2.83 0 0 0 1.081 2.203 2.94 2.94 0 0 0-1.3-.303 2.837 2.837 0 0 0-2.874 2.593 2.83 2.83 0 0 0 2.403 3.03c.216.048.437.072.659.073a2.827 2.827 0 0 0 2.644-1.742l-.043.256a8.331 8.331 0 0 1-.286 1.503l-.074.232c-.496 1.41-1.513 1.86-1.513 1.86V42h4.394v-.465s-1.017-.448-1.513-1.86a6.387 6.387 0 0 1-.12-.385 9.326 9.326 0 0 1-.24-1.349c-.014-.085-.027-.17-.043-.258a2.835 2.835 0 0 0 2.65 1.742c.222 0 .443-.025.66-.073a2.83 2.83 0 0 0 2.402-3.03 2.837 2.837 0 0 0-2.874-2.592l.006.002ZM28.878 77.268a2.92 2.92 0 0 0 1.3-.302 2.83 2.83 0 0 0-1.081 2.203c.006.759.317 1.484.862 2.015a2.88 2.88 0 0 0 2.044.816 2.864 2.864 0 0 0 2.894-2.831 2.83 2.83 0 0 0-1.081-2.203 2.94 2.94 0 0 0 1.3.303 2.837 2.837 0 0 0 2.874-2.593 2.83 2.83 0 0 0-2.403-3.03 3.078 3.078 0 0 0-.659-.073 2.827 2.827 0 0 0-2.644 1.742l.043-.256c.049-.509.145-1.012.286-1.503l.074-.232c.496-1.41 1.513-1.86 1.513-1.86V69h-4.394v.465s1.017.448 1.513 1.86c.048.14.087.265.12.385.113.443.194.894.24 1.349.014.085.027.17.043.258a2.835 2.835 0 0 0-2.65-1.742c-.222 0-.443.025-.66.073a2.83 2.83 0 0 0-2.402 3.03 2.837 2.837 0 0 0 2.874 2.592l-.006-.002Z"})]})]}),a.jsxs("defs",{children:[a.jsxs("filter",{id:b,width:"71.684",height:"77.938",x:"23.658",y:"17.031",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[a.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),a.jsx("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),a.jsx("feOffset",{}),a.jsx("feGaussianBlur",{stdDeviation:"2"}),a.jsx("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0"}),a.jsx("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_26376_152228"}),a.jsx("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_26376_152228",result:"shape"})]}),a.jsxs("filter",{id:x,width:"51",height:"67",x:"19",y:"22",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[a.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),a.jsx("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),a.jsx("feOffset",{}),a.jsx("feGaussianBlur",{stdDeviation:"2"}),a.jsx("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0"}),a.jsx("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_26376_152228"}),a.jsx("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_26376_152228",result:"shape"})]})]})]})})}));A.displayName="Cards";const Y="animatedIconContainer--ef6d6",L=G.memo((({AnimatedElement:t})=>{const{state:K,animationType:D}=I(),N=G.useMemo((()=>"arrows"===t?a.jsx(H,{spinButtonState:K,animationType:D}):"cards"===t?a.jsx(A,{spinButtonState:K,animationType:D}):a.jsx(t,{spinButtonState:K,animationType:D})),[t,D,K]);return a.jsx("div",{"data-role":"animated-element-container",className:Y,children:N})}));L.displayName="SpinButtonAnimatedElement";const S="background--132f2",f=({element:t})=>a.jsx("div",{className:S,"data-role":"custom-background",children:t}),$=G.memo((({iconComponent:t})=>a.jsx("div",{className:q.icon,children:t})));$.displayName="SpinButtonIcon";var B=D(297318),O=D(228174),v=D(124315);const p=.295,j=({spinButtonSize:t,labelText:K})=>{const{labelRef:D,labelContainerRef:N,resize:W}=function(t){const K=G.useRef(null),D=G.useRef(null),a=v.i(),N=G.useCallback((()=>{const t=K.current,a=D.current;if(!t||!(null==a?void 0:a.parentElement))return;t.style.width="",t.style.fontSize="";const G=parseFloat(window.getComputedStyle(t).fontSize),N=a.parentElement.getBoundingClientRect(),W=new B.I(N.left+N.width/2,N.top+N.height/2),x=N.width*p,b=Math.max(N.width,N.height)/2,n=t.getBoundingClientRect(),e=parseFloat(window.getComputedStyle(a).marginTop),i=parseFloat(window.getComputedStyle(a).marginLeft),z=e/2,I=[new B.I(n.left,n.top-z),new B.I(n.right,n.top-z),new B.I(n.right,n.bottom-z),new B.I(n.left,n.bottom-z)],Z=I.reduce(((t,K)=>W.distanceTo(t)>W.distanceTo(K)?t:K),I[0]),w=(b-i+1)/W.distanceTo(Z),m=O.GB(G*w,3);t.style.fontSize=`${Math.min(m,x)}px`,t.style.width="100%"}),[]);return G.useEffect((()=>{a&&N()}),[a,N,t]),{labelRef:K,resize:N,labelContainerRef:D}}(t);G.useLayoutEffect((()=>{W()}),[W,K]),G.useEffect((()=>(window.addEventListener("resize",W),()=>{window.removeEventListener("resize",W)})),[]);const{spinButtonLabelRepositioned:b}=x.vL();return a.jsx("div",{className:q.labelContainer,ref:N,children:a.jsx("span",{className:q.label,"data-role":"spin-button-label",style:{whiteSpace:b?"nowrap":"normal",marginBottom:b?"8%":"1%"},ref:D,children:K})})},r="glare--6265d",M=G.memo((()=>{const t=G.useId(),K=`glare-gradient-${t}`,D=`glare-c-${t}`,N=`glare-d-${t}`,W=`glare-e-${t}`,x=`glare-f-${t}`;return a.jsx("div",{className:r,children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 122 122",children:[a.jsx("path",{fill:`url(#${K})`,fillRule:"evenodd",d:"M58 70c43-10 64 24 64-9 0-34-27-61-61-61S0 27 0 61c0 33 16 20 58 9Z",clipRule:"evenodd",opacity:".8"}),a.jsx("g",{filter:`url(#${D})`,children:a.jsx("path",{stroke:`url(#${N})`,d:"M61 117A56 56 0 1 0 61 5a56 56 0 0 0 0 112Z"})}),a.jsx("g",{filter:`url(#${W})`,children:a.jsx("path",{fill:`url(#${x})`,fillRule:"evenodd",d:"M60 0C27 0 0 27 0 60L60 0Z",clipRule:"evenodd"})}),a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:K,x1:"61",x2:"61",y1:"0",y2:"46.1",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#fff",stopOpacity:".7"}),a.jsx("stop",{offset:"1",stopColor:"#fff",stopOpacity:"0"})]}),a.jsxs("linearGradient",{id:N,x1:"-21.6",x2:"156.9",y1:"-16.9",y2:"98.7",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#fff"}),a.jsx("stop",{offset:".1",stopColor:"#fff",stopOpacity:".6"}),a.jsx("stop",{offset:".2",stopColor:"#fff",stopOpacity:".7"}),a.jsx("stop",{offset:".3",stopColor:"#fff",stopOpacity:"0"}),a.jsx("stop",{offset:".7",stopColor:"#fff",stopOpacity:"0"}),a.jsx("stop",{offset:"1",stopColor:"#fff"})]}),a.jsxs("linearGradient",{id:x,x1:"18.1",x2:"20.8",y1:"17",y2:"19.7",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#FBFFEA",stopOpacity:".8"}),a.jsx("stop",{offset:"1",stopColor:"#F2FFB5",stopOpacity:"0"})]}),a.jsxs("filter",{id:D,width:"114.2",height:"114.2",x:"4",y:"4",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[a.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),a.jsx("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),a.jsx("feGaussianBlur",{result:"effect1_foregroundBlur_21872_12807",stdDeviation:".3"})]}),a.jsxs("filter",{id:W,width:"61.2",height:"61.2",x:"-1",y:"-1",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[a.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),a.jsx("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),a.jsx("feGaussianBlur",{result:"effect1_foregroundBlur_21872_12807",stdDeviation:".3"})]})]})]})})}));M.displayName="Glare";const k=({children:t})=>a.jsxs("div",{className:q.reactiveWrapper,"data-role":"spin-button-reactive-wrapper",children:[a.jsx("div",{className:q.reactiveBaseStroke}),a.jsx("div",{className:q.reactiveBaseFill}),t]}),tt="timerContainer--5b6ef",Kt="gradientFill--060dc",Dt="gradientMask--9f64f",at=({timerDuration:t})=>a.jsx("div",{className:tt,"data-role":"spin-disabled-timer",style:{animationDuration:`${t}ms`},children:a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("foreignObject",{x:"0",y:"0",width:"100",height:"100",children:a.jsx("div",{className:Kt})}),a.jsxs("g",{className:Dt,children:[a.jsx("rect",{x:"0",y:"0",width:"100",height:"100"}),a.jsx("path",{d:"M 50 96 a 46 46 0 0 1 0 -92 46 46 0 0 1 0 92",style:{animationDuration:`${t}ms`}})]})]})}),Gt=({size:t,labelText:K,displaySmokePattern:D,icon:G,background:N,AnimatedElement:W})=>{const{state:x,timerDuration:b}=I();return a.jsx("div",{className:e.A(q.baseRim,q[t]),"data-role":"spin-button-rim",children:a.jsx("div",{className:q.baseStroke,"data-role":"spin-button-stroke",children:a.jsxs("div",{className:q.baseFill,children:[b&&a.jsx(at,{timerDuration:b}),a.jsxs(k,{children:[N&&a.jsx(f,{element:N}),D&&a.jsx("div",{className:q.smokePattern}),"Disabled"!==x&&a.jsx(M,{}),!G&&W&&a.jsx(L,{AnimatedElement:W}),G?a.jsx($,{iconComponent:G}):a.jsx(j,{labelText:K,spinButtonSize:t})]})]})})})},Nt=G.memo((({size:t,labelText:K=x.Tl("spin.uppercase"),onClick:D,onDisabledClick:G,displaySmokePattern:N,disableInteractionAnimation:W=!1,state:e="Default",layerStyles:i,badgeValue:z=0,icon:I,timerDuration:Z,tooltipTranslationKey:w,soundToPlay:E,background:l,AnimatedElement:y="arrows",BackPlate:h,disableGlowAnimation:J=!1,disableCtaAnimation:T=!1})=>{const _={state:e,disableInteractionAnimation:W,timerDuration:Z,disableCtaAnimation:T},{isSmallScreen:C,isMediumScreen:H}=b.Qo(n.Q.size.value);return a.jsx(P,{props:_,children:a.jsxs(X,{layerStyles:i,children:[!!h&&a.jsx(Q,{children:({buttonState:t})=>a.jsx(h,{buttonState:t})}),!J&&a.jsx(m,{}),a.jsx(d.N,{isPhone:C,isTablet:H,state:e,onClick:D,onDisabledClick:G,tooltip:w,soundToPlay:E,hideTooltipAfterClick:"Disabled"!==e,buttonContent:a.jsx(Gt,{labelText:K,displaySmokePattern:N,icon:I,size:t,background:l,AnimatedElement:y}),size:"adjusting"}),z>0&&a.jsx("div",{className:q.badge,children:a.jsx(u.Ex,{value:z,theme:"goldenGradient",scale:Wt[t]})})]})})}));Nt.displayName="SpinButton";const Wt={xxl:2.5,xl:2.4,lg:2.1,md:1.9,sm:1.7,xs:1.5,xxs:1.4,xxxs:1.25},xt="spinButtonContainer--8391d",bt=G.forwardRef((({disabled:t=!1,onClick:K,onDisabledClick:D,labelText:x,layerStyles:b,onPress:n,onReleaseOutside:e,onMouseEnter:i,onMouseLeave:z,tooltip:I},Z)=>{const w=N.DS.DeviceProperties.platform===W.OD.Desktop?"xl":N.DS.DeviceProperties.platform===W.OD.Tablet?"md":"xs",{onPresInside:m}=function({onPress:t,onReleaseOutside:K,ref:D}){const[a,N]=G.useState(!1);return G.useEffect((()=>{if(!a)return;const t=t=>{var a;(null===(a=D.current)||void 0===a?void 0:a.contains(t.target))||null==K||K(),N(!1)};return window.document.addEventListener("pointerup",t),()=>{window.document.removeEventListener("pointerup",t)}}),[K,a]),{ref:D,onPresInside:()=>{N(!0),null==t||t()}}}({onPress:n,onReleaseOutside:e,ref:Z});return a.jsx("div",{ref:Z,onPointerDown:m,onMouseEnter:i,onMouseLeave:z,className:xt,children:a.jsx(Nt,{size:w,onClick:K,onDisabledClick:D,labelText:x,AnimatedElement:"arrows",displaySmokePattern:!0,state:t?"Disabled":"Default",layerStyles:b,disableInteractionAnimation:!1,disableCtaAnimation:!1,tooltipTranslationKey:I})})}))},399158:(t,K,D)=>{D.d(K,{t:()=>EG,g:()=>dG});var a=D(297809),G=D(760998),N=D(604910),W=D(564135),x=D(779908),b=D(690096),n=D(869581);n.b.AddNodeConstructor("TargetCamera",((t,K)=>()=>new e(t,N.Pq.Zero(),K)));class e extends W.i{constructor(t,K,D,a=!0){super(t,K,D,a),this._tmpUpVector=N.Pq.Zero(),this._tmpTargetVector=N.Pq.Zero(),this.cameraDirection=new N.Pq(0,0,0),this.cameraRotation=new N.I9(0,0),this.ignoreParentScaling=!1,this.updateUpVectorFromRotation=!1,this._tmpQuaternion=new N.PT,this.rotation=new N.Pq(0,0,0),this.speed=2,this.noRotationConstraint=!1,this.invertRotation=!1,this.inverseRotationSpeed=.2,this.lockedTarget=null,this._currentTarget=N.Pq.Zero(),this._initialFocalDistance=1,this._viewMatrix=N.uq.Zero(),this._camMatrix=N.uq.Zero(),this._cameraTransformMatrix=N.uq.Zero(),this._cameraRotationMatrix=N.uq.Zero(),this._referencePoint=new N.Pq(0,0,1),this._transformedReferencePoint=N.Pq.Zero(),this._deferredPositionUpdate=new N.Pq,this._deferredRotationQuaternionUpdate=new N.PT,this._deferredRotationUpdate=new N.Pq,this._deferredUpdated=!1,this._deferOnly=!1,this._defaultUp=N.Pq.Up(),this._cachedRotationZ=0,this._cachedQuaternionRotationZ=0}getFrontPosition(t){this.getWorldMatrix();const K=this.getTarget().subtract(this.position);return K.normalize(),K.scaleInPlace(t),this.globalPosition.add(K)}_getLockedTargetPosition(){if(!this.lockedTarget)return null;if(this.lockedTarget.absolutePosition){const t=this.lockedTarget;t.computeWorldMatrix().getTranslationToRef(t.absolutePosition)}return this.lockedTarget.absolutePosition||this.lockedTarget}storeState(){return this._storedPosition=this.position.clone(),this._storedRotation=this.rotation.clone(),this.rotationQuaternion&&(this._storedRotationQuaternion=this.rotationQuaternion.clone()),super.storeState()}_restoreStateValues(){return!!super._restoreStateValues()&&(this.position=this._storedPosition.clone(),this.rotation=this._storedRotation.clone(),this.rotationQuaternion&&(this.rotationQuaternion=this._storedRotationQuaternion.clone()),this.cameraDirection.copyFromFloats(0,0,0),this.cameraRotation.copyFromFloats(0,0),!0)}_initCache(){super._initCache(),this._cache.lockedTarget=new N.Pq(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotation=new N.Pq(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotationQuaternion=new N.PT(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)}_updateCache(t){t||super._updateCache();const K=this._getLockedTargetPosition();K?this._cache.lockedTarget?this._cache.lockedTarget.copyFrom(K):this._cache.lockedTarget=K.clone():this._cache.lockedTarget=null,this._cache.rotation.copyFrom(this.rotation),this.rotationQuaternion&&this._cache.rotationQuaternion.copyFrom(this.rotationQuaternion)}_isSynchronizedViewMatrix(){if(!super._isSynchronizedViewMatrix())return!1;const t=this._getLockedTargetPosition();return(this._cache.lockedTarget?this._cache.lockedTarget.equals(t):!t)&&(this.rotationQuaternion?this.rotationQuaternion.equals(this._cache.rotationQuaternion):this._cache.rotation.equals(this.rotation))}_computeLocalCameraSpeed(){const t=this.getEngine();return this.speed*Math.sqrt(t.getDeltaTime()/(100*t.getFps()))}setTarget(t){this.upVector.normalize(),this._initialFocalDistance=t.subtract(this.position).length(),this.position.z===t.z&&(this.position.z+=x.bH),this._referencePoint.normalize().scaleInPlace(this._initialFocalDistance),N.uq.LookAtLHToRef(this.position,t,this._defaultUp,this._camMatrix),this._camMatrix.invert(),this.rotation.x=Math.atan(this._camMatrix.m[6]/this._camMatrix.m[10]);const K=t.subtract(this.position);K.x>=0?this.rotation.y=-Math.atan(K.z/K.x)+Math.PI/2:this.rotation.y=-Math.atan(K.z/K.x)-Math.PI/2,this.rotation.z=0,isNaN(this.rotation.x)&&(this.rotation.x=0),isNaN(this.rotation.y)&&(this.rotation.y=0),isNaN(this.rotation.z)&&(this.rotation.z=0),this.rotationQuaternion&&N.PT.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this.rotationQuaternion)}get target(){return this.getTarget()}set target(t){this.setTarget(t)}getTarget(){return this._currentTarget}_decideIfNeedsToMove(){return Math.abs(this.cameraDirection.x)>0||Math.abs(this.cameraDirection.y)>0||Math.abs(this.cameraDirection.z)>0}_updatePosition(){if(this.parent)return this.parent.getWorldMatrix().invertToRef(N.AA.Matrix[0]),N.Pq.TransformNormalToRef(this.cameraDirection,N.AA.Matrix[0],N.AA.Vector3[0]),this._deferredPositionUpdate.addInPlace(N.AA.Vector3[0]),void(this._deferOnly?this._deferredUpdated=!0:this.position.copyFrom(this._deferredPositionUpdate));this._deferredPositionUpdate.addInPlace(this.cameraDirection),this._deferOnly?this._deferredUpdated=!0:this.position.copyFrom(this._deferredPositionUpdate)}_checkInputs(){const t=this.invertRotation?-this.inverseRotationSpeed:1,K=this._decideIfNeedsToMove(),D=this.cameraRotation.x||this.cameraRotation.y;if(this._deferredUpdated=!1,this._deferredRotationUpdate.copyFrom(this.rotation),this._deferredPositionUpdate.copyFrom(this.position),this.rotationQuaternion&&this._deferredRotationQuaternionUpdate.copyFrom(this.rotationQuaternion),K&&this._updatePosition(),D){if(this.rotationQuaternion&&this.rotationQuaternion.toEulerAnglesToRef(this._deferredRotationUpdate),this._deferredRotationUpdate.x+=this.cameraRotation.x*t,this._deferredRotationUpdate.y+=this.cameraRotation.y*t,!this.noRotationConstraint){const t=1.570796;this._deferredRotationUpdate.x>t&&(this._deferredRotationUpdate.x=t),this._deferredRotationUpdate.x<-t&&(this._deferredRotationUpdate.x=-t)}this._deferOnly?this._deferredUpdated=!0:this.rotation.copyFrom(this._deferredRotationUpdate),this.rotationQuaternion&&this._deferredRotationUpdate.lengthSquared()&&(N.PT.RotationYawPitchRollToRef(this._deferredRotationUpdate.y,this._deferredRotationUpdate.x,this._deferredRotationUpdate.z,this._deferredRotationQuaternionUpdate),this._deferOnly?this._deferredUpdated=!0:this.rotationQuaternion.copyFrom(this._deferredRotationQuaternionUpdate))}K&&(Math.abs(this.cameraDirection.x)<this.speed*x.bH&&(this.cameraDirection.x=0),Math.abs(this.cameraDirection.y)<this.speed*x.bH&&(this.cameraDirection.y=0),Math.abs(this.cameraDirection.z)<this.speed*x.bH&&(this.cameraDirection.z=0),this.cameraDirection.scaleInPlace(this.inertia)),D&&(Math.abs(this.cameraRotation.x)<this.speed*x.bH&&(this.cameraRotation.x=0),Math.abs(this.cameraRotation.y)<this.speed*x.bH&&(this.cameraRotation.y=0),this.cameraRotation.scaleInPlace(this.inertia)),super._checkInputs()}_updateCameraRotationMatrix(){this.rotationQuaternion?this.rotationQuaternion.toRotationMatrix(this._cameraRotationMatrix):N.uq.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this._cameraRotationMatrix)}_rotateUpVectorWithCameraRotationMatrix(){return N.Pq.TransformNormalToRef(this._defaultUp,this._cameraRotationMatrix,this.upVector),this}_getViewMatrix(){return this.lockedTarget&&this.setTarget(this._getLockedTargetPosition()),this._updateCameraRotationMatrix(),this.rotationQuaternion&&this._cachedQuaternionRotationZ!=this.rotationQuaternion.z?(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedQuaternionRotationZ=this.rotationQuaternion.z):this._cachedRotationZ!==this.rotation.z&&(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedRotationZ=this.rotation.z),N.Pq.TransformCoordinatesToRef(this._referencePoint,this._cameraRotationMatrix,this._transformedReferencePoint),this.position.addToRef(this._transformedReferencePoint,this._currentTarget),this.updateUpVectorFromRotation&&(this.rotationQuaternion?b._0.Y.rotateByQuaternionToRef(this.rotationQuaternion,this.upVector):(N.PT.FromEulerVectorToRef(this.rotation,this._tmpQuaternion),b._0.Y.rotateByQuaternionToRef(this._tmpQuaternion,this.upVector))),this._computeViewMatrix(this.position,this._currentTarget,this.upVector),this._viewMatrix}_computeViewMatrix(t,K,D){if(this.ignoreParentScaling){if(this.parent){const a=this.parent.getWorldMatrix();N.Pq.TransformCoordinatesToRef(t,a,this._globalPosition),N.Pq.TransformCoordinatesToRef(K,a,this._tmpTargetVector),N.Pq.TransformNormalToRef(D,a,this._tmpUpVector),this._markSyncedWithParent()}else this._globalPosition.copyFrom(t),this._tmpTargetVector.copyFrom(K),this._tmpUpVector.copyFrom(D);this.getScene().useRightHandedSystem?N.uq.LookAtRHToRef(this._globalPosition,this._tmpTargetVector,this._tmpUpVector,this._viewMatrix):N.uq.LookAtLHToRef(this._globalPosition,this._tmpTargetVector,this._tmpUpVector,this._viewMatrix)}else if(this.getScene().useRightHandedSystem?N.uq.LookAtRHToRef(t,K,D,this._viewMatrix):N.uq.LookAtLHToRef(t,K,D,this._viewMatrix),this.parent){const t=this.parent.getWorldMatrix();this._viewMatrix.invert(),this._viewMatrix.multiplyToRef(t,this._viewMatrix),this._viewMatrix.getTranslationToRef(this._globalPosition),this._viewMatrix.invert(),this._markSyncedWithParent()}else this._globalPosition.copyFrom(t)}createRigCamera(t,K){if(this.cameraRigMode!==W.i.RIG_MODE_NONE){const K=new e(t,this.position.clone(),this.getScene());return K.isRigCamera=!0,K.rigParent=this,this.cameraRigMode===W.i.RIG_MODE_VR&&(this.rotationQuaternion||(this.rotationQuaternion=new N.PT),K._cameraRigParams={},K.rotationQuaternion=new N.PT),K.mode=this.mode,K.orthoLeft=this.orthoLeft,K.orthoRight=this.orthoRight,K.orthoTop=this.orthoTop,K.orthoBottom=this.orthoBottom,K}return null}_updateRigCameras(){const t=this._rigCameras[0],K=this._rigCameras[1];switch(this.computeWorldMatrix(),this.cameraRigMode){case W.i.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case W.i.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case W.i.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case W.i.RIG_MODE_STEREOSCOPIC_OVERUNDER:case W.i.RIG_MODE_STEREOSCOPIC_INTERLACED:{const D=this.cameraRigMode===W.i.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?1:-1,a=this.cameraRigMode===W.i.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?-1:1;this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*D,t),this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*a,K);break}case W.i.RIG_MODE_VR:t.rotationQuaternion?(t.rotationQuaternion.copyFrom(this.rotationQuaternion),K.rotationQuaternion.copyFrom(this.rotationQuaternion)):(t.rotation.copyFrom(this.rotation),K.rotation.copyFrom(this.rotation)),t.position.copyFrom(this.position),K.position.copyFrom(this.position)}super._updateRigCameras()}_getRigCamPositionAndTarget(t,K){this.getTarget().subtractToRef(this.position,e._TargetFocalPoint),e._TargetFocalPoint.normalize().scaleInPlace(this._initialFocalDistance);const D=e._TargetFocalPoint.addInPlace(this.position);N.uq.TranslationToRef(-D.x,-D.y,-D.z,e._TargetTransformMatrix),e._TargetTransformMatrix.multiplyToRef(N.uq.RotationAxis(K.upVector,t),e._RigCamTransformMatrix),N.uq.TranslationToRef(D.x,D.y,D.z,e._TargetTransformMatrix),e._RigCamTransformMatrix.multiplyToRef(e._TargetTransformMatrix,e._RigCamTransformMatrix),N.Pq.TransformCoordinatesToRef(this.position,e._RigCamTransformMatrix,K.position),K.setTarget(D)}getClassName(){return"TargetCamera"}}e._RigCamTransformMatrix=new N.uq,e._TargetTransformMatrix=new N.uq,e._TargetFocalPoint=new N.Pq,a.Cg([G.P_()],e.prototype,"rotation",void 0),a.Cg([G.lK()],e.prototype,"speed",void 0),a.Cg([G.xG("lockedTargetId")],e.prototype,"lockedTarget",void 0);var i=D(706400),z=D(337776),I={};class Z{constructor(t){this.attachedToElement=!1,this.attached={},this.camera=t,this.checkInputs=()=>{}}add(t){const K=t.getSimpleName();this.attached[K]?i.V.Warn("camera input of type "+K+" already exists on camera"):(this.attached[K]=t,t.camera=this.camera,t.checkInputs&&(this.checkInputs=this._addCheckInputs(t.checkInputs.bind(t))),this.attachedToElement&&t.attachControl(this.noPreventDefault))}remove(t){for(const K in this.attached){const D=this.attached[K];if(D===t)return D.detachControl(),D.camera=null,delete this.attached[K],void this.rebuildInputCheck()}}removeByType(t){for(const K in this.attached){const D=this.attached[K];D.getClassName()===t&&(D.detachControl(),D.camera=null,delete this.attached[K],this.rebuildInputCheck())}}_addCheckInputs(t){const K=this.checkInputs;return()=>{K(),t()}}attachInput(t){this.attachedToElement&&t.attachControl(this.noPreventDefault)}attachElement(t=!1){if(!this.attachedToElement){t=!W.i.ForceAttachControlToAlwaysPreventDefault&&t,this.attachedToElement=!0,this.noPreventDefault=t;for(const K in this.attached)this.attached[K].attachControl(t)}}detachElement(t=!1){for(const K in this.attached)this.attached[K].detachControl(),t&&(this.attached[K].camera=null);this.attachedToElement=!1}rebuildInputCheck(){this.checkInputs=()=>{};for(const t in this.attached){const K=this.attached[t];K.checkInputs&&(this.checkInputs=this._addCheckInputs(K.checkInputs.bind(K)))}}clear(){this.attachedToElement&&this.detachElement(!0),this.attached={},this.attachedToElement=!1,this.checkInputs=()=>{}}serialize(t){const K={};for(const t in this.attached){const D=this.attached[t],a=z.p.Serialize(D);K[D.getClassName()]=a}t.inputsmgr=K}parse(t){const K=t.inputsmgr;if(K){this.clear();for(const t in K){const D=I[t];if(D){const a=K[t],G=z.p.Parse((()=>new D),a,null);this.add(G)}}}else for(const K in this.attached){const D=I[this.attached[K].getClassName()];if(D){const a=z.p.Parse((()=>new D),t,null);this.remove(this.attached[K]),this.add(a)}}}}var w=D(834255),m=D(898973);class u{constructor(){this.keysUp=[38],this.keysUpward=[33],this.keysDown=[40],this.keysDownward=[34],this.keysLeft=[37],this.keysRight=[39],this.rotationSpeed=.5,this.keysRotateLeft=[],this.keysRotateRight=[],this.keysRotateUp=[],this.keysRotateDown=[],this._keys=new Array}attachControl(t){t=m.S0.BackCompatCameraNoPreventDefault(arguments),this._onCanvasBlurObserver||(this._scene=this.camera.getScene(),this._engine=this._scene.getEngine(),this._onCanvasBlurObserver=this._engine.onCanvasBlurObservable.add((()=>{this._keys.length=0})),this._onKeyboardObserver=this._scene.onKeyboardObservable.add((K=>{const D=K.event;if(!D.metaKey)if(K.type===w.TB.KEYDOWN)-1===this.keysUp.indexOf(D.keyCode)&&-1===this.keysDown.indexOf(D.keyCode)&&-1===this.keysLeft.indexOf(D.keyCode)&&-1===this.keysRight.indexOf(D.keyCode)&&-1===this.keysUpward.indexOf(D.keyCode)&&-1===this.keysDownward.indexOf(D.keyCode)&&-1===this.keysRotateLeft.indexOf(D.keyCode)&&-1===this.keysRotateRight.indexOf(D.keyCode)&&-1===this.keysRotateUp.indexOf(D.keyCode)&&-1===this.keysRotateDown.indexOf(D.keyCode)||(-1===this._keys.indexOf(D.keyCode)&&this._keys.push(D.keyCode),t||D.preventDefault());else if(-1!==this.keysUp.indexOf(D.keyCode)||-1!==this.keysDown.indexOf(D.keyCode)||-1!==this.keysLeft.indexOf(D.keyCode)||-1!==this.keysRight.indexOf(D.keyCode)||-1!==this.keysUpward.indexOf(D.keyCode)||-1!==this.keysDownward.indexOf(D.keyCode)||-1!==this.keysRotateLeft.indexOf(D.keyCode)||-1!==this.keysRotateRight.indexOf(D.keyCode)||-1!==this.keysRotateUp.indexOf(D.keyCode)||-1!==this.keysRotateDown.indexOf(D.keyCode)){const K=this._keys.indexOf(D.keyCode);K>=0&&this._keys.splice(K,1),t||D.preventDefault()}})))}detachControl(){this._scene&&(this._onKeyboardObserver&&this._scene.onKeyboardObservable.remove(this._onKeyboardObserver),this._onCanvasBlurObserver&&this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),this._onKeyboardObserver=null,this._onCanvasBlurObserver=null),this._keys.length=0}checkInputs(){if(this._onKeyboardObserver){const t=this.camera;for(let K=0;K<this._keys.length;K++){const D=this._keys[K],a=t._computeLocalCameraSpeed();-1!==this.keysLeft.indexOf(D)?t._localDirection.copyFromFloats(-a,0,0):-1!==this.keysUp.indexOf(D)?t._localDirection.copyFromFloats(0,0,a):-1!==this.keysRight.indexOf(D)?t._localDirection.copyFromFloats(a,0,0):-1!==this.keysDown.indexOf(D)?t._localDirection.copyFromFloats(0,0,-a):-1!==this.keysUpward.indexOf(D)?t._localDirection.copyFromFloats(0,a,0):-1!==this.keysDownward.indexOf(D)?t._localDirection.copyFromFloats(0,-a,0):-1!==this.keysRotateLeft.indexOf(D)?(t._localDirection.copyFromFloats(0,0,0),t.cameraRotation.y-=this._getLocalRotation()):-1!==this.keysRotateRight.indexOf(D)?(t._localDirection.copyFromFloats(0,0,0),t.cameraRotation.y+=this._getLocalRotation()):-1!==this.keysRotateUp.indexOf(D)?(t._localDirection.copyFromFloats(0,0,0),t.cameraRotation.x-=this._getLocalRotation()):-1!==this.keysRotateDown.indexOf(D)&&(t._localDirection.copyFromFloats(0,0,0),t.cameraRotation.x+=this._getLocalRotation()),t.getScene().useRightHandedSystem&&(t._localDirection.z*=-1),t.getViewMatrix().invertToRef(t._cameraTransformMatrix),N.Pq.TransformNormalToRef(t._localDirection,t._cameraTransformMatrix,t._transformedDirection),t.cameraDirection.addInPlace(t._transformedDirection)}}}getClassName(){return"FreeCameraKeyboardMoveInput"}_onLostFocus(){this._keys.length=0}getSimpleName(){return"keyboard"}_getLocalRotation(){const t=this.camera._calculateHandednessMultiplier();return this.rotationSpeed*this._engine.getDeltaTime()/1e3*t}}a.Cg([G.lK()],u.prototype,"keysUp",void 0),a.Cg([G.lK()],u.prototype,"keysUpward",void 0),a.Cg([G.lK()],u.prototype,"keysDown",void 0),a.Cg([G.lK()],u.prototype,"keysDownward",void 0),a.Cg([G.lK()],u.prototype,"keysLeft",void 0),a.Cg([G.lK()],u.prototype,"keysRight",void 0),a.Cg([G.lK()],u.prototype,"rotationSpeed",void 0),a.Cg([G.lK()],u.prototype,"keysRotateLeft",void 0),a.Cg([G.lK()],u.prototype,"keysRotateRight",void 0),a.Cg([G.lK()],u.prototype,"keysRotateUp",void 0),a.Cg([G.lK()],u.prototype,"keysRotateDown",void 0),I["FreeCameraKeyboardMoveInput"]=u;var d=D(638113),E=D(706211);class l{constructor(t=!0){this.touchEnabled=t,this.buttons=[0,1,2],this.angularSensibility=2e3,this._previousPosition=null,this.onPointerMovedObservable=new d.cP,this._allowCameraRotation=!0,this._currentActiveButton=-1,this._activePointerId=-1}attachControl(t){t=m.S0.BackCompatCameraNoPreventDefault(arguments);const K=this.camera.getEngine(),D=K.getInputElement();this._pointerInput||(this._pointerInput=a=>{const G=a.event,N="touch"===G.pointerType;if(!this.touchEnabled&&N)return;if(a.type!==E.Zp.POINTERMOVE&&-1===this.buttons.indexOf(G.button))return;const W=G.target;if(a.type===E.Zp.POINTERDOWN){if(N&&-1!==this._activePointerId||!N&&-1!==this._currentActiveButton)return;this._activePointerId=G.pointerId;try{null==W||W.setPointerCapture(G.pointerId)}catch(t){}-1===this._currentActiveButton&&(this._currentActiveButton=G.button),this._previousPosition={x:G.clientX,y:G.clientY},t||(G.preventDefault(),D&&D.focus()),K.isPointerLock&&this._onMouseMove&&this._onMouseMove(a.event)}else if(a.type===E.Zp.POINTERUP){if(N&&this._activePointerId!==G.pointerId||!N&&this._currentActiveButton!==G.button)return;try{null==W||W.releasePointerCapture(G.pointerId)}catch(t){}this._currentActiveButton=-1,this._previousPosition=null,t||G.preventDefault(),this._activePointerId=-1}else if(a.type===E.Zp.POINTERMOVE&&(this._activePointerId===G.pointerId||!N))if(K.isPointerLock&&this._onMouseMove)this._onMouseMove(a.event);else if(this._previousPosition){const K=this.camera._calculateHandednessMultiplier(),D=(G.clientX-this._previousPosition.x)*K,a=G.clientY-this._previousPosition.y;this._allowCameraRotation&&(this.camera.cameraRotation.y+=D/this.angularSensibility,this.camera.cameraRotation.x+=a/this.angularSensibility),this.onPointerMovedObservable.notifyObservers({offsetX:D,offsetY:a}),this._previousPosition={x:G.clientX,y:G.clientY},t||G.preventDefault()}}),this._onMouseMove=D=>{if(!K.isPointerLock)return;const a=this.camera._calculateHandednessMultiplier(),G=D.movementX*a;this.camera.cameraRotation.y+=G/this.angularSensibility;const N=D.movementY;this.camera.cameraRotation.x+=N/this.angularSensibility,this._previousPosition=null,t||D.preventDefault()},this._observer=this.camera.getScene()._inputManager._addCameraPointerObserver(this._pointerInput,E.Zp.POINTERDOWN|E.Zp.POINTERUP|E.Zp.POINTERMOVE),D&&(this._contextMenuBind=t=>this.onContextMenu(t),D.addEventListener("contextmenu",this._contextMenuBind,!1))}onContextMenu(t){t.preventDefault()}detachControl(){if(this._observer){if(this.camera.getScene()._inputManager._removeCameraPointerObserver(this._observer),this._contextMenuBind){const t=this.camera.getEngine().getInputElement();t&&t.removeEventListener("contextmenu",this._contextMenuBind)}this.onPointerMovedObservable&&this.onPointerMovedObservable.clear(),this._observer=null,this._onMouseMove=null,this._previousPosition=null}this._activePointerId=-1,this._currentActiveButton=-1}getClassName(){return"FreeCameraMouseInput"}getSimpleName(){return"mouse"}}a.Cg([G.lK()],l.prototype,"buttons",void 0),a.Cg([G.lK()],l.prototype,"angularSensibility",void 0),I["FreeCameraMouseInput"]=l;var Q,P=D(332108);class y{constructor(){this.wheelPrecisionX=3,this.wheelPrecisionY=3,this.wheelPrecisionZ=3,this.onChangedObservable=new d.cP,this._wheelDeltaX=0,this._wheelDeltaY=0,this._wheelDeltaZ=0,this._ffMultiplier=12,this._normalize=120}attachControl(t){t=m.S0.BackCompatCameraNoPreventDefault(arguments),this._wheel=K=>{if(K.type!==E.Zp.POINTERWHEEL)return;const D=K.event,a=D.deltaMode===P.s.DOM_DELTA_LINE?this._ffMultiplier:1;this._wheelDeltaX+=this.wheelPrecisionX*a*D.deltaX/this._normalize,this._wheelDeltaY-=this.wheelPrecisionY*a*D.deltaY/this._normalize,this._wheelDeltaZ+=this.wheelPrecisionZ*a*D.deltaZ/this._normalize,D.preventDefault&&(t||D.preventDefault())},this._observer=this.camera.getScene()._inputManager._addCameraPointerObserver(this._wheel,E.Zp.POINTERWHEEL)}detachControl(){this._observer&&(this.camera.getScene()._inputManager._removeCameraPointerObserver(this._observer),this._observer=null,this._wheel=null),this.onChangedObservable&&this.onChangedObservable.clear()}checkInputs(){this.onChangedObservable.notifyObservers({wheelDeltaX:this._wheelDeltaX,wheelDeltaY:this._wheelDeltaY,wheelDeltaZ:this._wheelDeltaZ}),this._wheelDeltaX=0,this._wheelDeltaY=0,this._wheelDeltaZ=0}getClassName(){return"BaseCameraMouseWheelInput"}getSimpleName(){return"mousewheel"}}a.Cg([G.lK()],y.prototype,"wheelPrecisionX",void 0),a.Cg([G.lK()],y.prototype,"wheelPrecisionY",void 0),a.Cg([G.lK()],y.prototype,"wheelPrecisionZ",void 0),function(t){t[t["MoveRelative"]=0]="MoveRelative",t[t["RotateRelative"]=1]="RotateRelative",t[t["MoveScene"]=2]="MoveScene"}(Q||(Q={}));class q extends y{constructor(){super(...arguments),this._moveRelative=N.Pq.Zero(),this._rotateRelative=N.Pq.Zero(),this._moveScene=N.Pq.Zero(),this._wheelXAction=Q.MoveRelative,this._wheelXActionCoordinate=0,this._wheelYAction=Q.MoveRelative,this._wheelYActionCoordinate=2,this._wheelZAction=null,this._wheelZActionCoordinate=null}getClassName(){return"FreeCameraMouseWheelInput"}set wheelXMoveRelative(t){null===t&&this._wheelXAction!==Q.MoveRelative||(this._wheelXAction=Q.MoveRelative,this._wheelXActionCoordinate=t)}get wheelXMoveRelative(){return this._wheelXAction!==Q.MoveRelative?null:this._wheelXActionCoordinate}set wheelYMoveRelative(t){null===t&&this._wheelYAction!==Q.MoveRelative||(this._wheelYAction=Q.MoveRelative,this._wheelYActionCoordinate=t)}get wheelYMoveRelative(){return this._wheelYAction!==Q.MoveRelative?null:this._wheelYActionCoordinate}set wheelZMoveRelative(t){null===t&&this._wheelZAction!==Q.MoveRelative||(this._wheelZAction=Q.MoveRelative,this._wheelZActionCoordinate=t)}get wheelZMoveRelative(){return this._wheelZAction!==Q.MoveRelative?null:this._wheelZActionCoordinate}set wheelXRotateRelative(t){null===t&&this._wheelXAction!==Q.RotateRelative||(this._wheelXAction=Q.RotateRelative,this._wheelXActionCoordinate=t)}get wheelXRotateRelative(){return this._wheelXAction!==Q.RotateRelative?null:this._wheelXActionCoordinate}set wheelYRotateRelative(t){null===t&&this._wheelYAction!==Q.RotateRelative||(this._wheelYAction=Q.RotateRelative,this._wheelYActionCoordinate=t)}get wheelYRotateRelative(){return this._wheelYAction!==Q.RotateRelative?null:this._wheelYActionCoordinate}set wheelZRotateRelative(t){null===t&&this._wheelZAction!==Q.RotateRelative||(this._wheelZAction=Q.RotateRelative,this._wheelZActionCoordinate=t)}get wheelZRotateRelative(){return this._wheelZAction!==Q.RotateRelative?null:this._wheelZActionCoordinate}set wheelXMoveScene(t){null===t&&this._wheelXAction!==Q.MoveScene||(this._wheelXAction=Q.MoveScene,this._wheelXActionCoordinate=t)}get wheelXMoveScene(){return this._wheelXAction!==Q.MoveScene?null:this._wheelXActionCoordinate}set wheelYMoveScene(t){null===t&&this._wheelYAction!==Q.MoveScene||(this._wheelYAction=Q.MoveScene,this._wheelYActionCoordinate=t)}get wheelYMoveScene(){return this._wheelYAction!==Q.MoveScene?null:this._wheelYActionCoordinate}set wheelZMoveScene(t){null===t&&this._wheelZAction!==Q.MoveScene||(this._wheelZAction=Q.MoveScene,this._wheelZActionCoordinate=t)}get wheelZMoveScene(){return this._wheelZAction!==Q.MoveScene?null:this._wheelZActionCoordinate}checkInputs(){if(0===this._wheelDeltaX&&0===this._wheelDeltaY&&0==this._wheelDeltaZ)return;this._moveRelative.setAll(0),this._rotateRelative.setAll(0),this._moveScene.setAll(0),this._updateCamera(),this.camera.getScene().useRightHandedSystem&&(this._moveRelative.z*=-1);const t=N.uq.Zero();this.camera.getViewMatrix().invertToRef(t);const K=N.Pq.Zero();N.Pq.TransformNormalToRef(this._moveRelative,t,K),this.camera.cameraRotation.x+=this._rotateRelative.x/200,this.camera.cameraRotation.y+=this._rotateRelative.y/200,this.camera.cameraDirection.addInPlace(K),this.camera.cameraDirection.addInPlace(this._moveScene),super.checkInputs()}_updateCamera(){this._updateCameraProperty(this._wheelDeltaX,this._wheelXAction,this._wheelXActionCoordinate),this._updateCameraProperty(this._wheelDeltaY,this._wheelYAction,this._wheelYActionCoordinate),this._updateCameraProperty(this._wheelDeltaZ,this._wheelZAction,this._wheelZActionCoordinate)}_updateCameraProperty(t,K,D){if(0===t)return;if(null===K||null===D)return;let a=null;switch(K){case Q.MoveRelative:a=this._moveRelative;break;case Q.RotateRelative:a=this._rotateRelative;break;case Q.MoveScene:a=this._moveScene}switch(D){case 0:a.set(t,0,0);break;case 1:a.set(0,t,0);break;case 2:a.set(0,0,t)}}}a.Cg([G.lK()],q.prototype,"wheelXMoveRelative",null),a.Cg([G.lK()],q.prototype,"wheelYMoveRelative",null),a.Cg([G.lK()],q.prototype,"wheelZMoveRelative",null),a.Cg([G.lK()],q.prototype,"wheelXRotateRelative",null),a.Cg([G.lK()],q.prototype,"wheelYRotateRelative",null),a.Cg([G.lK()],q.prototype,"wheelZRotateRelative",null),a.Cg([G.lK()],q.prototype,"wheelXMoveScene",null),a.Cg([G.lK()],q.prototype,"wheelYMoveScene",null),a.Cg([G.lK()],q.prototype,"wheelZMoveScene",null),I["FreeCameraMouseWheelInput"]=q;class X{constructor(t=!1){this.allowMouse=t,this.touchAngularSensibility=2e5,this.touchMoveSensibility=250,this.singleFingerRotate=!1,this._offsetX=null,this._offsetY=null,this._pointerPressed=new Array,this._isSafari=m.S0.IsSafari()}attachControl(t){t=m.S0.BackCompatCameraNoPreventDefault(arguments);let K=null;if(void 0===this._pointerInput&&(this._onLostFocus=()=>{this._offsetX=null,this._offsetY=null},this._pointerInput=D=>{const a=D.event,G="mouse"===a.pointerType||this._isSafari&&void 0===a.pointerType;if(this.allowMouse||!G)if(D.type===E.Zp.POINTERDOWN){if(t||a.preventDefault(),this._pointerPressed.push(a.pointerId),1!==this._pointerPressed.length)return;K={x:a.clientX,y:a.clientY}}else if(D.type===E.Zp.POINTERUP){t||a.preventDefault();const D=this._pointerPressed.indexOf(a.pointerId);if(-1===D)return;if(this._pointerPressed.splice(D,1),0!=D)return;K=null,this._offsetX=null,this._offsetY=null}else if(D.type===E.Zp.POINTERMOVE){if(t||a.preventDefault(),!K)return;if(0!=this._pointerPressed.indexOf(a.pointerId))return;this._offsetX=a.clientX-K.x,this._offsetY=-(a.clientY-K.y)}}),this._observer=this.camera.getScene()._inputManager._addCameraPointerObserver(this._pointerInput,E.Zp.POINTERDOWN|E.Zp.POINTERUP|E.Zp.POINTERMOVE),this._onLostFocus){const t=this.camera.getEngine().getInputElement();t&&t.addEventListener("blur",this._onLostFocus)}}detachControl(){if(this._pointerInput){if(this._observer&&(this.camera.getScene()._inputManager._removeCameraPointerObserver(this._observer),this._observer=null),this._onLostFocus){const t=this.camera.getEngine().getInputElement();t&&t.removeEventListener("blur",this._onLostFocus),this._onLostFocus=null}this._pointerPressed.length=0,this._offsetX=null,this._offsetY=null}}checkInputs(){if(null===this._offsetX||null===this._offsetY)return;if(0===this._offsetX&&0===this._offsetY)return;const t=this.camera,K=t._calculateHandednessMultiplier();if(t.cameraRotation.y=K*this._offsetX/this.touchAngularSensibility,this.singleFingerRotate&&1===this._pointerPressed.length||!this.singleFingerRotate&&this._pointerPressed.length>1)t.cameraRotation.x=-this._offsetY/this.touchAngularSensibility;else{const K=t._computeLocalCameraSpeed(),D=new N.Pq(0,0,0!==this.touchMoveSensibility?K*this._offsetY/this.touchMoveSensibility:0);N.uq.RotationYawPitchRollToRef(t.rotation.y,t.rotation.x,0,t._cameraRotationMatrix),t.cameraDirection.addInPlace(N.Pq.TransformCoordinates(D,t._cameraRotationMatrix))}}getClassName(){return"FreeCameraTouchInput"}getSimpleName(){return"touch"}}a.Cg([G.lK()],X.prototype,"touchAngularSensibility",void 0),a.Cg([G.lK()],X.prototype,"touchMoveSensibility",void 0),I["FreeCameraTouchInput"]=X;class h extends Z{constructor(t){super(t),this._mouseInput=null,this._mouseWheelInput=null}addKeyboard(){return this.add(new u),this}addMouse(t=!0){return this._mouseInput||(this._mouseInput=new l(t),this.add(this._mouseInput)),this}removeMouse(){return this._mouseInput&&this.remove(this._mouseInput),this}addMouseWheel(){return this._mouseWheelInput||(this._mouseWheelInput=new q,this.add(this._mouseWheelInput)),this}removeMouseWheel(){return this._mouseWheelInput&&this.remove(this._mouseWheelInput),this}addTouch(){return this.add(new X),this}clear(){super.clear(),this._mouseInput=null}}var J=D(310035),T=D(33321);class _ extends e{get angularSensibility(){const t=this.inputs.attached["mouse"];return t?t.angularSensibility:0}set angularSensibility(t){const K=this.inputs.attached["mouse"];K&&(K.angularSensibility=t)}get keysUp(){const t=this.inputs.attached["keyboard"];return t?t.keysUp:[]}set keysUp(t){const K=this.inputs.attached["keyboard"];K&&(K.keysUp=t)}get keysUpward(){const t=this.inputs.attached["keyboard"];return t?t.keysUpward:[]}set keysUpward(t){const K=this.inputs.attached["keyboard"];K&&(K.keysUpward=t)}get keysDown(){const t=this.inputs.attached["keyboard"];return t?t.keysDown:[]}set keysDown(t){const K=this.inputs.attached["keyboard"];K&&(K.keysDown=t)}get keysDownward(){const t=this.inputs.attached["keyboard"];return t?t.keysDownward:[]}set keysDownward(t){const K=this.inputs.attached["keyboard"];K&&(K.keysDownward=t)}get keysLeft(){const t=this.inputs.attached["keyboard"];return t?t.keysLeft:[]}set keysLeft(t){const K=this.inputs.attached["keyboard"];K&&(K.keysLeft=t)}get keysRight(){const t=this.inputs.attached["keyboard"];return t?t.keysRight:[]}set keysRight(t){const K=this.inputs.attached["keyboard"];K&&(K.keysRight=t)}get keysRotateLeft(){const t=this.inputs.attached["keyboard"];return t?t.keysRotateLeft:[]}set keysRotateLeft(t){const K=this.inputs.attached["keyboard"];K&&(K.keysRotateLeft=t)}get keysRotateRight(){const t=this.inputs.attached["keyboard"];return t?t.keysRotateRight:[]}set keysRotateRight(t){const K=this.inputs.attached["keyboard"];K&&(K.keysRotateRight=t)}get keysRotateUp(){const t=this.inputs.attached["keyboard"];return t?t.keysRotateUp:[]}set keysRotateUp(t){const K=this.inputs.attached["keyboard"];K&&(K.keysRotateUp=t)}get keysRotateDown(){const t=this.inputs.attached["keyboard"];return t?t.keysRotateDown:[]}set keysRotateDown(t){const K=this.inputs.attached["keyboard"];K&&(K.keysRotateDown=t)}constructor(t,K,D,a=!0){super(t,K,D,a),this.ellipsoid=new N.Pq(.5,1,.5),this.ellipsoidOffset=new N.Pq(0,0,0),this.checkCollisions=!1,this.applyGravity=!1,this._needMoveForGravity=!1,this._oldPosition=N.Pq.Zero(),this._diffPosition=N.Pq.Zero(),this._newPosition=N.Pq.Zero(),this._collisionMask=-1,this._onCollisionPositionChange=(t,K,D=null)=>{this._newPosition.copyFrom(K),this._newPosition.subtractToRef(this._oldPosition,this._diffPosition),this._diffPosition.length()>T.$.CollisionsEpsilon&&(this.position.addToRef(this._diffPosition,this._deferredPositionUpdate),this._deferOnly?this._deferredUpdated=!0:this.position.copyFrom(this._deferredPositionUpdate),this.onCollide&&D&&this.onCollide(D))},this.inputs=new h(this),this.inputs.addKeyboard().addMouse()}attachControl(t,K){K=m.S0.BackCompatCameraNoPreventDefault(arguments),this.inputs.attachElement(K)}detachControl(){this.inputs.detachElement(),this.cameraDirection=new N.Pq(0,0,0),this.cameraRotation=new N.I9(0,0)}get collisionMask(){return this._collisionMask}set collisionMask(t){this._collisionMask=isNaN(t)?-1:t}_collideWithWorld(t){let K;K=this.parent?N.Pq.TransformCoordinates(this.position,this.parent.getWorldMatrix()):this.position,K.subtractFromFloatsToRef(0,this.ellipsoid.y,0,this._oldPosition),this._oldPosition.addInPlace(this.ellipsoidOffset);const D=this.getScene().collisionCoordinator;this._collider||(this._collider=D.createCollider()),this._collider._radius=this.ellipsoid,this._collider.collisionMask=this._collisionMask;let a=t;this.applyGravity&&(a=t.add(this.getScene().gravity)),D.getNewPosition(this._oldPosition,a,this._collider,3,null,this._onCollisionPositionChange,this.uniqueId)}_checkInputs(){this._localDirection||(this._localDirection=N.Pq.Zero(),this._transformedDirection=N.Pq.Zero()),this.inputs.checkInputs(),super._checkInputs()}set needMoveForGravity(t){this._needMoveForGravity=t}get needMoveForGravity(){return this._needMoveForGravity}_decideIfNeedsToMove(){return this._needMoveForGravity||Math.abs(this.cameraDirection.x)>0||Math.abs(this.cameraDirection.y)>0||Math.abs(this.cameraDirection.z)>0}_updatePosition(){this.checkCollisions&&this.getScene().collisionsEnabled?this._collideWithWorld(this.cameraDirection):super._updatePosition()}dispose(){this.inputs.clear(),super.dispose()}getClassName(){return"FreeCamera"}}a.Cg([G.P_()],_.prototype,"ellipsoid",void 0),a.Cg([G.P_()],_.prototype,"ellipsoidOffset",void 0),a.Cg([G.lK()],_.prototype,"checkCollisions",void 0),a.Cg([G.lK()],_.prototype,"applyGravity",void 0),J.Y5("BABYLON.FreeCamera",_);var C=D(675100),H=(D(625735),D(349487));class o extends H.v{constructor(){super(...arguments),this._needProjectionMatrixCompute=!0,this._viewMatrix=N.uq.Identity(),this._projectionMatrix=N.uq.Identity()}_setPosition(t){this._position=t}get position(){return this._position}set position(t){this._setPosition(t)}_setDirection(t){this._direction=t}get direction(){return this._direction}set direction(t){this._setDirection(t)}get shadowMinZ(){return this._shadowMinZ}set shadowMinZ(t){this._shadowMinZ=t,this.forceProjectionMatrixCompute()}get shadowMaxZ(){return this._shadowMaxZ}set shadowMaxZ(t){this._shadowMaxZ=t,this.forceProjectionMatrixCompute()}computeTransformedInformation(){return!(!this.parent||!this.parent.getWorldMatrix||(this.transformedPosition||(this.transformedPosition=N.Pq.Zero()),N.Pq.TransformCoordinatesToRef(this.position,this.parent.getWorldMatrix(),this.transformedPosition),this.direction&&(this.transformedDirection||(this.transformedDirection=N.Pq.Zero()),N.Pq.TransformNormalToRef(this.direction,this.parent.getWorldMatrix(),this.transformedDirection)),0))}getDepthScale(){return 50}getShadowDirection(t){return this.transformedDirection?this.transformedDirection:this.direction}getAbsolutePosition(){return this.transformedPosition?this.transformedPosition:this.position}setDirectionToTarget(t){return this.direction=N.Pq.Normalize(t.subtract(this.position)),this.direction}getRotation(){this.direction.normalize();const t=N.Pq.Cross(this.direction,b._0.Y),K=N.Pq.Cross(t,this.direction);return N.Pq.RotationFromAxis(t,K,this.direction)}needCube(){return!1}needProjectionMatrixCompute(){return this._needProjectionMatrixCompute}forceProjectionMatrixCompute(){this._needProjectionMatrixCompute=!0}_initCache(){super._initCache(),this._cache.position=N.Pq.Zero()}_isSynchronized(){return!!this._cache.position.equals(this.position)}computeWorldMatrix(t){return!t&&this.isSynchronized()?(this._currentRenderId=this.getScene().getRenderId(),this._worldMatrix):(this._updateCache(),this._cache.position.copyFrom(this.position),this._worldMatrix||(this._worldMatrix=N.uq.Identity()),N.uq.TranslationToRef(this.position.x,this.position.y,this.position.z,this._worldMatrix),this.parent&&this.parent.getWorldMatrix&&(this._worldMatrix.multiplyToRef(this.parent.getWorldMatrix(),this._worldMatrix),this._markSyncedWithParent()),this._worldMatrixDeterminantIsDirty=!0,this._worldMatrix)}getDepthMinZ(t){return void 0!==this.shadowMinZ?this.shadowMinZ:t.minZ}getDepthMaxZ(t){return void 0!==this.shadowMaxZ?this.shadowMaxZ:t.maxZ}setShadowProjectionMatrix(t,K,D){return this.customProjectionMatrixBuilder?this.customProjectionMatrixBuilder(K,D,t):this._setDefaultShadowProjectionMatrix(t,K,D),this}_syncParentEnabledState(){super._syncParentEnabledState(),this.parent&&this.parent.getWorldMatrix||(this.transformedPosition=null,this.transformedDirection=null)}getViewMatrix(t){const K=N.AA.Vector3[0];let D=this.position;this.computeTransformedInformation()&&(D=this.transformedPosition),N.Pq.NormalizeToRef(this.getShadowDirection(t),K),1===Math.abs(N.Pq.Dot(K,N.Pq.Up()))&&(K.z=1e-13);const a=N.AA.Vector3[1];return D.addToRef(K,a),N.uq.LookAtLHToRef(D,a,N.Pq.Up(),this._viewMatrix),this._viewMatrix}getProjectionMatrix(t,K){return this.setShadowProjectionMatrix(this._projectionMatrix,null!=t?t:this._viewMatrix,null!=K?K:[]),this._projectionMatrix}}a.Cg([G.P_()],o.prototype,"position",null),a.Cg([G.P_()],o.prototype,"direction",null),a.Cg([G.lK()],o.prototype,"shadowMinZ",null),a.Cg([G.lK()],o.prototype,"shadowMaxZ",null);var U=D(432050);n.b.AddNodeConstructor("Light_Type_2",((t,K)=>()=>new V(t,N.Pq.Zero(),N.Pq.Zero(),0,0,K)));class V extends o{get angle(){return this._angle}set angle(t){this._angle=t,this._cosHalfAngle=Math.cos(.5*t),this._projectionTextureProjectionLightDirty=!0,this.forceProjectionMatrixCompute(),this._computeAngleValues()}get innerAngle(){return this._innerAngle}set innerAngle(t){this._innerAngle=t,this._computeAngleValues()}get shadowAngleScale(){return this._shadowAngleScale}set shadowAngleScale(t){this._shadowAngleScale=t,this.forceProjectionMatrixCompute()}get projectionTextureMatrix(){return this._projectionTextureMatrix}get projectionTextureLightNear(){return this._projectionTextureLightNear}set projectionTextureLightNear(t){this._projectionTextureLightNear=t,this._projectionTextureProjectionLightDirty=!0}get projectionTextureLightFar(){return this._projectionTextureLightFar}set projectionTextureLightFar(t){this._projectionTextureLightFar=t,this._projectionTextureProjectionLightDirty=!0}get projectionTextureUpDirection(){return this._projectionTextureUpDirection}set projectionTextureUpDirection(t){this._projectionTextureUpDirection=t,this._projectionTextureProjectionLightDirty=!0}get projectionTexture(){return this._projectionTexture}set projectionTexture(t){this._projectionTexture!==t&&(this._projectionTexture=t,this._projectionTextureDirty=!0,this._projectionTexture&&!this._projectionTexture.isReady()&&(V._IsProceduralTexture(this._projectionTexture)?this._projectionTexture.getEffect().executeWhenCompiled((()=>{this._markMeshesAsLightDirty()})):V._IsTexture(this._projectionTexture)&&this._projectionTexture.onLoadObservable.addOnce((()=>{this._markMeshesAsLightDirty()}))))}static _IsProceduralTexture(t){return void 0!==t.onGeneratedObservable}static _IsTexture(t){return void 0!==t.onLoadObservable}get projectionTextureProjectionLightMatrix(){return this._projectionTextureProjectionLightMatrix}set projectionTextureProjectionLightMatrix(t){this._projectionTextureProjectionLightMatrix=t,this._projectionTextureProjectionLightDirty=!1,this._projectionTextureDirty=!0}constructor(t,K,D,a,G,W){super(t,W),this._innerAngle=0,this._projectionTextureMatrix=N.uq.Zero(),this._projectionTextureLightNear=1e-6,this._projectionTextureLightFar=1e3,this._projectionTextureUpDirection=N.Pq.Up(),this._projectionTextureViewLightDirty=!0,this._projectionTextureProjectionLightDirty=!0,this._projectionTextureDirty=!0,this._projectionTextureViewTargetVector=N.Pq.Zero(),this._projectionTextureViewLightMatrix=N.uq.Zero(),this._projectionTextureProjectionLightMatrix=N.uq.Zero(),this._projectionTextureScalingMatrix=N.uq.FromValues(.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1),this.position=K,this.direction=D,this.angle=a,this.exponent=G}getClassName(){return"SpotLight"}getTypeID(){return H.v.LIGHTTYPEID_SPOTLIGHT}_setDirection(t){super._setDirection(t),this._projectionTextureViewLightDirty=!0}_setPosition(t){super._setPosition(t),this._projectionTextureViewLightDirty=!0}_setDefaultShadowProjectionMatrix(t,K,D){const a=this.getScene().activeCamera;if(!a)return;this._shadowAngleScale=this._shadowAngleScale||1;const G=this._shadowAngleScale*this._angle,W=void 0!==this.shadowMinZ?this.shadowMinZ:a.minZ,x=void 0!==this.shadowMaxZ?this.shadowMaxZ:a.maxZ,b=this.getScene().getEngine().useReverseDepthBuffer;N.uq.PerspectiveFovLHToRef(G,1,b?x:W,b?W:x,t,!0,this._scene.getEngine().isNDCHalfZRange,void 0,b)}_computeProjectionTextureViewLightMatrix(){this._projectionTextureViewLightDirty=!1,this._projectionTextureDirty=!0,this.getAbsolutePosition().addToRef(this.getShadowDirection(),this._projectionTextureViewTargetVector),N.uq.LookAtLHToRef(this.getAbsolutePosition(),this._projectionTextureViewTargetVector,this._projectionTextureUpDirection,this._projectionTextureViewLightMatrix)}_computeProjectionTextureProjectionLightMatrix(){this._projectionTextureProjectionLightDirty=!1,this._projectionTextureDirty=!0;const t=this.projectionTextureLightFar,K=this.projectionTextureLightNear,D=t/(t-K),a=-D*K,G=1/Math.tan(this._angle/2);N.uq.FromValuesToRef(G/1,0,0,0,0,G,0,0,0,0,D,1,0,0,a,0,this._projectionTextureProjectionLightMatrix)}_computeProjectionTextureMatrix(){if(this._projectionTextureDirty=!1,this._projectionTextureViewLightMatrix.multiplyToRef(this._projectionTextureProjectionLightMatrix,this._projectionTextureMatrix),this._projectionTexture instanceof U.g){const t=this._projectionTexture.uScale/2,K=this._projectionTexture.vScale/2;N.uq.FromValuesToRef(t,0,0,0,0,K,0,0,0,0,.5,0,.5,.5,.5,1,this._projectionTextureScalingMatrix)}this._projectionTextureMatrix.multiplyToRef(this._projectionTextureScalingMatrix,this._projectionTextureMatrix)}_buildUniformLayout(){this._uniformBuffer.addUniform("vLightData",4),this._uniformBuffer.addUniform("vLightDiffuse",4),this._uniformBuffer.addUniform("vLightSpecular",4),this._uniformBuffer.addUniform("vLightDirection",3),this._uniformBuffer.addUniform("vLightFalloff",4),this._uniformBuffer.addUniform("shadowsInfo",3),this._uniformBuffer.addUniform("depthValues",2),this._uniformBuffer.create()}_computeAngleValues(){this._lightAngleScale=1/Math.max(.001,Math.cos(.5*this._innerAngle)-this._cosHalfAngle),this._lightAngleOffset=-this._cosHalfAngle*this._lightAngleScale}transferTexturesToEffect(t,K){return this.projectionTexture&&this.projectionTexture.isReady()&&(this._projectionTextureViewLightDirty&&this._computeProjectionTextureViewLightMatrix(),this._projectionTextureProjectionLightDirty&&this._computeProjectionTextureProjectionLightMatrix(),this._projectionTextureDirty&&this._computeProjectionTextureMatrix(),t.setMatrix("textureProjectionMatrix"+K,this._projectionTextureMatrix),t.setTexture("projectionLightTexture"+K,this.projectionTexture)),this}transferToEffect(t,K){let D;return this.computeTransformedInformation()?(this._uniformBuffer.updateFloat4("vLightData",this.transformedPosition.x,this.transformedPosition.y,this.transformedPosition.z,this.exponent,K),D=N.Pq.Normalize(this.transformedDirection)):(this._uniformBuffer.updateFloat4("vLightData",this.position.x,this.position.y,this.position.z,this.exponent,K),D=N.Pq.Normalize(this.direction)),this._uniformBuffer.updateFloat4("vLightDirection",D.x,D.y,D.z,this._cosHalfAngle,K),this._uniformBuffer.updateFloat4("vLightFalloff",this.range,this._inverseSquaredRange,this._lightAngleScale,this._lightAngleOffset,K),this}transferToNodeMaterialEffect(t,K){let D;return D=this.computeTransformedInformation()?N.Pq.Normalize(this.transformedDirection):N.Pq.Normalize(this.direction),this.getScene().useRightHandedSystem?t.setFloat3(K,-D.x,-D.y,-D.z):t.setFloat3(K,D.x,D.y,D.z),this}dispose(){super.dispose(),this._projectionTexture&&this._projectionTexture.dispose()}getDepthMinZ(t){const K=this._scene.getEngine(),D=void 0!==this.shadowMinZ?this.shadowMinZ:t.minZ;return K.useReverseDepthBuffer&&K.isNDCHalfZRange?D:this._scene.getEngine().isNDCHalfZRange?0:D}getDepthMaxZ(t){const K=this._scene.getEngine(),D=void 0!==this.shadowMaxZ?this.shadowMaxZ:t.maxZ;return K.useReverseDepthBuffer&&K.isNDCHalfZRange?0:D}prepareLightSpecificDefines(t,K){t["SPOTLIGHT"+K]=!0,t["PROJECTEDLIGHTTEXTURE"+K]=!(!this.projectionTexture||!this.projectionTexture.isReady())}}a.Cg([G.lK()],V.prototype,"angle",null),a.Cg([G.lK()],V.prototype,"innerAngle",null),a.Cg([G.lK()],V.prototype,"shadowAngleScale",null),a.Cg([G.lK()],V.prototype,"exponent",void 0),a.Cg([G.lK()],V.prototype,"projectionTextureLightNear",null),a.Cg([G.lK()],V.prototype,"projectionTextureLightFar",null),a.Cg([G.lK()],V.prototype,"projectionTextureUpDirection",null),a.Cg([G.uM("projectedLightTexture")],V.prototype,"_projectionTexture",void 0),J.Y5("BABYLON.SpotLight",V);var s=D(332290),F=D(607552),c=D(443401),g=D(378480),R=D(23987),A=D(818696),Y=D(374216),L=D(396574),S=D(59036),f=D(755752),$=D(395726),B=D(158548);class O{get boundingBias(){return this._boundingBias}set boundingBias(t){this._boundingBias?this._boundingBias.copyFrom(t):this._boundingBias=t.clone(),this._updateBoundingInfo(!0,null)}static CreateGeometryForMesh(t){const K=new O(O.RandomId(),t.getScene());return K.applyToMesh(t),K}get meshes(){return this._meshes}constructor(t,K,D,a=!1,G=null){this.delayLoadState=0,this._totalVertices=0,this._isDisposed=!1,this._indexBufferIsUpdatable=!1,this._positionsCache=[],this._parentContainer=null,this.useBoundingInfoFromGeometry=!1,this._scene=K||$.q.LastCreatedScene,this._scene&&(this.id=t,this.uniqueId=this._scene.getUniqueId(),this._engine=this._scene.getEngine(),this._meshes=[],this._vertexBuffers={},this._indices=[],this._updatable=a,D?this.setAllVerticesData(D,a):this._totalVertices=0,this._engine.getCaps().vertexArrayObject&&(this._vertexArrayObjects={}),G&&(this.applyToMesh(G),G.computeWorldMatrix(!0)))}get extend(){return this._extend}getScene(){return this._scene}getEngine(){return this._engine}isReady(){return 1===this.delayLoadState||0===this.delayLoadState}get doNotSerialize(){for(let t=0;t<this._meshes.length;t++)if(!this._meshes[t].doNotSerialize)return!1;return!0}_rebuild(){this._vertexArrayObjects&&(this._vertexArrayObjects={}),0!==this._meshes.length&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,this._updatable,"Geometry_"+this.id+"_IndexBuffer"));const t=new Set;for(const K in this._vertexBuffers)t.add(this._vertexBuffers[K].getWrapperBuffer());t.forEach((t=>{t._rebuild()}))}setAllVerticesData(t,K){t.applyToGeometry(this,K),this._notifyUpdate()}setVerticesData(t,K,D=!1,a){D&&Array.isArray(K)&&(K=new Float32Array(K));const G=new R.R(this._engine,K,t,{updatable:D,postponeInternalCreation:0===this._meshes.length,stride:a,label:"Geometry_"+this.id+"_"+t});this.setVerticesBuffer(G)}removeVerticesData(t){this._vertexBuffers[t]&&(this._vertexBuffers[t].dispose(),delete this._vertexBuffers[t]),this._vertexArrayObjects&&this._disposeVertexArrayObjects()}setVerticesBuffer(t,K=null,D=!0){const a=t.getKind();this._vertexBuffers[a]&&D&&this._vertexBuffers[a].dispose(),t._buffer&&t._buffer._increaseReferences(),this._vertexBuffers[a]=t;const G=this._meshes,W=G.length;if(a===R.R.PositionKind){this._totalVertices=null!=K?K:t._maxVerticesCount,this._updateExtend(t.getFloatData(this._totalVertices)),this._resetPointsArrayCache();const D=this._extend&&this._extend.minimum||new N.Pq(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),a=this._extend&&this._extend.maximum||new N.Pq(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);for(let t=0;t<W;t++){const K=G[t];K.buildBoundingInfo(D,a),K._createGlobalSubMesh(K.isUnIndexed),K.computeWorldMatrix(!0),K.synchronizeInstances()}}this._notifyUpdate(a)}updateVerticesDataDirectly(t,K,D,a=!1){const G=this.getVertexBuffer(t);G&&(G.updateDirectly(K,D,a),this._notifyUpdate(t))}updateVerticesData(t,K,D=!1){const a=this.getVertexBuffer(t);a&&(a.update(K),t===R.R.PositionKind&&this._updateBoundingInfo(D,K),this._notifyUpdate(t))}_updateBoundingInfo(t,K){if(t&&this._updateExtend(K),this._resetPointsArrayCache(),t){const t=this._meshes;for(const K of t){K.hasBoundingInfo?K.getBoundingInfo().reConstruct(this._extend.minimum,this._extend.maximum):K.buildBoundingInfo(this._extend.minimum,this._extend.maximum);const t=K.subMeshes;for(const K of t)K.refreshBoundingInfo()}}}_bind(t,K,D,a){if(!t)return;void 0===K&&(K=this._indexBuffer);const G=this.getVertexBuffers();if(!G)return;if(K!=this._indexBuffer||!this._vertexArrayObjects&&!a)return void this._engine.bindBuffers(G,K,t,D);const N=a||this._vertexArrayObjects,W=this._engine;N[t.key]||(N[t.key]=W.recordVertexArrayObject(G,K,t,D)),W.bindVertexArrayObject(N[t.key],K)}getTotalVertices(){return this.isReady()?this._totalVertices:0}getVerticesData(t,K,D){const a=this.getVertexBuffer(t);return a?a.getFloatData(this._totalVertices,D||K&&1!==this._meshes.length):null}copyVerticesData(t,K){const D=this.getVertexBuffer(t);if(!D)return;K[t]||(K[t]=new Float32Array(this._totalVertices*D.getSize()));const a=D.getData();a&&function(t,K,D,a,G,N,W,x){const b=K*R.R.GetTypeByteLength(D),n=W*K;if(x.length!==n)throw new Error("Output length is not valid");if(D===R.R.FLOAT&&G===b)if(t instanceof Array){const K=a/4;x.set(t,K)}else if(t instanceof ArrayBuffer){const K=new Float32Array(t,a,n);x.set(K)}else{const K=t.byteOffset+a;if(K%4)return i.V.Warn("CopyFloatData: copied misaligned data."),void x.set(new Float32Array(t.buffer.slice(K,K+4*n)));const D=new Float32Array(t.buffer,K,n);x.set(D)}else R.R.ForEach(t,a,G,K,D,n,N,((t,K)=>x[K]=t))}(a,D.getSize(),D.type,D.byteOffset,D.byteStride,D.normalized,this._totalVertices,K[t])}isVertexBufferUpdatable(t){const K=this._vertexBuffers[t];return!!K&&K.isUpdatable()}getVertexBuffer(t){return this.isReady()?this._vertexBuffers[t]:null}getVertexBuffers(){return this.isReady()?this._vertexBuffers:null}isVerticesDataPresent(t){return this._vertexBuffers?void 0!==this._vertexBuffers[t]:!!this._delayInfo&&-1!==this._delayInfo.indexOf(t)}getVerticesDataKinds(){const t=[];let K;if(!this._vertexBuffers&&this._delayInfo)for(K in this._delayInfo)t.push(K);else for(K in this._vertexBuffers)t.push(K);return t}updateIndices(t,K,D=!1){if(this._indexBuffer)if(this._indexBufferIsUpdatable){const a=t.length!==this._indices.length;if(D||(this._indices=t.slice()),this._engine.updateDynamicIndexBuffer(this._indexBuffer,t,K),a)for(const t of this._meshes)t._createGlobalSubMesh(!0)}else this.setIndices(t,null,!0)}setIndexBuffer(t,K,D){this._indices=[],this._indexBufferIsUpdatable=!1,this._indexBuffer=t,this._totalVertices=K,this._totalIndices=D,t.is32Bits||(t.is32Bits=this._totalIndices>65535);for(const t of this._meshes)t._createGlobalSubMesh(!0),t.synchronizeInstances();this._notifyUpdate()}setIndices(t,K=null,D=!1){this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indices=t,this._indexBufferIsUpdatable=D,0!==this._meshes.length&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,D,"Geometry_"+this.id+"_IndexBuffer")),null!=K&&(this._totalVertices=K);for(const t of this._meshes)t._createGlobalSubMesh(!0),t.synchronizeInstances();this._notifyUpdate()}getTotalIndices(){return this.isReady()?void 0!==this._totalIndices?this._totalIndices:this._indices.length:0}getIndices(t,K){if(!this.isReady())return null;const D=this._indices;return K||t&&1!==this._meshes.length?D.slice():D}getIndexBuffer(){return this.isReady()?this._indexBuffer:null}_releaseVertexArrayObject(t=null){t&&this._vertexArrayObjects&&this._vertexArrayObjects[t.key]&&(this._engine.releaseVertexArrayObject(this._vertexArrayObjects[t.key]),delete this._vertexArrayObjects[t.key])}releaseForMesh(t,K){const D=this._meshes,a=D.indexOf(t);-1!==a&&(D.splice(a,1),this._vertexArrayObjects&&t._invalidateInstanceVertexArrayObject(),t._geometry=null,0===D.length&&K&&this.dispose())}applyToMesh(t){if(t._geometry===this)return;const K=t._geometry;K&&K.releaseForMesh(t),this._vertexArrayObjects&&t._invalidateInstanceVertexArrayObject();const D=this._meshes;t._geometry=this,t._internalAbstractMeshDataInfo._positions=null,this._scene.pushGeometry(this),D.push(t),this.isReady()?this._applyToMesh(t):this._boundingInfo&&t.setBoundingInfo(this._boundingInfo)}_updateExtend(t=null){if(this.useBoundingInfoFromGeometry&&this._boundingInfo)this._extend={minimum:this._boundingInfo.minimum.clone(),maximum:this._boundingInfo.maximum.clone()};else{if(!t&&!(t=this.getVerticesData(R.R.PositionKind)))return;this._extend=f.b(t,0,this._totalVertices,this.boundingBias,3)}}_applyToMesh(t){const K=this._meshes.length;for(const D in this._vertexBuffers)1===K&&this._vertexBuffers[D].create(),D===R.R.PositionKind&&(this._extend||this._updateExtend(),t.buildBoundingInfo(this._extend.minimum,this._extend.maximum),t._createGlobalSubMesh(t.isUnIndexed),t._updateBoundingInfo());1===K&&this._indices&&this._indices.length>0&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,this._updatable,"Geometry_"+this.id+"_IndexBuffer")),t._syncGeometryWithMorphTargetManager(),t.synchronizeInstances()}_notifyUpdate(t){this.onGeometryUpdated&&this.onGeometryUpdated(this,t),this._vertexArrayObjects&&this._disposeVertexArrayObjects();for(const t of this._meshes)t._markSubMeshesAsAttributesDirty()}load(t,K){2!==this.delayLoadState&&(this.isReady()?K&&K():(this.delayLoadState=2,this._queueLoad(t,K)))}_queueLoad(t,K){this.delayLoadingFile&&(t.addPendingData(this),t._loadFile(this.delayLoadingFile,(D=>{if(!this._delayLoadingFunction)return;this._delayLoadingFunction(JSON.parse(D),this),this.delayLoadState=1,this._delayInfo=[],t.removePendingData(this);const a=this._meshes,G=a.length;for(let t=0;t<G;t++)this._applyToMesh(a[t]);K&&K()}),void 0,!0))}toLeftHanded(){const t=this.getIndices(!1);if(null!=t&&t.length>0){for(let K=0;K<t.length;K+=3){const D=t[K+0];t[K+0]=t[K+2],t[K+2]=D}this.setIndices(t)}const K=this.getVerticesData(R.R.PositionKind,!1);if(null!=K&&K.length>0){for(let t=0;t<K.length;t+=3)K[t+2]=-K[t+2];this.setVerticesData(R.R.PositionKind,K,!1)}const D=this.getVerticesData(R.R.NormalKind,!1);if(null!=D&&D.length>0){for(let t=0;t<D.length;t+=3)D[t+2]=-D[t+2];this.setVerticesData(R.R.NormalKind,D,!1)}}_resetPointsArrayCache(){this._positions=null}_generatePointsArray(){if(this._positions)return!0;const t=this.getVerticesData(R.R.PositionKind);if(!t||0===t.length)return!1;for(let K=3*this._positionsCache.length,D=this._positionsCache.length;K<t.length;K+=3,++D)this._positionsCache[D]=N.Pq.FromArray(t,K);for(let K=0,D=0;K<t.length;K+=3,++D)this._positionsCache[D].set(t[0+K],t[1+K],t[2+K]);return this._positionsCache.length=t.length/3,this._positions=this._positionsCache,!0}isDisposed(){return this._isDisposed}_disposeVertexArrayObjects(){if(this._vertexArrayObjects){for(const t in this._vertexArrayObjects)this._engine.releaseVertexArrayObject(this._vertexArrayObjects[t]);this._vertexArrayObjects={};const t=this._meshes,K=t.length;for(let D=0;D<K;D++)t[D]._invalidateInstanceVertexArrayObject()}}dispose(){const t=this._meshes,K=t.length;let D;for(D=0;D<K;D++)this.releaseForMesh(t[D]);this._meshes.length=0,this._disposeVertexArrayObjects();for(const t in this._vertexBuffers)this._vertexBuffers[t].dispose();if(this._vertexBuffers={},this._totalVertices=0,this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indexBuffer=null,this._indices=[],this.delayLoadState=0,this.delayLoadingFile=null,this._delayLoadingFunction=null,this._delayInfo=[],this._boundingInfo=null,this._scene.removeGeometry(this),this._parentContainer){const t=this._parentContainer.geometries.indexOf(this);t>-1&&this._parentContainer.geometries.splice(t,1),this._parentContainer=null}this._isDisposed=!0}copy(t){const K=new A.P;K.indices=[];const D=this.getIndices();if(D)for(let t=0;t<D.length;t++)K.indices.push(D[t]);let a,G=!1,N=!1;for(a in this._vertexBuffers){const t=this.getVerticesData(a);if(t&&(t instanceof Float32Array?K.set(new Float32Array(t),a):K.set(t.slice(0),a),!N)){const t=this.getVertexBuffer(a);t&&(G=t.isUpdatable(),N=!G)}}const W=new O(t,this._scene,K,G);for(a in W.delayLoadState=this.delayLoadState,W.delayLoadingFile=this.delayLoadingFile,W._delayLoadingFunction=this._delayLoadingFunction,this._delayInfo)W._delayInfo=W._delayInfo||[],W._delayInfo.push(a);return W._boundingInfo=new S.j(this._extend.minimum,this._extend.maximum),W}serialize(){const t={};return t.id=this.id,t.uniqueId=this.uniqueId,t.updatable=this._updatable,c.Y&&c.Y.HasTags(this)&&(t.tags=c.Y.GetTags(this)),t}_toNumberArray(t){return Array.isArray(t)?t:Array.prototype.slice.call(t)}clearCachedData(){this._indices=[],this._resetPointsArrayCache();for(const t in this._vertexBuffers)Object.prototype.hasOwnProperty.call(this._vertexBuffers,t)&&(this._vertexBuffers[t]._buffer._data=null)}serializeVerticeData(){const t=this.serialize();return this.isVerticesDataPresent(R.R.PositionKind)&&(t.positions=this._toNumberArray(this.getVerticesData(R.R.PositionKind)),this.isVertexBufferUpdatable(R.R.PositionKind)&&(t.positions._updatable=!0)),this.isVerticesDataPresent(R.R.NormalKind)&&(t.normals=this._toNumberArray(this.getVerticesData(R.R.NormalKind)),this.isVertexBufferUpdatable(R.R.NormalKind)&&(t.normals._updatable=!0)),this.isVerticesDataPresent(R.R.TangentKind)&&(t.tangents=this._toNumberArray(this.getVerticesData(R.R.TangentKind)),this.isVertexBufferUpdatable(R.R.TangentKind)&&(t.tangents._updatable=!0)),this.isVerticesDataPresent(R.R.UVKind)&&(t.uvs=this._toNumberArray(this.getVerticesData(R.R.UVKind)),this.isVertexBufferUpdatable(R.R.UVKind)&&(t.uvs._updatable=!0)),this.isVerticesDataPresent(R.R.UV2Kind)&&(t.uvs2=this._toNumberArray(this.getVerticesData(R.R.UV2Kind)),this.isVertexBufferUpdatable(R.R.UV2Kind)&&(t.uvs2._updatable=!0)),this.isVerticesDataPresent(R.R.UV3Kind)&&(t.uvs3=this._toNumberArray(this.getVerticesData(R.R.UV3Kind)),this.isVertexBufferUpdatable(R.R.UV3Kind)&&(t.uvs3._updatable=!0)),this.isVerticesDataPresent(R.R.UV4Kind)&&(t.uvs4=this._toNumberArray(this.getVerticesData(R.R.UV4Kind)),this.isVertexBufferUpdatable(R.R.UV4Kind)&&(t.uvs4._updatable=!0)),this.isVerticesDataPresent(R.R.UV5Kind)&&(t.uvs5=this._toNumberArray(this.getVerticesData(R.R.UV5Kind)),this.isVertexBufferUpdatable(R.R.UV5Kind)&&(t.uvs5._updatable=!0)),this.isVerticesDataPresent(R.R.UV6Kind)&&(t.uvs6=this._toNumberArray(this.getVerticesData(R.R.UV6Kind)),this.isVertexBufferUpdatable(R.R.UV6Kind)&&(t.uvs6._updatable=!0)),this.isVerticesDataPresent(R.R.ColorKind)&&(t.colors=this._toNumberArray(this.getVerticesData(R.R.ColorKind)),this.isVertexBufferUpdatable(R.R.ColorKind)&&(t.colors._updatable=!0)),this.isVerticesDataPresent(R.R.MatricesIndicesKind)&&(t.matricesIndices=this._toNumberArray(this.getVerticesData(R.R.MatricesIndicesKind)),t.matricesIndices._isExpanded=!0,this.isVertexBufferUpdatable(R.R.MatricesIndicesKind)&&(t.matricesIndices._updatable=!0)),this.isVerticesDataPresent(R.R.MatricesWeightsKind)&&(t.matricesWeights=this._toNumberArray(this.getVerticesData(R.R.MatricesWeightsKind)),this.isVertexBufferUpdatable(R.R.MatricesWeightsKind)&&(t.matricesWeights._updatable=!0)),t.indices=this._toNumberArray(this.getIndices()),t}static ExtractFromMesh(t,K){const D=t._geometry;return D?D.copy(K):null}static RandomId(){return m.S0.RandomId()}static _GetGeometryByLoadedUniqueId(t,K){for(let D=0;D<K.geometries.length;D++)if(K.geometries[D]._loadedUniqueId===t)return K.geometries[D];return null}static _ImportGeometry(t,K){const D=K.getScene(),a=t.geometryUniqueId,G=t.geometryId;if(a||G){const t=a?this._GetGeometryByLoadedUniqueId(a,D):D.getGeometryById(G);t&&t.applyToMesh(K)}else if(t instanceof ArrayBuffer){const D=K._binaryInfo;if(D.positionsAttrDesc&&D.positionsAttrDesc.count>0){const a=new Float32Array(t,D.positionsAttrDesc.offset,D.positionsAttrDesc.count);K.setVerticesData(R.R.PositionKind,a,!1)}if(D.normalsAttrDesc&&D.normalsAttrDesc.count>0){const a=new Float32Array(t,D.normalsAttrDesc.offset,D.normalsAttrDesc.count);K.setVerticesData(R.R.NormalKind,a,!1)}if(D.tangetsAttrDesc&&D.tangetsAttrDesc.count>0){const a=new Float32Array(t,D.tangetsAttrDesc.offset,D.tangetsAttrDesc.count);K.setVerticesData(R.R.TangentKind,a,!1)}if(D.uvsAttrDesc&&D.uvsAttrDesc.count>0){const a=new Float32Array(t,D.uvsAttrDesc.offset,D.uvsAttrDesc.count);if(B.rX)for(let t=1;t<a.length;t+=2)a[t]=1-a[t];K.setVerticesData(R.R.UVKind,a,!1)}if(D.uvs2AttrDesc&&D.uvs2AttrDesc.count>0){const a=new Float32Array(t,D.uvs2AttrDesc.offset,D.uvs2AttrDesc.count);if(B.rX)for(let t=1;t<a.length;t+=2)a[t]=1-a[t];K.setVerticesData(R.R.UV2Kind,a,!1)}if(D.uvs3AttrDesc&&D.uvs3AttrDesc.count>0){const a=new Float32Array(t,D.uvs3AttrDesc.offset,D.uvs3AttrDesc.count);if(B.rX)for(let t=1;t<a.length;t+=2)a[t]=1-a[t];K.setVerticesData(R.R.UV3Kind,a,!1)}if(D.uvs4AttrDesc&&D.uvs4AttrDesc.count>0){const a=new Float32Array(t,D.uvs4AttrDesc.offset,D.uvs4AttrDesc.count);if(B.rX)for(let t=1;t<a.length;t+=2)a[t]=1-a[t];K.setVerticesData(R.R.UV4Kind,a,!1)}if(D.uvs5AttrDesc&&D.uvs5AttrDesc.count>0){const a=new Float32Array(t,D.uvs5AttrDesc.offset,D.uvs5AttrDesc.count);if(B.rX)for(let t=1;t<a.length;t+=2)a[t]=1-a[t];K.setVerticesData(R.R.UV5Kind,a,!1)}if(D.uvs6AttrDesc&&D.uvs6AttrDesc.count>0){const a=new Float32Array(t,D.uvs6AttrDesc.offset,D.uvs6AttrDesc.count);if(B.rX)for(let t=1;t<a.length;t+=2)a[t]=1-a[t];K.setVerticesData(R.R.UV6Kind,a,!1)}if(D.colorsAttrDesc&&D.colorsAttrDesc.count>0){const a=new Float32Array(t,D.colorsAttrDesc.offset,D.colorsAttrDesc.count);K.setVerticesData(R.R.ColorKind,a,!1,D.colorsAttrDesc.stride)}if(D.matricesIndicesAttrDesc&&D.matricesIndicesAttrDesc.count>0){const a=new Int32Array(t,D.matricesIndicesAttrDesc.offset,D.matricesIndicesAttrDesc.count),G=[];for(let t=0;t<a.length;t++){const K=a[t];G.push(255&K),G.push((65280&K)>>8),G.push((16711680&K)>>16),G.push(K>>24&255)}K.setVerticesData(R.R.MatricesIndicesKind,G,!1)}if(D.matricesIndicesExtraAttrDesc&&D.matricesIndicesExtraAttrDesc.count>0){const a=new Int32Array(t,D.matricesIndicesExtraAttrDesc.offset,D.matricesIndicesExtraAttrDesc.count),G=[];for(let t=0;t<a.length;t++){const K=a[t];G.push(255&K),G.push((65280&K)>>8),G.push((16711680&K)>>16),G.push(K>>24&255)}K.setVerticesData(R.R.MatricesIndicesExtraKind,G,!1)}if(D.matricesWeightsAttrDesc&&D.matricesWeightsAttrDesc.count>0){const a=new Float32Array(t,D.matricesWeightsAttrDesc.offset,D.matricesWeightsAttrDesc.count);K.setVerticesData(R.R.MatricesWeightsKind,a,!1)}if(D.indicesAttrDesc&&D.indicesAttrDesc.count>0){const a=new Int32Array(t,D.indicesAttrDesc.offset,D.indicesAttrDesc.count);K.setIndices(a,null)}if(D.subMeshesAttrDesc&&D.subMeshesAttrDesc.count>0){const a=new Int32Array(t,D.subMeshesAttrDesc.offset,5*D.subMeshesAttrDesc.count);K.subMeshes=[];for(let t=0;t<D.subMeshesAttrDesc.count;t++){const D=a[5*t+0],G=a[5*t+1],N=a[5*t+2],W=a[5*t+3],x=a[5*t+4];Y.K.AddToMesh(D,G,N,W,x,K)}}}else if(t.positions&&t.normals&&t.indices){if(K.setVerticesData(R.R.PositionKind,t.positions,t.positions._updatable),K.setVerticesData(R.R.NormalKind,t.normals,t.normals._updatable),t.tangents&&K.setVerticesData(R.R.TangentKind,t.tangents,t.tangents._updatable),t.uvs&&K.setVerticesData(R.R.UVKind,t.uvs,t.uvs._updatable),t.uvs2&&K.setVerticesData(R.R.UV2Kind,t.uvs2,t.uvs2._updatable),t.uvs3&&K.setVerticesData(R.R.UV3Kind,t.uvs3,t.uvs3._updatable),t.uvs4&&K.setVerticesData(R.R.UV4Kind,t.uvs4,t.uvs4._updatable),t.uvs5&&K.setVerticesData(R.R.UV5Kind,t.uvs5,t.uvs5._updatable),t.uvs6&&K.setVerticesData(R.R.UV6Kind,t.uvs6,t.uvs6._updatable),t.colors&&K.setVerticesData(R.R.ColorKind,s.ov.CheckColors4(t.colors,t.positions.length/3),t.colors._updatable),t.matricesIndices)if(t.matricesIndices._isExpanded)delete t.matricesIndices._isExpanded,K.setVerticesData(R.R.MatricesIndicesKind,t.matricesIndices,t.matricesIndices._updatable);else{const D=[];for(let K=0;K<t.matricesIndices.length;K++){const a=t.matricesIndices[K];D.push(255&a),D.push((65280&a)>>8),D.push((16711680&a)>>16),D.push(a>>24&255)}K.setVerticesData(R.R.MatricesIndicesKind,D,t.matricesIndices._updatable)}if(t.matricesIndicesExtra)if(t.matricesIndicesExtra._isExpanded)delete t.matricesIndices._isExpanded,K.setVerticesData(R.R.MatricesIndicesExtraKind,t.matricesIndicesExtra,t.matricesIndicesExtra._updatable);else{const D=[];for(let K=0;K<t.matricesIndicesExtra.length;K++){const a=t.matricesIndicesExtra[K];D.push(255&a),D.push((65280&a)>>8),D.push((16711680&a)>>16),D.push(a>>24&255)}K.setVerticesData(R.R.MatricesIndicesExtraKind,D,t.matricesIndicesExtra._updatable)}t.matricesWeights&&(O._CleanMatricesWeights(t,K),K.setVerticesData(R.R.MatricesWeightsKind,t.matricesWeights,t.matricesWeights._updatable)),t.matricesWeightsExtra&&K.setVerticesData(R.R.MatricesWeightsExtraKind,t.matricesWeightsExtra,t.matricesWeights._updatable),K.setIndices(t.indices,null)}if(t.subMeshes){K.subMeshes=[];for(let D=0;D<t.subMeshes.length;D++){const a=t.subMeshes[D];Y.K.AddToMesh(a.materialIndex,a.verticesStart,a.verticesCount,a.indexStart,a.indexCount,K)}}K._shouldGenerateFlatShading&&(K.convertToFlatShadedMesh(),K._shouldGenerateFlatShading=!1),K.computeWorldMatrix(!0),D.onMeshImportedObservable.notifyObservers(K)}static _CleanMatricesWeights(t,K){const D=.001;if(!L.B.CleanBoneMatrixWeights)return;let a=0;if(!(t.skeletonId>-1))return;{const D=K.getScene().getLastSkeletonById(t.skeletonId);if(!D)return;a=D.bones.length}const G=K.getVerticesData(R.R.MatricesIndicesKind),N=K.getVerticesData(R.R.MatricesIndicesExtraKind),W=t.matricesWeights,x=t.matricesWeightsExtra,b=t.numBoneInfluencer,n=W.length;for(let t=0;t<n;t+=4){let K=0,n=-1;for(let a=0;a<4;a++){const G=W[t+a];K+=G,G<D&&n<0&&(n=a)}if(x)for(let a=0;a<4;a++){const G=x[t+a];K+=G,G<D&&n<0&&(n=a+4)}if((n<0||n>b-1)&&(n=b-1),K>D){const D=1/K;for(let K=0;K<4;K++)W[t+K]*=D;if(x)for(let K=0;K<4;K++)x[t+K]*=D}else n>=4?(x[t+n-4]=1-K,N[t+n-4]=a):(W[t+n]=1-K,G[t+n]=a)}K.setVerticesData(R.R.MatricesIndicesKind,G),t.matricesWeightsExtra&&K.setVerticesData(R.R.MatricesIndicesExtraKind,N)}static Parse(t,K,D){const a=new O(t.id,K,void 0,t.updatable);return a._loadedUniqueId=t.uniqueId,c.Y&&c.Y.AddTagsTo(a,t.tags),t.delayLoadingFile?(a.delayLoadState=4,a.delayLoadingFile=D+t.delayLoadingFile,a._boundingInfo=new S.j(N.Pq.FromArray(t.boundingBoxMinimum),N.Pq.FromArray(t.boundingBoxMaximum)),a._delayInfo=[],t.hasUVs&&a._delayInfo.push(R.R.UVKind),t.hasUVs2&&a._delayInfo.push(R.R.UV2Kind),t.hasUVs3&&a._delayInfo.push(R.R.UV3Kind),t.hasUVs4&&a._delayInfo.push(R.R.UV4Kind),t.hasUVs5&&a._delayInfo.push(R.R.UV5Kind),t.hasUVs6&&a._delayInfo.push(R.R.UV6Kind),t.hasColors&&a._delayInfo.push(R.R.ColorKind),t.hasMatricesIndices&&a._delayInfo.push(R.R.MatricesIndicesKind),t.hasMatricesWeights&&a._delayInfo.push(R.R.MatricesWeightsKind),a._delayLoadingFunction=A.P.ImportVertexData):A.P.ImportVertexData(t,a),K.pushGeometry(a,!0),a}}var v=D(938868),p=D(55973);class j extends p.i{get subMaterials(){return this._subMaterials}set subMaterials(t){this._subMaterials=t,this._hookArray(t)}getChildren(){return this.subMaterials}constructor(t,K){super(t,K,!0),this._waitingSubMaterialsUniqueIds=[],this.getScene().addMultiMaterial(this),this.subMaterials=[],this._storeEffectOnSubMeshes=!0}_hookArray(t){const K=t.push;t.push=(...D)=>{const a=K.apply(t,D);return this._markAllSubMeshesAsTexturesDirty(),a};const D=t.splice;t.splice=(K,a)=>{const G=D.apply(t,[K,a]);return this._markAllSubMeshesAsTexturesDirty(),G}}getSubMaterial(t){return t<0||t>=this.subMaterials.length?this.getScene().defaultMaterial:this.subMaterials[t]}getActiveTextures(){return super.getActiveTextures().concat(...this.subMaterials.map((t=>t?t.getActiveTextures():[])))}hasTexture(t){var K;if(super.hasTexture(t))return!0;for(let D=0;D<this.subMaterials.length;D++)if(null===(K=this.subMaterials[D])||void 0===K?void 0:K.hasTexture(t))return!0;return!1}getClassName(){return"MultiMaterial"}isReadyForSubMesh(t,K,D){for(let a=0;a<this.subMaterials.length;a++){const G=this.subMaterials[a];if(G){if(G._storeEffectOnSubMeshes){if(!G.isReadyForSubMesh(t,K,D))return!1;continue}if(!G.isReady(t))return!1}}return!0}clone(t,K){const D=new j(t,this.getScene());for(let a=0;a<this.subMaterials.length;a++){let G=null;const N=this.subMaterials[a];G=K&&N?N.clone(t+"-"+N.name):this.subMaterials[a],D.subMaterials.push(G)}return D}serialize(){const t={};t.name=this.name,t.id=this.id,t.uniqueId=this.uniqueId,c.Y&&(t.tags=c.Y.GetTags(this)),t.materialsUniqueIds=[],t.materials=[];for(let K=0;K<this.subMaterials.length;K++){const D=this.subMaterials[K];D?(t.materialsUniqueIds.push(D.uniqueId),t.materials.push(D.id)):(t.materialsUniqueIds.push(null),t.materials.push(null))}return t}dispose(t,K,D){const a=this.getScene();if(!a)return;if(D)for(let D=0;D<this.subMaterials.length;D++){const a=this.subMaterials[D];a&&a.dispose(t,K)}const G=a.multiMaterials.indexOf(this);G>=0&&a.multiMaterials.splice(G,1),super.dispose(t,K)}static ParseMultiMaterial(t,K){const D=new j(t.name,K);return D.id=t.id,D._loadedUniqueId=t.uniqueId,c.Y&&c.Y.AddTagsTo(D,t.tags),t.materialsUniqueIds?D._waitingSubMaterialsUniqueIds=t.materialsUniqueIds:t.materials.forEach((t=>D.subMaterials.push(K.getLastMaterialById(t)))),D}}J.Y5("BABYLON.MultiMaterial",j);var r=D(554014),M=D(122030);class k{constructor(t,K){this.distanceOrScreenCoverage=t,this.mesh=K}}class tt{}class Kt{constructor(){this.visibleInstances={},this.batchCache=new Dt,this.batchCacheReplacementModeInFrozenMode=new Dt,this.instancesBufferSize=32*16*4}}class Dt{constructor(){this.mustReturn=!1,this.visibleInstances=new Array,this.renderSelf=[],this.hardwareInstancedRendering=[]}}class at{constructor(){this.instancesCount=0,this.matrixBuffer=null,this.previousMatrixBuffer=null,this.matrixBufferSize=32*16,this.matrixData=null,this.boundingVectors=[],this.worldMatrices=null}}class Gt{constructor(){this._areNormalsFrozen=!1,this._source=null,this.meshMap=null,this._preActivateId=-1,this._LODLevels=new Array,this._useLODScreenCoverage=!1,this._effectiveMaterial=null,this._forcedInstanceCount=0,this._overrideRenderingFillMode=null}}class Nt extends v.u{static _GetDefaultSideOrientation(t){return t||Nt.FRONTSIDE}get useLODScreenCoverage(){return this._internalMeshDataInfo._useLODScreenCoverage}set useLODScreenCoverage(t){this._internalMeshDataInfo._useLODScreenCoverage=t,this._sortLODLevels()}get computeBonesUsingShaders(){return this._internalAbstractMeshDataInfo._computeBonesUsingShaders}set computeBonesUsingShaders(t){this._internalAbstractMeshDataInfo._computeBonesUsingShaders!==t&&(t&&this._internalMeshDataInfo._sourcePositions&&(this.setVerticesData(R.R.PositionKind,this._internalMeshDataInfo._sourcePositions,!0),this._internalMeshDataInfo._sourceNormals&&this.setVerticesData(R.R.NormalKind,this._internalMeshDataInfo._sourceNormals,!0),this._internalMeshDataInfo._sourcePositions=null,this._internalMeshDataInfo._sourceNormals=null),this._internalAbstractMeshDataInfo._computeBonesUsingShaders=t,this._markSubMeshesAsAttributesDirty())}get onBeforeRenderObservable(){return this._internalMeshDataInfo._onBeforeRenderObservable||(this._internalMeshDataInfo._onBeforeRenderObservable=new d.cP),this._internalMeshDataInfo._onBeforeRenderObservable}get onBeforeBindObservable(){return this._internalMeshDataInfo._onBeforeBindObservable||(this._internalMeshDataInfo._onBeforeBindObservable=new d.cP),this._internalMeshDataInfo._onBeforeBindObservable}get onAfterRenderObservable(){return this._internalMeshDataInfo._onAfterRenderObservable||(this._internalMeshDataInfo._onAfterRenderObservable=new d.cP),this._internalMeshDataInfo._onAfterRenderObservable}get onBetweenPassObservable(){return this._internalMeshDataInfo._onBetweenPassObservable||(this._internalMeshDataInfo._onBetweenPassObservable=new d.cP),this._internalMeshDataInfo._onBetweenPassObservable}get onBeforeDrawObservable(){return this._internalMeshDataInfo._onBeforeDrawObservable||(this._internalMeshDataInfo._onBeforeDrawObservable=new d.cP),this._internalMeshDataInfo._onBeforeDrawObservable}set onBeforeDraw(t){this._onBeforeDrawObserver&&this.onBeforeDrawObservable.remove(this._onBeforeDrawObserver),this._onBeforeDrawObserver=this.onBeforeDrawObservable.add(t)}get hasInstances(){return this.instances.length>0}get hasThinInstances(){return(this.forcedInstanceCount||this._thinInstanceDataStorage.instancesCount||0)>0}get forcedInstanceCount(){return this._internalMeshDataInfo._forcedInstanceCount}set forcedInstanceCount(t){this._internalMeshDataInfo._forcedInstanceCount=t}get sideOrientation(){return this._internalMeshDataInfo._sideOrientation}set sideOrientation(t){this._internalMeshDataInfo._sideOrientation=t,this._internalAbstractMeshDataInfo._sideOrientationHint=this._scene.useRightHandedSystem&&1===t||!this._scene.useRightHandedSystem&&0===t}get overrideMaterialSideOrientation(){return this.sideOrientation}set overrideMaterialSideOrientation(t){this.sideOrientation=t,this.material&&(this.material.sideOrientation=null)}get overrideRenderingFillMode(){return this._internalMeshDataInfo._overrideRenderingFillMode}set overrideRenderingFillMode(t){this._internalMeshDataInfo._overrideRenderingFillMode=t}get material(){return this._internalAbstractMeshDataInfo._material}set material(t){t&&(this.material&&null===this.material.sideOrientation||this._internalAbstractMeshDataInfo._sideOrientationHint)&&(t.sideOrientation=null),this._setMaterial(t)}get source(){return this._internalMeshDataInfo._source}get cloneMeshMap(){return this._internalMeshDataInfo.meshMap}get isUnIndexed(){return this._unIndexed}set isUnIndexed(t){this._unIndexed!==t&&(this._unIndexed=t,this._markSubMeshesAsAttributesDirty())}get worldMatrixInstancedBuffer(){return this._instanceDataStorage.instancesData}get previousWorldMatrixInstancedBuffer(){return this._instanceDataStorage.instancesPreviousData}get manualUpdateOfWorldMatrixInstancedBuffer(){return this._instanceDataStorage.manualUpdate}set manualUpdateOfWorldMatrixInstancedBuffer(t){this._instanceDataStorage.manualUpdate=t}get manualUpdateOfPreviousWorldMatrixInstancedBuffer(){return this._instanceDataStorage.previousManualUpdate}set manualUpdateOfPreviousWorldMatrixInstancedBuffer(t){this._instanceDataStorage.previousManualUpdate=t}get forceWorldMatrixInstancedBufferUpdate(){return this._instanceDataStorage.forceMatrixUpdates}set forceWorldMatrixInstancedBufferUpdate(t){this._instanceDataStorage.forceMatrixUpdates=t}_copySource(t,K,D=!0){const a=this.getScene();if(t._geometry&&t._geometry.applyToMesh(this),F.r.DeepCopy(t,this,["name","material","skeleton","instances","parent","uniqueId","source","metadata","morphTargetManager","hasInstances","worldMatrixInstancedBuffer","previousWorldMatrixInstancedBuffer","hasLODLevels","geometry","isBlocked","areNormalsFrozen","facetNb","isFacetDataEnabled","lightSources","useBones","isAnInstance","collider","edgesRenderer","forward","up","right","absolutePosition","absoluteScaling","absoluteRotationQuaternion","isWorldMatrixFrozen","nonUniformScaling","behaviors","worldMatrixFromCache","hasThinInstances","cloneMeshMap","hasBoundingInfo","physicsBody","physicsImpostor"],["_poseMatrix"]),this._internalMeshDataInfo._source=t,a.useClonedMeshMap&&(t._internalMeshDataInfo.meshMap||(t._internalMeshDataInfo.meshMap={}),t._internalMeshDataInfo.meshMap[this.uniqueId]=this),this._originalBuilderSideOrientation=t._originalBuilderSideOrientation,this._creationDataStorage=t._creationDataStorage,t._ranges){const K=t._ranges;for(const t in K)Object.prototype.hasOwnProperty.call(K,t)&&K[t]&&this.createAnimationRange(t,K[t].from,K[t].to)}if(t.metadata&&t.metadata.clone?this.metadata=t.metadata.clone():this.metadata=t.metadata,this._internalMetadata=t._internalMetadata,c.Y&&c.Y.HasTags(t)&&c.Y.AddTagsTo(this,c.Y.GetTags(t,!0)),this.setEnabled(t.isEnabled(!1)),this.parent=t.parent,this.setPivotMatrix(t.getPivotMatrix(),this._postMultiplyPivotMatrix),this.id=this.name+"."+t.id,this.material=t.material,!K){const K=t.getDescendants(!0);for(let t=0;t<K.length;t++){const D=K[t];D.clone&&D.clone(this.name+"."+D.name,this)}}if(t.morphTargetManager&&(this.morphTargetManager=t.morphTargetManager),a.getPhysicsEngine){const K=a.getPhysicsEngine();if(D&&K)if(1===K.getPluginVersion()){const D=K.getImpostorForPhysicsObject(t);D&&(this.physicsImpostor=D.clone(this))}else 2===K.getPluginVersion()&&t.physicsBody&&t.physicsBody.clone(this)}for(let K=0;K<a.particleSystems.length;K++){const D=a.particleSystems[K];D.emitter===t&&D.clone(D.name,this)}this.skeleton=t.skeleton,this.refreshBoundingInfo(!0,!0),this.computeWorldMatrix(!0)}constructor(t,K=null,D=null,a=null,G,N=!0){super(t,K),this._internalMeshDataInfo=new Gt,this.delayLoadState=0,this.instances=[],this._creationDataStorage=null,this._geometry=null,this._instanceDataStorage=new Kt,this._thinInstanceDataStorage=new at,this._shouldGenerateFlatShading=!1,this._originalBuilderSideOrientation=Nt.DEFAULTSIDE,this.ignoreCameraMaxZ=!1,K=this.getScene(),this._scene.useRightHandedSystem?this.sideOrientation=0:this.sideOrientation=1,this._onBeforeDraw=(t,K,D)=>{t&&D&&(this._uniformBuffer?this.transferToEffect(K):D.bindOnlyWorldMatrix(K))},a&&this._copySource(a,G,N),null!==D&&(this.parent=D),this._instanceDataStorage.hardwareInstancedRendering=this.getEngine().getCaps().instancedArrays,this._internalMeshDataInfo._onMeshReadyObserverAdded=t=>{t.unregisterOnNextCall=!0,this.isReady(!0)?this.onMeshReadyObservable.notifyObservers(this):this._internalMeshDataInfo._checkReadinessObserver||(this._internalMeshDataInfo._checkReadinessObserver=this._scene.onBeforeRenderObservable.add((()=>{this.isReady(!0)&&(this._scene.onBeforeRenderObservable.remove(this._internalMeshDataInfo._checkReadinessObserver),this._internalMeshDataInfo._checkReadinessObserver=null,this.onMeshReadyObservable.notifyObservers(this))})))},this.onMeshReadyObservable=new d.cP(this._internalMeshDataInfo._onMeshReadyObserverAdded),a&&a.onClonedObservable.notifyObservers(this)}instantiateHierarchy(t=null,K,D){const a=0===this.getTotalVertices()||K&&K.doNotInstantiate&&(!0===K.doNotInstantiate||K.doNotInstantiate(this))?this.clone("Clone of "+(this.name||this.id),t||this.parent,!0):this.createInstance("instance of "+(this.name||this.id));a.parent=t||this.parent,a.position=this.position.clone(),a.scaling=this.scaling.clone(),this.rotationQuaternion?a.rotationQuaternion=this.rotationQuaternion.clone():a.rotation=this.rotation.clone(),D&&D(this,a);for(const t of this.getChildTransformNodes(!0))"InstancedMesh"===t.getClassName()&&"Mesh"===a.getClassName()&&t.sourceMesh===this?t.instantiateHierarchy(a,{doNotInstantiate:K&&K.doNotInstantiate||!1,newSourcedMesh:a},D):t.instantiateHierarchy(a,K,D);return a}getClassName(){return"Mesh"}get _isMesh(){return!0}toString(t){let K=super.toString(t);if(K+=", n vertices: "+this.getTotalVertices(),K+=", parent: "+(this._waitingParentId?this._waitingParentId:this.parent?this.parent.name:"NONE"),this.animations)for(let D=0;D<this.animations.length;D++)K+=", animation[0]: "+this.animations[D].toString(t);if(t)if(this._geometry){const t=this.getIndices(),D=this.getVerticesData(R.R.PositionKind);D&&t&&(K+=", flat shading: "+(D.length/3===t.length?"YES":"NO"))}else K+=", flat shading: UNKNOWN";return K}_unBindEffect(){super._unBindEffect();for(const t of this.instances)t._unBindEffect()}get hasLODLevels(){return this._internalMeshDataInfo._LODLevels.length>0}getLODLevels(){return this._internalMeshDataInfo._LODLevels}_sortLODLevels(){const t=this._internalMeshDataInfo._useLODScreenCoverage?-1:1;this._internalMeshDataInfo._LODLevels.sort(((K,D)=>K.distanceOrScreenCoverage<D.distanceOrScreenCoverage?t:K.distanceOrScreenCoverage>D.distanceOrScreenCoverage?-t:0))}addLODLevel(t,K){if(K&&K._masterMesh)return i.V.Warn("You cannot use a mesh as LOD level twice"),this;const D=new k(t,K);return this._internalMeshDataInfo._LODLevels.push(D),K&&(K._masterMesh=this),this._sortLODLevels(),this}getLODLevelAtDistance(t){const K=this._internalMeshDataInfo;for(let D=0;D<K._LODLevels.length;D++){const a=K._LODLevels[D];if(a.distanceOrScreenCoverage===t)return a.mesh}return null}removeLODLevel(t){const K=this._internalMeshDataInfo;for(let D=0;D<K._LODLevels.length;D++)K._LODLevels[D].mesh===t&&(K._LODLevels.splice(D,1),t&&(t._masterMesh=null));return this._sortLODLevels(),this}getLOD(t,K){const D=this._internalMeshDataInfo;if(!D._LODLevels||0===D._LODLevels.length)return this;const a=K||this.getBoundingInfo().boundingSphere,G=t.mode===W.i.ORTHOGRAPHIC_CAMERA?t.minZ:a.centerWorld.subtract(t.globalPosition).length();let N=G,x=1;if(D._useLODScreenCoverage){const K=t.screenArea;let D=a.radiusWorld*t.minZ/G;D=D*D*Math.PI,N=D/K,x=-1}if(x*D._LODLevels[D._LODLevels.length-1].distanceOrScreenCoverage>x*N)return this.onLODLevelSelection&&this.onLODLevelSelection(N,this,this),this;for(let t=0;t<D._LODLevels.length;t++){const K=D._LODLevels[t];if(x*K.distanceOrScreenCoverage<x*N){if(K.mesh){if(4===K.mesh.delayLoadState)return K.mesh._checkDelayState(),this;if(2===K.mesh.delayLoadState)return this;K.mesh._preActivate(),K.mesh._updateSubMeshesBoundingInfo(this.worldMatrixFromCache)}return this.onLODLevelSelection&&this.onLODLevelSelection(N,this,K.mesh),K.mesh}}return this.onLODLevelSelection&&this.onLODLevelSelection(N,this,this),this}get geometry(){return this._geometry}getTotalVertices(){return null===this._geometry||void 0===this._geometry?0:this._geometry.getTotalVertices()}getVerticesData(t,K,D,a){var G,N;if(!this._geometry)return null;let W=a||null===(N=null===(G=this._userInstancedBuffersStorage)||void 0===G?void 0:G.vertexBuffers[t])||void 0===N?void 0:N.getFloatData(this.instances.length+1,D||K&&1!==this._geometry.meshes.length);return W||(W=this._geometry.getVerticesData(t,K,D)),W}copyVerticesData(t,K){this._geometry&&this._geometry.copyVerticesData(t,K)}getVertexBuffer(t,K){var D,a;return this._geometry?null!==(a=K||null===(D=this._userInstancedBuffersStorage)||void 0===D?void 0:D.vertexBuffers[t])&&void 0!==a?a:this._geometry.getVertexBuffer(t):null}isVerticesDataPresent(t,K){var D;return this._geometry?!K&&void 0!==(null===(D=this._userInstancedBuffersStorage)||void 0===D?void 0:D.vertexBuffers[t])||this._geometry.isVerticesDataPresent(t):!!this._delayInfo&&-1!==this._delayInfo.indexOf(t)}isVertexBufferUpdatable(t,K){var D;if(!this._geometry)return!!this._delayInfo&&-1!==this._delayInfo.indexOf(t);if(!K){const K=null===(D=this._userInstancedBuffersStorage)||void 0===D?void 0:D.vertexBuffers[t];if(K)return K.isUpdatable()}return this._geometry.isVertexBufferUpdatable(t)}getVerticesDataKinds(t){if(!this._geometry){const t=[];return this._delayInfo&&this._delayInfo.forEach((function(K){t.push(K)})),t}const K=this._geometry.getVerticesDataKinds();if(!t&&this._userInstancedBuffersStorage)for(const t in this._userInstancedBuffersStorage.vertexBuffers)-1===K.indexOf(t)&&K.push(t);return K}getTotalIndices(){return this._geometry?this._geometry.getTotalIndices():0}getIndices(t,K){return this._geometry?this._geometry.getIndices(t,K):[]}get isBlocked(){return null!==this._masterMesh&&void 0!==this._masterMesh}isReady(t=!1,K=!1){var D,a,G,N,W,x,b;if(2===this.delayLoadState)return!1;if(!super.isReady(t))return!1;if(!this.subMeshes||0===this.subMeshes.length)return!0;if(!t)return!0;const n=this.getEngine(),e=this.getScene(),i=K||n.getCaps().instancedArrays&&(this.instances.length>0||this.hasThinInstances);this.computeWorldMatrix();const z=this.material||e.defaultMaterial;if(z)if(z._storeEffectOnSubMeshes)for(const t of this.subMeshes){const K=t.getMaterial();if(K)if(K._storeEffectOnSubMeshes){if(!K.isReadyForSubMesh(this,t,i))return!1}else if(!K.isReady(this,i))return!1}else if(!z.isReady(this,i))return!1;const I=n.currentRenderPassId;for(const t of this.lightSources){const K=t.getShadowGenerators();if(!K)continue;const e=K.values();for(let t=e.next();!0!==t.done;t=e.next()){const K=t.value;if(K&&(!(null===(D=K.getShadowMap())||void 0===D?void 0:D.renderList)||(null===(a=K.getShadowMap())||void 0===a?void 0:a.renderList)&&-1!==(null===(N=null===(G=K.getShadowMap())||void 0===G?void 0:G.renderList)||void 0===N?void 0:N.indexOf(this)))){const t=null!==(W=K.getShadowMap().renderPassIds)&&void 0!==W?W:[n.currentRenderPassId];for(let D=0;D<t.length;++D){n.currentRenderPassId=t[D];for(const t of this.subMeshes)if(!K.isReady(t,i,null!==(b=null===(x=t.getMaterial())||void 0===x?void 0:x.needAlphaBlendingForMesh(this))&&void 0!==b&&b))return n.currentRenderPassId=I,!1}n.currentRenderPassId=I}}}for(const t of this._internalMeshDataInfo._LODLevels)if(t.mesh&&!t.mesh.isReady(i))return!1;return!0}get areNormalsFrozen(){return this._internalMeshDataInfo._areNormalsFrozen}freezeNormals(){return this._internalMeshDataInfo._areNormalsFrozen=!0,this}unfreezeNormals(){return this._internalMeshDataInfo._areNormalsFrozen=!1,this}set overridenInstanceCount(t){this._instanceDataStorage.overridenInstanceCount=t}_preActivate(){const t=this._internalMeshDataInfo,K=this.getScene().getRenderId();return t._preActivateId===K||(t._preActivateId=K,this._instanceDataStorage.visibleInstances=null),this}_preActivateForIntermediateRendering(t){return this._instanceDataStorage.visibleInstances&&(this._instanceDataStorage.visibleInstances.intermediateDefaultRenderId=t),this}_registerInstanceForRenderId(t,K){return this._instanceDataStorage.visibleInstances||(this._instanceDataStorage.visibleInstances={defaultRenderId:K,selfDefaultRenderId:this._renderId}),this._instanceDataStorage.visibleInstances[K]||(void 0!==this._instanceDataStorage.previousRenderId&&this._instanceDataStorage.isFrozen&&(this._instanceDataStorage.visibleInstances[this._instanceDataStorage.previousRenderId]=null),this._instanceDataStorage.previousRenderId=K,this._instanceDataStorage.visibleInstances[K]=new Array),this._instanceDataStorage.visibleInstances[K].push(t),this}_afterComputeWorldMatrix(){super._afterComputeWorldMatrix(),this.hasThinInstances&&(this.doNotSyncBoundingInfo||this.thinInstanceRefreshBoundingInfo(!1))}_postActivate(){this.edgesShareWithInstances&&this.edgesRenderer&&this.edgesRenderer.isEnabled&&this._renderingGroup&&(this._renderingGroup._edgesRenderers.pushNoDuplicate(this.edgesRenderer),this.edgesRenderer.customInstances.push(this.getWorldMatrix()))}refreshBoundingInfo(t=!1,K=!1){if(this.hasBoundingInfo&&this.getBoundingInfo().isLocked)return this;let D;D="object"==typeof t?t:{applySkeleton:t,applyMorph:K};const a=this.geometry?this.geometry.boundingBias:null;return this._refreshBoundingInfo(this._getData(D,null,R.R.PositionKind),a),this}_createGlobalSubMesh(t){const K=this.getTotalVertices();if(!K||!this.getIndices())return null;if(this.subMeshes&&this.subMeshes.length>0){const D=this.getIndices();if(!D)return null;const a=D.length;let G=!1;if(t)G=!0;else for(const t of this.subMeshes){if(t.indexStart+t.indexCount>a){G=!0;break}if(t.verticesStart+t.verticesCount>K){G=!0;break}}if(!G)return this.subMeshes[0]}return this.releaseSubMeshes(),new Y.K(0,0,K,0,this.getTotalIndices(),this)}subdivide(t){if(t<1)return;const K=this.getTotalIndices();let D=K/t|0,a=0;for(;D%3!=0;)D++;this.releaseSubMeshes();for(let G=0;G<t&&!(a>=K);G++)Y.K.CreateFromIndices(0,a,G===t-1?K-a:D,this,void 0,!1),a+=D;this.refreshBoundingInfo(),this.synchronizeInstances()}setVerticesData(t,K,D=!1,a){if(this._geometry)this._geometry.setVerticesData(t,K,D,a);else{const a=new A.P;a.set(K,t);const G=this.getScene();new O(O.RandomId(),G,a,D,this)}return this}removeVerticesData(t){this._geometry&&this._geometry.removeVerticesData(t)}markVerticesDataAsUpdatable(t,K=!0){const D=this.getVertexBuffer(t);D&&D.isUpdatable()!==K&&this.setVerticesData(t,this.getVerticesData(t),K)}setVerticesBuffer(t,K=!0){return this._geometry||(this._geometry=O.CreateGeometryForMesh(this)),this._geometry.setVerticesBuffer(t,null,K),this}updateVerticesData(t,K,D,a){return this._geometry?(a?(this.makeGeometryUnique(),this.updateVerticesData(t,K,D,!1)):this._geometry.updateVerticesData(t,K,D),this):this}updateMeshPositions(t,K=!0){const D=this.getVerticesData(R.R.PositionKind);if(!D)return this;if(t(D),this.updateVerticesData(R.R.PositionKind,D,!1,!1),K){const t=this.getIndices(),K=this.getVerticesData(R.R.NormalKind);if(!K)return this;A.P.ComputeNormals(D,t,K),this.updateVerticesData(R.R.NormalKind,K,!1,!1)}return this}makeGeometryUnique(){if(!this._geometry)return this;if(1===this._geometry.meshes.length)return this;const t=this._geometry,K=this._geometry.copy(O.RandomId());return t.releaseForMesh(this,!0),K.applyToMesh(this),this}setIndexBuffer(t,K,D){let a=this._geometry;a||(a=new O(O.RandomId(),this.getScene(),void 0,void 0,this)),a.setIndexBuffer(t,K,D)}setIndices(t,K=null,D=!1){if(this._geometry)this._geometry.setIndices(t,K,D);else{const K=new A.P;K.indices=t;const a=this.getScene();new O(O.RandomId(),a,K,D,this)}return this}updateIndices(t,K,D=!1){return this._geometry?(this._geometry.updateIndices(t,K,D),this):this}toLeftHanded(){return this._geometry?(this._geometry.toLeftHanded(),this):this}_bind(t,K,D,a=!0){if(!this._geometry)return this;const G=this.getScene().getEngine();let N;if(this._unIndexed)N=null;else switch(this._getRenderingFillMode(D)){case p.i.PointFillMode:N=null;break;case p.i.WireFrameFillMode:N=t._getLinesIndexBuffer(this.getIndices(),G);break;default:case p.i.TriangleFillMode:N=this._geometry.getIndexBuffer()}return this._bindDirect(K,N,a)}_bindDirect(t,K,D=!0){return this._geometry?(this.morphTargetManager&&this.morphTargetManager.isUsingTextureForTargets&&this.morphTargetManager._bind(t),D&&this._userInstancedBuffersStorage&&!this.hasThinInstances?this._geometry._bind(t,K,this._userInstancedBuffersStorage.vertexBuffers,this._userInstancedBuffersStorage.vertexArrayObjects):this._geometry._bind(t,K),this):this}_draw(t,K,D){if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;this._internalMeshDataInfo._onBeforeDrawObservable&&this._internalMeshDataInfo._onBeforeDrawObservable.notifyObservers(this);const a=this.getScene().getEngine();return this._unIndexed||K==p.i.PointFillMode?a.drawArraysType(K,t.verticesStart,t.verticesCount,this.forcedInstanceCount||D):K==p.i.WireFrameFillMode?a.drawElementsType(K,0,t._linesIndexCount,this.forcedInstanceCount||D):a.drawElementsType(K,t.indexStart,t.indexCount,this.forcedInstanceCount||D),this}registerBeforeRender(t){return this.onBeforeRenderObservable.add(t),this}unregisterBeforeRender(t){return this.onBeforeRenderObservable.removeCallback(t),this}registerAfterRender(t){return this.onAfterRenderObservable.add(t),this}unregisterAfterRender(t){return this.onAfterRenderObservable.removeCallback(t),this}_getInstancesRenderList(t,K=!1){if(this._instanceDataStorage.isFrozen){if(K)return this._instanceDataStorage.batchCacheReplacementModeInFrozenMode.hardwareInstancedRendering[t]=!1,this._instanceDataStorage.batchCacheReplacementModeInFrozenMode.renderSelf[t]=!0,this._instanceDataStorage.batchCacheReplacementModeInFrozenMode;if(this._instanceDataStorage.previousBatch)return this._instanceDataStorage.previousBatch}const D=this.getScene(),a=D._isInIntermediateRendering(),G=a?this._internalAbstractMeshDataInfo._onlyForInstancesIntermediate:this._internalAbstractMeshDataInfo._onlyForInstances,N=this._instanceDataStorage.batchCache;if(N.mustReturn=!1,N.renderSelf[t]=K||!G&&this.isEnabled()&&this.isVisible,N.visibleInstances[t]=null,this._instanceDataStorage.visibleInstances&&!K){const K=this._instanceDataStorage.visibleInstances,G=D.getRenderId(),W=a?K.intermediateDefaultRenderId:K.defaultRenderId;N.visibleInstances[t]=K[G],!N.visibleInstances[t]&&W&&(N.visibleInstances[t]=K[W])}return N.hardwareInstancedRendering[t]=!K&&this._instanceDataStorage.hardwareInstancedRendering&&null!==N.visibleInstances[t]&&void 0!==N.visibleInstances[t],this._instanceDataStorage.previousBatch=N,N}_renderWithInstances(t,K,D,a,G){var W;const x=D.visibleInstances[t._id],b=x?x.length:0,n=this._instanceDataStorage,e=n.instancesBufferSize;let i=n.instancesBuffer,z=n.instancesPreviousBuffer;const I=16*(b+1)*4;for(;n.instancesBufferSize<I;)n.instancesBufferSize*=2;n.instancesData&&e==n.instancesBufferSize||(n.instancesData=new Float32Array(n.instancesBufferSize/4)),(this._scene.needsPreviousWorldMatrices&&!n.instancesPreviousData||e!=n.instancesBufferSize)&&(n.instancesPreviousData=new Float32Array(n.instancesBufferSize/4));let Z=0,w=0;const m=D.renderSelf[t._id],u=!i||e!==n.instancesBufferSize||this._scene.needsPreviousWorldMatrices&&!n.instancesPreviousBuffer;if(this._instanceDataStorage.manualUpdate||n.isFrozen&&!u)w=(m?1:0)+b;else{const K=this.getWorldMatrix();if(m&&(this._scene.needsPreviousWorldMatrices&&(n.masterMeshPreviousWorldMatrix?(n.masterMeshPreviousWorldMatrix.copyToArray(n.instancesPreviousData,Z),n.masterMeshPreviousWorldMatrix.copyFrom(K)):(n.masterMeshPreviousWorldMatrix=K.clone(),n.masterMeshPreviousWorldMatrix.copyToArray(n.instancesPreviousData,Z))),K.copyToArray(n.instancesData,Z),Z+=16,w++),x){if(Nt.INSTANCEDMESH_SORT_TRANSPARENT&&this._scene.activeCamera&&(null===(W=t.getMaterial())||void 0===W?void 0:W.needAlphaBlendingForMesh(t.getRenderingMesh()))){const t=this._scene.activeCamera.globalPosition;for(let K=0;K<x.length;K++){const D=x[K];D._distanceToCamera=N.Pq.Distance(D.getBoundingInfo().boundingSphere.centerWorld,t)}x.sort(((t,K)=>t._distanceToCamera>K._distanceToCamera?-1:t._distanceToCamera<K._distanceToCamera?1:0))}for(let t=0;t<x.length;t++){const K=x[t],D=K.getWorldMatrix();D.copyToArray(n.instancesData,Z),this._scene.needsPreviousWorldMatrices&&(K._previousWorldMatrix?(K._previousWorldMatrix.copyToArray(n.instancesPreviousData,Z),K._previousWorldMatrix.copyFrom(D)):(K._previousWorldMatrix=D.clone(),K._previousWorldMatrix.copyToArray(n.instancesPreviousData,Z))),Z+=16,w++}}}return u?(i&&i.dispose(),z&&z.dispose(),i=new R.h(G,n.instancesData,!0,16,!1,!0),n.instancesBuffer=i,this._userInstancedBuffersStorage||(this._userInstancedBuffersStorage={data:{},vertexBuffers:{},strides:{},sizes:{},vertexArrayObjects:this.getEngine().getCaps().vertexArrayObject?{}:void 0}),this._userInstancedBuffersStorage.vertexBuffers["world0"]=i.createVertexBuffer("world0",0,4),this._userInstancedBuffersStorage.vertexBuffers["world1"]=i.createVertexBuffer("world1",4,4),this._userInstancedBuffersStorage.vertexBuffers["world2"]=i.createVertexBuffer("world2",8,4),this._userInstancedBuffersStorage.vertexBuffers["world3"]=i.createVertexBuffer("world3",12,4),this._scene.needsPreviousWorldMatrices&&(z=new R.h(G,n.instancesPreviousData,!0,16,!1,!0),n.instancesPreviousBuffer=z,this._userInstancedBuffersStorage.vertexBuffers["previousWorld0"]=z.createVertexBuffer("previousWorld0",0,4),this._userInstancedBuffersStorage.vertexBuffers["previousWorld1"]=z.createVertexBuffer("previousWorld1",4,4),this._userInstancedBuffersStorage.vertexBuffers["previousWorld2"]=z.createVertexBuffer("previousWorld2",8,4),this._userInstancedBuffersStorage.vertexBuffers["previousWorld3"]=z.createVertexBuffer("previousWorld3",12,4)),this._invalidateInstanceVertexArrayObject()):this._instanceDataStorage.isFrozen&&!this._instanceDataStorage.forceMatrixUpdates||(i.updateDirectly(n.instancesData,0,w),!this._scene.needsPreviousWorldMatrices||this._instanceDataStorage.manualUpdate&&!this._instanceDataStorage.previousManualUpdate||z.updateDirectly(n.instancesPreviousData,0,w)),this._processInstancedBuffers(x,m),this.getScene()._activeIndices.addCount(t.indexCount*w,!1),G._currentDrawContext&&(G._currentDrawContext.useInstancing=!0),this._bind(t,a,K),this._draw(t,K,w),!this._scene.needsPreviousWorldMatrices||u||!this._instanceDataStorage.manualUpdate||this._instanceDataStorage.isFrozen&&!this._instanceDataStorage.forceMatrixUpdates||this._instanceDataStorage.previousManualUpdate||z.updateDirectly(n.instancesData,0,w),G.unbindInstanceAttributes(),this}_renderWithThinInstances(t,K,D,a){var G,N;const W=null!==(N=null===(G=this._thinInstanceDataStorage)||void 0===G?void 0:G.instancesCount)&&void 0!==N?N:0;this.getScene()._activeIndices.addCount(t.indexCount*W,!1),a._currentDrawContext&&(a._currentDrawContext.useInstancing=!0),this._bind(t,D,K),this._draw(t,K,W),this._scene.needsPreviousWorldMatrices&&!this._thinInstanceDataStorage.previousMatrixData&&this._thinInstanceDataStorage.matrixData&&(this._thinInstanceDataStorage.previousMatrixBuffer?this._thinInstanceDataStorage.previousMatrixBuffer.updateDirectly(this._thinInstanceDataStorage.matrixData,0,W):this._thinInstanceDataStorage.previousMatrixBuffer=this._thinInstanceCreateMatrixBuffer("previousWorld",this._thinInstanceDataStorage.matrixData,!1)),a.unbindInstanceAttributes()}_processInstancedBuffers(t,K){}_processRendering(t,K,D,a,G,N,W,x){const b=this.getScene(),n=b.getEngine();if(a=this._getRenderingFillMode(a),N&&K.getRenderingMesh().hasThinInstances)return this._renderWithThinInstances(K,a,D,n),this;if(N)this._renderWithInstances(K,a,G,D,n);else{n._currentDrawContext&&(n._currentDrawContext.useInstancing=!1);let D=0;G.renderSelf[K._id]&&(W&&W(!1,t.getWorldMatrix(),x),D++,this._draw(K,a,this._instanceDataStorage.overridenInstanceCount));const N=G.visibleInstances[K._id];if(N){const t=N.length;D+=t;for(let D=0;D<t;D++){const t=N[D].getWorldMatrix();W&&W(!0,t,x),this._draw(K,a)}}b._activeIndices.addCount(K.indexCount*D,!1)}return this}_rebuild(t=!1){if(this._instanceDataStorage.instancesBuffer&&(t&&this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null),this._userInstancedBuffersStorage){for(const K in this._userInstancedBuffersStorage.vertexBuffers){const D=this._userInstancedBuffersStorage.vertexBuffers[K];D&&(t&&D.dispose(),this._userInstancedBuffersStorage.vertexBuffers[K]=null)}this._userInstancedBuffersStorage.vertexArrayObjects&&(this._userInstancedBuffersStorage.vertexArrayObjects={})}this._internalMeshDataInfo._effectiveMaterial=null,super._rebuild(t)}_freeze(){if(this.subMeshes){for(let t=0;t<this.subMeshes.length;t++)this._getInstancesRenderList(t);this._internalMeshDataInfo._effectiveMaterial=null,this._instanceDataStorage.isFrozen=!0}}_unFreeze(){this._instanceDataStorage.isFrozen=!1,this._instanceDataStorage.previousBatch=null}renderWithRenderPassId(t,K,D,a,G=!0){const N=this._scene.getEngine(),W=N.currentRenderPassId;if(void 0!==t&&(N.currentRenderPassId=t),a)(!G||G&&a.isInFrustum(this._scene._frustumPlanes))&&this.render(a,!!K,D);else for(let t=0;t<this.subMeshes.length;t++){const a=this.subMeshes[t];(!G||G&&a.isInFrustum(this._scene._frustumPlanes))&&this.render(a,!!K,D)}return void 0!==t&&(N.currentRenderPassId=W),this}render(t,K,D){var a,G,N,W;const x=this.getScene();this._internalAbstractMeshDataInfo._isActiveIntermediate?this._internalAbstractMeshDataInfo._isActiveIntermediate=!1:this._internalAbstractMeshDataInfo._isActive=!1;const b=null!==(G=null===(a=x.activeCameras)||void 0===a?void 0:a.length)&&void 0!==G?G:0;if((b>1&&x.activeCamera===x.activeCameras[0]||b<=1)&&this._checkOcclusionQuery()&&!this._occlusionDataStorage.forceRenderingWhenOccluded)return this;const n=this._getInstancesRenderList(t._id,!!D);if(n.mustReturn)return this;if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;const e=x.getEngine();let i=0,z=null;this.ignoreCameraMaxZ&&x.activeCamera&&!x._isInIntermediateRendering()&&(i=x.activeCamera.maxZ,z=x.activeCamera,x.activeCamera.maxZ=0,x.updateTransformMatrix(!0)),this._internalMeshDataInfo._onBeforeRenderObservable&&this._internalMeshDataInfo._onBeforeRenderObservable.notifyObservers(this);const I=t.getRenderingMesh(),Z=n.hardwareInstancedRendering[t._id]||I.hasThinInstances||!!this._userInstancedBuffersStorage&&!t.getMesh()._internalAbstractMeshDataInfo._actAsRegularMesh,w=this._instanceDataStorage,m=t.getMaterial();if(!m)return z&&(z.maxZ=i,x.updateTransformMatrix(!0)),this;if(w.isFrozen&&this._internalMeshDataInfo._effectiveMaterial&&this._internalMeshDataInfo._effectiveMaterial===m){if(m._storeEffectOnSubMeshes&&!(null===(N=t._drawWrapper)||void 0===N?void 0:N._wasPreviouslyReady)||!m._storeEffectOnSubMeshes&&!m._getDrawWrapper()._wasPreviouslyReady)return z&&(z.maxZ=i,x.updateTransformMatrix(!0)),this}else{if(m._storeEffectOnSubMeshes){if(!m.isReadyForSubMesh(this,t,Z))return z&&(z.maxZ=i,x.updateTransformMatrix(!0)),this}else if(!m.isReady(this,Z))return z&&(z.maxZ=i,x.updateTransformMatrix(!0)),this;this._internalMeshDataInfo._effectiveMaterial=m}let u;K&&e.setAlphaMode(this._internalMeshDataInfo._effectiveMaterial.alphaMode),u=this._internalMeshDataInfo._effectiveMaterial._storeEffectOnSubMeshes?t._drawWrapper:this._internalMeshDataInfo._effectiveMaterial._getDrawWrapper();const d=null!==(W=null==u?void 0:u.effect)&&void 0!==W?W:null;for(const K of x._beforeRenderingMeshStage)K.action(this,t,n,d);if(!u||!d)return z&&(z.maxZ=i,x.updateTransformMatrix(!0)),this;const E=D||this;let l;if(w.isFrozen||!this._internalMeshDataInfo._effectiveMaterial.backFaceCulling&&null===this._internalMeshDataInfo._effectiveMaterial.sideOrientation&&!this._internalMeshDataInfo._effectiveMaterial.twoSidedLighting)l=w.sideOrientation;else{const t=E._getWorldMatrixDeterminant();l=this._internalMeshDataInfo._effectiveMaterial._getEffectiveOrientation(this),t<0&&(l=l===p.i.ClockWiseSideOrientation?p.i.CounterClockWiseSideOrientation:p.i.ClockWiseSideOrientation),w.sideOrientation=l}const Q=this._internalMeshDataInfo._effectiveMaterial._preBind(u,l);this._internalMeshDataInfo._effectiveMaterial.forceDepthWrite&&e.setDepthWrite(!0);const P=this._internalMeshDataInfo._effectiveMaterial,y=P.fillMode;this._internalMeshDataInfo._onBeforeBindObservable&&this._internalMeshDataInfo._onBeforeBindObservable.notifyObservers(this),Z||this._bind(t,d,y,!1);const q=E.getWorldMatrix();P._storeEffectOnSubMeshes?P.bindForSubMesh(q,this,t):P.bind(q,this),!P.backFaceCulling&&P.separateCullingPass&&(e.setState(!0,P.zOffset,!1,!Q,P.cullBackFaces,P.stencil,P.zOffsetUnits),this._processRendering(this,t,d,y,n,Z,this._onBeforeDraw,this._internalMeshDataInfo._effectiveMaterial),e.setState(!0,P.zOffset,!1,Q,P.cullBackFaces,P.stencil,P.zOffsetUnits),this._internalMeshDataInfo._onBetweenPassObservable&&this._internalMeshDataInfo._onBetweenPassObservable.notifyObservers(t)),this._processRendering(this,t,d,y,n,Z,this._onBeforeDraw,this._internalMeshDataInfo._effectiveMaterial),this._internalMeshDataInfo._effectiveMaterial.unbind();for(const K of x._afterRenderingMeshStage)K.action(this,t,n,d);return this._internalMeshDataInfo._onAfterRenderObservable&&this._internalMeshDataInfo._onAfterRenderObservable.notifyObservers(this),z&&(z.maxZ=i,x.updateTransformMatrix(!0)),2!==x.performancePriority||w.isFrozen||this._freeze(),this}cleanMatrixWeights(){this.isVerticesDataPresent(R.R.MatricesWeightsKind)&&(this.isVerticesDataPresent(R.R.MatricesWeightsExtraKind)?this._normalizeSkinWeightsAndExtra():this._normalizeSkinFourWeights())}_normalizeSkinFourWeights(){const t=this.getVerticesData(R.R.MatricesWeightsKind),K=t.length;for(let D=0;D<K;D+=4){const K=t[D]+t[D+1]+t[D+2]+t[D+3];if(0===K)t[D]=1;else{const a=1/K;t[D]*=a,t[D+1]*=a,t[D+2]*=a,t[D+3]*=a}}this.setVerticesData(R.R.MatricesWeightsKind,t)}_normalizeSkinWeightsAndExtra(){const t=this.getVerticesData(R.R.MatricesWeightsExtraKind),K=this.getVerticesData(R.R.MatricesWeightsKind),D=K.length;for(let a=0;a<D;a+=4){let D=K[a]+K[a+1]+K[a+2]+K[a+3];if(D+=t[a]+t[a+1]+t[a+2]+t[a+3],0===D)K[a]=1;else{const G=1/D;K[a]*=G,K[a+1]*=G,K[a+2]*=G,K[a+3]*=G,t[a]*=G,t[a+1]*=G,t[a+2]*=G,t[a+3]*=G}}this.setVerticesData(R.R.MatricesWeightsKind,K),this.setVerticesData(R.R.MatricesWeightsKind,t)}validateSkinning(){const t=this.getVerticesData(R.R.MatricesWeightsExtraKind),K=this.getVerticesData(R.R.MatricesWeightsKind);if(null===K||null==this.skeleton)return{skinned:!1,valid:!0,report:"not skinned"};const D=K.length;let a=0,G=0,N=0,W=0;const x=null===t?4:8,b=[];for(let t=0;t<=x;t++)b[t]=0;const n=.001;for(let e=0;e<D;e+=4){let D=K[e],i=D,z=0===i?0:1;for(let G=1;G<x;G++){const N=G<4?K[e+G]:t[e+G-4];N>D&&a++,0!==N&&z++,i+=N,D=N}if(b[z]++,z>N&&(N=z),0===i)G++;else{const D=1/i;let a=0;for(let G=0;G<x;G++)a+=G<4?Math.abs(K[e+G]-K[e+G]*D):Math.abs(t[e+G-4]-t[e+G-4]*D);a>n&&W++}}const e=this.skeleton.bones.length,i=this.getVerticesData(R.R.MatricesIndicesKind),z=this.getVerticesData(R.R.MatricesIndicesExtraKind);let I=0;for(let t=0;t<D;t+=4)for(let K=0;K<x;K++){const D=K<4?i[t+K]:z[t+K-4];(D>=e||D<0)&&I++}return{skinned:!0,valid:0===G&&0===W&&0===I,report:"Number of Weights = "+D/4+"\nMaximum influences = "+N+"\nMissing Weights = "+G+"\nNot Sorted = "+a+"\nNot Normalized = "+W+"\nWeightCounts = ["+b+"]"+"\nNumber of bones = "+e+"\nBad Bone Indices = "+I}}_checkDelayState(){const t=this.getScene();return this._geometry?this._geometry.load(t):4===this.delayLoadState&&(this.delayLoadState=2,this._queueLoad(t)),this}_queueLoad(t){t.addPendingData(this);const K=-1!==this.delayLoadingFile.indexOf(".babylonbinarymeshdata");return m.S0.LoadFile(this.delayLoadingFile,(K=>{K instanceof ArrayBuffer?this._delayLoadingFunction(K,this):this._delayLoadingFunction(JSON.parse(K),this),this.instances.forEach((t=>{t.refreshBoundingInfo(),t._syncSubMeshes()})),this.delayLoadState=1,t.removePendingData(this)}),(()=>{}),t.offlineProvider,K),this}isInFrustum(t){return 2!==this.delayLoadState&&!!super.isInFrustum(t)&&(this._checkDelayState(),!0)}setMaterialById(t){const K=this.getScene().materials;let D;for(D=K.length-1;D>-1;D--)if(K[D].id===t)return this.material=K[D],this;const a=this.getScene().multiMaterials;for(D=a.length-1;D>-1;D--)if(a[D].id===t)return this.material=a[D],this;return this}getAnimatables(){const t=[];return this.material&&t.push(this.material),this.skeleton&&t.push(this.skeleton),t}bakeTransformIntoVertices(t){if(!this.isVerticesDataPresent(R.R.PositionKind))return this;const K=this.subMeshes.splice(0);this._resetPointsArrayCache();let D=this.getVerticesData(R.R.PositionKind);const a=N.Pq.Zero();let G;for(G=0;G<D.length;G+=3)N.Pq.TransformCoordinatesFromFloatsToRef(D[G],D[G+1],D[G+2],t,a).toArray(D,G);if(this.setVerticesData(R.R.PositionKind,D,this.getVertexBuffer(R.R.PositionKind).isUpdatable()),this.isVerticesDataPresent(R.R.NormalKind)){for(D=this.getVerticesData(R.R.NormalKind),G=0;G<D.length;G+=3)N.Pq.TransformNormalFromFloatsToRef(D[G],D[G+1],D[G+2],t,a).normalize().toArray(D,G);this.setVerticesData(R.R.NormalKind,D,this.getVertexBuffer(R.R.NormalKind).isUpdatable())}if(this.isVerticesDataPresent(R.R.TangentKind)){for(D=this.getVerticesData(R.R.TangentKind),G=0;G<D.length;G+=4)N.Pq.TransformNormalFromFloatsToRef(D[G],D[G+1],D[G+2],t,a).normalize().toArray(D,G);this.setVerticesData(R.R.TangentKind,D,this.getVertexBuffer(R.R.TangentKind).isUpdatable())}return t.determinant()<0&&this.flipFaces(),this.releaseSubMeshes(),this.subMeshes=K,this}bakeCurrentTransformIntoVertices(t=!0){return this.bakeTransformIntoVertices(this.computeWorldMatrix(!0)),this.resetLocalMatrix(t),this}get _positions(){return this._internalAbstractMeshDataInfo._positions||this._geometry&&this._geometry._positions||null}_resetPointsArrayCache(){return this._geometry&&this._geometry._resetPointsArrayCache(),this}_generatePointsArray(){return!!this._geometry&&this._geometry._generatePointsArray()}clone(t="",K=null,D,a=!0){return new Nt(t,this.getScene(),K,this,D,a)}dispose(t,K=!1){this.morphTargetManager=null,this._geometry&&this._geometry.releaseForMesh(this,!0);const D=this._internalMeshDataInfo;if(D._onBeforeDrawObservable&&D._onBeforeDrawObservable.clear(),D._onBeforeBindObservable&&D._onBeforeBindObservable.clear(),D._onBeforeRenderObservable&&D._onBeforeRenderObservable.clear(),D._onAfterRenderObservable&&D._onAfterRenderObservable.clear(),D._onBetweenPassObservable&&D._onBetweenPassObservable.clear(),this._scene.useClonedMeshMap){if(D.meshMap)for(const t in D.meshMap){const K=D.meshMap[t];K&&(K._internalMeshDataInfo._source=null,D.meshMap[t]=void 0)}D._source&&D._source._internalMeshDataInfo.meshMap&&(D._source._internalMeshDataInfo.meshMap[this.uniqueId]=void 0)}else{const t=this.getScene().meshes;for(const K of t){const t=K;t._internalMeshDataInfo&&t._internalMeshDataInfo._source&&t._internalMeshDataInfo._source===this&&(t._internalMeshDataInfo._source=null)}}D._source=null,this._instanceDataStorage.visibleInstances={},this._disposeInstanceSpecificData(),this._disposeThinInstanceSpecificData(),this._internalMeshDataInfo._checkReadinessObserver&&this._scene.onBeforeRenderObservable.remove(this._internalMeshDataInfo._checkReadinessObserver),super.dispose(t,K)}_disposeInstanceSpecificData(){}_disposeThinInstanceSpecificData(){}_invalidateInstanceVertexArrayObject(){}applyDisplacementMap(t,K,D,a,G,N,W=!1,x){const b=this.getScene();return m.S0.LoadImage(t,(t=>{const x=t.width,b=t.height,n=this.getEngine().createCanvas(x,b).getContext("2d");n.drawImage(t,0,0);const e=n.getImageData(0,0,x,b).data;this.applyDisplacementMapFromBuffer(e,x,b,K,D,G,N,W),a&&a(this)}),x||(()=>{}),b.offlineProvider),this}applyDisplacementMapFromBuffer(t,K,D,a,G,W,x,b=!1){if(!this.isVerticesDataPresent(R.R.PositionKind)||!this.isVerticesDataPresent(R.R.NormalKind)||!this.isVerticesDataPresent(R.R.UVKind))return i.V.Warn("Cannot call applyDisplacementMap: Given mesh is not complete. Position, Normal or UV are missing"),this;const n=this.getVerticesData(R.R.PositionKind,!0,!0),e=this.getVerticesData(R.R.NormalKind),z=this.getVerticesData(R.R.UVKind);let I=N.Pq.Zero();const Z=N.Pq.Zero(),w=N.I9.Zero();W=W||N.I9.Zero(),x=x||new N.I9(1,1);for(let b=0;b<n.length;b+=3){N.Pq.FromArrayToRef(n,b,I),N.Pq.FromArrayToRef(e,b,Z),N.I9.FromArrayToRef(z,b/3*2,w);const i=4*((Math.abs(w.x*x.x+W.x%1)*(K-1)%K|0)+(Math.abs(w.y*x.y+W.y%1)*(D-1)%D|0)*K),m=.3*(t[i]/255)+.59*(t[i+1]/255)+.11*(t[i+2]/255);Z.normalize(),Z.scaleInPlace(a+(G-a)*m),I=I.add(Z),I.toArray(n,b)}return A.P.ComputeNormals(n,this.getIndices(),e),b?(this.setVerticesData(R.R.PositionKind,n),this.setVerticesData(R.R.NormalKind,e),this.setVerticesData(R.R.UVKind,z)):(this.updateVerticesData(R.R.PositionKind,n),this.updateVerticesData(R.R.NormalKind,e)),this}_getFlattenedNormals(t,K){const D=new Float32Array(3*t.length);let a=0;const G=this.sideOrientation===(this._scene.useRightHandedSystem?1:0);for(let W=0;W<t.length;W+=3){const x=N.Pq.FromArray(K,3*t[W]),b=N.Pq.FromArray(K,3*t[W+1]),n=N.Pq.FromArray(K,3*t[W+2]),e=x.subtract(b),i=n.subtract(b),z=N.Pq.Normalize(N.Pq.Cross(e,i));G&&z.scaleInPlace(-1);for(let t=0;t<3;t++)D[a++]=z.x,D[a++]=z.y,D[a++]=z.z}return D}_convertToUnIndexedMesh(t=!1){const K=this.getVerticesDataKinds().filter((t=>{var K;return!(null===(K=this.getVertexBuffer(t))||void 0===K?void 0:K.getIsInstanced())})),D=this.getIndices(),a={},G=(t,K)=>{const a=new Float32Array(D.length*K);let G=0;for(let N=0;N<D.length;N++)for(let W=0;W<K;W++)a[G++]=t[D[N]*K+W];return a},N=this.getBoundingInfo(),W=this.geometry?this.subMeshes.slice(0):[];for(const t of K)a[t]=this.getVerticesData(t);for(const N of K){const K=this.getVertexBuffer(N),W=K.getSize();if(t&&N===R.R.NormalKind){const t=this._getFlattenedNormals(D,a[R.R.PositionKind]);this.setVerticesData(R.R.NormalKind,t,K.isUpdatable(),W)}else this.setVerticesData(N,G(a[N],W),K.isUpdatable(),W)}if(this.morphTargetManager){for(let K=0;K<this.morphTargetManager.numTargets;K++){const a=this.morphTargetManager.getTarget(K),N=a.getPositions();a.setPositions(G(N,3));const W=a.getNormals();W&&a.setNormals(t?this._getFlattenedNormals(D,N):G(W,3));const x=a.getTangents();x&&a.setTangents(G(x,3));const b=a.getUVs();b&&a.setUVs(G(b,2))}this.morphTargetManager.synchronize()}for(let t=0;t<D.length;t++)D[t]=t;this.setIndices(D),this._unIndexed=!0,this.releaseSubMeshes();for(const t of W){const K=t.getBoundingInfo();Y.K.AddToMesh(t.materialIndex,t.indexStart,t.indexCount,t.indexStart,t.indexCount,this).setBoundingInfo(K)}return this.setBoundingInfo(N),this.synchronizeInstances(),this}convertToFlatShadedMesh(){return this._convertToUnIndexedMesh(!0)}convertToUnIndexedMesh(){return this._convertToUnIndexedMesh()}flipFaces(t=!1){const K=A.P.ExtractFromMesh(this);let D;if(t&&this.isVerticesDataPresent(R.R.NormalKind)&&K.normals)for(D=0;D<K.normals.length;D++)K.normals[D]*=-1;if(K.indices){let t;for(D=0;D<K.indices.length;D+=3)t=K.indices[D+1],K.indices[D+1]=K.indices[D+2],K.indices[D+2]=t}return K.applyToMesh(this,this.isVertexBufferUpdatable(R.R.PositionKind)),this}increaseVertices(t=1){const K=A.P.ExtractFromMesh(this),D=K.indices&&!Array.isArray(K.indices)&&Array.from?Array.from(K.indices):K.indices,a=K.positions&&!Array.isArray(K.positions)&&Array.from?Array.from(K.positions):K.positions,G=K.uvs&&!Array.isArray(K.uvs)&&Array.from?Array.from(K.uvs):K.uvs,W=K.normals&&!Array.isArray(K.normals)&&Array.from?Array.from(K.normals):K.normals;if(D&&a){K.indices=D,K.positions=a,G&&(K.uvs=G),W&&(K.normals=W);const x=t+1,b=new Array;for(let t=0;t<x+1;t++)b[t]=new Array;let n,e;const i=new N.Pq(0,0,0),z=new N.Pq(0,0,0),I=new N.I9(0,0),Z=new Array,w=new Array,m=new Array;let u,d,E,l=a.length;G&&(d=G.length),W&&(E=W.length);for(let t=0;t<D.length;t+=3){w[0]=D[t],w[1]=D[t+1],w[2]=D[t+2];for(let t=0;t<3;t++)if(n=w[t],e=w[(t+1)%3],void 0===m[n]&&void 0===m[e]?(m[n]=new Array,m[e]=new Array):(void 0===m[n]&&(m[n]=new Array),void 0===m[e]&&(m[e]=new Array)),void 0===m[n][e]&&void 0===m[e][n]){m[n][e]=[],i.x=(a[3*e]-a[3*n])/x,i.y=(a[3*e+1]-a[3*n+1])/x,i.z=(a[3*e+2]-a[3*n+2])/x,W&&(z.x=(W[3*e]-W[3*n])/x,z.y=(W[3*e+1]-W[3*n+1])/x,z.z=(W[3*e+2]-W[3*n+2])/x),G&&(I.x=(G[2*e]-G[2*n])/x,I.y=(G[2*e+1]-G[2*n+1])/x),m[n][e].push(n);for(let t=1;t<x;t++)m[n][e].push(a.length/3),a[l++]=a[3*n]+t*i.x,a[l++]=a[3*n+1]+t*i.y,a[l++]=a[3*n+2]+t*i.z,W&&(W[E++]=W[3*n]+t*z.x,W[E++]=W[3*n+1]+t*z.y,W[E++]=W[3*n+2]+t*z.z),G&&(G[d++]=G[2*n]+t*I.x,G[d++]=G[2*n+1]+t*I.y);m[n][e].push(e),m[e][n]=new Array,u=m[n][e].length;for(let t=0;t<u;t++)m[e][n][t]=m[n][e][u-1-t]}b[0][0]=D[t],b[1][0]=m[D[t]][D[t+1]][1],b[1][1]=m[D[t]][D[t+2]][1];for(let K=2;K<x;K++){b[K][0]=m[D[t]][D[t+1]][K],b[K][K]=m[D[t]][D[t+2]][K],i.x=(a[3*b[K][K]]-a[3*b[K][0]])/K,i.y=(a[3*b[K][K]+1]-a[3*b[K][0]+1])/K,i.z=(a[3*b[K][K]+2]-a[3*b[K][0]+2])/K,W&&(z.x=(W[3*b[K][K]]-W[3*b[K][0]])/K,z.y=(W[3*b[K][K]+1]-W[3*b[K][0]+1])/K,z.z=(W[3*b[K][K]+2]-W[3*b[K][0]+2])/K),G&&(I.x=(G[2*b[K][K]]-G[2*b[K][0]])/K,I.y=(G[2*b[K][K]+1]-G[2*b[K][0]+1])/K);for(let t=1;t<K;t++)b[K][t]=a.length/3,a[l++]=a[3*b[K][0]]+t*i.x,a[l++]=a[3*b[K][0]+1]+t*i.y,a[l++]=a[3*b[K][0]+2]+t*i.z,W&&(W[E++]=W[3*b[K][0]]+t*z.x,W[E++]=W[3*b[K][0]+1]+t*z.y,W[E++]=W[3*b[K][0]+2]+t*z.z),G&&(G[d++]=G[2*b[K][0]]+t*I.x,G[d++]=G[2*b[K][0]+1]+t*I.y)}b[x]=m[D[t+1]][D[t+2]],Z.push(b[0][0],b[1][0],b[1][1]);for(let t=1;t<x;t++){let K;for(K=0;K<t;K++)Z.push(b[t][K],b[t+1][K],b[t+1][K+1]),Z.push(b[t][K],b[t+1][K+1],b[t][K+1]);Z.push(b[t][K],b[t+1][K],b[t+1][K+1])}}K.indices=Z,K.applyToMesh(this,this.isVertexBufferUpdatable(R.R.PositionKind))}else i.V.Warn("Couldn't increase number of vertices : VertexData must contain at least indices and positions")}forceSharedVertices(){const t=A.P.ExtractFromMesh(this),K=t.uvs,D=t.indices,a=t.positions,G=t.colors,N=t.matricesIndices,W=t.matricesWeights,x=t.matricesIndicesExtra,b=t.matricesWeightsExtra;if(void 0===D||void 0===a||null===D||null===a)i.V.Warn("VertexData contains empty entries");else{const n=new Array,e=new Array,i=new Array,z=new Array,I=new Array,Z=new Array,w=new Array,m=new Array;let u=new Array,d=0;const E={};let l,Q;for(let t=0;t<D.length;t+=3){Q=[D[t],D[t+1],D[t+2]],u=[];for(let t=0;t<3;t++){u[t]="";for(let K=0;K<3;K++)Math.abs(a[3*Q[t]+K])<1e-8&&(a[3*Q[t]+K]=0),u[t]+=a[3*Q[t]+K]+"|"}if(u[0]!=u[1]&&u[0]!=u[2]&&u[1]!=u[2])for(let t=0;t<3;t++){if(l=E[u[t]],void 0===l){E[u[t]]=d,l=d++;for(let K=0;K<3;K++)n.push(a[3*Q[t]+K]);if(null!=G)for(let K=0;K<4;K++)z.push(G[4*Q[t]+K]);if(null!=K)for(let D=0;D<2;D++)i.push(K[2*Q[t]+D]);if(null!=N)for(let K=0;K<4;K++)I.push(N[4*Q[t]+K]);if(null!=W)for(let K=0;K<4;K++)Z.push(W[4*Q[t]+K]);if(null!=x)for(let K=0;K<4;K++)w.push(x[4*Q[t]+K]);if(null!=b)for(let K=0;K<4;K++)m.push(b[4*Q[t]+K])}e.push(l)}}const P=new Array;A.P.ComputeNormals(n,e,P),t.positions=n,t.indices=e,t.normals=P,null!=K&&(t.uvs=i),null!=G&&(t.colors=z),null!=N&&(t.matricesIndices=I),null!=W&&(t.matricesWeights=Z),null!=x&&(t.matricesIndicesExtra=w),null!=W&&(t.matricesWeightsExtra=m),t.applyToMesh(this,this.isVertexBufferUpdatable(R.R.PositionKind))}}static _instancedMeshFactory(t,K){throw r.n("InstancedMesh")}static _PhysicsImpostorParser(t,K,D){throw r.n("PhysicsImpostor")}createInstance(t){return Nt._instancedMeshFactory(t,this)}synchronizeInstances(){for(let t=0;t<this.instances.length;t++)this.instances[t]._syncSubMeshes();return this}optimizeIndices(t){const K=this.getIndices(),D=this.getVerticesData(R.R.PositionKind);if(!D||!K)return this;const a=[];for(let t=0;t<D.length;t+=3)a.push(N.Pq.FromArray(D,t));const G=[];return m.LV.SyncAsyncForLoop(a.length,40,(t=>{const K=a.length-1-t,D=a[K];for(let t=0;t<K;++t){const N=a[t];if(D.equals(N)){G[K]=t;break}}}),(()=>{for(let t=0;t<K.length;++t)K[t]=G[K[t]]||K[t];const D=this.subMeshes.slice(0);this.setIndices(K),this.subMeshes=D,t&&t(this)})),this}serialize(t={}){t.name=this.name,t.id=this.id,t.uniqueId=this.uniqueId,t.type=this.getClassName(),c.Y&&c.Y.HasTags(this)&&(t.tags=c.Y.GetTags(this)),t.position=this.position.asArray(),this.rotationQuaternion?t.rotationQuaternion=this.rotationQuaternion.asArray():this.rotation&&(t.rotation=this.rotation.asArray()),t.scaling=this.scaling.asArray(),this._postMultiplyPivotMatrix?t.pivotMatrix=this.getPivotMatrix().asArray():t.localMatrix=this.getPivotMatrix().asArray(),t.isEnabled=this.isEnabled(!1),t.isVisible=this.isVisible,t.infiniteDistance=this.infiniteDistance,t.pickable=this.isPickable,t.receiveShadows=this.receiveShadows,t.billboardMode=this.billboardMode,t.visibility=this.visibility,t.alwaysSelectAsActiveMesh=this.alwaysSelectAsActiveMesh,t.checkCollisions=this.checkCollisions,t.ellipsoid=this.ellipsoid.asArray(),t.ellipsoidOffset=this.ellipsoidOffset.asArray(),t.doNotSyncBoundingInfo=this.doNotSyncBoundingInfo,t.isBlocker=this.isBlocker,t.sideOrientation=this.sideOrientation,this.parent&&this.parent._serializeAsParent(t),t.isUnIndexed=this.isUnIndexed;const K=this._geometry;if(K&&this.subMeshes){t.geometryUniqueId=K.uniqueId,t.geometryId=K.id,t.subMeshes=[];for(let K=0;K<this.subMeshes.length;K++){const D=this.subMeshes[K];t.subMeshes.push({materialIndex:D.materialIndex,verticesStart:D.verticesStart,verticesCount:D.verticesCount,indexStart:D.indexStart,indexCount:D.indexCount})}}if(this.material?this.material.doNotSerialize||(t.materialUniqueId=this.material.uniqueId,t.materialId=this.material.id):(this.material=null,t.materialUniqueId=this._scene.defaultMaterial.uniqueId,t.materialId=this._scene.defaultMaterial.id),this.morphTargetManager&&(t.morphTargetManagerId=this.morphTargetManager.uniqueId),this.skeleton&&(t.skeletonId=this.skeleton.id,t.numBoneInfluencers=this.numBoneInfluencers),this.getScene()._getComponent(M.v.NAME_PHYSICSENGINE)){const K=this.getPhysicsImpostor();K&&(t.physicsMass=K.getParam("mass"),t.physicsFriction=K.getParam("friction"),t.physicsRestitution=K.getParam("mass"),t.physicsImpostor=K.type)}this.metadata&&(t.metadata=this.metadata),t.instances=[];for(let K=0;K<this.instances.length;K++){const D=this.instances[K];if(D.doNotSerialize)continue;const a={name:D.name,id:D.id,isEnabled:D.isEnabled(!1),isVisible:D.isVisible,isPickable:D.isPickable,checkCollisions:D.checkCollisions,position:D.position.asArray(),scaling:D.scaling.asArray()};if(D.parent&&D.parent._serializeAsParent(a),D.rotationQuaternion?a.rotationQuaternion=D.rotationQuaternion.asArray():D.rotation&&(a.rotation=D.rotation.asArray()),this.getScene()._getComponent(M.v.NAME_PHYSICSENGINE)){const t=D.getPhysicsImpostor();t&&(a.physicsMass=t.getParam("mass"),a.physicsFriction=t.getParam("friction"),a.physicsRestitution=t.getParam("mass"),a.physicsImpostor=t.type)}D.metadata&&(a.metadata=D.metadata),D.actionManager&&(a.actions=D.actionManager.serialize(D.name)),t.instances.push(a),z.p.AppendSerializedAnimations(D,a),a.ranges=D.serializeAnimationRanges()}if(this._thinInstanceDataStorage.instancesCount&&this._thinInstanceDataStorage.matrixData&&(t.thinInstances={instancesCount:this._thinInstanceDataStorage.instancesCount,matrixData:Array.from(this._thinInstanceDataStorage.matrixData),matrixBufferSize:this._thinInstanceDataStorage.matrixBufferSize,enablePicking:this.thinInstanceEnablePicking},this._userThinInstanceBuffersStorage)){const K={data:{},sizes:{},strides:{}};for(const t in this._userThinInstanceBuffersStorage.data)K.data[t]=Array.from(this._userThinInstanceBuffersStorage.data[t]),K.sizes[t]=this._userThinInstanceBuffersStorage.sizes[t],K.strides[t]=this._userThinInstanceBuffersStorage.strides[t];t.thinInstances.userThinInstance=K}return z.p.AppendSerializedAnimations(this,t),t.ranges=this.serializeAnimationRanges(),t.layerMask=this.layerMask,t.alphaIndex=this.alphaIndex,t.hasVertexAlpha=this.hasVertexAlpha,t.overlayAlpha=this.overlayAlpha,t.overlayColor=this.overlayColor.asArray(),t.renderOverlay=this.renderOverlay,t.applyFog=this.applyFog,this.actionManager&&(t.actions=this.actionManager.serialize(this.name)),t}_syncGeometryWithMorphTargetManager(){if(!this.geometry)return;this._markSubMeshesAsAttributesDirty();const t=this._internalAbstractMeshDataInfo._morphTargetManager;if(t&&t.vertexCount){if(t.vertexCount!==this.getTotalVertices())return i.V.Error("Mesh is incompatible with morph targets. Targets and mesh must all have the same vertices count."),void(this.morphTargetManager=null);if(t.isUsingTextureForTargets)return;for(let K=0;K<t.numInfluencers;K++){const D=t.getActiveTarget(K),a=D.getPositions();if(!a)return void i.V.Error("Invalid morph target. Target must have positions.");this.geometry.setVerticesData(R.R.PositionKind+K,a,!1,3);const G=D.getNormals();G&&this.geometry.setVerticesData(R.R.NormalKind+K,G,!1,3);const N=D.getTangents();N&&this.geometry.setVerticesData(R.R.TangentKind+K,N,!1,3);const W=D.getUVs();W&&this.geometry.setVerticesData(R.R.UVKind+"_"+K,W,!1,2)}}else{let t=0;for(;this.geometry.isVerticesDataPresent(R.R.PositionKind+t);)this.geometry.removeVerticesData(R.R.PositionKind+t),this.geometry.isVerticesDataPresent(R.R.NormalKind+t)&&this.geometry.removeVerticesData(R.R.NormalKind+t),this.geometry.isVerticesDataPresent(R.R.TangentKind+t)&&this.geometry.removeVerticesData(R.R.TangentKind+t),this.geometry.isVerticesDataPresent(R.R.UVKind+t)&&this.geometry.removeVerticesData(R.R.UVKind+"_"+t),t++}}static Parse(t,K,D){let a;if(a=t.type&&"LinesMesh"===t.type?Nt._LinesMeshParser(t,K):t.type&&"GroundMesh"===t.type?Nt._GroundMeshParser(t,K):t.type&&"GoldbergMesh"===t.type?Nt._GoldbergMeshParser(t,K):t.type&&"GreasedLineMesh"===t.type?Nt._GreasedLineMeshParser(t,K):t.type&&"TrailMesh"===t.type?Nt._TrailMeshParser(t,K):new Nt(t.name,K),a.id=t.id,a._waitingParsedUniqueId=t.uniqueId,c.Y&&c.Y.AddTagsTo(a,t.tags),a.position=N.Pq.FromArray(t.position),void 0!==t.metadata&&(a.metadata=t.metadata),t.rotationQuaternion?a.rotationQuaternion=N.PT.FromArray(t.rotationQuaternion):t.rotation&&(a.rotation=N.Pq.FromArray(t.rotation)),a.scaling=N.Pq.FromArray(t.scaling),t.localMatrix?a.setPreTransformMatrix(N.uq.FromArray(t.localMatrix)):t.pivotMatrix&&a.setPivotMatrix(N.uq.FromArray(t.pivotMatrix)),a.setEnabled(t.isEnabled),a.isVisible=t.isVisible,a.infiniteDistance=t.infiniteDistance,a.alwaysSelectAsActiveMesh=!!t.alwaysSelectAsActiveMesh,a.showBoundingBox=t.showBoundingBox,a.showSubMeshesBoundingBox=t.showSubMeshesBoundingBox,void 0!==t.applyFog&&(a.applyFog=t.applyFog),void 0!==t.pickable&&(a.isPickable=t.pickable),void 0!==t.alphaIndex&&(a.alphaIndex=t.alphaIndex),a.receiveShadows=t.receiveShadows,void 0!==t.billboardMode&&(a.billboardMode=t.billboardMode),void 0!==t.visibility&&(a.visibility=t.visibility),a.checkCollisions=t.checkCollisions,a.doNotSyncBoundingInfo=!!t.doNotSyncBoundingInfo,t.ellipsoid&&(a.ellipsoid=N.Pq.FromArray(t.ellipsoid)),t.ellipsoidOffset&&(a.ellipsoidOffset=N.Pq.FromArray(t.ellipsoidOffset)),null!=t.overrideMaterialSideOrientation&&(a.sideOrientation=t.overrideMaterialSideOrientation),void 0!==t.sideOrientation&&(a.sideOrientation=t.sideOrientation),void 0!==t.isBlocker&&(a.isBlocker=t.isBlocker),a._shouldGenerateFlatShading=t.useFlatShading,t.freezeWorldMatrix&&(a._waitingData.freezeWorldMatrix=t.freezeWorldMatrix),void 0!==t.parentId&&(a._waitingParentId=t.parentId),void 0!==t.parentInstanceIndex&&(a._waitingParentInstanceIndex=t.parentInstanceIndex),void 0!==t.actions&&(a._waitingData.actions=t.actions),void 0!==t.overlayAlpha&&(a.overlayAlpha=t.overlayAlpha),void 0!==t.overlayColor&&(a.overlayColor=s.v9.FromArray(t.overlayColor)),void 0!==t.renderOverlay&&(a.renderOverlay=t.renderOverlay),a.isUnIndexed=!!t.isUnIndexed,a.hasVertexAlpha=t.hasVertexAlpha,t.delayLoadingFile?(a.delayLoadState=4,a.delayLoadingFile=D+t.delayLoadingFile,a.buildBoundingInfo(N.Pq.FromArray(t.boundingBoxMinimum),N.Pq.FromArray(t.boundingBoxMaximum)),t._binaryInfo&&(a._binaryInfo=t._binaryInfo),a._delayInfo=[],t.hasUVs&&a._delayInfo.push(R.R.UVKind),t.hasUVs2&&a._delayInfo.push(R.R.UV2Kind),t.hasUVs3&&a._delayInfo.push(R.R.UV3Kind),t.hasUVs4&&a._delayInfo.push(R.R.UV4Kind),t.hasUVs5&&a._delayInfo.push(R.R.UV5Kind),t.hasUVs6&&a._delayInfo.push(R.R.UV6Kind),t.hasColors&&a._delayInfo.push(R.R.ColorKind),t.hasMatricesIndices&&a._delayInfo.push(R.R.MatricesIndicesKind),t.hasMatricesWeights&&a._delayInfo.push(R.R.MatricesWeightsKind),a._delayLoadingFunction=O._ImportGeometry,L.B.ForceFullSceneLoadingForIncremental&&a._checkDelayState()):O._ImportGeometry(t,a),t.materialUniqueId?a._waitingMaterialId=t.materialUniqueId:t.materialId&&(a._waitingMaterialId=t.materialId),t.morphTargetManagerId>-1&&(a.morphTargetManager=K.getMorphTargetManagerById(t.morphTargetManagerId)),void 0!==t.skeletonId&&null!==t.skeletonId&&(a.skeleton=K.getLastSkeletonById(t.skeletonId),t.numBoneInfluencers&&(a.numBoneInfluencers=t.numBoneInfluencers)),t.animations){for(let K=0;K<t.animations.length;K++){const D=t.animations[K],G=J.n9("BABYLON.Animation");G&&a.animations.push(G.Parse(D))}n.b.ParseAnimationRanges(a,t,K)}if(t.autoAnimate&&K.beginAnimation(a,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,t.autoAnimateSpeed||1),t.layerMask&&!isNaN(t.layerMask)?a.layerMask=Math.abs(parseInt(t.layerMask)):a.layerMask=268435455,t.physicsImpostor&&(a.physicsImpostor=Nt._PhysicsImpostorParser(K,a,t)),t.lodMeshIds&&(a._waitingData.lods={ids:t.lodMeshIds,distances:t.lodDistances?t.lodDistances:null,coverages:t.lodCoverages?t.lodCoverages:null}),t.instances)for(let D=0;D<t.instances.length;D++){const G=t.instances[D],W=a.createInstance(G.name);if(G.id&&(W.id=G.id),c.Y&&(G.tags?c.Y.AddTagsTo(W,G.tags):c.Y.AddTagsTo(W,t.tags)),W.position=N.Pq.FromArray(G.position),void 0!==G.metadata&&(W.metadata=G.metadata),void 0!==G.parentId&&(W._waitingParentId=G.parentId),void 0!==G.parentInstanceIndex&&(W._waitingParentInstanceIndex=G.parentInstanceIndex),void 0!==G.isEnabled&&null!==G.isEnabled&&W.setEnabled(G.isEnabled),void 0!==G.isVisible&&null!==G.isVisible&&(W.isVisible=G.isVisible),void 0!==G.isPickable&&null!==G.isPickable&&(W.isPickable=G.isPickable),G.rotationQuaternion?W.rotationQuaternion=N.PT.FromArray(G.rotationQuaternion):G.rotation&&(W.rotation=N.Pq.FromArray(G.rotation)),W.scaling=N.Pq.FromArray(G.scaling),null!=G.checkCollisions&&null!=G.checkCollisions&&(W.checkCollisions=G.checkCollisions),null!=G.pickable&&null!=G.pickable&&(W.isPickable=G.pickable),null!=G.showBoundingBox&&null!=G.showBoundingBox&&(W.showBoundingBox=G.showBoundingBox),null!=G.showSubMeshesBoundingBox&&null!=G.showSubMeshesBoundingBox&&(W.showSubMeshesBoundingBox=G.showSubMeshesBoundingBox),null!=G.alphaIndex&&null!=G.showSubMeshesBoundingBox&&(W.alphaIndex=G.alphaIndex),G.physicsImpostor&&(W.physicsImpostor=Nt._PhysicsImpostorParser(K,W,G)),void 0!==G.actions&&(W._waitingData.actions=G.actions),G.animations){for(let t=0;t<G.animations.length;t++){const K=G.animations[t],D=J.n9("BABYLON.Animation");D&&W.animations.push(D.Parse(K))}n.b.ParseAnimationRanges(W,G,K),G.autoAnimate&&K.beginAnimation(W,G.autoAnimateFrom,G.autoAnimateTo,G.autoAnimateLoop,G.autoAnimateSpeed||1)}}if(t.thinInstances){const K=t.thinInstances;if(a.thinInstanceEnablePicking=!!K.enablePicking,K.matrixData?(a.thinInstanceSetBuffer("matrix",new Float32Array(K.matrixData),16,!1),a._thinInstanceDataStorage.matrixBufferSize=K.matrixBufferSize,a._thinInstanceDataStorage.instancesCount=K.instancesCount):a._thinInstanceDataStorage.matrixBufferSize=K.matrixBufferSize,t.thinInstances.userThinInstance){const K=t.thinInstances.userThinInstance;for(const t in K.data)a.thinInstanceSetBuffer(t,new Float32Array(K.data[t]),K.strides[t],!1),a._userThinInstanceBuffersStorage.sizes[t]=K.sizes[t]}}return a}setPositionsForCPUSkinning(){const t=this._internalMeshDataInfo;if(!t._sourcePositions){const K=this.getVerticesData(R.R.PositionKind);if(!K)return t._sourcePositions;t._sourcePositions=new Float32Array(K),this.isVertexBufferUpdatable(R.R.PositionKind)||this.setVerticesData(R.R.PositionKind,K,!0)}return t._sourcePositions}setNormalsForCPUSkinning(){const t=this._internalMeshDataInfo;if(!t._sourceNormals){const K=this.getVerticesData(R.R.NormalKind);if(!K)return t._sourceNormals;t._sourceNormals=new Float32Array(K),this.isVertexBufferUpdatable(R.R.NormalKind)||this.setVerticesData(R.R.NormalKind,K,!0)}return t._sourceNormals}applySkeleton(t){if(!this.geometry)return this;if(this.geometry._softwareSkinningFrameId==this.getScene().getFrameId())return this;if(this.geometry._softwareSkinningFrameId=this.getScene().getFrameId(),!this.isVerticesDataPresent(R.R.PositionKind))return this;if(!this.isVerticesDataPresent(R.R.MatricesIndicesKind))return this;if(!this.isVerticesDataPresent(R.R.MatricesWeightsKind))return this;const K=this.isVerticesDataPresent(R.R.NormalKind),D=this._internalMeshDataInfo;if(!D._sourcePositions){const t=this.subMeshes.slice();this.setPositionsForCPUSkinning(),this.subMeshes=t}K&&!D._sourceNormals&&this.setNormalsForCPUSkinning();let a=this.getVerticesData(R.R.PositionKind);if(!a)return this;a instanceof Float32Array||(a=new Float32Array(a));let G=this.getVerticesData(R.R.NormalKind);if(K){if(!G)return this;G instanceof Float32Array||(G=new Float32Array(G))}const W=this.getVerticesData(R.R.MatricesIndicesKind),x=this.getVerticesData(R.R.MatricesWeightsKind);if(!x||!W)return this;const b=this.numBoneInfluencers>4,n=b?this.getVerticesData(R.R.MatricesIndicesExtraKind):null,e=b?this.getVerticesData(R.R.MatricesWeightsExtraKind):null,i=t.getTransformMatrices(this),z=N.Pq.Zero(),I=new N.uq,Z=new N.uq;let w,m=0;for(let t=0;t<a.length;t+=3,m+=4){let u;for(w=0;w<4;w++)u=x[m+w],u>0&&(N.uq.FromFloat32ArrayToRefScaled(i,Math.floor(16*W[m+w]),u,Z),I.addToSelf(Z));if(b)for(w=0;w<4;w++)u=e[m+w],u>0&&(N.uq.FromFloat32ArrayToRefScaled(i,Math.floor(16*n[m+w]),u,Z),I.addToSelf(Z));N.Pq.TransformCoordinatesFromFloatsToRef(D._sourcePositions[t],D._sourcePositions[t+1],D._sourcePositions[t+2],I,z),z.toArray(a,t),K&&(N.Pq.TransformNormalFromFloatsToRef(D._sourceNormals[t],D._sourceNormals[t+1],D._sourceNormals[t+2],I,z),z.toArray(G,t)),I.reset()}return this.updateVerticesData(R.R.PositionKind,a),K&&this.updateVerticesData(R.R.NormalKind,G),this}static MinMax(t){let K=null,D=null;return t.forEach((function(t){const a=t.getBoundingInfo().boundingBox;K&&D?(K.minimizeInPlace(a.minimumWorld),D.maximizeInPlace(a.maximumWorld)):(K=a.minimumWorld,D=a.maximumWorld)})),K&&D?{min:K,max:D}:{min:N.Pq.Zero(),max:N.Pq.Zero()}}static Center(t){const K=t instanceof Array?Nt.MinMax(t):t;return N.Pq.Center(K.min,K.max)}static MergeMeshes(t,K=!0,D,a,G,N){return g.V1(Nt._MergeMeshesCoroutine(t,K,D,a,G,N,!1))}static MergeMeshesAsync(t,K=!0,D,a,G,N){return g.kj(Nt._MergeMeshesCoroutine(t,K,D,a,G,N,!0),g.VP())}static*_MergeMeshesCoroutine(t,K=!0,D,a,G,N,W){if(0===(t=t.filter(Boolean)).length)return null;let x;if(!D){let K=0;for(x=0;x<t.length;x++)if(K+=t[x].getTotalVertices(),K>=65536)return i.V.Warn("Cannot merge meshes because resulting mesh will have more than 65536 vertices. Please use allow32BitsIndices = true to use 32 bits indices"),null}N&&(G=!1);const b=new Array,n=new Array,e=new Array,z=t[0].sideOrientation;for(x=0;x<t.length;x++){const K=t[x];if(K.isAnInstance)return i.V.Warn("Cannot merge instance meshes."),null;if(z!==K.sideOrientation)return i.V.Warn("Cannot merge meshes with different sideOrientation values."),null;if(G&&e.push(K.getTotalIndices()),N)if(K.material){const t=K.material;if(t instanceof j){for(let K=0;K<t.subMaterials.length;K++)b.indexOf(t.subMaterials[K])<0&&b.push(t.subMaterials[K]);for(let D=0;D<K.subMeshes.length;D++)n.push(b.indexOf(t.subMaterials[K.subMeshes[D].materialIndex])),e.push(K.subMeshes[D].indexCount)}else{b.indexOf(t)<0&&b.push(t);for(let D=0;D<K.subMeshes.length;D++)n.push(b.indexOf(t)),e.push(K.subMeshes[D].indexCount)}}else for(let t=0;t<K.subMeshes.length;t++)n.push(0),e.push(K.subMeshes[t].indexCount)}const I=t[0],Z=t=>{const K=t.computeWorldMatrix(!0);return{vertexData:A.P.ExtractFromMesh(t,!1,!1),transform:K}},{vertexData:w,transform:m}=Z(I);W&&(yield);const u=new Array(t.length-1);for(let K=1;K<t.length;K++)u[K-1]=Z(t[K]),W&&(yield);const d=w._mergeCoroutine(m,u,D,W,!K);let E=d.next();for(;!E.done;)W&&(yield),E=d.next();const l=E.value;a||(a=new Nt(I.name+"_merged",I.getScene()));const Q=l._applyToCoroutine(a,void 0,W);let P=Q.next();for(;!P.done;)W&&(yield),P=Q.next();if(a.checkCollisions=I.checkCollisions,a.sideOrientation=I.sideOrientation,K)for(x=0;x<t.length;x++)t[x].dispose();if(G||N){a.releaseSubMeshes(),x=0;let t=0;for(;x<e.length;)Y.K.CreateFromIndices(0,t,e[x],a,void 0,!1),t+=e[x],x++;for(const t of a.subMeshes)t.refreshBoundingInfo();a.computeWorldMatrix(!0)}if(N){const t=new j(I.name+"_merged",I.getScene());t.subMaterials=b;for(let t=0;t<a.subMeshes.length;t++)a.subMeshes[t].materialIndex=n[t];a.material=t}else a.material=I.material;return a}addInstance(t){t._indexInSourceMeshInstanceArray=this.instances.length,this.instances.push(t)}removeInstance(t){const K=t._indexInSourceMeshInstanceArray;if(-1!=K){if(K!==this.instances.length-1){const t=this.instances[this.instances.length-1];this.instances[K]=t,t._indexInSourceMeshInstanceArray=K}t._indexInSourceMeshInstanceArray=-1,this.instances.pop()}}_shouldConvertRHS(){return this._scene.useRightHandedSystem&&this.sideOrientation===p.i.CounterClockWiseSideOrientation}_getRenderingFillMode(t){var K;const D=this.getScene();return D.forcePointsCloud?p.i.PointFillMode:D.forceWireframe?p.i.WireFrameFillMode:null!==(K=this.overrideRenderingFillMode)&&void 0!==K?K:t}setMaterialByID(t){return this.setMaterialById(t)}static CreateRibbon(t,K,D,a,G,N,W,x,b){throw new Error("Import MeshBuilder to populate this function")}static CreateDisc(t,K,D,a,G,N){throw new Error("Import MeshBuilder to populate this function")}static CreateBox(t,K,D,a,G){throw new Error("Import MeshBuilder to populate this function")}static CreateSphere(t,K,D,a,G,N){throw new Error("Import MeshBuilder to populate this function")}static CreateHemisphere(t,K,D,a){throw new Error("Import MeshBuilder to populate this function")}static CreateCylinder(t,K,D,a,G,N,W,x,b){throw new Error("Import MeshBuilder to populate this function")}static CreateTorus(t,K,D,a,G,N,W){throw new Error("Import MeshBuilder to populate this function")}static CreateTorusKnot(t,K,D,a,G,N,W,x,b,n){throw new Error("Import MeshBuilder to populate this function")}static CreateLines(t,K,D,a,G){throw new Error("Import MeshBuilder to populate this function")}static CreateDashedLines(t,K,D,a,G,N,W,x){throw new Error("Import MeshBuilder to populate this function")}static CreatePolygon(t,K,D,a,G,N,W){throw new Error("Import MeshBuilder to populate this function")}static ExtrudePolygon(t,K,D,a,G,N,W,x){throw new Error("Import MeshBuilder to populate this function")}static ExtrudeShape(t,K,D,a,G,N,W,x,b,n){throw new Error("Import MeshBuilder to populate this function")}static ExtrudeShapeCustom(t,K,D,a,G,N,W,x,b,n,e,i){throw new Error("Import MeshBuilder to populate this function")}static CreateLathe(t,K,D,a,G,N,W){throw new Error("Import MeshBuilder to populate this function")}static CreatePlane(t,K,D,a,G){throw new Error("Import MeshBuilder to populate this function")}static CreateGround(t,K,D,a,G,N){throw new Error("Import MeshBuilder to populate this function")}static CreateTiledGround(t,K,D,a,G,N,W,x,b){throw new Error("Import MeshBuilder to populate this function")}static CreateGroundFromHeightMap(t,K,D,a,G,N,W,x,b,n,e){throw new Error("Import MeshBuilder to populate this function")}static CreateTube(t,K,D,a,G,N,W,x,b,n){throw new Error("Import MeshBuilder to populate this function")}static CreatePolyhedron(t,K,D){throw new Error("Import MeshBuilder to populate this function")}static CreateIcoSphere(t,K,D){throw new Error("Import MeshBuilder to populate this function")}static CreateDecal(t,K,D,a,G,N){throw new Error("Import MeshBuilder to populate this function")}static CreateCapsule(t,K,D){throw new Error("Import MeshBuilder to populate this function")}static ExtendToGoldberg(t){throw new Error("Import MeshBuilder to populate this function")}}Nt.FRONTSIDE=A.P.FRONTSIDE,Nt.BACKSIDE=A.P.BACKSIDE,Nt.DOUBLESIDE=A.P.DOUBLESIDE,Nt.DEFAULTSIDE=A.P.DEFAULTSIDE,Nt.NO_CAP=0,Nt.CAP_START=1,Nt.CAP_END=2,Nt.CAP_ALL=3,Nt.NO_FLIP=0,Nt.FLIP_TILE=1,Nt.ROTATE_TILE=2,Nt.FLIP_ROW=3,Nt.ROTATE_ROW=4,Nt.FLIP_N_ROTATE_TILE=5,Nt.FLIP_N_ROTATE_ROW=6,Nt.CENTER=0,Nt.LEFT=1,Nt.RIGHT=2,Nt.TOP=3,Nt.BOTTOM=4,Nt.INSTANCEDMESH_SORT_TRANSPARENT=!1,Nt._GroundMeshParser=(t,K)=>{throw r.n("GroundMesh")},Nt._GoldbergMeshParser=(t,K)=>{throw r.n("GoldbergMesh")},Nt._LinesMeshParser=(t,K)=>{throw r.n("LinesMesh")},Nt._GreasedLineMeshParser=(t,K)=>{throw r.n("GreasedLineMesh")},Nt._GreasedLineRibbonMeshParser=(t,K)=>{throw r.n("GreasedLineRibbonMesh")},Nt._TrailMeshParser=(t,K)=>{throw r.n("TrailMesh")},J.Y5("BABYLON.Mesh",Nt);var Wt=D(633727),xt=D(194373),bt=(D(757634),D(109050),D(499251)),nt=D(182453),et=D(562756),it=D(615473),zt=D(684911);bt.w.prototype.createPrefilteredCubeTexture=function(t,K,D,a,G=null,N=null,W,x=null,b=!0){return this.createCubeTexture(t,K,null,!1,(t=>{if(!t)return void(G&&G(null));const N=t.texture;if(b?t.info.sphericalPolynomial&&(N._sphericalPolynomial=t.info.sphericalPolynomial):N._sphericalPolynomial=new et.Q,N._source=9,this.getCaps().textureLOD)return void(G&&G(N));const W=3,x=this._gl,n=t.width;if(!n)return;const e=[];for(let G=0;G<W;G++){const b=1-G/(W-1),z=a,I=it.X.Log2(n)*D+a,Z=z+(I-z)*b,w=Math.round(Math.min(Math.max(Z,0),I)),m=new nt.h(this,2);if(m.type=N.type,m.format=N.format,m.width=Math.pow(2,Math.max(it.X.Log2(n)-w,0)),m.height=m.width,m.isCube=!0,m._cachedWrapU=0,m._cachedWrapV=0,this._bindTextureDirectly(x.TEXTURE_CUBE_MAP,m,!0),m.samplingMode=2,x.texParameteri(x.TEXTURE_CUBE_MAP,x.TEXTURE_MAG_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_CUBE_MAP,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_CUBE_MAP,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_CUBE_MAP,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),t.isDDS){const K=t.info,D=t.data;this._unpackFlipY(K.isCompressed),zt.D.UploadDDSLevels(this,m,D,K,!0,6,w)}else i.V.Warn("DDS is the only prefiltered cube map supported so far.");this._bindTextureDirectly(x.TEXTURE_CUBE_MAP,null);const u=new xt.t(K);u._isCube=!0,u._texture=m,m.isReady=!0,e.push(u)}N._lodTextureHigh=e[2],N._lodTextureMid=e[1],N._lodTextureLow=e[0],G&&G(N)}),N,W,x,b,D,a)};const It=.8;class Zt extends xt.t{set boundingBoxSize(t){if(this._boundingBoxSize&&this._boundingBoxSize.equals(t))return;this._boundingBoxSize=t;const K=this.getScene();K&&K.markAllMaterialsAsDirty(1)}get boundingBoxSize(){return this._boundingBoxSize}set rotationY(t){this._rotationY=t,this.setReflectionTextureMatrix(N.uq.RotationY(this._rotationY))}get rotationY(){return this._rotationY}get noMipmap(){return this._noMipmap}get forcedExtension(){return this._forcedExtension}static CreateFromImages(t,K,D){let a="";return t.forEach((t=>a+=t)),new Zt(a,K,null,D,t)}static CreateFromPrefilteredData(t,K,D=null,a=!0){const G=K.useDelayedTextureLoading;K.useDelayedTextureLoading=!1;const N=new Zt(t,K,null,!1,null,null,null,void 0,!0,D,a);return K.useDelayedTextureLoading=G,N}constructor(t,K,D=null,a=!1,G=null,W=null,x=null,b=5,n=!1,e=null,i=!1,z=It,I=0,Z,w){var m,u,E,l,Q,P,y,q,X,h,J,T,_;super(K),this.onLoadObservable=new d.cP,this.boundingBoxPosition=N.Pq.Zero(),this._rotationY=0,this._files=null,this._forcedExtension=null,this._extensions=null,this._textureMatrixRefraction=new N.uq,this._buffer=null,this.name=t,this.url=t,this._noMipmap=a,this.hasAlpha=!1,this.isCube=!0,this._textureMatrix=N.uq.Identity(),this.coordinatesMode=U.g.CUBIC_MODE;let C=null,H=null;null===D||Array.isArray(D)?(this._noMipmap=a,this._format=b,this._createPolynomials=i,C=D,this._loaderOptions=Z,this._useSRGBBuffer=w,this._lodScale=z,this._lodOffset=I):(C=null!==(m=D.extensions)&&void 0!==m?m:null,this._noMipmap=null!==(u=D.noMipmap)&&void 0!==u&&u,G=null!==(E=D.files)&&void 0!==E?E:null,H=null!==(l=D.buffer)&&void 0!==l?l:null,this._format=null!==(Q=D.format)&&void 0!==Q?Q:5,n=null!==(P=D.prefiltered)&&void 0!==P&&P,e=null!==(y=D.forcedExtension)&&void 0!==y?y:null,this._createPolynomials=null!==(q=D.createPolynomials)&&void 0!==q&&q,this._lodScale=null!==(X=D.lodScale)&&void 0!==X?X:It,this._lodOffset=null!==(h=D.lodOffset)&&void 0!==h?h:0,this._loaderOptions=D.loaderOptions,this._useSRGBBuffer=D.useSRGBBuffer,W=null!==(J=D.onLoad)&&void 0!==J?J:null,x=null!==(T=D.onError)&&void 0!==T?T:null),(t||G)&&this.updateURL(t,e,W,n,x,C,null===(_=this.getScene())||void 0===_?void 0:_.useDelayedTextureLoading,G,H)}getClassName(){return"CubeTexture"}updateURL(t,K=null,D=null,a=!1,G=null,N=null,W=!1,x=null,b=null){this.name&&!this.name.startsWith("data:")||(this.name=t),this.url=t,K&&(this._forcedExtension=K);const n=t.lastIndexOf("."),e=K||(n>-1?t.substring(n).toLowerCase():""),i=0===e.indexOf(".dds"),z=0===e.indexOf(".env"),I=0===e.indexOf(".basis");if(z?(this.gammaSpace=!1,this._prefiltered=!1,this.anisotropicFilteringLevel=1):(this._prefiltered=a,a&&(this.gammaSpace=!1,this.anisotropicFilteringLevel=1)),x)this._files=x;else if(I||z||i||N||(N=["_px.jpg","_py.jpg","_pz.jpg","_nx.jpg","_ny.jpg","_nz.jpg"]),this._files=this._files||[],this._files.length=0,N){for(let K=0;K<N.length;K++)this._files.push(t+N[K]);this._extensions=N}this._buffer=b,W?(this.delayLoadState=4,this._delayedOnLoad=D,this._delayedOnError=G):this._loadTexture(D,G)}delayLoad(t){4===this.delayLoadState&&(t&&(this._forcedExtension=t),this.delayLoadState=1,this._loadTexture(this._delayedOnLoad,this._delayedOnError))}getReflectionTextureMatrix(){return this._textureMatrix}setReflectionTextureMatrix(t){var K,D;if(t.updateFlag===this._textureMatrix.updateFlag)return;if(t.isIdentity()!==this._textureMatrix.isIdentity()&&(null===(K=this.getScene())||void 0===K||K.markAllMaterialsAsDirty(1,(t=>-1!==t.getActiveTextures().indexOf(this)))),this._textureMatrix=t,!(null===(D=this.getScene())||void 0===D?void 0:D.useRightHandedSystem))return;const a=N.AA.Vector3[0],G=N.AA.Quaternion[0],W=N.AA.Vector3[1];this._textureMatrix.decompose(a,G,W),G.z*=-1,G.w*=-1,N.uq.ComposeToRef(a,G,W,this._textureMatrixRefraction)}getRefractionTextureMatrix(){var t;return(null===(t=this.getScene())||void 0===t?void 0:t.useRightHandedSystem)?this._textureMatrixRefraction:this._textureMatrix}_loadTexture(t=null,K=null){var D;const a=this.getScene(),G=this._texture;this._texture=this._getFromCache(this.url,this._noMipmap,void 0,void 0,this._useSRGBBuffer,this.isCube);const N=()=>{var K;this.onLoadObservable.notifyObservers(this),G&&(G.dispose(),null===(K=this.getScene())||void 0===K||K.markAllMaterialsAsDirty(1)),t&&t()},W=(t,D)=>{this._loadingError=!0,this._errorObject={message:t,exception:D},K&&K(t,D),U.g.OnTextureLoadErrorObservable.notifyObservers(this)};this._texture?this._texture.isReady?m.S0.SetImmediate((()=>N())):this._texture.onLoadedObservable.add((()=>N())):(this._prefiltered?this._texture=this._getEngine().createPrefilteredCubeTexture(this.url,a,this._lodScale,this._lodOffset,t,W,this._format,this._forcedExtension,this._createPolynomials):this._texture=this._getEngine().createCubeTexture(this.url,a,this._files,this._noMipmap,t,W,this._format,this._forcedExtension,!1,this._lodScale,this._lodOffset,null,this._loaderOptions,!!this._useSRGBBuffer,this._buffer),null===(D=this._texture)||void 0===D||D.onLoadedObservable.add((()=>this.onLoadObservable.notifyObservers(this))))}static Parse(t,K,D){const a=z.p.Parse((()=>{var a;let G=!1;return t.prefiltered&&(G=t.prefiltered),new Zt(D+(null!==(a=t.url)&&void 0!==a?a:t.name),K,t.extensions,!1,t.files||null,null,null,void 0,G,t.forcedExtension)}),t,K);if(t.boundingBoxPosition&&(a.boundingBoxPosition=N.Pq.FromArray(t.boundingBoxPosition)),t.boundingBoxSize&&(a.boundingBoxSize=N.Pq.FromArray(t.boundingBoxSize)),t.animations)for(let K=0;K<t.animations.length;K++){const D=t.animations[K],G=J.n9("BABYLON.Animation");G&&a.animations.push(G.Parse(D))}return a}clone(){let t=0;const K=z.p.Clone((()=>{const K=new Zt(this.url,this.getScene()||this._getEngine(),this._extensions,this._noMipmap,this._files);return t=K.uniqueId,K}),this);return K.uniqueId=t,K}}a.Cg([G.lK()],Zt.prototype,"url",void 0),a.Cg([G.P_()],Zt.prototype,"boundingBoxPosition",void 0),a.Cg([G.P_()],Zt.prototype,"boundingBoxSize",null),a.Cg([G.lK("rotationY")],Zt.prototype,"rotationY",null),a.Cg([G.lK("files")],Zt.prototype,"_files",void 0),a.Cg([G.lK("forcedExtension")],Zt.prototype,"_forcedExtension",void 0),a.Cg([G.lK("extensions")],Zt.prototype,"_extensions",void 0),a.Cg([G.GG("textureMatrix")],Zt.prototype,"_textureMatrix",void 0),a.Cg([G.GG("textureMatrixRefraction")],Zt.prototype,"_textureMatrixRefraction",void 0),U.g._CubeTextureParser=Zt.Parse,J.Y5("BABYLON.CubeTexture",Zt);var wt=D(843019),mt=D(906264),ut=D(948733),dt=D(101032),Et=(D(240396),D(395879));const lt=`attribute vec2 position;varying vec3 direction;uniform vec3 up;uniform vec3 right;uniform vec3 front;\n#define CUSTOM_VERTEX_DEFINITIONS\nvoid main(void) {\n#define CUSTOM_VERTEX_MAIN_BEGIN\nmat3 view=mat3(up,right,front);direction=view*vec3(position,1.0);gl_Position=vec4(position,0.0,1.0);\n#define CUSTOM_VERTEX_MAIN_END\n}`;Et.l.ShadersStore["hdrFilteringVertexShader"]=lt,D(485914),D(368668),D(950544),D(489974);const Qt=`#include<helperFunctions>\n#include<importanceSampling>\n#include<pbrBRDFFunctions>\n#include<hdrFilteringFunctions>\nuniform float alphaG;uniform samplerCube inputTexture;uniform vec2 vFilteringInfo;uniform float hdrScale;varying vec3 direction;void main() {vec3 color=radiance(alphaG,inputTexture,direction,vFilteringInfo);gl_FragColor=vec4(color*hdrScale,1.0);}`;Et.l.ShadersStore["hdrFilteringPixelShader"]=Qt;class Pt{constructor(t,K={}){this._lodGenerationOffset=0,this._lodGenerationScale=.8,this.quality=4096,this.hdrScale=1,this._engine=t,this.hdrScale=K.hdrScale||this.hdrScale,this.quality=K.quality||this.quality}_createRenderTarget(t){let K=0;this._engine.getCaps().textureHalfFloatRender?K=2:this._engine.getCaps().textureFloatRender&&(K=1);const D=this._engine.createRenderTargetCubeTexture(t,{format:5,type:K,createMipMaps:!0,generateMipMaps:!1,generateDepthBuffer:!1,generateStencilBuffer:!1,samplingMode:1});return this._engine.updateTextureWrappingMode(D.texture,0,0,0),this._engine.updateTextureSamplingMode(3,D.texture,!0),D}_prefilterInternal(t){const K=t.getSize().width,D=it.X.ILog2(K)+1,a=this._effectWrapper.effect,G=this._createRenderTarget(K);this._effectRenderer.saveStates(),this._effectRenderer.setViewport();const N=t.getInternalTexture();N&&this._engine.updateTextureSamplingMode(3,N,!0),this._effectRenderer.applyEffectWrapper(this._effectWrapper);const W=[[new ut.Pq(0,0,-1),new ut.Pq(0,-1,0),new ut.Pq(1,0,0)],[new ut.Pq(0,0,1),new ut.Pq(0,-1,0),new ut.Pq(-1,0,0)],[new ut.Pq(1,0,0),new ut.Pq(0,0,1),new ut.Pq(0,1,0)],[new ut.Pq(1,0,0),new ut.Pq(0,0,-1),new ut.Pq(0,-1,0)],[new ut.Pq(1,0,0),new ut.Pq(0,-1,0),new ut.Pq(0,0,1)],[new ut.Pq(-1,0,0),new ut.Pq(0,-1,0),new ut.Pq(0,0,-1)]];a.setFloat("hdrScale",this.hdrScale),a.setFloat2("vFilteringInfo",t.getSize().width,D),a.setTexture("inputTexture",t);for(let t=0;t<6;t++){a.setVector3("up",W[t][0]),a.setVector3("right",W[t][1]),a.setVector3("front",W[t][2]);for(let N=0;N<D;N++){this._engine.bindFramebuffer(G,t,void 0,void 0,!0,N),this._effectRenderer.applyEffectWrapper(this._effectWrapper);let D=Math.pow(2,(N-this._lodGenerationOffset)/this._lodGenerationScale)/K;0===N&&(D=0),a.setFloat("alphaG",D),this._effectRenderer.draw()}}this._effectRenderer.restoreStates(),this._engine.restoreDefaultFramebuffer(),this._engine._releaseTexture(t._texture);const x=G.texture.type,b=G.texture.format;return G._swapAndDie(t._texture),t._texture.type=x,t._texture.format=b,t.gammaSpace=!1,t.lodGenerationOffset=this._lodGenerationOffset,t.lodGenerationScale=this._lodGenerationScale,t._prefiltered=!0,t}_createEffect(t,K){const D=[];return t.gammaSpace&&D.push("#define GAMMA_INPUT"),D.push("#define NUM_SAMPLES "+this.quality+"u"),new dt.$({engine:this._engine,name:"hdrFiltering",vertexShader:"hdrFiltering",fragmentShader:"hdrFiltering",samplerNames:["inputTexture"],uniformNames:["vSampleDirections","vWeights","up","right","front","vFilteringInfo","hdrScale","alphaG"],useShaderStore:!0,defines:D,onCompiled:K})}isReady(t){return t.isReady()&&this._effectWrapper.effect.isReady()}prefilter(t,K=null){return this._engine._features.allowTexturePrefiltering?new Promise((D=>{this._effectRenderer=new dt.J(this._engine),this._effectWrapper=this._createEffect(t),this._effectWrapper.effect.executeWhenCompiled((()=>{this._prefilterInternal(t),this._effectRenderer.dispose(),this._effectWrapper.dispose(),D(),K&&K()}))})):(i.V.Warn("HDR prefiltering is not available in WebGL 1., you can use real time filtering instead."),Promise.reject("HDR prefiltering is not available in WebGL 1., you can use real time filtering instead."))}}var yt=D(484573),qt=D(104270);function Xt(t,K,D,a){let G,N=1;1===a?G=new Float32Array(K*D*4):2===a?(G=new Uint16Array(K*D*4),N=15360):G=7===a?new Uint32Array(K*D*4):new Uint8Array(K*D*4);for(let a=0;a<K;a++)for(let W=0;W<D;W++){const D=3*(W*K+a),x=4*(W*K+a);G[x+0]=t[D+0],G[x+1]=t[D+1],G[x+2]=t[D+2],G[x+3]=N}return G}function ht(t){return function(K,D,a,G,N,W,x,b,n=null,e=0){const i=t?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D_ARRAY,z=t?10:11,I=new nt.h(this,z);I.baseWidth=D,I.baseHeight=a,I.baseDepth=G,I.width=D,I.height=a,I.depth=G,I.format=N,I.type=e,I.generateMipMaps=W,I.samplingMode=b,t?I.is3D=!0:I.is2DArray=!0,this._doNotHandleContextLost||(I._bufferView=K),t?this.updateRawTexture3D(I,K,N,x,n,e):this.updateRawTexture2DArray(I,K,N,x,n,e),this._bindTextureDirectly(i,I,!0);const Z=this._getSamplingParameters(b,W);return this._gl.texParameteri(i,this._gl.TEXTURE_MAG_FILTER,Z.mag),this._gl.texParameteri(i,this._gl.TEXTURE_MIN_FILTER,Z.min),W&&this._gl.generateMipmap(i),this._bindTextureDirectly(i,null),this._internalTexturesCache.push(I),I}}function Jt(t){return function(K,D,a,G,N=null,W=0){const x=t?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D_ARRAY,b=this._getWebGLTextureType(W),n=this._getInternalFormat(a),e=this._getRGBABufferInternalSizedFormat(W,a);this._bindTextureDirectly(x,K,!0),this._unpackFlipY(void 0===G||!!G),this._doNotHandleContextLost||(K._bufferView=D,K.format=a,K.invertY=G,K._compression=N),K.width%4!=0&&this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,1),N&&D?this._gl.compressedTexImage3D(x,0,this.getCaps().s3tc[N],K.width,K.height,K.depth,0,D):this._gl.texImage3D(x,0,e,K.width,K.height,K.depth,0,n,b,D),K.generateMipMaps&&this._gl.generateMipmap(x),this._bindTextureDirectly(x,null),K.isReady=!0}}bt.w.prototype.updateRawTexture=function(t,K,D,a,G=null,N=0,W=!1){if(!t)return;const x=this._getRGBABufferInternalSizedFormat(N,D,W),b=this._getInternalFormat(D),n=this._getWebGLTextureType(N);this._bindTextureDirectly(this._gl.TEXTURE_2D,t,!0),this._unpackFlipY(void 0===a||!!a),this._doNotHandleContextLost||(t._bufferView=K,t.format=D,t.type=N,t.invertY=a,t._compression=G),t.width%4!=0&&this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,1),G&&K?this._gl.compressedTexImage2D(this._gl.TEXTURE_2D,0,this.getCaps().s3tc[G],t.width,t.height,0,K):this._gl.texImage2D(this._gl.TEXTURE_2D,0,x,t.width,t.height,0,b,n,K),t.generateMipMaps&&this._gl.generateMipmap(this._gl.TEXTURE_2D),this._bindTextureDirectly(this._gl.TEXTURE_2D,null),t.isReady=!0},bt.w.prototype.createRawTexture=function(t,K,D,a,G,N,W,x=null,b=0,n=0,e=!1){const i=new nt.h(this,3);i.baseWidth=K,i.baseHeight=D,i.width=K,i.height=D,i.format=a,i.generateMipMaps=G,i.samplingMode=W,i.invertY=N,i._compression=x,i.type=b,i._useSRGBBuffer=this._getUseSRGBBuffer(e,!G),this._doNotHandleContextLost||(i._bufferView=t),this.updateRawTexture(i,t,a,N,x,b,i._useSRGBBuffer),this._bindTextureDirectly(this._gl.TEXTURE_2D,i,!0);const z=this._getSamplingParameters(W,G);return this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,z.mag),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,z.min),G&&this._gl.generateMipmap(this._gl.TEXTURE_2D),this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._internalTexturesCache.push(i),i},bt.w.prototype.createRawCubeTexture=function(t,K,D,a,G,N,W,x=null){const b=this._gl,n=new nt.h(this,8);n.isCube=!0,n.format=D,n.type=a,this._doNotHandleContextLost||(n._bufferViewArray=t);const e=this._getWebGLTextureType(a);let z=this._getInternalFormat(D);z===b.RGB&&(z=b.RGBA),e!==b.FLOAT||this._caps.textureFloatLinearFiltering?e!==this._gl.HALF_FLOAT_OES||this._caps.textureHalfFloatLinearFiltering?e!==b.FLOAT||this._caps.textureFloatRender?e!==b.HALF_FLOAT||this._caps.colorBufferFloat||(G=!1,i.V.Warn("Render to half float textures is not supported. Mipmap generation forced to false.")):(G=!1,i.V.Warn("Render to float textures is not supported. Mipmap generation forced to false.")):(G=!1,W=1,i.V.Warn("Half float texture filtering is not supported. Mipmap generation and sampling mode are forced to false and TEXTURE_NEAREST_SAMPLINGMODE, respectively.")):(G=!1,W=1,i.V.Warn("Float texture filtering is not supported. Mipmap generation and sampling mode are forced to false and TEXTURE_NEAREST_SAMPLINGMODE, respectively."));const I=K,Z=I;if(n.width=I,n.height=Z,n.invertY=N,n._compression=x,!this.needPOTTextures||qt.L8(n.width)&&qt.L8(n.height)||(G=!1),t)this.updateRawCubeTexture(n,t,D,a,N,x);else{const t=this._getRGBABufferInternalSizedFormat(a),K=0;this._bindTextureDirectly(b.TEXTURE_CUBE_MAP,n,!0);for(let D=0;D<6;D++)x?b.compressedTexImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+D,K,this.getCaps().s3tc[x],n.width,n.height,0,void 0):b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+D,K,t,n.width,n.height,0,z,e,null);this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null)}this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,n,!0),t&&G&&this._gl.generateMipmap(this._gl.TEXTURE_CUBE_MAP);const w=this._getSamplingParameters(W,G);return b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_MAG_FILTER,w.mag),b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_MIN_FILTER,w.min),b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),this._bindTextureDirectly(b.TEXTURE_CUBE_MAP,null),n.generateMipMaps=G,n.samplingMode=W,n.isReady=!0,n},bt.w.prototype.updateRawCubeTexture=function(t,K,D,a,G,N=null,W=0){t._bufferViewArray=K,t.format=D,t.type=a,t.invertY=G,t._compression=N;const x=this._gl,b=this._getWebGLTextureType(a);let n=this._getInternalFormat(D);const e=this._getRGBABufferInternalSizedFormat(a);let i=!1;n===x.RGB&&(n=x.RGBA,i=!0),this._bindTextureDirectly(x.TEXTURE_CUBE_MAP,t,!0),this._unpackFlipY(void 0===G||!!G),t.width%4!=0&&x.pixelStorei(x.UNPACK_ALIGNMENT,1);for(let D=0;D<6;D++){let G=K[D];N?x.compressedTexImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+D,W,this.getCaps().s3tc[N],t.width,t.height,0,G):(i&&(G=Xt(G,t.width,t.height,a)),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+D,W,e,t.width,t.height,0,n,b,G))}(!this.needPOTTextures||qt.L8(t.width)&&qt.L8(t.height))&&t.generateMipMaps&&0===W&&this._gl.generateMipmap(this._gl.TEXTURE_CUBE_MAP),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),t.isReady=!0},bt.w.prototype.createRawCubeTextureFromUrl=function(t,K,D,a,G,N,W,x,b=null,n=null,e=3,i=!1){const z=this._gl,I=this.createRawCubeTexture(null,D,a,G,!N,i,e,null);null==K||K.addPendingData(I),I.url=t,I.isReady=!1,this._internalTexturesCache.push(I);const Z=t=>{const D=I.width,N=W(t);if(N){if(x){const t=this._getWebGLTextureType(G);let K=this._getInternalFormat(a);const W=this._getRGBABufferInternalSizedFormat(G);let b=!1;K===z.RGB&&(K=z.RGBA,b=!0),this._bindTextureDirectly(z.TEXTURE_CUBE_MAP,I,!0),this._unpackFlipY(!1);const n=x(N);for(let a=0;a<n.length;a++){const N=D>>a;for(let D=0;D<6;D++){let x=n[a][D];b&&(x=Xt(x,N,N,G)),z.texImage2D(D,a,W,N,N,0,K,t,x)}}this._bindTextureDirectly(z.TEXTURE_CUBE_MAP,null)}else this.updateRawCubeTexture(I,N,a,G,i);I.isReady=!0,null==K||K.removePendingData(I),I.onLoadedObservable.notifyObservers(I),I.onLoadedObservable.clear(),b&&b()}};return this._loadFile(t,(t=>{Z(t)}),void 0,null==K?void 0:K.offlineProvider,!0,((t,D)=>{null==K||K.removePendingData(I),n&&t&&n(t.status+" "+t.statusText,D)})),I},bt.w.prototype.createRawTexture2DArray=ht(!1),bt.w.prototype.createRawTexture3D=ht(!0),bt.w.prototype.updateRawTexture2DArray=Jt(!1),bt.w.prototype.updateRawTexture3D=Jt(!0),D(587053);class Tt extends xt.t{set isBlocking(t){this._isBlocking=t}get isBlocking(){return this._isBlocking}set rotationY(t){this._rotationY=t,this.setReflectionTextureMatrix(N.uq.RotationY(this._rotationY))}get rotationY(){return this._rotationY}set boundingBoxSize(t){if(this._boundingBoxSize&&this._boundingBoxSize.equals(t))return;this._boundingBoxSize=t;const K=this.getScene();K&&K.markAllMaterialsAsDirty(1)}get boundingBoxSize(){return this._boundingBoxSize}constructor(t,K,D,a=!1,G=!0,W=!1,x=!1,b=null,n=null,e=!1){var i;super(K),this._generateHarmonics=!0,this._onError=null,this._isBlocking=!0,this._rotationY=0,this.boundingBoxPosition=N.Pq.Zero(),this.onLoadObservable=new d.cP,t&&(this._coordinatesMode=U.g.CUBIC_MODE,this.name=t,this.url=t,this.hasAlpha=!1,this.isCube=!0,this._textureMatrix=N.uq.Identity(),this._prefilterOnLoad=x,this._onLoad=()=>{this.onLoadObservable.notifyObservers(this),b&&b()},this._onError=n,this.gammaSpace=W,this._noMipmap=a,this._size=D,this._supersample=e,this._generateHarmonics=G,this._texture=this._getFromCache(t,this._noMipmap,void 0,void 0,void 0,this.isCube),this._texture?this._texture.isReady?m.S0.SetImmediate((()=>this._onLoad())):this._texture.onLoadedObservable.add(this._onLoad):(null===(i=this.getScene())||void 0===i?void 0:i.useDelayedTextureLoading)?this.delayLoadState=4:this._loadTexture())}getClassName(){return"HDRCubeTexture"}_loadTexture(){const t=this._getEngine(),K=t.getCaps();let D=0;if(K.textureFloat&&K.textureFloatLinearFiltering?D=1:K.textureHalfFloat&&K.textureHalfFloatLinearFiltering&&(D=2),t._features.allowTexturePrefiltering&&this._prefilterOnLoad){const K=this._onLoad,D=new Pt(t);this._onLoad=()=>{D.prefilter(this,K)}}this._texture=t.createRawCubeTextureFromUrl(this.url,this.getScene(),this._size,4,D,this._noMipmap,(t=>{this.lodGenerationOffset=0,this.lodGenerationScale=.8;const K=wt.VH(t,this._size,this._supersample);if(this._generateHarmonics){const t=mt.d.ConvertCubeMapToSphericalPolynomial(K);this.sphericalPolynomial=t}const a=[];let G=null,N=null;for(let t=0;t<6;t++){2===D?N=new Uint16Array(this._size*this._size*3):0===D&&(G=new Uint8Array(this._size*this._size*3));const W=K[Tt._FacesMapping[t]];if(this.gammaSpace||N||G)for(let t=0;t<this._size*this._size;t++)if(this.gammaSpace&&(W[3*t+0]=Math.pow(W[3*t+0],x.rv),W[3*t+1]=Math.pow(W[3*t+1],x.rv),W[3*t+2]=Math.pow(W[3*t+2],x.rv)),N&&(N[3*t+0]=yt.LZ(W[3*t+0]),N[3*t+1]=yt.LZ(W[3*t+1]),N[3*t+2]=yt.LZ(W[3*t+2])),G){let K=Math.max(255*W[3*t+0],0),D=Math.max(255*W[3*t+1],0),a=Math.max(255*W[3*t+2],0);const N=Math.max(Math.max(K,D),a);if(N>255){const t=255/N;K*=t,D*=t,a*=t}G[3*t+0]=K,G[3*t+1]=D,G[3*t+2]=a}N?a.push(N):G?a.push(G):a.push(W)}return a}),null,this._onLoad,this._onError)}clone(){const t=new Tt(this.url,this.getScene()||this._getEngine(),this._size,this._noMipmap,this._generateHarmonics,this.gammaSpace);return t.level=this.level,t.wrapU=this.wrapU,t.wrapV=this.wrapV,t.coordinatesIndex=this.coordinatesIndex,t.coordinatesMode=this.coordinatesMode,t}delayLoad(){4===this.delayLoadState&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap),this._texture||this._loadTexture())}getReflectionTextureMatrix(){return this._textureMatrix}setReflectionTextureMatrix(t){var K;this._textureMatrix=t,t.updateFlag!==this._textureMatrix.updateFlag&&t.isIdentity()!==this._textureMatrix.isIdentity()&&(null===(K=this.getScene())||void 0===K||K.markAllMaterialsAsDirty(1,(t=>-1!==t.getActiveTextures().indexOf(this))))}dispose(){this.onLoadObservable.clear(),super.dispose()}static Parse(t,K,D){let a=null;return t.name&&!t.isRenderTarget&&(a=new Tt(D+t.name,K,t.size,t.noMipmap,t.generateHarmonics,t.useInGammaSpace),a.name=t.name,a.hasAlpha=t.hasAlpha,a.level=t.level,a.coordinatesMode=t.coordinatesMode,a.isBlocking=t.isBlocking),a&&(t.boundingBoxPosition&&(a.boundingBoxPosition=N.Pq.FromArray(t.boundingBoxPosition)),t.boundingBoxSize&&(a.boundingBoxSize=N.Pq.FromArray(t.boundingBoxSize)),t.rotationY&&(a.rotationY=t.rotationY)),a}serialize(){if(!this.name)return null;const t={};return t.name=this.name,t.hasAlpha=this.hasAlpha,t.isCube=!0,t.level=this.level,t.size=this._size,t.coordinatesMode=this.coordinatesMode,t.useInGammaSpace=this.gammaSpace,t.generateHarmonics=this._generateHarmonics,t.customType="BABYLON.HDRCubeTexture",t.noMipmap=this._noMipmap,t.isBlocking=this._isBlocking,t.rotationY=this._rotationY,t}}Tt._FacesMapping=["right","left","up","down","front","back"],J.Y5("BABYLON.HDRCubeTexture",Tt);class _t{constructor(t,K,D){this.name=t,this.from=K,this.to=D}clone(){return new _t(this.name,this.from,this.to)}}var Ct=D(500556),Ht=D(732259);const ot=Object.freeze(new N.PT(0,0,0,0)),Ut=Object.freeze(N.Pq.Zero()),Vt=Object.freeze(N.I9.Zero()),st=Object.freeze(Ct.o.Zero()),Ft=Object.freeze(s.v9.Black()),ct=Object.freeze(new s.ov(0,0,0,0)),gt={key:0,repeatCount:0,loopMode:2};class Rt{static _PrepareAnimation(t,K,D,a,G,W,x,b){let n;if(!isNaN(parseFloat(G))&&isFinite(G)?n=Rt.ANIMATIONTYPE_FLOAT:G instanceof N.PT?n=Rt.ANIMATIONTYPE_QUATERNION:G instanceof N.Pq?n=Rt.ANIMATIONTYPE_VECTOR3:G instanceof N.I9?n=Rt.ANIMATIONTYPE_VECTOR2:G instanceof s.v9?n=Rt.ANIMATIONTYPE_COLOR3:G instanceof s.ov?n=Rt.ANIMATIONTYPE_COLOR4:G instanceof Ct.o&&(n=Rt.ANIMATIONTYPE_SIZE),null==n)return null;const e=new Rt(t,K,D,n,x),i=[{frame:0,value:G},{frame:a,value:W}];return e.setKeys(i),void 0!==b&&e.setEasingFunction(b),e}static CreateAnimation(t,K,D,a){const G=new Rt(t+"Animation",t,D,K,Rt.ANIMATIONLOOPMODE_CONSTANT);return G.setEasingFunction(a),G}static CreateAndStartAnimation(t,K,D,a,G,N,W,x,b,n,e){const i=Rt._PrepareAnimation(t,D,a,G,N,W,x,b);return i?(K.getScene&&(e=K.getScene()),e?e.beginDirectAnimation(K,[i],0,G,1===i.loopMode,1,n):null):null}static CreateAndStartHierarchyAnimation(t,K,D,a,G,N,W,x,b,n,e){const i=Rt._PrepareAnimation(t,a,G,N,W,x,b,n);return i?K.getScene().beginDirectHierarchyAnimation(K,D,[i],0,N,1===i.loopMode,1,e):null}static CreateMergeAndStartAnimation(t,K,D,a,G,N,W,x,b,n){const e=Rt._PrepareAnimation(t,D,a,G,N,W,x,b);return e?(K.animations.push(e),K.getScene().beginAnimation(K,0,G,1===e.loopMode,1,n)):null}static MakeAnimationAdditive(t,K,D,a=!1,G){var W,x;let b;b="object"==typeof K?K:{referenceFrame:null!=K?K:0,range:D,cloneOriginalAnimation:a,clonedAnimationName:G};let n=t;if(b.cloneOriginalAnimation&&(n=t.clone(),n.name=b.clonedAnimationName||n.name),!n._keys.length)return n;const e=b.referenceFrame&&b.referenceFrame>=0?b.referenceFrame:0;let i=0;const z=n._keys[0];let I=n._keys.length-1;const Z=n._keys[I],w={referenceValue:z.value,referencePosition:N.AA.Vector3[0],referenceQuaternion:N.AA.Quaternion[0],referenceScaling:N.AA.Vector3[1],keyPosition:N.AA.Vector3[2],keyQuaternion:N.AA.Quaternion[1],keyScaling:N.AA.Vector3[3]};let m=z.frame,u=Z.frame;if(b.range){const t=n.getRange(b.range);t&&(m=t.from,u=t.to)}else m=null!==(W=b.fromFrame)&&void 0!==W?W:m,u=null!==(x=b.toFrame)&&void 0!==x?x:u;if(m!==z.frame&&(i=n.createKeyForFrame(m)),u!==Z.frame&&(I=n.createKeyForFrame(u)),1===n._keys.length){const t=n._getKeyValue(n._keys[0]);w.referenceValue=t.clone?t.clone():t}else if(e<=z.frame){const t=n._getKeyValue(z.value);w.referenceValue=t.clone?t.clone():t}else if(e>=Z.frame){const t=n._getKeyValue(Z.value);w.referenceValue=t.clone?t.clone():t}else{gt.key=0;const t=n._interpolate(e,gt);w.referenceValue=t.clone?t.clone():t}n.dataType===Rt.ANIMATIONTYPE_QUATERNION?w.referenceValue.normalize().conjugateInPlace():n.dataType===Rt.ANIMATIONTYPE_MATRIX&&(w.referenceValue.decompose(w.referenceScaling,w.referenceQuaternion,w.referencePosition),w.referenceQuaternion.normalize().conjugateInPlace());let d=Number.MAX_VALUE;const E=b.clipKeys?[]:null;for(let t=i;t<=I;t++){let K=n._keys[t];if((E||b.cloneOriginalAnimation)&&(K={frame:K.frame,value:K.value.clone?K.value.clone():K.value,inTangent:K.inTangent,outTangent:K.outTangent,interpolation:K.interpolation,lockedTangent:K.lockedTangent},E&&(d===Number.MAX_VALUE&&(d=K.frame),K.frame-=d,E.push(K))),!t||n.dataType===Rt.ANIMATIONTYPE_FLOAT||K.value!==z.value)switch(n.dataType){case Rt.ANIMATIONTYPE_MATRIX:K.value.decompose(w.keyScaling,w.keyQuaternion,w.keyPosition),w.keyPosition.subtractInPlace(w.referencePosition),w.keyScaling.divideInPlace(w.referenceScaling),w.referenceQuaternion.multiplyToRef(w.keyQuaternion,w.keyQuaternion),N.uq.ComposeToRef(w.keyScaling,w.keyQuaternion,w.keyPosition,K.value);break;case Rt.ANIMATIONTYPE_QUATERNION:w.referenceValue.multiplyToRef(K.value,K.value);break;case Rt.ANIMATIONTYPE_VECTOR2:case Rt.ANIMATIONTYPE_VECTOR3:case Rt.ANIMATIONTYPE_COLOR3:case Rt.ANIMATIONTYPE_COLOR4:K.value.subtractToRef(w.referenceValue,K.value);break;case Rt.ANIMATIONTYPE_SIZE:K.value.width-=w.referenceValue.width,K.value.height-=w.referenceValue.height;break;default:K.value-=w.referenceValue}}return E&&n.setKeys(E,!0),n}static TransitionTo(t,K,D,a,G,N,W,x=null){if(W<=0)return D[t]=K,x&&x(),null;const b=G*(W/1e3);N.setKeys([{frame:0,value:D[t].clone?D[t].clone():D[t]},{frame:b,value:K}]),D.animations||(D.animations=[]),D.animations.push(N);const n=a.beginAnimation(D,0,b,!1);return n.onAnimationEnd=x,n}get runtimeAnimations(){return this._runtimeAnimations}get hasRunningRuntimeAnimations(){for(const t of this._runtimeAnimations)if(!t.isStopped())return!0;return!1}constructor(t,K,D,a,G,N){this.name=t,this.targetProperty=K,this.framePerSecond=D,this.dataType=a,this.loopMode=G,this.enableBlending=N,this._easingFunction=null,this._runtimeAnimations=new Array,this._events=new Array,this.blendingSpeed=.01,this._ranges={},this.targetPropertyPath=K.split("."),this.dataType=a,this.loopMode=void 0===G?Rt.ANIMATIONLOOPMODE_CYCLE:G,this.uniqueId=Rt._UniqueIdGenerator++}toString(t){let K="Name: "+this.name+", property: "+this.targetProperty;if(K+=", datatype: "+["Float","Vector3","Quaternion","Matrix","Color3","Vector2"][this.dataType],K+=", nKeys: "+(this._keys?this._keys.length:"none"),K+=", nRanges: "+(this._ranges?Object.keys(this._ranges).length:"none"),t){K+=", Ranges: {";let t=!0;for(const D in this._ranges)t&&(K+=", ",t=!1),K+=D;K+="}"}return K}addEvent(t){this._events.push(t),this._events.sort(((t,K)=>t.frame-K.frame))}removeEvents(t){for(let K=0;K<this._events.length;K++)this._events[K].frame===t&&(this._events.splice(K,1),K--)}getEvents(){return this._events}createRange(t,K,D){this._ranges[t]||(this._ranges[t]=new _t(t,K,D))}deleteRange(t,K=!0){const D=this._ranges[t];if(D){if(K){const t=D.from,K=D.to;for(let D=this._keys.length-1;D>=0;D--)this._keys[D].frame>=t&&this._keys[D].frame<=K&&this._keys.splice(D,1)}this._ranges[t]=null}}getRange(t){return this._ranges[t]}getKeys(){return this._keys}getHighestFrame(){let t=0;for(let K=0,D=this._keys.length;K<D;K++)t<this._keys[K].frame&&(t=this._keys[K].frame);return t}getEasingFunction(){return this._easingFunction}setEasingFunction(t){this._easingFunction=t}floatInterpolateFunction(t,K,D){return it.X.Lerp(t,K,D)}floatInterpolateFunctionWithTangents(t,K,D,a,G){return it.X.Hermite(t,K,D,a,G)}quaternionInterpolateFunction(t,K,D){return N.PT.Slerp(t,K,D)}quaternionInterpolateFunctionWithTangents(t,K,D,a,G){return N.PT.Hermite(t,K,D,a,G).normalize()}vector3InterpolateFunction(t,K,D){return N.Pq.Lerp(t,K,D)}vector3InterpolateFunctionWithTangents(t,K,D,a,G){return N.Pq.Hermite(t,K,D,a,G)}vector2InterpolateFunction(t,K,D){return N.I9.Lerp(t,K,D)}vector2InterpolateFunctionWithTangents(t,K,D,a,G){return N.I9.Hermite(t,K,D,a,G)}sizeInterpolateFunction(t,K,D){return Ct.o.Lerp(t,K,D)}color3InterpolateFunction(t,K,D){return s.v9.Lerp(t,K,D)}color3InterpolateFunctionWithTangents(t,K,D,a,G){return s.v9.Hermite(t,K,D,a,G)}color4InterpolateFunction(t,K,D){return s.ov.Lerp(t,K,D)}color4InterpolateFunctionWithTangents(t,K,D,a,G){return s.ov.Hermite(t,K,D,a,G)}_getKeyValue(t){return"function"==typeof t?t():t}evaluate(t){return gt.key=0,this._interpolate(t,gt)}_interpolate(t,K,D=!1){var a;if(K.loopMode===Rt.ANIMATIONLOOPMODE_CONSTANT&&K.repeatCount>0)return K.highLimitValue.clone?K.highLimitValue.clone():K.highLimitValue;const G=this._keys,N=G.length;let W=K.key;for(;W>=0&&t<G[W].frame;)--W;for(;W+1<=N-1&&t>=G[W+1].frame;)++W;if(K.key=W,W<0)return D?void 0:this._getKeyValue(G[0].value);if(W+1>N-1)return D?void 0:this._getKeyValue(G[N-1].value);const x=G[W],b=G[W+1];if(D&&(t===x.frame||t===b.frame))return;const n=this._getKeyValue(x.value),e=this._getKeyValue(b.value);if(1===x.interpolation)return b.frame>t?n:e;const i=void 0!==x.outTangent&&void 0!==b.inTangent,z=b.frame-x.frame;let I=(t-x.frame)/z;const Z=x.easingFunction||this.getEasingFunction();switch(null!==Z&&(I=Z.ease(I)),this.dataType){case Rt.ANIMATIONTYPE_FLOAT:{const t=i?this.floatInterpolateFunctionWithTangents(n,x.outTangent*z,e,b.inTangent*z,I):this.floatInterpolateFunction(n,e,I);switch(K.loopMode){case Rt.ANIMATIONLOOPMODE_CYCLE:case Rt.ANIMATIONLOOPMODE_CONSTANT:case Rt.ANIMATIONLOOPMODE_YOYO:return t;case Rt.ANIMATIONLOOPMODE_RELATIVE:case Rt.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return(null!==(a=K.offsetValue)&&void 0!==a?a:0)*K.repeatCount+t}break}case Rt.ANIMATIONTYPE_QUATERNION:{const t=i?this.quaternionInterpolateFunctionWithTangents(n,x.outTangent.scale(z),e,b.inTangent.scale(z),I):this.quaternionInterpolateFunction(n,e,I);switch(K.loopMode){case Rt.ANIMATIONLOOPMODE_CYCLE:case Rt.ANIMATIONLOOPMODE_CONSTANT:case Rt.ANIMATIONLOOPMODE_YOYO:return t;case Rt.ANIMATIONLOOPMODE_RELATIVE:case Rt.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return t.addInPlace((K.offsetValue||ot).scale(K.repeatCount))}return t}case Rt.ANIMATIONTYPE_VECTOR3:{const t=i?this.vector3InterpolateFunctionWithTangents(n,x.outTangent.scale(z),e,b.inTangent.scale(z),I):this.vector3InterpolateFunction(n,e,I);switch(K.loopMode){case Rt.ANIMATIONLOOPMODE_CYCLE:case Rt.ANIMATIONLOOPMODE_CONSTANT:case Rt.ANIMATIONLOOPMODE_YOYO:return t;case Rt.ANIMATIONLOOPMODE_RELATIVE:case Rt.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return t.add((K.offsetValue||Ut).scale(K.repeatCount))}break}case Rt.ANIMATIONTYPE_VECTOR2:{const t=i?this.vector2InterpolateFunctionWithTangents(n,x.outTangent.scale(z),e,b.inTangent.scale(z),I):this.vector2InterpolateFunction(n,e,I);switch(K.loopMode){case Rt.ANIMATIONLOOPMODE_CYCLE:case Rt.ANIMATIONLOOPMODE_CONSTANT:case Rt.ANIMATIONLOOPMODE_YOYO:return t;case Rt.ANIMATIONLOOPMODE_RELATIVE:case Rt.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return t.add((K.offsetValue||Vt).scale(K.repeatCount))}break}case Rt.ANIMATIONTYPE_SIZE:switch(K.loopMode){case Rt.ANIMATIONLOOPMODE_CYCLE:case Rt.ANIMATIONLOOPMODE_CONSTANT:case Rt.ANIMATIONLOOPMODE_YOYO:return this.sizeInterpolateFunction(n,e,I);case Rt.ANIMATIONLOOPMODE_RELATIVE:case Rt.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return this.sizeInterpolateFunction(n,e,I).add((K.offsetValue||st).scale(K.repeatCount))}break;case Rt.ANIMATIONTYPE_COLOR3:{const t=i?this.color3InterpolateFunctionWithTangents(n,x.outTangent.scale(z),e,b.inTangent.scale(z),I):this.color3InterpolateFunction(n,e,I);switch(K.loopMode){case Rt.ANIMATIONLOOPMODE_CYCLE:case Rt.ANIMATIONLOOPMODE_CONSTANT:case Rt.ANIMATIONLOOPMODE_YOYO:return t;case Rt.ANIMATIONLOOPMODE_RELATIVE:case Rt.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return t.add((K.offsetValue||Ft).scale(K.repeatCount))}break}case Rt.ANIMATIONTYPE_COLOR4:{const t=i?this.color4InterpolateFunctionWithTangents(n,x.outTangent.scale(z),e,b.inTangent.scale(z),I):this.color4InterpolateFunction(n,e,I);switch(K.loopMode){case Rt.ANIMATIONLOOPMODE_CYCLE:case Rt.ANIMATIONLOOPMODE_CONSTANT:case Rt.ANIMATIONLOOPMODE_YOYO:return t;case Rt.ANIMATIONLOOPMODE_RELATIVE:case Rt.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return t.add((K.offsetValue||ct).scale(K.repeatCount))}break}case Rt.ANIMATIONTYPE_MATRIX:switch(K.loopMode){case Rt.ANIMATIONLOOPMODE_CYCLE:case Rt.ANIMATIONLOOPMODE_CONSTANT:case Rt.ANIMATIONLOOPMODE_YOYO:return Rt.AllowMatricesInterpolation?this.matrixInterpolateFunction(n,e,I,K.workValue):n;case Rt.ANIMATIONLOOPMODE_RELATIVE:case Rt.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return n}}return 0}matrixInterpolateFunction(t,K,D,a){return Rt.AllowMatrixDecomposeForInterpolation?a?(N.uq.DecomposeLerpToRef(t,K,D,a),a):N.uq.DecomposeLerp(t,K,D):a?(N.uq.LerpToRef(t,K,D,a),a):N.uq.Lerp(t,K,D)}clone(){const t=new Rt(this.name,this.targetPropertyPath.join("."),this.framePerSecond,this.dataType,this.loopMode);if(t.enableBlending=this.enableBlending,t.blendingSpeed=this.blendingSpeed,this._keys&&t.setKeys(this._keys),this._ranges){t._ranges={};for(const K in this._ranges){const D=this._ranges[K];D&&(t._ranges[K]=D.clone())}}return t}setKeys(t,K=!1){this._keys=K?t:t.slice(0)}createKeyForFrame(t){gt.key=0;const K=this._interpolate(t,gt,!0);if(!K)return this._keys[gt.key].frame===t?gt.key:gt.key+1;const D={frame:t,value:K.clone?K.clone():K};return this._keys.splice(gt.key+1,0,D),gt.key+1}serialize(){const t={};t.name=this.name,t.property=this.targetProperty,t.framePerSecond=this.framePerSecond,t.dataType=this.dataType,t.loopBehavior=this.loopMode,t.enableBlending=this.enableBlending,t.blendingSpeed=this.blendingSpeed;const K=this.dataType;t.keys=[];const D=this.getKeys();for(let a=0;a<D.length;a++){const G=D[a],N={};switch(N.frame=G.frame,K){case Rt.ANIMATIONTYPE_FLOAT:N.values=[G.value],void 0!==G.inTangent&&N.values.push(G.inTangent),void 0!==G.outTangent&&(void 0===G.inTangent&&N.values.push(void 0),N.values.push(G.outTangent)),void 0!==G.interpolation&&(void 0===G.inTangent&&N.values.push(void 0),void 0===G.outTangent&&N.values.push(void 0),N.values.push(G.interpolation));break;case Rt.ANIMATIONTYPE_QUATERNION:case Rt.ANIMATIONTYPE_MATRIX:case Rt.ANIMATIONTYPE_VECTOR3:case Rt.ANIMATIONTYPE_COLOR3:case Rt.ANIMATIONTYPE_COLOR4:N.values=G.value.asArray(),null!=G.inTangent&&N.values.push(G.inTangent.asArray()),null!=G.outTangent&&(void 0===G.inTangent&&N.values.push(void 0),N.values.push(G.outTangent.asArray())),void 0!==G.interpolation&&(void 0===G.inTangent&&N.values.push(void 0),void 0===G.outTangent&&N.values.push(void 0),N.values.push(G.interpolation))}t.keys.push(N)}t.ranges=[];for(const K in this._ranges){const D=this._ranges[K];if(!D)continue;const a={};a.name=K,a.from=D.from,a.to=D.to,t.ranges.push(a)}return t}static _UniversalLerp(t,K,D){const a=t.constructor;return a.Lerp?a.Lerp(t,K,D):a.Slerp?a.Slerp(t,K,D):t.toFixed?t*(1-D)+D*K:K}static Parse(t){const K=new Rt(t.name,t.property,t.framePerSecond,t.dataType,t.loopBehavior),D=t.dataType,a=[];let G,W;for(t.enableBlending&&(K.enableBlending=t.enableBlending),t.blendingSpeed&&(K.blendingSpeed=t.blendingSpeed),W=0;W<t.keys.length;W++){const K=t.keys[W];let x,b,n;switch(D){case Rt.ANIMATIONTYPE_FLOAT:G=K.values[0],K.values.length>=2&&(x=K.values[1]),K.values.length>=3&&(b=K.values[2]),K.values.length>=4&&(n=K.values[3]);break;case Rt.ANIMATIONTYPE_QUATERNION:if(G=N.PT.FromArray(K.values),K.values.length>=8){const t=N.PT.FromArray(K.values.slice(4,8));t.equals(N.PT.Zero())||(x=t)}if(K.values.length>=12){const t=N.PT.FromArray(K.values.slice(8,12));t.equals(N.PT.Zero())||(b=t)}K.values.length>=13&&(n=K.values[12]);break;case Rt.ANIMATIONTYPE_MATRIX:G=N.uq.FromArray(K.values),K.values.length>=17&&(n=K.values[16]);break;case Rt.ANIMATIONTYPE_COLOR3:G=s.v9.FromArray(K.values),K.values[3]&&(x=s.v9.FromArray(K.values[3])),K.values[4]&&(b=s.v9.FromArray(K.values[4])),K.values[5]&&(n=K.values[5]);break;case Rt.ANIMATIONTYPE_COLOR4:G=s.ov.FromArray(K.values),K.values[4]&&(x=s.ov.FromArray(K.values[4])),K.values[5]&&(b=s.ov.FromArray(K.values[5])),K.values[6]&&(n=s.ov.FromArray(K.values[6]));break;case Rt.ANIMATIONTYPE_VECTOR3:default:G=N.Pq.FromArray(K.values),K.values[3]&&(x=N.Pq.FromArray(K.values[3])),K.values[4]&&(b=N.Pq.FromArray(K.values[4])),K.values[5]&&(n=K.values[5])}const e={};e.frame=K.frame,e.value=G,null!=x&&(e.inTangent=x),null!=b&&(e.outTangent=b),null!=n&&(e.interpolation=n),a.push(e)}if(K.setKeys(a),t.ranges)for(W=0;W<t.ranges.length;W++)G=t.ranges[W],K.createRange(G.name,G.from,G.to);return K}static AppendSerializedAnimations(t,K){z.p.AppendSerializedAnimations(t,K)}static ParseFromFileAsync(t,K){return new Promise(((D,a)=>{const G=new Ht.u;G.addEventListener("readystatechange",(()=>{if(4==G.readyState)if(200==G.status){let K=JSON.parse(G.responseText);if(K.animations&&(K=K.animations),K.length){const t=[];for(const D of K)t.push(this.Parse(D));D(t)}else{const a=this.Parse(K);t&&(a.name=t),D(a)}}else a("Unable to load the animation")})),G.open("GET",K),G.send()}))}static ParseFromSnippetAsync(t){return new Promise(((K,D)=>{const a=new Ht.u;a.addEventListener("readystatechange",(()=>{if(4==a.readyState)if(200==a.status){const D=JSON.parse(JSON.parse(a.responseText).jsonPayload);if(D.animations){const a=JSON.parse(D.animations),G=[];for(const K of a.animations){const D=this.Parse(K);D.snippetId=t,G.push(D)}K(G)}else{const a=JSON.parse(D.animation),G=this.Parse(a);G.snippetId=t,K(G)}}else D("Unable to load the snippet "+t)})),a.open("GET",this.SnippetUrl+"/"+t.replace(/#/g,"/")),a.send()}))}}Rt._UniqueIdGenerator=0,Rt.AllowMatricesInterpolation=!1,Rt.AllowMatrixDecomposeForInterpolation=!0,Rt.SnippetUrl=`https://snippet.babylonjs.com`,Rt.ANIMATIONTYPE_FLOAT=0,Rt.ANIMATIONTYPE_VECTOR3=1,Rt.ANIMATIONTYPE_QUATERNION=2,Rt.ANIMATIONTYPE_MATRIX=3,Rt.ANIMATIONTYPE_COLOR3=4,Rt.ANIMATIONTYPE_COLOR4=7,Rt.ANIMATIONTYPE_VECTOR2=5,Rt.ANIMATIONTYPE_SIZE=6,Rt.ANIMATIONLOOPMODE_RELATIVE=0,Rt.ANIMATIONLOOPMODE_CYCLE=1,Rt.ANIMATIONLOOPMODE_CONSTANT=2,Rt.ANIMATIONLOOPMODE_YOYO=4,Rt.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT=5,Rt.CreateFromSnippetAsync=Rt.ParseFromSnippetAsync,J.Y5("BABYLON.Animation",Rt),n.b._AnimationRangeFactory=(t,K,D)=>new _t(t,K,D);class At{getClassName(){return"TargetedAnimation"}serialize(){const t={};return t.animation=this.animation.serialize(),t.targetId=this.target.id,t}}class Yt{get mask(){return this._mask}set mask(t){this._mask!==t&&(this._mask=t,this.syncWithMask(!0))}syncWithMask(t=!1){if(this.mask||t){this._numActiveAnimatables=0;for(let t=0;t<this._animatables.length;++t){const K=this._animatables[t];!this.mask||this.mask.disabled||this.mask.retainsTarget(K.target.name)?(this._numActiveAnimatables++,K.paused&&K.restart()):K.paused||K.pause()}}else this._numActiveAnimatables=this._targetedAnimations.length}removeUnmaskedAnimations(){if(this.mask&&!this.mask.disabled){for(let t=0;t<this._animatables.length;++t){const K=this._animatables[t];this.mask.retainsTarget(K.target.name)||(K.stop(),this._animatables.splice(t,1),--t)}for(let t=0;t<this._targetedAnimations.length;t++){const K=this._targetedAnimations[t];this.mask.retainsTarget(K.target.name)||(this._targetedAnimations.splice(t,1),--t)}}}get from(){return this._from}set from(t){if(this._from!==t){this._from=t;for(let t=0;t<this._animatables.length;t++)this._animatables[t].fromFrame=this._from}}get to(){return this._to}set to(t){if(this._to!==t){this._to=t;for(let t=0;t<this._animatables.length;t++)this._animatables[t].toFrame=this._to}}get isStarted(){return this._isStarted}get isPlaying(){return this._isStarted&&!this._isPaused}get speedRatio(){return this._speedRatio}set speedRatio(t){if(this._speedRatio!==t){this._speedRatio=t;for(let t=0;t<this._animatables.length;t++)this._animatables[t].speedRatio=this._speedRatio}}get loopAnimation(){return this._loopAnimation}set loopAnimation(t){if(this._loopAnimation!==t){this._loopAnimation=t;for(let t=0;t<this._animatables.length;t++)this._animatables[t].loopAnimation=this._loopAnimation}}get isAdditive(){return this._isAdditive}set isAdditive(t){if(this._isAdditive!==t){this._isAdditive=t;for(let t=0;t<this._animatables.length;t++)this._animatables[t].isAdditive=this._isAdditive}}get weight(){return this._weight}set weight(t){this._weight!==t&&(this._weight=t,this.setWeightForAllAnimatables(this._weight))}get targetedAnimations(){return this._targetedAnimations}get animatables(){return this._animatables}get children(){return this._targetedAnimations}get playOrder(){return this._playOrder}set playOrder(t){if(this._playOrder!==t&&(this._playOrder=t,this._animatables.length>0)){for(let t=0;t<this._animatables.length;t++)this._animatables[t].playOrder=this._playOrder;this._scene.sortActiveAnimatables()}}get enableBlending(){return this._enableBlending}set enableBlending(t){if(this._enableBlending!==t&&(this._enableBlending=t,null!==t))for(let K=0;K<this._targetedAnimations.length;++K)this._targetedAnimations[K].animation.enableBlending=t}get blendingSpeed(){return this._blendingSpeed}set blendingSpeed(t){if(this._blendingSpeed!==t&&(this._blendingSpeed=t,null!==t))for(let K=0;K<this._targetedAnimations.length;++K)this._targetedAnimations[K].animation.blendingSpeed=t}getLength(t,K){return t=null!=t?t:this._from,((K=null!=K?K:this._to)-t)/(this.targetedAnimations[0].animation.framePerSecond*this._speedRatio)}static MergeAnimationGroups(t,K=!0,D=!1,a){if(0===t.length)return null;a=null!=a?a:t[0].weight;let G=Number.MAX_VALUE,N=-Number.MAX_VALUE;if(D)for(const K of t)K.from<G&&(G=K.from),K.to>N&&(N=K.to);const W=new Yt(t[0].name+"_merged",t[0]._scene,a);for(const a of t){D&&a.normalize(G,N);for(const t of a.targetedAnimations)W.addTargetedAnimation(t.animation,t.target);K&&a.dispose()}return W}constructor(t,K=null,D=-1,a=0){this.name=t,this._targetedAnimations=new Array,this._animatables=new Array,this._from=Number.MAX_VALUE,this._to=-Number.MAX_VALUE,this._speedRatio=1,this._loopAnimation=!1,this._isAdditive=!1,this._weight=-1,this._playOrder=0,this._enableBlending=null,this._blendingSpeed=null,this._numActiveAnimatables=0,this._shouldStart=!0,this._parentContainer=null,this.onAnimationEndObservable=new d.cP,this.onAnimationLoopObservable=new d.cP,this.onAnimationGroupLoopObservable=new d.cP,this.onAnimationGroupEndObservable=new d.cP,this.onAnimationGroupPauseObservable=new d.cP,this.onAnimationGroupPlayObservable=new d.cP,this.metadata=null,this._mask=null,this._animationLoopFlags=[],this._scene=K||$.q.LastCreatedScene,this._weight=D,this._playOrder=a,this.uniqueId=this._scene.getUniqueId(),this._scene.addAnimationGroup(this)}addTargetedAnimation(t,K){const D=new At;D.animation=t,D.target=K;const a=t.getKeys();return this._from>a[0].frame&&(this._from=a[0].frame),this._to<a[a.length-1].frame&&(this._to=a[a.length-1].frame),null!==this._enableBlending&&(t.enableBlending=this._enableBlending),null!==this._blendingSpeed&&(t.blendingSpeed=this._blendingSpeed),this._targetedAnimations.push(D),this._shouldStart=!0,D}removeTargetedAnimation(t){for(let K=this._targetedAnimations.length-1;K>-1;K--)this._targetedAnimations[K].animation===t&&this._targetedAnimations.splice(K,1)}normalize(t=null,K=null){null==t&&(t=this._from),null==K&&(K=this._to);for(let D=0;D<this._targetedAnimations.length;D++){const a=this._targetedAnimations[D].animation.getKeys(),G=a[0],N=a[a.length-1];if(G.frame>t){const K={frame:t,value:G.value,inTangent:G.inTangent,outTangent:G.outTangent,interpolation:G.interpolation};a.splice(0,0,K)}if(N.frame<K){const t={frame:K,value:N.value,inTangent:N.inTangent,outTangent:N.outTangent,interpolation:N.interpolation};a.push(t)}}return this._from=t,this._to=K,this}_processLoop(t,K,D){t.onAnimationLoop=()=>{this.onAnimationLoopObservable.notifyObservers(K),this._animationLoopFlags[D]||(this._animationLoopFlags[D]=!0,this._animationLoopCount++,this._animationLoopCount===this._numActiveAnimatables&&(this.onAnimationGroupLoopObservable.notifyObservers(this),this._animationLoopCount=0,this._animationLoopFlags.length=0))}}start(t=!1,K=1,D,a,G){if(this._isStarted||0===this._targetedAnimations.length)return this;this._loopAnimation=t,this._shouldStart=!1,this._animationLoopCount=0,this._animationLoopFlags.length=0;for(let N=0;N<this._targetedAnimations.length;N++){const W=this._targetedAnimations[N],x=this._scene.beginDirectAnimation(W.target,[W.animation],void 0!==D?D:this._from,void 0!==a?a:this._to,t,K,void 0,void 0,void 0!==G?G:this._isAdditive);x.weight=this._weight,x.playOrder=this._playOrder,x.onAnimationEnd=()=>{this.onAnimationEndObservable.notifyObservers(W),this._checkAnimationGroupEnded(x)},this._processLoop(x,W,N),this._animatables.push(x)}return this.syncWithMask(),this._scene.sortActiveAnimatables(),this._speedRatio=K,this._isStarted=!0,this._isPaused=!1,this.onAnimationGroupPlayObservable.notifyObservers(this),this}pause(){if(!this._isStarted)return this;this._isPaused=!0;for(let t=0;t<this._animatables.length;t++)this._animatables[t].pause();return this.onAnimationGroupPauseObservable.notifyObservers(this),this}play(t){return this.isStarted&&this._animatables.length&&!this._shouldStart?(void 0!==t&&(this.loopAnimation=t),this.restart()):(this.stop(),this.start(t,this._speedRatio)),this}reset(){if(!this._isStarted)return this.play(),this.goToFrame(0),this.stop(!0),this;for(let t=0;t<this._animatables.length;t++)this._animatables[t].reset();return this}restart(){if(!this._isStarted)return this;for(let t=0;t<this._animatables.length;t++)this._animatables[t].restart();return this.syncWithMask(),this._isPaused=!1,this.onAnimationGroupPlayObservable.notifyObservers(this),this}stop(t=!1){if(!this._isStarted)return this;const K=this._animatables.slice();for(let D=0;D<K.length;D++)K[D].stop(void 0,void 0,!0,t);let D=0;for(let K=0;K<this._scene._activeAnimatables.length;K++){const a=this._scene._activeAnimatables[K];a._runtimeAnimations.length>0?this._scene._activeAnimatables[D++]=a:t&&this._checkAnimationGroupEnded(a,t)}return this._scene._activeAnimatables.length=D,this._isStarted=!1,this}setWeightForAllAnimatables(t){for(let K=0;K<this._animatables.length;K++)this._animatables[K].weight=t;return this}syncAllAnimationsWith(t){for(let K=0;K<this._animatables.length;K++)this._animatables[K].syncWith(t);return this}goToFrame(t){if(!this._isStarted)return this;for(let K=0;K<this._animatables.length;K++)this._animatables[K].goToFrame(t);return this}getCurrentFrame(){var t;return(null===(t=this.animatables[0])||void 0===t?void 0:t.masterFrame)||0}dispose(){this.isStarted&&this.stop(),this._targetedAnimations.length=0,this._animatables.length=0;const t=this._scene.animationGroups.indexOf(this);if(t>-1&&this._scene.animationGroups.splice(t,1),this._parentContainer){const t=this._parentContainer.animationGroups.indexOf(this);t>-1&&this._parentContainer.animationGroups.splice(t,1),this._parentContainer=null}this.onAnimationEndObservable.clear(),this.onAnimationGroupEndObservable.clear(),this.onAnimationGroupPauseObservable.clear(),this.onAnimationGroupPlayObservable.clear(),this.onAnimationLoopObservable.clear(),this.onAnimationGroupLoopObservable.clear()}_checkAnimationGroupEnded(t,K=!1){const D=this._animatables.indexOf(t);D>-1&&this._animatables.splice(D,1),0===this._animatables.length&&(this._isStarted=!1,K||this.onAnimationGroupEndObservable.notifyObservers(this))}clone(t,K,D=!1){const a=new Yt(t||this.name,this._scene,this._weight,this._playOrder);a._from=this.from,a._to=this.to,a._speedRatio=this.speedRatio,a._loopAnimation=this.loopAnimation,a._isAdditive=this.isAdditive,a._enableBlending=this.enableBlending,a._blendingSpeed=this.blendingSpeed,a.metadata=this.metadata,a.mask=this.mask;for(const t of this._targetedAnimations)a.addTargetedAnimation(D?t.animation.clone():t.animation,K?K(t.target):t.target);return a}serialize(){const t={};t.name=this.name,t.from=this.from,t.to=this.to,t.speedRatio=this.speedRatio,t.loopAnimation=this.loopAnimation,t.isAdditive=this.isAdditive,t.weight=this.weight,t.playOrder=this.playOrder,t.enableBlending=this.enableBlending,t.blendingSpeed=this.blendingSpeed,t.targetedAnimations=[];for(let K=0;K<this.targetedAnimations.length;K++){const D=this.targetedAnimations[K];t.targetedAnimations[K]=D.serialize()}return c.Y&&c.Y.HasTags(this)&&(t.tags=c.Y.GetTags(this)),this.metadata&&(t.metadata=this.metadata),t}static Parse(t,K){const D=new Yt(t.name,K,t.weight,t.playOrder);for(let a=0;a<t.targetedAnimations.length;a++){const G=t.targetedAnimations[a],N=Rt.Parse(G.animation),W=G.targetId;if("influence"===G.animation.property){const t=K.getMorphTargetById(W);t&&D.addTargetedAnimation(N,t)}else{const t=K.getNodeById(W);null!=t&&D.addTargetedAnimation(N,t)}}return c.Y&&c.Y.AddTagsTo(D,t.tags),null!==t.from&&null!==t.to&&D.normalize(t.from,t.to),void 0!==t.speedRatio&&(D._speedRatio=t.speedRatio),void 0!==t.loopAnimation&&(D._loopAnimation=t.loopAnimation),void 0!==t.isAdditive&&(D._isAdditive=t.isAdditive),void 0!==t.weight&&(D._weight=t.weight),void 0!==t.playOrder&&(D._playOrder=t.playOrder),void 0!==t.enableBlending&&(D._enableBlending=t.enableBlending),void 0!==t.blendingSpeed&&(D._blendingSpeed=t.blendingSpeed),void 0!==t.metadata&&(D.metadata=t.metadata),D}static MakeAnimationAdditive(t,K,D,a=!1,G){let N;N="object"==typeof K?K:{referenceFrame:K,range:D,cloneOriginalAnimationGroup:a,clonedAnimationName:G};let W=t;N.cloneOriginalAnimationGroup&&(W=t.clone(N.clonedAnimationGroupName||W.name));const x=W.targetedAnimations;for(let t=0;t<x.length;t++){const K=x[t];K.animation=Rt.MakeAnimationAdditive(K.animation,N)}if(W.isAdditive=!0,N.clipKeys){let t=Number.MAX_VALUE,K=-Number.MAX_VALUE;const D=W.targetedAnimations;for(let a=0;a<D.length;a++){const G=D[a].animation.getKeys();t>G[0].frame&&(t=G[0].frame),K<G[G.length-1].frame&&(K=G[G.length-1].frame)}W._from=t,W._to=K}return W}static ClipKeys(t,K,D,a,G){const N=t.clone(a||t.name);return Yt.ClipKeysInPlace(N,K,D,G)}static ClipKeysInPlace(t,K,D,a){return Yt.ClipInPlace(t,K,D,a,!1)}static ClipFrames(t,K,D,a,G){const N=t.clone(a||t.name);return Yt.ClipFramesInPlace(N,K,D,G)}static ClipFramesInPlace(t,K,D,a){return Yt.ClipInPlace(t,K,D,a,!0)}static ClipInPlace(t,K,D,a,G=!1){let N=Number.MAX_VALUE,W=-Number.MAX_VALUE;const x=t.targetedAnimations;for(let t=0;t<x.length;t++){const b=x[t],n=a?b.animation:b.animation.clone();G&&(n.createKeyForFrame(K),n.createKeyForFrame(D));const e=n.getKeys(),i=[];let z=Number.MAX_VALUE;for(let t=0;t<e.length;t++){const a=e[t];if(!G&&t>=K&&t<=D||G&&a.frame>=K&&a.frame<=D){const t={frame:a.frame,value:a.value.clone?a.value.clone():a.value,inTangent:a.inTangent,outTangent:a.outTangent,interpolation:a.interpolation,lockedTangent:a.lockedTangent};z===Number.MAX_VALUE&&(z=t.frame),t.frame-=z,i.push(t)}}0!==i.length?(N>i[0].frame&&(N=i[0].frame),W<i[i.length-1].frame&&(W=i[i.length-1].frame),n.setKeys(i,!0),b.animation=n):(x.splice(t,1),t--)}return t._from=N,t._to=W,t}getClassName(){return"AnimationGroup"}toString(t){let K="Name: "+this.name;return K+=", type: "+this.getClassName(),t&&(K+=", from: "+this._from,K+=", to: "+this._to,K+=", isStarted: "+this._isStarted,K+=", speedRatio: "+this._speedRatio,K+=", targetedAnimations length: "+this._targetedAnimations.length,K+=", animatables length: "+this._animatables),K}}var Lt=D(548949),St=D(837475);Nt._instancedMeshFactory=(t,K)=>{const D=new ft(t,K);if(K.instancedBuffers){D.instancedBuffers={};for(const t in K.instancedBuffers)D.instancedBuffers[t]=K.instancedBuffers[t]}return D};class ft extends v.u{constructor(t,K){super(t,K.getScene()),this._indexInSourceMeshInstanceArray=-1,this._distanceToCamera=0,K.addInstance(this),this._sourceMesh=K,this._unIndexed=K._unIndexed,this.position.copyFrom(K.position),this.rotation.copyFrom(K.rotation),this.scaling.copyFrom(K.scaling),K.rotationQuaternion&&(this.rotationQuaternion=K.rotationQuaternion.clone()),this.animations=K.animations.slice();for(const t of K.getAnimationRanges())null!=t&&this.createAnimationRange(t.name,t.from,t.to);this.infiniteDistance=K.infiniteDistance,this.setPivotMatrix(K.getPivotMatrix()),this.refreshBoundingInfo(!0,!0),this._syncSubMeshes()}getClassName(){return"InstancedMesh"}get lightSources(){return this._sourceMesh._lightSources}_resyncLightSources(){}_resyncLightSource(){}_removeLightSource(){}get receiveShadows(){return this._sourceMesh.receiveShadows}set receiveShadows(t){var K;(null===(K=this._sourceMesh)||void 0===K?void 0:K.receiveShadows)!==t&&m.S0.Warn("Setting receiveShadows on an instanced mesh has no effect")}get material(){return this._sourceMesh.material}set material(t){var K;(null===(K=this._sourceMesh)||void 0===K?void 0:K.material)!==t&&m.S0.Warn("Setting material on an instanced mesh has no effect")}get visibility(){return this._sourceMesh.visibility}set visibility(t){var K;(null===(K=this._sourceMesh)||void 0===K?void 0:K.visibility)!==t&&m.S0.Warn("Setting visibility on an instanced mesh has no effect")}get skeleton(){return this._sourceMesh.skeleton}set skeleton(t){var K;(null===(K=this._sourceMesh)||void 0===K?void 0:K.skeleton)!==t&&m.S0.Warn("Setting skeleton on an instanced mesh has no effect")}get renderingGroupId(){return this._sourceMesh.renderingGroupId}set renderingGroupId(t){this._sourceMesh&&t!==this._sourceMesh.renderingGroupId&&i.V.Warn("Note - setting renderingGroupId of an instanced mesh has no effect on the scene")}getTotalVertices(){return this._sourceMesh?this._sourceMesh.getTotalVertices():0}getTotalIndices(){return this._sourceMesh.getTotalIndices()}get sourceMesh(){return this._sourceMesh}createInstance(t){return this._sourceMesh.createInstance(t)}isReady(t=!1){return this._sourceMesh.isReady(t,!0)}getVerticesData(t,K,D){return this._sourceMesh.getVerticesData(t,K,D)}copyVerticesData(t,K){this._sourceMesh.copyVerticesData(t,K)}setVerticesData(t,K,D,a){return this.sourceMesh&&this.sourceMesh.setVerticesData(t,K,D,a),this.sourceMesh}updateVerticesData(t,K,D,a){return this.sourceMesh&&this.sourceMesh.updateVerticesData(t,K,D,a),this.sourceMesh}setIndices(t,K=null){return this.sourceMesh&&this.sourceMesh.setIndices(t,K),this.sourceMesh}isVerticesDataPresent(t){return this._sourceMesh.isVerticesDataPresent(t)}getIndices(){return this._sourceMesh.getIndices()}get _positions(){return this._sourceMesh._positions}refreshBoundingInfo(t=!1,K=!1){if(this.hasBoundingInfo&&this.getBoundingInfo().isLocked)return this;let D;D="object"==typeof t?t:{applySkeleton:t,applyMorph:K};const a=this._sourceMesh.geometry?this._sourceMesh.geometry.boundingBias:null;return this._refreshBoundingInfo(this._sourceMesh._getData(D,null,R.R.PositionKind),a),this}_preActivate(){return this._currentLOD&&this._currentLOD._preActivate(),this}_activate(t,K){if(super._activate(t,K),this._sourceMesh.subMeshes||i.V.Warn("Instances should only be created for meshes with geometry."),this._currentLOD){if(this._currentLOD._getWorldMatrixDeterminant()>=0!=this._getWorldMatrixDeterminant()>=0)return this._internalAbstractMeshDataInfo._actAsRegularMesh=!0,!0;if(this._internalAbstractMeshDataInfo._actAsRegularMesh=!1,this._currentLOD._registerInstanceForRenderId(this,t),K){if(!this._currentLOD._internalAbstractMeshDataInfo._isActiveIntermediate)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!0,!0}else if(!this._currentLOD._internalAbstractMeshDataInfo._isActive)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstances=!0,!0}return!1}_postActivate(){this._sourceMesh.edgesShareWithInstances&&this._sourceMesh._edgesRenderer&&this._sourceMesh._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup?(this._sourceMesh._renderingGroup._edgesRenderers.pushNoDuplicate(this._sourceMesh._edgesRenderer),this._sourceMesh._edgesRenderer.customInstances.push(this.getWorldMatrix())):this._edgesRenderer&&this._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup&&this._sourceMesh._renderingGroup._edgesRenderers.push(this._edgesRenderer)}getWorldMatrix(){if(this._currentLOD&&this._currentLOD.billboardMode!==Wt.V.BILLBOARDMODE_NONE&&this._currentLOD._masterMesh!==this){this._billboardWorldMatrix||(this._billboardWorldMatrix=new N.uq);const t=this._currentLOD._masterMesh;return this._currentLOD._masterMesh=this,N.AA.Vector3[7].copyFrom(this._currentLOD.position),this._currentLOD.position.set(0,0,0),this._billboardWorldMatrix.copyFrom(this._currentLOD.computeWorldMatrix(!0)),this._currentLOD.position.copyFrom(N.AA.Vector3[7]),this._currentLOD._masterMesh=t,this._billboardWorldMatrix}return super.getWorldMatrix()}get isAnInstance(){return!0}getLOD(t){if(!t)return this;const K=this.sourceMesh.getLODLevels();if(K&&0!==K.length){const K=this.getBoundingInfo();this._currentLOD=this.sourceMesh.getLOD(t,K.boundingSphere)}else this._currentLOD=this.sourceMesh;return this._currentLOD}_preActivateForIntermediateRendering(t){return this.sourceMesh._preActivateForIntermediateRendering(t)}_syncSubMeshes(){if(this.releaseSubMeshes(),this._sourceMesh.subMeshes)for(let t=0;t<this._sourceMesh.subMeshes.length;t++)this._sourceMesh.subMeshes[t].clone(this,this._sourceMesh);return this}_generatePointsArray(){return this._sourceMesh._generatePointsArray()}_updateBoundingInfo(){return this.hasBoundingInfo?this.getBoundingInfo().update(this.worldMatrixFromCache):this.buildBoundingInfo(this.absolutePosition,this.absolutePosition,this.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache),this}clone(t,K=null,D,a){const G=(a||this._sourceMesh).createInstance(t);if(F.r.DeepCopy(this,G,["name","subMeshes","uniqueId","parent","lightSources","receiveShadows","material","visibility","skeleton","sourceMesh","isAnInstance","facetNb","isFacetDataEnabled","isBlocked","useBones","hasInstances","collider","edgesRenderer","forward","up","right","absolutePosition","absoluteScaling","absoluteRotationQuaternion","isWorldMatrixFrozen","nonUniformScaling","behaviors","worldMatrixFromCache","hasThinInstances","hasBoundingInfo"],[]),this.refreshBoundingInfo(),K&&(G.parent=K),!D)for(let t=0;t<this.getScene().meshes.length;t++){const K=this.getScene().meshes[t];K.parent===this&&K.clone(K.name,G)}return G.computeWorldMatrix(!0),this.onClonedObservable.notifyObservers(G),G}dispose(t,K=!1){this._sourceMesh.removeInstance(this),super.dispose(t,K)}_serializeAsParent(t){super._serializeAsParent(t),t.parentId=this._sourceMesh.uniqueId,t.parentInstanceIndex=this._indexInSourceMeshInstanceArray}instantiateHierarchy(t=null,K,D){const a=this.clone("Clone of "+(this.name||this.id),t||this.parent,!0,K&&K.newSourcedMesh);a&&D&&D(this,a);for(const t of this.getChildTransformNodes(!0))t.instantiateHierarchy(a,K,D);return a}}Nt.prototype.registerInstancedBuffer=function(t,K){var D,a;if(null===(a=null===(D=this._userInstancedBuffersStorage)||void 0===D?void 0:D.vertexBuffers[t])||void 0===a||a.dispose(),!this.instancedBuffers){this.instancedBuffers={};for(const t of this.instances)t.instancedBuffers={}}this._userInstancedBuffersStorage||(this._userInstancedBuffersStorage={data:{},vertexBuffers:{},strides:{},sizes:{},vertexArrayObjects:this.getEngine().getCaps().vertexArrayObject?{}:void 0}),this.instancedBuffers[t]=null,this._userInstancedBuffersStorage.strides[t]=K,this._userInstancedBuffersStorage.sizes[t]=32*K,this._userInstancedBuffersStorage.data[t]=new Float32Array(this._userInstancedBuffersStorage.sizes[t]),this._userInstancedBuffersStorage.vertexBuffers[t]=new R.R(this.getEngine(),this._userInstancedBuffersStorage.data[t],t,!0,!1,K,!0);for(const K of this.instances)K.instancedBuffers[t]=null;this._invalidateInstanceVertexArrayObject(),this._markSubMeshesAsAttributesDirty()},Nt.prototype._processInstancedBuffers=function(t,K){const D=t?t.length:0;for(const a in this.instancedBuffers){let G=this._userInstancedBuffersStorage.sizes[a];const N=this._userInstancedBuffersStorage.strides[a],W=(D+1)*N;for(;G<W;)G*=2;this._userInstancedBuffersStorage.data[a].length!=G&&(this._userInstancedBuffersStorage.data[a]=new Float32Array(G),this._userInstancedBuffersStorage.sizes[a]=G,this._userInstancedBuffersStorage.vertexBuffers[a]&&(this._userInstancedBuffersStorage.vertexBuffers[a].dispose(),this._userInstancedBuffersStorage.vertexBuffers[a]=null));const x=this._userInstancedBuffersStorage.data[a];let b=0;if(K){const t=this.instancedBuffers[a];t.toArray?t.toArray(x,b):t.copyToArray?t.copyToArray(x,b):x[b]=t,b+=N}for(let K=0;K<D;K++){const D=t[K].instancedBuffers[a];D.toArray?D.toArray(x,b):D.copyToArray?D.copyToArray(x,b):x[b]=D,b+=N}this._userInstancedBuffersStorage.vertexBuffers[a]?this._userInstancedBuffersStorage.vertexBuffers[a].updateDirectly(x,0):(this._userInstancedBuffersStorage.vertexBuffers[a]=new R.R(this.getEngine(),this._userInstancedBuffersStorage.data[a],a,!0,!1,N,!0),this._invalidateInstanceVertexArrayObject())}},Nt.prototype._invalidateInstanceVertexArrayObject=function(){if(this._userInstancedBuffersStorage&&void 0!==this._userInstancedBuffersStorage.vertexArrayObjects){for(const t in this._userInstancedBuffersStorage.vertexArrayObjects)this.getEngine().releaseVertexArrayObject(this._userInstancedBuffersStorage.vertexArrayObjects[t]);this._userInstancedBuffersStorage.vertexArrayObjects={}}},Nt.prototype._disposeInstanceSpecificData=function(){for(this._instanceDataStorage.instancesBuffer&&(this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null);this.instances.length;)this.instances[0].dispose();for(const t in this.instancedBuffers)this._userInstancedBuffersStorage.vertexBuffers[t]&&this._userInstancedBuffersStorage.vertexBuffers[t].dispose();this._invalidateInstanceVertexArrayObject(),this.instancedBuffers={}},J.Y5("BABYLON.InstancedMesh",ft);class $t extends St.d{}class Bt{constructor(){this.rootNodes=[],this.skeletons=[],this.animationGroups=[]}dispose(){this.rootNodes.slice(0).forEach((t=>{t.dispose()})),this.rootNodes.length=0,this.skeletons.slice(0).forEach((t=>{t.dispose()})),this.skeletons.length=0,this.animationGroups.slice(0).forEach((t=>{t.dispose()})),this.animationGroups.length=0}}class Ot extends St.d{constructor(t){super(),this._wasAddedToScene=!1,(t=t||$.q.LastCreatedScene)&&(this.scene=t,this["sounds"]=[],this["effectLayers"]=[],this["layers"]=[],this["lensFlareSystems"]=[],this["proceduralTextures"]=[],this["reflectionProbes"]=[],t.onDisposeObservable.add((()=>{this._wasAddedToScene||this.dispose()})),this._onContextRestoredObserver=t.getEngine().onContextRestoredObservable.add((()=>{for(const t of this.geometries)t._rebuild();for(const t of this.meshes)t._rebuild();for(const t of this.particleSystems)t.rebuild();for(const t of this.textures)t._rebuild()})))}_topologicalSort(t){const K=new Map;for(const D of t)K.set(D.uniqueId,D);const D={dependsOn:new Map,dependedBy:new Map};for(const K of t){const t=K.uniqueId;D.dependsOn.set(t,new Set),D.dependedBy.set(t,new Set)}for(const a of t){const t=a.uniqueId,G=D.dependsOn.get(t);if(a instanceof ft){const N=a.sourceMesh;K.has(N.uniqueId)&&(G.add(N.uniqueId),D.dependedBy.get(N.uniqueId).add(t))}const N=D.dependedBy.get(t);for(const G of a.getDescendants()){const a=G.uniqueId;K.has(a)&&(N.add(a),D.dependsOn.get(a).add(t))}}const a=[],G=[];for(const a of t){const t=a.uniqueId;0===D.dependsOn.get(t).size&&(G.push(a),K.delete(t))}const N=G;for(;N.length>0;){const t=N.shift();a.push(t);const G=D.dependedBy.get(t.uniqueId);for(const a of Array.from(G.values())){const G=D.dependsOn.get(a);G.delete(t.uniqueId),0===G.size&&K.get(a)&&(N.push(K.get(a)),K.delete(a))}}return K.size>0&&(i.V.Error("SceneSerializer._topologicalSort: There were unvisited nodes:"),K.forEach((t=>i.V.Error(t.name)))),a}_addNodeAndDescendantsToList(t,K,D,a){if(D&&(!a||a(D))&&!K.has(D.uniqueId)){t.push(D),K.add(D.uniqueId);for(const G of D.getDescendants(!0))this._addNodeAndDescendantsToList(t,K,G,a)}}_isNodeInContainer(t){return t instanceof v.u&&-1!==this.meshes.indexOf(t)||t instanceof Wt.V&&-1!==this.transformNodes.indexOf(t)||t instanceof H.v&&-1!==this.lights.indexOf(t)||t instanceof W.i&&-1!==this.cameras.indexOf(t)}_isValidHierarchy(){for(const t of this.meshes)if(t.parent&&!this._isNodeInContainer(t.parent))return i.V.Warn(`Node ${t.name} has a parent that is not in the container.`),!1;for(const t of this.transformNodes)if(t.parent&&!this._isNodeInContainer(t.parent))return i.V.Warn(`Node ${t.name} has a parent that is not in the container.`),!1;for(const t of this.lights)if(t.parent&&!this._isNodeInContainer(t.parent))return i.V.Warn(`Node ${t.name} has a parent that is not in the container.`),!1;for(const t of this.cameras)if(t.parent&&!this._isNodeInContainer(t.parent))return i.V.Warn(`Node ${t.name} has a parent that is not in the container.`),!1;return!0}instantiateModelsToScene(t,K=!1,D){this._isValidHierarchy()||m.S0.Warn("SceneSerializer.InstantiateModelsToScene: The Asset Container hierarchy is not valid.");const a={},G={},N=new Bt,W=[],x=[],b={doNotInstantiate:!0,...D},n=[],e=new Set;for(const t of this.transformNodes)null===t.parent&&this._addNodeAndDescendantsToList(n,e,t,b.predicate);for(const t of this.meshes)null===t.parent&&this._addNodeAndDescendantsToList(n,e,t,b.predicate);const i=this._topologicalSort(n),z=(D,W)=>{if(((K,D)=>{if(a[K.uniqueId]=D.uniqueId,G[D.uniqueId]=D,t&&(D.name=t(K.name)),D instanceof Nt){const t=D;if(t.morphTargetManager){const D=K.morphTargetManager;t.morphTargetManager=D.clone();for(let K=0;K<D.numTargets;K++){const N=D.getTarget(K),W=t.morphTargetManager.getTarget(K);a[N.uniqueId]=W.uniqueId,G[W.uniqueId]=W}}}})(D,W),D.parent){const t=a[D.parent.uniqueId],K=G[t];W.parent=K||D.parent}if(W.position&&D.position&&W.position.copyFrom(D.position),W.rotationQuaternion&&D.rotationQuaternion&&W.rotationQuaternion.copyFrom(D.rotationQuaternion),W.rotation&&D.rotation&&W.rotation.copyFrom(D.rotation),W.scaling&&D.scaling&&W.scaling.copyFrom(D.scaling),W.material){const N=W;if(N.material)if(K){const K=D.material;if(-1===x.indexOf(K)){let D=K.clone(t?t(K.name):"Clone of "+K.name);if(x.push(K),a[K.uniqueId]=D.uniqueId,G[D.uniqueId]=D,"MultiMaterial"===K.getClassName()){const N=K;for(const K of N.subMaterials)K&&(D=K.clone(t?t(K.name):"Clone of "+K.name),x.push(K),a[K.uniqueId]=D.uniqueId,G[D.uniqueId]=D);N.subMaterials=N.subMaterials.map((t=>t&&G[a[t.uniqueId]]))}}"InstancedMesh"!==N.getClassName()&&(N.material=G[a[K.uniqueId]])}else"MultiMaterial"===N.material.getClassName()?-1===this.scene.multiMaterials.indexOf(N.material)&&this.scene.addMultiMaterial(N.material):-1===this.scene.materials.indexOf(N.material)&&this.scene.addMaterial(N.material)}null===W.parent&&N.rootNodes.push(W)};return i.forEach((t=>{if("InstancedMesh"===t.getClassName()){const K=t,D=K.sourceMesh,N=a[D.uniqueId],W=("number"==typeof N?G[N]:D).createInstance(K.name);z(K,W)}else{let K=!0;"TransformNode"===t.getClassName()||"Node"===t.getClassName()||t.skeleton||!t.getTotalVertices||0===t.getTotalVertices()?K=!1:b.doNotInstantiate&&(K="function"==typeof b.doNotInstantiate?!b.doNotInstantiate(t):!b.doNotInstantiate);const D=K?t.createInstance(`instance of ${t.name}`):t.clone(`Clone of ${t.name}`,null,!0);if(!D)throw new Error(`Could not clone or instantiate node on Asset Container ${t.name}`);z(t,D)}})),this.skeletons.forEach((K=>{if(b.predicate&&!b.predicate(K))return;const D=K.clone(t?t(K.name):"Clone of "+K.name);for(const t of this.meshes)if(t.skeleton===K&&!t.isAnInstance){const K=G[a[t.uniqueId]];if(!K||K.isAnInstance)continue;if(K.skeleton=D,-1!==W.indexOf(D))continue;W.push(D);for(const t of D.bones)t._linkedTransformNode&&(t._linkedTransformNode=G[a[t._linkedTransformNode.uniqueId]])}N.skeletons.push(D)})),this.animationGroups.forEach((K=>{if(b.predicate&&!b.predicate(K))return;const D=K.clone(t?t(K.name):"Clone of "+K.name,(t=>G[a[t.uniqueId]]||t));N.animationGroups.push(D)})),N}addAllToScene(){if(!this._wasAddedToScene){this._isValidHierarchy()||m.S0.Warn("SceneSerializer.addAllToScene: The Asset Container hierarchy is not valid."),this._wasAddedToScene=!0,this.addToScene(null),this.environmentTexture&&(this.scene.environmentTexture=this.environmentTexture);for(const t of this.scene._serializableComponents)t.addFromContainer(this);this.scene.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null}}addToScene(t=null){const K=[];this.cameras.forEach((D=>{t&&!t(D)||(this.scene.addCamera(D),K.push(D))})),this.lights.forEach((D=>{t&&!t(D)||(this.scene.addLight(D),K.push(D))})),this.meshes.forEach((D=>{t&&!t(D)||(this.scene.addMesh(D),K.push(D))})),this.skeletons.forEach((K=>{t&&!t(K)||this.scene.addSkeleton(K)})),this.animations.forEach((K=>{t&&!t(K)||this.scene.addAnimation(K)})),this.animationGroups.forEach((K=>{t&&!t(K)||this.scene.addAnimationGroup(K)})),this.multiMaterials.forEach((K=>{t&&!t(K)||this.scene.addMultiMaterial(K)})),this.materials.forEach((K=>{t&&!t(K)||this.scene.addMaterial(K)})),this.morphTargetManagers.forEach((K=>{t&&!t(K)||this.scene.addMorphTargetManager(K)})),this.geometries.forEach((K=>{t&&!t(K)||this.scene.addGeometry(K)})),this.transformNodes.forEach((D=>{t&&!t(D)||(this.scene.addTransformNode(D),K.push(D))})),this.actionManagers.forEach((K=>{t&&!t(K)||this.scene.addActionManager(K)})),this.textures.forEach((K=>{t&&!t(K)||this.scene.addTexture(K)})),this.reflectionProbes.forEach((K=>{t&&!t(K)||this.scene.addReflectionProbe(K)}));for(const t of K)t.parent&&-1===this.scene.getNodes().indexOf(t.parent)&&(t.setParent?t.setParent(null):t.parent=null)}removeAllFromScene(){this._isValidHierarchy()||m.S0.Warn("SceneSerializer.removeAllFromScene: The Asset Container hierarchy is not valid."),this._wasAddedToScene=!1,this.removeFromScene(null),this.environmentTexture===this.scene.environmentTexture&&(this.scene.environmentTexture=null);for(const t of this.scene._serializableComponents)t.removeFromContainer(this)}removeFromScene(t=null){this.cameras.forEach((K=>{t&&!t(K)||this.scene.removeCamera(K)})),this.lights.forEach((K=>{t&&!t(K)||this.scene.removeLight(K)})),this.meshes.forEach((K=>{t&&!t(K)||this.scene.removeMesh(K,!0)})),this.skeletons.forEach((K=>{t&&!t(K)||this.scene.removeSkeleton(K)})),this.animations.forEach((K=>{t&&!t(K)||this.scene.removeAnimation(K)})),this.animationGroups.forEach((K=>{t&&!t(K)||this.scene.removeAnimationGroup(K)})),this.multiMaterials.forEach((K=>{t&&!t(K)||this.scene.removeMultiMaterial(K)})),this.materials.forEach((K=>{t&&!t(K)||this.scene.removeMaterial(K)})),this.morphTargetManagers.forEach((K=>{t&&!t(K)||this.scene.removeMorphTargetManager(K)})),this.geometries.forEach((K=>{t&&!t(K)||this.scene.removeGeometry(K)})),this.transformNodes.forEach((K=>{t&&!t(K)||this.scene.removeTransformNode(K)})),this.actionManagers.forEach((K=>{t&&!t(K)||this.scene.removeActionManager(K)})),this.textures.forEach((K=>{t&&!t(K)||this.scene.removeTexture(K)})),this.reflectionProbes.forEach((K=>{t&&!t(K)||this.scene.removeReflectionProbe(K)}))}dispose(){this.cameras.slice(0).forEach((t=>{t.dispose()})),this.cameras.length=0,this.lights.slice(0).forEach((t=>{t.dispose()})),this.lights.length=0,this.meshes.slice(0).forEach((t=>{t.dispose()})),this.meshes.length=0,this.skeletons.slice(0).forEach((t=>{t.dispose()})),this.skeletons.length=0,this.animationGroups.slice(0).forEach((t=>{t.dispose()})),this.animationGroups.length=0,this.multiMaterials.slice(0).forEach((t=>{t.dispose()})),this.multiMaterials.length=0,this.materials.slice(0).forEach((t=>{t.dispose()})),this.materials.length=0,this.geometries.slice(0).forEach((t=>{t.dispose()})),this.geometries.length=0,this.transformNodes.slice(0).forEach((t=>{t.dispose()})),this.transformNodes.length=0,this.actionManagers.slice(0).forEach((t=>{t.dispose()})),this.actionManagers.length=0,this.textures.slice(0).forEach((t=>{t.dispose()})),this.textures.length=0,this.reflectionProbes.slice(0).forEach((t=>{t.dispose()})),this.reflectionProbes.length=0,this.morphTargetManagers.slice(0).forEach((t=>{t.dispose()})),this.morphTargetManagers.length=0,this.environmentTexture&&(this.environmentTexture.dispose(),this.environmentTexture=null);for(const t of this.scene._serializableComponents)t.removeFromContainer(this,!0);this._onContextRestoredObserver&&(this.scene.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null)}_moveAssets(t,K,D){if(t&&K)for(const a of t){let t=!0;if(D)for(const K of D)if(a===K){t=!1;break}t&&(K.push(a),a._parentContainer=this)}}moveAllFromScene(t){this._wasAddedToScene=!1,void 0===t&&(t=new $t);for(const K in this)Object.prototype.hasOwnProperty.call(this,K)&&(this[K]=this[K]||("_environmentTexture"===K?null:[]),this._moveAssets(this.scene[K],this[K],t[K]));this.environmentTexture=this.scene.environmentTexture,this.removeAllFromScene()}createRootMesh(){const t=new Nt("assetContainerRootMesh",this.scene);return this.meshes.forEach((K=>{K.parent||t.addChild(K)})),this.meshes.unshift(t),t}mergeAnimationsTo(t=$.q.LastCreatedScene,K,D=null){if(!t)return i.V.Error("No scene available to merge animations to"),[];const a=D||(K=>{let D=null;const a=K.animations.length?K.animations[0].targetProperty:"",G=K.name.split(".").join("").split("_primitive")[0];switch(a){case"position":case"rotationQuaternion":D=t.getTransformNodeByName(K.name)||t.getTransformNodeByName(G);break;case"influence":D=t.getMorphTargetByName(K.name)||t.getMorphTargetByName(G);break;default:D=t.getNodeByName(K.name)||t.getNodeByName(G)}return D});this.getNodes().forEach((t=>{const K=a(t);if(null!==K){for(const D of t.animations){const t=K.animations.filter((t=>t.targetProperty===D.targetProperty));for(const D of t){const t=K.animations.indexOf(D,0);t>-1&&K.animations.splice(t,1)}}K.animations=K.animations.concat(t.animations)}}));const G=[];return this.animationGroups.slice().forEach((t=>{G.push(t.clone(t.name,a)),t.animatables.forEach((t=>{t.stop()}))})),K.forEach((K=>{const D=a(K.target);D&&(t.beginAnimation(D,K.fromFrame,K.toFrame,K.loopAnimation,K.speedRatio,K.onAnimationEnd?K.onAnimationEnd:void 0,void 0,!0,void 0,K.onAnimationLoop?K.onAnimationLoop:void 0),t.stopAnimation(K.target))})),G}populateRootNodes(){this.rootNodes.length=0,this.meshes.forEach((t=>{t.parent||-1!==this.rootNodes.indexOf(t)||this.rootNodes.push(t)})),this.transformNodes.forEach((t=>{t.parent||-1!==this.rootNodes.indexOf(t)||this.rootNodes.push(t)})),this.lights.forEach((t=>{t.parent||-1!==this.rootNodes.indexOf(t)||this.rootNodes.push(t)})),this.cameras.forEach((t=>{t.parent||-1!==this.rootNodes.indexOf(t)||this.rootNodes.push(t)}))}addAllAssetsToContainer(t){if(!t)return;const K=[],D=new Set;for(K.push(t);K.length>0;){const t=K.pop();if(t instanceof Nt?(t.geometry&&-1===this.geometries.indexOf(t.geometry)&&this.geometries.push(t.geometry),this.meshes.push(t)):t instanceof Wt.V?this.transformNodes.push(t):t instanceof H.v?this.lights.push(t):t instanceof W.i&&this.cameras.push(t),t instanceof v.u){if(t.material&&-1===this.materials.indexOf(t.material)){this.materials.push(t.material);for(const K of t.material.getActiveTextures())-1===this.textures.indexOf(K)&&this.textures.push(K)}t.skeleton&&-1===this.skeletons.indexOf(t.skeleton)&&this.skeletons.push(t.skeleton),t.morphTargetManager&&-1===this.morphTargetManagers.indexOf(t.morphTargetManager)&&this.morphTargetManagers.push(t.morphTargetManager)}for(const a of t.getChildren())D.has(a)||K.push(a);D.add(t)}this.populateRootNodes()}}class vt{constructor(t,K){this.triggerOptions=t,this.onBeforeExecuteObservable=new d.cP,t.parameter?(this.trigger=t.trigger,this._triggerParameter=t.parameter):t.trigger?this.trigger=t.trigger:this.trigger=t,this._nextActiveAction=this,this._condition=K}_prepare(){}getTriggerParameter(){return this._triggerParameter}setTriggerParameter(t){this._triggerParameter=t}_evaluateConditionForCurrentFrame(){const t=this._condition;if(!t)return!0;const K=this._actionManager.getScene().getRenderId();return t._evaluationId!==K&&(t._evaluationId=K,t._currentResult=t.isValid()),t._currentResult}_executeCurrent(t){this._evaluateConditionForCurrentFrame()&&(this.onBeforeExecuteObservable.notifyObservers(this),this._nextActiveAction.execute(t),this.skipToNextActiveAction())}execute(t){}skipToNextActiveAction(){this._nextActiveAction._child?(this._nextActiveAction._child._actionManager||(this._nextActiveAction._child._actionManager=this._actionManager),this._nextActiveAction=this._nextActiveAction._child):this._nextActiveAction=this}then(t){return this._child=t,t._actionManager=this._actionManager,t._prepare(),t}_getProperty(t){return this._actionManager._getProperty(t)}_getEffectiveTarget(t,K){return this._actionManager._getEffectiveTarget(t,K)}serialize(t){return null}_serialize(t,K){const D={type:1,children:[],name:t.name,properties:t.properties||[]};if(this._child&&this._child.serialize(D),this._condition){const t=this._condition.serialize();return t.children.push(D),K&&K.children.push(t),t}return K&&K.children.push(D),D}}vt._SerializeValueAsString=t=>"number"==typeof t?t.toString():"boolean"==typeof t?t?"true":"false":t instanceof N.I9?t.x+", "+t.y:t instanceof N.Pq?t.x+", "+t.y+", "+t.z:t instanceof s.v9?t.r+", "+t.g+", "+t.b:t instanceof s.ov?t.r+", "+t.g+", "+t.b+", "+t.a:t,vt._GetTargetProperty=t=>({name:"target",targetType:t._isMesh?"MeshProperties":t._isLight?"LightProperties":t._isCamera?"CameraProperties":t._isMaterial?"MaterialProperties":"SceneProperties",value:t._isScene?"Scene":t.name}),J.Y5("BABYLON.Action",vt);class pt{constructor(t){this._actionManager=t}isValid(){return!0}_getProperty(t){return this._actionManager._getProperty(t)}_getEffectiveTarget(t,K){return this._actionManager._getEffectiveTarget(t,K)}serialize(){}_serialize(t){return{type:2,children:[],name:t.name,properties:t.properties}}}class jt extends pt{static get IsEqual(){return jt._IsEqual}static get IsDifferent(){return jt._IsDifferent}static get IsGreater(){return jt._IsGreater}static get IsLesser(){return jt._IsLesser}constructor(t,K,D,a,G=jt.IsEqual){super(t),this.propertyPath=D,this.value=a,this.operator=G,this._target=K,this._effectiveTarget=this._getEffectiveTarget(K,this.propertyPath),this._property=this._getProperty(this.propertyPath)}isValid(){switch(this.operator){case jt.IsGreater:return this._effectiveTarget[this._property]>this.value;case jt.IsLesser:return this._effectiveTarget[this._property]<this.value;case jt.IsEqual:case jt.IsDifferent:{let t;return t=this.value.equals?this.value.equals(this._effectiveTarget[this._property]):this.value===this._effectiveTarget[this._property],this.operator===jt.IsEqual?t:!t}}return!1}serialize(){return this._serialize({name:"ValueCondition",properties:[vt._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:vt._SerializeValueAsString(this.value)},{name:"operator",value:jt.GetOperatorName(this.operator)}]})}static GetOperatorName(t){switch(t){case jt._IsEqual:return"IsEqual";case jt._IsDifferent:return"IsDifferent";case jt._IsGreater:return"IsGreater";case jt._IsLesser:return"IsLesser";default:return""}}}jt._IsEqual=0,jt._IsDifferent=1,jt._IsGreater=2,jt._IsLesser=3,J.Y5("BABYLON.ValueCondition",jt),J.Y5("BABYLON.PredicateCondition",class extends pt{constructor(t,K){super(t),this.predicate=K}isValid(){return this.predicate()}}),J.Y5("BABYLON.StateCondition",class extends pt{constructor(t,K,D){super(t),this.value=D,this._target=K}isValid(){return this._target.state===this.value}serialize(){return this._serialize({name:"StateCondition",properties:[vt._GetTargetProperty(this._target),{name:"value",value:this.value}]})}});class rt extends vt{constructor(t=0,K){super(t,K)}execute(){}serialize(t){return super._serialize({name:"DoNothingAction",properties:[]},t)}}class Mt extends vt{constructor(t,K,D,a){super(t,a),this._target=K,this._parent=D}_prepare(){}execute(){if(this._target.parent===this._parent)return;const t=this._parent.getWorldMatrix().clone();t.invert(),this._target.position=N.Pq.TransformCoordinates(this._target.position,t),this._target.parent=this._parent}serialize(t){return super._serialize({name:"SetParentAction",properties:[vt._GetTargetProperty(this._target),vt._GetTargetProperty(this._parent)]},t)}}J.Y5("BABYLON.SetParentAction",Mt),J.Y5("BABYLON.ExecuteCodeAction",class extends vt{constructor(t,K,D){super(t,D),this.func=K}execute(t){this.func(t)}}),J.Y5("BABYLON.DoNothingAction",rt),J.Y5("BABYLON.StopAnimationAction",class extends vt{constructor(t,K,D){super(t,D),this._target=K}_prepare(){}execute(){this._actionManager.getScene().stopAnimation(this._target)}serialize(t){return super._serialize({name:"StopAnimationAction",properties:[vt._GetTargetProperty(this._target)]},t)}}),J.Y5("BABYLON.PlayAnimationAction",class extends vt{constructor(t,K,D,a,G,N){super(t,N),this.from=D,this.to=a,this.loop=G,this._target=K}_prepare(){}execute(){this._actionManager.getScene().beginAnimation(this._target,this.from,this.to,this.loop)}serialize(t){return super._serialize({name:"PlayAnimationAction",properties:[vt._GetTargetProperty(this._target),{name:"from",value:String(this.from)},{name:"to",value:String(this.to)},{name:"loop",value:vt._SerializeValueAsString(this.loop)||!1}]},t)}}),J.Y5("BABYLON.IncrementValueAction",class extends vt{constructor(t,K,D,a,G){super(t,G),this.propertyPath=D,this.value=a,this._target=this._effectiveTarget=K}_prepare(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath),"number"!=typeof this._effectiveTarget[this._property]&&i.V.Warn("Warning: IncrementValueAction can only be used with number values")}execute(){this._effectiveTarget[this._property]+=this.value,this._target.markAsDirty&&this._target.markAsDirty(this._property)}serialize(t){return super._serialize({name:"IncrementValueAction",properties:[vt._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:vt._SerializeValueAsString(this.value)}]},t)}}),J.Y5("BABYLON.SetValueAction",class extends vt{constructor(t,K,D,a,G){super(t,G),this.propertyPath=D,this.value=a,this._target=this._effectiveTarget=K}_prepare(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath)}execute(){this._effectiveTarget[this._property]=this.value,this._target.markAsDirty&&this._target.markAsDirty(this._property)}serialize(t){return super._serialize({name:"SetValueAction",properties:[vt._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:vt._SerializeValueAsString(this.value)}]},t)}}),J.Y5("BABYLON.SetStateAction",class extends vt{constructor(t,K,D,a){super(t,a),this.value=D,this._target=K}execute(){this._target.state=this.value}serialize(t){return super._serialize({name:"SetStateAction",properties:[vt._GetTargetProperty(this._target),{name:"value",value:this.value}]},t)}}),J.Y5("BABYLON.SetParentAction",Mt),J.Y5("BABYLON.SwitchBooleanAction",class extends vt{constructor(t,K,D,a){super(t,a),this.propertyPath=D,this._target=this._effectiveTarget=K}_prepare(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath)}execute(){this._effectiveTarget[this._property]=!this._effectiveTarget[this._property]}serialize(t){return super._serialize({name:"SwitchBooleanAction",properties:[vt._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath}]},t)}}),J.Y5("BABYLON.CombineAction",class extends vt{constructor(t,K,D,a=!0){super(t,D),this.children=K,this.enableChildrenConditions=a}_prepare(){for(let t=0;t<this.children.length;t++)this.children[t]._actionManager=this._actionManager,this.children[t]._prepare()}execute(t){for(const K of this.children)this.enableChildrenConditions&&!K._evaluateConditionForCurrentFrame()||K.execute(t)}serialize(t){const K=super._serialize({name:"CombineAction",properties:[],combine:[]},t);for(let t=0;t<this.children.length;t++)K.combine.push(this.children[t].serialize(null));return K}});var kt=D(806630);class tK extends kt.G{constructor(t){super(),(t=t||$.q.LastCreatedScene)&&(this._scene=t,t.actionManagers.push(this))}dispose(){const t=this._scene.actionManagers.indexOf(this);for(let t=0;t<this.actions.length;t++){const K=this.actions[t];tK.Triggers[K.trigger]--,0===tK.Triggers[K.trigger]&&delete tK.Triggers[K.trigger]}this.actions.length=0,t>-1&&this._scene.actionManagers.splice(t,1);const K=this._scene.meshes.filter((t=>t.actionManager===this));for(const t of K)t.actionManager=null}getScene(){return this._scene}hasSpecificTriggers(t){for(let K=0;K<this.actions.length;K++){const D=this.actions[K];if(t.indexOf(D.trigger)>-1)return!0}return!1}hasSpecificTriggers2(t,K){for(let D=0;D<this.actions.length;D++){const a=this.actions[D];if(t==a.trigger||K==a.trigger)return!0}return!1}hasSpecificTrigger(t,K){for(let D=0;D<this.actions.length;D++){const a=this.actions[D];if(a.trigger===t){if(!K)return!0;if(K(a.getTriggerParameter()))return!0}}return!1}get hasPointerTriggers(){for(let t=0;t<this.actions.length;t++){const K=this.actions[t];if(K.trigger>=tK.OnPickTrigger&&K.trigger<=tK.OnPointerOutTrigger)return!0}return!1}get hasPickTriggers(){for(let t=0;t<this.actions.length;t++){const K=this.actions[t];if(K.trigger>=tK.OnPickTrigger&&K.trigger<=tK.OnPickUpTrigger)return!0}return!1}registerAction(t){return t.trigger===tK.OnEveryFrameTrigger&&this.getScene().actionManager!==this?(i.V.Warn("OnEveryFrameTrigger can only be used with scene.actionManager"),null):(this.actions.push(t),this.getScene()._registeredActions++,tK.Triggers[t.trigger]?tK.Triggers[t.trigger]++:tK.Triggers[t.trigger]=1,t._actionManager=this,t._prepare(),t)}unregisterAction(t){const K=this.actions.indexOf(t);return-1!==K&&(this.actions.splice(K,1),tK.Triggers[t.trigger]-=1,0===tK.Triggers[t.trigger]&&delete tK.Triggers[t.trigger],t._actionManager=null,this.getScene()._registeredActions--,!0)}processTrigger(t,K){for(let D=0;D<this.actions.length;D++){const a=this.actions[D];if(a.trigger===t){if(K&&(t===tK.OnKeyUpTrigger||t===tK.OnKeyDownTrigger)){const t=a.getTriggerParameter();if("function"==typeof t){if(!t(K))continue}else if(t&&t!==K.sourceEvent.keyCode){if(!t.toLowerCase)continue;const D=t.toLowerCase();if(D!==K.sourceEvent.key){const t=K.sourceEvent.charCode?K.sourceEvent.charCode:K.sourceEvent.keyCode;if(String.fromCharCode(t).toLowerCase()!==D)continue}}}a._executeCurrent(K)}}}_getEffectiveTarget(t,K){const D=K.split(".");for(let K=0;K<D.length-1;K++)t=t[D[K]];return t}_getProperty(t){const K=t.split(".");return K[K.length-1]}serialize(t){const K={children:new Array,name:t,type:3,properties:new Array};for(let t=0;t<this.actions.length;t++){const D={type:0,children:new Array,name:tK.GetTriggerName(this.actions[t].trigger),properties:new Array},a=this.actions[t].triggerOptions;if(a&&"number"!=typeof a)if(a.parameter instanceof Node)D.properties.push(vt._GetTargetProperty(a.parameter));else if("object"==typeof a.parameter){const t={};F.r.DeepCopy(a.parameter,t,["mesh"]),a.parameter&&a.parameter.mesh&&(t._meshId=a.parameter.mesh.id),D.properties.push({name:"parameter",targetType:null,value:t})}else D.properties.push({name:"parameter",targetType:null,value:a.parameter});this.actions[t].serialize(D),K.children.push(D)}return K}static Parse(t,K,D){const a=new tK(D);null===K?D.actionManager=a:K.actionManager=a;const G=(t,K,D,a)=>{if(null===a){const t=parseFloat(K);return"true"===K||"false"===K?"true"===K:isNaN(t)?K:t}const G=a.split("."),W=K.split(",");for(let t=0;t<G.length;t++)D=D[G[t]];if("boolean"==typeof D)return"true"===W[0];if("string"==typeof D)return W[0];const x=[];for(let t=0;t<W.length;t++)x.push(parseFloat(W[t]));return D instanceof N.Pq?N.Pq.FromArray(x):D instanceof N.IU?N.IU.FromArray(x):D instanceof s.v9?s.v9.FromArray(x):D instanceof s.ov?s.ov.FromArray(x):parseFloat(W[0])},W=(t,K,N,x,b=null)=>{if(t.detached)return;const n=[];let e=null,i=null;const z=t.combine&&t.combine.length>0;if(2===t.type?n.push(a):n.push(K),z){const K=[];for(let D=0;D<t.combine.length;D++)W(t.combine[D],tK.NothingTrigger,N,x,K);n.push(K)}else for(let K=0;K<t.properties.length;K++){let a=t.properties[K].value;const N=t.properties[K].name,W=t.properties[K].targetType;"target"===N?a=e="SceneProperties"===W?D:"MaterialProperties"===W?D.getMaterialByName(a):D.getNodeByName(a):"parent"===N?a=D.getNodeByName(a):"sound"===N?D.getSoundByName&&(a=D.getSoundByName(a)):"propertyPath"!==N?a=2===t.type&&"operator"===N?jt[a]:G(0,a,e,"value"===N?i:null):i=a,n.push(a)}if(null===b?n.push(N):n.push(null),"InterpolateValueAction"===t.name){const t=n[n.length-2];n[n.length-1]=t,n[n.length-2]=N}let I=((t,K)=>{const D=J.n9("BABYLON."+t);return D&&new D(...K)})(t.name,n);if(I instanceof pt&&null!==N){const t=new rt(K,N);x?x.then(t):a.registerAction(t),x=t}null===b?I instanceof pt?(N=I,I=x):(N=null,x?x.then(I):a.registerAction(I)):b.push(I);for(let D=0;D<t.children.length;D++)W(t.children[D],K,N,I,null)};for(let K=0;K<t.children.length;K++){let a;const G=t.children[K];if(G.properties.length>0){const t=G.properties[0].value,K=null===G.properties[0].targetType?t:D.getMeshByName(t);K._meshId&&(K.mesh=D.getMeshById(K._meshId)),a={trigger:tK[G.name],parameter:K}}else a=tK[G.name];for(let t=0;t<G.children.length;t++)G.detached||W(G.children[t],a,null,null)}}static GetTriggerName(t){switch(t){case 0:return"NothingTrigger";case 1:return"OnPickTrigger";case 2:return"OnLeftPickTrigger";case 3:return"OnRightPickTrigger";case 4:return"OnCenterPickTrigger";case 5:return"OnPickDownTrigger";case 6:return"OnDoublePickTrigger";case 7:return"OnPickUpTrigger";case 8:return"OnLongPressTrigger";case 9:return"OnPointerOverTrigger";case 10:return"OnPointerOutTrigger";case 11:return"OnEveryFrameTrigger";case 12:return"OnIntersectionEnterTrigger";case 13:return"OnIntersectionExitTrigger";case 14:return"OnKeyDownTrigger";case 15:return"OnKeyUpTrigger";case 16:return"OnPickOutTrigger";default:return""}}}tK.NothingTrigger=0,tK.OnPickTrigger=1,tK.OnLeftPickTrigger=2,tK.OnRightPickTrigger=3,tK.OnCenterPickTrigger=4,tK.OnPickDownTrigger=5,tK.OnDoublePickTrigger=6,tK.OnPickUpTrigger=7,tK.OnPickOutTrigger=16,tK.OnLongPressTrigger=8,tK.OnPointerOverTrigger=9,tK.OnPointerOutTrigger=10,tK.OnEveryFrameTrigger=11,tK.OnIntersectionEnterTrigger=12,tK.OnIntersectionExitTrigger=13,tK.OnKeyDownTrigger=14,tK.OnKeyUpTrigger=15;var KK=D(967872);class DK extends n.b{get _matrix(){return this._compose(),this._localMatrix}set _matrix(t){(t.updateFlag!==this._localMatrix.updateFlag||this._needToCompose)&&(this._needToCompose=!1,this._localMatrix.copyFrom(t),this._markAsDirtyAndDecompose())}constructor(t,K,D=null,a=null,G=null,W=null,x=null){var b;super(t,K.getScene(),!1),this.name=t,this.children=[],this.animations=[],this._index=null,this._scalingDeterminant=1,this._needToDecompose=!0,this._needToCompose=!1,this._linkedTransformNode=null,this._waitingTransformNodeId=null,this._skeleton=K,this._localMatrix=null!==(b=null==a?void 0:a.clone())&&void 0!==b?b:N.uq.Identity(),this._restMatrix=null!=G?G:this._localMatrix.clone(),this._bindMatrix=null!=W?W:this._localMatrix.clone(),this._index=x,this._absoluteMatrix=new N.uq,this._absoluteBindMatrix=new N.uq,this._absoluteInverseBindMatrix=new N.uq,this._finalMatrix=new N.uq,K.bones.push(this),this.setParent(D,!1),this._updateAbsoluteBindMatrices()}getClassName(){return"Bone"}getSkeleton(){return this._skeleton}get parent(){return this._parentNode}getParent(){return this.parent}getChildren(){return this.children}getIndex(){return null===this._index?this.getSkeleton().bones.indexOf(this):this._index}set parent(t){this.setParent(t)}setParent(t,K=!0){if(this.parent!==t){if(this.parent){const t=this.parent.children.indexOf(this);-1!==t&&this.parent.children.splice(t,1)}this._parentNode=t,this.parent&&this.parent.children.push(this),K&&this._updateAbsoluteBindMatrices(),this.markAsDirty()}}getLocalMatrix(){return this._compose(),this._localMatrix}getBindMatrix(){return this._bindMatrix}getBaseMatrix(){return this.getBindMatrix()}getRestMatrix(){return this._restMatrix}getRestPose(){return this.getRestMatrix()}setRestMatrix(t){this._restMatrix.copyFrom(t)}setRestPose(t){this.setRestMatrix(t)}getBindPose(){return this.getBindMatrix()}setBindMatrix(t){this.updateMatrix(t)}setBindPose(t){this.setBindMatrix(t)}getFinalMatrix(){return this._finalMatrix}getWorldMatrix(){return this.getFinalMatrix()}returnToRest(){var t;if(this._linkedTransformNode){const K=N.AA.Vector3[0],D=N.AA.Quaternion[0],a=N.AA.Vector3[1];this.getRestMatrix().decompose(K,D,a),this._linkedTransformNode.position.copyFrom(a),this._linkedTransformNode.rotationQuaternion=null!==(t=this._linkedTransformNode.rotationQuaternion)&&void 0!==t?t:N.PT.Identity(),this._linkedTransformNode.rotationQuaternion.copyFrom(D),this._linkedTransformNode.scaling.copyFrom(K)}else this._matrix=this._restMatrix}getAbsoluteInverseBindMatrix(){return this._absoluteInverseBindMatrix}getInvertedAbsoluteTransform(){return this.getAbsoluteInverseBindMatrix()}getAbsoluteMatrix(){return this._absoluteMatrix}getAbsoluteTransform(){return this._absoluteMatrix}linkTransformNode(t){this._linkedTransformNode&&this._skeleton._numBonesWithLinkedTransformNode--,this._linkedTransformNode=t,this._linkedTransformNode&&this._skeleton._numBonesWithLinkedTransformNode++}getTransformNode(){return this._linkedTransformNode}get position(){return this._decompose(),this._localPosition}set position(t){this._decompose(),this._localPosition.copyFrom(t),this._markAsDirtyAndCompose()}get rotation(){return this.getRotation()}set rotation(t){this.setRotation(t)}get rotationQuaternion(){return this._decompose(),this._localRotation}set rotationQuaternion(t){this.setRotationQuaternion(t)}get scaling(){return this.getScale()}set scaling(t){this.setScale(t)}get animationPropertiesOverride(){return this._skeleton.animationPropertiesOverride}_decompose(){this._needToDecompose&&(this._needToDecompose=!1,this._localScaling||(this._localScaling=N.Pq.Zero(),this._localRotation=N.PT.Zero(),this._localPosition=N.Pq.Zero()),this._localMatrix.decompose(this._localScaling,this._localRotation,this._localPosition))}_compose(){this._needToCompose&&(this._localScaling?(this._needToCompose=!1,N.uq.ComposeToRef(this._localScaling,this._localRotation,this._localPosition,this._localMatrix)):this._needToCompose=!1)}updateMatrix(t,K=!0,D=!0){this._bindMatrix.copyFrom(t),K&&this._updateAbsoluteBindMatrices(),D?this._matrix=t:this.markAsDirty()}_updateAbsoluteBindMatrices(t,K=!0){if(t||(t=this._bindMatrix),this.parent?t.multiplyToRef(this.parent._absoluteBindMatrix,this._absoluteBindMatrix):this._absoluteBindMatrix.copyFrom(t),this._absoluteBindMatrix.invertToRef(this._absoluteInverseBindMatrix),K)for(let t=0;t<this.children.length;t++)this.children[t]._updateAbsoluteBindMatrices();this._scalingDeterminant=this._absoluteBindMatrix.determinant()<0?-1:1}markAsDirty(){return this._currentRenderId++,this._childUpdateId++,this._skeleton._markAsDirty(),this}_markAsDirtyAndCompose(){this.markAsDirty(),this._needToCompose=!0}_markAsDirtyAndDecompose(){this.markAsDirty(),this._needToDecompose=!0}_updatePosition(t,K=0,D,a=!0){const G=this.getLocalMatrix();if(0==K)a?(G.addAtIndex(12,t.x),G.addAtIndex(13,t.y),G.addAtIndex(14,t.z)):G.setTranslationFromFloats(t.x,t.y,t.z);else{let K=null;D&&(K=D.getWorldMatrix()),this._skeleton.computeAbsoluteMatrices();const W=DK._TmpMats[0],x=DK._TmpVecs[0];this.parent?D&&K?(W.copyFrom(this.parent.getAbsoluteMatrix()),W.multiplyToRef(K,W)):W.copyFrom(this.parent.getAbsoluteMatrix()):N.uq.IdentityToRef(W),a&&W.setTranslationFromFloats(0,0,0),W.invert(),N.Pq.TransformCoordinatesToRef(t,W,x),a?(G.addAtIndex(12,x.x),G.addAtIndex(13,x.y),G.addAtIndex(14,x.z)):G.setTranslationFromFloats(x.x,x.y,x.z)}this._markAsDirtyAndDecompose()}translate(t,K=0,D){this._updatePosition(t,K,D,!0)}setPosition(t,K=0,D){this._updatePosition(t,K,D,!1)}setAbsolutePosition(t,K){this.setPosition(t,1,K)}scale(t,K,D,a=!1){const G=this.getLocalMatrix(),W=DK._TmpMats[0];N.uq.ScalingToRef(t,K,D,W),W.multiplyToRef(G,G),W.invert();for(const a of this.children){const G=a.getLocalMatrix();G.multiplyToRef(W,G),G.multiplyAtIndex(12,t),G.multiplyAtIndex(13,K),G.multiplyAtIndex(14,D),a._markAsDirtyAndDecompose()}if(this._markAsDirtyAndDecompose(),a)for(const G of this.children)G.scale(t,K,D,a)}setScale(t){this._decompose(),this._localScaling.copyFrom(t),this._markAsDirtyAndCompose()}getScale(){return this._decompose(),this._localScaling}getScaleToRef(t){this._decompose(),t.copyFrom(this._localScaling)}setYawPitchRoll(t,K,D,a=0,G){if(0===a){const W=DK._TmpQuat;return N.PT.RotationYawPitchRollToRef(t,K,D,W),void this.setRotationQuaternion(W,a,G)}const W=DK._TmpMats[0];if(!this._getAbsoluteInverseMatrixUnscaledToRef(W,G))return;const x=DK._TmpMats[1];N.uq.RotationYawPitchRollToRef(t,K,D,x),W.multiplyToRef(x,x),this._rotateWithMatrix(x,a,G)}rotate(t,K,D=0,a){const G=DK._TmpMats[0];G.setTranslationFromFloats(0,0,0),N.uq.RotationAxisToRef(t,K,G),this._rotateWithMatrix(G,D,a)}setAxisAngle(t,K,D=0,a){if(0===D){const G=DK._TmpQuat;return N.PT.RotationAxisToRef(t,K,G),void this.setRotationQuaternion(G,D,a)}const G=DK._TmpMats[0];if(!this._getAbsoluteInverseMatrixUnscaledToRef(G,a))return;const W=DK._TmpMats[1];N.uq.RotationAxisToRef(t,K,W),G.multiplyToRef(W,W),this._rotateWithMatrix(W,D,a)}setRotation(t,K=0,D){this.setYawPitchRoll(t.y,t.x,t.z,K,D)}setRotationQuaternion(t,K=0,D){if(0===K)return this._decompose(),this._localRotation.copyFrom(t),void this._markAsDirtyAndCompose();const a=DK._TmpMats[0];if(!this._getAbsoluteInverseMatrixUnscaledToRef(a,D))return;const G=DK._TmpMats[1];N.uq.FromQuaternionToRef(t,G),a.multiplyToRef(G,G),this._rotateWithMatrix(G,K,D)}setRotationMatrix(t,K=0,D){if(0===K){const a=DK._TmpQuat;return N.PT.FromRotationMatrixToRef(t,a),void this.setRotationQuaternion(a,K,D)}const a=DK._TmpMats[0];if(!this._getAbsoluteInverseMatrixUnscaledToRef(a,D))return;const G=DK._TmpMats[1];G.copyFrom(t),a.multiplyToRef(t,G),this._rotateWithMatrix(G,K,D)}_rotateWithMatrix(t,K=0,D){const a=this.getLocalMatrix(),G=a.m[12],N=a.m[13],W=a.m[14],x=this.getParent(),b=DK._TmpMats[3],n=DK._TmpMats[4];x&&1==K?(D?(b.copyFrom(D.getWorldMatrix()),x.getAbsoluteMatrix().multiplyToRef(b,b)):b.copyFrom(x.getAbsoluteMatrix()),n.copyFrom(b),n.invert(),a.multiplyToRef(b,a),a.multiplyToRef(t,a),a.multiplyToRef(n,a)):1==K&&D?(b.copyFrom(D.getWorldMatrix()),n.copyFrom(b),n.invert(),a.multiplyToRef(b,a),a.multiplyToRef(t,a),a.multiplyToRef(n,a)):a.multiplyToRef(t,a),a.setTranslationFromFloats(G,N,W),this.computeAbsoluteMatrices(),this._markAsDirtyAndDecompose()}_getAbsoluteInverseMatrixUnscaledToRef(t,K){const D=DK._TmpMats[2];return t.copyFrom(this.getAbsoluteMatrix()),K?(t.multiplyToRef(K.getWorldMatrix(),t),N.uq.ScalingToRef(K.scaling.x,K.scaling.y,K.scaling.z,D)):N.uq.IdentityToRef(D),t.invert(),!isNaN(t.m[0])&&(D.multiplyAtIndex(0,this._scalingDeterminant),t.multiplyToRef(D,t),!0)}getPosition(t=0,K=null){const D=N.Pq.Zero();return this.getPositionToRef(t,K,D),D}getPositionToRef(t=0,K,D){if(0==t){const t=this.getLocalMatrix();D.x=t.m[12],D.y=t.m[13],D.z=t.m[14]}else{let t=null;K&&(t=K.getWorldMatrix()),this._skeleton.computeAbsoluteMatrices();let a=DK._TmpMats[0];K&&t?(a.copyFrom(this.getAbsoluteMatrix()),a.multiplyToRef(t,a)):a=this.getAbsoluteMatrix(),D.x=a.m[12],D.y=a.m[13],D.z=a.m[14]}}getAbsolutePosition(t=null){const K=N.Pq.Zero();return this.getPositionToRef(1,t,K),K}getAbsolutePositionToRef(t,K){this.getPositionToRef(1,t,K)}computeAbsoluteMatrices(){if(this._compose(),this.parent)this._localMatrix.multiplyToRef(this.parent._absoluteMatrix,this._absoluteMatrix);else{this._absoluteMatrix.copyFrom(this._localMatrix);const t=this._skeleton.getPoseMatrix();t&&this._absoluteMatrix.multiplyToRef(t,this._absoluteMatrix)}const t=this.children,K=t.length;for(let D=0;D<K;D++)t[D].computeAbsoluteMatrices()}computeAbsoluteTransforms(){this.computeAbsoluteMatrices()}getDirection(t,K=null){const D=N.Pq.Zero();return this.getDirectionToRef(t,K,D),D}getDirectionToRef(t,K=null,D){let a=null;K&&(a=K.getWorldMatrix()),this._skeleton.computeAbsoluteMatrices();const G=DK._TmpMats[0];G.copyFrom(this.getAbsoluteMatrix()),K&&a&&G.multiplyToRef(a,G),N.Pq.TransformNormalToRef(t,G,D),D.normalize()}getRotation(t=0,K=null){const D=N.Pq.Zero();return this.getRotationToRef(t,K,D),D}getRotationToRef(t=0,K=null,D){const a=DK._TmpQuat;this.getRotationQuaternionToRef(t,K,a),a.toEulerAnglesToRef(D)}getRotationQuaternion(t=0,K=null){const D=N.PT.Identity();return this.getRotationQuaternionToRef(t,K,D),D}getRotationQuaternionToRef(t=0,K=null,D){if(0==t)this._decompose(),D.copyFrom(this._localRotation);else{const t=DK._TmpMats[0],a=this.getAbsoluteMatrix();K?a.multiplyToRef(K.getWorldMatrix(),t):t.copyFrom(a),t.multiplyAtIndex(0,this._scalingDeterminant),t.multiplyAtIndex(1,this._scalingDeterminant),t.multiplyAtIndex(2,this._scalingDeterminant),t.decompose(void 0,D,void 0)}}getRotationMatrix(t=0,K){const D=N.uq.Identity();return this.getRotationMatrixToRef(t,K,D),D}getRotationMatrixToRef(t=0,K,D){if(0==t)this.getLocalMatrix().getRotationMatrixToRef(D);else{const t=DK._TmpMats[0],a=this.getAbsoluteMatrix();K?a.multiplyToRef(K.getWorldMatrix(),t):t.copyFrom(a),t.multiplyAtIndex(0,this._scalingDeterminant),t.multiplyAtIndex(1,this._scalingDeterminant),t.multiplyAtIndex(2,this._scalingDeterminant),t.getRotationMatrixToRef(D)}}getAbsolutePositionFromLocal(t,K=null){const D=N.Pq.Zero();return this.getAbsolutePositionFromLocalToRef(t,K,D),D}getAbsolutePositionFromLocalToRef(t,K=null,D){let a=null;K&&(a=K.getWorldMatrix()),this._skeleton.computeAbsoluteMatrices();const G=DK._TmpMats[0];G.copyFrom(this.getAbsoluteMatrix()),K&&a&&G.multiplyToRef(a,G),N.Pq.TransformCoordinatesToRef(t,G,D)}getLocalPositionFromAbsolute(t,K=null){const D=N.Pq.Zero();return this.getLocalPositionFromAbsoluteToRef(t,K,D),D}getLocalPositionFromAbsoluteToRef(t,K=null,D){let a=null;K&&(a=K.getWorldMatrix()),this._skeleton.computeAbsoluteMatrices();const G=DK._TmpMats[0];G.copyFrom(this.getAbsoluteMatrix()),K&&a&&G.multiplyToRef(a,G),G.invert(),N.Pq.TransformCoordinatesToRef(t,G,D)}setCurrentPoseAsRest(){this.setRestMatrix(this.getLocalMatrix())}}DK._TmpVecs=KK.mI(2,N.Pq.Zero),DK._TmpQuat=N.PT.Identity(),DK._TmpMats=KK.mI(5,N.uq.Identity);class aK extends U.g{constructor(t,K,D,a,G,N=!0,W=!1,x=3,b=0,n,e){super(null,G,!N,W,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,n),this.format=a,this._engine&&(this._engine._caps.textureFloatLinearFiltering||1!==b||(x=1),this._engine._caps.textureHalfFloatLinearFiltering||2!==b||(x=1),this._texture=this._engine.createRawTexture(t,K,D,a,N,W,x,null,b,null!=n?n:0,null!=e&&e),this.wrapU=U.g.CLAMP_ADDRESSMODE,this.wrapV=U.g.CLAMP_ADDRESSMODE)}update(t){this._getEngine().updateRawTexture(this._texture,t,this._texture.format,this._texture.invertY,null,this._texture.type,this._texture._useSRGBBuffer)}clone(){if(!this._texture)return super.clone();const t=new aK(null,this.getSize().width,this.getSize().height,this.format,this.getScene(),this._texture.generateMipMaps,this._invertY,this.samplingMode,this._texture.type,this._texture._creationFlags,this._useSRGBBuffer);return t._texture=this._texture,this._texture.incrementReferences(),t}static CreateLuminanceTexture(t,K,D,a,G=!0,N=!1,W=3){return new aK(t,K,D,1,a,G,N,W)}static CreateLuminanceAlphaTexture(t,K,D,a,G=!0,N=!1,W=3){return new aK(t,K,D,2,a,G,N,W)}static CreateAlphaTexture(t,K,D,a,G=!0,N=!1,W=3){return new aK(t,K,D,0,a,G,N,W)}static CreateRGBTexture(t,K,D,a,G=!0,N=!1,W=3,x=0,b=0,n=!1){return new aK(t,K,D,4,a,G,N,W,x,b,n)}static CreateRGBATexture(t,K,D,a,G=!0,N=!1,W=3,x=0,b=0,n=!1){return new aK(t,K,D,5,a,G,N,W,x,b,n)}static CreateRGBAStorageTexture(t,K,D,a,G=!0,N=!1,W=3,x=0,b=!1){return new aK(t,K,D,5,a,G,N,W,x,1,b)}static CreateRTexture(t,K,D,a,G=!0,N=!1,W=U.g.TRILINEAR_SAMPLINGMODE,x=1){return new aK(t,K,D,6,a,G,N,W,x)}static CreateRStorageTexture(t,K,D,a,G=!0,N=!1,W=U.g.TRILINEAR_SAMPLINGMODE,x=1){return new aK(t,K,D,6,a,G,N,W,x,1)}}class GK{get useTextureToStoreBoneMatrices(){return this._useTextureToStoreBoneMatrices}set useTextureToStoreBoneMatrices(t){this._useTextureToStoreBoneMatrices=t,this._markAsDirty()}get animationPropertiesOverride(){return this._animationPropertiesOverride?this._animationPropertiesOverride:this._scene.animationPropertiesOverride}set animationPropertiesOverride(t){this._animationPropertiesOverride=t}get isUsingTextureForMatrices(){return this.useTextureToStoreBoneMatrices&&this._canUseTextureForBones}get uniqueId(){return this._uniqueId}constructor(t,K,D){this.name=t,this.id=K,this.bones=[],this.needInitialSkinMatrix=!1,this._isDirty=!0,this._meshesWithPoseMatrix=new Array,this._identity=N.uq.Identity(),this._currentRenderId=-1,this._ranges={},this._absoluteTransformIsDirty=!0,this._canUseTextureForBones=!1,this._uniqueId=0,this._numBonesWithLinkedTransformNode=0,this._hasWaitingData=null,this._parentContainer=null,this.doNotSerialize=!1,this._useTextureToStoreBoneMatrices=!0,this._animationPropertiesOverride=null,this.onBeforeComputeObservable=new d.cP,this.bones=[],this._scene=D||$.q.LastCreatedScene,this._uniqueId=this._scene.getUniqueId(),this._scene.addSkeleton(this),this._isDirty=!0;const a=this._scene.getEngine().getCaps();this._canUseTextureForBones=a.textureFloat&&a.maxVertexTextureImageUnits>0}getClassName(){return"Skeleton"}getChildren(){return this.bones.filter((t=>!t.getParent()))}getTransformMatrices(t){if(this.needInitialSkinMatrix){if(!t)throw new Error("getTransformMatrices: When using the needInitialSkinMatrix flag, a mesh must be provided");return t._bonesTransformMatrices||this.prepare(!0),t._bonesTransformMatrices}return this._transformMatrices&&!this._isDirty||this.prepare(!this._transformMatrices),this._transformMatrices}getTransformMatrixTexture(t){return this.needInitialSkinMatrix&&t._transformMatrixTexture?t._transformMatrixTexture:this._transformMatrixTexture}getScene(){return this._scene}toString(t){let K=`Name: ${this.name}, nBones: ${this.bones.length}`;if(K+=`, nAnimationRanges: ${this._ranges?Object.keys(this._ranges).length:"none"}`,t){K+=", Ranges: {";let t=!0;for(const D in this._ranges)t&&(K+=", ",t=!1),K+=D;K+="}"}return K}getBoneIndexByName(t){for(let K=0,D=this.bones.length;K<D;K++)if(this.bones[K].name===t)return K;return-1}createAnimationRange(t,K,D){if(!this._ranges[t]){this._ranges[t]=new _t(t,K,D);for(let a=0,G=this.bones.length;a<G;a++)this.bones[a].animations[0]&&this.bones[a].animations[0].createRange(t,K,D)}}deleteAnimationRange(t,K=!0){for(let D=0,a=this.bones.length;D<a;D++)this.bones[D].animations[0]&&this.bones[D].animations[0].deleteRange(t,K);this._ranges[t]=null}getAnimationRange(t){return this._ranges[t]||null}getAnimationRanges(){const t=[];let K;for(K in this._ranges)t.push(this._ranges[K]);return t}copyAnimationRange(t,K,D=!1){if(this._ranges[K]||!t.getAnimationRange(K))return!1;let a=!0;const G=this._getHighestAnimationFrame()+1,N={},W=t.bones;let x,b;for(b=0,x=W.length;b<x;b++)N[W[b].name]=W[b];this.bones.length!==W.length&&(i.V.Warn(`copyAnimationRange: this rig has ${this.bones.length} bones, while source as ${W.length}`),a=!1);const n=D&&this.dimensionsAtRest&&t.dimensionsAtRest?this.dimensionsAtRest.divide(t.dimensionsAtRest):null;for(b=0,x=this.bones.length;b<x;b++){const t=this.bones[b].name,W=N[t];W?a=a&&this.bones[b].copyAnimationRange(W,K,G,D,n):(i.V.Warn("copyAnimationRange: not same rig, missing source bone "+t),a=!1)}const e=t.getAnimationRange(K);return e&&(this._ranges[K]=new _t(K,e.from+G,e.to+G)),a}returnToRest(){for(const t of this.bones)-1!==t._index&&t.returnToRest()}_getHighestAnimationFrame(){let t=0;for(let K=0,D=this.bones.length;K<D;K++)if(this.bones[K].animations[0]){const D=this.bones[K].animations[0].getHighestFrame();t<D&&(t=D)}return t}beginAnimation(t,K,D,a){const G=this.getAnimationRange(t);return G?this._scene.beginAnimation(this,G.from,G.to,K,D,a):null}static MakeAnimationAdditive(t,K=0,D){const a=t.getAnimationRange(D);if(!a)return null;const G=t._scene.getAllAnimatablesByTarget(t);let N=null;for(let t=0;t<G.length;t++){const K=G[t];if(K.fromFrame===(null==a?void 0:a.from)&&K.toFrame===(null==a?void 0:a.to)){N=K;break}}const W=t.getAnimatables();for(let t=0;t<W.length;t++){const a=W[t].animations;if(a)for(let t=0;t<a.length;t++)Rt.MakeAnimationAdditive(a[t],K,D)}return N&&(N.isAdditive=!0),t}_markAsDirty(){this._isDirty=!0,this._absoluteTransformIsDirty=!0}_registerMeshWithPoseMatrix(t){this._meshesWithPoseMatrix.push(t)}_unregisterMeshWithPoseMatrix(t){const K=this._meshesWithPoseMatrix.indexOf(t);K>-1&&this._meshesWithPoseMatrix.splice(K,1)}_computeTransformMatrices(t,K){this.onBeforeComputeObservable.notifyObservers(this);for(let D=0;D<this.bones.length;D++){const a=this.bones[D];a._childUpdateId++;const G=a.getParent();if(G?a.getLocalMatrix().multiplyToRef(G.getFinalMatrix(),a.getFinalMatrix()):K?a.getLocalMatrix().multiplyToRef(K,a.getFinalMatrix()):a.getFinalMatrix().copyFrom(a.getLocalMatrix()),-1!==a._index){const K=null===a._index?D:a._index;a.getAbsoluteInverseBindMatrix().multiplyToArray(a.getFinalMatrix(),t,16*K)}}this._identity.copyToArray(t,16*this.bones.length)}prepare(t=!1){if(!t){const t=this.getScene().getRenderId();if(this._currentRenderId===t)return;this._currentRenderId=t}if(this._numBonesWithLinkedTransformNode>0)for(const t of this.bones)if(t._linkedTransformNode){const K=t._linkedTransformNode;t.position=K.position,K.rotationQuaternion?t.rotationQuaternion=K.rotationQuaternion:t.rotation=K.rotation,t.scaling=K.scaling}if(this.needInitialSkinMatrix)for(const t of this._meshesWithPoseMatrix){const K=t.getPoseMatrix();let D=this._isDirty;if(t._bonesTransformMatrices&&t._bonesTransformMatrices.length===16*(this.bones.length+1)||(t._bonesTransformMatrices=new Float32Array(16*(this.bones.length+1)),D=!0),D){if(this._synchronizedWithMesh!==t){this._synchronizedWithMesh=t;for(const t of this.bones)t.getParent()||(t.getBindMatrix().multiplyToRef(K,N.AA.Matrix[1]),t._updateAbsoluteBindMatrices(N.AA.Matrix[1]));if(this.isUsingTextureForMatrices){const K=4*(this.bones.length+1);t._transformMatrixTexture&&t._transformMatrixTexture.getSize().width===K||(t._transformMatrixTexture&&t._transformMatrixTexture.dispose(),t._transformMatrixTexture=aK.CreateRGBATexture(t._bonesTransformMatrices,4*(this.bones.length+1),1,this._scene,!1,!1,1,1))}}this._computeTransformMatrices(t._bonesTransformMatrices,K),this.isUsingTextureForMatrices&&t._transformMatrixTexture&&t._transformMatrixTexture.update(t._bonesTransformMatrices)}}else{if(!this._isDirty)return;this._transformMatrices&&this._transformMatrices.length===16*(this.bones.length+1)||(this._transformMatrices=new Float32Array(16*(this.bones.length+1)),this.isUsingTextureForMatrices&&(this._transformMatrixTexture&&this._transformMatrixTexture.dispose(),this._transformMatrixTexture=aK.CreateRGBATexture(this._transformMatrices,4*(this.bones.length+1),1,this._scene,!1,!1,1,1))),this._computeTransformMatrices(this._transformMatrices,null),this.isUsingTextureForMatrices&&this._transformMatrixTexture&&this._transformMatrixTexture.update(this._transformMatrices)}this._isDirty=!1}getAnimatables(){if(!this._animatables||this._animatables.length!==this.bones.length){this._animatables=[];for(let t=0;t<this.bones.length;t++)this._animatables.push(this.bones[t])}return this._animatables}clone(t,K){const D=new GK(t,K||t,this._scene);D.needInitialSkinMatrix=this.needInitialSkinMatrix;for(let t=0;t<this.bones.length;t++){const K=this.bones[t];let a=null;const G=K.getParent();if(G){const t=this.bones.indexOf(G);a=D.bones[t]}const N=new DK(K.name,D,a,K.getBindMatrix().clone(),K.getRestMatrix().clone());N._index=K._index,K._linkedTransformNode&&N.linkTransformNode(K._linkedTransformNode),F.r.DeepCopy(K.animations,N.animations)}if(this._ranges){D._ranges={};for(const t in this._ranges){const K=this._ranges[t];K&&(D._ranges[t]=K.clone())}}return this._isDirty=!0,D.prepare(!0),D}enableBlending(t=.01){this.bones.forEach((K=>{K.animations.forEach((K=>{K.enableBlending=!0,K.blendingSpeed=t}))}))}dispose(){if(this._meshesWithPoseMatrix.length=0,this.getScene().stopAnimation(this),this.getScene().removeSkeleton(this),this._parentContainer){const t=this._parentContainer.skeletons.indexOf(this);t>-1&&this._parentContainer.skeletons.splice(t,1),this._parentContainer=null}this._transformMatrixTexture&&(this._transformMatrixTexture.dispose(),this._transformMatrixTexture=null)}serialize(){var t;const K={};K.name=this.name,K.id=this.id,this.dimensionsAtRest&&(K.dimensionsAtRest=this.dimensionsAtRest.asArray()),K.bones=[],K.needInitialSkinMatrix=this.needInitialSkinMatrix;for(let D=0;D<this.bones.length;D++){const a=this.bones[D],G=a.getParent(),N={parentBoneIndex:G?this.bones.indexOf(G):-1,index:a.getIndex(),name:a.name,id:a.id,matrix:a.getBindMatrix().asArray(),rest:a.getRestMatrix().asArray(),linkedTransformNodeId:null===(t=a.getTransformNode())||void 0===t?void 0:t.id};K.bones.push(N),a.length&&(N.length=a.length),a.metadata&&(N.metadata=a.metadata),a.animations&&a.animations.length>0&&(N.animation=a.animations[0].serialize()),K.ranges=[];for(const t in this._ranges){const D=this._ranges[t];if(!D)continue;const a={};a.name=t,a.from=D.from,a.to=D.to,K.ranges.push(a)}}return K}static Parse(t,K){const D=new GK(t.name,t.id,K);let a;for(t.dimensionsAtRest&&(D.dimensionsAtRest=N.Pq.FromArray(t.dimensionsAtRest)),D.needInitialSkinMatrix=t.needInitialSkinMatrix,a=0;a<t.bones.length;a++){const K=t.bones[a],G=t.bones[a].index;let W=null;K.parentBoneIndex>-1&&(W=D.bones[K.parentBoneIndex]);const x=K.rest?N.uq.FromArray(K.rest):null,b=new DK(K.name,D,W,N.uq.FromArray(K.matrix),x,null,G);void 0!==K.id&&null!==K.id&&(b.id=K.id),K.length&&(b.length=K.length),K.metadata&&(b.metadata=K.metadata),K.animation&&b.animations.push(Rt.Parse(K.animation)),void 0!==K.linkedTransformNodeId&&null!==K.linkedTransformNodeId&&(D._hasWaitingData=!0,b._waitingTransformNodeId=K.linkedTransformNodeId)}if(t.ranges)for(a=0;a<t.ranges.length;a++){const K=t.ranges[a];D.createAnimationRange(K.name,K.from,K.to)}return D}computeAbsoluteMatrices(t=!1){(this._absoluteTransformIsDirty||t)&&(this.bones[0].computeAbsoluteMatrices(),this._absoluteTransformIsDirty=!1)}computeAbsoluteTransforms(t=!1){this.computeAbsoluteMatrices(t)}getPoseMatrix(){let t=null;return this._meshesWithPoseMatrix.length>0&&(t=this._meshesWithPoseMatrix[0].getPoseMatrix()),t}sortBones(){const t=[],K=new Array(this.bones.length);for(let D=0;D<this.bones.length;D++)this._sortBones(D,t,K);this.bones=t}_sortBones(t,K,D){if(D[t])return;D[t]=!0;const a=this.bones[t];if(!a)return;void 0===a._index&&(a._index=t);const G=a.getParent();G&&this._sortBones(this.bones.indexOf(G),K,D),K.push(a)}setCurrentPoseAsRest(){this.bones.forEach((t=>{t.setCurrentPoseAsRest()}))}}var NK=D(293506);class WK{get influence(){return this._influence}set influence(t){if(this._influence===t)return;const K=this._influence;this._influence=t,this.onInfluenceChanged.hasObservers()&&this.onInfluenceChanged.notifyObservers(0===K||0===t)}get animationPropertiesOverride(){return!this._animationPropertiesOverride&&this._scene?this._scene.animationPropertiesOverride:this._animationPropertiesOverride}set animationPropertiesOverride(t){this._animationPropertiesOverride=t}constructor(t,K=0,D=null){this.name=t,this.animations=[],this._positions=null,this._normals=null,this._tangents=null,this._uvs=null,this._uniqueId=0,this.onInfluenceChanged=new d.cP,this._onDataLayoutChanged=new d.cP,this._animationPropertiesOverride=null,this._scene=D||$.q.LastCreatedScene,this.influence=K,this._scene&&(this._uniqueId=this._scene.getUniqueId())}get uniqueId(){return this._uniqueId}get hasPositions(){return!!this._positions}get hasNormals(){return!!this._normals}get hasTangents(){return!!this._tangents}get hasUVs(){return!!this._uvs}setPositions(t){const K=this.hasPositions;this._positions=t,K!==this.hasPositions&&this._onDataLayoutChanged.notifyObservers(void 0)}getPositions(){return this._positions}setNormals(t){const K=this.hasNormals;this._normals=t,K!==this.hasNormals&&this._onDataLayoutChanged.notifyObservers(void 0)}getNormals(){return this._normals}setTangents(t){const K=this.hasTangents;this._tangents=t,K!==this.hasTangents&&this._onDataLayoutChanged.notifyObservers(void 0)}getTangents(){return this._tangents}setUVs(t){const K=this.hasUVs;this._uvs=t,K!==this.hasUVs&&this._onDataLayoutChanged.notifyObservers(void 0)}getUVs(){return this._uvs}clone(){const t=z.p.Clone((()=>new WK(this.name,this.influence,this._scene)),this);return t._positions=this._positions,t._normals=this._normals,t._tangents=this._tangents,t._uvs=this._uvs,t}serialize(){const t={};return t.name=this.name,t.influence=this.influence,t.positions=Array.prototype.slice.call(this.getPositions()),null!=this.id&&(t.id=this.id),this.hasNormals&&(t.normals=Array.prototype.slice.call(this.getNormals())),this.hasTangents&&(t.tangents=Array.prototype.slice.call(this.getTangents())),this.hasUVs&&(t.uvs=Array.prototype.slice.call(this.getUVs())),z.p.AppendSerializedAnimations(this,t),t}getClassName(){return"MorphTarget"}static Parse(t,K){const D=new WK(t.name,t.influence);if(D.setPositions(t.positions),null!=t.id&&(D.id=t.id),t.normals&&D.setNormals(t.normals),t.tangents&&D.setTangents(t.tangents),t.uvs&&D.setUVs(t.uvs),t.animations){for(let K=0;K<t.animations.length;K++){const a=t.animations[K],G=J.n9("BABYLON.Animation");G&&D.animations.push(G.Parse(a))}t.autoAnimate&&K&&K.beginAnimation(D,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,t.autoAnimateSpeed||1)}return D}static FromMesh(t,K,D){K||(K=t.name);const a=new WK(K,D,t.getScene());return a.setPositions(t.getVerticesData(R.R.PositionKind)),t.isVerticesDataPresent(R.R.NormalKind)&&a.setNormals(t.getVerticesData(R.R.NormalKind)),t.isVerticesDataPresent(R.R.TangentKind)&&a.setTangents(t.getVerticesData(R.R.TangentKind)),t.isVerticesDataPresent(R.R.UVKind)&&a.setUVs(t.getVerticesData(R.R.UVKind)),a}}a.Cg([G.lK()],WK.prototype,"id",void 0);class xK extends U.g{get depth(){return this._depth}constructor(t,K,D,a,G,N,W=!0,x=!1,b=U.g.TRILINEAR_SAMPLINGMODE,n=0,e){super(null,N,!W,x),this.format=G,this._texture=N.getEngine().createRawTexture2DArray(t,K,D,a,G,W,x,b,null,n,e),this._depth=a,this.is2DArray=!0}update(t){this._texture&&this._getEngine().updateRawTexture2DArray(this._texture,t,this._texture.format,this._texture.invertY,null,this._texture.type)}static CreateRGBATexture(t,K,D,a,G,N=!0,W=!1,x=3,b=0){return new xK(t,K,D,a,5,G,N,W,x,b)}}class bK{set areUpdatesFrozen(t){t?this._blockCounter++:(this._blockCounter--,this._blockCounter<=0&&(this._blockCounter=0,this._syncActiveTargets(!0)))}get areUpdatesFrozen(){return this._blockCounter>0}constructor(t=null){if(this._targets=new Array,this._targetInfluenceChangedObservers=new Array,this._targetDataLayoutChangedObservers=new Array,this._activeTargets=new NK.L(16),this._supportsNormals=!1,this._supportsTangents=!1,this._supportsUVs=!1,this._vertexCount=0,this._uniqueId=0,this._tempInfluences=new Array,this._canUseTextureForTargets=!1,this._blockCounter=0,this._textureVertexStride=0,this._textureWidth=0,this._textureHeight=1,this._parentContainer=null,this.optimizeInfluencers=!0,this.enableNormalMorphing=!0,this.enableTangentMorphing=!0,this.enableUVMorphing=!0,this._numMaxInfluencers=0,this._useTextureToStoreTargets=!0,t||(t=$.q.LastCreatedScene),this._scene=t,this._scene){this._scene.addMorphTargetManager(this),this._uniqueId=this._scene.getUniqueId();const t=this._scene.getEngine().getCaps();this._canUseTextureForTargets=t.canUseGLVertexID&&t.textureFloat&&t.maxVertexTextureImageUnits>0&&t.texture2DArrayMaxLayerCount>1}}get numMaxInfluencers(){return this._numMaxInfluencers}set numMaxInfluencers(t){this._numMaxInfluencers!==t&&(this._numMaxInfluencers=t,this._syncActiveTargets(!0))}get uniqueId(){return this._uniqueId}get vertexCount(){return this._vertexCount}get supportsNormals(){return this._supportsNormals&&this.enableNormalMorphing}get supportsTangents(){return this._supportsTangents&&this.enableTangentMorphing}get supportsUVs(){return this._supportsUVs&&this.enableUVMorphing}get numTargets(){return this._targets.length}get numInfluencers(){return this._activeTargets.length}get influences(){return this._influences}get useTextureToStoreTargets(){return this._useTextureToStoreTargets}set useTextureToStoreTargets(t){this._useTextureToStoreTargets=t}get isUsingTextureForTargets(){var t;return bK.EnableTextureStorage&&this.useTextureToStoreTargets&&this._canUseTextureForTargets&&!(null===(t=this._scene)||void 0===t?void 0:t.getEngine().getCaps().disableMorphTargetTexture)}getActiveTarget(t){return this._activeTargets.data[t]}getTarget(t){return this._targets[t]}getTargetByName(t){for(const K of this._targets)if(K.name===t)return K;return null}addTarget(t){this._targets.push(t),this._targetInfluenceChangedObservers.push(t.onInfluenceChanged.add((t=>{this._syncActiveTargets(t)}))),this._targetDataLayoutChangedObservers.push(t._onDataLayoutChanged.add((()=>{this._syncActiveTargets(!0)}))),this._syncActiveTargets(!0)}removeTarget(t){const K=this._targets.indexOf(t);K>=0&&(this._targets.splice(K,1),t.onInfluenceChanged.remove(this._targetInfluenceChangedObservers.splice(K,1)[0]),t._onDataLayoutChanged.remove(this._targetDataLayoutChangedObservers.splice(K,1)[0]),this._syncActiveTargets(!0)),this._scene&&this._scene.stopAnimation(t)}_bind(t){t.setFloat3("morphTargetTextureInfo",this._textureVertexStride,this._textureWidth,this._textureHeight),t.setFloatArray("morphTargetTextureIndices",this._morphTargetTextureIndices),t.setTexture("morphTargets",this._targetStoreTexture),t.setInt("morphTargetCount",this.numInfluencers)}clone(){const t=new bK(this._scene);for(const K of this._targets)t.addTarget(K.clone());return t.enableNormalMorphing=this.enableNormalMorphing,t.enableTangentMorphing=this.enableTangentMorphing,t.enableUVMorphing=this.enableUVMorphing,t}serialize(){const t={};t.id=this.uniqueId,t.targets=[];for(const K of this._targets)t.targets.push(K.serialize());return t}_syncActiveTargets(t){if(this.areUpdatesFrozen)return;let K=0;this._activeTargets.reset(),this._supportsNormals=!0,this._supportsTangents=!0,this._supportsUVs=!0,this._vertexCount=0,this._scene&&this._targets.length>this._scene.getEngine().getCaps().texture2DArrayMaxLayerCount&&(this.useTextureToStoreTargets=!1),this._morphTargetTextureIndices&&this._morphTargetTextureIndices.length===this._targets.length||(this._morphTargetTextureIndices=new Float32Array(this._targets.length));let D=-1;for(const t of this._targets){if(D++,0===t.influence&&this.optimizeInfluencers)continue;if(this._activeTargets.length>=bK.MaxActiveMorphTargetsInVertexAttributeMode&&!this.isUsingTextureForTargets)break;this._activeTargets.push(t),this._morphTargetTextureIndices[K]=D,this._tempInfluences[K++]=t.influence,this._supportsNormals=this._supportsNormals&&t.hasNormals,this._supportsTangents=this._supportsTangents&&t.hasTangents,this._supportsUVs=this._supportsUVs&&t.hasUVs;const a=t.getPositions();if(a){const t=a.length/3;if(0===this._vertexCount)this._vertexCount=t;else if(this._vertexCount!==t)return void i.V.Error("Incompatible target. Targets must all have the same vertices count.")}}this._morphTargetTextureIndices.length!==K&&(this._morphTargetTextureIndices=this._morphTargetTextureIndices.slice(0,K)),this._influences&&this._influences.length===K||(this._influences=new Float32Array(K));for(let t=0;t<K;t++)this._influences[t]=this._tempInfluences[t];t&&this.synchronize()}synchronize(){if(this._scene&&!this.areUpdatesFrozen){if(this.isUsingTextureForTargets&&(this._vertexCount||this.numMaxInfluencers>0)){this._textureVertexStride=1,this._supportsNormals&&this._textureVertexStride++,this._supportsTangents&&this._textureVertexStride++,this._supportsUVs&&this._textureVertexStride++,this._textureWidth=this._vertexCount*this._textureVertexStride||1,this._textureHeight=1;const t=this._scene.getEngine().getCaps().maxTextureSize;this._textureWidth>t&&(this._textureHeight=Math.ceil(this._textureWidth/t),this._textureWidth=t);let K=!0;if(this._targetStoreTexture){const t=this._targetStoreTexture.getSize();t.width===this._textureWidth&&t.height===this._textureHeight&&this._targetStoreTexture.depth===this._targets.length&&(K=!1)}if(K){this._targetStoreTexture&&this._targetStoreTexture.dispose();const t=this._targets.length,K=new Float32Array(t*this._textureWidth*this._textureHeight*4);let D=0;for(let a=0;a<t;a++){const t=this._targets[a],G=t.getPositions(),N=t.getNormals(),W=t.getUVs(),x=t.getTangents();if(!G)return void(0===a&&i.V.Error("Invalid morph target. Target must have positions."));D=a*this._textureWidth*this._textureHeight*4;for(let t=0;t<this._vertexCount;t++)K[D]=G[3*t],K[D+1]=G[3*t+1],K[D+2]=G[3*t+2],D+=4,this._supportsNormals&&N&&(K[D]=N[3*t],K[D+1]=N[3*t+1],K[D+2]=N[3*t+2],D+=4),this._supportsUVs&&W&&(K[D]=W[2*t],K[D+1]=W[2*t+1],D+=4),this._supportsTangents&&x&&(K[D]=x[3*t],K[D+1]=x[3*t+1],K[D+2]=x[3*t+2],D+=4)}this._targetStoreTexture=xK.CreateRGBATexture(K,this._textureWidth,this._textureHeight,t,this._scene,!1,!1,1,1)}}for(const t of this._scene.meshes)t.morphTargetManager===this&&t._syncGeometryWithMorphTargetManager()}}dispose(){if(this._targetStoreTexture&&this._targetStoreTexture.dispose(),this._targetStoreTexture=null,this._scene){if(this._scene.removeMorphTargetManager(this),this._parentContainer){const t=this._parentContainer.morphTargetManagers.indexOf(this);t>-1&&this._parentContainer.morphTargetManagers.splice(t,1),this._parentContainer=null}for(const t of this._targets)this._scene.stopAnimation(t)}}static Parse(t,K){const D=new bK(K);D._uniqueId=t.id;for(const a of t.targets)D.addTarget(WK.Parse(a,K));return D}}bK.EnableTextureStorage=!0,bK.MaxActiveMorphTargetsInVertexAttributeMode=8;class nK{constructor(t,K){this.type=t,this.jointData=K,K.nativeParams=K.nativeParams||{}}get physicsJoint(){return this._physicsJoint}set physicsJoint(t){this._physicsJoint=t}set physicsPlugin(t){this._physicsPlugin=t}executeNativeFunction(t){t(this._physicsPlugin.world,this._physicsJoint)}}nK.DistanceJoint=0,nK.HingeJoint=1,nK.BallAndSocketJoint=2,nK.WheelJoint=3,nK.SliderJoint=4,nK.PrismaticJoint=5,nK.UniversalJoint=6,nK.Hinge2Joint=nK.WheelJoint,nK.PointToPointJoint=8,nK.SpringJoint=9,nK.LockJoint=10,Nt._PhysicsImpostorParser=function(t,K,D){return new eK(K,D.physicsImpostor,{mass:D.physicsMass,friction:D.physicsFriction,restitution:D.physicsRestitution},t)};class eK{get isDisposed(){return this._isDisposed}get mass(){return this._physicsEngine?this._physicsEngine.getPhysicsPlugin().getBodyMass(this):0}set mass(t){this.setMass(t)}get friction(){return this._physicsEngine?this._physicsEngine.getPhysicsPlugin().getBodyFriction(this):0}set friction(t){this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().setBodyFriction(this,t)}get restitution(){return this._physicsEngine?this._physicsEngine.getPhysicsPlugin().getBodyRestitution(this):0}set restitution(t){this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().setBodyRestitution(this,t)}get pressure(){if(!this._physicsEngine)return 0;const t=this._physicsEngine.getPhysicsPlugin();return t.setBodyPressure?t.getBodyPressure(this):0}set pressure(t){if(!this._physicsEngine)return;const K=this._physicsEngine.getPhysicsPlugin();K.setBodyPressure&&K.setBodyPressure(this,t)}get stiffness(){if(!this._physicsEngine)return 0;const t=this._physicsEngine.getPhysicsPlugin();return t.getBodyStiffness?t.getBodyStiffness(this):0}set stiffness(t){if(!this._physicsEngine)return;const K=this._physicsEngine.getPhysicsPlugin();K.setBodyStiffness&&K.setBodyStiffness(this,t)}get velocityIterations(){if(!this._physicsEngine)return 0;const t=this._physicsEngine.getPhysicsPlugin();return t.getBodyVelocityIterations?t.getBodyVelocityIterations(this):0}set velocityIterations(t){if(!this._physicsEngine)return;const K=this._physicsEngine.getPhysicsPlugin();K.setBodyVelocityIterations&&K.setBodyVelocityIterations(this,t)}get positionIterations(){if(!this._physicsEngine)return 0;const t=this._physicsEngine.getPhysicsPlugin();return t.getBodyPositionIterations?t.getBodyPositionIterations(this):0}set positionIterations(t){if(!this._physicsEngine)return;const K=this._physicsEngine.getPhysicsPlugin();K.setBodyPositionIterations&&K.setBodyPositionIterations(this,t)}constructor(t,K,D={mass:0},a){this.object=t,this.type=K,this._options=D,this._scene=a,this._pluginData={},this._bodyUpdateRequired=!1,this._onBeforePhysicsStepCallbacks=new Array,this._onAfterPhysicsStepCallbacks=new Array,this._onPhysicsCollideCallbacks=[],this._deltaPosition=N.Pq.Zero(),this._isDisposed=!1,this.soft=!1,this.segments=0,this._tmpQuat=new N.PT,this._tmpQuat2=new N.PT,this.beforeStep=()=>{this._physicsEngine&&(this.object.translate(this._deltaPosition,-1),this._deltaRotationConjugated&&this.object.rotationQuaternion&&this.object.rotationQuaternion.multiplyToRef(this._deltaRotationConjugated,this.object.rotationQuaternion),this.object.computeWorldMatrix(!1),this.object.parent&&this.object.rotationQuaternion?(this.getParentsRotation(),this._tmpQuat.multiplyToRef(this.object.rotationQuaternion,this._tmpQuat)):this._tmpQuat.copyFrom(this.object.rotationQuaternion||new N.PT),this._options.disableBidirectionalTransformation||this.object.rotationQuaternion&&this._physicsEngine.getPhysicsPlugin().setPhysicsBodyTransformation(this,this.object.getAbsolutePosition(),this._tmpQuat),this._onBeforePhysicsStepCallbacks.forEach((t=>{t(this)})))},this.afterStep=()=>{this._physicsEngine&&(this._onAfterPhysicsStepCallbacks.forEach((t=>{t(this)})),this._physicsEngine.getPhysicsPlugin().setTransformationFromPhysicsBody(this),this.object.parent&&this.object.rotationQuaternion&&(this.getParentsRotation(),this._tmpQuat.conjugateInPlace(),this._tmpQuat.multiplyToRef(this.object.rotationQuaternion,this.object.rotationQuaternion)),this.object.setAbsolutePosition(this.object.position),this._deltaRotation?(this.object.rotationQuaternion&&this.object.rotationQuaternion.multiplyToRef(this._deltaRotation,this.object.rotationQuaternion),this._deltaPosition.applyRotationQuaternionToRef(this._deltaRotation,eK._TmpVecs[0]),this.object.translate(eK._TmpVecs[0],1)):this.object.translate(this._deltaPosition,1),this.object.computeWorldMatrix(!0))},this.onCollideEvent=null,this.onCollide=t=>{if(!this._onPhysicsCollideCallbacks.length&&!this.onCollideEvent)return;if(!this._physicsEngine)return;const K=this._physicsEngine.getImpostorWithPhysicsBody(t.body);K&&(this.onCollideEvent&&this.onCollideEvent(this,K),this._onPhysicsCollideCallbacks.filter((t=>-1!==t.otherImpostors.indexOf(K))).forEach((D=>{D.callback(this,K,t.point,t.distance,t.impulse,t.normal)})))},this.object?(this.object.parent&&0!==D.mass&&i.V.Warn("A physics impostor has been created for an object which has a parent. Babylon physics currently works in local space so unexpected issues may occur."),!this._scene&&t.getScene&&(this._scene=t.getScene()),this._scene&&(this.type>100&&(this.soft=!0),this._physicsEngine=this._scene.getPhysicsEngine(),this._physicsEngine?(this.object.rotationQuaternion||(this.object.rotation?this.object.rotationQuaternion=N.PT.RotationYawPitchRoll(this.object.rotation.y,this.object.rotation.x,this.object.rotation.z):this.object.rotationQuaternion=new N.PT),this._options.mass=void 0===D.mass?0:D.mass,this._options.friction=void 0===D.friction?.2:D.friction,this._options.restitution=void 0===D.restitution?.2:D.restitution,this.soft&&(this._options.mass=this._options.mass>0?this._options.mass:1,this._options.pressure=void 0===D.pressure?200:D.pressure,this._options.stiffness=void 0===D.stiffness?1:D.stiffness,this._options.velocityIterations=void 0===D.velocityIterations?20:D.velocityIterations,this._options.positionIterations=void 0===D.positionIterations?20:D.positionIterations,this._options.fixedPoints=void 0===D.fixedPoints?0:D.fixedPoints,this._options.margin=void 0===D.margin?0:D.margin,this._options.damping=void 0===D.damping?0:D.damping,this._options.path=void 0===D.path?null:D.path,this._options.shape=void 0===D.shape?null:D.shape),this._joints=[],!this.object.parent||this._options.ignoreParent?this._init():this.object.parent.physicsImpostor&&i.V.Warn("You must affect impostors to children before affecting impostor to parent.")):i.V.Error("Physics not enabled. Please use scene.enablePhysics(...) before creating impostors."))):i.V.Error("No object was provided. A physics object is obligatory")}_init(){this._physicsEngine&&(this._physicsEngine.removeImpostor(this),this.physicsBody=null,this._parent=this._parent||this._getPhysicsParent(),this._isDisposed||this.parent&&!this._options.ignoreParent||this._physicsEngine.addImpostor(this))}_getPhysicsParent(){return this.object.parent instanceof v.u?this.object.parent.physicsImpostor:null}isBodyInitRequired(){return this._bodyUpdateRequired||!this._physicsBody&&(!this._parent||!!this._options.ignoreParent)}setScalingUpdated(){this.forceUpdate()}forceUpdate(){this._init(),this.parent&&!this._options.ignoreParent&&this.parent.forceUpdate()}get physicsBody(){return this._parent&&!this._options.ignoreParent?this._parent.physicsBody:this._physicsBody}get parent(){return!this._options.ignoreParent&&this._parent?this._parent:null}set parent(t){this._parent=t}set physicsBody(t){this._physicsBody&&this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().removePhysicsBody(this),this._physicsBody=t,this.resetUpdateFlags()}resetUpdateFlags(){this._bodyUpdateRequired=!1}getObjectExtents(){if(this.object.getBoundingInfo){const t=this.object.rotationQuaternion,K=this.object.scaling.clone();this.object.rotationQuaternion=eK.IDENTITY_QUATERNION;const D=this.object.computeWorldMatrix&&this.object.computeWorldMatrix(!0);D&&D.decompose(K,void 0,void 0);const a=this.object.getBoundingInfo().boundingBox.extendSize.scale(2).multiplyInPlace(K);return a.x=Math.abs(a.x),a.y=Math.abs(a.y),a.z=Math.abs(a.z),this.object.rotationQuaternion=t,this.object.computeWorldMatrix&&this.object.computeWorldMatrix(!0),a}return eK.DEFAULT_OBJECT_SIZE}getObjectCenter(){return this.object.getBoundingInfo?this.object.getBoundingInfo().boundingBox.centerWorld:this.object.position}getParam(t){return this._options[t]}setParam(t,K){this._options[t]=K,this._bodyUpdateRequired=!0}setMass(t){this.getParam("mass")!==t&&this.setParam("mass",t),this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().setBodyMass(this,t)}getLinearVelocity(){return this._physicsEngine?this._physicsEngine.getPhysicsPlugin().getLinearVelocity(this):N.Pq.Zero()}setLinearVelocity(t){this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().setLinearVelocity(this,t)}getAngularVelocity(){return this._physicsEngine?this._physicsEngine.getPhysicsPlugin().getAngularVelocity(this):N.Pq.Zero()}setAngularVelocity(t){this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().setAngularVelocity(this,t)}executeNativeFunction(t){this._physicsEngine&&t(this._physicsEngine.getPhysicsPlugin().world,this.physicsBody)}registerBeforePhysicsStep(t){this._onBeforePhysicsStepCallbacks.push(t)}unregisterBeforePhysicsStep(t){const K=this._onBeforePhysicsStepCallbacks.indexOf(t);K>-1?this._onBeforePhysicsStepCallbacks.splice(K,1):i.V.Warn("Function to remove was not found")}registerAfterPhysicsStep(t){this._onAfterPhysicsStepCallbacks.push(t)}unregisterAfterPhysicsStep(t){const K=this._onAfterPhysicsStepCallbacks.indexOf(t);K>-1?this._onAfterPhysicsStepCallbacks.splice(K,1):i.V.Warn("Function to remove was not found")}registerOnPhysicsCollide(t,K){const D=t instanceof Array?t:[t];this._onPhysicsCollideCallbacks.push({callback:K,otherImpostors:D})}unregisterOnPhysicsCollide(t,K){const D=t instanceof Array?t:[t];let a=-1;this._onPhysicsCollideCallbacks.some(((t,G)=>{if(t.callback===K&&t.otherImpostors.length===D.length){const K=t.otherImpostors.every((t=>D.indexOf(t)>-1));return K&&(a=G),K}return!1}))?this._onPhysicsCollideCallbacks.splice(a,1):i.V.Warn("Function to remove was not found")}getParentsRotation(){let t=this.object.parent;for(this._tmpQuat.copyFromFloats(0,0,0,1);t;)t.rotationQuaternion?this._tmpQuat2.copyFrom(t.rotationQuaternion):N.PT.RotationYawPitchRollToRef(t.rotation.y,t.rotation.x,t.rotation.z,this._tmpQuat2),this._tmpQuat.multiplyToRef(this._tmpQuat2,this._tmpQuat),t=t.parent;return this._tmpQuat}applyForce(t,K){return this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().applyForce(this,t,K),this}applyImpulse(t,K){return this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().applyImpulse(this,t,K),this}createJoint(t,K,D){const a=new nK(K,D);return this.addJoint(t,a),this}addJoint(t,K){return this._joints.push({otherImpostor:t,joint:K}),this._physicsEngine&&this._physicsEngine.addJoint(this,t,K),this}addAnchor(t,K,D,a,G){if(!this._physicsEngine)return this;const N=this._physicsEngine.getPhysicsPlugin();return N.appendAnchor?(this._physicsEngine&&N.appendAnchor(this,t,K,D,a,G),this):this}addHook(t,K,D,a){if(!this._physicsEngine)return this;const G=this._physicsEngine.getPhysicsPlugin();return G.appendAnchor?(this._physicsEngine&&G.appendHook(this,t,K,D,a),this):this}sleep(){return this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().sleepBody(this),this}wakeUp(){return this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().wakeUpBody(this),this}clone(t){return t?new eK(t,this.type,this._options,this._scene):null}dispose(){this._physicsEngine&&(this._joints.forEach((t=>{this._physicsEngine&&this._physicsEngine.removeJoint(this,t.otherImpostor,t.joint)})),this._physicsEngine.removeImpostor(this),this.parent&&this.parent.forceUpdate(),this._isDisposed=!0)}setDeltaPosition(t){this._deltaPosition.copyFrom(t)}setDeltaRotation(t){this._deltaRotation||(this._deltaRotation=new N.PT),this._deltaRotation.copyFrom(t),this._deltaRotationConjugated=this._deltaRotation.conjugate()}getBoxSizeToRef(t){return this._physicsEngine&&this._physicsEngine.getPhysicsPlugin().getBoxSizeToRef(this,t),this}getRadius(){return this._physicsEngine?this._physicsEngine.getPhysicsPlugin().getRadius(this):0}syncBoneWithImpostor(t,K,D,a,G){const N=eK._TmpVecs[0],W=this.object;if(W.rotationQuaternion)if(G){const D=eK._TmpQuat;W.rotationQuaternion.multiplyToRef(G,D),t.setRotationQuaternion(D,1,K)}else t.setRotationQuaternion(W.rotationQuaternion,1,K);N.x=0,N.y=0,N.z=0,D&&(N.x=D.x,N.y=D.y,N.z=D.z,t.getDirectionToRef(N,K,N),null==a&&(a=D.length()),N.x*=a,N.y*=a,N.z*=a),t.getParent()?(N.addInPlace(W.getAbsolutePosition()),t.setAbsolutePosition(N,K)):(K.setAbsolutePosition(W.getAbsolutePosition()),K.position.x-=N.x,K.position.y-=N.y,K.position.z-=N.z)}syncImpostorWithBone(t,K,D,a,G,N){const W=this.object;if(W.rotationQuaternion)if(G){const D=eK._TmpQuat;t.getRotationQuaternionToRef(1,K,D),D.multiplyToRef(G,W.rotationQuaternion)}else t.getRotationQuaternionToRef(1,K,W.rotationQuaternion);const x=eK._TmpVecs[0],b=eK._TmpVecs[1];N||((N=eK._TmpVecs[2]).x=0,N.y=1,N.z=0),t.getDirectionToRef(N,K,b),t.getAbsolutePositionToRef(K,x),null==a&&D&&(a=D.length()),null!=a&&(x.x+=b.x*a,x.y+=b.y*a,x.z+=b.z*a),W.setAbsolutePosition(x)}}eK.DEFAULT_OBJECT_SIZE=new N.Pq(1,1,1),eK.IDENTITY_QUATERNION=N.PT.Identity(),eK._TmpVecs=KK.mI(3,N.Pq.Zero),eK._TmpQuat=N.PT.Identity(),eK.NoImpostor=0,eK.SphereImpostor=1,eK.BoxImpostor=2,eK.PlaneImpostor=3,eK.MeshImpostor=4,eK.CapsuleImpostor=6,eK.CylinderImpostor=7,eK.ParticleImpostor=8,eK.HeightmapImpostor=9,eK.ConvexHullImpostor=10,eK.CustomImpostor=100,eK.RopeImpostor=101,eK.ClothImpostor=102,eK.SoftbodyImpostor=103;class iK{constructor(){this._hasHit=!1,this._hitNormal=N.Pq.Zero(),this._hitPoint=N.Pq.Zero(),this._triangleIndex=-1}get hitPoint(){return this._hitPoint}get hitNormal(){return this._hitNormal}get hasHit(){return this._hasHit}get triangleIndex(){return this._triangleIndex}setHitData(t,K,D){this._hasHit=!0,this._hitNormal.set(t.x,t.y,t.z),this._hitPoint.set(K.x,K.y,K.z),this._triangleIndex=null!=D?D:-1}reset(){this._hasHit=!1,this._hitNormal.setAll(0),this._hitPoint.setAll(0),this._triangleIndex=-1,this.body=void 0,this.bodyIndex=void 0,this.shape=void 0}}class zK extends iK{constructor(){super(...arguments),this._hitDistance=0,this._rayFromWorld=N.Pq.Zero(),this._rayToWorld=N.Pq.Zero()}get hitDistance(){return this._hitDistance}get hitNormalWorld(){return this._hitNormal}get hitPointWorld(){return this._hitPoint}get rayFromWorld(){return this._rayFromWorld}get rayToWorld(){return this._rayToWorld}setHitDistance(t){this._hitDistance=t}calculateHitDistance(){this._hitDistance=N.Pq.Distance(this._rayFromWorld,this._hitPoint)}reset(t=N.Pq.Zero(),K=N.Pq.Zero()){super.reset(),this._rayFromWorld.copyFrom(t),this._rayToWorld.copyFrom(K),this._hitDistance=0}}class IK{getPluginVersion(){return this._physicsPlugin.getPluginVersion()}static DefaultPluginFactory(){throw r.n("CannonJSPlugin")}constructor(t,K=IK.DefaultPluginFactory()){if(this._physicsPlugin=K,this._impostors=[],this._joints=[],this._subTimeStep=0,this._uniqueIdCounter=0,!this._physicsPlugin.isSupported())throw new Error("Physics Engine "+this._physicsPlugin.name+" cannot be found. "+"Please make sure it is included.");t=t||new N.Pq(0,-9.807,0),this.setGravity(t),this.setTimeStep()}setGravity(t){this.gravity=t,this._physicsPlugin.setGravity(this.gravity)}setTimeStep(t=1/60){this._physicsPlugin.setTimeStep(t)}getTimeStep(){return this._physicsPlugin.getTimeStep()}setSubTimeStep(t=0){this._subTimeStep=t}getSubTimeStep(){return this._subTimeStep}dispose(){this._impostors.forEach((function(t){t.dispose()})),this._physicsPlugin.dispose()}getPhysicsPluginName(){return this._physicsPlugin.name}addImpostor(t){this._impostors.push(t),t.uniqueId=this._uniqueIdCounter++,t.parent||this._physicsPlugin.generatePhysicsBody(t)}removeImpostor(t){const K=this._impostors.indexOf(t);K>-1&&this._impostors.splice(K,1).length&&this.getPhysicsPlugin().removePhysicsBody(t)}addJoint(t,K,D){const a={mainImpostor:t,connectedImpostor:K,joint:D};D.physicsPlugin=this._physicsPlugin,this._joints.push(a),this._physicsPlugin.generateJoint(a)}removeJoint(t,K,D){const a=this._joints.filter((function(a){return a.connectedImpostor===K&&a.joint===D&&a.mainImpostor===t}));a.length&&this._physicsPlugin.removeJoint(a[0])}_step(t){this._impostors.forEach((t=>{t.isBodyInitRequired()&&this._physicsPlugin.generatePhysicsBody(t)})),t>.1?t=.1:t<=0&&(t=1/60),this._physicsPlugin.executeStep(t,this._impostors)}getPhysicsPlugin(){return this._physicsPlugin}getImpostors(){return this._impostors}getImpostorForPhysicsObject(t){for(let K=0;K<this._impostors.length;++K)if(this._impostors[K].object===t)return this._impostors[K];return null}getImpostorWithPhysicsBody(t){for(let K=0;K<this._impostors.length;++K)if(this._impostors[K].physicsBody===t)return this._impostors[K];return null}raycast(t,K){return this._physicsPlugin.raycast(t,K)}raycastToRef(t,K,D){return this._physicsPlugin.raycastToRef(t,K,D)}}class ZK{constructor(t=!0,K=10,D=CANNON){this._useDeltaForWorldStep=t,this.name="CannonJSPlugin",this._physicsMaterials=new Array,this._fixedTimeStep=1/60,this._physicsBodiesToRemoveAfterStep=new Array,this._firstFrame=!0,this._tmpQuaternion=new N.PT,this._minus90X=new N.PT(-.7071067811865475,0,0,.7071067811865475),this._plus90X=new N.PT(.7071067811865475,0,0,.7071067811865475),this._tmpPosition=N.Pq.Zero(),this._tmpDeltaPosition=N.Pq.Zero(),this._tmpUnityRotation=new N.PT,this.BJSCANNON=D,this.isSupported()?(this._extendNamespace(),this.world=new this.BJSCANNON.World,this.world.broadphase=new this.BJSCANNON.NaiveBroadphase,this.world.solver.iterations=K,this._cannonRaycastResult=new this.BJSCANNON.RaycastResult,this._raycastResult=new zK):i.V.Error("CannonJS is not available. Please make sure you included the js file.")}getPluginVersion(){return 1}setGravity(t){const K=t;this.world.gravity.set(K.x,K.y,K.z)}setTimeStep(t){this._fixedTimeStep=t}getTimeStep(){return this._fixedTimeStep}executeStep(t,K){if(this._firstFrame){this._firstFrame=!1;for(const t of K)t.type!=eK.HeightmapImpostor&&t.type!==eK.PlaneImpostor&&t.beforeStep()}this.world.step(this._useDeltaForWorldStep?t:this._fixedTimeStep),this._removeMarkedPhysicsBodiesFromWorld()}_removeMarkedPhysicsBodiesFromWorld(){this._physicsBodiesToRemoveAfterStep.length>0&&(this._physicsBodiesToRemoveAfterStep.forEach((t=>{"function"==typeof this.world.removeBody?this.world.removeBody(t):this.world.remove(t)})),this._physicsBodiesToRemoveAfterStep.length=0)}applyImpulse(t,K,D){const a=new this.BJSCANNON.Vec3(D.x,D.y,D.z),G=new this.BJSCANNON.Vec3(K.x,K.y,K.z);t.physicsBody.applyImpulse(G,a)}applyForce(t,K,D){const a=new this.BJSCANNON.Vec3(D.x,D.y,D.z),G=new this.BJSCANNON.Vec3(K.x,K.y,K.z);t.physicsBody.applyForce(G,a)}generatePhysicsBody(t){if(this._removeMarkedPhysicsBodiesFromWorld(),t.parent)t.physicsBody&&(this.removePhysicsBody(t),t.forceUpdate());else{if(t.isBodyInitRequired()){const K=this._createShape(t);if(!K)return void i.V.Warn("It was not possible to create a physics body for this object.");const D=t.physicsBody;D&&this.removePhysicsBody(t);const a=this._addMaterial("mat-"+t.uniqueId,t.getParam("friction"),t.getParam("restitution")),G={mass:t.getParam("mass"),material:a},N=t.getParam("nativeOptions");for(const t in N)Object.prototype.hasOwnProperty.call(N,t)&&(G[t]=N[t]);t.physicsBody=new this.BJSCANNON.Body(G),t.physicsBody.addEventListener("collide",t.onCollide),this.world.addEventListener("preStep",t.beforeStep),this.world.addEventListener("postStep",t.afterStep),t.physicsBody.addShape(K),"function"==typeof this.world.addBody?this.world.addBody(t.physicsBody):this.world.add(t.physicsBody),D&&["force","torque","velocity","angularVelocity"].forEach((function(K){const a=D[K];t.physicsBody[K].set(a.x,a.y,a.z)})),this._processChildMeshes(t)}this._updatePhysicsBodyTransformation(t)}}_processChildMeshes(t){const K=t.object.getChildMeshes?t.object.getChildMeshes(!0):[],D=t.object.rotationQuaternion;if(D?D.conjugateToRef(this._tmpQuaternion):this._tmpQuaternion.set(0,0,0,1),K.length){const D=K=>{if(!K.rotationQuaternion)return;const a=K.getPhysicsImpostor();if(a&&a.parent!==t&&K.parent){const D=K.getAbsolutePosition().subtract(K.parent.getAbsolutePosition()),G=K.rotationQuaternion.multiply(this._tmpQuaternion);a.physicsBody&&(this.removePhysicsBody(a),a.physicsBody=null),a.parent=t,a.resetUpdateFlags(),t.physicsBody.addShape(this._createShape(a),new this.BJSCANNON.Vec3(D.x,D.y,D.z),new this.BJSCANNON.Quaternion(G.x,G.y,G.z,G.w)),t.physicsBody.mass+=a.getParam("mass")}K.getChildMeshes(!0).filter((t=>!!t.physicsImpostor)).forEach(D)};K.filter((t=>!!t.physicsImpostor)).forEach(D)}}removePhysicsBody(t){t.physicsBody.removeEventListener("collide",t.onCollide),this.world.removeEventListener("preStep",t.beforeStep),this.world.removeEventListener("postStep",t.afterStep),-1===this._physicsBodiesToRemoveAfterStep.indexOf(t.physicsBody)&&this._physicsBodiesToRemoveAfterStep.push(t.physicsBody)}generateJoint(t){const K=t.mainImpostor.physicsBody,D=t.connectedImpostor.physicsBody;if(!K||!D)return;let a;const G=t.joint.jointData,N={pivotA:G.mainPivot?(new this.BJSCANNON.Vec3).set(G.mainPivot.x,G.mainPivot.y,G.mainPivot.z):null,pivotB:G.connectedPivot?(new this.BJSCANNON.Vec3).set(G.connectedPivot.x,G.connectedPivot.y,G.connectedPivot.z):null,axisA:G.mainAxis?(new this.BJSCANNON.Vec3).set(G.mainAxis.x,G.mainAxis.y,G.mainAxis.z):null,axisB:G.connectedAxis?(new this.BJSCANNON.Vec3).set(G.connectedAxis.x,G.connectedAxis.y,G.connectedAxis.z):null,maxForce:G.nativeParams.maxForce,collideConnected:!!G.collision};switch(t.joint.type){case nK.HingeJoint:case nK.Hinge2Joint:a=new this.BJSCANNON.HingeConstraint(K,D,N);break;case nK.DistanceJoint:a=new this.BJSCANNON.DistanceConstraint(K,D,G.maxDistance||2);break;case nK.SpringJoint:{const t=G;a=new this.BJSCANNON.Spring(K,D,{restLength:t.length,stiffness:t.stiffness,damping:t.damping,localAnchorA:N.pivotA,localAnchorB:N.pivotB});break}case nK.LockJoint:a=new this.BJSCANNON.LockConstraint(K,D,N);break;case nK.PointToPointJoint:case nK.BallAndSocketJoint:default:a=new this.BJSCANNON.PointToPointConstraint(K,N.pivotA,D,N.pivotB,N.maxForce)}a.collideConnected=!!G.collision,t.joint.physicsJoint=a,t.joint.type!==nK.SpringJoint?this.world.addConstraint(a):(t.joint.jointData.forceApplicationCallback=t.joint.jointData.forceApplicationCallback||function(){a.applyForce()},t.mainImpostor.registerAfterPhysicsStep(t.joint.jointData.forceApplicationCallback))}removeJoint(t){t.joint.type!==nK.SpringJoint?this.world.removeConstraint(t.joint.physicsJoint):t.mainImpostor.unregisterAfterPhysicsStep(t.joint.jointData.forceApplicationCallback)}_addMaterial(t,K,D){let a,G;for(a=0;a<this._physicsMaterials.length;a++)if(G=this._physicsMaterials[a],G.friction===K&&G.restitution===D)return G;const N=new this.BJSCANNON.Material(t);return N.friction=K,N.restitution=D,this._physicsMaterials.push(N),N}_checkWithEpsilon(t){return t<x.bH?x.bH:t}_createShape(t){const K=t.object;let D;const a=t.getObjectExtents();switch(t.type){case eK.SphereImpostor:{const t=a.x,K=a.y,G=a.z;D=new this.BJSCANNON.Sphere(Math.max(this._checkWithEpsilon(t),this._checkWithEpsilon(K),this._checkWithEpsilon(G))/2);break}case eK.CylinderImpostor:{let K=t.getParam("nativeOptions");K||(K={});const G=void 0!==K.radiusTop?K.radiusTop:this._checkWithEpsilon(a.x)/2,N=void 0!==K.radiusBottom?K.radiusBottom:this._checkWithEpsilon(a.x)/2,W=void 0!==K.height?K.height:this._checkWithEpsilon(a.y),x=void 0!==K.numSegments?K.numSegments:16;D=new this.BJSCANNON.Cylinder(G,N,W,x);const b=new this.BJSCANNON.Quaternion;b.setFromAxisAngle(new this.BJSCANNON.Vec3(1,0,0),-Math.PI/2);const n=new this.BJSCANNON.Vec3(0,0,0);D.transformAllPoints(n,b);break}case eK.BoxImpostor:{const t=a.scale(.5);D=new this.BJSCANNON.Box(new this.BJSCANNON.Vec3(this._checkWithEpsilon(t.x),this._checkWithEpsilon(t.y),this._checkWithEpsilon(t.z)));break}case eK.PlaneImpostor:i.V.Warn("Attention, PlaneImposter might not behave as you expect. Consider using BoxImposter instead"),D=new this.BJSCANNON.Plane;break;case eK.MeshImpostor:{const a=K.getVerticesData?K.getVerticesData(R.R.PositionKind):[],G=K.getIndices?K.getIndices():[];if(!a)return void i.V.Warn("Tried to create a MeshImpostor for an object without vertices. This will fail.");const W=K.position.clone(),x=K.rotation&&K.rotation.clone(),b=K.rotationQuaternion&&K.rotationQuaternion.clone();K.position.copyFromFloats(0,0,0),K.rotation&&K.rotation.copyFromFloats(0,0,0),K.rotationQuaternion&&K.rotationQuaternion.copyFrom(t.getParentsRotation()),K.rotationQuaternion&&K.parent&&K.rotationQuaternion.conjugateInPlace();const n=K.computeWorldMatrix(!0),e=[];let z;for(z=0;z<a.length;z+=3)N.Pq.TransformCoordinates(N.Pq.FromArray(a,z),n).toArray(e,z);i.V.Warn("MeshImpostor only collides against spheres."),D=new this.BJSCANNON.Trimesh(e,G),K.position.copyFrom(W),x&&K.rotation&&K.rotation.copyFrom(x),b&&K.rotationQuaternion&&K.rotationQuaternion.copyFrom(b);break}case eK.HeightmapImpostor:{const a=K.position.clone(),G=K.rotation&&K.rotation.clone(),N=K.rotationQuaternion&&K.rotationQuaternion.clone();K.position.copyFromFloats(0,0,0),K.rotation&&K.rotation.copyFromFloats(0,0,0),K.rotationQuaternion&&K.rotationQuaternion.copyFrom(t.getParentsRotation()),K.rotationQuaternion&&K.parent&&K.rotationQuaternion.conjugateInPlace(),K.rotationQuaternion&&K.rotationQuaternion.multiplyInPlace(this._minus90X),D=this._createHeightmap(K),K.position.copyFrom(a),G&&K.rotation&&K.rotation.copyFrom(G),N&&K.rotationQuaternion&&K.rotationQuaternion.copyFrom(N),K.computeWorldMatrix(!0);break}case eK.ParticleImpostor:D=new this.BJSCANNON.Particle;break;case eK.NoImpostor:D=new this.BJSCANNON.Box(new this.BJSCANNON.Vec3(0,0,0))}return D}_createHeightmap(t,K){let D=t.getVerticesData(R.R.PositionKind);const a=t.computeWorldMatrix(!0),G=[];let W;for(W=0;W<D.length;W+=3)N.Pq.TransformCoordinates(N.Pq.FromArray(D,W),a).toArray(G,W);D=G;const x=new Array,b=K||~~(Math.sqrt(D.length/3)-1),n=t.getBoundingInfo(),e=Math.min(n.boundingBox.extendSizeWorld.x,n.boundingBox.extendSizeWorld.y),i=n.boundingBox.extendSizeWorld.z,z=2*e/b;for(let t=0;t<D.length;t+=3){const K=Math.round(D[t+0]/z+b/2),a=Math.round(-1*(D[t+1]/z-b/2)),G=-D[t+2]+i;x[K]||(x[K]=[]),x[K][a]||(x[K][a]=G),x[K][a]=Math.max(G,x[K][a])}for(let t=0;t<=b;++t){if(!x[t]){let K=1;for(;!x[(t+K)%b];)K++;x[t]=x[(t+K)%b].slice()}for(let K=0;K<=b;++K)if(!x[t][K]){let D,a=1;for(;void 0===D;)D=x[t][(K+a++)%b];x[t][K]=D}}const I=new this.BJSCANNON.Heightfield(x,{elementSize:z});return I.minY=i,I}_updatePhysicsBodyTransformation(t){const K=t.object;if(K.computeWorldMatrix&&K.computeWorldMatrix(!0),!K.getBoundingInfo())return;const D=t.getObjectCenter();this._tmpDeltaPosition.copyFrom(K.getAbsolutePivotPoint().subtract(D)),this._tmpDeltaPosition.divideInPlace(t.object.scaling),this._tmpPosition.copyFrom(D);let a=K.rotationQuaternion;if(a){if(t.type!==eK.PlaneImpostor&&t.type!==eK.HeightmapImpostor||(a=a.multiply(this._minus90X),t.setDeltaRotation(this._plus90X)),t.type===eK.HeightmapImpostor){const t=K;let a=t.getBoundingInfo();const G=t.rotationQuaternion;t.rotationQuaternion=this._tmpUnityRotation,t.computeWorldMatrix(!0);const W=D.clone();let x=t.getPivotMatrix();x=x?x.clone():N.uq.Identity();const b=N.uq.Translation(a.boundingBox.extendSizeWorld.x,0,-a.boundingBox.extendSizeWorld.z);t.setPreTransformMatrix(b),t.computeWorldMatrix(!0),a=t.getBoundingInfo();const n=a.boundingBox.centerWorld.subtract(D).subtract(t.position).negate();this._tmpPosition.copyFromFloats(n.x,n.y-a.boundingBox.extendSizeWorld.y,n.z),this._tmpDeltaPosition.copyFrom(a.boundingBox.centerWorld.subtract(W)),this._tmpDeltaPosition.y+=a.boundingBox.extendSizeWorld.y,t.rotationQuaternion=G,t.setPreTransformMatrix(x),t.computeWorldMatrix(!0)}else t.type===eK.MeshImpostor&&this._tmpDeltaPosition.copyFromFloats(0,0,0);t.setDeltaPosition(this._tmpDeltaPosition),t.physicsBody.position.set(this._tmpPosition.x,this._tmpPosition.y,this._tmpPosition.z),t.physicsBody.quaternion.set(a.x,a.y,a.z,a.w)}}setTransformationFromPhysicsBody(t){if(t.object.position.set(t.physicsBody.position.x,t.physicsBody.position.y,t.physicsBody.position.z),t.object.rotationQuaternion){const K=t.physicsBody.quaternion;t.object.rotationQuaternion.set(K.x,K.y,K.z,K.w)}}setPhysicsBodyTransformation(t,K,D){t.physicsBody.position.set(K.x,K.y,K.z),t.physicsBody.quaternion.set(D.x,D.y,D.z,D.w)}isSupported(){return void 0!==this.BJSCANNON}setLinearVelocity(t,K){t.physicsBody.velocity.set(K.x,K.y,K.z)}setAngularVelocity(t,K){t.physicsBody.angularVelocity.set(K.x,K.y,K.z)}getLinearVelocity(t){const K=t.physicsBody.velocity;return K?new N.Pq(K.x,K.y,K.z):null}getAngularVelocity(t){const K=t.physicsBody.angularVelocity;return K?new N.Pq(K.x,K.y,K.z):null}setBodyMass(t,K){t.physicsBody.mass=K,t.physicsBody.updateMassProperties()}getBodyMass(t){return t.physicsBody.mass}getBodyFriction(t){return t.physicsBody.material.friction}setBodyFriction(t,K){t.physicsBody.material.friction=K}getBodyRestitution(t){return t.physicsBody.material.restitution}setBodyRestitution(t,K){t.physicsBody.material.restitution=K}sleepBody(t){t.physicsBody.sleep()}wakeUpBody(t){t.physicsBody.wakeUp()}updateDistanceJoint(t,K){t.physicsJoint.distance=K}setMotor(t,K,D,a){a||(t.physicsJoint.enableMotor(),t.physicsJoint.setMotorSpeed(K),D&&this.setLimit(t,D))}setLimit(t,K,D){t.physicsJoint.motorEquation.maxForce=D,t.physicsJoint.motorEquation.minForce=void 0===K?-K:K}syncMeshWithImpostor(t,K){const D=K.physicsBody;t.position.x=D.position.x,t.position.y=D.position.y,t.position.z=D.position.z,t.rotationQuaternion&&(t.rotationQuaternion.x=D.quaternion.x,t.rotationQuaternion.y=D.quaternion.y,t.rotationQuaternion.z=D.quaternion.z,t.rotationQuaternion.w=D.quaternion.w)}getRadius(t){return t.physicsBody.shapes[0].boundingSphereRadius}getBoxSizeToRef(t,K){const D=t.physicsBody.shapes[0];K.x=2*D.halfExtents.x,K.y=2*D.halfExtents.y,K.z=2*D.halfExtents.z}dispose(){}_extendNamespace(){const t=new this.BJSCANNON.Vec3,K=this.BJSCANNON;this.BJSCANNON.World.prototype.step=function(D,a,G){if(G=G||10,0===(a=a||0))this.internalStep(D),this.time+=D;else{let N=Math.floor((this.time+a)/D)-Math.floor(this.time/D);N=Math.min(N,G)||1;const W=performance.now();for(let t=0;t!==N&&(this.internalStep(D),!(performance.now()-W>1e3*D));t++);this.time+=a;const x=this.time%D/D,b=t,n=this.bodies;for(let t=0;t!==n.length;t++){const D=n[t];D.type!==K.Body.STATIC&&D.sleepState!==K.Body.SLEEPING?(D.position.vsub(D.previousPosition,b),b.scale(x,b),D.position.vadd(b,D.interpolatedPosition)):(D.interpolatedPosition.set(D.position.x,D.position.y,D.position.z),D.interpolatedQuaternion.set(D.quaternion.x,D.quaternion.y,D.quaternion.z,D.quaternion.w))}}}}raycast(t,K){return this._raycastResult.reset(t,K),this.raycastToRef(t,K,this._raycastResult),this._raycastResult}raycastToRef(t,K,D){this._cannonRaycastResult.reset(),this.world.raycastClosest(t,K,{},this._cannonRaycastResult),D.reset(t,K),this._cannonRaycastResult.hasHit&&(D.setHitData({x:this._cannonRaycastResult.hitNormalWorld.x,y:this._cannonRaycastResult.hitNormalWorld.y,z:this._cannonRaycastResult.hitNormalWorld.z},{x:this._cannonRaycastResult.hitPointWorld.x,y:this._cannonRaycastResult.hitPointWorld.y,z:this._cannonRaycastResult.hitPointWorld.z}),D.setHitDistance(this._cannonRaycastResult.distance))}}IK.DefaultPluginFactory=()=>new ZK;class wK{constructor(t=!0,K,D=OIMO){this._useDeltaForWorldStep=t,this.name="OimoJSPlugin",this._fixedTimeStep=1/60,this._tmpImpostorsArray=[],this._tmpPositionVector=N.Pq.Zero(),this.BJSOIMO=D,this.world=new this.BJSOIMO.World({iterations:K}),this.world.clear(),this._raycastResult=new zK}getPluginVersion(){return 1}setGravity(t){this.world.gravity.set(t.x,t.y,t.z)}setTimeStep(t){this.world.timeStep=t}getTimeStep(){return this.world.timeStep}executeStep(t,K){K.forEach((function(t){t.beforeStep()})),this.world.timeStep=this._useDeltaForWorldStep?t:this._fixedTimeStep,this.world.step(),K.forEach((t=>{t.afterStep(),this._tmpImpostorsArray[t.uniqueId]=t}));let D=this.world.contacts;for(;null!==D;){if(D.touching&&!D.body1.sleeping&&!D.body2.sleeping){D=D.next;continue}const t=this._tmpImpostorsArray[+D.body1.name],K=this._tmpImpostorsArray[+D.body2.name];t&&K?(t.onCollide({body:K.physicsBody,point:null,distance:0,impulse:0,normal:null}),K.onCollide({body:t.physicsBody,point:null,distance:0,impulse:0,normal:null}),D=D.next):D=D.next}}applyImpulse(t,K,D){const a=t.physicsBody.mass;t.physicsBody.applyImpulse(D.scale(this.world.invScale),K.scale(this.world.invScale*a))}applyForce(t,K,D){i.V.Warn("Oimo doesn't support applying force. Using impulse instead."),this.applyImpulse(t,K,D)}generatePhysicsBody(t){if(t.parent)t.physicsBody&&(this.removePhysicsBody(t),t.forceUpdate());else{if(t.isBodyInitRequired()){const D={name:t.uniqueId,config:[t.getParam("mass")||.001,t.getParam("friction"),t.getParam("restitution")],size:[],type:[],pos:[],posShape:[],rot:[],rotShape:[],move:0!==t.getParam("mass"),density:t.getParam("mass"),friction:t.getParam("friction"),restitution:t.getParam("restitution"),world:this.world},a=[t];(K=t.object).getChildMeshes&&K.getChildMeshes().forEach((function(t){t.physicsImpostor&&a.push(t.physicsImpostor)}));const G=t=>Math.max(t,x.bH),W=new N.PT;a.forEach((K=>{if(!K.object.rotationQuaternion)return;const a=K.object.rotationQuaternion;W.copyFrom(a),K.object.rotationQuaternion.set(0,0,0,1),K.object.computeWorldMatrix(!0);const N=W.toEulerAngles(),x=K.getObjectExtents(),b=57.29577951308232;if(K===t){const K=t.getObjectCenter();t.object.getAbsolutePivotPoint().subtractToRef(K,this._tmpPositionVector),this._tmpPositionVector.divideInPlace(t.object.scaling),D.pos.push(K.x),D.pos.push(K.y),D.pos.push(K.z),D.posShape.push(0,0,0),D.rotShape.push(0,0,0)}else{const t=K.object.position.clone();D.posShape.push(t.x),D.posShape.push(t.y),D.posShape.push(t.z),D.rotShape.push(N.x*b,N.y*b,N.z*b)}switch(K.object.rotationQuaternion.copyFrom(W),K.type){case eK.ParticleImpostor:i.V.Warn("No Particle support in OIMO.js. using SphereImpostor instead");case eK.SphereImpostor:{const t=x.x,K=x.y,a=x.z,N=Math.max(G(t),G(K),G(a))/2;D.type.push("sphere"),D.size.push(N),D.size.push(N),D.size.push(N);break}case eK.CylinderImpostor:{const t=G(x.x)/2,K=G(x.y);D.type.push("cylinder"),D.size.push(t),D.size.push(K),D.size.push(K);break}case eK.PlaneImpostor:case eK.BoxImpostor:default:{const t=G(x.x),K=G(x.y),a=G(x.z);D.type.push("box"),D.size.push(t),D.size.push(K),D.size.push(a);break}}K.object.rotationQuaternion=a})),t.physicsBody=this.world.add(D),t.physicsBody.resetQuaternion(W),t.physicsBody.updatePosition(0)}else this._tmpPositionVector.copyFromFloats(0,0,0);t.setDeltaPosition(this._tmpPositionVector)}var K}removePhysicsBody(t){this.world.removeRigidBody(t.physicsBody)}generateJoint(t){const K=t.mainImpostor.physicsBody,D=t.connectedImpostor.physicsBody;if(!K||!D)return;const a=t.joint.jointData,G=a.nativeParams||{};let N;const W={body1:K,body2:D,axe1:G.axe1||(a.mainAxis?a.mainAxis.asArray():null),axe2:G.axe2||(a.connectedAxis?a.connectedAxis.asArray():null),pos1:G.pos1||(a.mainPivot?a.mainPivot.asArray():null),pos2:G.pos2||(a.connectedPivot?a.connectedPivot.asArray():null),min:G.min,max:G.max,collision:G.collision||a.collision,spring:G.spring,world:this.world};switch(t.joint.type){case nK.BallAndSocketJoint:N="jointBall";break;case nK.SpringJoint:{i.V.Warn("OIMO.js doesn't support Spring Constraint. Simulating using DistanceJoint instead");const t=a;W.min=t.length||W.min,W.max=Math.max(W.min,W.max)}case nK.DistanceJoint:N="jointDistance",W.max=a.maxDistance;break;case nK.PrismaticJoint:N="jointPrisme";break;case nK.SliderJoint:N="jointSlide";break;case nK.WheelJoint:N="jointWheel";break;case nK.HingeJoint:default:N="jointHinge"}W.type=N,t.joint.physicsJoint=this.world.add(W)}removeJoint(t){try{this.world.removeJoint(t.joint.physicsJoint)}catch(t){i.V.Warn(t)}}isSupported(){return void 0!==this.BJSOIMO}setTransformationFromPhysicsBody(t){if(!t.physicsBody.sleeping){if(t.physicsBody.shapes.next){let K=t.physicsBody.shapes;for(;K.next;)K=K.next;t.object.position.set(K.position.x,K.position.y,K.position.z)}else{const K=t.physicsBody.getPosition();t.object.position.set(K.x,K.y,K.z)}if(t.object.rotationQuaternion){const K=t.physicsBody.getQuaternion();t.object.rotationQuaternion.set(K.x,K.y,K.z,K.w)}}}setPhysicsBodyTransformation(t,K,D){const a=t.physicsBody;t.physicsBody.shapes.next||(a.position.set(K.x,K.y,K.z),a.orientation.set(D.x,D.y,D.z,D.w),a.syncShapes(),a.awake())}setLinearVelocity(t,K){t.physicsBody.linearVelocity.set(K.x,K.y,K.z)}setAngularVelocity(t,K){t.physicsBody.angularVelocity.set(K.x,K.y,K.z)}getLinearVelocity(t){const K=t.physicsBody.linearVelocity;return K?new N.Pq(K.x,K.y,K.z):null}getAngularVelocity(t){const K=t.physicsBody.angularVelocity;return K?new N.Pq(K.x,K.y,K.z):null}setBodyMass(t,K){const D=0===K;t.physicsBody.shapes.density=D?1:K,t.physicsBody.setupMass(D?2:1)}getBodyMass(t){return t.physicsBody.shapes.density}getBodyFriction(t){return t.physicsBody.shapes.friction}setBodyFriction(t,K){t.physicsBody.shapes.friction=K}getBodyRestitution(t){return t.physicsBody.shapes.restitution}setBodyRestitution(t,K){t.physicsBody.shapes.restitution=K}sleepBody(t){t.physicsBody.sleep()}wakeUpBody(t){t.physicsBody.awake()}updateDistanceJoint(t,K,D){t.physicsJoint.limitMotor.upperLimit=K,void 0!==D&&(t.physicsJoint.limitMotor.lowerLimit=D)}setMotor(t,K,D,a){void 0!==D?i.V.Warn("OimoJS plugin currently has unexpected behavior when using setMotor with force parameter"):D=1e6,K*=-1;const G=a?t.physicsJoint.rotationalLimitMotor2:t.physicsJoint.rotationalLimitMotor1||t.physicsJoint.rotationalLimitMotor||t.physicsJoint.limitMotor;G&&G.setMotor(K,D)}setLimit(t,K,D,a){const G=a?t.physicsJoint.rotationalLimitMotor2:t.physicsJoint.rotationalLimitMotor1||t.physicsJoint.rotationalLimitMotor||t.physicsJoint.limitMotor;G&&G.setLimit(K,void 0===D?-K:D)}syncMeshWithImpostor(t,K){const D=K.physicsBody;t.position.x=D.position.x,t.position.y=D.position.y,t.position.z=D.position.z,t.rotationQuaternion&&(t.rotationQuaternion.x=D.orientation.x,t.rotationQuaternion.y=D.orientation.y,t.rotationQuaternion.z=D.orientation.z,t.rotationQuaternion.w=D.orientation.w)}getRadius(t){return t.physicsBody.shapes.radius}getBoxSizeToRef(t,K){const D=t.physicsBody.shapes;K.x=2*D.halfWidth,K.y=2*D.halfHeight,K.z=2*D.halfDepth}dispose(){this.world.clear()}raycast(t,K){return i.V.Warn("raycast is not currently supported by the Oimo physics plugin"),this._raycastResult.reset(t,K),this._raycastResult}raycastToRef(t,K,D){i.V.Warn("raycast is not currently supported by the Oimo physics plugin"),D.reset(t,K)}}function mK(t){let K=t.pathArray;const D=t.closeArray||!1,a=t.closePath||!1,G=t.invertUV||!1,N=Math.floor(K[0].length/2);let W=t.offset||N;W=W>N?N:Math.floor(W);const x=0===t.sideOrientation?0:t.sideOrientation||A.P.DEFAULTSIDE,b=t.uvs,n=t.colors,e=[],i=[],z=[],I=[],Z=[],w=[],m=[],u=[];let d;const E=[],l=[];let Q,P,y;if(K.length<2){const t=[],D=[];for(P=0;P<K[0].length-W;P++)t.push(K[0][P]),D.push(K[0][P+W]);K=[t,D]}let q=0;const X=a?1:0,h=D?1:0;let J,T,_,C,H,o;for(d=K[0].length,Q=0;Q<K.length+h;Q++){for(m[Q]=0,Z[Q]=[0],J=Q===K.length?K[0]:K[Q],T=J.length,d=d<T?d:T,y=0;y<T;)e.push(J[y].x,J[y].y,J[y].z),y>0&&(_=J[y].subtract(J[y-1]).length(),C=_+m[Q],Z[Q].push(C),m[Q]=C),y++;a&&(y--,e.push(J[0].x,J[0].y,J[0].z),_=J[y].subtract(J[0]).length(),C=_+m[Q],Z[Q].push(C),m[Q]=C),E[Q]=T+X,l[Q]=q,q+=T+X}let U,V,s=null,F=null;for(P=0;P<d+X;P++)for(u[P]=0,w[P]=[0],Q=0;Q<K.length-1+h;Q++)H=K[Q],o=Q===K.length-1?K[0]:K[Q+1],P===d?(s=H[0],F=o[0]):(s=H[P],F=o[P]),_=F.subtract(s).length(),C=_+u[P],w[P].push(C),u[P]=C;if(b)for(Q=0;Q<b.length;Q++)I.push(b[Q].x,B.rX?1-b[Q].y:b[Q].y);else for(Q=0;Q<K.length+h;Q++)for(P=0;P<d+X;P++)U=0!=m[Q]?Z[Q][P]/m[Q]:0,V=0!=u[P]?w[P][Q]/u[P]:0,G?I.push(V,U):I.push(U,B.rX?1-V:V);Q=0;let c=0,g=E[Q]-1,Y=E[Q+1]-1,L=g<Y?g:Y,S=l[1]-l[0];const f=E.length-1;for(;c<=L&&Q<f;)i.push(c,c+S,c+1),i.push(c+S+1,c+1,c+S),c+=1,c===L&&(Q++,S=l[Q+1]-l[Q],g=E[Q]-1,Y=E[Q+1]-1,c=l[Q],L=g<Y?g+c:Y+c);if(A.P.ComputeNormals(e,i,z),a){let t=0,D=0;for(Q=0;Q<K.length;Q++){t=3*l[Q],D=Q+1<K.length?3*(l[Q+1]-1):z.length-3,z[t]=.5*(z[t]+z[D]),z[t+1]=.5*(z[t+1]+z[D+1]),z[t+2]=.5*(z[t+2]+z[D+2]);const a=Math.sqrt(z[t]*z[t]+z[t+1]*z[t+1]+z[t+2]*z[t+2]);z[t]/=a,z[t+1]/=a,z[t+2]/=a,z[D]=z[t],z[D+1]=z[t+1],z[D+2]=z[t+2]}}if(D){let t=3*l[0],D=3*l[K.length];for(P=0;P<d+X;P++){z[t]=.5*(z[t]+z[D]),z[t+1]=.5*(z[t+1]+z[D+1]),z[t+2]=.5*(z[t+2]+z[D+2]);const K=Math.sqrt(z[t]*z[t]+z[t+1]*z[t+1]+z[t+2]*z[t+2]);z[t]/=K,z[t+1]/=K,z[t+2]/=K,z[D]=z[t],z[D+1]=z[t+1],z[D+2]=z[t+2],t+=3,D+=3}}A.P._ComputeSides(x,e,i,z,I,t.frontUVs,t.backUVs);let $=null;if(n){$=new Float32Array(4*n.length);for(let t=0;t<n.length;t++)$[4*t]=n[t].r,$[4*t+1]=n[t].g,$[4*t+2]=n[t].b,$[4*t+3]=n[t].a}const O=new A.P,v=new Float32Array(e),p=new Float32Array(z),j=new Float32Array(I);return O.indices=i,O.positions=v,O.normals=p,O.uvs=j,$&&O.set($,R.R.ColorKind),a&&(O._idx=l),O}function uK(t,K,D=null){const a=K.pathArray,G=K.closeArray,W=K.closePath,x=Nt._GetDefaultSideOrientation(K.sideOrientation),b=K.instance,n=K.updatable;if(b){const t=N.AA.Vector3[0].setAll(Number.MAX_VALUE),D=N.AA.Vector3[1].setAll(-Number.MAX_VALUE),G=K=>{let G=a[0].length;const N=b;let W=0;const x=N._originalBuilderSideOrientation===Nt.DOUBLESIDE?2:1;for(let b=1;b<=x;++b)for(let x=0;x<a.length;++x){const b=a[x],n=b.length;G=G<n?G:n;for(let a=0;a<G;++a){const G=b[a];K[W]=G.x,K[W+1]=G.y,K[W+2]=G.z,t.minimizeInPlaceFromFloats(G.x,G.y,G.z),D.maximizeInPlaceFromFloats(G.x,G.y,G.z),W+=3}if(N._creationDataStorage&&N._creationDataStorage.closePath){const t=b[0];K[W]=t.x,K[W+1]=t.y,K[W+2]=t.z,W+=3}}},W=b.getVerticesData(R.R.PositionKind);if(G(W),b.hasBoundingInfo?b.getBoundingInfo().reConstruct(t,D,b._worldMatrix):b.buildBoundingInfo(t,D,b._worldMatrix),b.updateVerticesData(R.R.PositionKind,W,!1,!1),K.colors){const t=b.getVerticesData(R.R.ColorKind);for(let D=0,a=0;D<K.colors.length;D++,a+=4){const G=K.colors[D];t[a]=G.r,t[a+1]=G.g,t[a+2]=G.b,t[a+3]=G.a}b.updateVerticesData(R.R.ColorKind,t,!1,!1)}if(K.uvs){const t=b.getVerticesData(R.R.UVKind);for(let D=0;D<K.uvs.length;D++)t[2*D]=K.uvs[D].x,t[2*D+1]=B.rX?1-K.uvs[D].y:K.uvs[D].y;b.updateVerticesData(R.R.UVKind,t,!1,!1)}if(!b.areNormalsFrozen||b.isFacetDataEnabled){const t=b.getIndices(),K=b.getVerticesData(R.R.NormalKind),D=b.isFacetDataEnabled?b.getFacetDataParameters():null;if(A.P.ComputeNormals(W,t,K,D),b._creationDataStorage&&b._creationDataStorage.closePath){let t=0,D=0;for(let G=0;G<a.length;G++)t=3*b._creationDataStorage.idx[G],D=G+1<a.length?3*(b._creationDataStorage.idx[G+1]-1):K.length-3,K[t]=.5*(K[t]+K[D]),K[t+1]=.5*(K[t+1]+K[D+1]),K[t+2]=.5*(K[t+2]+K[D+2]),K[D]=K[t],K[D+1]=K[t+1],K[D+2]=K[t+2]}b.areNormalsFrozen||b.updateVerticesData(R.R.NormalKind,K,!1,!1)}return b}{const a=new Nt(t,D);a._originalBuilderSideOrientation=x,a._creationDataStorage=new tt;const N=mK(K);return W&&(a._creationDataStorage.idx=N._idx),a._creationDataStorage.closePath=W,a._creationDataStorage.closeArray=G,N.applyToMesh(a,n),a}}A.P.CreateRibbon=mK,Nt.CreateRibbon=(t,K,D=!1,a,G,N,W=!1,x,b)=>uK(t,{pathArray:K,closeArray:D,closePath:a,offset:G,updatable:W,sideOrientation:x,instance:b},N);var dK=D(808966);function EK(t,K,D=null){const a=K.path,G=K.shape,N=K.scale||1,W=K.rotation||0,x=0===K.cap?0:K.cap||Nt.NO_CAP,b=K.updatable,n=Nt._GetDefaultSideOrientation(K.sideOrientation),e=K.instance||null,i=K.invertUV||!1,z=K.closeShape||!1;return lK(t,G,a,N,W,null,null,K.closePath||!1,z,x,!1,D,!!b,n,e,i,K.frontUVs||null,K.backUVs||null,K.firstNormal||null,!!K.adjustFrame)}function lK(t,K,D,a,G,W,x,b,n,e,i,z,I,Z,w,m,u,d,E,l){const Q=(t,K,D,a,G,W,x,b,n,e,i)=>{const z=D.getTangents(),I=D.getNormals(),Z=D.getBinormals(),w=D.getDistances();if(i)for(let t=0;t<z.length;t++)if(0==z[t].x&&0==z[t].y&&0==z[t].z&&z[t].copyFrom(z[t-1]),0==I[t].x&&0==I[t].y&&0==I[t].z&&I[t].copyFrom(I[t-1]),0==Z[t].x&&0==Z[t].y&&0==Z[t].z&&Z[t].copyFrom(Z[t-1]),t>0){let K=z[t-1];N.Pq.Dot(K,z[t])<0&&z[t].scaleInPlace(-1),K=I[t-1],N.Pq.Dot(K,I[t])<0&&I[t].scaleInPlace(-1),K=Z[t-1],N.Pq.Dot(K,Z[t])<0&&Z[t].scaleInPlace(-1)}let m=0;const u=e&&b?b:()=>null!==W?W:0,d=e&&x?x:()=>null!==G?G:1;let E=n===Nt.NO_CAP||n===Nt.CAP_END?0:2;const l=N.AA.Matrix[0];for(let D=0;D<K.length;D++){const G=[],W=u(D,w[D]),x=d(D,w[D]);N.uq.RotationAxisToRef(z[D],m,l);for(let a=0;a<t.length;a++){const W=z[D].scale(t[a].z).add(I[D].scale(t[a].x)).add(Z[D].scale(t[a].y)),b=N.Pq.Zero();N.Pq.TransformCoordinatesToRef(W,l,b),b.scaleInPlace(x).addInPlace(K[D]),G[a]=b}a[E]=G,m+=W,E++}const Q=t=>{const K=Array(),D=N.Pq.Zero();let a;for(a=0;a<t.length;a++)D.addInPlace(t[a]);for(D.scaleInPlace(1/t.length),a=0;a<t.length;a++)K.push(D);return K};switch(n){case Nt.NO_CAP:break;case Nt.CAP_START:a[0]=Q(a[2]),a[1]=a[2];break;case Nt.CAP_END:a[E]=a[E-1],a[E+1]=Q(a[E-1]);break;case Nt.CAP_ALL:a[0]=Q(a[2]),a[1]=a[2],a[E]=a[E-1],a[E+1]=Q(a[E-1])}return a};let P,y;if(w){const t=w._creationDataStorage;return P=E?t.path3D.update(D,E):t.path3D.update(D),y=Q(K,D,t.path3D,t.pathArray,a,G,W,x,t.cap,i,l),uK("",{pathArray:y,closeArray:!1,closePath:!1,offset:0,updatable:!1,sideOrientation:0,instance:w},z||void 0)}P=E?new dK.tO(D,E):new dK.tO(D),y=Q(K,D,P,new Array,a,G,W,x,e=e<0||e>3?0:e,i,l);const q=uK(t,{pathArray:y,closeArray:b,closePath:n,updatable:I,sideOrientation:Z,invertUV:m,frontUVs:u||void 0,backUVs:d||void 0},z);return q._creationDataStorage.pathArray=y,q._creationDataStorage.path3D=P,q._creationDataStorage.cap=e,q}Nt.ExtrudeShape=(t,K,D,a,G,N,W=null,x,b,n)=>EK(t,{shape:K,path:D,scale:a,rotation:G,cap:0===N?0:N||Nt.NO_CAP,sideOrientation:b,instance:n,updatable:x},W),Nt.ExtrudeShapeCustom=(t,K,D,a,G,N,W,x,b,n,e,i)=>function(t,K,D=null){const a=K.path,G=K.shape,N=K.scaleFunction||(()=>1),W=K.rotationFunction||(()=>0),x=K.closePath||K.ribbonCloseArray||!1,b=K.closeShape||K.ribbonClosePath||!1,n=0===K.cap?0:K.cap||Nt.NO_CAP,e=K.updatable,i=K.firstNormal||null,z=K.adjustFrame||!1;return lK(t,G,a,null,null,N,W,x,b,n,!0,D,!!e,Nt._GetDefaultSideOrientation(K.sideOrientation),K.instance||null,K.invertUV||!1,K.frontUVs||null,K.backUVs||null,i,z)}(t,{shape:K,path:D,scaleFunction:a,rotationFunction:G,ribbonCloseArray:N,ribbonClosePath:W,cap:0===x?0:x||Nt.NO_CAP,sideOrientation:e,instance:i,updatable:n},b);var QK=D(889460),PK=D(522208),yK=D(235519),qK=D(651577),XK=D(855300);const hK={effect:null,subMesh:null};class JK extends yK.E{constructor(t,K,D,a={},G=!0){super(t,K,G),this._textures={},this._textureArrays={},this._externalTextures={},this._floats={},this._ints={},this._uints={},this._floatsArrays={},this._colors3={},this._colors3Arrays={},this._colors4={},this._colors4Arrays={},this._vectors2={},this._vectors3={},this._vectors4={},this._quaternions={},this._quaternionsArrays={},this._matrices={},this._matrixArrays={},this._matrices3x3={},this._matrices2x2={},this._vectors2Arrays={},this._vectors3Arrays={},this._vectors4Arrays={},this._uniformBuffers={},this._textureSamplers={},this._storageBuffers={},this._cachedWorldViewMatrix=new N.uq,this._cachedWorldViewProjectionMatrix=new N.uq,this._multiview=!1,this._materialHelperNeedsPreviousMatrices=!1,this._shaderPath=D,this._options={needAlphaBlending:!1,needAlphaTesting:!1,attributes:["position","normal","uv"],uniforms:["worldViewProjection"],uniformBuffers:[],samplers:[],externalTextures:[],samplerObjects:[],storageBuffers:[],defines:[],useClipPlane:!1,...a}}get shaderPath(){return this._shaderPath}set shaderPath(t){this._shaderPath=t}get options(){return this._options}get isMultiview(){return this._multiview}getClassName(){return"ShaderMaterial"}needAlphaBlending(){return this.alpha<1||this._options.needAlphaBlending}needAlphaTesting(){return this._options.needAlphaTesting}_checkUniform(t){-1===this._options.uniforms.indexOf(t)&&this._options.uniforms.push(t)}setTexture(t,K){return-1===this._options.samplers.indexOf(t)&&this._options.samplers.push(t),this._textures[t]=K,this}setTextureArray(t,K){return-1===this._options.samplers.indexOf(t)&&this._options.samplers.push(t),this._checkUniform(t),this._textureArrays[t]=K,this}setExternalTexture(t,K){return-1===this._options.externalTextures.indexOf(t)&&this._options.externalTextures.push(t),this._externalTextures[t]=K,this}setFloat(t,K){return this._checkUniform(t),this._floats[t]=K,this}setInt(t,K){return this._checkUniform(t),this._ints[t]=K,this}setUInt(t,K){return this._checkUniform(t),this._uints[t]=K,this}setFloats(t,K){return this._checkUniform(t),this._floatsArrays[t]=K,this}setColor3(t,K){return this._checkUniform(t),this._colors3[t]=K,this}setColor3Array(t,K){return this._checkUniform(t),this._colors3Arrays[t]=K.reduce(((t,K)=>(K.toArray(t,t.length),t)),[]),this}setColor4(t,K){return this._checkUniform(t),this._colors4[t]=K,this}setColor4Array(t,K){return this._checkUniform(t),this._colors4Arrays[t]=K.reduce(((t,K)=>(K.toArray(t,t.length),t)),[]),this}setVector2(t,K){return this._checkUniform(t),this._vectors2[t]=K,this}setVector3(t,K){return this._checkUniform(t),this._vectors3[t]=K,this}setVector4(t,K){return this._checkUniform(t),this._vectors4[t]=K,this}setQuaternion(t,K){return this._checkUniform(t),this._quaternions[t]=K,this}setQuaternionArray(t,K){return this._checkUniform(t),this._quaternionsArrays[t]=K.reduce(((t,K)=>(K.toArray(t,t.length),t)),[]),this}setMatrix(t,K){return this._checkUniform(t),this._matrices[t]=K,this}setMatrices(t,K){this._checkUniform(t);const D=new Float32Array(16*K.length);for(let t=0;t<K.length;t++)K[t].copyToArray(D,16*t);return this._matrixArrays[t]=D,this}setMatrix3x3(t,K){return this._checkUniform(t),this._matrices3x3[t]=K,this}setMatrix2x2(t,K){return this._checkUniform(t),this._matrices2x2[t]=K,this}setArray2(t,K){return this._checkUniform(t),this._vectors2Arrays[t]=K,this}setArray3(t,K){return this._checkUniform(t),this._vectors3Arrays[t]=K,this}setArray4(t,K){return this._checkUniform(t),this._vectors4Arrays[t]=K,this}setUniformBuffer(t,K){return-1===this._options.uniformBuffers.indexOf(t)&&this._options.uniformBuffers.push(t),this._uniformBuffers[t]=K,this}setTextureSampler(t,K){return-1===this._options.samplerObjects.indexOf(t)&&this._options.samplerObjects.push(t),this._textureSamplers[t]=K,this}setStorageBuffer(t,K){return-1===this._options.storageBuffers.indexOf(t)&&this._options.storageBuffers.push(t),this._storageBuffers[t]=K,this}setDefine(t,K){const D=t.trimEnd()+" ",a=this.options.defines.findIndex((K=>K===t||K.startsWith(D)));return a>=0&&this.options.defines.splice(a,1),("boolean"!=typeof K||K)&&this.options.defines.push(D+K),this}isReadyForSubMesh(t,K,D){return this.isReady(t,D,K)}isReady(t,K,D){var a,G,N,W;const x=D&&this._storeEffectOnSubMeshes;if(this.isFrozen){const t=x?D._drawWrapper:this._drawWrapper;if(t.effect&&t._wasPreviouslyReady&&t._wasPreviouslyUsingInstances===K)return!0}const b=this.getScene(),n=b.getEngine(),e=[],i=[],z=new PK.J;let I=this._shaderPath,Z=this._options.uniforms,w=this._options.uniformBuffers,m=this._options.samplers;n.getCaps().multiview&&b.activeCamera&&b.activeCamera.outputRenderTarget&&b.activeCamera.outputRenderTarget.getViewCount()>1&&(this._multiview=!0,e.push("#define MULTIVIEW"),-1!==Z.indexOf("viewProjection")&&-1===Z.indexOf("viewProjectionR")&&Z.push("viewProjectionR"));for(let t=0;t<this._options.defines.length;t++){const K=0===this._options.defines[t].indexOf("#define")?this._options.defines[t]:`#define ${this._options.defines[t]}`;e.push(K)}for(let t=0;t<this._options.attributes.length;t++)i.push(this._options.attributes[t]);if(t&&t.isVerticesDataPresent(R.R.ColorKind)&&(-1===i.indexOf(R.R.ColorKind)&&i.push(R.R.ColorKind),e.push("#define VERTEXCOLOR")),K&&(e.push("#define INSTANCES"),XK.te(i,this._materialHelperNeedsPreviousMatrices),(null==t?void 0:t.hasThinInstances)&&(e.push("#define THIN_INSTANCES"),t&&t.isVerticesDataPresent(R.R.ColorInstanceKind)&&(i.push(R.R.ColorInstanceKind),e.push("#define INSTANCESCOLOR")))),t&&t.useBones&&t.computeBonesUsingShaders&&t.skeleton){i.push(R.R.MatricesIndicesKind),i.push(R.R.MatricesWeightsKind),t.numBoneInfluencers>4&&(i.push(R.R.MatricesIndicesExtraKind),i.push(R.R.MatricesWeightsExtraKind));const K=t.skeleton;e.push("#define NUM_BONE_INFLUENCERS "+t.numBoneInfluencers),z.addCPUSkinningFallback(0,t),K.isUsingTextureForMatrices?(e.push("#define BONETEXTURE"),-1===Z.indexOf("boneTextureWidth")&&Z.push("boneTextureWidth"),-1===this._options.samplers.indexOf("boneSampler")&&this._options.samplers.push("boneSampler")):(e.push("#define BonesPerMesh "+(K.bones.length+1)),-1===Z.indexOf("mBones")&&Z.push("mBones"))}else e.push("#define NUM_BONE_INFLUENCERS 0");let u=0;const d=t?t.morphTargetManager:null;if(d){const t=d.supportsUVs&&-1!==e.indexOf("#define UV1"),K=d.supportsTangents&&-1!==e.indexOf("#define TANGENT"),D=d.supportsNormals&&-1!==e.indexOf("#define NORMAL");u=d.numMaxInfluencers||d.numInfluencers,t&&e.push("#define MORPHTARGETS_UV"),K&&e.push("#define MORPHTARGETS_TANGENT"),D&&e.push("#define MORPHTARGETS_NORMAL"),u>0&&e.push("#define MORPHTARGETS"),d.isUsingTextureForTargets&&(e.push("#define MORPHTARGETS_TEXTURE"),-1===Z.indexOf("morphTargetTextureIndices")&&Z.push("morphTargetTextureIndices"),-1===this._options.samplers.indexOf("morphTargets")&&this._options.samplers.push("morphTargets")),e.push("#define NUM_MORPH_INFLUENCERS "+u);for(let a=0;a<u;a++)i.push(R.R.PositionKind+a),D&&i.push(R.R.NormalKind+a),K&&i.push(R.R.TangentKind+a),t&&i.push(R.R.UVKind+"_"+a);u>0&&(Z=Z.slice(),Z.push("morphTargetInfluences"),Z.push("morphTargetCount"),Z.push("morphTargetTextureInfo"),Z.push("morphTargetTextureIndices"))}else e.push("#define NUM_MORPH_INFLUENCERS 0");if(t){const K=t.bakedVertexAnimationManager;K&&K.isEnabled&&(e.push("#define BAKED_VERTEX_ANIMATION_TEXTURE"),-1===Z.indexOf("bakedVertexAnimationSettings")&&Z.push("bakedVertexAnimationSettings"),-1===Z.indexOf("bakedVertexAnimationTextureSizeInverted")&&Z.push("bakedVertexAnimationTextureSizeInverted"),-1===Z.indexOf("bakedVertexAnimationTime")&&Z.push("bakedVertexAnimationTime"),-1===this._options.samplers.indexOf("bakedVertexAnimationTexture")&&this._options.samplers.push("bakedVertexAnimationTexture")),XK.J2(i,t,e)}for(const t in this._textures)if(!this._textures[t].isReady())return!1;t&&this._shouldTurnAlphaTestOn(t)&&e.push("#define ALPHATEST"),!1!==this._options.useClipPlane&&(qK.TV(Z),qK.tv(this,b,e)),b.fogEnabled&&(null==t?void 0:t.applyFog)&&b.fogMode!==QK.Z.FOGMODE_NONE&&(e.push("#define FOG"),-1===Z.indexOf("view")&&Z.push("view"),-1===Z.indexOf("vFogInfos")&&Z.push("vFogInfos"),-1===Z.indexOf("vFogColor")&&Z.push("vFogColor")),this._useLogarithmicDepth&&(e.push("#define LOGARITHMICDEPTH"),-1===Z.indexOf("logarithmicDepthConstant")&&Z.push("logarithmicDepthConstant")),this.customShaderNameResolve&&(Z=Z.slice(),w=w.slice(),m=m.slice(),I=this.customShaderNameResolve(this.name,Z,w,m,e,i));const E=x?D._getDrawWrapper(void 0,!0):this._drawWrapper,l=null!==(a=null==E?void 0:E.effect)&&void 0!==a?a:null,Q=null!==(G=null==E?void 0:E.defines)&&void 0!==G?G:null,P=e.join("\n");let y=l;return Q!==P&&(y=n.createEffect(I,{attributes:i,uniformsNames:Z,uniformBuffersNames:w,samplers:m,defines:P,fallbacks:z,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousMorphTargets:u},shaderLanguage:this._options.shaderLanguage,extraInitializationsAsync:this._options.extraInitializationsAsync},n),x?D.setEffect(y,P,this._materialContext):E&&E.setEffect(y,P),this._onEffectCreatedObservable&&(hK.effect=y,hK.subMesh=null!==(N=null!=D?D:null==t?void 0:t.subMeshes[0])&&void 0!==N?N:null,this._onEffectCreatedObservable.notifyObservers(hK))),E._wasPreviouslyUsingInstances=!!K,null!==(W=!(null==y?void 0:y.isReady()))&&void 0!==W&&!W&&(l!==y&&b.resetCachedMaterial(),E._wasPreviouslyReady=!0,!0)}bindOnlyWorldMatrix(t,K){const D=this.getScene(),a=null!=K?K:this.getEffect();a&&(-1!==this._options.uniforms.indexOf("world")&&a.setMatrix("world",t),-1!==this._options.uniforms.indexOf("worldView")&&(t.multiplyToRef(D.getViewMatrix(),this._cachedWorldViewMatrix),a.setMatrix("worldView",this._cachedWorldViewMatrix)),-1!==this._options.uniforms.indexOf("worldViewProjection")&&(t.multiplyToRef(D.getTransformMatrix(),this._cachedWorldViewProjectionMatrix),a.setMatrix("worldViewProjection",this._cachedWorldViewProjectionMatrix)),-1!==this._options.uniforms.indexOf("view")&&a.setMatrix("view",D.getViewMatrix()))}bindForSubMesh(t,K,D){var a;this.bind(t,K,null===(a=D._drawWrapperOverride)||void 0===a?void 0:a.effect,D)}bind(t,K,D,a){var G;const N=a&&this._storeEffectOnSubMeshes,W=null!=D?D:N?a.effect:this.getEffect();if(!W)return;const x=this.getScene();this._activeEffect=W,this.bindOnlyWorldMatrix(t,D);const b=this._options.uniformBuffers;let n=!1;if(W&&b&&b.length>0&&x.getEngine().supportsUniformBuffers)for(let D=0;D<b.length;++D)switch(b[D]){case"Mesh":K&&(K.getMeshUniformBuffer().bindToEffect(W,"Mesh"),K.transferToEffect(t));break;case"Scene":XK._8(W,x.getSceneUniformBuffer()),x.finalizeSceneUbo(),n=!0}const e=K&&N?this._mustRebind(x,W,a,K.visibility):x.getCachedMaterial()!==this;if(W&&e){let t;for(t in n||-1===this._options.uniforms.indexOf("view")||W.setMatrix("view",x.getViewMatrix()),n||-1===this._options.uniforms.indexOf("projection")||W.setMatrix("projection",x.getProjectionMatrix()),n||-1===this._options.uniforms.indexOf("viewProjection")||(W.setMatrix("viewProjection",x.getTransformMatrix()),this._multiview&&W.setMatrix("viewProjectionR",x._transformMatrixR)),x.activeCamera&&-1!==this._options.uniforms.indexOf("cameraPosition")&&W.setVector3("cameraPosition",x.activeCamera.globalPosition),XK.f$(K,W),qK.gS(W,this,x),this._useLogarithmicDepth&&XK.DL(N?a.materialDefines:W.defines,W,x),K&&XK.Yy(x,K,W),this._textures)W.setTexture(t,this._textures[t]);for(t in this._textureArrays)W.setTextureArray(t,this._textureArrays[t]);for(t in this._ints)W.setInt(t,this._ints[t]);for(t in this._uints)W.setUInt(t,this._uints[t]);for(t in this._floats)W.setFloat(t,this._floats[t]);for(t in this._floatsArrays)W.setArray(t,this._floatsArrays[t]);for(t in this._colors3)W.setColor3(t,this._colors3[t]);for(t in this._colors3Arrays)W.setArray3(t,this._colors3Arrays[t]);for(t in this._colors4){const K=this._colors4[t];W.setFloat4(t,K.r,K.g,K.b,K.a)}for(t in this._colors4Arrays)W.setArray4(t,this._colors4Arrays[t]);for(t in this._vectors2)W.setVector2(t,this._vectors2[t]);for(t in this._vectors3)W.setVector3(t,this._vectors3[t]);for(t in this._vectors4)W.setVector4(t,this._vectors4[t]);for(t in this._quaternions)W.setQuaternion(t,this._quaternions[t]);for(t in this._matrices)W.setMatrix(t,this._matrices[t]);for(t in this._matrixArrays)W.setMatrices(t,this._matrixArrays[t]);for(t in this._matrices3x3)W.setMatrix3x3(t,this._matrices3x3[t]);for(t in this._matrices2x2)W.setMatrix2x2(t,this._matrices2x2[t]);for(t in this._vectors2Arrays)W.setArray2(t,this._vectors2Arrays[t]);for(t in this._vectors3Arrays)W.setArray3(t,this._vectors3Arrays[t]);for(t in this._vectors4Arrays)W.setArray4(t,this._vectors4Arrays[t]);for(t in this._quaternionsArrays)W.setArray4(t,this._quaternionsArrays[t]);for(t in this._uniformBuffers){const K=this._uniformBuffers[t].getBuffer();K&&W.bindUniformBuffer(K,t)}const D=x.getEngine(),G=D.setExternalTexture;if(G)for(t in this._externalTextures)G.call(D,t,this._externalTextures[t]);const b=D.setTextureSampler;if(b)for(t in this._textureSamplers)b.call(D,t,this._textureSamplers[t]);const e=D.setStorageBuffer;if(e)for(t in this._storageBuffers)e.call(D,t,this._storageBuffers[t])}if(W&&K&&(e||!this.isFrozen)){const t=K.morphTargetManager;t&&t.numInfluencers>0&&XK.nR(K,W);const D=K.bakedVertexAnimationManager;if(D&&D.isEnabled){const t=N?a._drawWrapper:this._drawWrapper;null===(G=K.bakedVertexAnimationManager)||void 0===G||G.bind(W,!!t._wasPreviouslyUsingInstances)}}this._afterBind(K,W,a)}getActiveTextures(){const t=super.getActiveTextures();for(const K in this._textures)t.push(this._textures[K]);for(const K in this._textureArrays){const D=this._textureArrays[K];for(let K=0;K<D.length;K++)t.push(D[K])}return t}hasTexture(t){if(super.hasTexture(t))return!0;for(const K in this._textures)if(this._textures[K]===t)return!0;for(const K in this._textureArrays){const D=this._textureArrays[K];for(let K=0;K<D.length;K++)if(D[K]===t)return!0}return!1}clone(t){const K=z.p.Clone((()=>new JK(t,this.getScene(),this._shaderPath,this._options,this._storeEffectOnSubMeshes)),this);K.name=t,K.id=t,"object"==typeof K._shaderPath&&(K._shaderPath={...K._shaderPath}),this._options={...this._options},Object.keys(this._options).forEach((t=>{const K=this._options[t];Array.isArray(K)&&(this._options[t]=K.slice(0))})),this.stencil.copyTo(K.stencil);for(const t in this._textures)K.setTexture(t,this._textures[t]);for(const t in this._textureArrays)K.setTextureArray(t,this._textureArrays[t]);for(const t in this._externalTextures)K.setExternalTexture(t,this._externalTextures[t]);for(const t in this._ints)K.setInt(t,this._ints[t]);for(const t in this._uints)K.setUInt(t,this._uints[t]);for(const t in this._floats)K.setFloat(t,this._floats[t]);for(const t in this._floatsArrays)K.setFloats(t,this._floatsArrays[t]);for(const t in this._colors3)K.setColor3(t,this._colors3[t]);for(const t in this._colors3Arrays)K._colors3Arrays[t]=this._colors3Arrays[t];for(const t in this._colors4)K.setColor4(t,this._colors4[t]);for(const t in this._colors4Arrays)K._colors4Arrays[t]=this._colors4Arrays[t];for(const t in this._vectors2)K.setVector2(t,this._vectors2[t]);for(const t in this._vectors3)K.setVector3(t,this._vectors3[t]);for(const t in this._vectors4)K.setVector4(t,this._vectors4[t]);for(const t in this._quaternions)K.setQuaternion(t,this._quaternions[t]);for(const t in this._quaternionsArrays)K._quaternionsArrays[t]=this._quaternionsArrays[t];for(const t in this._matrices)K.setMatrix(t,this._matrices[t]);for(const t in this._matrixArrays)K._matrixArrays[t]=this._matrixArrays[t].slice();for(const t in this._matrices3x3)K.setMatrix3x3(t,this._matrices3x3[t]);for(const t in this._matrices2x2)K.setMatrix2x2(t,this._matrices2x2[t]);for(const t in this._vectors2Arrays)K.setArray2(t,this._vectors2Arrays[t]);for(const t in this._vectors3Arrays)K.setArray3(t,this._vectors3Arrays[t]);for(const t in this._vectors4Arrays)K.setArray4(t,this._vectors4Arrays[t]);for(const t in this._uniformBuffers)K.setUniformBuffer(t,this._uniformBuffers[t]);for(const t in this._textureSamplers)K.setTextureSampler(t,this._textureSamplers[t]);for(const t in this._storageBuffers)K.setStorageBuffer(t,this._storageBuffers[t]);return K}dispose(t,K,D){if(K){let t;for(t in this._textures)this._textures[t].dispose();for(t in this._textureArrays){const K=this._textureArrays[t];for(let t=0;t<K.length;t++)K[t].dispose()}}this._textures={},super.dispose(t,K,D)}serialize(){const t=z.p.Serialize(this);let K;for(K in t.customType="BABYLON.ShaderMaterial",t.uniqueId=this.uniqueId,t.options=this._options,t.shaderPath=this._shaderPath,t.storeEffectOnSubMeshes=this._storeEffectOnSubMeshes,t.stencil=this.stencil.serialize(),t.textures={},this._textures)t.textures[K]=this._textures[K].serialize();for(K in t.textureArrays={},this._textureArrays){t.textureArrays[K]=[];const D=this._textureArrays[K];for(let a=0;a<D.length;a++)t.textureArrays[K].push(D[a].serialize())}for(K in t.ints={},this._ints)t.ints[K]=this._ints[K];for(K in t.uints={},this._uints)t.uints[K]=this._uints[K];for(K in t.floats={},this._floats)t.floats[K]=this._floats[K];for(K in t.floatsArrays={},this._floatsArrays)t.floatsArrays[K]=this._floatsArrays[K];for(K in t.colors3={},this._colors3)t.colors3[K]=this._colors3[K].asArray();for(K in t.colors3Arrays={},this._colors3Arrays)t.colors3Arrays[K]=this._colors3Arrays[K];for(K in t.colors4={},this._colors4)t.colors4[K]=this._colors4[K].asArray();for(K in t.colors4Arrays={},this._colors4Arrays)t.colors4Arrays[K]=this._colors4Arrays[K];for(K in t.vectors2={},this._vectors2)t.vectors2[K]=this._vectors2[K].asArray();for(K in t.vectors3={},this._vectors3)t.vectors3[K]=this._vectors3[K].asArray();for(K in t.vectors4={},this._vectors4)t.vectors4[K]=this._vectors4[K].asArray();for(K in t.quaternions={},this._quaternions)t.quaternions[K]=this._quaternions[K].asArray();for(K in t.matrices={},this._matrices)t.matrices[K]=this._matrices[K].asArray();for(K in t.matrixArray={},this._matrixArrays)t.matrixArray[K]=this._matrixArrays[K];for(K in t.matrices3x3={},this._matrices3x3)t.matrices3x3[K]=this._matrices3x3[K];for(K in t.matrices2x2={},this._matrices2x2)t.matrices2x2[K]=this._matrices2x2[K];for(K in t.vectors2Arrays={},this._vectors2Arrays)t.vectors2Arrays[K]=this._vectors2Arrays[K];for(K in t.vectors3Arrays={},this._vectors3Arrays)t.vectors3Arrays[K]=this._vectors3Arrays[K];for(K in t.vectors4Arrays={},this._vectors4Arrays)t.vectors4Arrays[K]=this._vectors4Arrays[K];for(K in t.quaternionsArrays={},this._quaternionsArrays)t.quaternionsArrays[K]=this._quaternionsArrays[K];return t}static Parse(t,K,D){const a=z.p.Parse((()=>new JK(t.name,K,t.shaderPath,t.options,t.storeEffectOnSubMeshes)),t,K,D);let G;for(G in t.stencil&&a.stencil.parse(t.stencil,K,D),t.textures)a.setTexture(G,U.g.Parse(t.textures[G],K,D));for(G in t.textureArrays){const N=t.textureArrays[G],W=[];for(let t=0;t<N.length;t++)W.push(U.g.Parse(N[t],K,D));a.setTextureArray(G,W)}for(G in t.ints)a.setInt(G,t.ints[G]);for(G in t.uints)a.setUInt(G,t.uints[G]);for(G in t.floats)a.setFloat(G,t.floats[G]);for(G in t.floatsArrays)a.setFloats(G,t.floatsArrays[G]);for(G in t.colors3)a.setColor3(G,s.v9.FromArray(t.colors3[G]));for(G in t.colors3Arrays){const K=t.colors3Arrays[G].reduce(((t,K,D)=>(D%3==0?t.push([K]):t[t.length-1].push(K),t)),[]).map((t=>s.v9.FromArray(t)));a.setColor3Array(G,K)}for(G in t.colors4)a.setColor4(G,s.ov.FromArray(t.colors4[G]));for(G in t.colors4Arrays){const K=t.colors4Arrays[G].reduce(((t,K,D)=>(D%4==0?t.push([K]):t[t.length-1].push(K),t)),[]).map((t=>s.ov.FromArray(t)));a.setColor4Array(G,K)}for(G in t.vectors2)a.setVector2(G,N.I9.FromArray(t.vectors2[G]));for(G in t.vectors3)a.setVector3(G,N.Pq.FromArray(t.vectors3[G]));for(G in t.vectors4)a.setVector4(G,N.IU.FromArray(t.vectors4[G]));for(G in t.quaternions)a.setQuaternion(G,N.PT.FromArray(t.quaternions[G]));for(G in t.matrices)a.setMatrix(G,N.uq.FromArray(t.matrices[G]));for(G in t.matrixArray)a._matrixArrays[G]=new Float32Array(t.matrixArray[G]);for(G in t.matrices3x3)a.setMatrix3x3(G,t.matrices3x3[G]);for(G in t.matrices2x2)a.setMatrix2x2(G,t.matrices2x2[G]);for(G in t.vectors2Arrays)a.setArray2(G,t.vectors2Arrays[G]);for(G in t.vectors3Arrays)a.setArray3(G,t.vectors3Arrays[G]);for(G in t.vectors4Arrays)a.setArray4(G,t.vectors4Arrays[G]);for(G in t.quaternionsArrays)a.setArray4(G,t.quaternionsArrays[G]);return a}static ParseFromFileAsync(t,K,D,a=""){return new Promise(((G,N)=>{const W=new Ht.u;W.addEventListener("readystatechange",(()=>{if(4==W.readyState)if(200==W.status){const K=JSON.parse(W.responseText),N=this.Parse(K,D||$.q.LastCreatedScene,a);t&&(N.name=t),G(N)}else N("Unable to load the ShaderMaterial")})),W.open("GET",K),W.send()}))}static ParseFromSnippetAsync(t,K,D=""){return new Promise(((a,G)=>{const N=new Ht.u;N.addEventListener("readystatechange",(()=>{if(4==N.readyState)if(200==N.status){const G=JSON.parse(JSON.parse(N.responseText).jsonPayload),W=JSON.parse(G.shaderMaterial),x=this.Parse(W,K||$.q.LastCreatedScene,D);x.snippetId=t,a(x)}else G("Unable to load the snippet "+t)})),N.open("GET",this.SnippetUrl+"/"+t.replace(/#/g,"/")),N.send()}))}}JK.SnippetUrl=`https://snippet.babylonjs.com`,JK.CreateFromSnippetAsync=JK.ParseFromSnippetAsync,J.Y5("BABYLON.ShaderMaterial",JK),Nt._LinesMeshParser=(t,K)=>TK.Parse(t,K);class TK extends Nt{_isShaderMaterial(t){return"ShaderMaterial"===t.getClassName()}constructor(t,K=null,a=null,G=null,N,W,x,b){super(t,K,a,G,N),this.useVertexColor=W,this.useVertexAlpha=x,this.color=new s.v9(1,1,1),this.alpha=1,this._shaderLanguage=0,G&&(this.color=G.color.clone(),this.alpha=G.alpha,this.useVertexColor=G.useVertexColor,this.useVertexAlpha=G.useVertexAlpha),this.intersectionThreshold=.1;const n={attributes:[R.R.PositionKind],uniforms:["world","viewProjection"],needAlphaBlending:!0,defines:[],useClipPlane:null,shaderLanguage:0};!1===x?n.needAlphaBlending=!1:n.defines.push("#define VERTEXALPHA"),W?(n.defines.push("#define VERTEXCOLOR"),n.attributes.push(R.R.ColorKind)):(n.uniforms.push("color"),this._color4=new s.ov),b?this.material=b:(this.getScene().getEngine().isWebGPU&&!TK.ForceGLSL&&(this._shaderLanguage=1),n.shaderLanguage=this._shaderLanguage,n.extraInitializationsAsync=async()=>{1===this._shaderLanguage?await Promise.all([D.e(28276).then(D.bind(D,28276)),D.e(56926).then(D.bind(D,556926))]):await Promise.all([D.e(29251).then(D.bind(D,129251)),D.e(26089).then(D.bind(D,626089))])},this.material=new JK("colorShader",this.getScene(),"color",n,!1),this.material.doNotSerialize=!0)}isReady(){return!!this._lineMaterial.isReady(this,!!this._userInstancedBuffersStorage||this.hasThinInstances)&&super.isReady()}getClassName(){return"LinesMesh"}get material(){return this._lineMaterial}set material(t){this._lineMaterial=t,this._lineMaterial.fillMode=p.i.LineListDrawMode}get checkCollisions(){return!1}set checkCollisions(t){}_bind(t,K){if(!this._geometry)return this;const D=this.isUnIndexed?null:this._geometry.getIndexBuffer();if(!this._userInstancedBuffersStorage||this.hasThinInstances?this._geometry._bind(K,D):this._geometry._bind(K,D,this._userInstancedBuffersStorage.vertexBuffers,this._userInstancedBuffersStorage.vertexArrayObjects),!this.useVertexColor&&this._isShaderMaterial(this._lineMaterial)){const{r:t,g:K,b:D}=this.color;this._color4.set(t,K,D,this.alpha),this._lineMaterial.setColor4("color",this._color4)}return this}_draw(t,K,D){if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;const a=this.getScene().getEngine();return this._unIndexed?a.drawArraysType(p.i.LineListDrawMode,t.verticesStart,t.verticesCount,D):a.drawElementsType(p.i.LineListDrawMode,t.indexStart,t.indexCount,D),this}dispose(t,K=!1,D){D||this._lineMaterial.dispose(!1,!1,!0),super.dispose(t)}clone(t,K=null,D){return new TK(t,this.getScene(),K,this,D)}createInstance(t){const K=new _K(t,this);if(this.instancedBuffers){K.instancedBuffers={};for(const t in this.instancedBuffers)K.instancedBuffers[t]=this.instancedBuffers[t]}return K}serialize(t){super.serialize(t),t.color=this.color.asArray(),t.alpha=this.alpha}static Parse(t,K){const D=new TK(t.name,K);return D.color=s.v9.FromArray(t.color),D.alpha=t.alpha,D}}TK.ForceGLSL=!1;class _K extends ft{constructor(t,K){super(t,K),this.intersectionThreshold=K.intersectionThreshold}getClassName(){return"InstancedLinesMesh"}}function CK(t){const K=[],D=[],a=t.lines,G=t.colors,N=[];let W=0;for(let t=0;t<a.length;t++){const x=a[t];for(let a=0;a<x.length;a++){const{x:b,y:n,z:e}=x[a];if(D.push(b,n,e),G){const K=G[t],{r:D,g:W,b:x,a:b}=K[a];N.push(D,W,x,b)}a>0&&(K.push(W-1),K.push(W)),W++}}const x=new A.P;return x.indices=K,x.positions=D,G&&(x.colors=N),x}function HK(t){const K=t.dashSize||3,D=t.gapSize||1,a=t.dashNb||200,G=t.points,W=[],x=[],b=N.Pq.Zero();let n=0,e=0,i=0,z=0,I=0,Z=0,w=0;for(w=0;w<G.length-1;w++)G[w+1].subtractToRef(G[w],b),n+=b.length();for(i=n/a,z=K*i/(K+D),w=0;w<G.length-1;w++){G[w+1].subtractToRef(G[w],b),e=Math.floor(b.length()/i),b.normalize();for(let t=0;t<e;t++)I=i*t,W.push(G[w].x+I*b.x,G[w].y+I*b.y,G[w].z+I*b.z),W.push(G[w].x+(I+z)*b.x,G[w].y+(I+z)*b.y,G[w].z+(I+z)*b.z),x.push(Z,Z+1),Z+=2}const m=new A.P;return m.positions=W,m.indices=x,m}function oK(t,K,D=null){const a=K.colors?[K.colors]:null;return function(t,K,D=null){const a=K.instance,G=K.lines,N=K.colors;if(a){const t=a.getVerticesData(R.R.PositionKind);let K,D;N&&(K=a.getVerticesData(R.R.ColorKind));let W=0,x=0;for(let a=0;a<G.length;a++){const b=G[a];for(let G=0;G<b.length;G++)t[W]=b[G].x,t[W+1]=b[G].y,t[W+2]=b[G].z,N&&K&&(D=N[a],K[x]=D[G].r,K[x+1]=D[G].g,K[x+2]=D[G].b,K[x+3]=D[G].a,x+=4),W+=3}return a.updateVerticesData(R.R.PositionKind,t,!1,!1),N&&K&&a.updateVerticesData(R.R.ColorKind,K,!1,!1),a.refreshBoundingInfo(),a}const W=new TK(t,D,null,void 0,void 0,!!N,K.useVertexAlpha,K.material);return CK(K).applyToMesh(W,K.updatable),W}(t,{lines:[K.points],updatable:K.updatable,instance:K.instance,colors:a,useVertexAlpha:K.useVertexAlpha,material:K.material},D)}A.P.CreateLineSystem=CK,A.P.CreateDashedLines=HK,Nt.CreateLines=(t,K,D=null,a=!1,G=null)=>oK(t,{points:K,updatable:a,instance:G},D),Nt.CreateDashedLines=(t,K,D,a,G,W=null,x,b)=>function(t,K,D=null){const a=K.points,G=K.instance,W=K.gapSize||1,x=K.dashSize||3;if(G){const t=t=>{const K=N.Pq.Zero(),D=t.length/6;let W=0,x=0,b=0,n=0,e=0,i=0,z=0,I=0;for(z=0;z<a.length-1;z++)a[z+1].subtractToRef(a[z],K),W+=K.length();b=W/D;const Z=G._creationDataStorage.dashSize;for(n=Z*b/(Z+G._creationDataStorage.gapSize),z=0;z<a.length-1;z++)for(a[z+1].subtractToRef(a[z],K),x=Math.floor(K.length()/b),K.normalize(),I=0;I<x&&i<t.length;)e=b*I,t[i]=a[z].x+e*K.x,t[i+1]=a[z].y+e*K.y,t[i+2]=a[z].z+e*K.z,t[i+3]=a[z].x+(e+n)*K.x,t[i+4]=a[z].y+(e+n)*K.y,t[i+5]=a[z].z+(e+n)*K.z,i+=6,I++;for(;i<t.length;)t[i]=a[z].x,t[i+1]=a[z].y,t[i+2]=a[z].z,i+=3};return(K.dashNb||K.dashSize||K.gapSize||K.useVertexAlpha||K.material)&&i.V.Warn("You have used an option other than points with the instance option. Please be aware that these other options will be ignored."),G.updateMeshPositions(t,!1),G}const b=new TK(t,D,null,void 0,void 0,void 0,K.useVertexAlpha,K.material);return HK(K).applyToMesh(b,K.updatable),b._creationDataStorage=new tt,b._creationDataStorage.dashSize=x,b._creationDataStorage.gapSize=W,b}(t,{points:K,dashSize:D,gapSize:a,dashNb:G,updatable:x,instance:b},W);class UK{constructor(t=!0,K=Ammo,D=null){this._useDeltaForWorldStep=t,this.bjsAMMO={},this.name="AmmoJSPlugin",this._timeStep=1/60,this._fixedTimeStep=1/60,this._maxSteps=5,this._tmpQuaternion=new N.PT,this._tmpContactCallbackResult=!1,this._tmpContactPoint=new N.Pq,this._tmpContactNormal=new N.Pq,this._tmpVec3=new N.Pq,this._tmpMatrix=new N.uq,"function"!=typeof K?(this.bjsAMMO=K,this.isSupported()?(this._collisionConfiguration=new this.bjsAMMO.btSoftBodyRigidBodyCollisionConfiguration,this._dispatcher=new this.bjsAMMO.btCollisionDispatcher(this._collisionConfiguration),this._overlappingPairCache=D||new this.bjsAMMO.btDbvtBroadphase,this._solver=new this.bjsAMMO.btSequentialImpulseConstraintSolver,this._softBodySolver=new this.bjsAMMO.btDefaultSoftBodySolver,this.world=new this.bjsAMMO.btSoftRigidDynamicsWorld(this._dispatcher,this._overlappingPairCache,this._solver,this._collisionConfiguration,this._softBodySolver),this._tmpAmmoConcreteContactResultCallback=new this.bjsAMMO.ConcreteContactResultCallback,this._tmpAmmoConcreteContactResultCallback.addSingleResult=t=>{const K=(t=this.bjsAMMO.wrapPointer(t,this.bjsAMMO.btManifoldPoint)).getPositionWorldOnA(),D=t.m_normalWorldOnB;this._tmpContactPoint.x=K.x(),this._tmpContactPoint.y=K.y(),this._tmpContactPoint.z=K.z(),this._tmpContactNormal.x=D.x(),this._tmpContactNormal.y=D.y(),this._tmpContactNormal.z=D.z(),this._tmpContactImpulse=t.getAppliedImpulse(),this._tmpContactDistance=t.getDistance(),this._tmpContactCallbackResult=!0},this._raycastResult=new zK,this._tmpAmmoTransform=new this.bjsAMMO.btTransform,this._tmpAmmoTransform.setIdentity(),this._tmpAmmoQuaternion=new this.bjsAMMO.btQuaternion(0,0,0,1),this._tmpAmmoVectorA=new this.bjsAMMO.btVector3(0,0,0),this._tmpAmmoVectorB=new this.bjsAMMO.btVector3(0,0,0),this._tmpAmmoVectorC=new this.bjsAMMO.btVector3(0,0,0),this._tmpAmmoVectorD=new this.bjsAMMO.btVector3(0,0,0)):i.V.Error("AmmoJS is not available. Please make sure you included the js file.")):i.V.Error("AmmoJS is not ready. Please make sure you await Ammo() before using the plugin.")}getPluginVersion(){return 1}setGravity(t){this._tmpAmmoVectorA.setValue(t.x,t.y,t.z),this.world.setGravity(this._tmpAmmoVectorA),this.world.getWorldInfo().set_m_gravity(this._tmpAmmoVectorA)}setTimeStep(t){this._timeStep=t}setFixedTimeStep(t){this._fixedTimeStep=t}setMaxSteps(t){this._maxSteps=t}getTimeStep(){return this._timeStep}_isImpostorInContact(t){return this._tmpContactCallbackResult=!1,this.world.contactTest(t.physicsBody,this._tmpAmmoConcreteContactResultCallback),this._tmpContactCallbackResult}_isImpostorPairInContact(t,K){return this._tmpContactCallbackResult=!1,this.world.contactPairTest(t.physicsBody,K.physicsBody,this._tmpAmmoConcreteContactResultCallback),this._tmpContactCallbackResult}_stepSimulation(t=1/60,K=10,D=1/60){if(0==K)this.world.stepSimulation(t,0);else for(;K>0&&t>0;)t-D<D?(this.world.stepSimulation(t,0),t=0):(t-=D,this.world.stepSimulation(D,0)),K--}executeStep(t,K){for(const t of K)t.soft||t.beforeStep();this._stepSimulation(this._useDeltaForWorldStep?t:this._timeStep,this._maxSteps,this._fixedTimeStep);for(const t of K)if(t.soft?this._afterSoftStep(t):t.afterStep(),t._onPhysicsCollideCallbacks.length>0&&this._isImpostorInContact(t))for(const K of t._onPhysicsCollideCallbacks)for(const D of K.otherImpostors)(t.physicsBody.isActive()||D.physicsBody.isActive())&&this._isImpostorPairInContact(t,D)&&(t.onCollide({body:D.physicsBody,point:this._tmpContactPoint,distance:this._tmpContactDistance,impulse:this._tmpContactImpulse,normal:this._tmpContactNormal}),D.onCollide({body:t.physicsBody,point:this._tmpContactPoint,distance:this._tmpContactDistance,impulse:this._tmpContactImpulse,normal:this._tmpContactNormal}))}_afterSoftStep(t){t.type===eK.RopeImpostor?this._ropeStep(t):this._softbodyOrClothStep(t)}_ropeStep(t){const K=t.physicsBody.get_m_nodes(),D=K.size();let a,G,W,x,b;const n=new Array;for(let t=0;t<D;t++)a=K.at(t),G=a.get_m_x(),W=G.x(),x=G.y(),b=G.z(),n.push(new N.Pq(W,x,b));const e=t.object,i=t.getParam("shape");t._isFromLine?t.object=oK("lines",{points:n,instance:e}):t.object=EK("ext",{shape:i,path:n,instance:e})}_softbodyOrClothStep(t){const K=t.type===eK.ClothImpostor?1:-1,D=t.object;let a=D.getVerticesData(R.R.PositionKind);a||(a=[]);let G=D.getVerticesData(R.R.NormalKind);G||(G=[]);const N=a.length/3,W=t.physicsBody.get_m_nodes();let x,b,n,e,i,z,I,Z;for(let t=0;t<N;t++){x=W.at(t),b=x.get_m_x(),n=b.x(),e=b.y(),i=b.z()*K;const D=x.get_m_n();z=D.x(),I=D.y(),Z=D.z()*K,a[3*t]=n,a[3*t+1]=e,a[3*t+2]=i,G[3*t]=z,G[3*t+1]=I,G[3*t+2]=Z}const w=new A.P;w.positions=a,w.normals=G,w.uvs=D.getVerticesData(R.R.UVKind),w.colors=D.getVerticesData(R.R.ColorKind),D&&D.getIndices&&(w.indices=D.getIndices()),w.applyToMesh(D)}applyImpulse(t,K,D){if(t.soft)i.V.Warn("Cannot be applied to a soft body");else{t.physicsBody.activate();const a=this._tmpAmmoVectorA,G=this._tmpAmmoVectorB;t.object&&t.object.getWorldMatrix&&D.subtractInPlace(t.object.getWorldMatrix().getTranslation()),a.setValue(D.x,D.y,D.z),G.setValue(K.x,K.y,K.z),t.physicsBody.applyImpulse(G,a)}}applyForce(t,K,D){if(t.soft)i.V.Warn("Cannot be applied to a soft body");else{t.physicsBody.activate();const a=this._tmpAmmoVectorA,G=this._tmpAmmoVectorB;if(t.object&&t.object.getWorldMatrix){const K=t.object.getWorldMatrix().getTranslation();a.setValue(D.x-K.x,D.y-K.y,D.z-K.z)}else a.setValue(D.x,D.y,D.z);G.setValue(K.x,K.y,K.z),t.physicsBody.applyForce(G,a)}}generatePhysicsBody(t){if(t._pluginData.toDispose=[],t.parent)t.physicsBody&&(this.removePhysicsBody(t),t.forceUpdate());else if(t.isBodyInitRequired()){const K=this._createShape(t),D=t.getParam("mass");if(t._pluginData.mass=D,t.soft)K.get_m_cfg().set_collisions(17),K.get_m_cfg().set_kDP(t.getParam("damping")),this.bjsAMMO.castObject(K,this.bjsAMMO.btCollisionObject).getCollisionShape().setMargin(t.getParam("margin")),K.setActivationState(UK._DISABLE_DEACTIVATION_FLAG),this.world.addSoftBody(K,1,-1),t.physicsBody=K,t._pluginData.toDispose.push(K),this.setBodyPressure(t,0),t.type===eK.SoftbodyImpostor&&this.setBodyPressure(t,t.getParam("pressure")),this.setBodyStiffness(t,t.getParam("stiffness")),this.setBodyVelocityIterations(t,t.getParam("velocityIterations")),this.setBodyPositionIterations(t,t.getParam("positionIterations"));else{const a=new this.bjsAMMO.btVector3(0,0,0),G=new this.bjsAMMO.btTransform;t.object.computeWorldMatrix(!0),G.setIdentity(),0!==D&&K.calculateLocalInertia(D,a),this._tmpAmmoVectorA.setValue(t.object.position.x,t.object.position.y,t.object.position.z),this._tmpAmmoQuaternion.setValue(t.object.rotationQuaternion.x,t.object.rotationQuaternion.y,t.object.rotationQuaternion.z,t.object.rotationQuaternion.w),G.setOrigin(this._tmpAmmoVectorA),G.setRotation(this._tmpAmmoQuaternion);const N=new this.bjsAMMO.btDefaultMotionState(G),W=new this.bjsAMMO.btRigidBodyConstructionInfo(D,N,K,a),x=new this.bjsAMMO.btRigidBody(W);if(0===D&&(x.setCollisionFlags(x.getCollisionFlags()|UK._KINEMATIC_FLAG),x.setActivationState(UK._DISABLE_DEACTIVATION_FLAG)),t.type!=eK.NoImpostor||K.getChildShape||x.setCollisionFlags(x.getCollisionFlags()|UK._DISABLE_COLLISION_FLAG),t.type!==eK.MeshImpostor&&t.type!==eK.NoImpostor){const K=t.object.getBoundingInfo();this._tmpVec3.copyFrom(t.object.getAbsolutePosition()),this._tmpVec3.subtractInPlace(K.boundingBox.centerWorld),this._tmpVec3.x/=t.object.scaling.x,this._tmpVec3.y/=t.object.scaling.y,this._tmpVec3.z/=t.object.scaling.z,t.setDeltaPosition(this._tmpVec3)}const b=t.getParam("group"),n=t.getParam("mask");b&&n?this.world.addRigidBody(x,b,n):this.world.addRigidBody(x),t.physicsBody=x,t._pluginData.toDispose=t._pluginData.toDispose.concat([x,W,N,G,a,K])}this.setBodyRestitution(t,t.getParam("restitution")),this.setBodyFriction(t,t.getParam("friction"))}}removePhysicsBody(t){this.world&&(t.soft?this.world.removeSoftBody(t.physicsBody):this.world.removeRigidBody(t.physicsBody),t._pluginData&&(t._pluginData.toDispose.forEach((t=>{this.bjsAMMO.destroy(t)})),t._pluginData.toDispose=[]))}generateJoint(t){const K=t.mainImpostor.physicsBody,D=t.connectedImpostor.physicsBody;if(!K||!D)return;if(t.joint.physicsJoint)return;const a=t.joint.jointData;let G;switch(a.mainPivot||(a.mainPivot=new N.Pq(0,0,0)),a.connectedPivot||(a.connectedPivot=new N.Pq(0,0,0)),t.joint.type){case nK.DistanceJoint:{const t=a.maxDistance;t&&(a.mainPivot=new N.Pq(0,-t/2,0),a.connectedPivot=new N.Pq(0,t/2,0));const W=this._tmpAmmoVectorA;W.setValue(a.mainPivot.x,a.mainPivot.y,a.mainPivot.z);const x=this._tmpAmmoVectorB;x.setValue(a.connectedPivot.x,a.connectedPivot.y,a.connectedPivot.z),G=new this.bjsAMMO.btPoint2PointConstraint(K,D,W,x);break}case nK.HingeJoint:{a.mainAxis||(a.mainAxis=new N.Pq(0,0,0)),a.connectedAxis||(a.connectedAxis=new N.Pq(0,0,0));const t=this._tmpAmmoVectorA;t.setValue(a.mainPivot.x,a.mainPivot.y,a.mainPivot.z);const W=this._tmpAmmoVectorB;W.setValue(a.connectedPivot.x,a.connectedPivot.y,a.connectedPivot.z);const x=this._tmpAmmoVectorC;x.setValue(a.mainAxis.x,a.mainAxis.y,a.mainAxis.z);const b=this._tmpAmmoVectorD;b.setValue(a.connectedAxis.x,a.connectedAxis.y,a.connectedAxis.z),G=new this.bjsAMMO.btHingeConstraint(K,D,t,W,x,b);break}case nK.BallAndSocketJoint:{const t=this._tmpAmmoVectorA;t.setValue(a.mainPivot.x,a.mainPivot.y,a.mainPivot.z);const N=this._tmpAmmoVectorB;N.setValue(a.connectedPivot.x,a.connectedPivot.y,a.connectedPivot.z),G=new this.bjsAMMO.btPoint2PointConstraint(K,D,t,N);break}default:{i.V.Warn("JointType not currently supported by the Ammo plugin, falling back to PhysicsJoint.BallAndSocketJoint");const t=this._tmpAmmoVectorA;t.setValue(a.mainPivot.x,a.mainPivot.y,a.mainPivot.z);const N=this._tmpAmmoVectorB;N.setValue(a.connectedPivot.x,a.connectedPivot.y,a.connectedPivot.z),G=new this.bjsAMMO.btPoint2PointConstraint(K,D,t,N);break}}this.world.addConstraint(G,!t.joint.jointData.collision),t.joint.physicsJoint=G}removeJoint(t){this.world&&this.world.removeConstraint(t.joint.physicsJoint),this.bjsAMMO.destroy(t.joint.physicsJoint)}_addMeshVerts(t,K,D){let a=0;if(D&&D.getIndices&&D.getWorldMatrix&&D.getChildMeshes){let G=D.getIndices();G||(G=[]);let W,x=D.getVerticesData(R.R.PositionKind);if(x||(x=[]),K&&K!==D){let t;t=K.rotationQuaternion?K.rotationQuaternion:K.rotation?N.PT.FromEulerAngles(K.rotation.x,K.rotation.y,K.rotation.z):N.PT.Identity(),N.uq.Compose(N.Pq.One(),t,K.position).invertToRef(this._tmpMatrix),W=D.computeWorldMatrix(!1).multiply(this._tmpMatrix)}else N.uq.ScalingToRef(D.scaling.x,D.scaling.y,D.scaling.z,this._tmpMatrix),W=this._tmpMatrix;const b=G.length/3;for(let K=0;K<b;K++){const D=[];for(let t=0;t<3;t++){let a,b=new N.Pq(x[3*G[3*K+t]+0],x[3*G[3*K+t]+1],x[3*G[3*K+t]+2]);b=N.Pq.TransformCoordinates(b,W),a=0==t?this._tmpAmmoVectorA:1==t?this._tmpAmmoVectorB:this._tmpAmmoVectorC,a.setValue(b.x,b.y,b.z),D.push(a)}t.addTriangle(D[0],D[1],D[2]),a++}D.getChildMeshes().forEach((D=>{a+=this._addMeshVerts(t,K,D)}))}return a}_softVertexData(t){const K=t.object;if(K&&K.getIndices&&K.getWorldMatrix&&K.getChildMeshes){let t=K.getIndices();t||(t=[]);let D=K.getVerticesData(R.R.PositionKind);D||(D=[]);let a=K.getVerticesData(R.R.NormalKind);a||(a=[]),K.computeWorldMatrix(!1);const G=[],W=[];for(let t=0;t<D.length;t+=3){let x=new N.Pq(D[t],D[t+1],D[t+2]),b=new N.Pq(a[t],a[t+1],a[t+2]);x=N.Pq.TransformCoordinates(x,K.getWorldMatrix()),b=N.Pq.TransformNormal(b,K.getWorldMatrix()),G.push(x.x,x.y,x.z),W.push(b.x,b.y,b.z)}const x=new A.P;return x.positions=G,x.normals=W,x.uvs=K.getVerticesData(R.R.UVKind),x.colors=K.getVerticesData(R.R.ColorKind),K&&K.getIndices&&(x.indices=K.getIndices()),x.applyToMesh(K),K.position=N.Pq.Zero(),K.rotationQuaternion=null,K.rotation=N.Pq.Zero(),K.computeWorldMatrix(!0),x}return A.P.ExtractFromMesh(K)}_createSoftbody(t){const K=t.object;if(K&&K.getIndices){let D=K.getIndices();D||(D=[]);const a=this._softVertexData(t),G=a.positions,W=a.normals;if(null===G||null===W)return new this.bjsAMMO.btCompoundShape;{const t=[],a=[];for(let K=0;K<G.length;K+=3){const D=new N.Pq(G[K],G[K+1],G[K+2]),x=new N.Pq(W[K],W[K+1],W[K+2]);t.push(D.x,D.y,-D.z),a.push(x.x,x.y,-x.z)}const x=(new this.bjsAMMO.btSoftBodyHelpers).CreateFromTriMesh(this.world.getWorldInfo(),t,K.getIndices(),D.length/3,!0),b=G.length/3,n=x.get_m_nodes();let e,i;for(let t=0;t<b;t++)e=n.at(t),i=e.get_m_n(),i.setX(a[3*t]),i.setY(a[3*t+1]),i.setZ(a[3*t+2]);return x}}}_createCloth(t){const K=t.object;if(K&&K.getIndices){let D=K.getIndices();D||(D=[]);const a=this._softVertexData(t),G=a.positions,N=a.normals;if(null===G||null===N)return new this.bjsAMMO.btCompoundShape;{const K=G.length,D=Math.sqrt(K/3);t.segments=D;const a=D-1;return this._tmpAmmoVectorA.setValue(G[0],G[1],G[2]),this._tmpAmmoVectorB.setValue(G[3*a],G[3*a+1],G[3*a+2]),this._tmpAmmoVectorD.setValue(G[K-3],G[K-2],G[K-1]),this._tmpAmmoVectorC.setValue(G[K-3-3*a],G[K-2-3*a],G[K-1-3*a]),(new this.bjsAMMO.btSoftBodyHelpers).CreatePatch(this.world.getWorldInfo(),this._tmpAmmoVectorA,this._tmpAmmoVectorB,this._tmpAmmoVectorC,this._tmpAmmoVectorD,D,D,t.getParam("fixedPoints"),!0)}}}_createRope(t){let K,D;const a=this._softVertexData(t),G=a.positions,N=a.normals;if(null===G||null===N)return new this.bjsAMMO.btCompoundShape;if(a.applyToMesh(t.object,!0),t._isFromLine=!0,0===N.map((t=>t*t)).reduce(((t,K)=>t+K)))K=G.length,D=K/3-1,this._tmpAmmoVectorA.setValue(G[0],G[1],G[2]),this._tmpAmmoVectorB.setValue(G[K-3],G[K-2],G[K-1]);else{t._isFromLine=!1;const a=t.getParam("path");if(null===t.getParam("shape"))return i.V.Warn("No shape available for extruded mesh"),new this.bjsAMMO.btCompoundShape;K=a.length,D=K-1,this._tmpAmmoVectorA.setValue(a[0].x,a[0].y,a[0].z),this._tmpAmmoVectorB.setValue(a[K-1].x,a[K-1].y,a[K-1].z)}t.segments=D;let W=t.getParam("fixedPoints");W=W>3?3:W;const x=(new this.bjsAMMO.btSoftBodyHelpers).CreateRope(this.world.getWorldInfo(),this._tmpAmmoVectorA,this._tmpAmmoVectorB,D-1,W);return x.get_m_cfg().set_collisions(17),x}_createCustom(t){let K=null;return this.onCreateCustomShape&&(K=this.onCreateCustomShape(t)),null==K&&(K=new this.bjsAMMO.btCompoundShape),K}_addHullVerts(t,K,D){let a=0;if(D&&D.getIndices&&D.getWorldMatrix&&D.getChildMeshes){let G=D.getIndices();G||(G=[]);let W=D.getVerticesData(R.R.PositionKind);W||(W=[]),D.computeWorldMatrix(!1);const x=G.length/3;for(let K=0;K<x;K++){const x=[];for(let t=0;t<3;t++){let a,b=new N.Pq(W[3*G[3*K+t]+0],W[3*G[3*K+t]+1],W[3*G[3*K+t]+2]);N.uq.ScalingToRef(D.scaling.x,D.scaling.y,D.scaling.z,this._tmpMatrix),b=N.Pq.TransformCoordinates(b,this._tmpMatrix),a=0==t?this._tmpAmmoVectorA:1==t?this._tmpAmmoVectorB:this._tmpAmmoVectorC,a.setValue(b.x,b.y,b.z),x.push(a)}t.addPoint(x[0],!0),t.addPoint(x[1],!0),t.addPoint(x[2],!0),a++}D.getChildMeshes().forEach((D=>{a+=this._addHullVerts(t,K,D)}))}return a}_createShape(t,K=!1){const D=t.object;let a;const G=t.getObjectExtents();if(!K){const K=t.object.getChildMeshes?t.object.getChildMeshes(!0):[];a=new this.bjsAMMO.btCompoundShape;let D=0;if(K.forEach((t=>{const K=t.getPhysicsImpostor();if(K){if(K.type==eK.MeshImpostor)throw"A child MeshImpostor is not supported. Only primitive impostors are supported as children (eg. box or sphere)";const G=this._createShape(K),W=t.parent.getWorldMatrix().clone(),x=new N.Pq;W.decompose(x),this._tmpAmmoTransform.getOrigin().setValue(t.position.x*x.x,t.position.y*x.y,t.position.z*x.z),this._tmpAmmoQuaternion.setValue(t.rotationQuaternion.x,t.rotationQuaternion.y,t.rotationQuaternion.z,t.rotationQuaternion.w),this._tmpAmmoTransform.setRotation(this._tmpAmmoQuaternion),a.addChildShape(this._tmpAmmoTransform,G),K.dispose(),D++}})),D>0){if(t.type!=eK.NoImpostor){const K=this._createShape(t,!0);K&&(this._tmpAmmoTransform.getOrigin().setValue(0,0,0),this._tmpAmmoQuaternion.setValue(0,0,0,1),this._tmpAmmoTransform.setRotation(this._tmpAmmoQuaternion),a.addChildShape(this._tmpAmmoTransform,K))}return a}this.bjsAMMO.destroy(a),a=null}switch(t.type){case eK.SphereImpostor:if(it.X.WithinEpsilon(G.x,G.y,1e-4)&&it.X.WithinEpsilon(G.x,G.z,1e-4))a=new this.bjsAMMO.btSphereShape(G.x/2);else{this._tmpAmmoVectorA.setValue(0,0,0);const t=[this._tmpAmmoVectorA],K=[1];a=new this.bjsAMMO.btMultiSphereShape(t,K,1),this._tmpAmmoVectorA.setValue(G.x/2,G.y/2,G.z/2),a.setLocalScaling(this._tmpAmmoVectorA)}break;case eK.CapsuleImpostor:{const t=G.x/2;a=new this.bjsAMMO.btCapsuleShape(t,G.y-2*t)}break;case eK.CylinderImpostor:this._tmpAmmoVectorA.setValue(G.x/2,G.y/2,G.z/2),a=new this.bjsAMMO.btCylinderShape(this._tmpAmmoVectorA);break;case eK.PlaneImpostor:case eK.BoxImpostor:this._tmpAmmoVectorA.setValue(G.x/2,G.y/2,G.z/2),a=new this.bjsAMMO.btBoxShape(this._tmpAmmoVectorA);break;case eK.MeshImpostor:if(0==t.getParam("mass")){if(this.onCreateCustomMeshImpostor)a=this.onCreateCustomMeshImpostor(t);else{const K=new this.bjsAMMO.btTriangleMesh;t._pluginData.toDispose.push(K);const G=this._addMeshVerts(K,D,D);a=0==G?new this.bjsAMMO.btCompoundShape:new this.bjsAMMO.btBvhTriangleMeshShape(K)}break}case eK.ConvexHullImpostor:if(this.onCreateCustomConvexHullImpostor)a=this.onCreateCustomConvexHullImpostor(t);else{const K=new this.bjsAMMO.btConvexHullShape;0==this._addHullVerts(K,D,D)?(t._pluginData.toDispose.push(K),a=new this.bjsAMMO.btCompoundShape):a=K}break;case eK.NoImpostor:a=new this.bjsAMMO.btSphereShape(G.x/2);break;case eK.CustomImpostor:a=this._createCustom(t);break;case eK.SoftbodyImpostor:a=this._createSoftbody(t);break;case eK.ClothImpostor:a=this._createCloth(t);break;case eK.RopeImpostor:a=this._createRope(t);break;default:i.V.Warn("The impostor type is not currently supported by the ammo plugin.")}return a}setTransformationFromPhysicsBody(t){t.physicsBody.getMotionState().getWorldTransform(this._tmpAmmoTransform),t.object.position.set(this._tmpAmmoTransform.getOrigin().x(),this._tmpAmmoTransform.getOrigin().y(),this._tmpAmmoTransform.getOrigin().z()),t.object.rotationQuaternion?t.object.rotationQuaternion.set(this._tmpAmmoTransform.getRotation().x(),this._tmpAmmoTransform.getRotation().y(),this._tmpAmmoTransform.getRotation().z(),this._tmpAmmoTransform.getRotation().w()):t.object.rotation&&(this._tmpQuaternion.set(this._tmpAmmoTransform.getRotation().x(),this._tmpAmmoTransform.getRotation().y(),this._tmpAmmoTransform.getRotation().z(),this._tmpAmmoTransform.getRotation().w()),this._tmpQuaternion.toEulerAnglesToRef(t.object.rotation))}setPhysicsBodyTransformation(t,K,D){const a=t.physicsBody.getWorldTransform();if(Math.abs(a.getOrigin().x()-K.x)>x.bH||Math.abs(a.getOrigin().y()-K.y)>x.bH||Math.abs(a.getOrigin().z()-K.z)>x.bH||Math.abs(a.getRotation().x()-D.x)>x.bH||Math.abs(a.getRotation().y()-D.y)>x.bH||Math.abs(a.getRotation().z()-D.z)>x.bH||Math.abs(a.getRotation().w()-D.w)>x.bH)if(this._tmpAmmoVectorA.setValue(K.x,K.y,K.z),a.setOrigin(this._tmpAmmoVectorA),this._tmpAmmoQuaternion.setValue(D.x,D.y,D.z,D.w),a.setRotation(this._tmpAmmoQuaternion),t.physicsBody.setWorldTransform(a),0==t.mass){const K=t.physicsBody.getMotionState();K&&K.setWorldTransform(a)}else t.physicsBody.activate()}isSupported(){return void 0!==this.bjsAMMO}setLinearVelocity(t,K){this._tmpAmmoVectorA.setValue(K.x,K.y,K.z),t.soft?t.physicsBody.linearVelocity(this._tmpAmmoVectorA):t.physicsBody.setLinearVelocity(this._tmpAmmoVectorA)}setAngularVelocity(t,K){this._tmpAmmoVectorA.setValue(K.x,K.y,K.z),t.soft?t.physicsBody.angularVelocity(this._tmpAmmoVectorA):t.physicsBody.setAngularVelocity(this._tmpAmmoVectorA)}getLinearVelocity(t){let K;if(K=t.soft?t.physicsBody.linearVelocity():t.physicsBody.getLinearVelocity(),!K)return null;const D=new N.Pq(K.x(),K.y(),K.z());return this.bjsAMMO.destroy(K),D}getAngularVelocity(t){let K;if(K=t.soft?t.physicsBody.angularVelocity():t.physicsBody.getAngularVelocity(),!K)return null;const D=new N.Pq(K.x(),K.y(),K.z());return this.bjsAMMO.destroy(K),D}setBodyMass(t,K){t.soft?t.physicsBody.setTotalMass(K,!1):t.physicsBody.setMassProps(K),t._pluginData.mass=K}getBodyMass(t){return t._pluginData.mass||0}getBodyFriction(t){return t._pluginData.friction||0}setBodyFriction(t,K){t.soft?t.physicsBody.get_m_cfg().set_kDF(K):t.physicsBody.setFriction(K),t._pluginData.friction=K}getBodyRestitution(t){return t._pluginData.restitution||0}setBodyRestitution(t,K){t.physicsBody.setRestitution(K),t._pluginData.restitution=K}getBodyPressure(t){return t.soft?t._pluginData.pressure||0:(i.V.Warn("Pressure is not a property of a rigid body"),0)}setBodyPressure(t,K){t.soft?t.type===eK.SoftbodyImpostor?(t.physicsBody.get_m_cfg().set_kPR(K),t._pluginData.pressure=K):(t.physicsBody.get_m_cfg().set_kPR(0),t._pluginData.pressure=0):i.V.Warn("Pressure can only be applied to a softbody")}getBodyStiffness(t){return t.soft?t._pluginData.stiffness||0:(i.V.Warn("Stiffness is not a property of a rigid body"),0)}setBodyStiffness(t,K){t.soft?(K=(K=K<0?0:K)>1?1:K,t.physicsBody.get_m_materials().at(0).set_m_kLST(K),t._pluginData.stiffness=K):i.V.Warn("Stiffness cannot be applied to a rigid body")}getBodyVelocityIterations(t){return t.soft?t._pluginData.velocityIterations||0:(i.V.Warn("Velocity iterations is not a property of a rigid body"),0)}setBodyVelocityIterations(t,K){t.soft?(K=K<0?0:K,t.physicsBody.get_m_cfg().set_viterations(K),t._pluginData.velocityIterations=K):i.V.Warn("Velocity iterations cannot be applied to a rigid body")}getBodyPositionIterations(t){return t.soft?t._pluginData.positionIterations||0:(i.V.Warn("Position iterations is not a property of a rigid body"),0)}setBodyPositionIterations(t,K){t.soft?(K=K<0?0:K,t.physicsBody.get_m_cfg().set_piterations(K),t._pluginData.positionIterations=K):i.V.Warn("Position iterations cannot be applied to a rigid body")}appendAnchor(t,K,D,a,G=1,N=!1){const W=t.segments,x=Math.round((W-1)*D)+W*(W-1-Math.round((W-1)*a));t.physicsBody.appendAnchor(x,K.physicsBody,N,G)}appendHook(t,K,D,a=1,G=!1){const N=Math.round(t.segments*D);t.physicsBody.appendAnchor(N,K.physicsBody,G,a)}sleepBody(t){t.physicsBody.forceActivationState(0)}wakeUpBody(t){t.physicsBody.activate()}updateDistanceJoint(){i.V.Warn("updateDistanceJoint is not currently supported by the Ammo physics plugin")}setMotor(t,K,D){t.physicsJoint.enableAngularMotor(!0,K,D)}setLimit(){i.V.Warn("setLimit is not currently supported by the Ammo physics plugin")}syncMeshWithImpostor(t,K){K.physicsBody.getMotionState().getWorldTransform(this._tmpAmmoTransform),t.position.x=this._tmpAmmoTransform.getOrigin().x(),t.position.y=this._tmpAmmoTransform.getOrigin().y(),t.position.z=this._tmpAmmoTransform.getOrigin().z(),t.rotationQuaternion&&(t.rotationQuaternion.x=this._tmpAmmoTransform.getRotation().x(),t.rotationQuaternion.y=this._tmpAmmoTransform.getRotation().y(),t.rotationQuaternion.z=this._tmpAmmoTransform.getRotation().z(),t.rotationQuaternion.w=this._tmpAmmoTransform.getRotation().w())}getRadius(t){return t.getObjectExtents().x/2}getBoxSizeToRef(t,K){const D=t.getObjectExtents();K.x=D.x,K.y=D.y,K.z=D.z}dispose(){this.bjsAMMO.destroy(this.world),this.bjsAMMO.destroy(this._softBodySolver),this.bjsAMMO.destroy(this._solver),this.bjsAMMO.destroy(this._overlappingPairCache),this.bjsAMMO.destroy(this._dispatcher),this.bjsAMMO.destroy(this._collisionConfiguration),this.bjsAMMO.destroy(this._tmpAmmoVectorA),this.bjsAMMO.destroy(this._tmpAmmoVectorB),this.bjsAMMO.destroy(this._tmpAmmoVectorC),this.bjsAMMO.destroy(this._tmpAmmoVectorD),this.bjsAMMO.destroy(this._tmpAmmoTransform),this.bjsAMMO.destroy(this._tmpAmmoQuaternion),this.bjsAMMO.destroy(this._tmpAmmoConcreteContactResultCallback),this.world=null}raycast(t,K){return this.raycastToRef(t,K,this._raycastResult),this._raycastResult}raycastToRef(t,K,D){this._tmpAmmoVectorRCA=new this.bjsAMMO.btVector3(t.x,t.y,t.z),this._tmpAmmoVectorRCB=new this.bjsAMMO.btVector3(K.x,K.y,K.z);const a=new this.bjsAMMO.ClosestRayResultCallback(this._tmpAmmoVectorRCA,this._tmpAmmoVectorRCB);this.world.rayTest(this._tmpAmmoVectorRCA,this._tmpAmmoVectorRCB,a),D.reset(t,K),a.hasHit()&&(D.setHitData({x:a.get_m_hitNormalWorld().x(),y:a.get_m_hitNormalWorld().y(),z:a.get_m_hitNormalWorld().z()},{x:a.get_m_hitPointWorld().x(),y:a.get_m_hitPointWorld().y(),z:a.get_m_hitPointWorld().z()}),D.calculateHitDistance()),this.bjsAMMO.destroy(a),this.bjsAMMO.destroy(this._tmpAmmoVectorRCA),this.bjsAMMO.destroy(this._tmpAmmoVectorRCB)}}UK._DISABLE_COLLISION_FLAG=4,UK._KINEMATIC_FLAG=2,UK._DISABLE_DEACTIVATION_FLAG=4;var VK=D(888413);St.d.prototype.removeReflectionProbe=function(t){if(!this.reflectionProbes)return-1;const K=this.reflectionProbes.indexOf(t);return-1!==K&&this.reflectionProbes.splice(K,1),K},St.d.prototype.addReflectionProbe=function(t){this.reflectionProbes||(this.reflectionProbes=[]),this.reflectionProbes.push(t)};class sK{constructor(t,K,D,a=!0,G=!1,W=!1){if(this.name=t,this._viewMatrix=N.uq.Identity(),this._target=N.Pq.Zero(),this._add=N.Pq.Zero(),this._invertYAxis=!1,this.position=N.Pq.Zero(),this.metadata=null,this._parentContainer=null,this._scene=D,D.getEngine().supportsUniformBuffers){this._sceneUBOs=[];for(let K=0;K<6;++K)this._sceneUBOs.push(D.createSceneUniformBuffer(`Scene for Reflection Probe (name "${t}") face #${K}`))}this._scene.reflectionProbes||(this._scene.reflectionProbes=[]),this._scene.reflectionProbes.push(this);let x=0;if(G){const t=this._scene.getEngine().getCaps();t.textureHalfFloatRender?x=2:t.textureFloatRender&&(x=1)}this._renderTargetTexture=new VK.$(t,K,D,a,!0,x,!0),this._renderTargetTexture.gammaSpace=!W,this._renderTargetTexture.invertZ=D.useRightHandedSystem;const b=D.getEngine().useReverseDepthBuffer;let n;this._renderTargetTexture.onBeforeRenderObservable.add((t=>{switch(this._sceneUBOs&&(D.setSceneUniformBuffer(this._sceneUBOs[t]),D.getSceneUniformBuffer().unbindEffect()),t){case 0:this._add.copyFromFloats(1,0,0);break;case 1:this._add.copyFromFloats(-1,0,0);break;case 2:this._add.copyFromFloats(0,this._invertYAxis?1:-1,0);break;case 3:this._add.copyFromFloats(0,this._invertYAxis?-1:1,0);break;case 4:this._add.copyFromFloats(0,0,D.useRightHandedSystem?-1:1);break;case 5:this._add.copyFromFloats(0,0,D.useRightHandedSystem?1:-1)}this._attachedMesh&&this.position.copyFrom(this._attachedMesh.getAbsolutePosition()),this.position.addToRef(this._add,this._target);const K=D.useRightHandedSystem?N.uq.LookAtRHToRef:N.uq.LookAtLHToRef,a=D.useRightHandedSystem?N.uq.PerspectiveFovRH:N.uq.PerspectiveFovLH;K(this.position,this._target,N.Pq.Up(),this._viewMatrix),D.activeCamera&&(this._projectionMatrix=a(Math.PI/2,1,b?D.activeCamera.maxZ:D.activeCamera.minZ,b?D.activeCamera.minZ:D.activeCamera.maxZ,this._scene.getEngine().isNDCHalfZRange),D.setTransformMatrix(this._viewMatrix,this._projectionMatrix),D.activeCamera.isRigCamera&&!this._renderTargetTexture.activeCamera&&(this._renderTargetTexture.activeCamera=D.activeCamera.rigParent||null)),D._forcedViewPosition=this.position})),this._renderTargetTexture.onBeforeBindObservable.add((()=>{var K,a;this._currentSceneUBO=D.getSceneUniformBuffer(),null===(a=(K=D.getEngine())._debugPushGroup)||void 0===a||a.call(K,`reflection probe generation for ${t}`,1),n=this._scene.imageProcessingConfiguration.applyByPostProcess,W&&(D.imageProcessingConfiguration.applyByPostProcess=!0)})),this._renderTargetTexture.onAfterUnbindObservable.add((()=>{var t,K;D.imageProcessingConfiguration.applyByPostProcess=n,D._forcedViewPosition=null,this._sceneUBOs&&D.setSceneUniformBuffer(this._currentSceneUBO),D.updateTransformMatrix(!0),null===(K=(t=D.getEngine())._debugPopGroup)||void 0===K||K.call(t,1)}))}get samples(){return this._renderTargetTexture.samples}set samples(t){this._renderTargetTexture.samples=t}get refreshRate(){return this._renderTargetTexture.refreshRate}set refreshRate(t){this._renderTargetTexture.refreshRate=t}getScene(){return this._scene}get cubeTexture(){return this._renderTargetTexture}get renderList(){return this._renderTargetTexture.renderList}set renderList(t){this._renderTargetTexture.renderList=t}attachToMesh(t){this._attachedMesh=t}setRenderingAutoClearDepthStencil(t,K){this._renderTargetTexture.setRenderingAutoClearDepthStencil(t,K)}dispose(){const t=this._scene.reflectionProbes.indexOf(this);if(-1!==t&&this._scene.reflectionProbes.splice(t,1),this._parentContainer){const t=this._parentContainer.reflectionProbes.indexOf(this);t>-1&&this._parentContainer.reflectionProbes.splice(t,1),this._parentContainer=null}if(this._renderTargetTexture&&(this._renderTargetTexture.dispose(),this._renderTargetTexture=null),this._sceneUBOs){for(const t of this._sceneUBOs)t.dispose();this._sceneUBOs=[]}}toString(t){let K="Name: "+this.name;return t&&(K+=", position: "+this.position.toString(),this._attachedMesh&&(K+=", attached mesh: "+this._attachedMesh.name)),K}getClassName(){return"ReflectionProbe"}serialize(){const t=z.p.Serialize(this,this._renderTargetTexture.serialize());return t.isReflectionProbe=!0,t.metadata=this.metadata,t}static Parse(t,K,D){let a=null;if(K.reflectionProbes)for(let D=0;D<K.reflectionProbes.length;D++){const G=K.reflectionProbes[D];if(G.name===t.name){a=G;break}}return a=z.p.Parse((()=>a||new sK(t.name,t.renderTargetSize,K,t._generateMipMaps)),t,K,D),a.cubeTexture._waitingRenderList=t.renderList,t._attachedMesh&&a.attachToMesh(K.getMeshById(t._attachedMesh)),t.metadata&&(a.metadata=t.metadata),a}}a.Cg([G.xG()],sK.prototype,"_attachedMesh",void 0),a.Cg([G.P_()],sK.prototype,"position",void 0);var FK=D(850034);class cK{get animationStarted(){return this._animationStarted}get fromIndex(){return this._fromIndex}get toIndex(){return this._toIndex}get loopAnimation(){return this._loopAnimation}get delay(){return Math.max(this._delay,1)}constructor(){this.width=1,this.height=1,this.angle=0,this.invertU=!1,this.invertV=!1,this.isVisible=!0,this._animationStarted=!1,this._loopAnimation=!1,this._fromIndex=0,this._toIndex=0,this._delay=0,this._direction=1,this._time=0,this._onBaseAnimationEnd=null,this.position={x:1,y:1,z:1},this.color={r:1,g:1,b:1,a:1}}playAnimation(t,K,D,a,G){this._fromIndex=t,this._toIndex=K,this._loopAnimation=D,this._delay=a||1,this._animationStarted=!0,this._onBaseAnimationEnd=G,t<K?this._direction=1:(this._direction=-1,this._toIndex=t,this._fromIndex=K),this.cellIndex=t,this._time=0}stopAnimation(){this._animationStarted=!1}_animate(t){this._animationStarted&&(this._time+=t,this._time>this._delay&&(this._time=this._time%this._delay,this.cellIndex+=this._direction,(this._direction>0&&this.cellIndex>this._toIndex||this._direction<0&&this.cellIndex<this._fromIndex)&&(this._loopAnimation?this.cellIndex=this._direction>0?this._fromIndex:this._toIndex:(this.cellIndex=this._toIndex,this._animationStarted=!1,this._onBaseAnimationEnd&&this._onBaseAnimationEnd()))))}}class gK extends cK{get size(){return this.width}set size(t){this.width=t,this.height=t}get manager(){return this._manager}constructor(t,K){super(),this.name=t,this.animations=new Array,this.isPickable=!1,this.useAlphaForPicking=!1,this.onDisposeObservable=new d.cP,this._onAnimationEnd=null,this._endAnimation=()=>{this._onAnimationEnd&&this._onAnimationEnd(),this.disposeWhenFinishedAnimating&&this.dispose()},this.color=new s.ov(1,1,1,1),this.position=N.Pq.Zero(),this._manager=K,this._manager.sprites.push(this),this.uniqueId=this._manager.scene.getUniqueId()}getClassName(){return"Sprite"}get fromIndex(){return this._fromIndex}set fromIndex(t){this.playAnimation(t,this._toIndex,this._loopAnimation,this._delay,this._onAnimationEnd)}get toIndex(){return this._toIndex}set toIndex(t){this.playAnimation(this._fromIndex,t,this._loopAnimation,this._delay,this._onAnimationEnd)}get loopAnimation(){return this._loopAnimation}set loopAnimation(t){this.playAnimation(this._fromIndex,this._toIndex,t,this._delay,this._onAnimationEnd)}get delay(){return Math.max(this._delay,1)}set delay(t){this.playAnimation(this._fromIndex,this._toIndex,this._loopAnimation,t,this._onAnimationEnd)}playAnimation(t,K,D,a,G=null){this._onAnimationEnd=G,super.playAnimation(t,K,D,a,this._endAnimation)}dispose(){for(let t=0;t<this._manager.sprites.length;t++)this._manager.sprites[t]==this&&this._manager.sprites.splice(t,1);this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear()}serialize(){const t={};return t.name=this.name,t.position=this.position.asArray(),t.color=this.color.asArray(),t.width=this.width,t.height=this.height,t.angle=this.angle,t.cellIndex=this.cellIndex,t.cellRef=this.cellRef,t.invertU=this.invertU,t.invertV=this.invertV,t.disposeWhenFinishedAnimating=this.disposeWhenFinishedAnimating,t.isPickable=this.isPickable,t.isVisible=this.isVisible,t.useAlphaForPicking=this.useAlphaForPicking,t.animationStarted=this.animationStarted,t.fromIndex=this.fromIndex,t.toIndex=this.toIndex,t.loopAnimation=this.loopAnimation,t.delay=this.delay,t}static Parse(t,K){const D=new gK(t.name,K);return D.position=N.Pq.FromArray(t.position),D.color=s.ov.FromArray(t.color),D.width=t.width,D.height=t.height,D.angle=t.angle,D.cellIndex=t.cellIndex,D.cellRef=t.cellRef,D.invertU=t.invertU,D.invertV=t.invertV,D.disposeWhenFinishedAnimating=t.disposeWhenFinishedAnimating,D.isPickable=t.isPickable,D.isVisible=t.isVisible,D.useAlphaForPicking=t.useAlphaForPicking,D._fromIndex=t.fromIndex,D._toIndex=t.toIndex,D._loopAnimation=t.loopAnimation,D._delay=t.delay,t.animationStarted&&D.playAnimation(D.fromIndex,D.toIndex,D.loopAnimation,D.delay),D}}var RK=D(79160),AK=D(7686);class YK{constructor(t,K,D=Number.MAX_VALUE,a=x.bH){this.origin=t,this.direction=K,this.length=D,this.epsilon=a}clone(){return new YK(this.origin.clone(),this.direction.clone(),this.length)}intersectsBoxMinMax(t,K,D=0){const a=YK._TmpVector3[0].copyFromFloats(t.x-D,t.y-D,t.z-D),G=YK._TmpVector3[1].copyFromFloats(K.x+D,K.y+D,K.z+D);let N,W,x,b,n=0,e=Number.MAX_VALUE;if(Math.abs(this.direction.x)<1e-7){if(this.origin.x<a.x||this.origin.x>G.x)return!1}else if(N=1/this.direction.x,W=(a.x-this.origin.x)*N,x=(G.x-this.origin.x)*N,x===-1/0&&(x=1/0),W>x&&(b=W,W=x,x=b),n=Math.max(W,n),e=Math.min(x,e),n>e)return!1;if(Math.abs(this.direction.y)<1e-7){if(this.origin.y<a.y||this.origin.y>G.y)return!1}else if(N=1/this.direction.y,W=(a.y-this.origin.y)*N,x=(G.y-this.origin.y)*N,x===-1/0&&(x=1/0),W>x&&(b=W,W=x,x=b),n=Math.max(W,n),e=Math.min(x,e),n>e)return!1;if(Math.abs(this.direction.z)<1e-7){if(this.origin.z<a.z||this.origin.z>G.z)return!1}else if(N=1/this.direction.z,W=(a.z-this.origin.z)*N,x=(G.z-this.origin.z)*N,x===-1/0&&(x=1/0),W>x&&(b=W,W=x,x=b),n=Math.max(W,n),e=Math.min(x,e),n>e)return!1;return!0}intersectsBox(t,K=0){return this.intersectsBoxMinMax(t.minimum,t.maximum,K)}intersectsSphere(t,K=0){const D=t.center.x-this.origin.x,a=t.center.y-this.origin.y,G=t.center.z-this.origin.z,N=D*D+a*a+G*G,W=t.radius+K,x=W*W;if(N<=x)return!0;const b=D*this.direction.x+a*this.direction.y+G*this.direction.z;return!(b<0)&&N-b*b<=x}intersectsTriangle(t,K,D){const a=YK._TmpVector3[0],G=YK._TmpVector3[1],W=YK._TmpVector3[2],x=YK._TmpVector3[3],b=YK._TmpVector3[4];K.subtractToRef(t,a),D.subtractToRef(t,G),N.Pq.CrossToRef(this.direction,G,W);const n=N.Pq.Dot(a,W);if(0===n)return null;const e=1/n;this.origin.subtractToRef(t,x);const i=N.Pq.Dot(x,W)*e;if(i<-this.epsilon||i>1+this.epsilon)return null;N.Pq.CrossToRef(x,a,b);const z=N.Pq.Dot(this.direction,b)*e;if(z<-this.epsilon||i+z>1+this.epsilon)return null;const I=N.Pq.Dot(G,b)*e;return I>this.length?null:new AK.w(1-i-z,i,I)}intersectsPlane(t){let K;const D=N.Pq.Dot(t.normal,this.direction);if(Math.abs(D)<9.99999997475243e-7)return null;{const a=N.Pq.Dot(t.normal,this.origin);return K=(-t.d-a)/D,K<0?K<-9.99999997475243e-7?null:0:K}}intersectsAxis(t,K=0){switch(t){case"y":{const t=(this.origin.y-K)/this.direction.y;return t>0?null:new N.Pq(this.origin.x+this.direction.x*-t,K,this.origin.z+this.direction.z*-t)}case"x":{const t=(this.origin.x-K)/this.direction.x;return t>0?null:new N.Pq(K,this.origin.y+this.direction.y*-t,this.origin.z+this.direction.z*-t)}case"z":{const t=(this.origin.z-K)/this.direction.z;return t>0?null:new N.Pq(this.origin.x+this.direction.x*-t,this.origin.y+this.direction.y*-t,K)}default:return null}}intersectsMesh(t,K,D,a=!1,G,W=!1){const x=N.AA.Matrix[0];return t.getWorldMatrix().invertToRef(x),this._tmpRay?YK.TransformToRef(this,x,this._tmpRay):this._tmpRay=YK.Transform(this,x),t.intersects(this._tmpRay,K,D,a,G,W)}intersectsMeshes(t,K,D){D?D.length=0:D=[];for(let a=0;a<t.length;a++){const G=this.intersectsMesh(t[a],K);G.hit&&D.push(G)}return D.sort(this._comparePickingInfo),D}_comparePickingInfo(t,K){return t.distance<K.distance?-1:t.distance>K.distance?1:0}intersectionSegment(t,K,D){const a=this.origin,G=N.AA.Vector3[0],W=N.AA.Vector3[1],x=N.AA.Vector3[2],b=N.AA.Vector3[3];K.subtractToRef(t,G),this.direction.scaleToRef(YK._Rayl,x),a.addToRef(x,W),t.subtractToRef(a,b);const n=N.Pq.Dot(G,G),e=N.Pq.Dot(G,x),i=N.Pq.Dot(x,x),z=N.Pq.Dot(G,b),I=N.Pq.Dot(x,b),Z=n*i-e*e;let w,m,u=Z,d=Z;Z<YK._Smallnum?(w=0,u=1,m=I,d=i):(w=e*I-i*z,m=n*I-e*z,w<0?(w=0,m=I,d=i):w>u&&(w=u,m=I+e,d=i)),m<0?(m=0,-z<0?w=0:-z>n?w=u:(w=-z,u=n)):m>d&&(m=d,-z+e<0?w=0:-z+e>n?w=u:(w=-z+e,u=n));const E=Math.abs(w)<YK._Smallnum?0:w/u,l=Math.abs(m)<YK._Smallnum?0:m/d,Q=N.AA.Vector3[4];x.scaleToRef(l,Q);const P=N.AA.Vector3[5];G.scaleToRef(E,P),P.addInPlace(b);const y=N.AA.Vector3[6];return P.subtractToRef(Q,y),l>0&&l<=this.length&&y.lengthSquared()<D*D?P.length():-1}update(t,K,D,a,G,W,x,b=!1){if(b){YK._RayDistant||(YK._RayDistant=YK.Zero()),YK._RayDistant.unprojectRayToRef(t,K,D,a,N.uq.IdentityReadOnly,W,x);const b=N.AA.Matrix[0];G.invertToRef(b),YK.TransformToRef(YK._RayDistant,b,this)}else this.unprojectRayToRef(t,K,D,a,G,W,x);return this}static Zero(){return new YK(N.Pq.Zero(),N.Pq.Zero())}static CreateNew(t,K,D,a,G,N,W){return YK.Zero().update(t,K,D,a,G,N,W)}static CreateNewFromTo(t,K,D=N.uq.IdentityReadOnly){const a=new YK(new N.Pq(0,0,0),new N.Pq(0,0,0));return YK.CreateFromToToRef(t,K,a,D)}static CreateFromToToRef(t,K,D,a=N.uq.IdentityReadOnly){D.origin.copyFrom(t);const G=K.subtractToRef(t,D.direction),W=Math.sqrt(G.x*G.x+G.y*G.y+G.z*G.z);return D.length=W,D.direction.normalize(),YK.TransformToRef(D,a,D)}static Transform(t,K){const D=new YK(new N.Pq(0,0,0),new N.Pq(0,0,0));return YK.TransformToRef(t,K,D),D}static TransformToRef(t,K,D){N.Pq.TransformCoordinatesToRef(t.origin,K,D.origin),N.Pq.TransformNormalToRef(t.direction,K,D.direction),D.length=t.length,D.epsilon=t.epsilon;const a=D.direction,G=a.length();if(0!==G&&1!==G){const t=1/G;a.x*=t,a.y*=t,a.z*=t,D.length*=G}return D}unprojectRayToRef(t,K,D,a,G,W,x){const b=N.AA.Matrix[0];G.multiplyToRef(W,b),b.multiplyToRef(x,b),b.invert();const n=$.q.LastCreatedEngine,e=N.AA.Vector3[0];e.x=t/D*2-1,e.y=-(K/a*2-1),e.z=(null==n?void 0:n.useReverseDepthBuffer)?1:(null==n?void 0:n.isNDCHalfZRange)?0:-1;const i=N.AA.Vector3[1].copyFromFloats(e.x,e.y,1-1e-8),z=N.AA.Vector3[2],I=N.AA.Vector3[3];N.Pq._UnprojectFromInvertedMatrixToRef(e,b,z),N.Pq._UnprojectFromInvertedMatrixToRef(i,b,I),this.origin.copyFrom(z),I.subtractToRef(z,this.direction),this.direction.normalize()}}YK._TmpVector3=KK.mI(6,N.Pq.Zero),YK._RayDistant=YK.Zero(),YK._Smallnum=1e-8,YK._Rayl=1e9,QK.Z.prototype.createPickingRay=function(t,K,D,a,G=!1){const N=YK.Zero();return this.createPickingRayToRef(t,K,D,N,a,G),N},QK.Z.prototype.createPickingRayToRef=function(t,K,D,a,G,W=!1,x=!1){const b=this.getEngine();if(!G&&!(G=this.activeCamera))return this;const n=G.viewport,e=b.getRenderHeight(),{x:i,y:z,width:I,height:Z}=n.toGlobal(b.getRenderWidth(),e),w=1/b.getHardwareScalingLevel();return t=t*w-i,K=K*w-(e-z-Z),a.update(t,K,I,Z,D||N.uq.IdentityReadOnly,W?N.uq.IdentityReadOnly:G.getViewMatrix(),G.getProjectionMatrix(),x),this},QK.Z.prototype.createPickingRayInCameraSpace=function(t,K,D){const a=YK.Zero();return this.createPickingRayInCameraSpaceToRef(t,K,a,D),a},QK.Z.prototype.createPickingRayInCameraSpaceToRef=function(t,K,D,a){if(!RK.G)return this;const G=this.getEngine();if(!a&&!(a=this.activeCamera))throw new Error("Active camera not set");const W=a.viewport,x=G.getRenderHeight(),{x:b,y:n,width:e,height:i}=W.toGlobal(G.getRenderWidth(),x),z=N.uq.Identity(),I=1/G.getHardwareScalingLevel();return t=t*I-b,K=K*I-(x-n-i),D.update(t,K,e,i,z,z,a.getProjectionMatrix()),this},QK.Z.prototype._internalPickForMesh=function(t,K,D,a,G,N,W,x){const b=K(a,D.enableDistantPicking),n=D.intersects(b,G,W,N,a,x);return n&&n.hit?!G&&null!=t&&n.distance>=t.distance?null:n:null},QK.Z.prototype._internalPick=function(t,K,D,a,G){let W=null;const x=!!(this.activeCameras&&this.activeCameras.length>1&&this.cameraToUseForPointers!==this.activeCamera),b=this.cameraToUseForPointers||this.activeCamera;for(let n=0;n<this.meshes.length;n++){const e=this.meshes[n];if(K){if(!K(e,-1))continue}else if(!e.isEnabled()||!e.isVisible||!e.isPickable)continue;const i=x&&e.isWorldMatrixCameraDependent(),z=e.computeWorldMatrix(i,b);if(e.hasThinInstances&&e.thinInstanceEnablePicking){const x=this._internalPickForMesh(W,t,e,z,!0,!0,G);if(x){if(a)return x;const b=N.AA.Matrix[1],n=e.thinInstanceGetWorldMatrices();for(let N=0;N<n.length;N++){if(K&&!K(e,N))continue;n[N].multiplyToRef(z,b);const x=this._internalPickForMesh(W,t,e,b,D,a,G,!0);if(x&&(W=x,W.thinInstanceIndex=N,D))return W}}}else{const K=this._internalPickForMesh(W,t,e,z,D,a,G);if(K&&(W=K,D))return W}}return W||new RK.G},QK.Z.prototype._internalMultiPick=function(t,K,D){if(!RK.G)return null;const a=[],G=!!(this.activeCameras&&this.activeCameras.length>1&&this.cameraToUseForPointers!==this.activeCamera),W=this.cameraToUseForPointers||this.activeCamera;for(let x=0;x<this.meshes.length;x++){const b=this.meshes[x];if(K){if(!K(b,-1))continue}else if(!b.isEnabled()||!b.isVisible||!b.isPickable)continue;const n=G&&b.isWorldMatrixCameraDependent(),e=b.computeWorldMatrix(n,W);if(b.hasThinInstances&&b.thinInstanceEnablePicking){if(this._internalPickForMesh(null,t,b,e,!0,!0,D)){const G=N.AA.Matrix[1],W=b.thinInstanceGetWorldMatrices();for(let N=0;N<W.length;N++){if(K&&!K(b,N))continue;W[N].multiplyToRef(e,G);const x=this._internalPickForMesh(null,t,b,G,!1,!1,D,!0);x&&(x.thinInstanceIndex=N,a.push(x))}}}else{const K=this._internalPickForMesh(null,t,b,e,!1,!1,D);K&&a.push(K)}}return a},QK.Z.prototype.pickWithBoundingInfo=function(t,K,D,a,G){if(!RK.G)return null;const W=this._internalPick((D=>(this._tempPickingRay||(this._tempPickingRay=YK.Zero()),this.createPickingRayToRef(t,K,D,this._tempPickingRay,G||null),this._tempPickingRay)),D,a,!0);return W&&(W.ray=this.createPickingRay(t,K,N.uq.Identity(),G||null)),W},Object.defineProperty(QK.Z.prototype,"_pickingAvailable",{get:()=>!0,enumerable:!1,configurable:!1}),QK.Z.prototype.pick=function(t,K,D,a,G,W,x=!1){const b=this._internalPick(((D,a)=>(this._tempPickingRay||(this._tempPickingRay=YK.Zero()),this.createPickingRayToRef(t,K,D,this._tempPickingRay,G||null,!1,a),this._tempPickingRay)),D,a,!1,W);return b&&(b.ray=this.createPickingRay(t,K,N.uq.Identity(),G||null)),b},QK.Z.prototype.pickWithRay=function(t,K,D,a){const G=this._internalPick((K=>(this._pickWithRayInverseMatrix||(this._pickWithRayInverseMatrix=N.uq.Identity()),K.invertToRef(this._pickWithRayInverseMatrix),this._cachedRayForTransform||(this._cachedRayForTransform=YK.Zero()),YK.TransformToRef(t,this._pickWithRayInverseMatrix,this._cachedRayForTransform),this._cachedRayForTransform)),K,D,!1,a);return G&&(G.ray=t),G},QK.Z.prototype.multiPick=function(t,K,D,a,G){return this._internalMultiPick((D=>this.createPickingRay(t,K,D,a||null)),D,G)},QK.Z.prototype.multiPickWithRay=function(t,K,D){return this._internalMultiPick((K=>(this._pickWithRayInverseMatrix||(this._pickWithRayInverseMatrix=N.uq.Identity()),K.invertToRef(this._pickWithRayInverseMatrix),this._cachedRayForTransform||(this._cachedRayForTransform=YK.Zero()),YK.TransformToRef(t,this._pickWithRayInverseMatrix,this._cachedRayForTransform),this._cachedRayForTransform)),K,D)},W.i.prototype.getForwardRay=function(t=100,K,D){return this.getForwardRayToRef(new YK(N.Pq.Zero(),N.Pq.Zero(),t),t,K,D)},W.i.prototype.getForwardRayToRef=function(t,K=100,D,a){D||(D=this.getWorldMatrix()),t.length=K,a?t.origin.copyFrom(a):t.origin.copyFrom(this.position);const G=N.AA.Vector3[2];G.set(0,0,this._scene.useRightHandedSystem?-1:1);const W=N.AA.Vector3[3];return N.Pq.TransformNormalToRef(G,D,W),N.Pq.NormalizeToRef(W,t.direction),t};var LK=D(35259);QK.Z.prototype._internalPickSprites=function(t,K,D,a){if(!RK.G)return null;let G=null;if(!a){if(!this.activeCamera)return null;a=this.activeCamera}if(this.spriteManagers&&this.spriteManagers.length>0)for(let N=0;N<this.spriteManagers.length;N++){const W=this.spriteManagers[N];if(!W.isPickable)continue;const x=W.intersects(t,a,K,D);if(x&&x.hit&&(D||null==G||!(x.distance>=G.distance))&&(G=x,D))break}return G||new RK.G},QK.Z.prototype._internalMultiPickSprites=function(t,K,D){if(!RK.G)return null;let a=[];if(!D){if(!this.activeCamera)return null;D=this.activeCamera}if(this.spriteManagers&&this.spriteManagers.length>0)for(let G=0;G<this.spriteManagers.length;G++){const N=this.spriteManagers[G];if(!N.isPickable)continue;const W=N.multiIntersects(t,D,K);null!==W&&(a=a.concat(W))}return a},QK.Z.prototype.pickSprite=function(t,K,D,a,G){if(!this._tempSpritePickingRay)return null;this.createPickingRayInCameraSpaceToRef(t,K,this._tempSpritePickingRay,G);const N=this._internalPickSprites(this._tempSpritePickingRay,D,a,G);return N&&(N.ray=this.createPickingRayInCameraSpace(t,K,G)),N},QK.Z.prototype.pickSpriteWithRay=function(t,K,D,a){if(!this._tempSpritePickingRay)return null;if(!a){if(!this.activeCamera)return null;a=this.activeCamera}YK.TransformToRef(t,a.getViewMatrix(),this._tempSpritePickingRay);const G=this._internalPickSprites(this._tempSpritePickingRay,K,D,a);return G&&(G.ray=t),G},QK.Z.prototype.multiPickSprite=function(t,K,D,a){return this.createPickingRayInCameraSpaceToRef(t,K,this._tempSpritePickingRay,a),this._internalMultiPickSprites(this._tempSpritePickingRay,D,a)},QK.Z.prototype.multiPickSpriteWithRay=function(t,K,D){if(!this._tempSpritePickingRay)return null;if(!D){if(!this.activeCamera)return null;D=this.activeCamera}return YK.TransformToRef(t,D.getViewMatrix(),this._tempSpritePickingRay),this._internalMultiPickSprites(this._tempSpritePickingRay,K,D)},QK.Z.prototype.setPointerOverSprite=function(t){this._pointerOverSprite!==t&&(this._pointerOverSprite&&this._pointerOverSprite.actionManager&&this._pointerOverSprite.actionManager.processTrigger(10,LK.X.CreateNewFromSprite(this._pointerOverSprite,this)),this._pointerOverSprite=t,this._pointerOverSprite&&this._pointerOverSprite.actionManager&&this._pointerOverSprite.actionManager.processTrigger(9,LK.X.CreateNewFromSprite(this._pointerOverSprite,this)))},QK.Z.prototype.getPointerOverSprite=function(){return this._pointerOverSprite};class SK{constructor(t){this.name=M.v.NAME_SPRITE,this.scene=t,this.scene.spriteManagers=[],this.scene._tempSpritePickingRay=YK?YK.Zero():null,this.scene.onBeforeSpritesRenderingObservable=new d.cP,this.scene.onAfterSpritesRenderingObservable=new d.cP,this._spritePredicate=t=>!!t.actionManager&&t.isPickable&&t.actionManager.hasPointerTriggers}register(){this.scene._pointerMoveStage.registerStep(M.v.STEP_POINTERMOVE_SPRITE,this,this._pointerMove),this.scene._pointerDownStage.registerStep(M.v.STEP_POINTERDOWN_SPRITE,this,this._pointerDown),this.scene._pointerUpStage.registerStep(M.v.STEP_POINTERUP_SPRITE,this,this._pointerUp)}rebuild(){}dispose(){this.scene.onBeforeSpritesRenderingObservable.clear(),this.scene.onAfterSpritesRenderingObservable.clear();const t=this.scene.spriteManagers;if(t)for(;t.length;)t[0].dispose()}_pickSpriteButKeepRay(t,K,D,a,G){const N=this.scene.pickSprite(K,D,this._spritePredicate,a,G);return N&&(N.ray=t?t.ray:null),N}_pointerMove(t,K,D,a,G){const N=this.scene;return a?N.setPointerOverSprite(null):(D=this._pickSpriteButKeepRay(D,t,K,!1,N.cameraToUseForPointers||void 0))&&D.hit&&D.pickedSprite?(N.setPointerOverSprite(D.pickedSprite),!N.doNotHandleCursors&&G&&(N._pointerOverSprite&&N._pointerOverSprite.actionManager&&N._pointerOverSprite.actionManager.hoverCursor?G.style.cursor=N._pointerOverSprite.actionManager.hoverCursor:G.style.cursor=N.hoverCursor)):N.setPointerOverSprite(null),D}_pointerDown(t,K,D,a){const G=this.scene;if(G._pickedDownSprite=null,G.spriteManagers&&G.spriteManagers.length>0&&(D=G.pickSprite(t,K,this._spritePredicate,!1,G.cameraToUseForPointers||void 0))&&D.hit&&D.pickedSprite&&D.pickedSprite.actionManager){switch(G._pickedDownSprite=D.pickedSprite,a.button){case 0:D.pickedSprite.actionManager.processTrigger(2,LK.X.CreateNewFromSprite(D.pickedSprite,G,a));break;case 1:D.pickedSprite.actionManager.processTrigger(4,LK.X.CreateNewFromSprite(D.pickedSprite,G,a));break;case 2:D.pickedSprite.actionManager.processTrigger(3,LK.X.CreateNewFromSprite(D.pickedSprite,G,a))}D.pickedSprite.actionManager&&D.pickedSprite.actionManager.processTrigger(5,LK.X.CreateNewFromSprite(D.pickedSprite,G,a))}return D}_pointerUp(t,K,D,a,G){const N=this.scene;if(N.spriteManagers&&N.spriteManagers.length>0){const D=N.pickSprite(t,K,this._spritePredicate,!1,N.cameraToUseForPointers||void 0);D&&(D.hit&&D.pickedSprite&&D.pickedSprite.actionManager&&(D.pickedSprite.actionManager.processTrigger(7,LK.X.CreateNewFromSprite(D.pickedSprite,N,a)),D.pickedSprite.actionManager&&(this.scene._inputManager._isPointerSwiping()||D.pickedSprite.actionManager.processTrigger(1,LK.X.CreateNewFromSprite(D.pickedSprite,N,a)),G&&D.pickedSprite.actionManager.processTrigger(6,LK.X.CreateNewFromSprite(D.pickedSprite,N,a)))),N._pickedDownSprite&&N._pickedDownSprite.actionManager&&N._pickedDownSprite!==D.pickedSprite&&N._pickedDownSprite.actionManager.processTrigger(16,LK.X.CreateNewFromSprite(N._pickedDownSprite,N,a)))}return D}}var fK=D(964061);D(889630),D(80157);class $K{get fogEnabled(){return this._fogEnabled}set fogEnabled(t){this._fogEnabled!==t&&(this._fogEnabled=t,this._createEffects())}get useLogarithmicDepth(){return this._useLogarithmicDepth}set useLogarithmicDepth(t){var K;const D=!!(null===(K=this._scene)||void 0===K?void 0:K.getEngine().getCaps().fragmentDepthSupported);t&&!D&&i.V.Warn("Logarithmic depth has been requested for a sprite renderer on a device that doesn't support it."),this._useLogarithmicDepth=t&&D,this._createEffects()}get capacity(){return this._capacity}get pixelPerfect(){return this._pixelPerfect}set pixelPerfect(t){this._pixelPerfect!==t&&(this._pixelPerfect=t,this._createEffects())}get shaderLanguage(){return this._shaderLanguage}constructor(t,K,D=.01,a=null){this.blendMode=2,this.autoResetAlpha=!0,this.disableDepthWrite=!1,this._fogEnabled=!0,this._pixelPerfect=!1,this._shaderLanguage=0,this._useVAO=!1,this._useInstancing=!1,this._vertexBuffers={},this._isDisposed=!1,this._shadersLoaded=!1,this._capacity=K,this._epsilon=D,this._engine=t,this._useInstancing=t.getCaps().instancedArrays&&t._features.supportSpriteInstancing,this._useVAO=t.getCaps().vertexArrayObject&&!t.disableVertexArrayObjects,this._scene=a,this._useInstancing||this._buildIndexBuffer(),this._vertexBufferSize=this._useInstancing?16:18,this._vertexData=new Float32Array(K*this._vertexBufferSize*(this._useInstancing?1:4)),this._buffer=new R.h(t,this._vertexData,!0,this._vertexBufferSize);const G=this._buffer.createVertexBuffer(R.R.PositionKind,0,4,this._vertexBufferSize,this._useInstancing),N=this._buffer.createVertexBuffer("options",4,2,this._vertexBufferSize,this._useInstancing);let W,x=6;if(this._useInstancing){const K=new Float32Array([0,0,1,0,0,1,1,1]);this._spriteBuffer=new R.h(t,K,!1,2),W=this._spriteBuffer.createVertexBuffer("offsets",0,2)}else W=this._buffer.createVertexBuffer("offsets",x,2,this._vertexBufferSize,this._useInstancing),x+=2;const b=this._buffer.createVertexBuffer("inverts",x,2,this._vertexBufferSize,this._useInstancing),n=this._buffer.createVertexBuffer("cellInfo",x+2,4,this._vertexBufferSize,this._useInstancing),e=this._buffer.createVertexBuffer(R.R.ColorKind,x+6,4,this._vertexBufferSize,this._useInstancing);this._vertexBuffers[R.R.PositionKind]=G,this._vertexBuffers["options"]=N,this._vertexBuffers["offsets"]=W,this._vertexBuffers["inverts"]=b,this._vertexBuffers["cellInfo"]=n,this._vertexBuffers[R.R.ColorKind]=e,this._initShaderSourceAsync()}async _initShaderSourceAsync(){this._engine.isWebGPU&&!$K.ForceGLSL?(this._shaderLanguage=1,await Promise.all([D.e(66691).then(D.bind(D,866691)),D.e(72923).then(D.bind(D,972923))])):await Promise.all([D.e(98180).then(D.bind(D,398180)),D.e(35214).then(D.bind(D,135214))]),this._shadersLoaded=!0,this._createEffects()}_createEffects(){var t,K;if(this._isDisposed)return;null===(t=this._drawWrapperBase)||void 0===t||t.dispose(),null===(K=this._drawWrapperDepth)||void 0===K||K.dispose(),this._drawWrapperBase=new fK.E(this._engine),this._drawWrapperDepth=new fK.E(this._engine,!1),this._drawWrapperBase.drawContext&&(this._drawWrapperBase.drawContext.useInstancing=this._useInstancing),this._drawWrapperDepth.drawContext&&(this._drawWrapperDepth.drawContext.useInstancing=this._useInstancing);let D="";this._pixelPerfect&&(D+="#define PIXEL_PERFECT\n"),this._scene&&this._scene.fogEnabled&&0!==this._scene.fogMode&&this._fogEnabled&&(D+="#define FOG\n"),this._useLogarithmicDepth&&(D+="#define LOGARITHMICDEPTH\n"),this._drawWrapperBase.effect=this._engine.createEffect("sprites",[R.R.PositionKind,"options","offsets","inverts","cellInfo",R.R.ColorKind],["view","projection","textureInfos","alphaTest","vFogInfos","vFogColor","logarithmicDepthConstant"],["diffuseSampler"],D,void 0,void 0,void 0,void 0,this._shaderLanguage),this._drawWrapperDepth.effect=this._drawWrapperBase.effect,this._drawWrapperDepth.materialContext=this._drawWrapperBase.materialContext}render(t,K,D,a,G=null){if(!(this._shadersLoaded&&this.texture&&this.texture.isReady()&&t.length))return;const N=this._drawWrapperBase,W=this._drawWrapperDepth,x=this.fogEnabled&&this._scene&&this._scene.fogEnabled&&0!==this._scene.fogMode,b=N.effect;if(!b.isReady())return;const n=this._engine,e=!(!this._scene||!this._scene.useRightHandedSystem),i=this.texture.getBaseSize(),z=Math.min(this._capacity,t.length);let I=0,Z=!0;for(let D=0;D<z;D++){const a=t[D];a&&a.isVisible&&(Z=!1,a._animate(K),this._appendSpriteVertex(I++,a,0,0,i,e,G),this._useInstancing||(this._appendSpriteVertex(I++,a,1,0,i,e,G),this._appendSpriteVertex(I++,a,1,1,i,e,G),this._appendSpriteVertex(I++,a,0,1,i,e,G)))}if(Z)return;this._buffer.update(this._vertexData);const w=!!n.depthCullingState.cull,m=n.depthCullingState.zOffset,u=n.depthCullingState.zOffsetUnits;if(n.setState(w,m,!1,!1,void 0,void 0,u),n.enableEffect(N),b.setTexture("diffuseSampler",this.texture),b.setMatrix("view",D),b.setMatrix("projection",a),x){const t=this._scene;b.setFloat4("vFogInfos",t.fogMode,t.fogStart,t.fogEnd,t.fogDensity),b.setColor3("vFogColor",t.fogColor)}this.useLogarithmicDepth&&this._scene&&XK.DL(N.defines,b,this._scene),this._useVAO?(this._vertexArrayObject||(this._vertexArrayObject=n.recordVertexArrayObject(this._vertexBuffers,this._indexBuffer,b)),n.bindVertexArrayObject(this._vertexArrayObject,this._indexBuffer)):n.bindBuffers(this._vertexBuffers,this._indexBuffer,b),n.depthCullingState.depthFunc=n.useReverseDepthBuffer?518:515,this.disableDepthWrite||(b.setBool("alphaTest",!0),n.setColorWrite(!1),n.enableEffect(W),this._useInstancing?n.drawArraysType(7,0,4,I):n.drawElementsType(0,0,I/4*6),n.enableEffect(N),n.setColorWrite(!0),b.setBool("alphaTest",!1)),n.setAlphaMode(this.blendMode),this._useInstancing?n.drawArraysType(7,0,4,I):n.drawElementsType(0,0,I/4*6),this.autoResetAlpha&&n.setAlphaMode(0),e&&this._scene.getEngine().setState(w,m,!1,!0,void 0,void 0,u),n.unbindInstanceAttributes()}_appendSpriteVertex(t,K,D,a,G,N,W){let x=t*this._vertexBufferSize;if(0===D?D=this._epsilon:1===D&&(D=1-this._epsilon),0===a?a=this._epsilon:1===a&&(a=1-this._epsilon),W)W(K,G);else{K.cellIndex||(K.cellIndex=0);const t=G.width/this.cellWidth,D=K.cellIndex/t>>0;K._xOffset=(K.cellIndex-D*t)*this.cellWidth/G.width,K._yOffset=D*this.cellHeight/G.height,K._xSize=this.cellWidth,K._ySize=this.cellHeight}this._vertexData[x]=K.position.x,this._vertexData[x+1]=K.position.y,this._vertexData[x+2]=K.position.z,this._vertexData[x+3]=K.angle,this._vertexData[x+4]=K.width,this._vertexData[x+5]=K.height,this._useInstancing?x-=2:(this._vertexData[x+6]=D,this._vertexData[x+7]=a),this._vertexData[x+8]=N?K.invertU?0:1:K.invertU?1:0,this._vertexData[x+9]=K.invertV?1:0,this._vertexData[x+10]=K._xOffset,this._vertexData[x+11]=K._yOffset,this._vertexData[x+12]=K._xSize/G.width,this._vertexData[x+13]=K._ySize/G.height,this._vertexData[x+14]=K.color.r,this._vertexData[x+15]=K.color.g,this._vertexData[x+16]=K.color.b,this._vertexData[x+17]=K.color.a}_buildIndexBuffer(){const t=[];let K=0;for(let D=0;D<this._capacity;D++)t.push(K),t.push(K+1),t.push(K+2),t.push(K),t.push(K+2),t.push(K+3),K+=4;this._indexBuffer=this._engine.createIndexBuffer(t)}rebuild(){var t;this._indexBuffer&&this._buildIndexBuffer(),this._useVAO&&(this._vertexArrayObject=void 0),this._buffer._rebuild();for(const t in this._vertexBuffers)this._vertexBuffers[t]._rebuild();null===(t=this._spriteBuffer)||void 0===t||t._rebuild()}dispose(){var t,K;this._buffer&&(this._buffer.dispose(),this._buffer=null),this._spriteBuffer&&(this._spriteBuffer.dispose(),this._spriteBuffer=null),this._indexBuffer&&(this._engine._releaseBuffer(this._indexBuffer),this._indexBuffer=null),this._vertexArrayObject&&(this._engine.releaseVertexArrayObject(this._vertexArrayObject),this._vertexArrayObject=null),this.texture&&(this.texture.dispose(),this.texture=null),null===(t=this._drawWrapperBase)||void 0===t||t.dispose(),null===(K=this._drawWrapperDepth)||void 0===K||K.dispose(),this._isDisposed=!0}}$K.ForceGLSL=!1;class BK{set onDispose(t){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(t)}get children(){return this.sprites}get scene(){return this._scene}get capacity(){return this._spriteRenderer.capacity}get texture(){return this._spriteRenderer.texture}set texture(t){t.wrapU=U.g.CLAMP_ADDRESSMODE,t.wrapV=U.g.CLAMP_ADDRESSMODE,this._spriteRenderer.texture=t,this._textureContent=null}get cellWidth(){return this._spriteRenderer.cellWidth}set cellWidth(t){this._spriteRenderer.cellWidth=t}get cellHeight(){return this._spriteRenderer.cellHeight}set cellHeight(t){this._spriteRenderer.cellHeight=t}get fogEnabled(){return this._spriteRenderer.fogEnabled}set fogEnabled(t){this._spriteRenderer.fogEnabled=t}get useLogarithmicDepth(){return this._spriteRenderer.useLogarithmicDepth}set useLogarithmicDepth(t){this._spriteRenderer.useLogarithmicDepth=t}get blendMode(){return this._spriteRenderer.blendMode}set blendMode(t){this._spriteRenderer.blendMode=t}get disableDepthWrite(){return this._disableDepthWrite}set disableDepthWrite(t){this._disableDepthWrite=t,this._spriteRenderer.disableDepthWrite=t}get pixelPerfect(){return this._spriteRenderer.pixelPerfect}set pixelPerfect(t){this._spriteRenderer.pixelPerfect=t,t&&3!==this.texture.samplingMode&&this.texture.updateSamplingMode(3)}constructor(t,K,D,a,G,N=.01,W=U.g.TRILINEAR_SAMPLINGMODE,x=!1,b=null){this.name=t,this.sprites=[],this.renderingGroupId=0,this.layerMask=268435455,this.isPickable=!1,this.metadata=null,this._wasDispatched=!1,this.onDisposeObservable=new d.cP,this._disableDepthWrite=!1,this._packedAndReady=!1,this._customUpdate=(t,K)=>{t.cellRef||(t.cellIndex=0);const D=t.cellIndex;"number"==typeof D&&isFinite(D)&&Math.floor(D)===D&&(t.cellRef=this._spriteMap[t.cellIndex]),t._xOffset=this._cellData[t.cellRef].frame.x/K.width,t._yOffset=this._cellData[t.cellRef].frame.y/K.height,t._xSize=this._cellData[t.cellRef].frame.w,t._ySize=this._cellData[t.cellRef].frame.h},G||(G=$.q.LastCreatedScene),G._getComponent(M.v.NAME_SPRITE)||G._addComponent(new SK(G)),this._fromPacked=x,this._scene=G;const n=this._scene.getEngine();if(this._spriteRenderer=new $K(n,D,N,G),a.width&&a.height)this.cellWidth=a.width,this.cellHeight=a.height;else{if(void 0===a)return void(this._spriteRenderer=null);this.cellWidth=a,this.cellHeight=a}this._scene.spriteManagers&&this._scene.spriteManagers.push(this),this.uniqueId=this.scene.getUniqueId(),K&&(this.texture=new U.g(K,G,!0,!1,W)),this._fromPacked&&this._makePacked(K,b)}getClassName(){return"SpriteManager"}_makePacked(t,K){if(null!==K)try{let t;if(t="string"==typeof K?JSON.parse(K):K,t.frames.length){const K={};for(let D=0;D<t.frames.length;D++){const a=t.frames[D];if("string"!=typeof Object.keys(a)[0])throw new Error("Invalid JSON Format.  Check the frame values and make sure the name is the first parameter.");K[a[Object.keys(a)[0]]]=a}t.frames=K}const D=Reflect.ownKeys(t.frames);this._spriteMap=D,this._packedAndReady=!0,this._cellData=t.frames}catch(t){throw this._fromPacked=!1,this._packedAndReady=!1,new Error("Invalid JSON from string. Spritesheet managed with constant cell size.")}else{const K=/\./g;let D;do{D=K.lastIndex,K.test(t)}while(K.lastIndex>0);const a=t.substring(0,D-1)+".json",G=()=>{i.V.Error("JSON ERROR: Unable to load JSON file."),this._fromPacked=!1,this._packedAndReady=!1},N=t=>{try{const K=JSON.parse(t),D=Reflect.ownKeys(K.frames);this._spriteMap=D,this._packedAndReady=!0,this._cellData=K.frames}catch(t){throw this._fromPacked=!1,this._packedAndReady=!1,new Error("Invalid JSON format. Please check documentation for format specifications.")}};m.S0.LoadFile(a,N,void 0,void 0,!1,G)}}_checkTextureAlpha(t,K,D,a,G){if(!t.useAlphaForPicking||!this.texture)return!0;const W=this.texture.getSize();this._textureContent||(this._textureContent=new Uint8Array(W.width*W.height*4),this.texture.readPixels(0,0,this._textureContent));const x=N.AA.Vector3[0];x.copyFrom(K.direction),x.normalize(),x.scaleInPlace(D),x.addInPlace(K.origin);const b=(x.x-a.x)/(G.x-a.x),n=1-(x.y-a.y)/(G.y-a.y),e=t._xOffset*W.width+b*t._xSize|0,i=t._yOffset*W.height+n*t._ySize|0;return this._textureContent[4*(e+i*W.width)+3]>.5}intersects(t,K,D,a){const G=Math.min(this.capacity,this.sprites.length),W=N.Pq.Zero(),x=N.Pq.Zero();let b=Number.MAX_VALUE,n=null;const e=N.AA.Vector3[0],i=N.AA.Vector3[1],z=K.getViewMatrix();let I=t,Z=t;for(let K=0;K<G;K++){const G=this.sprites[K];if(G){if(D){if(!D(G))continue}else if(!G.isPickable)continue;if(N.Pq.TransformCoordinatesToRef(G.position,z,i),G.angle?(N.uq.TranslationToRef(-i.x,-i.y,0,N.AA.Matrix[1]),N.uq.TranslationToRef(i.x,i.y,0,N.AA.Matrix[2]),N.uq.RotationZToRef(-G.angle,N.AA.Matrix[3]),N.AA.Matrix[1].multiplyToRef(N.AA.Matrix[3],N.AA.Matrix[4]),N.AA.Matrix[4].multiplyToRef(N.AA.Matrix[2],N.AA.Matrix[0]),I=t.clone(),N.Pq.TransformCoordinatesToRef(t.origin,N.AA.Matrix[0],I.origin),N.Pq.TransformNormalToRef(t.direction,N.AA.Matrix[0],I.direction)):I=t,W.copyFromFloats(i.x-G.width/2,i.y-G.height/2,i.z),x.copyFromFloats(i.x+G.width/2,i.y+G.height/2,i.z),I.intersectsBoxMinMax(W,x)){const t=N.Pq.Distance(i,I.origin);if(b>t){if(!this._checkTextureAlpha(G,I,t,W,x))continue;if(Z=I,b=t,n=G,a)break}}}}if(n){const t=new RK.G;z.invertToRef(N.AA.Matrix[0]),t.hit=!0,t.pickedSprite=n,t.distance=b;const K=N.AA.Vector3[2];return K.copyFrom(Z.direction),K.normalize(),K.scaleInPlace(b),Z.origin.addToRef(K,e),t.pickedPoint=N.Pq.TransformCoordinates(e,N.AA.Matrix[0]),t}return null}multiIntersects(t,K,D){const a=Math.min(this.capacity,this.sprites.length),G=N.Pq.Zero(),W=N.Pq.Zero();let x;const b=[],n=N.AA.Vector3[0].copyFromFloats(0,0,0),e=N.AA.Vector3[1].copyFromFloats(0,0,0),i=K.getViewMatrix();for(let K=0;K<a;K++){const a=this.sprites[K];if(a){if(D){if(!D(a))continue}else if(!a.isPickable)continue;if(N.Pq.TransformCoordinatesToRef(a.position,i,e),G.copyFromFloats(e.x-a.width/2,e.y-a.height/2,e.z),W.copyFromFloats(e.x+a.width/2,e.y+a.height/2,e.z),t.intersectsBoxMinMax(G,W)){if(x=N.Pq.Distance(e,t.origin),!this._checkTextureAlpha(a,t,x,G,W))continue;const K=new RK.G;b.push(K),i.invertToRef(N.AA.Matrix[0]),K.hit=!0,K.pickedSprite=a,K.distance=x;const D=N.AA.Vector3[2];D.copyFrom(t.direction),D.normalize(),D.scaleInPlace(x),t.origin.addToRef(D,n),K.pickedPoint=N.Pq.TransformCoordinates(n,N.AA.Matrix[0])}}}return b}render(){if(this._fromPacked&&(!this._packedAndReady||!this._spriteMap||!this._cellData))return;const t=this._scene.getEngine().getDeltaTime();this._packedAndReady?this._spriteRenderer.render(this.sprites,t,this._scene.getViewMatrix(),this._scene.getProjectionMatrix(),this._customUpdate):this._spriteRenderer.render(this.sprites,t,this._scene.getViewMatrix(),this._scene.getProjectionMatrix())}rebuild(){var t;null===(t=this._spriteRenderer)||void 0===t||t.rebuild()}dispose(){if(this._spriteRenderer&&(this._spriteRenderer.dispose(),this._spriteRenderer=null),this._textureContent=null,this._scene.spriteManagers){const t=this._scene.spriteManagers.indexOf(this);this._scene.spriteManagers.splice(t,1)}this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.metadata=null}serialize(t=!1){const K={};K.name=this.name,K.capacity=this.capacity,K.cellWidth=this.cellWidth,K.cellHeight=this.cellHeight,K.fogEnabled=this.fogEnabled,K.blendMode=this.blendMode,K.disableDepthWrite=this.disableDepthWrite,K.pixelPerfect=this.pixelPerfect,K.useLogarithmicDepth=this.useLogarithmicDepth,this.texture&&(t?K.texture=this.texture.serialize():(K.textureUrl=this.texture.name,K.invertY=this.texture._invertY)),K.sprites=[];for(const t of this.sprites)K.sprites.push(t.serialize());return K.metadata=this.metadata,K}static Parse(t,K,D){const a=new BK(t.name,"",t.capacity,{width:t.cellWidth,height:t.cellHeight},K);void 0!==t.fogEnabled&&(a.fogEnabled=t.fogEnabled),void 0!==t.blendMode&&(a.blendMode=t.blendMode),void 0!==t.disableDepthWrite&&(a.disableDepthWrite=t.disableDepthWrite),void 0!==t.pixelPerfect&&(a.pixelPerfect=t.pixelPerfect),void 0!==t.useLogarithmicDepth&&(a.useLogarithmicDepth=t.useLogarithmicDepth),void 0!==t.metadata&&(a.metadata=t.metadata),t.texture?a.texture=U.g.Parse(t.texture,K,D):t.textureName&&(a.texture=new U.g(D+t.textureUrl,K,!1,void 0===t.invertY||t.invertY));for(const K of t.sprites)gK.Parse(K,a);return a}static ParseFromFileAsync(t,K,D,a=""){return new Promise(((G,N)=>{const W=new Ht.u;W.addEventListener("readystatechange",(()=>{if(4==W.readyState)if(200==W.status){const K=JSON.parse(W.responseText),N=BK.Parse(K,D||$.q.LastCreatedScene,a);t&&(N.name=t),G(N)}else N("Unable to load the sprite manager")})),W.open("GET",K),W.send()}))}static ParseFromSnippetAsync(t,K,D=""){return"_BLANK"===t?Promise.resolve(new BK("Default sprite manager","//playground.babylonjs.com/textures/player.png",500,64,K)):new Promise(((a,G)=>{const N=new Ht.u;N.addEventListener("readystatechange",(()=>{if(4==N.readyState)if(200==N.status){const G=JSON.parse(JSON.parse(N.responseText).jsonPayload),W=JSON.parse(G.spriteManager),x=BK.Parse(W,K||$.q.LastCreatedScene,D);x.snippetId=t,a(x)}else G("Unable to load the snippet "+t)})),N.open("GET",this.SnippetUrl+"/"+t.replace(/#/g,"/")),N.send()}))}}BK.SnippetUrl=`https://snippet.babylonjs.com`,BK.CreateFromSnippetAsync=BK.ParseFromSnippetAsync;class OK{}OK.LoaderInjectedPhysicsEngine=void 0;let vK={},pK={};const jK=(t,K,D,a)=>{if(!K.materials)return null;for(let G=0,N=K.materials.length;G<N;G++){const N=K.materials[G];if(t(N))return{parsedMaterial:N,material:p.i.Parse(N,D,a)}}return null},rK=(t,K,D)=>{for(const a in K)if(t.name===K[a])return D.push(t.id),!0;return void 0!==t.parentId&&-1!==D.indexOf(t.parentId)&&(D.push(t.id),!0)},MK=(t,K)=>t+" of "+(K?K.file+" from "+K.name+" version: "+K.version+", exporter version: "+K.exporter_version:"unknown"),kK=(t,K)=>{const D=K;if(K._waitingData.lods){if(K._waitingData.lods.ids&&K._waitingData.lods.ids.length>0){const a=K._waitingData.lods.ids,G=D.isEnabled(!1);if(K._waitingData.lods.distances){const N=K._waitingData.lods.distances;if(N.length>=a.length){const K=N.length>a.length?N[N.length-1]:0;D.setEnabled(!1);for(let K=0;K<a.length;K++){const G=a[K],W=t.getMeshById(G);null!=W&&D.addLODLevel(N[K],W)}K>0&&D.addLODLevel(K,null),!0===G&&D.setEnabled(!0)}else m.S0.Warn("Invalid level of detail distances for "+K.name)}}K._waitingData.lods=null}},tD=(t,K,D)=>{if("number"!=typeof t){const a=D.getLastEntryById(t);return a&&null!=K?a.instances[parseInt(K)]:a}const a=vK[t];return a&&null!=K?a.instances[parseInt(K)]:a},KD=(t,K)=>"number"!=typeof t?K.getLastMaterialById(t,!0):pK[t],DD=(t,K,D,a,G=!1)=>{const N=new Ot(t);let x="importScene has failed JSON parse";try{var b=JSON.parse(K);x="";const a=Lt.cn.loggingLevel===Lt.cn.DETAILED_LOGGING;let G,n;if(void 0!==b.environmentTexture&&null!==b.environmentTexture){const K=void 0===b.isPBR||b.isPBR;if(b.environmentTextureType&&"BABYLON.HDRCubeTexture"===b.environmentTextureType){const a=b.environmentTextureSize?b.environmentTextureSize:128,G=new Tt((b.environmentTexture.match(/https?:\/\//g)?"":D)+b.environmentTexture,t,a,!0,!K,void 0,b.environmentTexturePrefilterOnLoad);b.environmentTextureRotationY&&(G.rotationY=b.environmentTextureRotationY),t.environmentTexture=G}else if("object"==typeof b.environmentTexture){const K=Zt.Parse(b.environmentTexture,t,D);t.environmentTexture=K}else if(b.environmentTexture.endsWith(".env")){const K=new Zt((b.environmentTexture.match(/https?:\/\//g)?"":D)+b.environmentTexture,t,b.environmentTextureForcedExtension);b.environmentTextureRotationY&&(K.rotationY=b.environmentTextureRotationY),t.environmentTexture=K}else{const K=Zt.CreateFromPrefilteredData((b.environmentTexture.match(/https?:\/\//g)?"":D)+b.environmentTexture,t,b.environmentTextureForcedExtension);b.environmentTextureRotationY&&(K.rotationY=b.environmentTextureRotationY),t.environmentTexture=K}if(!0===b.createDefaultSkybox){const D=void 0!==t.activeCamera&&null!==t.activeCamera?(t.activeCamera.maxZ-t.activeCamera.minZ)/2:1e3,a=b.skyboxBlurLevel||0;t.createDefaultSkybox(t.environmentTexture,K,D,a)}N.environmentTexture=t.environmentTexture}if(void 0!==b.environmentIntensity&&null!==b.environmentIntensity&&(t.environmentIntensity=b.environmentIntensity),void 0!==b.lights&&null!==b.lights)for(G=0,n=b.lights.length;G<n;G++){const K=b.lights[G],D=H.v.Parse(K,t);D&&(vK[K.uniqueId]=D,N.lights.push(D),D._parentContainer=N,x+=0===G?"\n\tLights:":"",x+="\n\t\t"+D.toString(a))}if(void 0!==b.reflectionProbes&&null!==b.reflectionProbes)for(G=0,n=b.reflectionProbes.length;G<n;G++){const K=b.reflectionProbes[G],W=sK.Parse(K,t,D);W&&(N.reflectionProbes.push(W),W._parentContainer=N,x+=0===G?"\n\tReflection Probes:":"",x+="\n\t\t"+W.toString(a))}if(void 0!==b.animations&&null!==b.animations)for(G=0,n=b.animations.length;G<n;G++){const K=b.animations[G],D=J.n9("BABYLON.Animation");if(D){const W=D.Parse(K);t.animations.push(W),N.animations.push(W),x+=0===G?"\n\tAnimations:":"",x+="\n\t\t"+W.toString(a)}}if(void 0!==b.materials&&null!==b.materials)for(G=0,n=b.materials.length;G<n;G++){const K=b.materials[G],W=p.i.Parse(K,t,D);W&&(pK[K.uniqueId||K.id]=W,N.materials.push(W),W._parentContainer=N,x+=0===G?"\n\tMaterials:":"",x+="\n\t\t"+W.toString(a),W.getActiveTextures().forEach((t=>{-1==N.textures.indexOf(t)&&(N.textures.push(t),t._parentContainer=N)})))}if(void 0!==b.multiMaterials&&null!==b.multiMaterials)for(G=0,n=b.multiMaterials.length;G<n;G++){const K=b.multiMaterials[G],D=j.ParseMultiMaterial(K,t);pK[K.uniqueId||K.id]=D,N.multiMaterials.push(D),D._parentContainer=N,x+=0===G?"\n\tMultiMaterials:":"",x+="\n\t\t"+D.toString(a),D.getActiveTextures().forEach((t=>{-1==N.textures.indexOf(t)&&(N.textures.push(t),t._parentContainer=N)}))}if(void 0!==b.morphTargetManagers&&null!==b.morphTargetManagers)for(const K of b.morphTargetManagers){const D=bK.Parse(K,t);N.morphTargetManagers.push(D),D._parentContainer=N}if(void 0!==b.skeletons&&null!==b.skeletons)for(G=0,n=b.skeletons.length;G<n;G++){const K=b.skeletons[G],D=GK.Parse(K,t);N.skeletons.push(D),D._parentContainer=N,x+=0===G?"\n\tSkeletons:":"",x+="\n\t\t"+D.toString(a)}const e=b.geometries;if(null!=e){const K=new Array,a=e.vertexData;if(null!=a)for(G=0,n=a.length;G<n;G++){const N=a[G];K.push(O.Parse(N,t,D))}K.forEach((t=>{t&&(N.geometries.push(t),t._parentContainer=N)}))}if(void 0!==b.transformNodes&&null!==b.transformNodes)for(G=0,n=b.transformNodes.length;G<n;G++){const K=b.transformNodes[G],a=Wt.V.Parse(K,t,D);vK[K.uniqueId]=a,N.transformNodes.push(a),a._parentContainer=N}if(void 0!==b.meshes&&null!==b.meshes)for(G=0,n=b.meshes.length;G<n;G++){const K=b.meshes[G],W=Nt.Parse(K,t,D);if(vK[K.uniqueId]=W,N.meshes.push(W),W._parentContainer=N,W.hasInstances)for(const t of W.instances)N.meshes.push(t),t._parentContainer=N;x+=0===G?"\n\tMeshes:":"",x+="\n\t\t"+W.toString(a)}if(void 0!==b.cameras&&null!==b.cameras)for(G=0,n=b.cameras.length;G<n;G++){const K=b.cameras[G],D=W.i.Parse(K,t);vK[K.uniqueId]=D,N.cameras.push(D),D._parentContainer=N,x+=0===G?"\n\tCameras:":"",x+="\n\t\t"+D.toString(a)}if(void 0!==b.postProcesses&&null!==b.postProcesses)for(G=0,n=b.postProcesses.length;G<n;G++){const K=b.postProcesses[G],a=FK.w.Parse(K,t,D);a&&(N.postProcesses.push(a),a._parentContainer=N,x+=0===G?"\nPostprocesses:":"",x+="\n\t\t"+a.toString())}if(void 0!==b.animationGroups&&null!==b.animationGroups)for(G=0,n=b.animationGroups.length;G<n;G++){const K=b.animationGroups[G],D=Yt.Parse(K,t);N.animationGroups.push(D),D._parentContainer=N,x+=0===G?"\n\tAnimationGroups:":"",x+="\n\t\t"+D.toString(a)}if(b.spriteManagers)for(let K=0,a=b.spriteManagers.length;K<a;K++){const a=b.spriteManagers[K];x+="\n\t\tSpriteManager "+BK.Parse(a,t,D).name}for(G=0,n=t.cameras.length;G<n;G++){const K=t.cameras[G];null!==K._waitingParentId&&(K.parent=tD(K._waitingParentId,K._waitingParentInstanceIndex,t),K._waitingParentId=null,K._waitingParentInstanceIndex=null)}for(G=0,n=t.lights.length;G<n;G++){const K=t.lights[G];K&&null!==K._waitingParentId&&(K.parent=tD(K._waitingParentId,K._waitingParentInstanceIndex,t),K._waitingParentId=null,K._waitingParentInstanceIndex=null)}for(G=0,n=t.transformNodes.length;G<n;G++){const K=t.transformNodes[G];null!==K._waitingParentId&&(K.parent=tD(K._waitingParentId,K._waitingParentInstanceIndex,t),K._waitingParentId=null,K._waitingParentInstanceIndex=null)}for(G=0,n=t.meshes.length;G<n;G++){const K=t.meshes[G];null!==K._waitingParentId&&(K.parent=tD(K._waitingParentId,K._waitingParentInstanceIndex,t),K._waitingParentId=null,K._waitingParentInstanceIndex=null),K._waitingData.lods&&kK(t,K)}for(t.multiMaterials.forEach((K=>{K._waitingSubMaterialsUniqueIds.forEach((D=>{K.subMaterials.push(KD(D,t))})),K._waitingSubMaterialsUniqueIds=[]})),t.meshes.forEach((K=>{null!==K._waitingMaterialId&&(K.material=KD(K._waitingMaterialId,t),K._waitingMaterialId=null)})),G=0,n=t.skeletons.length;G<n;G++){const K=t.skeletons[G];K._hasWaitingData&&(null!=K.bones&&K.bones.forEach((K=>{if(K._waitingTransformNodeId){const D=t.getLastEntryById(K._waitingTransformNodeId);D&&K.linkTransformNode(D),K._waitingTransformNodeId=null}})),K._hasWaitingData=null)}for(G=0,n=t.meshes.length;G<n;G++){const K=t.meshes[G];K._waitingData.freezeWorldMatrix?(K.freezeWorldMatrix(),K._waitingData.freezeWorldMatrix=null):K.computeWorldMatrix(!0)}for(G=0,n=t.lights.length;G<n;G++){const K=t.lights[G];if(K._excludedMeshesIds.length>0){for(let D=0;D<K._excludedMeshesIds.length;D++){const a=t.getMeshById(K._excludedMeshesIds[D]);a&&K.excludedMeshes.push(a)}K._excludedMeshesIds=[]}if(K._includedOnlyMeshesIds.length>0){for(let D=0;D<K._includedOnlyMeshesIds.length;D++){const a=t.getMeshById(K._includedOnlyMeshesIds[D]);a&&K.includedOnlyMeshes.push(a)}K._includedOnlyMeshesIds=[]}}for(t.geometries.forEach((t=>{t._loadedUniqueId=""})),St.d.Parse(b,t,N,D),G=0,n=t.meshes.length;G<n;G++){const K=t.meshes[G];K._waitingData.actions&&(tK.Parse(K._waitingData.actions,K,t),K._waitingData.actions=null)}void 0!==b.actions&&null!==b.actions&&tK.Parse(b.actions,null,t)}catch(t){const K=MK("loadAssets",b?b.producer:"Unknown")+x;if(!a)throw i.V.Log(K),t;a(K,t)}finally{vK={},pK={},G||N.removeAllFromScene(),null!==x&&Lt.cn.loggingLevel!==Lt.cn.NO_LOGGING&&i.V.Log(MK("loadAssets",b?b.producer:"Unknown")+(Lt.cn.loggingLevel!==Lt.cn.MINIMAL_LOGGING?x:""))}return N};Lt.cn.RegisterPlugin({name:"babylon.js",extensions:".babylon",canDirectLoad:t=>-1!==t.indexOf("babylon"),rewriteRootURL:function(t){return 0?0:window.EVO_CDN||""},importMesh:(t,K,D,a,G,N,W,x)=>{var b;let n="importMesh has failed JSON parse";try{var e=JSON.parse(D);n="";const x=Lt.cn.loggingLevel===Lt.cn.DETAILED_LOGGING;t?Array.isArray(t)||(t=[t]):t=null;const z=[],I=new Map,Z=[];if(void 0!==e.transformNodes&&null!==e.transformNodes)for(let t=0,D=e.transformNodes.length;t<D;t++){const D=e.transformNodes[t],G=Wt.V.Parse(D,K,a);Z.push(G),I.set(G._waitingParsedUniqueId,G),G._waitingParsedUniqueId=null}if(void 0!==e.meshes&&null!==e.meshes){const D=[],N=[],w=[],m=[];for(let b=0,Z=e.meshes.length;b<Z;b++){const Z=e.meshes[b];if(null===t||rK(Z,t,z)){if(null!==t&&delete t[t.indexOf(Z.name)],void 0!==Z.geometryId&&null!==Z.geometryId&&void 0!==e.geometries&&null!==e.geometries){let t=!1;["boxes","spheres","cylinders","toruses","grounds","planes","torusKnots","vertexData"].forEach((D=>{!0!==t&&e.geometries[D]&&Array.isArray(e.geometries[D])&&e.geometries[D].forEach((G=>{G.id===Z.geometryId&&("vertexData"===D&&O.Parse(G,K,a),t=!0)}))})),!1===t&&i.V.Warn("Geometry not found for mesh "+Z.id)}if(Z.materialUniqueId||Z.materialId){const t=Z.materialUniqueId?w:N;let D=-1!==t.indexOf(Z.materialUniqueId||Z.materialId);if(!1===D&&void 0!==e.multiMaterials&&null!==e.multiMaterials){const G=(D,G)=>{t.push(D);const N=jK(G,e,K,a);N&&N.material&&(pK[N.parsedMaterial.uniqueId||N.parsedMaterial.id]=N.material,n+="\n\tMaterial "+N.material.toString(x))};for(let a=0,N=e.multiMaterials.length;a<N;a++){const N=e.multiMaterials[a];if(Z.materialUniqueId&&N.uniqueId===Z.materialUniqueId||N.id===Z.materialId){N.materialsUniqueIds?N.materialsUniqueIds.forEach((t=>G(t,(K=>K.uniqueId===t)))):N.materials.forEach((t=>G(t,(K=>K.id===t)))),t.push(N.uniqueId||N.id);const a=j.ParseMultiMaterial(N,K);pK[N.uniqueId||N.id]=a,a&&(D=!0,n+="\n\tMulti-Material "+a.toString(x));break}}}if(!1===D){t.push(Z.materialUniqueId||Z.materialId);const D=jK((t=>Z.materialUniqueId&&t.uniqueId===Z.materialUniqueId||t.id===Z.materialId),e,K,a);D&&D.material?(pK[D.parsedMaterial.uniqueId||D.parsedMaterial.id]=D.material,n+="\n\tMaterial "+D.material.toString(x)):i.V.Warn("Material not found for mesh "+Z.id)}}if(null!==Z.skeletonId&&void 0!==Z.skeletonId&&-1!==e.skeletonId&&void 0!==e.skeletons&&null!==e.skeletons&&!(D.indexOf(Z.skeletonId)>-1))for(let t=0,a=e.skeletons.length;t<a;t++){const a=e.skeletons[t];if(a.id===Z.skeletonId){const t=GK.Parse(a,K);W.push(t),D.push(a.id),n+="\n\tSkeleton "+t.toString(x)}}if(Z.morphTargetManagerId>-1&&void 0!==e.morphTargetManagers&&null!==e.morphTargetManagers&&!(m.indexOf(Z.morphTargetManagerId)>-1))for(let t=0,D=e.morphTargetManagers.length;t<D;t++){const D=e.morphTargetManagers[t];if(D.id===Z.morphTargetManagerId){const t=bK.Parse(D,K);m.push(t.uniqueId),n+="\nMorph target "+t.toString()}}const b=Nt.Parse(Z,K,a);G.push(b),I.set(b._waitingParsedUniqueId,b),b._waitingParsedUniqueId=null,n+="\n\tMesh "+b.toString(x)}}K.multiMaterials.forEach((t=>{t._waitingSubMaterialsUniqueIds.forEach((D=>{t.subMaterials.push(KD(D,K))})),t._waitingSubMaterialsUniqueIds=[]})),K.meshes.forEach((t=>{null!==t._waitingMaterialId&&(t.material=KD(t._waitingMaterialId,K),t._waitingMaterialId=null)}));for(let t=0,D=K.transformNodes.length;t<D;t++){const D=K.transformNodes[t];if(null!==D._waitingParentId){let t=I.get(parseInt(D._waitingParentId))||null;null===t&&(t=K.getLastEntryById(D._waitingParentId));let a=t;D._waitingParentInstanceIndex&&(a=t.instances[parseInt(D._waitingParentInstanceIndex)],D._waitingParentInstanceIndex=null),D.parent=a,D._waitingParentId=null}}let u;for(let t=0,D=K.meshes.length;t<D;t++){if(u=K.meshes[t],u._waitingParentId){let t=I.get(parseInt(u._waitingParentId))||null;null===t&&(t=K.getLastEntryById(u._waitingParentId));let D=t;if(u._waitingParentInstanceIndex&&(D=t.instances[parseInt(u._waitingParentInstanceIndex)],u._waitingParentInstanceIndex=null),u.parent=D,"TransformNode"===(null===(b=u.parent)||void 0===b?void 0:b.getClassName())){const t=Z.indexOf(u.parent);t>-1&&Z.splice(t,1)}u._waitingParentId=null}u._waitingData.lods&&kK(K,u)}for(const t of Z)t.dispose();for(let t=0,D=K.skeletons.length;t<D;t++){const D=K.skeletons[t];D._hasWaitingData&&(null!=D.bones&&D.bones.forEach((t=>{if(t._waitingTransformNodeId){const D=K.getLastEntryById(t._waitingTransformNodeId);D&&t.linkTransformNode(D),t._waitingTransformNodeId=null}})),D._hasWaitingData=null)}for(let t=0,D=K.meshes.length;t<D;t++)u=K.meshes[t],u._waitingData.freezeWorldMatrix?(u.freezeWorldMatrix(),u._waitingData.freezeWorldMatrix=null):u.computeWorldMatrix(!0)}if(void 0!==e.particleSystems&&null!==e.particleSystems){const t=St.d.GetIndividualParser(M.v.NAME_PARTICLESYSTEM);if(t)for(let D=0,G=e.particleSystems.length;D<G;D++){const G=e.particleSystems[D];-1!==z.indexOf(G.emitterId)&&N.push(t(G,K,a))}}return K.geometries.forEach((t=>{t._loadedUniqueId=""})),!0}catch(t){const K=MK("importMesh",e?e.producer:"Unknown")+n;if(!x)throw i.V.Log(K),t;x(K,t)}finally{null!==n&&Lt.cn.loggingLevel!==Lt.cn.NO_LOGGING&&i.V.Log(MK("importMesh",e?e.producer:"Unknown")+(Lt.cn.loggingLevel!==Lt.cn.MINIMAL_LOGGING?n:"")),pK={}}return!1},load:(t,K,D,a)=>{let G="importScene has failed JSON parse";try{var W=JSON.parse(K);switch(G="",void 0!==W.useDelayedTextureLoading&&null!==W.useDelayedTextureLoading&&(t.useDelayedTextureLoading=W.useDelayedTextureLoading&&!Lt.cn.ForceFullSceneLoadingForIncremental),void 0!==W.autoClear&&null!==W.autoClear&&(t.autoClear=W.autoClear),void 0!==W.clearColor&&null!==W.clearColor&&(t.clearColor=s.ov.FromArray(W.clearColor)),void 0!==W.ambientColor&&null!==W.ambientColor&&(t.ambientColor=s.v9.FromArray(W.ambientColor)),void 0!==W.gravity&&null!==W.gravity&&(t.gravity=N.Pq.FromArray(W.gravity)),void 0!==W.useRightHandedSystem&&(t.useRightHandedSystem=!!W.useRightHandedSystem),void 0!==W.fogMode&&null!==W.fogMode&&(t.fogMode=W.fogMode),void 0!==W.fogColor&&null!==W.fogColor&&(t.fogColor=s.v9.FromArray(W.fogColor)),void 0!==W.fogStart&&null!==W.fogStart&&(t.fogStart=W.fogStart),void 0!==W.fogEnd&&null!==W.fogEnd&&(t.fogEnd=W.fogEnd),void 0!==W.fogDensity&&null!==W.fogDensity&&(t.fogDensity=W.fogDensity),G+="\tFog mode for scene:  ",t.fogMode){case 0:G+="none\n";break;case 1:G+="exp\n";break;case 2:G+="exp2\n";break;case 3:G+="linear\n"}if(W.physicsEnabled){let K;"cannon"===W.physicsEngine||W.physicsEngine===ZK.name?K=new ZK(void 0,void 0,OK.LoaderInjectedPhysicsEngine):"oimo"===W.physicsEngine||W.physicsEngine===wK.name?K=new wK(void 0,OK.LoaderInjectedPhysicsEngine):"ammo"!==W.physicsEngine&&W.physicsEngine!==UK.name||(K=new UK(void 0,OK.LoaderInjectedPhysicsEngine,void 0)),G="\tPhysics engine "+(W.physicsEngine?W.physicsEngine:"oimo")+" enabled\n";const D=W.gravity?N.Pq.FromArray(W.gravity):W.physicsGravity?N.Pq.FromArray(W.physicsGravity):null;t.enablePhysics(D,K)}return void 0!==W.metadata&&null!==W.metadata&&(t.metadata=W.metadata),void 0!==W.collisionsEnabled&&null!==W.collisionsEnabled&&(t.collisionsEnabled=W.collisionsEnabled),!!DD(t,K,D,a,!0)&&(W.autoAnimate&&t.beginAnimation(t,W.autoAnimateFrom,W.autoAnimateTo,W.autoAnimateLoop,W.autoAnimateSpeed||1),void 0!==W.activeCameraID&&null!==W.activeCameraID&&t.setActiveCameraById(W.activeCameraID),!0)}catch(t){const K=MK("importScene",W?W.producer:"Unknown")+G;if(!a)throw i.V.Log(K),t;a(K,t)}finally{null!==G&&Lt.cn.loggingLevel!==Lt.cn.NO_LOGGING&&i.V.Log(MK("importScene",W?W.producer:"Unknown")+(Lt.cn.loggingLevel!==Lt.cn.MINIMAL_LOGGING?G:""))}return!1},loadAssetContainer:(t,K,D,a)=>DD(t,K,D,a)});var aD=D(32138);bt.w.prototype.createDynamicTexture=function(t,K,D,a){const G=new nt.h(this,4);return G.baseWidth=t,G.baseHeight=K,D&&(t=this.needPOTTextures?qt.R(t,this._caps.maxTextureSize):t,K=this.needPOTTextures?qt.R(K,this._caps.maxTextureSize):K),G.width=t,G.height=K,G.isReady=!1,G.generateMipMaps=D,G.samplingMode=a,this.updateTextureSamplingMode(a,G),this._internalTexturesCache.push(G),G},bt.w.prototype.updateDynamicTexture=function(t,K,D,a=!1,G,N=!1,W=!1){if(!t)return;const x=this._gl,b=x.TEXTURE_2D,n=this._bindTextureDirectly(b,t,!0,N);this._unpackFlipY(void 0===D?t.invertY:D),a&&x.pixelStorei(x.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1);const e=this._getWebGLTextureType(t.type),i=this._getInternalFormat(G||t.format),z=this._getRGBABufferInternalSizedFormat(t.type,i);x.texImage2D(b,0,z,i,e,K),t.generateMipMaps&&x.generateMipmap(b),n||this._bindTextureDirectly(b,null),a&&x.pixelStorei(x.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),G&&(t.format=G),t._dynamicTextureSource=K,t._premulAlpha=a,t.invertY=D||!1,t.isReady=!0};class GD extends U.g{constructor(t,K,D=null,a=!1,G=3,N=5,W){super(null,D,!a,W,G,void 0,void 0,void 0,void 0,N),this.name=t,this.wrapU=U.g.CLAMP_ADDRESSMODE,this.wrapV=U.g.CLAMP_ADDRESSMODE,this._generateMipMaps=a;const x=this._getEngine();if(!x)return;K.getContext?(this._canvas=K,this._ownCanvas=!1,this._texture=x.createDynamicTexture(K.width,K.height,a,G)):(this._canvas=x.createCanvas(1,1),this._ownCanvas=!0,K.width||0===K.width?this._texture=x.createDynamicTexture(K.width,K.height,a,G):this._texture=x.createDynamicTexture(K,K,a,G));const b=this.getSize();this._canvas.width!==b.width&&(this._canvas.width=b.width),this._canvas.height!==b.height&&(this._canvas.height=b.height),this._context=this._canvas.getContext("2d")}getClassName(){return"DynamicTexture"}get canRescale(){return!0}_recreate(t){this._canvas.width=t.width,this._canvas.height=t.height,this.releaseInternalTexture(),this._texture=this._getEngine().createDynamicTexture(t.width,t.height,this._generateMipMaps,this.samplingMode)}scale(t){const K=this.getSize();K.width*=t,K.height*=t,this._recreate(K)}scaleTo(t,K){const D=this.getSize();D.width=t,D.height=K,this._recreate(D)}getContext(){return this._context}clear(t){const K=this.getSize();t&&(this._context.fillStyle=t),this._context.clearRect(0,0,K.width,K.height)}update(t,K=!1,D=!1){this._getEngine().updateDynamicTexture(this._texture,this._canvas,void 0===t||t,K,this._format||void 0,void 0,D)}drawText(t,K,D,a,G,N,W,x=!0){const b=this.getSize();if(N&&(this._context.fillStyle=N,this._context.fillRect(0,0,b.width,b.height)),this._context.font=a,null==K){const D=this._context.measureText(t);K=(b.width-D.width)/2}if(null==D){const t=parseInt(a.replace(/\D/g,""));D=b.height/2+t/3.65}this._context.fillStyle=G||"",this._context.fillText(t,K,D),x&&this.update(W)}dispose(){var t,K;super.dispose(),this._ownCanvas&&(null===(K=null===(t=this._canvas)||void 0===t?void 0:t.remove)||void 0===K||K.call(t)),this._canvas=null,this._context=null}clone(){const t=this.getScene();if(!t)return this;const K=this.getSize(),D=new GD(this.name,K,t,this._generateMipMaps);return D.hasAlpha=this.hasAlpha,D.level=this.level,D.wrapU=this.wrapU,D.wrapV=this.wrapV,D}serialize(){const t=this.getScene();t&&!t.isReady()&&i.V.Warn("The scene must be ready before serializing the dynamic texture");const K=super.serialize();return GD._IsCanvasElement(this._canvas)&&(K.base64String=this._canvas.toDataURL()),K.invertY=this._invertY,K.samplingMode=this.samplingMode,K}static _IsCanvasElement(t){return void 0!==t.toDataURL}_rebuild(){this.update()}}Nt._GroundMeshParser=(t,K)=>ND.Parse(t,K);class ND extends Nt{constructor(t,K){super(t,K),this.generateOctree=!1}getClassName(){return"GroundMesh"}get subdivisions(){return Math.min(this._subdivisionsX,this._subdivisionsY)}get subdivisionsX(){return this._subdivisionsX}get subdivisionsY(){return this._subdivisionsY}optimize(t,K=32){this._subdivisionsX=t,this._subdivisionsY=t,this.subdivide(t);this.createOrUpdateSubmeshesOctree&&this.createOrUpdateSubmeshesOctree(K)}getHeightAtCoordinates(t,K){const D=this.getWorldMatrix(),a=N.AA.Matrix[5];D.invertToRef(a);const G=N.AA.Vector3[8];if(N.Pq.TransformCoordinatesFromFloatsToRef(t,0,K,a,G),t=G.x,K=G.z,t<this._minX||t>=this._maxX||K<=this._minZ||K>this._maxZ)return this.position.y;this._heightQuads&&0!=this._heightQuads.length||(this._initHeightQuads(),this._computeHeightQuads());const W=this._getFacetAt(t,K),x=-(W.x*t+W.z*K+W.w)/W.y;return N.Pq.TransformCoordinatesFromFloatsToRef(0,x,0,D,G),G.y}getNormalAtCoordinates(t,K){const D=new N.Pq(0,1,0);return this.getNormalAtCoordinatesToRef(t,K,D),D}getNormalAtCoordinatesToRef(t,K,D){const a=this.getWorldMatrix(),G=N.AA.Matrix[5];a.invertToRef(G);const W=N.AA.Vector3[8];if(N.Pq.TransformCoordinatesFromFloatsToRef(t,0,K,G,W),t=W.x,K=W.z,t<this._minX||t>this._maxX||K<this._minZ||K>this._maxZ)return this;this._heightQuads&&0!=this._heightQuads.length||(this._initHeightQuads(),this._computeHeightQuads());const x=this._getFacetAt(t,K);return N.Pq.TransformNormalFromFloatsToRef(x.x,x.y,x.z,a,D),this}updateCoordinateHeights(){return this._heightQuads&&0!=this._heightQuads.length||this._initHeightQuads(),this._computeHeightQuads(),this}_getFacetAt(t,K){const D=Math.floor((t+this._maxX)*this._subdivisionsX/this._width),a=Math.floor(-(K+this._maxZ)*this._subdivisionsY/this._height+this._subdivisionsY),G=this._heightQuads[a*this._subdivisionsX+D];let N;return N=K<G.slope.x*t+G.slope.y?G.facet1:G.facet2,N}_initHeightQuads(){const t=this._subdivisionsX,K=this._subdivisionsY;this._heightQuads=new Array;for(let D=0;D<K;D++)for(let K=0;K<t;K++){const a={slope:N.I9.Zero(),facet1:new N.IU(0,0,0,0),facet2:new N.IU(0,0,0,0)};this._heightQuads[D*t+K]=a}return this}_computeHeightQuads(){const t=this.getVerticesData(R.R.PositionKind);if(!t)return this;const K=N.AA.Vector3[3],D=N.AA.Vector3[2],a=N.AA.Vector3[1],G=N.AA.Vector3[0],W=N.AA.Vector3[4],x=N.AA.Vector3[5],b=N.AA.Vector3[6],n=N.AA.Vector3[7],e=N.AA.Vector3[8];let i=0,z=0,I=0,Z=0,w=0,m=0,u=0;const d=this._subdivisionsX,E=this._subdivisionsY;for(let l=0;l<E;l++)for(let E=0;E<d;E++){i=3*E,z=l*(d+1)*3,I=(l+1)*(d+1)*3,K.x=t[z+i],K.y=t[z+i+1],K.z=t[z+i+2],D.x=t[z+i+3],D.y=t[z+i+4],D.z=t[z+i+5],a.x=t[I+i],a.y=t[I+i+1],a.z=t[I+i+2],G.x=t[I+i+3],G.y=t[I+i+4],G.z=t[I+i+5],Z=(G.z-K.z)/(G.x-K.x),w=K.z-Z*K.x,D.subtractToRef(K,W),a.subtractToRef(K,x),G.subtractToRef(K,b),N.Pq.CrossToRef(b,x,n),N.Pq.CrossToRef(W,b,e),n.normalize(),e.normalize(),m=-(n.x*K.x+n.y*K.y+n.z*K.z),u=-(e.x*D.x+e.y*D.y+e.z*D.z);const Q=this._heightQuads[l*d+E];Q.slope.copyFromFloats(Z,w),Q.facet1.copyFromFloats(n.x,n.y,n.z,m),Q.facet2.copyFromFloats(e.x,e.y,e.z,u)}return this}serialize(t){super.serialize(t),t.subdivisionsX=this._subdivisionsX,t.subdivisionsY=this._subdivisionsY,t.minX=this._minX,t.maxX=this._maxX,t.minZ=this._minZ,t.maxZ=this._maxZ,t.width=this._width,t.height=this._height}static Parse(t,K){const D=new ND(t.name,K);return D._subdivisionsX=t.subdivisionsX||1,D._subdivisionsY=t.subdivisionsY||1,D._minX=t.minX,D._maxX=t.maxX,D._minZ=t.minZ,D._maxZ=t.maxZ,D._width=t.width,D._height=t.height,D}}function WD(t){const K=[],D=[],a=[],G=[];let W,x;const b=t.width||1,n=t.height||1,e=0|(t.subdivisionsX||t.subdivisions||1),i=0|(t.subdivisionsY||t.subdivisions||1);for(W=0;W<=i;W++)for(x=0;x<=e;x++){const t=new N.Pq(x*b/e-b/2,0,(i-W)*n/i-n/2),K=new N.Pq(0,1,0);D.push(t.x,t.y,t.z),a.push(K.x,K.y,K.z),G.push(x/e,B.rX?W/i:1-W/i)}for(W=0;W<i;W++)for(x=0;x<e;x++)K.push(x+1+(W+1)*(e+1)),K.push(x+1+W*(e+1)),K.push(x+W*(e+1)),K.push(x+(W+1)*(e+1)),K.push(x+1+(W+1)*(e+1)),K.push(x+W*(e+1));const z=new A.P;return z.indices=K,z.positions=D,z.normals=a,z.uvs=G,z}function xD(t){const K=void 0!==t.xmin&&null!==t.xmin?t.xmin:-1,D=void 0!==t.zmin&&null!==t.zmin?t.zmin:-1,a=void 0!==t.xmax&&null!==t.xmax?t.xmax:1,G=void 0!==t.zmax&&null!==t.zmax?t.zmax:1,W=t.subdivisions||{w:1,h:1},x=t.precision||{w:1,h:1},b=[],n=[],e=[],i=[];let z,I,Z,w;W.h=W.h<1?1:W.h,W.w=W.w<1?1:W.w,x.w=x.w<1?1:x.w,x.h=x.h<1?1:x.h;const m=(a-K)/W.w,u=(G-D)/W.h;function d(t,K,D,a){const G=n.length/3,W=x.w+1;for(z=0;z<x.h;z++)for(I=0;I<x.w;I++){const t=[G+I+z*W,G+(I+1)+z*W,G+(I+1)+(z+1)*W,G+I+(z+1)*W];b.push(t[1]),b.push(t[2]),b.push(t[3]),b.push(t[0]),b.push(t[1]),b.push(t[3])}const Z=N.Pq.Zero(),w=new N.Pq(0,1,0);for(z=0;z<=x.h;z++)for(Z.z=z*(a-K)/x.h+K,I=0;I<=x.w;I++)Z.x=I*(D-t)/x.w+t,Z.y=0,n.push(Z.x,Z.y,Z.z),e.push(w.x,w.y,w.z),i.push(I/x.w,z/x.h)}for(Z=0;Z<W.h;Z++)for(w=0;w<W.w;w++)d(K+w*m,D+Z*u,K+(w+1)*m,D+(Z+1)*u);const E=new A.P;return E.indices=b,E.positions=n,E.normals=e,E.uvs=i,E}function bD(t){const K=[],D=[],a=[],G=[];let W,b;const n=t.colorFilter||new s.v9(.3,.59,.11),e=t.alphaFilter||0;let i=!1;if(t.minHeight>t.maxHeight){i=!0;const K=t.maxHeight;t.maxHeight=t.minHeight,t.minHeight=K}for(W=0;W<=t.subdivisions;W++)for(b=0;b<=t.subdivisions;b++){const K=new N.Pq(b*t.width/t.subdivisions-t.width/2,0,(t.subdivisions-W)*t.height/t.subdivisions-t.height/2),z=4*(((K.x+t.width/2)/t.width*(t.bufferWidth-1)|0)+((1-(K.z+t.height/2)/t.height)*(t.bufferHeight-1)|0)*t.bufferWidth);let I=t.buffer[z]/255,Z=t.buffer[z+1]/255,w=t.buffer[z+2]/255;const m=t.buffer[z+3]/255;i&&(I=1-I,Z=1-Z,w=1-w);const u=I*n.r+Z*n.g+w*n.b;K.y=m>=e?t.minHeight+(t.maxHeight-t.minHeight)*u:t.minHeight-x.bH,t.heightBuffer&&(t.heightBuffer[W*(t.subdivisions+1)+b]=K.y),D.push(K.x,K.y,K.z),a.push(0,0,0),G.push(b/t.subdivisions,1-W/t.subdivisions)}for(W=0;W<t.subdivisions;W++)for(b=0;b<t.subdivisions;b++){const a=b+1+(W+1)*(t.subdivisions+1),G=b+1+W*(t.subdivisions+1),N=b+W*(t.subdivisions+1),x=b+(W+1)*(t.subdivisions+1),n=D[3*a+1]>=t.minHeight,e=D[3*G+1]>=t.minHeight,i=D[3*N+1]>=t.minHeight;n&&e&&i&&(K.push(a),K.push(G),K.push(N)),D[3*x+1]>=t.minHeight&&n&&i&&(K.push(x),K.push(a),K.push(N))}A.P.ComputeNormals(D,K,a);const z=new A.P;return z.indices=K,z.positions=D,z.normals=a,z.uvs=G,z}function nD(t){const K=6;let D=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];const a=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0],G=[];let W=[];const x=t.width||t.size||1,b=t.height||t.size||1,n=t.depth||t.size||1,e=t.wrap||!1;let i=void 0===t.topBaseAt?1:t.topBaseAt,z=void 0===t.bottomBaseAt?0:t.bottomBaseAt;i=(i+4)%4,z=(z+4)%4;let I=[2,0,3,1][i],Z=[2,0,1,3][z],w=[1,-1,1,-1,-1,1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,-1,1,-1,-1,1,-1,1,1,1,1,-1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,-1,1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,1];if(e){D=[2,3,0,2,0,1,4,5,6,4,6,7,9,10,11,9,11,8,12,14,15,12,13,14],w=[-1,1,1,1,1,1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,1,1,1,-1,1,-1,-1,1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,-1,-1,-1];let t=[[1,1,1],[-1,1,1],[-1,1,-1],[1,1,-1]],K=[[-1,-1,1],[1,-1,1],[1,-1,-1],[-1,-1,-1]];const a=[17,18,19,16],G=[22,23,20,21];for(;I>0;)t.unshift(t.pop()),a.unshift(a.pop()),I--;for(;Z>0;)K.unshift(K.pop()),G.unshift(G.pop()),Z--;t=t.flat(),K=K.flat(),w=w.concat(t).concat(K),D.push(a[0],a[2],a[3],a[0],a[1],a[2]),D.push(G[0],G[2],G[3],G[0],G[1],G[2])}const m=[x/2,b/2,n/2];W=w.reduce(((t,K,D)=>t.concat(K*m[D%3])),[]);const u=0===t.sideOrientation?0:t.sideOrientation||A.P.DEFAULTSIDE,d=t.faceUV||new Array(6),E=t.faceColors,l=[];for(let t=0;t<6;t++)void 0===d[t]&&(d[t]=new N.IU(0,0,1,1)),E&&void 0===E[t]&&(E[t]=new s.ov(1,1,1,1));for(let t=0;t<K;t++)if(G.push(d[t].z,B.rX?1-d[t].w:d[t].w),G.push(d[t].x,B.rX?1-d[t].w:d[t].w),G.push(d[t].x,B.rX?1-d[t].y:d[t].y),G.push(d[t].z,B.rX?1-d[t].y:d[t].y),E)for(let K=0;K<4;K++)l.push(E[t].r,E[t].g,E[t].b,E[t].a);A.P._ComputeSides(u,W,D,a,G,t.frontUVs,t.backUVs);const Q=new A.P;if(Q.indices=D,Q.positions=W,Q.normals=a,Q.uvs=G,E){const t=u===A.P.DOUBLESIDE?l.concat(l):l;Q.colors=t}return Q}function eD(t){const K=t.pattern||Nt.NO_FLIP,D=t.tileWidth||t.tileSize||1,a=t.tileHeight||t.tileSize||1,G=t.alignHorizontal||0,N=t.alignVertical||0,W=t.width||t.size||1,x=Math.floor(W/D);let b=W-x*D;const n=t.height||t.size||1,e=Math.floor(n/a);let i=n-e*a;const z=D*x/2,I=a*e/2;let Z=0,w=0,m=0,u=0,d=0,E=0;if(b>0||i>0){switch(m=-z,u=-I,d=z,E=I,G){case Nt.CENTER:b/=2,m-=b,d+=b;break;case Nt.LEFT:d+=b,Z=-b/2;break;case Nt.RIGHT:m-=b,Z=b/2}switch(N){case Nt.CENTER:i/=2,u-=i,E+=i;break;case Nt.BOTTOM:E+=i,w=-i/2;break;case Nt.TOP:u-=i,w=i/2}}const l=[],Q=[],P=[];P[0]=[0,0,1,0,1,1,0,1],P[1]=[0,0,1,0,1,1,0,1],K!==Nt.ROTATE_TILE&&K!==Nt.ROTATE_ROW||(P[1]=[1,1,0,1,0,0,1,0]),K!==Nt.FLIP_TILE&&K!==Nt.FLIP_ROW||(P[1]=[1,0,0,0,0,1,1,1]),K!==Nt.FLIP_N_ROTATE_TILE&&K!==Nt.FLIP_N_ROTATE_ROW||(P[1]=[0,1,1,1,1,0,0,0]);let y=[];const q=[],X=[];let h=0;for(let t=0;t<e;t++)for(let G=0;G<x;G++)l.push(-z+G*D+Z,-I+t*a+w,0),l.push(-z+(G+1)*D+Z,-I+t*a+w,0),l.push(-z+(G+1)*D+Z,-I+(t+1)*a+w,0),l.push(-z+G*D+Z,-I+(t+1)*a+w,0),X.push(h,h+1,h+3,h+1,h+2,h+3),y=K===Nt.FLIP_TILE||K===Nt.ROTATE_TILE||K===Nt.FLIP_N_ROTATE_TILE?y.concat(P[(G%2+t%2)%2]):K===Nt.FLIP_ROW||K===Nt.ROTATE_ROW||K===Nt.FLIP_N_ROTATE_ROW?y.concat(P[t%2]):y.concat(P[0]),q.push(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),Q.push(0,0,-1,0,0,-1,0,0,-1,0,0,-1),h+=4;if(b>0||i>0){const t=i>0&&(N===Nt.CENTER||N===Nt.TOP),W=i>0&&(N===Nt.CENTER||N===Nt.BOTTOM),n=b>0&&(G===Nt.CENTER||G===Nt.RIGHT),P=b>0&&(G===Nt.CENTER||G===Nt.LEFT);let J,T,_,C,H=[];if(t&&n&&(l.push(m+Z,u+w,0),l.push(-z+Z,u+w,0),l.push(-z+Z,u+i+w,0),l.push(m+Z,u+i+w,0),X.push(h,h+1,h+3,h+1,h+2,h+3),h+=4,J=1-b/D,T=1-i/a,_=1,C=1,H=[J,T,_,T,_,C,J,C],K===Nt.ROTATE_ROW&&(H=[1-J,1-T,1-_,1-T,1-_,1-C,1-J,1-C]),K===Nt.FLIP_ROW&&(H=[1-J,T,1-_,T,1-_,C,1-J,C]),K===Nt.FLIP_N_ROTATE_ROW&&(H=[J,1-T,_,1-T,_,1-C,J,1-C]),y=y.concat(H),q.push(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),Q.push(0,0,-1,0,0,-1,0,0,-1,0,0,-1)),t&&P&&(l.push(z+Z,u+w,0),l.push(d+Z,u+w,0),l.push(d+Z,u+i+w,0),l.push(z+Z,u+i+w,0),X.push(h,h+1,h+3,h+1,h+2,h+3),h+=4,J=0,T=1-i/a,_=b/D,C=1,H=[J,T,_,T,_,C,J,C],(K===Nt.ROTATE_ROW||K===Nt.ROTATE_TILE&&x%2==0)&&(H=[1-J,1-T,1-_,1-T,1-_,1-C,1-J,1-C]),(K===Nt.FLIP_ROW||K===Nt.FLIP_TILE&&x%2==0)&&(H=[1-J,T,1-_,T,1-_,C,1-J,C]),(K===Nt.FLIP_N_ROTATE_ROW||K===Nt.FLIP_N_ROTATE_TILE&&x%2==0)&&(H=[J,1-T,_,1-T,_,1-C,J,1-C]),y=y.concat(H),q.push(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),Q.push(0,0,-1,0,0,-1,0,0,-1,0,0,-1)),W&&n&&(l.push(m+Z,I+w,0),l.push(-z+Z,I+w,0),l.push(-z+Z,E+w,0),l.push(m+Z,E+w,0),X.push(h,h+1,h+3,h+1,h+2,h+3),h+=4,J=1-b/D,T=0,_=1,C=i/a,H=[J,T,_,T,_,C,J,C],(K===Nt.ROTATE_ROW&&e%2==1||K===Nt.ROTATE_TILE&&e%1==0)&&(H=[1-J,1-T,1-_,1-T,1-_,1-C,1-J,1-C]),(K===Nt.FLIP_ROW&&e%2==1||K===Nt.FLIP_TILE&&e%2==0)&&(H=[1-J,T,1-_,T,1-_,C,1-J,C]),(K===Nt.FLIP_N_ROTATE_ROW&&e%2==1||K===Nt.FLIP_N_ROTATE_TILE&&e%2==0)&&(H=[J,1-T,_,1-T,_,1-C,J,1-C]),y=y.concat(H),q.push(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),Q.push(0,0,-1,0,0,-1,0,0,-1,0,0,-1)),W&&P&&(l.push(z+Z,I+w,0),l.push(d+Z,I+w,0),l.push(d+Z,E+w,0),l.push(z+Z,E+w,0),X.push(h,h+1,h+3,h+1,h+2,h+3),h+=4,J=0,T=0,_=b/D,C=i/a,H=[J,T,_,T,_,C,J,C],(K===Nt.ROTATE_ROW&&e%2==1||K===Nt.ROTATE_TILE&&(e+x)%2==1)&&(H=[1-J,1-T,1-_,1-T,1-_,1-C,1-J,1-C]),(K===Nt.FLIP_ROW&&e%2==1||K===Nt.FLIP_TILE&&(e+x)%2==1)&&(H=[1-J,T,1-_,T,1-_,C,1-J,C]),(K===Nt.FLIP_N_ROTATE_ROW&&e%2==1||K===Nt.FLIP_N_ROTATE_TILE&&(e+x)%2==1)&&(H=[J,1-T,_,1-T,_,1-C,J,1-C]),y=y.concat(H),q.push(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),Q.push(0,0,-1,0,0,-1,0,0,-1,0,0,-1)),t){const t=[];J=0,T=1-i/a,_=1,C=1,t[0]=[J,T,_,T,_,C,J,C],t[1]=[J,T,_,T,_,C,J,C],K!==Nt.ROTATE_TILE&&K!==Nt.ROTATE_ROW||(t[1]=[1-J,1-T,1-_,1-T,1-_,1-C,1-J,1-C]),K!==Nt.FLIP_TILE&&K!==Nt.FLIP_ROW||(t[1]=[1-J,T,1-_,T,1-_,C,1-J,C]),K!==Nt.FLIP_N_ROTATE_TILE&&K!==Nt.FLIP_N_ROTATE_ROW||(t[1]=[J,1-T,_,1-T,_,1-C,J,1-C]);for(let a=0;a<x;a++)l.push(-z+a*D+Z,u+w,0),l.push(-z+(a+1)*D+Z,u+w,0),l.push(-z+(a+1)*D+Z,u+i+w,0),l.push(-z+a*D+Z,u+i+w,0),X.push(h,h+1,h+3,h+1,h+2,h+3),h+=4,y=K===Nt.FLIP_TILE||K===Nt.ROTATE_TILE||K===Nt.FLIP_N_ROTATE_TILE?y.concat(t[(a+1)%2]):K===Nt.FLIP_ROW||K===Nt.ROTATE_ROW||K===Nt.FLIP_N_ROTATE_ROW?y.concat(t[1]):y.concat(t[0]),q.push(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),Q.push(0,0,-1,0,0,-1,0,0,-1,0,0,-1)}if(W){const t=[];J=0,T=0,_=1,C=i/a,t[0]=[J,T,_,T,_,C,J,C],t[1]=[J,T,_,T,_,C,J,C],K!==Nt.ROTATE_TILE&&K!==Nt.ROTATE_ROW||(t[1]=[1-J,1-T,1-_,1-T,1-_,1-C,1-J,1-C]),K!==Nt.FLIP_TILE&&K!==Nt.FLIP_ROW||(t[1]=[1-J,T,1-_,T,1-_,C,1-J,C]),K!==Nt.FLIP_N_ROTATE_TILE&&K!==Nt.FLIP_N_ROTATE_ROW||(t[1]=[J,1-T,_,1-T,_,1-C,J,1-C]);for(let a=0;a<x;a++)l.push(-z+a*D+Z,E-i+w,0),l.push(-z+(a+1)*D+Z,E-i+w,0),l.push(-z+(a+1)*D+Z,E+w,0),l.push(-z+a*D+Z,E+w,0),X.push(h,h+1,h+3,h+1,h+2,h+3),h+=4,y=K===Nt.FLIP_TILE||K===Nt.ROTATE_TILE||K===Nt.FLIP_N_ROTATE_TILE?y.concat(t[(a+e)%2]):K===Nt.FLIP_ROW||K===Nt.ROTATE_ROW||K===Nt.FLIP_N_ROTATE_ROW?y.concat(t[e%2]):y.concat(t[0]),q.push(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),Q.push(0,0,-1,0,0,-1,0,0,-1,0,0,-1)}if(n){const t=[];J=1-b/D,T=0,_=1,C=1,t[0]=[J,T,_,T,_,C,J,C],t[1]=[J,T,_,T,_,C,J,C],K!==Nt.ROTATE_TILE&&K!==Nt.ROTATE_ROW||(t[1]=[1-J,1-T,1-_,1-T,1-_,1-C,1-J,1-C]),K!==Nt.FLIP_TILE&&K!==Nt.FLIP_ROW||(t[1]=[1-J,T,1-_,T,1-_,C,1-J,C]),K!==Nt.FLIP_N_ROTATE_TILE&&K!==Nt.FLIP_N_ROTATE_ROW||(t[1]=[J,1-T,_,1-T,_,1-C,J,1-C]);for(let D=0;D<e;D++)l.push(m+Z,-I+D*a+w,0),l.push(m+b+Z,-I+D*a+w,0),l.push(m+b+Z,-I+(D+1)*a+w,0),l.push(m+Z,-I+(D+1)*a+w,0),X.push(h,h+1,h+3,h+1,h+2,h+3),h+=4,y=K===Nt.FLIP_TILE||K===Nt.ROTATE_TILE||K===Nt.FLIP_N_ROTATE_TILE?y.concat(t[(D+1)%2]):K===Nt.FLIP_ROW||K===Nt.ROTATE_ROW||K===Nt.FLIP_N_ROTATE_ROW?y.concat(t[D%2]):y.concat(t[0]),q.push(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),Q.push(0,0,-1,0,0,-1,0,0,-1,0,0,-1)}if(P){const t=[];J=0,T=0,_=b/a,C=1,t[0]=[J,T,_,T,_,C,J,C],t[1]=[J,T,_,T,_,C,J,C],K!==Nt.ROTATE_TILE&&K!==Nt.ROTATE_ROW||(t[1]=[1-J,1-T,1-_,1-T,1-_,1-C,1-J,1-C]),K!==Nt.FLIP_TILE&&K!==Nt.FLIP_ROW||(t[1]=[1-J,T,1-_,T,1-_,C,1-J,C]),K!==Nt.FLIP_N_ROTATE_TILE&&K!==Nt.FLIP_N_ROTATE_ROW||(t[1]=[J,1-T,_,1-T,_,1-C,J,1-C]);for(let D=0;D<e;D++)l.push(d-b+Z,-I+D*a+w,0),l.push(d+Z,-I+D*a+w,0),l.push(d+Z,-I+(D+1)*a+w,0),l.push(d-b+Z,-I+(D+1)*a+w,0),X.push(h,h+1,h+3,h+1,h+2,h+3),h+=4,y=K===Nt.FLIP_TILE||K===Nt.ROTATE_TILE||K===Nt.FLIP_N_ROTATE_TILE?y.concat(t[(D+x)%2]):K===Nt.FLIP_ROW||K===Nt.ROTATE_ROW||K===Nt.FLIP_N_ROTATE_ROW?y.concat(t[D%2]):y.concat(t[0]),q.push(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),Q.push(0,0,-1,0,0,-1,0,0,-1,0,0,-1)}}const J=0===t.sideOrientation?0:t.sideOrientation||A.P.DEFAULTSIDE;A.P._ComputeSides(J,l,X,Q,y,t.frontUVs,t.backUVs);const T=new A.P;T.indices=X,T.positions=l,T.normals=Q,T.uvs=y;const _=J===A.P.DOUBLESIDE?q.concat(q):q;return T.colors=_,T}function iD(t){const K=[],D=[],a=[],G=[],N=t.radius||.5,W=t.tessellation||64,x=t.arc&&(t.arc<=0||t.arc>1)?1:t.arc||1,b=0===t.sideOrientation?0:t.sideOrientation||A.P.DEFAULTSIDE;K.push(0,0,0),G.push(.5,.5);const n=2*Math.PI*x,e=1===x?n/W:n/(W-1);let i=0;for(let t=0;t<W;t++){const t=Math.cos(i),D=Math.sin(i),a=(t+1)/2,W=(1-D)/2;K.push(N*t,N*D,0),G.push(a,B.rX?1-W:W),i+=e}1===x&&(K.push(K[3],K[4],K[5]),G.push(G[2],B.rX?1-G[3]:G[3]));const z=K.length/3;for(let t=1;t<z-1;t++)D.push(t+1,0,t);A.P.ComputeNormals(K,D,a),A.P._ComputeSides(b,K,D,a,G,t.frontUVs,t.backUVs);const I=new A.P;return I.indices=D,I.positions=K,I.normals=a,I.uvs=G,I}function zD(t,K={},D=null){const a=new Nt(t,D);return K.sideOrientation=Nt._GetDefaultSideOrientation(K.sideOrientation),a._originalBuilderSideOrientation=K.sideOrientation,iD(K).applyToMesh(a,K.updatable),a}function ID(t){const K=0|(t.segments||32),D=t.diameterX||t.diameter||1,a=t.diameterY||t.diameter||1,G=t.diameterZ||t.diameter||1,W=t.arc&&(t.arc<=0||t.arc>1)?1:t.arc||1,x=t.slice&&t.slice<=0?1:t.slice||1,b=0===t.sideOrientation?0:t.sideOrientation||A.P.DEFAULTSIDE,n=!!t.dedupTopBottomIndices,e=new N.Pq(D/2,a/2,G/2),i=2+K,z=2*i,I=[],Z=[],w=[],m=[];for(let t=0;t<=i;t++){const K=t/i,D=K*Math.PI*x;for(let t=0;t<=z;t++){const a=t/z,G=a*Math.PI*2*W,x=N.uq.RotationZ(-D),b=N.uq.RotationY(G),n=N.Pq.TransformCoordinates(N.Pq.Up(),x),i=N.Pq.TransformCoordinates(n,b),I=i.multiply(e),u=i.divide(e).normalize();Z.push(I.x,I.y,I.z),w.push(u.x,u.y,u.z),m.push(a,B.rX?1-K:K)}if(t>0){const K=Z.length/3;for(let D=K-2*(z+1);D+z+2<K;D++)n?(t>1&&(I.push(D),I.push(D+1),I.push(D+z+1)),(t<i||x<1)&&(I.push(D+z+1),I.push(D+1),I.push(D+z+2))):(I.push(D),I.push(D+1),I.push(D+z+1),I.push(D+z+1),I.push(D+1),I.push(D+z+2))}}A.P._ComputeSides(b,Z,I,w,m,t.frontUVs,t.backUVs);const u=new A.P;return u.indices=I,u.positions=Z,u.normals=w,u.uvs=m,u}function ZD(t,K={},D=null){const a=new Nt(t,D);return K.sideOrientation=Nt._GetDefaultSideOrientation(K.sideOrientation),a._originalBuilderSideOrientation=K.sideOrientation,ID(K).applyToMesh(a,K.updatable),a}function wD(t){const K=t.height||2;let D=0===t.diameterTop?0:t.diameterTop||t.diameter||1,a=0===t.diameterBottom?0:t.diameterBottom||t.diameter||1;D=D||1e-5,a=a||1e-5;const G=0|(t.tessellation||24),W=0|(t.subdivisions||1),x=!!t.hasRings,n=!!t.enclose,e=0===t.cap?0:t.cap||Nt.CAP_ALL,i=t.arc&&(t.arc<=0||t.arc>1)?1:t.arc||1,z=0===t.sideOrientation?0:t.sideOrientation||A.P.DEFAULTSIDE,I=t.faceUV||new Array(3),Z=t.faceColors,w=2+(1+(1!==i&&n?2:0))*(x?W:1);let m;for(m=0;m<w;m++)Z&&void 0===Z[m]&&(Z[m]=new s.ov(1,1,1,1));for(m=0;m<w;m++)I&&void 0===I[m]&&(I[m]=new N.IU(0,0,1,1));const u=[],d=[],E=[],l=[],Q=[],P=2*Math.PI*i/G;let y,q,X;const h=(a-D)/2/K,J=N.Pq.Zero(),T=N.Pq.Zero(),_=N.Pq.Zero(),C=N.Pq.Zero(),H=N.Pq.Zero(),o=b._0.Y;let U,V,F,c=1,g=1,R=0,Y=0;for(U=0;U<=W;U++)for(q=U/W,X=(q*(D-a)+a)/2,c=x&&0!==U&&U!==W?2:1,F=0;F<c;F++){for(x&&(g+=F),n&&(g+=2*F),V=0;V<=G;V++)y=V*P,J.x=Math.cos(-y)*X,J.y=-K/2+q*K,J.z=Math.sin(-y)*X,0===D&&U===W?(T.x=E[E.length-3*(G+1)],T.y=E[E.length-3*(G+1)+1],T.z=E[E.length-3*(G+1)+2]):(T.x=J.x,T.z=J.z,T.y=Math.sqrt(T.x*T.x+T.z*T.z)*h,T.normalize()),0===V&&(_.copyFrom(J),C.copyFrom(T)),d.push(J.x,J.y,J.z),E.push(T.x,T.y,T.z),Y=x?R!==g?I[g].y:I[g].w:I[g].y+(I[g].w-I[g].y)*q,l.push(I[g].x+(I[g].z-I[g].x)*V/G,B.rX?1-Y:Y),Z&&Q.push(Z[g].r,Z[g].g,Z[g].b,Z[g].a);1!==i&&n&&(d.push(J.x,J.y,J.z),d.push(0,J.y,0),d.push(0,J.y,0),d.push(_.x,_.y,_.z),N.Pq.CrossToRef(o,T,H),H.normalize(),E.push(H.x,H.y,H.z,H.x,H.y,H.z),N.Pq.CrossToRef(C,o,H),H.normalize(),E.push(H.x,H.y,H.z,H.x,H.y,H.z),Y=x?R!==g?I[g+1].y:I[g+1].w:I[g+1].y+(I[g+1].w-I[g+1].y)*q,l.push(I[g+1].x,B.rX?1-Y:Y),l.push(I[g+1].z,B.rX?1-Y:Y),Y=x?R!==g?I[g+2].y:I[g+2].w:I[g+2].y+(I[g+2].w-I[g+2].y)*q,l.push(I[g+2].x,B.rX?1-Y:Y),l.push(I[g+2].z,B.rX?1-Y:Y),Z&&(Q.push(Z[g+1].r,Z[g+1].g,Z[g+1].b,Z[g+1].a),Q.push(Z[g+1].r,Z[g+1].g,Z[g+1].b,Z[g+1].a),Q.push(Z[g+2].r,Z[g+2].g,Z[g+2].b,Z[g+2].a),Q.push(Z[g+2].r,Z[g+2].g,Z[g+2].b,Z[g+2].a))),R!==g&&(R=g)}const L=1!==i&&n?G+4:G;for(U=0,g=0;g<W;g++){let t=0,K=0,D=0,a=0;for(V=0;V<G;V++)t=U*(L+1)+V,K=(U+1)*(L+1)+V,D=U*(L+1)+(V+1),a=(U+1)*(L+1)+(V+1),u.push(t,K,D),u.push(a,D,K);1!==i&&n&&(u.push(t+2,K+2,D+2),u.push(a+2,D+2,K+2),u.push(t+4,K+4,D+4),u.push(a+4,D+4,K+4)),U=x?U+2:U+1}const S=t=>{const W=t?D/2:a/2;if(0===W)return;let x,b,n;const e=t?I[w-1]:I[0];let z=null;Z&&(z=t?Z[w-1]:Z[0]);const m=d.length/3,P=t?K/2:-K/2,y=new N.Pq(0,P,0);d.push(y.x,y.y,y.z),E.push(0,t?1:-1,0);const q=e.y+.5*(e.w-e.y);l.push(e.x+.5*(e.z-e.x),B.rX?1-q:q),z&&Q.push(z.r,z.g,z.b,z.a);const X=new N.I9(.5,.5);for(n=0;n<=G;n++){x=2*Math.PI*n*i/G;const K=Math.cos(-x),D=Math.sin(-x);b=new N.Pq(K*W,P,D*W);const a=new N.I9(K*X.x+.5,D*X.y+.5);d.push(b.x,b.y,b.z),E.push(0,t?1:-1,0);const I=e.y+(e.w-e.y)*a.y;l.push(e.x+(e.z-e.x)*a.x,B.rX?1-I:I),z&&Q.push(z.r,z.g,z.b,z.a)}for(n=0;n<G;n++)t?(u.push(m),u.push(m+(n+2)),u.push(m+(n+1))):(u.push(m),u.push(m+(n+1)),u.push(m+(n+2)))};e!==Nt.CAP_START&&e!==Nt.CAP_ALL||S(!1),e!==Nt.CAP_END&&e!==Nt.CAP_ALL||S(!0),A.P._ComputeSides(z,d,u,E,l,t.frontUVs,t.backUVs);const f=new A.P;return f.indices=u,f.positions=d,f.normals=E,f.uvs=l,Z&&(f.colors=Q),f}function mD(t){const K=[],D=[],a=[],G=[],W=t.diameter||1,x=t.thickness||.5,b=0|(t.tessellation||16),n=0===t.sideOrientation?0:t.sideOrientation||A.P.DEFAULTSIDE,e=b+1;for(let t=0;t<=b;t++){const n=t/b,i=t*Math.PI*2/b-Math.PI/2,z=N.uq.Translation(W/2,0,0).multiply(N.uq.RotationY(i));for(let W=0;W<=b;W++){const i=1-W/b,I=W*Math.PI*2/b+Math.PI,Z=Math.cos(I),w=Math.sin(I);let m=new N.Pq(Z,w,0),u=m.scale(x/2);const d=new N.I9(n,i);u=N.Pq.TransformCoordinates(u,z),m=N.Pq.TransformNormal(m,z),D.push(u.x,u.y,u.z),a.push(m.x,m.y,m.z),G.push(d.x,B.rX?1-d.y:d.y);const E=(t+1)%e,l=(W+1)%e;K.push(t*e+W),K.push(t*e+l),K.push(E*e+W),K.push(t*e+l),K.push(E*e+l),K.push(E*e+W)}}A.P._ComputeSides(n,D,K,a,G,t.frontUVs,t.backUVs);const i=new A.P;return i.indices=K,i.positions=D,i.normals=a,i.uvs=G,i}function uD(t){const K=[],D=[],a=[],G=[],W=t.radius||2,x=t.tube||.5,b=t.radialSegments||32,n=t.tubularSegments||32,e=t.p||2,i=t.q||3,z=0===t.sideOrientation?0:t.sideOrientation||A.P.DEFAULTSIDE,I=t=>{const K=Math.cos(t),D=Math.sin(t),a=i/e*t,G=Math.cos(a),x=W*(2+G)*.5*K,b=W*(2+G)*D*.5,n=W*Math.sin(a)*.5;return new N.Pq(x,b,n)};let Z,w;for(Z=0;Z<=b;Z++){const t=Z%b/b*2*e*Math.PI,K=I(t),a=I(t+.01),W=a.subtract(K);let i=a.add(K);const z=N.Pq.Cross(W,i);for(i=N.Pq.Cross(z,W),z.normalize(),i.normalize(),w=0;w<n;w++){const t=w%n/n*2*Math.PI,a=-x*Math.cos(t),N=x*Math.sin(t);D.push(K.x+a*i.x+N*z.x),D.push(K.y+a*i.y+N*z.y),D.push(K.z+a*i.z+N*z.z),G.push(Z/b),G.push(B.rX?1-w/n:w/n)}}for(Z=0;Z<b;Z++)for(w=0;w<n;w++){const t=(w+1)%n,D=Z*n+w,a=(Z+1)*n+w,G=(Z+1)*n+t,N=Z*n+t;K.push(N),K.push(a),K.push(D),K.push(N),K.push(G),K.push(a)}A.P.ComputeNormals(D,K,a),A.P._ComputeSides(z,D,K,a,G,t.frontUVs,t.backUVs);const m=new A.P;return m.indices=K,m.positions=D,m.normals=a,m.uvs=G,m}A.P.CreateGround=WD,A.P.CreateTiledGround=xD,A.P.CreateGroundFromHeightMap=bD,Nt.CreateGround=(t,K,D,a,G,N)=>function(t,K={},D){const a=new ND(t,D);return a._setReady(!1),a._subdivisionsX=K.subdivisionsX||K.subdivisions||1,a._subdivisionsY=K.subdivisionsY||K.subdivisions||1,a._width=K.width||1,a._height=K.height||1,a._maxX=a._width/2,a._maxZ=a._height/2,a._minX=-a._maxX,a._minZ=-a._maxZ,WD(K).applyToMesh(a,K.updatable),a._setReady(!0),a}(t,{width:K,height:D,subdivisions:a,updatable:N},G),Nt.CreateTiledGround=(t,K,D,a,G,N,W,x,b)=>function(t,K,D=null){const a=new Nt(t,D);return xD(K).applyToMesh(a,K.updatable),a}(t,{xmin:K,zmin:D,xmax:a,zmax:G,subdivisions:N,precision:W,updatable:b},x),Nt.CreateGroundFromHeightMap=(t,K,D,a,G,N,W,x,b,n,e)=>function(t,K,D={},a=null){const G=D.width||10,N=D.height||10,W=D.subdivisions||1|0,x=D.minHeight||0,b=D.maxHeight||1,n=D.colorFilter||new s.v9(.3,.59,.11),e=D.alphaFilter||0,i=D.updatable,z=D.onReady;a=a||$.q.LastCreatedScene;const I=new ND(t,a);let Z;I._subdivisionsX=W,I._subdivisionsY=W,I._width=G,I._height=N,I._maxX=I._width/2,I._maxZ=I._height/2,I._minX=-I._maxX,I._minZ=-I._maxZ,I._setReady(!1),D.passHeightBufferInCallback&&(Z=new Float32Array((W+1)*(W+1)));const w=(t,K,D)=>{bD({width:G,height:N,subdivisions:W,minHeight:x,maxHeight:b,colorFilter:n,buffer:t,bufferWidth:K,bufferHeight:D,alphaFilter:e,heightBuffer:Z}).applyToMesh(I,i),z&&z(I,Z),I._setReady(!0)};if("string"==typeof K){const t=t=>{const K=t.width,D=t.height;if(a.isDisposed)return;const G=null==a?void 0:a.getEngine().resizeImageBitmap(t,K,D);w(G,K,D)};m.S0.LoadImage(K,t,D.onError?D.onError:()=>{},a.offlineProvider)}else w(K.data,K.width,K.height);return I}(t,K,{width:D,height:a,subdivisions:G,minHeight:N,maxHeight:W,updatable:b,onReady:n,alphaFilter:e},x),A.P.CreateBox=nD,Nt.CreateBox=(t,K,D=null,a,G)=>function(t,K={},D=null){const a=new Nt(t,D);return K.sideOrientation=Nt._GetDefaultSideOrientation(K.sideOrientation),a._originalBuilderSideOrientation=K.sideOrientation,nD(K).applyToMesh(a,K.updatable),a}(t,{size:K,sideOrientation:G,updatable:a},D),A.P.CreateTiledPlane=eD,A.P.CreateTiledBox=function(t){const K=6,D=t.faceUV||new Array(6),a=t.faceColors,G=t.pattern||Nt.NO_FLIP,W=t.width||t.size||1,x=t.height||t.size||1,b=t.depth||t.size||1,n=t.tileWidth||t.tileSize||1,e=t.tileHeight||t.tileSize||1,i=t.alignHorizontal||0,z=t.alignVertical||0,I=0===t.sideOrientation?0:t.sideOrientation||A.P.DEFAULTSIDE;for(let t=0;t<K;t++)void 0===D[t]&&(D[t]=new N.IU(0,0,1,1)),a&&void 0===a[t]&&(a[t]=new s.ov(1,1,1,1));const Z=W/2,w=x/2,m=b/2,u=[];for(let t=0;t<2;t++)u[t]=eD({pattern:G,tileWidth:n,tileHeight:e,width:W,height:x,alignVertical:z,alignHorizontal:i,sideOrientation:I});for(let t=2;t<4;t++)u[t]=eD({pattern:G,tileWidth:n,tileHeight:e,width:b,height:x,alignVertical:z,alignHorizontal:i,sideOrientation:I});let d=z;z===Nt.BOTTOM?d=Nt.TOP:z===Nt.TOP&&(d=Nt.BOTTOM);for(let t=4;t<6;t++)u[t]=eD({pattern:G,tileWidth:n,tileHeight:e,width:W,height:b,alignVertical:d,alignHorizontal:i,sideOrientation:I});let E=[],l=[],Q=[],P=[];const y=[],q=[],X=[],h=[];let J=0,T=0;for(let t=0;t<K;t++){const K=u[t].positions.length;q[t]=[],X[t]=[];for(let D=0;D<K/3;D++)q[t].push(new N.Pq(u[t].positions[3*D],u[t].positions[3*D+1],u[t].positions[3*D+2])),X[t].push(new N.Pq(u[t].normals[3*D],u[t].normals[3*D+1],u[t].normals[3*D+2]));J=u[t].uvs.length,h[t]=[];for(let K=0;K<J;K+=2)h[t][K]=D[t].x+(D[t].z-D[t].x)*u[t].uvs[K],h[t][K+1]=D[t].y+(D[t].w-D[t].y)*u[t].uvs[K+1],B.rX&&(h[t][K+1]=1-h[t][K+1]);if(Q=Q.concat(h[t]),P=P.concat(u[t].indices.map((t=>t+T))),T+=q[t].length,a)for(let K=0;K<4;K++)y.push(a[t].r,a[t].g,a[t].b,a[t].a)}const _=new N.Pq(0,0,m),C=N.uq.RotationY(Math.PI);E=q[0].map((t=>N.Pq.TransformNormal(t,C).add(_))).map((t=>[t.x,t.y,t.z])).reduce(((t,K)=>t.concat(K)),[]),l=X[0].map((t=>N.Pq.TransformNormal(t,C))).map((t=>[t.x,t.y,t.z])).reduce(((t,K)=>t.concat(K)),[]),E=E.concat(q[1].map((t=>t.subtract(_))).map((t=>[t.x,t.y,t.z])).reduce(((t,K)=>t.concat(K)),[])),l=l.concat(X[1].map((t=>[t.x,t.y,t.z])).reduce(((t,K)=>t.concat(K)),[]));const H=new N.Pq(Z,0,0),o=N.uq.RotationY(-Math.PI/2);E=E.concat(q[2].map((t=>N.Pq.TransformNormal(t,o).add(H))).map((t=>[t.x,t.y,t.z])).reduce(((t,K)=>t.concat(K)),[])),l=l.concat(X[2].map((t=>N.Pq.TransformNormal(t,o))).map((t=>[t.x,t.y,t.z])).reduce(((t,K)=>t.concat(K)),[]));const U=N.uq.RotationY(Math.PI/2);E=E.concat(q[3].map((t=>N.Pq.TransformNormal(t,U).subtract(H))).map((t=>[t.x,t.y,t.z])).reduce(((t,K)=>t.concat(K)),[])),l=l.concat(X[3].map((t=>N.Pq.TransformNormal(t,U))).map((t=>[t.x,t.y,t.z])).reduce(((t,K)=>t.concat(K)),[]));const V=new N.Pq(0,w,0),F=N.uq.RotationX(Math.PI/2);E=E.concat(q[4].map((t=>N.Pq.TransformNormal(t,F).add(V))).map((t=>[t.x,t.y,t.z])).reduce(((t,K)=>t.concat(K)),[])),l=l.concat(X[4].map((t=>N.Pq.TransformNormal(t,F))).map((t=>[t.x,t.y,t.z])).reduce(((t,K)=>t.concat(K)),[]));const c=N.uq.RotationX(-Math.PI/2);E=E.concat(q[5].map((t=>N.Pq.TransformNormal(t,c).subtract(V))).map((t=>[t.x,t.y,t.z])).reduce(((t,K)=>t.concat(K)),[])),l=l.concat(X[5].map((t=>N.Pq.TransformNormal(t,c))).map((t=>[t.x,t.y,t.z])).reduce(((t,K)=>t.concat(K)),[])),A.P._ComputeSides(I,E,P,l,Q);const g=new A.P;if(g.indices=P,g.positions=E,g.normals=l,g.uvs=Q,a){const t=I===A.P.DOUBLESIDE?y.concat(y):y;g.colors=t}return g},A.P.CreateDisc=iD,Nt.CreateDisc=(t,K,D,a=null,G,N)=>zD(t,{radius:K,tessellation:D,sideOrientation:N,updatable:G},a),A.P.CreateSphere=ID,Nt.CreateSphere=(t,K,D,a,G,N)=>ZD(t,{segments:K,diameterX:D,diameterY:D,diameterZ:D,sideOrientation:N,updatable:G},a),Nt.CreateHemisphere=(t,K,D,a)=>function(t,K={},D){K.diameter||(K.diameter=1),K.segments||(K.segments=16);const a=ZD("",{slice:.5,diameter:K.diameter,segments:K.segments},D),G=zD("",{radius:K.diameter/2,tessellation:3*K.segments+(4-K.segments)},D);G.rotation.x=-Math.PI/2,G.parent=a;const N=Nt.MergeMeshes([G,a],!0);return N.name=t,N}(t,{segments:K,diameter:D},a),A.P.CreateCylinder=wD,Nt.CreateCylinder=(t,K,D,a,G,N,W,x,b)=>(void 0!==W&&W instanceof QK.Z||(void 0!==W&&(b=x||Nt.DEFAULTSIDE,x=W),W=N,N=1),function(t,K={},D){const a=new Nt(t,D);return K.sideOrientation=Nt._GetDefaultSideOrientation(K.sideOrientation),a._originalBuilderSideOrientation=K.sideOrientation,wD(K).applyToMesh(a,K.updatable),a}(t,{height:K,diameterTop:D,diameterBottom:a,tessellation:G,subdivisions:N,sideOrientation:b,updatable:x},W)),A.P.CreateTorus=mD,Nt.CreateTorus=(t,K,D,a,G,N,W)=>function(t,K={},D){const a=new Nt(t,D);return K.sideOrientation=Nt._GetDefaultSideOrientation(K.sideOrientation),a._originalBuilderSideOrientation=K.sideOrientation,mD(K).applyToMesh(a,K.updatable),a}(t,{diameter:K,thickness:D,tessellation:a,sideOrientation:W,updatable:N},G),A.P.CreateTorusKnot=uD,Nt.CreateTorusKnot=(t,K,D,a,G,N,W,x,b,n)=>function(t,K={},D){const a=new Nt(t,D);return K.sideOrientation=Nt._GetDefaultSideOrientation(K.sideOrientation),a._originalBuilderSideOrientation=K.sideOrientation,uD(K).applyToMesh(a,K.updatable),a}(t,{radius:K,tube:D,radialSegments:a,tubularSegments:G,p:N,q:W,sideOrientation:n,updatable:b},x);class dD extends N.I9{constructor(t,K){super(t.x,t.y),this.index=K}}class ED{constructor(){this.elements=[]}add(t){const K=[];return t.forEach((t=>{const D=new dD(t,this.elements.length);K.push(D),this.elements.push(D)})),K}computeBounds(){const t=new N.I9(this.elements[0].x,this.elements[0].y),K=new N.I9(this.elements[0].x,this.elements[0].y);return this.elements.forEach((D=>{D.x<t.x?t.x=D.x:D.x>K.x&&(K.x=D.x),D.y<t.y?t.y=D.y:D.y>K.y&&(K.y=D.y)})),{min:t,max:K,width:K.x-t.x,height:K.y-t.y}}}class lD{_addToepoint(t){for(const K of t)this._epoints.push(K.x,K.y)}constructor(t,K,D,a=earcut){let G;this._points=new ED,this._outlinepoints=new ED,this._holes=new Array,this._epoints=new Array,this._eholes=new Array,this.bjsEarcut=a,this._name=t,this._scene=D||$.q.LastCreatedScene,G=K instanceof dK.Cu?K.getPoints():K,this._addToepoint(G),this._points.add(G),this._outlinepoints.add(G),void 0===this.bjsEarcut&&i.V.Warn("Earcut was not found, the polygon will not be built.")}addHole(t){this._points.add(t);const K=new ED;return K.add(t),this._holes.push(K),this._eholes.push(this._epoints.length/2),this._addToepoint(t),this}build(t=!1,K=0,D=2){const a=new Nt(this._name,this._scene),G=this.buildVertexData(K,D);return a.setVerticesData(R.R.PositionKind,G.positions,t),a.setVerticesData(R.R.NormalKind,G.normals,t),a.setVerticesData(R.R.UVKind,G.uvs,t),a.setIndices(G.indices),a}buildVertexData(t=0,K=2){const D=new A.P,a=[],G=[],N=[],W=this._points.computeBounds();this._points.elements.forEach((t=>{a.push(0,1,0),G.push(t.x,0,t.y),N.push((t.x-W.min.x)/W.width,(t.y-W.min.y)/W.height)}));const x=[],b=this.bjsEarcut(this._epoints,this._eholes,2);for(let t=0;t<b.length;t++)x.push(b[t]);if(t>0){const D=G.length/3;this._points.elements.forEach((K=>{a.push(0,-1,0),G.push(K.x,-t,K.y),N.push(1-(K.x-W.min.x)/W.width,1-(K.y-W.min.y)/W.height)}));const b=x.length;for(let t=0;t<b;t+=3){const K=x[t+0],a=x[t+1],G=x[t+2];x.push(G+D),x.push(a+D),x.push(K+D)}this._addSide(G,a,N,x,W,this._outlinepoints,t,!1,K),this._holes.forEach((D=>{this._addSide(G,a,N,x,W,D,t,!0,K)}))}return D.indices=x,D.positions=G,D.normals=a,D.uvs=N,D}_addSide(t,K,D,a,G,W,b,n,e){let i=t.length/3,z=0;for(let I=0;I<W.elements.length;I++){const Z=W.elements[I],w=W.elements[(I+1)%W.elements.length];t.push(Z.x,0,Z.y),t.push(Z.x,-b,Z.y),t.push(w.x,0,w.y),t.push(w.x,-b,w.y);const m=W.elements[(I+W.elements.length-1)%W.elements.length],u=W.elements[(I+2)%W.elements.length];let d=new N.Pq(-(w.y-Z.y),0,w.x-Z.x),E=new N.Pq(-(Z.y-m.y),0,Z.x-m.x),l=new N.Pq(-(u.y-w.y),0,u.x-w.x);n||(d=d.scale(-1),E=E.scale(-1),l=l.scale(-1));const Q=d.normalizeToNew();let P=E.normalizeToNew(),y=l.normalizeToNew();const q=N.Pq.Dot(P,Q);P=q>e?q<x.bH-1?new N.Pq(Z.x,0,Z.y).subtract(new N.Pq(w.x,0,w.y)).normalize():E.add(d).normalize():Q;const X=N.Pq.Dot(l,d);y=X>e?X<x.bH-1?new N.Pq(w.x,0,w.y).subtract(new N.Pq(Z.x,0,Z.y)).normalize():l.add(d).normalize():Q,D.push(z/G.width,0),D.push(z/G.width,1),z+=d.length(),D.push(z/G.width,0),D.push(z/G.width,1),K.push(P.x,P.y,P.z),K.push(P.x,P.y,P.z),K.push(y.x,y.y,y.z),K.push(y.x,y.y,y.z),n?(a.push(i),a.push(i+2),a.push(i+1),a.push(i+1),a.push(i+2),a.push(i+3)):(a.push(i),a.push(i+1),a.push(i+2),a.push(i+1),a.push(i+3),a.push(i+2)),i+=4}}}function QD(t,K,D,a,G,W,x){const b=D||new Array(3),n=a,e=[],i=x||!1;for(let t=0;t<3;t++)void 0===b[t]&&(b[t]=new N.IU(0,0,1,1)),n&&void 0===n[t]&&(n[t]=new s.ov(1,1,1,1));const z=t.getVerticesData(R.R.PositionKind),I=t.getVerticesData(R.R.NormalKind),Z=t.getVerticesData(R.R.UVKind),w=t.getIndices(),m=z.length/9;let u=0,d=0,E=0,l=0,Q=0;const P=[0];if(i)for(let t=m;t<z.length/3;t+=4)d=z[3*(t+2)]-z[3*t],E=z[3*(t+2)+2]-z[3*t+2],l=Math.sqrt(d*d+E*E),Q+=l,P.push(Q);let y=0,q=0;for(let t=0;t<I.length;t+=3)Math.abs(I[t+1])<.001&&(q=1),Math.abs(I[t+1]-1)<.001&&(q=0),Math.abs(I[t+1]+1)<.001&&(q=2),y=t/3,1===q?(u=y-m,Z[2*y]=u%4<1.5?i?b[q].x+(b[q].z-b[q].x)*P[Math.floor(u/4)]/Q:b[q].x:i?b[q].x+(b[q].z-b[q].x)*P[Math.floor(u/4)+1]/Q:b[q].z,Z[2*y+1]=u%2==0?B.rX?1-b[q].w:b[q].w:B.rX?1-b[q].y:b[q].y):(Z[2*y]=(1-Z[2*y])*b[q].x+Z[2*y]*b[q].z,Z[2*y+1]=(1-Z[2*y+1])*b[q].y+Z[2*y+1]*b[q].w,B.rX&&(Z[2*y+1]=1-Z[2*y+1])),n&&e.push(n[q].r,n[q].g,n[q].b,n[q].a);A.P._ComputeSides(K,z,w,I,Z,G,W);const X=new A.P;if(X.indices=w,X.positions=z,X.normals=I,X.uvs=Z,n){const t=K===A.P.DOUBLESIDE?e.concat(e):e;X.colors=t}return X}function PD(t,K,D=null,a=earcut){K.sideOrientation=Nt._GetDefaultSideOrientation(K.sideOrientation);const G=K.shape,W=K.holes||[],x=K.depth||0,b=K.smoothingThreshold||2,n=[];let e=[];for(let t=0;t<G.length;t++)n[t]=new N.I9(G[t].x,G[t].z);n[0].equalsWithEpsilon(n[n.length-1],1e-8)&&n.pop();const i=new lD(t,n,D||$.q.LastCreatedScene,a);for(let t=0;t<W.length;t++){e=[];for(let K=0;K<W[t].length;K++)e.push(new N.I9(W[t][K].x,W[t][K].z));i.addHole(e)}const z=i.build(!1,x,b);return z._originalBuilderSideOrientation=K.sideOrientation,QD(z,K.sideOrientation,K.faceUV,K.faceColors,K.frontUVs,K.backUVs,K.wrap).applyToMesh(z,K.updatable),z}function yD(t){const K=[],D=[],a=[],G=[],N=t.width||t.size||1,W=t.height||t.size||1,x=0===t.sideOrientation?0:t.sideOrientation||A.P.DEFAULTSIDE,b=N/2,n=W/2;D.push(-b,-n,0),a.push(0,0,-1),G.push(0,B.rX?1:0),D.push(b,-n,0),a.push(0,0,-1),G.push(1,B.rX?1:0),D.push(b,n,0),a.push(0,0,-1),G.push(1,B.rX?0:1),D.push(-b,n,0),a.push(0,0,-1),G.push(0,B.rX?0:1),K.push(0),K.push(1),K.push(2),K.push(0),K.push(2),K.push(3),A.P._ComputeSides(x,D,K,a,G,t.frontUVs,t.backUVs);const e=new A.P;return e.indices=K,e.positions=D,e.normals=a,e.uvs=G,e}function qD(t,K={},D=null){const a=new Nt(t,D);return K.sideOrientation=Nt._GetDefaultSideOrientation(K.sideOrientation),a._originalBuilderSideOrientation=K.sideOrientation,yD(K).applyToMesh(a,K.updatable),K.sourcePlane&&(a.translate(K.sourcePlane.normal,-K.sourcePlane.d),a.setDirection(K.sourcePlane.normal.scale(-1))),a}function XD(t){const K=[];K[0]={vertex:[[0,0,1.732051],[1.632993,0,-.5773503],[-.8164966,1.414214,-.5773503],[-.8164966,-1.414214,-.5773503]],face:[[0,1,2],[0,2,3],[0,3,1],[1,3,2]]},K[1]={vertex:[[0,0,1.414214],[1.414214,0,0],[0,1.414214,0],[-1.414214,0,0],[0,-1.414214,0],[0,0,-1.414214]],face:[[0,1,2],[0,2,3],[0,3,4],[0,4,1],[1,4,5],[1,5,2],[2,5,3],[3,5,4]]},K[2]={vertex:[[0,0,1.070466],[.7136442,0,.7978784],[-.3568221,.618034,.7978784],[-.3568221,-.618034,.7978784],[.7978784,.618034,.3568221],[.7978784,-.618034,.3568221],[-.9341724,.381966,.3568221],[.1362939,1,.3568221],[.1362939,-1,.3568221],[-.9341724,-.381966,.3568221],[.9341724,.381966,-.3568221],[.9341724,-.381966,-.3568221],[-.7978784,.618034,-.3568221],[-.1362939,1,-.3568221],[-.1362939,-1,-.3568221],[-.7978784,-.618034,-.3568221],[.3568221,.618034,-.7978784],[.3568221,-.618034,-.7978784],[-.7136442,0,-.7978784],[0,0,-1.070466]],face:[[0,1,4,7,2],[0,2,6,9,3],[0,3,8,5,1],[1,5,11,10,4],[2,7,13,12,6],[3,9,15,14,8],[4,10,16,13,7],[5,8,14,17,11],[6,12,18,15,9],[10,11,17,19,16],[12,13,16,19,18],[14,15,18,19,17]]},K[3]={vertex:[[0,0,1.175571],[1.051462,0,.5257311],[.3249197,1,.5257311],[-.8506508,.618034,.5257311],[-.8506508,-.618034,.5257311],[.3249197,-1,.5257311],[.8506508,.618034,-.5257311],[.8506508,-.618034,-.5257311],[-.3249197,1,-.5257311],[-1.051462,0,-.5257311],[-.3249197,-1,-.5257311],[0,0,-1.175571]],face:[[0,1,2],[0,2,3],[0,3,4],[0,4,5],[0,5,1],[1,5,7],[1,7,6],[1,6,2],[2,6,8],[2,8,3],[3,8,9],[3,9,4],[4,9,10],[4,10,5],[5,10,7],[6,7,11],[6,11,8],[7,10,11],[8,11,9],[9,11,10]]},K[4]={vertex:[[0,0,1.070722],[.7148135,0,.7971752],[-.104682,.7071068,.7971752],[-.6841528,.2071068,.7971752],[-.104682,-.7071068,.7971752],[.6101315,.7071068,.5236279],[1.04156,.2071068,.1367736],[.6101315,-.7071068,.5236279],[-.3574067,1,.1367736],[-.7888348,-.5,.5236279],[-.9368776,.5,.1367736],[-.3574067,-1,.1367736],[.3574067,1,-.1367736],[.9368776,-.5,-.1367736],[.7888348,.5,-.5236279],[.3574067,-1,-.1367736],[-.6101315,.7071068,-.5236279],[-1.04156,-.2071068,-.1367736],[-.6101315,-.7071068,-.5236279],[.104682,.7071068,-.7971752],[.6841528,-.2071068,-.7971752],[.104682,-.7071068,-.7971752],[-.7148135,0,-.7971752],[0,0,-1.070722]],face:[[0,2,3],[1,6,5],[4,9,11],[7,15,13],[8,16,10],[12,14,19],[17,22,18],[20,21,23],[0,1,5,2],[0,3,9,4],[0,4,7,1],[1,7,13,6],[2,5,12,8],[2,8,10,3],[3,10,17,9],[4,11,15,7],[5,6,14,12],[6,13,20,14],[8,12,19,16],[9,17,18,11],[10,16,22,17],[11,18,21,15],[13,15,21,20],[14,20,23,19],[16,19,23,22],[18,22,23,21]]},K[5]={vertex:[[0,0,1.322876],[1.309307,0,.1889822],[-.9819805,.8660254,.1889822],[.1636634,-1.299038,.1889822],[.3273268,.8660254,-.9449112],[-.8183171,-.4330127,-.9449112]],face:[[0,3,1],[2,4,5],[0,1,4,2],[0,2,5,3],[1,3,5,4]]},K[6]={vertex:[[0,0,1.159953],[1.013464,0,.5642542],[-.3501431,.9510565,.5642542],[-.7715208,-.6571639,.5642542],[.6633206,.9510565,-.03144481],[.8682979,-.6571639,-.3996071],[-1.121664,.2938926,-.03144481],[-.2348831,-1.063314,-.3996071],[.5181548,.2938926,-.9953061],[-.5850262,-.112257,-.9953061]],face:[[0,1,4,2],[0,2,6,3],[1,5,8,4],[3,6,9,7],[5,7,9,8],[0,3,7,5,1],[2,4,8,9,6]]},K[7]={vertex:[[0,0,1.118034],[.8944272,0,.6708204],[-.2236068,.8660254,.6708204],[-.7826238,-.4330127,.6708204],[.6708204,.8660254,.2236068],[1.006231,-.4330127,-.2236068],[-1.006231,.4330127,.2236068],[-.6708204,-.8660254,-.2236068],[.7826238,.4330127,-.6708204],[.2236068,-.8660254,-.6708204],[-.8944272,0,-.6708204],[0,0,-1.118034]],face:[[0,1,4,2],[0,2,6,3],[1,5,8,4],[3,6,10,7],[5,9,11,8],[7,10,11,9],[0,3,7,9,5,1],[2,4,8,11,10,6]]},K[8]={vertex:[[-.729665,.670121,.319155],[-.655235,-.29213,-.754096],[-.093922,-.607123,.537818],[.702196,.595691,.485187],[.776626,-.36656,-.588064]],face:[[1,4,2],[0,1,2],[3,0,2],[4,3,2],[4,1,0,3]]},K[9]={vertex:[[-.868849,-.100041,.61257],[-.329458,.976099,.28078],[-.26629,-.013796,-.477654],[-.13392,-1.034115,.229829],[.738834,.707117,-.307018],[.859683,-.535264,-.338508]],face:[[3,0,2],[5,3,2],[4,5,2],[1,4,2],[0,1,2],[0,3,5,4,1]]},K[10]={vertex:[[-.610389,.243975,.531213],[-.187812,-.48795,-.664016],[-.187812,.9759,-.664016],[.187812,-.9759,.664016],[.798201,.243975,.132803]],face:[[1,3,0],[3,4,0],[3,1,4],[0,2,1],[0,4,2],[2,4,1]]},K[11]={vertex:[[-1.028778,.392027,-.048786],[-.640503,-.646161,.621837],[-.125162,-.395663,-.540059],[.004683,.888447,-.651988],[.125161,.395663,.540059],[.632925,-.791376,.433102],[1.031672,.157063,-.354165]],face:[[3,2,0],[2,1,0],[2,5,1],[0,4,3],[0,1,4],[4,1,5],[2,3,6],[3,4,6],[5,2,6],[4,5,6]]},K[12]={vertex:[[-.669867,.334933,-.529576],[-.669867,.334933,.529577],[-.4043,1.212901,0],[-.334933,-.669867,-.529576],[-.334933,-.669867,.529577],[.334933,.669867,-.529576],[.334933,.669867,.529577],[.4043,-1.212901,0],[.669867,-.334933,-.529576],[.669867,-.334933,.529577]],face:[[8,9,7],[6,5,2],[3,8,7],[5,0,2],[4,3,7],[0,1,2],[9,4,7],[1,6,2],[9,8,5,6],[8,3,0,5],[3,4,1,0],[4,9,6,1]]},K[13]={vertex:[[-.931836,.219976,-.264632],[-.636706,.318353,.692816],[-.613483,-.735083,-.264632],[-.326545,.979634,0],[-.318353,-.636706,.692816],[-.159176,.477529,-.856368],[.159176,-.477529,-.856368],[.318353,.636706,.692816],[.326545,-.979634,0],[.613482,.735082,-.264632],[.636706,-.318353,.692816],[.931835,-.219977,-.264632]],face:[[11,10,8],[7,9,3],[6,11,8],[9,5,3],[2,6,8],[5,0,3],[4,2,8],[0,1,3],[10,4,8],[1,7,3],[10,11,9,7],[11,6,5,9],[6,2,0,5],[2,4,1,0],[4,10,7,1]]},K[14]={vertex:[[-.93465,.300459,-.271185],[-.838689,-.260219,-.516017],[-.711319,.717591,.128359],[-.710334,-.156922,.080946],[-.599799,.556003,-.725148],[-.503838,-.004675,-.969981],[-.487004,.26021,.48049],[-.460089,-.750282,-.512622],[-.376468,.973135,-.325605],[-.331735,-.646985,.084342],[-.254001,.831847,.530001],[-.125239,-.494738,-.966586],[.029622,.027949,.730817],[.056536,-.982543,-.262295],[.08085,1.087391,.076037],[.125583,-.532729,.485984],[.262625,.599586,.780328],[.391387,-.726999,-.716259],[.513854,-.868287,.139347],[.597475,.85513,.326364],[.641224,.109523,.783723],[.737185,-.451155,.538891],[.848705,-.612742,-.314616],[.976075,.365067,.32976],[1.072036,-.19561,.084927]],face:[[15,18,21],[12,20,16],[6,10,2],[3,0,1],[9,7,13],[2,8,4,0],[0,4,5,1],[1,5,11,7],[7,11,17,13],[13,17,22,18],[18,22,24,21],[21,24,23,20],[20,23,19,16],[16,19,14,10],[10,14,8,2],[15,9,13,18],[12,15,21,20],[6,12,16,10],[3,6,2,0],[9,3,1,7],[9,15,12,6,3],[22,17,11,5,4,8,14,19,23,24]]};const D=t.type&&(t.type<0||t.type>=K.length)?0:t.type||0,a=t.size,G=t.sizeX||a||1,W=t.sizeY||a||1,x=t.sizeZ||a||1,b=t.custom||K[D],n=b.face.length,e=t.faceUV||new Array(n),i=t.faceColors,z=void 0===t.flat||t.flat,I=0===t.sideOrientation?0:t.sideOrientation||A.P.DEFAULTSIDE,Z=[],w=[],m=[],u=[],d=[];let E=0,l=0;const Q=[];let P,y,q,X,h,J,T=0,_=0;if(z)for(_=0;_<n;_++)i&&void 0===i[_]&&(i[_]=new s.ov(1,1,1,1)),e&&void 0===e[_]&&(e[_]=new N.IU(0,0,1,1));if(z)for(_=0;_<n;_++){const t=b.face[_].length;for(q=2*Math.PI/t,X=.5*Math.tan(q/2),h=.5,T=0;T<t;T++)Z.push(b.vertex[b.face[_][T]][0]*G,b.vertex[b.face[_][T]][1]*W,b.vertex[b.face[_][T]][2]*x),Q.push(E),E++,P=e[_].x+(e[_].z-e[_].x)*(.5+X),y=e[_].y+(e[_].w-e[_].y)*(h-.5),u.push(P,B.rX?1-y:y),J=X*Math.cos(q)-h*Math.sin(q),h=X*Math.sin(q)+h*Math.cos(q),X=J,i&&d.push(i[_].r,i[_].g,i[_].b,i[_].a);for(T=0;T<t-2;T++)w.push(Q[0+l],Q[T+2+l],Q[T+1+l]);l+=t}else{for(T=0;T<b.vertex.length;T++)Z.push(b.vertex[T][0]*G,b.vertex[T][1]*W,b.vertex[T][2]*x),u.push(0,B.rX?1:0);for(_=0;_<n;_++)for(T=0;T<b.face[_].length-2;T++)w.push(b.face[_][0],b.face[_][T+2],b.face[_][T+1])}A.P.ComputeNormals(Z,w,m),A.P._ComputeSides(I,Z,w,m,u,t.frontUVs,t.backUVs);const C=new A.P;return C.positions=Z,C.indices=w,C.normals=m,C.uvs=u,i&&z&&(C.colors=d),C}A.P.CreatePolygon=QD,Nt.CreatePolygon=(t,K,D,a,G,N,W=earcut)=>PD(t,{shape:K,holes:a,updatable:G,sideOrientation:N},D,W),Nt.ExtrudePolygon=(t,K,D,a,G,N,W,x=earcut)=>function(t,K,D=null,a=earcut){return PD(t,K,D,a)}(t,{shape:K,holes:G,depth:D,updatable:N,sideOrientation:W},a,x),Nt.CreateLathe=(t,K,D,a,G,W,x)=>function(t,K,D=null){const a=K.arc?K.arc<=0||K.arc>1?1:K.arc:1,G=void 0===K.closed||K.closed,W=K.shape,x=K.radius||1,b=K.tessellation||64,n=K.clip||0,e=K.updatable,i=Nt._GetDefaultSideOrientation(K.sideOrientation),z=K.cap||Nt.NO_CAP,I=2*Math.PI,Z=[],w=K.invertUV||!1;let m=0,u=0;const d=I/b*a;let E,l;for(m=0;m<=b-n;m++){for(l=[],z!=Nt.CAP_START&&z!=Nt.CAP_ALL||(l.push(new N.Pq(0,W[0].y,0)),l.push(new N.Pq(Math.cos(m*d)*W[0].x*x,W[0].y,Math.sin(m*d)*W[0].x*x))),u=0;u<W.length;u++)E=new N.Pq(Math.cos(m*d)*W[u].x*x,W[u].y,Math.sin(m*d)*W[u].x*x),l.push(E);z!=Nt.CAP_END&&z!=Nt.CAP_ALL||(l.push(new N.Pq(Math.cos(m*d)*W[W.length-1].x*x,W[W.length-1].y,Math.sin(m*d)*W[W.length-1].x*x)),l.push(new N.Pq(0,W[W.length-1].y,0))),Z.push(l)}return uK(t,{pathArray:Z,closeArray:G,sideOrientation:i,updatable:e,invertUV:w,frontUVs:K.frontUVs,backUVs:K.backUVs},D)}(t,{shape:K,radius:D,tessellation:a,sideOrientation:x,updatable:W},G),A.P.CreatePlane=yD,Nt.CreatePlane=(t,K,D,a,G)=>qD(t,{size:K,width:K,height:K,sideOrientation:G,updatable:a},D),Nt.CreateTube=(t,K,D,a,G,W,x,b,n,e)=>function(t,K,D=null){const a=K.path;let G=K.instance,W=1;void 0!==K.radius?W=K.radius:G&&(W=G._creationDataStorage.radius);const x=K.tessellation||64|0,b=K.radiusFunction||null;let n=K.cap||Nt.NO_CAP;const e=K.invertUV||!1,i=K.updatable,z=Nt._GetDefaultSideOrientation(K.sideOrientation);K.arc=K.arc&&(K.arc<=0||K.arc>1)?1:K.arc||1;const I=(t,K,D,a,G,W,x,b)=>{const n=K.getTangents(),e=K.getNormals(),i=K.getDistances(),z=2*Math.PI/G*b,I=W||(()=>a);let Z,w,m,u;const d=N.AA.Matrix[0];let E=x===Nt.NO_CAP||x===Nt.CAP_END?0:2;for(let K=0;K<t.length;K++){w=I(K,i[K]),Z=Array(),m=e[K];for(let D=0;D<G;D++)N.uq.RotationAxisToRef(n[K],z*D,d),u=Z[D]?Z[D]:N.Pq.Zero(),N.Pq.TransformCoordinatesToRef(m,d,u),u.scaleInPlace(w).addInPlace(t[K]),Z[D]=u;D[E]=Z,E++}const l=(K,D)=>{const a=Array();for(let G=0;G<K;G++)a.push(t[D]);return a};switch(x){case Nt.NO_CAP:break;case Nt.CAP_START:D[0]=l(G,0),D[1]=D[2].slice(0);break;case Nt.CAP_END:D[E]=D[E-1].slice(0),D[E+1]=l(G,t.length-1);break;case Nt.CAP_ALL:D[0]=l(G,0),D[1]=D[2].slice(0),D[E]=D[E-1].slice(0),D[E+1]=l(G,t.length-1)}return D};let Z,w;if(G){const t=G._creationDataStorage,D=K.arc||t.arc;return Z=t.path3D.update(a),w=I(a,Z,t.pathArray,W,t.tessellation,b,t.cap,D),G=uK("",{pathArray:w,instance:G}),t.path3D=Z,t.pathArray=w,t.arc=D,t.radius=W,G}Z=new dK.tO(a),n=n<0||n>3?0:n,w=I(a,Z,new Array,W,x,b,n,K.arc);const m=uK(t,{pathArray:w,closePath:!0,closeArray:!1,updatable:i,sideOrientation:z,invertUV:e,frontUVs:K.frontUVs,backUVs:K.backUVs},D);return m._creationDataStorage.pathArray=w,m._creationDataStorage.path3D=Z,m._creationDataStorage.tessellation=x,m._creationDataStorage.cap=n,m._creationDataStorage.arc=K.arc,m._creationDataStorage.radius=W,m}(t,{path:K,radius:D,tessellation:a,radiusFunction:G,arc:1,cap:W,updatable:b,sideOrientation:n,instance:e},x),A.P.CreatePolyhedron=XD,Nt.CreatePolyhedron=(t,K,D)=>function(t,K={},D=null){const a=new Nt(t,D);return K.sideOrientation=Nt._GetDefaultSideOrientation(K.sideOrientation),a._originalBuilderSideOrientation=K.sideOrientation,XD(K).applyToMesh(a,K.updatable),a}(t,K,D),Nt._GoldbergMeshParser=(t,K)=>hD.Parse(t,K);class hD extends Nt{constructor(){super(...arguments),this.goldbergData={faceColors:[],faceCenters:[],faceZaxis:[],faceXaxis:[],faceYaxis:[],nbSharedFaces:0,nbUnsharedFaces:0,nbFaces:0,nbFacesAtPole:0,adjacentFaces:[]}}relatedGoldbergFace(t,K){return void 0===K?(t>this.goldbergData.nbUnsharedFaces-1&&(i.V.Warn("Maximum number of unshared faces used"),t=this.goldbergData.nbUnsharedFaces-1),this.goldbergData.nbUnsharedFaces+t):(t>11&&(i.V.Warn("Last pole used"),t=11),K>this.goldbergData.nbFacesAtPole-1&&(i.V.Warn("Maximum number of faces at a pole used"),K=this.goldbergData.nbFacesAtPole-1),12+t*this.goldbergData.nbFacesAtPole+K)}_changeGoldbergFaceColors(t){for(let K=0;K<t.length;K++){const D=t[K][0],a=t[K][1],G=t[K][2];for(let t=D;t<a+1;t++)this.goldbergData.faceColors[t]=G}const K=[];for(let t=0;t<12;t++)for(let D=0;D<5;D++)K.push(this.goldbergData.faceColors[t].r,this.goldbergData.faceColors[t].g,this.goldbergData.faceColors[t].b,this.goldbergData.faceColors[t].a);for(let t=12;t<this.goldbergData.faceColors.length;t++)for(let D=0;D<6;D++)K.push(this.goldbergData.faceColors[t].r,this.goldbergData.faceColors[t].g,this.goldbergData.faceColors[t].b,this.goldbergData.faceColors[t].a);return K}setGoldbergFaceColors(t){const K=this._changeGoldbergFaceColors(t);this.setVerticesData(R.R.ColorKind,K)}updateGoldbergFaceColors(t){const K=this._changeGoldbergFaceColors(t);this.updateVerticesData(R.R.ColorKind,K)}_changeGoldbergFaceUVs(t){const K=this.getVerticesData(R.R.UVKind);for(let D=0;D<t.length;D++){const a=t[D][0],G=t[D][1],N=t[D][2],W=t[D][3],x=t[D][4],b=[],n=[];let e,i;for(let t=0;t<5;t++)e=N.x+W*Math.cos(x+t*Math.PI/2.5),i=N.y+W*Math.sin(x+t*Math.PI/2.5),e<0&&(e=0),e>1&&(e=1),b.push(e,i);for(let t=0;t<6;t++)e=N.x+W*Math.cos(x+t*Math.PI/3),i=N.y+W*Math.sin(x+t*Math.PI/3),e<0&&(e=0),e>1&&(e=1),n.push(e,i);for(let t=a;t<Math.min(12,G+1);t++)for(let D=0;D<5;D++)K[10*t+2*D]=b[2*D],K[10*t+2*D+1]=b[2*D+1];for(let t=Math.max(12,a);t<G+1;t++)for(let D=0;D<6;D++)K[12*t-24+2*D]=n[2*D],K[12*t-23+2*D]=n[2*D+1]}return K}setGoldbergFaceUVs(t){const K=this._changeGoldbergFaceUVs(t);this.setVerticesData(R.R.UVKind,K)}updateGoldbergFaceUVs(t){const K=this._changeGoldbergFaceUVs(t);this.updateVerticesData(R.R.UVKind,K)}placeOnGoldbergFaceAt(t,K,D){const a=N.Pq.RotationFromAxis(this.goldbergData.faceXaxis[K],this.goldbergData.faceYaxis[K],this.goldbergData.faceZaxis[K]);t.rotation=a,t.position=this.goldbergData.faceCenters[K].add(this.goldbergData.faceXaxis[K].scale(D.x)).add(this.goldbergData.faceYaxis[K].scale(D.y)).add(this.goldbergData.faceZaxis[K].scale(D.z))}serialize(t){super.serialize(t),t.type="GoldbergMesh";const K={};if(K.adjacentFaces=this.goldbergData.adjacentFaces,K.nbSharedFaces=this.goldbergData.nbSharedFaces,K.nbUnsharedFaces=this.goldbergData.nbUnsharedFaces,K.nbFaces=this.goldbergData.nbFaces,K.nbFacesAtPole=this.goldbergData.nbFacesAtPole,this.goldbergData.faceColors){K.faceColors=[];for(const t of this.goldbergData.faceColors)K.faceColors.push(t.asArray())}if(this.goldbergData.faceCenters){K.faceCenters=[];for(const t of this.goldbergData.faceCenters)K.faceCenters.push(t.asArray())}if(this.goldbergData.faceZaxis){K.faceZaxis=[];for(const t of this.goldbergData.faceZaxis)K.faceZaxis.push(t.asArray())}if(this.goldbergData.faceYaxis){K.faceYaxis=[];for(const t of this.goldbergData.faceYaxis)K.faceYaxis.push(t.asArray())}if(this.goldbergData.faceXaxis){K.faceXaxis=[];for(const t of this.goldbergData.faceXaxis)K.faceXaxis.push(t.asArray())}t.goldbergData=K}static Parse(t,K){const D=t.goldbergData;D.faceColors=D.faceColors.map((t=>s.ov.FromArray(t))),D.faceCenters=D.faceCenters.map((t=>N.Pq.FromArray(t))),D.faceZaxis=D.faceZaxis.map((t=>N.Pq.FromArray(t))),D.faceXaxis=D.faceXaxis.map((t=>N.Pq.FromArray(t))),D.faceYaxis=D.faceYaxis.map((t=>N.Pq.FromArray(t)));const a=new hD(t.name,K);return a.goldbergData=D,a}}const JD=new N.Pq(1,0,0),TD=new N.Pq(-1,0,0),_D=new N.Pq(0,1,0),CD=new N.Pq(0,-1,0),HD=new N.Pq(0,0,1),oD=new N.Pq(0,0,-1);class UD{constructor(t=N.Pq.Zero(),K=N.Pq.Up(),D=N.I9.Zero(),a=0,G=0,W=null,x=null,b=null,n=null){this.position=t,this.normal=K,this.uv=D,this.vertexIdx=a,this.vertexIdxForBones=G,this.localPositionOverride=W,this.localNormalOverride=x,this.matrixIndicesOverride=b,this.matrixWeightsOverride=n}clone(){var t,K,D,a;return new UD(this.position.clone(),this.normal.clone(),this.uv.clone(),this.vertexIdx,this.vertexIdxForBones,null===(t=this.localPositionOverride)||void 0===t?void 0:t.slice(),null===(K=this.localNormalOverride)||void 0===K?void 0:K.slice(),null===(D=this.matrixIndicesOverride)||void 0===D?void 0:D.slice(),null===(a=this.matrixWeightsOverride)||void 0===a?void 0:a.slice())}}function VD(t){const K=t.sideOrientation||A.P.DEFAULTSIDE,D=t.radius||1,a=void 0===t.flat||t.flat,G=0|(t.subdivisions||4),W=t.radiusX||D,x=t.radiusY||D,b=t.radiusZ||D,n=(1+Math.sqrt(5))/2,e=[-1,n,-0,1,n,0,-1,-n,0,1,-n,0,0,-1,-n,0,1,-n,0,-1,n,0,1,n,n,0,1,n,0,-1,-n,0,1,-n,0,-1],i=[0,11,5,0,5,1,0,1,7,0,7,10,12,22,23,1,5,20,5,11,4,23,22,13,22,18,6,7,1,8,14,21,4,14,4,2,16,13,6,15,6,19,3,8,9,4,21,5,13,17,23,6,13,22,19,6,18,9,8,1],z=[0,1,2,3,4,5,6,7,8,9,10,11,0,2,3,3,3,4,7,8,9,9,10,11],I=[5,1,3,1,6,4,0,0,5,3,4,2,2,2,4,0,2,0,1,1,6,0,6,2,0,4,3,3,4,4,3,1,4,2,4,4,0,2,1,1,2,2,3,3,1,3,2,4],Z=138/1024,w=239/1024,m=60/1024,u=26/1024,d=-40/1024,E=+20/1024,l=[0,0,0,0,1,0,0,1,1,0,0,0,1,1,0,0,1,1,1,0],Q=[],P=[],y=[],q=[];let X=0;const h=new Array(3),J=new Array(3);let T;for(T=0;T<3;T++)h[T]=N.Pq.Zero(),J[T]=N.I9.Zero();for(let t=0;t<20;t++){for(T=0;T<3;T++){const K=i[3*t+T];h[T].copyFromFloats(e[3*z[K]],e[3*z[K]+1],e[3*z[K]+2]),h[T].normalize(),J[T].copyFromFloats(I[2*K]*Z+m+l[t]*d,I[2*K+1]*w+u+l[t]*E)}const K=(t,K,D,n)=>{const e=N.Pq.Lerp(h[0],h[2],K/G),i=N.Pq.Lerp(h[1],h[2],K/G),z=G===K?h[2]:N.Pq.Lerp(e,i,t/(G-K));let I;if(z.normalize(),a){const t=N.Pq.Lerp(h[0],h[2],n/G),K=N.Pq.Lerp(h[1],h[2],n/G);I=N.Pq.Lerp(t,K,D/(G-n))}else I=new N.Pq(z.x,z.y,z.z);I.x/=W,I.y/=x,I.z/=b,I.normalize();const Z=N.I9.Lerp(J[0],J[2],K/G),w=N.I9.Lerp(J[1],J[2],K/G),m=G===K?J[2]:N.I9.Lerp(Z,w,t/(G-K));P.push(z.x*W,z.y*x,z.z*b),y.push(I.x,I.y,I.z),q.push(m.x,B.rX?1-m.y:m.y),Q.push(X),X++};for(let t=0;t<G;t++)for(let D=0;D+t<G;D++)K(D,t,D+1/3,t+1/3),K(D+1,t,D+1/3,t+1/3),K(D,t+1,D+1/3,t+1/3),D+t+1<G&&(K(D+1,t,D+2/3,t+2/3),K(D+1,t+1,D+2/3,t+2/3),K(D,t+1,D+2/3,t+2/3))}A.P._ComputeSides(K,P,Q,y,q,t.frontUVs,t.backUVs);const _=new A.P;return _.indices=Q,_.positions=P,_.normals=y,_.uvs=q,_}function sD(t={subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6}){const K=0|Math.max(t.subdivisions?t.subdivisions:2,1),D=0|Math.max(t.tessellation?t.tessellation:16,3),a=Math.max(t.height?t.height:1,0),G=Math.max(t.radius?t.radius:.25,0),W=0|Math.max(t.capSubdivisions?t.capSubdivisions:6,1),x=D,b=K,n=Math.max(t.radiusTop?t.radiusTop:G,0),e=Math.max(t.radiusBottom?t.radiusBottom:G,0),i=a-(n+e),z=0,I=2*Math.PI,Z=Math.max(t.topCapSubdivisions?t.topCapSubdivisions:W,1),w=Math.max(t.bottomCapSubdivisions?t.bottomCapSubdivisions:W,1),m=Math.acos((e-n)/a);let u=[];const d=[],E=[],l=[];let Q=0;const P=[],y=.5*i,q=.5*Math.PI;let X,h;const J=N.Pq.Zero(),T=N.Pq.Zero(),_=Math.cos(m),C=Math.sin(m),H=new N.I9(n*C,y+n*_).subtract(new N.I9(e*C,-y+e*_)).length(),o=n*m+H+e*(q-m);let U=0;for(h=0;h<=Z;h++){const t=[],K=q-m*(h/Z);U+=n*m/Z;const D=Math.cos(K),a=Math.sin(K),G=D*n;for(X=0;X<=x;X++){const K=X/x,N=K*I+z,W=Math.sin(N),b=Math.cos(N);T.x=G*W,T.y=y+a*n,T.z=G*b,d.push(T.x,T.y,T.z),J.set(D*W,a,D*b),E.push(J.x,J.y,J.z),l.push(K,B.rX?U/o:1-U/o),t.push(Q),Q++}P.push(t)}const V=a-n-e+_*n-_*e,s=C*(e-n)/V;for(h=1;h<=b;h++){const t=[];U+=H/b;const K=C*(h*(e-n)/b+n);for(X=0;X<=x;X++){const D=X/x,a=D*I+z,G=Math.sin(a),N=Math.cos(a);T.x=K*G,T.y=y+_*n-h*V/b,T.z=K*N,d.push(T.x,T.y,T.z),J.set(G,s,N).normalize(),E.push(J.x,J.y,J.z),l.push(D,B.rX?U/o:1-U/o),t.push(Q),Q++}P.push(t)}for(h=1;h<=w;h++){const t=[],K=q-m-(Math.PI-m)*(h/w);U+=e*m/w;const D=Math.cos(K),a=Math.sin(K),G=D*e;for(X=0;X<=x;X++){const K=X/x,N=K*I+z,W=Math.sin(N),b=Math.cos(N);T.x=G*W,T.y=-y+a*e,T.z=G*b,d.push(T.x,T.y,T.z),J.set(D*W,a,D*b),E.push(J.x,J.y,J.z),l.push(K,B.rX?U/o:1-U/o),t.push(Q),Q++}P.push(t)}for(X=0;X<x;X++)for(h=0;h<Z+b+w;h++){const t=P[h][X],K=P[h+1][X],D=P[h+1][X+1],a=P[h][X+1];u.push(t),u.push(K),u.push(a),u.push(K),u.push(D),u.push(a)}if(u=u.reverse(),t.orientation&&!t.orientation.equals(N.Pq.Up())){const K=new N.uq;t.orientation.clone().scale(.5*Math.PI).cross(N.Pq.Up()).toQuaternion().toRotationMatrix(K);const D=N.Pq.Zero();for(let t=0;t<d.length;t+=3)D.set(d[t],d[t+1],d[t+2]),N.Pq.TransformCoordinatesToRef(D.clone(),K,D),d[t]=D.x,d[t+1]=D.y,d[t+2]=D.z}const F=new A.P;return F.positions=d,F.normals=E,F.uvs=l,F.indices=u,F}Nt.CreateDecal=(t,K,D,a,G,W)=>function(t,K,D){var a,G,W,x;const b=!!K.skeleton,n=D.localMode||b,e=K.getIndices(),i=b?K.getPositionData(!0,!0):K.getVerticesData(R.R.PositionKind),z=b?K.getNormalsData(!0,!0):K.getVerticesData(R.R.NormalKind),I=n?b?K.getVerticesData(R.R.PositionKind):i:null,Z=n?b?K.getVerticesData(R.R.NormalKind):z:null,w=K.getVerticesData(R.R.UVKind),m=b?K.getVerticesData(R.R.MatricesIndicesKind):null,u=b?K.getVerticesData(R.R.MatricesWeightsKind):null,d=b?K.getVerticesData(R.R.MatricesIndicesExtraKind):null,E=b?K.getVerticesData(R.R.MatricesWeightsExtraKind):null,l=D.position||N.Pq.Zero();let Q=D.normal||N.Pq.Up();const P=D.size||N.Pq.One(),y=D.angle||0;if(!Q){const t=new N.Pq(0,0,1),D=K.getScene().activeCamera,a=N.Pq.TransformCoordinates(t,D.getWorldMatrix());Q=D.globalPosition.subtract(a)}const q=-Math.atan2(Q.z,Q.x)-Math.PI/2,X=Math.sqrt(Q.x*Q.x+Q.z*Q.z),h=Math.atan2(Q.y,X),J=new A.P;J.indices=[],J.positions=[],J.normals=[],J.uvs=[],J.matricesIndices=b?[]:null,J.matricesWeights=b?[]:null,J.matricesIndicesExtra=d?[]:null,J.matricesWeightsExtra=E?[]:null;let T=0;const _=(t,K)=>{const a=new UD;if(!e||!i||!z)return a;const G=e[t];if(a.vertexIdx=3*G,a.vertexIdxForBones=4*G,a.position=new N.Pq(i[3*G],i[3*G+1],i[3*G+2]),N.Pq.TransformCoordinatesToRef(a.position,K,a.position),a.normal=new N.Pq(z[3*G],z[3*G+1],z[3*G+2]),N.Pq.TransformNormalToRef(a.normal,K,a.normal),D.captureUVS&&w){const t=w[2*G+1];a.uv=new N.I9(w[2*G],B.rX?1-t:t)}return a},C=[0,0,0,0],H=(t,K)=>{if(0===t.length)return t;const D=.5*Math.abs(N.Pq.Dot(P,K)),a=(t,K,D,a)=>{for(let G=0;G<a;++G)if(t[D+G]===K)return D+G;return-1},G=(t,G)=>{var W,x,b,n,e,i,z,w,d,E,l,Q,P,y,q,X;const h=N.Pq.GetClipFactor(t.position,G.position,K,D);let J=C,T=C;if(m&&u){const K=t.matrixIndicesOverride?0:t.vertexIdxForBones,D=null!==(W=t.matrixIndicesOverride)&&void 0!==W?W:m,N=null!==(x=t.matrixWeightsOverride)&&void 0!==x?x:u,e=G.matrixIndicesOverride?0:G.vertexIdxForBones,i=null!==(b=G.matrixIndicesOverride)&&void 0!==b?b:m,z=null!==(n=G.matrixWeightsOverride)&&void 0!==n?n:u;J=[0,0,0,0],T=[0,0,0,0];let I=0;for(let t=0;t<4;++t)if(N[K+t]>0){const G=a(i,D[K+t],e,4);J[I]=D[K+t],T[I]=it.X.Lerp(N[K+t],G>=0?z[G]:0,h),I++}for(let t=0;t<4&&I<4;++t){const G=i[e+t];-1===a(D,G,K,4)&&(J[I]=G,T[I]=it.X.Lerp(0,z[e+t],h),I++)}const Z=T[0]+T[1]+T[2]+T[3];T[0]/=Z,T[1]/=Z,T[2]/=Z,T[3]/=Z}const _=t.localPositionOverride?t.localPositionOverride[0]:null!==(e=null==I?void 0:I[t.vertexIdx])&&void 0!==e?e:0,H=t.localPositionOverride?t.localPositionOverride[1]:null!==(i=null==I?void 0:I[t.vertexIdx+1])&&void 0!==i?i:0,o=t.localPositionOverride?t.localPositionOverride[2]:null!==(z=null==I?void 0:I[t.vertexIdx+2])&&void 0!==z?z:0,U=G.localPositionOverride?G.localPositionOverride[0]:null!==(w=null==I?void 0:I[G.vertexIdx])&&void 0!==w?w:0,V=G.localPositionOverride?G.localPositionOverride[1]:null!==(d=null==I?void 0:I[G.vertexIdx+1])&&void 0!==d?d:0,s=G.localPositionOverride?G.localPositionOverride[2]:null!==(E=null==I?void 0:I[G.vertexIdx+2])&&void 0!==E?E:0,F=t.localNormalOverride?t.localNormalOverride[0]:null!==(l=null==Z?void 0:Z[t.vertexIdx])&&void 0!==l?l:0,c=t.localNormalOverride?t.localNormalOverride[1]:null!==(Q=null==Z?void 0:Z[t.vertexIdx+1])&&void 0!==Q?Q:0,g=t.localNormalOverride?t.localNormalOverride[2]:null!==(P=null==Z?void 0:Z[t.vertexIdx+2])&&void 0!==P?P:0,R=F+((G.localNormalOverride?G.localNormalOverride[0]:null!==(y=null==Z?void 0:Z[G.vertexIdx])&&void 0!==y?y:0)-F)*h,A=c+((G.localNormalOverride?G.localNormalOverride[1]:null!==(q=null==Z?void 0:Z[G.vertexIdx+1])&&void 0!==q?q:0)-c)*h,Y=g+((G.localNormalOverride?G.localNormalOverride[2]:null!==(X=null==Z?void 0:Z[G.vertexIdx+2])&&void 0!==X?X:0)-g)*h,L=Math.sqrt(R*R+A*A+Y*Y);return new UD(N.Pq.Lerp(t.position,G.position,h),N.Pq.Lerp(t.normal,G.normal,h).normalize(),N.I9.Lerp(t.uv,G.uv,h),-1,-1,I?[_+(U-_)*h,H+(V-H)*h,o+(s-o)*h]:null,Z?[R/L,A/L,Y/L]:null,J,T)};let W=null;t.length>3&&(W=[]);for(let a=0;a<t.length;a+=3){let x=0,b=null,n=null,e=null,i=null;const z=N.Pq.Dot(t[a].position,K)-D>0,I=N.Pq.Dot(t[a+1].position,K)-D>0,Z=N.Pq.Dot(t[a+2].position,K)-D>0;switch(x=(z?1:0)+(I?1:0)+(Z?1:0),x){case 0:t.length>3?(W.push(t[a]),W.push(t[a+1]),W.push(t[a+2])):W=t;break;case 1:if(W=null!=W?W:new Array,z&&(b=t[a+1],n=t[a+2],e=G(t[a],b),i=G(t[a],n)),I){b=t[a],n=t[a+2],e=G(t[a+1],b),i=G(t[a+1],n),W.push(e),W.push(n.clone()),W.push(b.clone()),W.push(n.clone()),W.push(e.clone()),W.push(i);break}Z&&(b=t[a],n=t[a+1],e=G(t[a+2],b),i=G(t[a+2],n)),b&&n&&e&&i&&(W.push(b.clone()),W.push(n.clone()),W.push(e),W.push(i),W.push(e.clone()),W.push(n.clone()));break;case 2:W=null!=W?W:new Array,z||(b=t[a].clone(),n=G(b,t[a+1]),e=G(b,t[a+2]),W.push(b),W.push(n),W.push(e)),I||(b=t[a+1].clone(),n=G(b,t[a+2]),e=G(b,t[a]),W.push(b),W.push(n),W.push(e)),Z||(b=t[a+2].clone(),n=G(b,t[a]),e=G(b,t[a+1]),W.push(b),W.push(n),W.push(e))}}return W},o=K instanceof Nt?K:null,U=null==o?void 0:o._thinInstanceDataStorage.matrixData,V=(null==o?void 0:o.thinInstanceCount)||1,s=N.AA.Matrix[0];s.copyFrom(N.uq.IdentityReadOnly);for(let t=0;t<V;++t){if((null==o?void 0:o.hasThinInstances)&&U){const K=16*t;s.setRowFromFloats(0,U[K+0],U[K+1],U[K+2],U[K+3]),s.setRowFromFloats(1,U[K+4],U[K+5],U[K+6],U[K+7]),s.setRowFromFloats(2,U[K+8],U[K+9],U[K+10],U[K+11]),s.setRowFromFloats(3,U[K+12],U[K+13],U[K+14],U[K+15])}const a=N.uq.RotationYawPitchRoll(q,h,y).multiply(N.uq.Translation(l.x,l.y,l.z)),G=N.uq.Invert(a),W=K.getWorldMatrix(),x=s.multiply(W).multiply(G),b=new Array(3);for(let t=0;t<e.length;t+=3){let K=b;if(K[0]=_(t,x),K[1]=_(t+1,x),K[2]=_(t+2,x),!(D.cullBackFaces&&-K[0].normal.z<=0&&-K[1].normal.z<=0&&-K[2].normal.z<=0)&&(K=H(K,JD),K&&(K=H(K,TD),K&&(K=H(K,_D),K&&(K=H(K,CD),K&&(K=H(K,HD),K&&(K=H(K,oD),K)))))))for(let t=0;t<K.length;t++){const a=K[t];if(J.indices.push(T),n?(a.localPositionOverride?(J.positions[3*T]=a.localPositionOverride[0],J.positions[3*T+1]=a.localPositionOverride[1],J.positions[3*T+2]=a.localPositionOverride[2]):I&&(J.positions[3*T]=I[a.vertexIdx],J.positions[3*T+1]=I[a.vertexIdx+1],J.positions[3*T+2]=I[a.vertexIdx+2]),a.localNormalOverride?(J.normals[3*T]=a.localNormalOverride[0],J.normals[3*T+1]=a.localNormalOverride[1],J.normals[3*T+2]=a.localNormalOverride[2]):Z&&(J.normals[3*T]=Z[a.vertexIdx],J.normals[3*T+1]=Z[a.vertexIdx+1],J.normals[3*T+2]=Z[a.vertexIdx+2])):(a.position.toArray(J.positions,3*T),a.normal.toArray(J.normals,3*T)),J.matricesIndices&&J.matricesWeights&&(a.matrixIndicesOverride?(J.matricesIndices[4*T]=a.matrixIndicesOverride[0],J.matricesIndices[4*T+1]=a.matrixIndicesOverride[1],J.matricesIndices[4*T+2]=a.matrixIndicesOverride[2],J.matricesIndices[4*T+3]=a.matrixIndicesOverride[3]):(m&&(J.matricesIndices[4*T]=m[a.vertexIdxForBones],J.matricesIndices[4*T+1]=m[a.vertexIdxForBones+1],J.matricesIndices[4*T+2]=m[a.vertexIdxForBones+2],J.matricesIndices[4*T+3]=m[a.vertexIdxForBones+3]),d&&J.matricesIndicesExtra&&(J.matricesIndicesExtra[4*T]=d[a.vertexIdxForBones],J.matricesIndicesExtra[4*T+1]=d[a.vertexIdxForBones+1],J.matricesIndicesExtra[4*T+2]=d[a.vertexIdxForBones+2],J.matricesIndicesExtra[4*T+3]=d[a.vertexIdxForBones+3])),a.matrixWeightsOverride?(J.matricesWeights[4*T]=a.matrixWeightsOverride[0],J.matricesWeights[4*T+1]=a.matrixWeightsOverride[1],J.matricesWeights[4*T+2]=a.matrixWeightsOverride[2],J.matricesWeights[4*T+3]=a.matrixWeightsOverride[3]):(u&&(J.matricesWeights[4*T]=u[a.vertexIdxForBones],J.matricesWeights[4*T+1]=u[a.vertexIdxForBones+1],J.matricesWeights[4*T+2]=u[a.vertexIdxForBones+2],J.matricesWeights[4*T+3]=u[a.vertexIdxForBones+3]),E&&J.matricesWeightsExtra&&(J.matricesWeightsExtra[4*T]=E[a.vertexIdxForBones],J.matricesWeightsExtra[4*T+1]=E[a.vertexIdxForBones+1],J.matricesWeightsExtra[4*T+2]=E[a.vertexIdxForBones+2],J.matricesWeightsExtra[4*T+3]=E[a.vertexIdxForBones+3]))),D.captureUVS)a.uv.toArray(J.uvs,2*T);else{J.uvs.push(.5+a.position.x/P.x);const t=.5+a.position.y/P.y;J.uvs.push(B.rX?1-t:t)}T++}}}0===J.indices.length&&(J.indices=null),0===J.positions.length&&(J.positions=null),0===J.normals.length&&(J.normals=null),0===J.uvs.length&&(J.uvs=null),0===(null===(a=J.matricesIndices)||void 0===a?void 0:a.length)&&(J.matricesIndices=null),0===(null===(G=J.matricesWeights)||void 0===G?void 0:G.length)&&(J.matricesWeights=null),0===(null===(W=J.matricesIndicesExtra)||void 0===W?void 0:W.length)&&(J.matricesIndicesExtra=null),0===(null===(x=J.matricesWeightsExtra)||void 0===x?void 0:x.length)&&(J.matricesWeightsExtra=null);const F=new Nt(t,K.getScene());return J.applyToMesh(F),n?(F.skeleton=K.skeleton,F.parent=K):(F.position=l.clone(),F.rotation=new N.Pq(h,q,y)),F.computeWorldMatrix(!0),F.refreshBoundingInfo(!0,!0),F}(t,K,{position:D,normal:a,size:G,angle:W}),A.P.CreateIcoSphere=VD,Nt.CreateIcoSphere=(t,K,D)=>function(t,K={},D=null){const a=new Nt(t,D);return K.sideOrientation=Nt._GetDefaultSideOrientation(K.sideOrientation),a._originalBuilderSideOrientation=K.sideOrientation,VD(K).applyToMesh(a,K.updatable),a}(t,K,D),Nt.CreateCapsule=(t,K,D)=>function(t,K={orientation:N.Pq.Up(),subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6,updatable:!1},D=null){const a=new Nt(t,D);return sD(K).applyToMesh(a,K.updatable),a}(t,K,D),A.P.CreateCapsule=sD;class FD{constructor(t){this._paths=[],this._tempPaths=[],this._holes=[],this._resolution=t}moveTo(t,K){this._currentPath=new dK.Cu(t,K),this._tempPaths.push(this._currentPath)}lineTo(t,K){this._currentPath.addLineTo(t,K)}quadraticCurveTo(t,K,D,a){this._currentPath.addQuadraticCurveTo(t,K,D,a,this._resolution)}bezierCurveTo(t,K,D,a,G,N){this._currentPath.addBezierCurveTo(t,K,D,a,G,N,this._resolution)}extractHoles(){for(const t of this._tempPaths)t.area()>0?this._holes.push(t):this._paths.push(t);if(!this._paths.length&&this._holes.length){const t=this._holes;this._holes=this._paths,this._paths=t}this._tempPaths.length=0}get paths(){return this._paths}get holes(){return this._holes}}function cD(t,K,D,a,G,N){const W=N.glyphs[t]||N.glyphs["?"];if(!W)return null;const x=new FD(G);if(W.o){const t=W.o.split(" ");for(let G=0,N=t.length;G<N;)switch(t[G++]){case"m":{const N=parseInt(t[G++])*K+D,W=parseInt(t[G++])*K+a;x.moveTo(N,W);break}case"l":{const N=parseInt(t[G++])*K+D,W=parseInt(t[G++])*K+a;x.lineTo(N,W);break}case"q":{const N=parseInt(t[G++])*K+D,W=parseInt(t[G++])*K+a,b=parseInt(t[G++])*K+D,n=parseInt(t[G++])*K+a;x.quadraticCurveTo(b,n,N,W);break}case"b":{const N=parseInt(t[G++])*K+D,W=parseInt(t[G++])*K+a,b=parseInt(t[G++])*K+D,n=parseInt(t[G++])*K+a,e=parseInt(t[G++])*K+D,i=parseInt(t[G++])*K+a;x.bezierCurveTo(b,n,e,i,N,W);break}}}return x.extractHoles(),{offsetX:W.ha*K,shapePath:x}}var gD=D(374603);const RD="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAgAElEQVR42u29yY5tWXIlZnbuiSaTbZFUkZRKrCKhElASQA0EoQABgn6hJvoXzfUP+gP9hWb6Bg00IgRoQJaKqUxmZmTEe8/v0uB2u7Fm2T7HIyIrnz88uPvt3f2a2WrMbOvf/u3PvvzP/sUf/N6//i8vf/lv/3v5H//d//Sb//Uq/5u8yf8hV/m/5Cp/L1f5hVzlG7nKJ7mKyJuIXN/hPwqXI/g++zq6rPI5u8z+WqfLre+zy7PrVv9L8brsMiGvk8XLmM/sdfHXal4e3ad6GXPdyu2ij8u/+uv/5cuf/OSLfdtEfvUr+dnf/d0X//t3H/7bf/hP//N/928h/0Yg/4VA/kogfyGQP5Wr/IFAvhbIlwK5CGQTPP+9z5uPeePJSW+yo2+s/GtN30Rnv1E+f5zxof9R/lSXv/nr//mrr3+i+5dfyX7ZZQP07Tffys//8R/l/9TtX7790T/7r/8G8pdy+/8XAvnnAvkzgfwzgfyxQP5AIL8vkJ8K5KsmMVzu1U7p5PA5AXxOAJ8TwPf7sX/51ZeXfcemqnp9w/W77/S7X/6T/vzf/7383RWCX3/z05/9i3/13/0PX//eX/2FyP8tIv+PiPy9iPy/IvIzEfm5iPxCRH4lIt/c/393//9BRD6KyKf7f488fP74/PH544dJAF9cLl98IZfLBZtuqterXr/7Dt9982v95S9+Lv+gF/3i7Spv/8lf/vnf/vGf/dF/JfKnIvLnIvLvReQ/NEngn0TklyLy6/v/34jIt00iGJOBlxAsdvv54/PH5493SQCXy9t2ueh2ueimKorrFbjq9eNH+fDtb+TXv/ol/vHyhX4Fxfbx7euPf/Lnf/PfiPyeiPyhiPxxkwB+fk8AvxzQgJcIrGTwFsiAEXH4/PH54/PHUgLY7whgu2C7bLqpQgHB2xvePn6SDx8+6G9+84384vKF/IPu8iVU9Y/+7C/+jWxffiHytYj8VER+X0T+oEEBvxqQwCMJeIngo5EI3goIwVMIPn98/vj8ESaAbbtu2ybbvl8u2ybbdtluSECA65u8ffqIDx8+6G++/VZ/efkV/sO261dQXP7wT/7kX8vl8qXIFyLylbySwe/dE0CLAr65B/9vGn0gQwRMMqgmhM/J4fPH548eAezbZd/lsm3YtssNAYiqiogAAkCvb5/k46cP8u2HD/rrb7+R/2/b9Wu9yJe//8d/9Ney6S5yEZFdRL68/38khG/uKOCnAwoYkcCoEXwkEgGDDq7CeQfyOTl8/vhd1QCum26ybZtu2yabbrKpQvXue1yvuF6v+vbpTT5+/CDffviAX1++1V9sO77WXb/66R/+4V/dgkbllQi+aBLBV/dE8LWRALwkYCWCNyMZXElkwLTMeMkga/P4/PH547ccAVwuctkvdxSw6bbdtYDbTfSZBN7e8PHTR/3u4wf55vKd/nL7DX6mu3791U9//5+/gkNFZGuSgZUQvnKowKgLWLTAQgRtEniTuEfwaELw0MJvf3LQzynud+53uG+X6y3gN9kul+2y6XVT1U27JCDAFVc8ksAn/e7jR/nN5YP+avtWfq6Xy9f7Vz/9w1dgRYngiyYhfNkkgzYBWHTg44AEMmqQUYQKOmDaiCIa8TmsfmzB+DnZDQjgcpGLbti2y3bZHjRAdRMVvb/dcYU8kcDbPQlsH/CrbddfbF98+RPZfvLFnAQeieCRDC5DMvju/vmD4JkEvjRQgKULeGggowdHkAHTYxihg89vu88I5UeGAPSOAFTlrgPopiqbKPSmCKreUoAAkCcSePukHz590m8vH+WbD9/JP335k6/+tA86KxFchv8jMvhiogE4JQm8XhfKqOAqx5qRPyeGzx8/cgSwbXcUoLJtim27C4Oi93+4v6VxQwKAvl2v+Hj9pB8+fZJvt4/yzfbF9lPdv/wJnsE2BogmyeCRED40tGFvksIXiSbgiYSRRpDNDZ6BDI6ghM+J4fPHeyKAO+zX7cb9t4tedMMNAQju5V+f1uAtBSiu1zsduMrHy5t8ePsk3376KN98sX/xE5FPAnm7/782o0DiUINXMkCXCB7/P94/e87AWUmARQWVvgMuKej9t1RLBp+Tw+ePgwngsutFFdu26WXbbl+rSvdfbnqAiuA23QcBgCugV1zl7e1NPm5v+LC96XfbJ/1W9y++fgXjA3bDYXV+MuhRwSPwL3JLMFYC+HS/LU8HYrGwIhwyNOF12SvgM4SgztdifP85MXz+KGsA2C6X7aJ6bXSAOwrY5OYIqGy3d5uq4P5GhABXuV6veLvRAf10fZMPb2/y3b7vX7+g+9v98/WOBq7GG7RNAlYy+Dgkhhb+Xxp0sE8IAC4SGAP/TbgVJK/PoJPBnAiwPKxsXfbbnRg+i3s/JAK4Q/4b9NfLtomBAqCickMBjy7BuywAUVyv8na94tMjCVzf9KNcLl/0SeA6oAEYb1i9g+FtSALb/bKL8/+t+wxXFMyswqiHoK4ToIgKqslgpg1qUC0QoYbvJZg/B/q5v4szHmPX7YEAsD0CX25OwEUVm9xag1+agKg+nxQArnKjAtDr9U0+Xd/k4/UqH7bL5YsewrcBBiMJZPRAp6TwQgWfjM9vgRbgUYGL8AvLWH2gqhesCokeUmCSwPsnhs8fP2YNYMO2XeSmAWxy2VQaXeDmDIhApf33rD4PTUCuV+DtCn27XuXT5ir8VmCJ2G5BpBM8/r/dEcJb8/0lEQMtJHA5TAlqNuLRhJChhEpSqFabH3di+G1AGj+W1/dyAR4IYJNNnuLf6+tWC9CHHiAtFhAIFLjK2/Uqn65X+SS67aK+3QeTDoy/IG2ogQ7fb/dAtz5vBgrYGqrwNtCHsVfgIvwK07OTQBURVNCBFpKCOjqCHn5L/67TgTN+fpySAC56nwSUi256kXsSuFGAVyLoUIDo8/Pz7fdoErr/v17lk162HbgHvFpIYDfoAJJfW4sGPjkU4VNAF8ZEcLmLhdc7kljdY1y1Dq9yLiI4IiRqcLujb138KIPn80ejATwRwIbtBvn1cqv+2J78/5EI5N4cJA8qIPcmwRsKAHDF9WYP6mV7VmrgLuTpxYTcMEW0LAmoQxFsuvAI8tv/a/C5fV2ZMMiKg++FCM7RDPRu8ebWY7VG6VJi+Bzk35MI2LsAckMAgwvQ0gC5DQjd3ABg2HQLAPpEAlZ1Bu7VV7MGHDFRAbo3VKsTbAY9sPWC/uvx86gBbDK3D1eEQS8pbAeSgSwmhepnJb6uBv/o/PzHLzxWA/X7TH77De5j6AGQi6o0CUGfCOD2X7cXAlCFQABtEsGLDtxuOyQB2UTQBKZe5GUPXgkUYCUAbZJRhBDeuq8xBf+bgwbehDm+BFQi2IJksOocvA8ysIMfxluVcRsY/eB3JzH8GFDAXQO48X/dcIf9jyDHptIigDsFkEe066tBSETQUYF7ElDdYEBytN4+rk9UcBPfrKaZqFHWcw3i4J8/X4ev2//bSXqAhwTay6OEIPLD2Ipt8OtAGzxkwLw9WVFRjTc/qC6H3+YK/b1oAA0KuOizHfieCLaHHiAb5NYTIC9EMEbZrVEQt1xwhVy1UfBh8PUOquMizwaap3tQXfY5B//tea/NZdfhsvbz+PURQTDSGWB87VX/7WSd4KxjUqrIgE0IUkoKGnhIvwvawpGf6eECXJ7tv4qbA7DJgwpsKthEmmYgfaAAffYF3HLxo0vwNjJ0SwRWMG4db4eh1gPNm18vQ+us/0eGmxDemu/fnM/X4evq/8342ksGHgLY5LyT/zg0wM8lcMjgGFXwqIOVFJBQw99eCvF9oZL9Mfl3QwAvIXDsBRC9R+fz8x0FPBLB0xJEpwUobrfAkARgIAF41h3wQgP6QAmX5E/7eI43IxGwwf/moIkRyWRJQIPgt9CA9b39nzt4bYUWjAlCjWDPgv8IEjgLJfzuaAsrv9VdVG4OwOXW/fdoA35qAdL0BDwvf6AAUVHd8LIEu94A3K+Q+2YxaB84MOH62P//qoo38fCRDERE2zf0JfmDa+MieElAjcDPKz+mRKCOtdgGtXaBjgNJ4H2owSpNeAW/rRH4CaHSpMwnBYYycjgSJwfie9CR6mPu20Uv8kABF206AvXlBMiIBPSlB9wjBW1fwEuSb94296VCqgMaGCt/G1BbExi3IG+r3a3J6P48Gv/J0YmEYoiGY7V/SxwFCwGoE/xa0AJ0CEiV9QPCJb1OJ5F1VTjEY2/MO9AEJvj1BJTQpqLfTlGwjABuzT962e4IoKnyrdh3+/6mzDVJ4PHOxj0JqGKoy20+wBMN6D1gLWi9NQHfVP5MEEPzjGYy8BMAOnTAJgEr8HUIejRo5xrA5xkR5AngmiSHs+zDDAmMgWzTg55GSJEmHE8IvWPAoYTfhWak/Wn/bQ0CGLSAjv83SUEfKp5q24LXuQICpzrjrgWoza8xVE00CQCORdhMJuTUT/rjuls0gO4Iby8BIEgK6gS7BsGuTtDrScH/fR68biUHNVGBnxjeNyHEvQe/ve3LZQqgG3rof6cEclsNflG9J4KtaQ8WHcVBHS1BtHE4QP9OBMS98mpbKTeDW7dJwRsnHpMBTFJpV4I+b0kY/NqInVFSyBLANbnMSgBM8F+Fqfxq/h657/Up+GaBnwV9hRqc9bZ/vA6vu+T9E8KPJWns94UfTeCj2QXwCHS9dNL8Xf3Ho/rfewSeFODGDV69AU0y6NFAE1DP3qK++rdB7/1HRxf86gT376zOr99T/h/ioBiXWQkgQgVeIrCC/WomhDmQK+hASI2ARQZKooHMLdCJwGEBBXC3+uERwg+VOHZ9ioAt9H80AI06wGgJ3nQA3BoCut6AhxYwgcPOFnxuFnrphk+NIKIGrWPQtgz3b0i7Y6D5rs1GKqTop0nQX52vmQC4BkjA+r4a7Kx9WLENGeegkhSETBCrNXIMdi/444Rw1n6E96ry7OPuj8UfLxtQ78NA2iSBbg7gIiIbdDLsb5agPhLC3RkYKv8NDbS2YGsatNRAG2oQwf9ZIOydgy1MAzBkAw8UwEEIDzSAqdPQ6za0PkeJAMH3Z0wXniUSZoHvBXU2mcjQgv56TedIKglCpIoQfgwCIjOytd8WgN0bfxoR8Fn9Gx0Aj5Zgq0lIZbsH/ibSJoFnS+C98g9ooHEELI3gliy25yONIiE6pb0NfBlyNEYyENoodkKwgl6I6s8kARgJ4ZoEfuYWHLEJa0LhSBXm7kImGeSfVdoJ1DO2G7WXsehAptupSOoyrCSF904k+6vt98X/ZcM98Hsd4JYIXhQAIg3/f9AAUYhsLQKAtkHVBnzjCKhOoYl2ym+iBtvzDzQ2DLXJ4PUmbJHAVnBQX4jkxfvHhNDqAdHXGQJgv0aSDGItgOseHIU+K9hXnIJzkoGlEKzNHagTdJ6VWEUH4iCKH4fd2AwDPaYBm4Wgng4gQ9V/CoGiuNmD04AQtNGMGzSAAQ2I2pzfogY9LRh7BrbOh4+D30sAencljFu2CUFrwY8UAWRfWwGvVOVfbx2uIILM0pwDv082dUTw8hYs8L+uIWiHGpWgClnAa1lMPJogovvvbePPs/q3Xr++kgCsfgB5oQF9WYKPJqEn6G+OE3i5AqouF59FQOmahQC8rlPLj38kg1c2f30vw+XaoIX24/pMGIgSBoZqoH3wo0sIIGlA9PWcCPrAtpPB8eBf6x1o6cHra+2+tpIFP4PgBfxZtZUJfo4qxELT948D9ucK8Mt9+ccjIQw6QJcEbrD/1g340ATuDgDkFfx6twSf1f9xvuBECYxq/7ythQQGm+5JDx6Brw4CkMGT3wgscCUoQ4sU2t6DR2ciBjTgtcpenQoZVX9NuL4Owc+dVaDursYVkVALX+shjSBKBuvCYDUZjE5BdNkxdHAUBexyHwB6NP7Iyw7sxUDViwge1t+mz8B/LAvVx/c3PeBBCToB8IUGOgqA3iV4yUg6UAOxaUFHDx6CYS8SorMOue0CCJGAf5YfRhoAI+A1CvwxqNkAY5yAIx2EQmkFfeWOXi+nEdSQQA0ZHMEItiagJArQxDXIrj8nCfQi4HZPAttrIahso9oPQ/2/JwV5JQU8zw+7I4D7/sBn4EO6rjw0FR+i3Z9fHtahzsFvJgM0X+tmVH5vaYiNDGAigewAz+gyNLThnjCURQFR1b9d3lZvnVqmj9mEPDKIUIC4KCCjBXywS4N+otp/Hk3QVthOkwEKlV9PQwXjT7s/zwF4Qf9toAAzFdjuaEB6S7D1//U5FIQu2MevO0rQQH8ZmoXE6B/IkgE60XCjVoq8gt2iCG0S8L5GdxkM1cGsfsCMArSCAnrr7dzAZxCEEpepvB8tqHJ/q+bmJGGts/AcAXFOMMeTwC7Pw0B6CtCtA2vWgonqBQJFSwH0JQK29OB2kvgj2HHXAoyeAIsCQO0kMNECAhFMqCBf8mElAkyBbX1tJQP2RJ/ha0gpAfS9l+/5n00CkrQpq0MZbOdAuxmMvHswog62jZj7BnYQe19b14kxNq2D/ehX/p68HEcF+x3yP7z/V/A/q/5DA3i5A/dzA5pdgbKp3v3/wQF4Bb70WkCTHGRAA6+KL0bFl6FJaFw0ImZwm6igSwbbwPn9RMBWf3sN2JgA/BVh/Rg0kQBgePf6HglAHLFQwqQQOwDjbdVxNZjR4iM6Qa3WxwvNxh0JFb3g/WzFQQS8b/ttKcDWoABtUMAd8j9hf0MB2uDXhzX4CHj03L9DBU3Qjz0C0l4mLSLQPicOOwZoVCB6P6dA7nDbGkVuxcNr8PU2JQO4wX5trEqmccZaHU4q8oCDFOpzAnOwqyMIMktNNNAHouDGxO37DgArQZzlmp/14W1QlqHTMaIIx7SCx0+5yza7AKJ3IXBrNAHVDcMZAU/BT/vgv/ULPOA+XiLggAREDF2g0ci6xNDRglegd7P7TWWH5oJfayliEg7bScQRBVgI4Ookg/F6rvpLWP29swREqA3CaG8/FpKqS8DTAV4TiBqIqtxfzaQRLys5I0XEFIFrPbZRQb+16Fgi2LvJv8EFUPW1gGfQv1T/F/d/HBnccP7rAwnIIyHI4ArgWeGbU4eHy6Tx/EeTZIb5bo/BsMBjmjBE08f/RB0PHYBd9eVRAGY7cHRwiBf8WeCPHY1bgBTa9xKTELzEkQX9CPtl0gJiqsAmCT7I8xbjivh3JGFI+D2nBcSJQJ8agDX+O9iBL7UfG4bzAkcaICrbtYHz1ycSmGmAjJfL3CMgT3tQpmrfB7gxSzC1DnvdhQMieG47u75+kTouKNkM8c/+vq/Q7ZYjO/hhVvRq8F/9gGfhP8aqE9EIdR6LTwJ1h0BItyDqB8iFwuNqASscRnYioxOg9ApvnYA35f8e9Ohbfe8J4rknoFkO0lmA2gmAG0YK0DkB4ieEjiLoMD8wBzom27ANZkzIoU8EMHk/uo1mzeVoEoRWKn8L/62EYAX/lsB7D/LXg74uAMr9oGivJ0CNJCGD6i9DhZdQF+gtOp4S+NODRzsDVbhdgv4BqTMNyIL9SCKwL9/FGPp5oQKxIf8A/UX6r231H7YIqLML0Ae2GtrADOvRQH5b/MPE9dt9BGLNG8jVTAQvIaK5TtvvvWQgDvyXIClUA78S9Nfg7VtIBlO7cbsEYkQDMot+ygQ7QwmOawTHnAM2XUSnJvPIYRYMmYPS+sv3J+cfP3d04JYIXsF/EwMbBKB9Q9AY+BiSwFj9mzrSXmcJhFPVHySTbgHJCPvRQ/z7G/SVUETsg0ZF+i3CRoCjhf7y1A9mOiDD7TwdwEoEXjLwAv+avLE2B7Jnb+OqDpBoAchoQJskxKnss0vu7Q2YhcDv4ySeLOg9GsCKiUIihP7yfW7zbTsBh0TQfN0iAWn9f72Z56/Ax9P7j5OAH/Qvv3/QxKfk0DgDuP+R3USg3bzBC7bO/QT9Eeh9QvDPG7glBQzJwK740lAFFgFk8P88CqDGAa223YckWYhr+c0BPdwetl2ocnsfzePAWcVnnAIp6gDVhDLyfV4nqFEDPxHsbWD3k4BDkN+pARqKMLYBPzYEvxp9xmCHQQdgWH/9EtH2TIFpu3AH/cdGydv1j0TQbRrq+D/mLcX3ZACZ15bF378CG0My6Kq/zoGOQwhASDFwFbxyNGBuSxbCEhQ/uEPe/6gAERWQObCVVfjPpQX+rexxYhYFxIkgpgX7Y/vPs+Pvxf9vwt8kAs7i32t3QCP+3SPaTwIytQXP38u0PESm+YER+o9B3vr8mETAUfDrEkPI80ck0FZ0dXh9U+HRbhey0cAc2H7A4y4egoD6y8JfkBiigLdFP8v2W00E8deT2IeAKujZ/QAVKpAtKI20gLWksHedfgPcb+0+NEHefd9vB9rayi8h7J91gBbaw20MsnWAF5xHkyDUCOoXp+yrOwwxcKj0aL6fFppaaKDv6OpHR5sgx5BAlK/+fYhuP1D196o8e7lFBaKqv5YIMnFQpd0FGVR35RJCnCDaABaXBtgbiSwtICMtalKC+1JQ6bx/PLcDPQL91QFodQNKpwOgF/9eqcBxBBqRcKAAVk+ArQOMx1RYGgB6naDhlK+uQQwJYx4meQbxtNnYQwMjt/d4f3M9ZE4UOld1LAh99fbfzOxiEkKFCkTJIUIMUeVnJ/9sDt8/e1NEJOi9oVHDGYhgnSLss9DX2IAqw1zALUncKcDr0FB5NP+0cBQNrEezDiyiADPkt9qGpwoPdL0AGPx/NOKeyf3b9WJNdfcFv6bKd2cLMJVfJ6Y3B6wB9WFUfWWEwKMfGiQL+3bz9XGQz2EHKhF41GCtZyDi/gUCsNhYoAr3UNJ58YidHKqnMb/6AB5J4N73/4L+t7mAkeeP3P+1LNSB/l0SkMEd8DcEuUlguEw6t2AU/PCE/q++Akw6QFf1u6SBrj1ZnnhG50AfkoGIdf7gJv1KcSfgzWWkQ9U33Z3tHXYASKJ9e/YhU90rvD+q9Ej69/wxYJVs506Eg/r3DkMDzEdDBRGgcZay49XihLA30P+l8N+hf1f57/0AoxbQbwYaan/rBMirE9Dk+sBzTkC8JNDEUlv5McB8PP19Y01Gayep+hC/2zvQ/2HGLAurowsNGlA1cnqGGzeH5weiYLZm7h3QQC4O2tXdhvMMk1ZS5ebpgI8eMrPvPGkwaxayk8Yc6PMOBPEdC1XZ+2UfbfOPtxLMQQAG9BcZFoF0gp/RKjxe7+oAw9T7ZPWhgedodgz0gf5KBtrtIZhQAZpAV1Bi36w6t98qVfH7hqGI318lLCjLCUFlxRHwqYEH9a2qb4XjWvDT7kBwfbZA5P0+PNuRuW1yf4yNQH3zzwv6b70QOJ0G9OT/dhoYRUGT15uQH/71MjQLtQlxfDuiCXrtM+SkA+icQdH6sU/xz7Ze7FlubV4TpoTQ2osdpaEjtqADmEU7OkBEFoLeC3IWFFeswJXKXzkboNL+wzcFHU8hTGKIboO7CLi1/P+5F+gydQhuvRbwEgxvtACmANikhLTbj0gCYk8KdlYgmj+4Ymaod7TwahwadICuX0Cm2fE5iNHPK0x/CDV66Kyg1MnqjNFBnhBoLQCgUULfaVe5nq/6EQWY67bXCszUb+7232fVPz51iGB12owK9peyP1T4raMFF/OEYJP792mgXYfZ04GHMAhBkCSmSj+dKqRPgVFGHbpLEGMiGFeQWfSgrY52VxaeDUPSNJI0P7NoisG729HHl78z6hxfs9rV3m4JjgM/lsui2qmThjCfDFSb+I9vwUqG5wwL55U7C+6ot8B+7N2o6r3q37T9trfpjgmTvv7PSQATLLeRAOZhIJHBQfDQQJPBdUwEbVW3+L08EcEE/9G4ANrCeWcnPKRHDupbNynMx5AA9IRYLmrc/YLSiD5EaEBS/s/TgnU9ILcH19n+CpHwegLejx7Mn/d25fdN+e9U/1vgb7bqf08MOtf8EXxaoh+GY8L6gDfhvs4i6HQ7seYI2sv1GchdMsBIG3xlvxcCRzdgCPTn+6q/TW00VE8Q9FaFv+R2VlOM1vm/hhjhDCdgNflVKME5B47I9xT8z0YgPAJ8myb/LqHy36j/Mwqw9AALxuO1JVjiuQAYLcFzIhiEPe05fk8tRjGw7yWQbsfuLAT2VqOId1osnr0F49VM8INACPHDoBz4B5mqqSnUgyh3ArjXxfQH5BbgUS8gP7aU+w0zHD9GGD0CGHf+P1p/DeivlhU4BbxR9a2kYFR58YaDZCUR2P0DMmgED2eg77puegy6PgDphEB0CwlG/i9d+/Hs34pBEQrBn0W51mqGnJAk3ACCHeiqkQ1XFQA5AlKH7Lk8yJKWY3/nym14h2C3JvxeMwD9ZVMz0BPMi1n1RbKl1cYhIVblF3G0ATsRiCMUvoK9//OgcwYMoe+ZKOLlC6/Xk50br9NFz9fanqA8UIYSpCwlBO4kHc4WLLBfBHVaKwKgLQjmP4Un61Vq+3s7Bsyi0WztmLjJwJwFeE0I2vD/1Q6MVwefxfUf32skCPbCnxQqf+QMPEUDHZ7vGeyj020JgkPXXwsldA7SYR1RE3h94NvNtugswcgxXEkIcBPCGZ1rmrgDC0A4K88nm2fn/eTnpQtWyZfybRoK8Dro4zYDIMGsf7saTBzvX0SMbkAD6o9CYbsfMK38cJKD9l2FJt9/VGs0h5Gib33pxMKWNsigFUh3G2un+/N1WUglI/EEx8fq27vUNnwsiOoKecL7kQS8VnWAGCFUgn6dBtQhv40CmIYggwK0uwDHRGAuBXVdfwzHUjZzATLMAoyJ4FmBhzaWBlrHld9CCWpPHRqofBqMReMGTJ78q9rDes1Tv7/0m0v0AFHXNR6P6g30SHivin7V1BOhh3iWPwvps/yE836L2XiwnUT8x2iHgfqhnwn667QHEE8oLQjEvtEW7GYBZDrDVkwNIO4G5GiBDf9fGoFM6n+vbEtzXwP6u9AduaWnGYSLAlVdl/AU+ikrSeEIKgwdaZ4AACAASURBVKj4/wtgHcHtdO2nWKcBkPfxcvnNQvsj2Me9f02r76T8q0IBn9OLKfz1HX8yVXQYGoAB/2UeBQ5/5kCL6+H/OGGoRnLSwdd3oH8r7KkGTbgIxEwVWvnF8KOpHnyzfF9Jod5Px+IF1h8owyitDw/XEgRb5bPqbt1uvn7qBIQ16vtS/u+DP3cR7CH0WWJgd5mTJKYgNzoGjQrfvu99NDBC+bnyW1x/qhTatv2OaMKgJWPvv5kwnMgxHYGFRtJW8VMl3uP+MgoqSZyWFKr7+KIDw1d6+IiOgZI4+d5iYL3imzbgyO+tph9t2oSBxOM3ugHtPoFZ1LM0hF4kXNEBssvVgPdjdXZWK7uKvyS3q1Xb1WQwtVDqSUggq+Vw3t56JA2cz7PXOwGNW1ecwxPhfe3QEUsDsFaAz8jg0nf+iZMAHNg/XSazDuC18Iq1HBRrOsAQ8NLB+16g614jmuSgs3bROxE55D+WDDQNA4ivdMJ9M1b309UqknaDU8ObV9/PwmMPATvTMAxpABLBzugUtV9bLdhNDQA+7B9tQJ06/7QNDHGSwtgZOCIA47InIoDdROQGtt0U1HI3GaoUnCnC/rzBMQJteN17+VaAzYNA7e+PFqHQUyXPUYB7iQYa5ZFjq1Zqpx8Uqu/XT7+6BWC1Xaj0GlBIwMoHu7UzcI/6/Acb8KIq+hzmGWmAYnADrIpvKP7TZeLaf0LAeQkGgebbq9FToI44p654F47tekKkI0L5PQNZPsDwPBpy/ni+wKMN76Vav4+2cFZFf8+JwAraMt0DFB7beA/u4Zz/a+RXx0M/ct4/jwaNAS8G17eSwmta0Fhx0VRxJkHMivso+onMXr+YwdWKbgioy1jp4x4AzIKg5lEA7wvHEYCRmdx11TAuT6lDLVl4KvXkAET9P4RT8H2u+lg9EPQIpw+/NpJ7RwE8HaDv/Mu4f3OdNkq/EfAiEiOANjEALvcWL9gfFV4NZbgbQc6qPky4Pm35QZxtH1f4j+P/jXuaYPcWwIEH/fmEPBoAO4m4LGxV3txOQqDU+dXgey+UwSzuqP++uImO/u/6ogCb7wTc1n61sL+vZi87rxnrNas+giTg6QLzaUCjIp6JfhwtGI7AjBBB9JjDY4ePYVR6ZPgN4owVv6Q2N5hhVHwNeYrM+w6dN6K1sMHZm/Ce7bHe3dzKr1xw1w4JrSQMZtgnoQHlr18fzunAszD4qurNUg/TDqzx/lfCaO6t4tACMUQ6P6htWjDPC1hCoZ8kpODzJ70MUR9AODcgwyqyPhmE+wfHYB/hvSqt6qeXUShhXH+d9SR8DzrDaZZdpSp/HxqLMQuATgDU/qDPRgOIeT8cvz/h/XC6BtE7ACLOWPE0KIS4UUjmZaJ2grBphiWgT41BUVWZfP3AnEIT6OrfoF122l2rMycBoU5i/OXoUZ4/aglsXwLzHNU++FVF3qikOj5HXm2PBitT1WuvJRAB+6O//W0/PY8vQH5IrAsMs/WuVmAdHBrQgrbOxJShXwRSsu08h8JMBpo0+aDTALwV4tbswgzHrftG/dJKIAQb5h9KCssWIMeto+GYqG12/HWGjx8kzqNJaa0noMWOr2KwW01AMwJoNvhMQda2/RKQP/3ecABM3g9uD6BY68Ntz9+nDOMb5iV+hIE+dP/Zs/wwJhJ9mgBnohBuStABUXjugF3hkXF9ZZJAjefKdHZCc389LoStKvIl7QIEb1d9RyciQgFDI9Cjyccc/23Aam7/PZJBhgDgin5CtQvbCzX8ip9YgIFtOAt+w0owp/hOiCWgEGbVHuYjRigPGR/YOnEoqPDoV5z5YqB3mRq2ox5ICmSSgAP1Ne+XV2NE+/vuFbCTRADxtS70VRBCjgBk2OyDUQiUgfl77b7DwaHm2rAZ7osRSOOUoHgKfNBSLI767+oDYrfwZvqChSpGfj3pFwZFsCJg2jeIQQBUiyI4WgD68ww4qO8khuWkkIuDrxWv2nv+UTBpJYiPd0KemTA8qqFiuUF1jWS3BoG6pADJq751JqBI0wvAVPyMQvjcX1zbELltKK+zBiXRFiRxG+b7q3M9xuLdzR8g0gCGNzSM5gNYfqGO9CBT8OHct6oB3KsSDBisUnwsFuISQaRHxDSv0vptt2oeLHMERfRn/FG/Cx01EpgIQG8LP+/i37PKw53xn6sYCM4/JwSRrCnIeB1ZkLsawDhaPKv/njU3wnZ/dBdGE8+YTHSG8+ofGgIjsC19YnwdM/KAnTSsqj6ig7uGgIPw3nYFzhhIIvriAxFP9CQd4HSlnzgxONIdrE7A8ZDPx9fjib8ifgegNIliRgdx95+E1T7+3nQVNNhEzDgGA3T2rEDLduwtPpuuouPcs8swwXFjdTaMKt+jA5gUAQPcf95KJQxYU0cYxEDvsBSmYuukp7AwnqniC9Afa5z8vboI68ImT0t26CvwBzSggkj447r9IojvCn7U92J/Hw0QSdwZKNNjxPCfSxRqnATkdwpOwh88oc4J8KTSm/wdbZjrc+4iFP8YO0/5JJDCfaijK5xVXevqfg6zGRrQf83chvX4aRfAE//6vv5+6490U4ADdO7QgM/5bcHP/n4OtCQhBEFeDWSvos8DPq8/IwzLzjpa8/U6MMSkBklDm8e0mn3QIY7XG1Om8wzN48y7HwhOK3P0/ZwUQHHv4psbdoVeb9VlAjChBCdtDDpOKTh9ZfcagOYq31RFjN4/gwBYzp8lAwYNwBELhZoxECeZxMlAzWGdCRV0fQWGHo8+8Kx+AAxnCIzowAxy9KvNepWfsfp4RR9kUrD88CPVTuXRybhqqTHcnxEGndsgub1Gdug8yz9fHt3Hpl57x/mfCOC29FOSQ7/noAZR5W3Ob24UMpuPYAYiQrQgk1gnFoUIKr4vKFpV15pHUJO3Y5rfH3UFHU4bGkU+NKJ9f2hJyOMxDBDpjAgwiYqvk5TqNl9EH2Arb6fA3yaA4cBtPWewhkEcIQJBlGzYp6zRmr1v+e3Fv27xpzvyI44NGDkCIi7CGNV9Dw0M8NtHC2vUwHINumCGNG8erxOwtQINsW88Tlwdoc+F85nI559ngEDpt2F/Uu3hiXYrkN/pBFS26hYDAkFgErMK67y9mGBA3L5ore5izf8b3n805MOq/t7XU4WHv1DUF/5gugCSOAIW/59uMwl6CHWAib8bvfxWl9/rBGEMTTwDfG+ezEYG4yk6FvRPuPwE+wvc39IRjENWM+/cm5b0W4Pf4WuKUnw/vD6eDbB1ETs5vl77Dhnm/51g6wPWwQAqxnivgQaeS3gy/u/1H4hpTPrIgHAN0mSgXUX13YP5PMIuQAfBr/f70cdeE+QoCX3i8nFMLcAjInBoAIYqt1LhC1WdtvmSab28AYffaeivCB+ohdYQgfUa/WS4ToMsNLHLc9nnvPZLwn1/EefPVf+U/xvnCVSEQEkEQEnEQJO7S7RvYDxNeNYKrG7DKMhtsQ8cMmhgPKKKj+F7CiHYFR5KIIPxOmg5IVAtu3ACQSPh7CzUQOgAej5CWEkIe3vgxz0ROGO//qYfz/dnLT+ZxDr4QW0eNCJBorCFOVC312Ec2TiY5Bk0cAaQmiA1VH1MOwDHQ0kHdEDDf+2UTWhS4Z8diQMicLx8MLBfverLcP/jQzF0P8EJj5+NGK9RCz755S6F/f1+X/gxeP+Wsedv+vF8/54aSPJYFjIQd624MDz/UDLQnr8HU3ztKHRf8Qeno1vyAQJBaLcMtTV3cvgP56COCqd/QP9xLgBkH4BxO13n4hNUDtACC6G1S3zqooZ6Ba4lp/zcAFb7iERKQwQcF39IFJjdXECGADw0IE4gg674pYAnk4HoHPx54tD5daO5vxrugSkMjgiiqc7TVKAT6AT8R4ckbHEQCYR/IZBxJgA+XZjsR7vaoRpIxWqeqfXuGC2CxwudicwePEB1kNkaZCuwyF0DuKv/4sz9mzP/Qxdg3BDkBTMC8Q+loD6UGBzx0Kz6eAX/KArOQTlPHFoI4vVtf4rNuLrca9edRn4xBP7k8w+9AgZCgBfEUZWfEs8iFNZ3UO7TqmkjCO/rWdgco/yIqHcQWaC2EGTzgz5y/iXQAvyx3riyxxV/JeBriaGB9OrTA5g9/eokM+37GszqfA/UZk9iW5UnCtBqBl3XoNN6Ag/+zy6A5evPAp+TIFDn15gQw9rjrOzFX0s2JBVAxa/nP1a6AsNWYGjPNGPLTQgBsNUFvOA3Ht9o/rGDN0tWOCcxJGp+f7++kkP7PxcGv1+GjkaLt/fawpwwerQxBJNW4b+PJsYEgiAYYdEAGIlDNaAbRkIgK3ut0jKByp+8yz23X6GttmBmjwDvChgiYLP5V/zhH6/110sGcKo5CkggCngxnIPoPja0j2B+1BRkiYJiviaLJqghDI63G2nAgAxMCuDdnoD0wIQm+urMB3VuAwbBrFGgGgnhAFqg9+ujKsLxB3qGCQNEEtPinIQlAj4WgIw7/iXc9V/x/yUWFs2KH504bAh4aYWf4TrTLGTy9YbftyLeVOWNfYNyt/ji29mQnqMAltU3ioTtbX343yv/1u0YPUBz6zB702tQucnX0gWaFh6DgPdmhXaapGotw0SFz1qDiTMdd8h45HfcqCPRUhA3+NmKz1l9teCPaMd4urGaewRitNBDdahR5c3AfQmDCFT9vmtQEwqAYXX4XI2n23Z9B/Yb1FL+LWox6wHGbZSo6FR1LzyG+3hriSZvWT6jfXhl2cmQZJDrAbuYAqAHo1GA/EOgD8eGcU7A8eDvH4fQBuAhBL/Zp/vamPTrRENDGLTV/7E1WEPLDlP/PwzU4YhusIMUgfIPAr6Dhv5R4y2r8ldFwiFoYHnmr8TAHbhRQSZOctH598ZYhqt6wP7q/ouqe77RJxvzFYaji/z4vna4v5cUMDXqDAJ5ytktqtBDckyjvJg04hl16LB0xFfyMfD77PZjErGQRRjYIfSvoAXntks0ok8MsUC4KARWnYPlJBeIgLeFrUgDOHYCag0/XNAbWgRwQuLAsaQwIhC1g7+jCNKuT38JfnYSyTi+QQEwwHeT4/dWHYxJPxfOj5oAnRQqgU3YgGZSOaDyK3n/qkDYBKptzR3oD6B4fyRKjp2AzSl80YR/3P+/1vBjX18Jbu+YsrMRgbqPP8zrDLTAaupphfeZtyPs9BPztpLSBZjowF3woYRwBwOWaqbev15b7X4RWsiqYiY6ZkFEIoUwUA2OrkeEQE8HYNyD/rl3m88jCGgO/nPW3xy8x4Q/HBcM1dYg5q8N+B/SBSYhtD0EY1PRGLDoKIBHF3yLz4H/gSYQJRETgqeB2d4vC8L2NVnQn4PoVJJAcP0inahAfdXVI8CFszjRagCTtRdV7Sr895NBpRKXIT64RMFw/iw5eChhEvmmyUIH+k+Qu3cLzOAN6ILlFvgWnx3YWFDz0f38ze9GlfP6UQ3ojEY0gtqRIEbA5/WgQFhsEuIeL75uTzvqHktAWfj/OD6sQXssROcGiRgFn0QVkld7OznMDT7CJKzhMIqxW9B+LCOQdH4uyxIcE49VTSeLj0wKjzcp2oDXQA8YoDEGBLMW0BJw+eAxXejPV/IXd59/tp5rVyYXDw5BlRetSpQAcvgfOwVM8ObzBq/AQ2wX4lwkQV3vNhYFfn2LFgaoDU1ogqsfqGkJYmrj9Tr22KQwBLzbLuzDeA9yzyJjVRfwegWq0H+FThDPA6ZhZwX2M2Kh4waovCzAWJTzD/qY00c+6PM8coz08VNqglzx54LfHuTJK7z2rwX35ABLg1DzsZ7Qv7l/f2yXDlbf4C/irg0MJ0aCuD0wP74MrxfdFlX7tq+vtRdCpvt599EG9Yz3V+P+Oj/n4zLruZHcJ7oMt/MNp9eD6HEeFb6/TMfbWo85Pb79HJo8t3371/PuIAZqMvjPC34nVV6ZB4hEuA7AzA5cfU0y2n6ux89D/35/n2/vWY5Bf0qwf3tPLISO1Tap9qzFB6eap/beqI94NCCbGwgqOItY3CGl446CaQ8i2Q9g0AvmgJOnBoAA0gu17tsKtKS7D4udgCYERy2QIceCX/P7mBW+g/7D9S6Mn50CS0eAoQPDcBjopIA5+EcxEjLweRjXq0UbLIjcBxsGx2IZvlf0ATjz/6qypAmY7bhrk4ahsIis6ccXKHdueAfUgk+RWPCLh42c6zEeKyJpRTdRAOqBbl/Wq/uT+q+Fx3FoTIuCzc6+hN8j4veGjuAnhSE5gKnco3A3XwYlq2sq+lmP4yEOpqEoG0M+mGDYuYT0pKCFHgLHKt3T7T9p8GcWH+n1UwGa8X6kQt2x4CeqPexegT6o/Z4Cr313PHdgrsS2ZReLfpKIf+IMFnmVmwxQ9AhithYT73+p2s+JIVfrjwiHnpAZrSsr9CMstQXP1+1+510N/q8E/YoekMN9OMFvi5LvkRDsy9rgFCOoPdpgaQIWBZjf5KCSQszZJ1ivTvLokpen6tsJAVND0NFqb6GUGg2Im4Dyx9Pn7/0dm4pADAslJzTv+dKNrAPQ0wyySm7bj1RQgbAXsRa4R+mBJzpaQmHLmy0BLoL+Nh2ZRca8uUc6P37k97n451fvTieAE8BdZ2ItqFEK6oOJIYPsiU4woo140Oh+H/UC++gatHYcOFT+2y3AYvD1rM/fpxdUcsAi70c0OxAEP45X/hymE9XeoC0zfYhbcqfbhs09HpwnKMDR6g0mmYyKth/UcLl9ITGQ8N1S6s+gA1HvQCc2pluPvN2Br8SyZyfyxPP/VhCi1L1HWX2CQCuAE8TIq/sBYdANZmTIwqq0sb0HIzhhugBeUpBZLFyA8y+EErsBUYDZHYN9QAAooQwOws+uQlhdESSSqk5Qsh8LSYI6LDS1AbmOvLlRBqQIeITvM36+TP63VfE5hFClCTr9zEyVFwS3STQBy66DMHB+PJWIrfgGnYBx2dTboPa2X49GaBVlePA7CFx4iaGi4ns0aLVjMGvtPTDtmO4XEE8E5Kb/8qYai+NHl60LgAICcUCoJPVeiYG6Pxw/X9VFNVbFn9FNPzXoIRDTyzcpREYB5Fm1EQQn3KRi9wKApR8Tz48SwxnV3qM0q7ZhpdKvr0zfY+gO4oQf+EGPFYW/Xf5hwWsUgxiBbShGoGIx+D2eH1h2EeR3UQMH4zMaUKr4033nzkSkfQADelFbLOQCalxdxvN8mInhPas9bxtGJw29Fx3Y8429MAS0fL33Oeo7qFZeiToCC3B/VSNYuU0fgDnkhxGgMFdxiYEY7MYel+OHPH30IMeVFK1C79l+QdXVpFqHlMAXEf3EYDyfkkGdNvJ8f3RAXU0jpgM7jMNA5yCrtfzOicKG/M9bgEkEjqqPPDEcDfqVwGZv6zcO9avDfOhf4OmLFd9OLBHHdxp51HvOBlnAoQksYjASA1xnIhPsapTCPjbsGB2YevpPpgM73EYeSYIftgPgte6CWesVBB9QEgfnWYMgoeC8ql69bWoRIqYHvSIv/u26bj/jdqZ9KSGk74JRo6QS9PuTiSHm6Z62kLUGH0UO4rwWrhtRETkR4iKRdI8giJ2D2nUCMjsA0TXiVDb98NAf/rCMlajA9wesWHZrAe1dlwRyVI2jx4KkyUHSx7YDe6YD4tOC6XW01puEdAJwaEJzf1uATHi6ZlSCpBQscsh6C1xRcWEG4bCFeKcAVhVlDu54JQIkTT21hptIT/Afk0kMcS9BKfjBJozcDXCrtgbWXxbMAw3INQIxtQJPAGwXmYaBbYh4SCsuKwLOAQ5awKskCMmRg8P3xwlBfbosQaDqyZqBkyQe1CLQACoTgN4qbyHsPwkTiF2pYaj6MAXBmUosQHnUEYCsBL3MW39SNKMJ5PfoBsT33DVJCEbFnBCMOkHfvj6Xq8uw+dgRIhGgAiUqf5QgKDFyhe8nnYrlqn9sG1GoAfirubygX4H+8IM1CmQrMFAJ5ExzKIp54nPoVU2Auh6eBShDlTV4u5c4HE/fVvjFrsII0Ik6QX+Iq68jB19ziLoKC27FYe0gC+j1RSS+BgB7AvAM3m8HLdy5fV60C8RMVuhD1ieQB32MCCq0QPJuvuw5IHF/geMKwOPdpmsxBwVEfGEOgeincJqNmuSFIPhPq/xM81CWIIi+gCFBqDX3QPYd2OcCRo6GZBoA3AM+00aesAOQ7/2Pe/vBCXoguD4OBD1WfPwClzcui12AuH+gC0gEwW72KfjBCQRBr05D0IQc7N8PzOCMehPWK384MPVDJQim7yDdoiRTItzzFV/ZOX9sYFetP0fsQzb6O7wOoFjxk89YoQXv+BmSN+yYHYO+BsDRAXHhuJXsEFbdIEGZQWUkNVNzGA9NZUVBIQL7jASR0AclE4Pb7JN3BO72mG92+o8UG3nybj+mASh0FsLKn9GPxDrEcS2Au35BzHO1BksriIJdpqWjKR1wlpR4fN977rZqI+XbYjYDgVDpcYQalOYKMiuQbB3G6Pu/HlMbi9a0EMkksXtjvvXTfgMKAEZRN/i/O7yD8Da2S2Bdh3ICWfp8yuMkYl5a4df4vVWt4UF0yyqEnaT6swYyWB8/j111Y1ERS9oB0SLMtBGDEBD1PEHwtdjUEAHnqmoHU4wCDAoAS+lHwtu9eQLUAgmxVvAuMB9cELMV3m8EUtcBYYI9nkNIEEJYrQeUHfnzzRyC39j8CgSkir/E0P2odnAmAqDnDIhqrtV9BDNS2POjv/0pwKr6z1h/PMz3uf9ykFYq9TtoAXSwpz0HljdvBCVAPY6t7osv6gFhMpkX13rcfXQMIpuTsfTibkfOPRAC2meLRipI4mDPwMD5x+v3+Ey+qEfACwoUEkKQSMZxYJDz9R68PyP43yvo2aYf881rNQbZgRU/jp80QnW/hdXqJxMvCFxXQSNHpE8QiF4XI+wFfQcw7VL2Md7RRajsKgh2D+6SLAKPF356+/7yXYBTUgFy/38StUjFHweD+iiHh8/LV/i/TSvGk4L5x7F6AsIKbgb4C0YjgdGRIToGUx7cgS3JKP8pRcgak95BJGQbjaJdBYQ1qHYnYHL8F45QgHx2gLMQ2cDxBD/4SeR0LSDi5XzPQNjM4ySE/HGG6g+ugltLNSARn281BPtNO72eJLjdX4ITSEgpQvJYFEUg24f1qAYQNQdxx6Q/RcB85j9f+03zf2QV33IDPHegNgPABTfqFR8cZK9TA7/ll0EQbUUHW8Gr1d+MSadia+LRHwhunv87yWoJ3h/pRDwJAbDNQQFd2P2mH4kP/wDT/ZeN3CK3+ZjvgVpw4r20AMafb58j4N1UMknuj6iCx883PU9g2VHVH5JX2eEcPghSgRBCKPzK0Q3fknwPN0Hk0CyC0zBkz//7duEetgFjVtypASDI4CsknYJgYDhqsBxxy29+eyxrAZX75EEf8f+CkOcijMDDHx4ASYGGu8WHgPwpHJc0qOG8FgFTuVk0cRZVePFwHEIUEu8xSHoL5qWg4I7/HgOKXe2dcnu2SSdCGIDTA+AcxY1zYL6Q6AAFu+/1GvjKPSeEoJV3NiM4Dz9C6oWkEav+NWjPWXNOIkKgNTi2I8LeBgaZHJxqrC4oNXoB9pzzMws/OW3ghSyQJgjbygOVEDhoj4nHLld8HPD6UUMFVLIgKrTL7cFoBRLQgEdXIseZ2/HhFPKbk4d5tYWwwR0nIFQSD2P5gQhs6meVfB+Bkyz2fOIvX/zxqsSODuAGIOLtPNnmIPCrv6Kqvgz3q4tCwNl9lWYfnsdHj2HTgQw5IBHwULmfSu1jEV3gDFSxTBmqSEVqiYK2IkWcRiAkwV/cyW9YhqHXDw9dkNQAcO6HFNJT7oChfrPUYc3KY17zAd+evAwF2w5SCKLV4EuCEKsKfjBVWHu9Q9Arh4CoBqEMWYBsNX7YgKP/69uC3M7/mOOz232QT+ox4iCyJGEFP4oBHd+GVvXBwX35nqp7qeIbV6L6tdZub3ueJ+gBIKgC6S5gOQFxDoGr+Bv2nzqbknd7ph/EmXzO0o+kZdc/wqvQkAOUffVMzKtYgx5Vob1/+HAfCdzHSiXHenX35/2JTr3KZ9Ruj2lYiMhLIFoNyMq9hFroeYMTE0bSLbhb4l3YlFPa6hMd2jk8dmrDgdQCnC4/+ANFlYTB6ATlx2GDGXP1rvL+SnWHw+cJes5/rRWt4H2pw9GklD4uSMpwasIQiaYR92gIyFX5S8dtRZt/nCAH48VXW3hRE/HKOsGquj8EM85Q9cfeAV4XwNGAlmIFIwPYrfLKuxV476RRetzcdeAsRSZhiHizCKEIOHn3EMOWy5X4uIJnXX6sFiBFLaBm/THOQAkVJK9j6TKwiSDTBWpwHkSPQJX7U959uAkoaTUuug6oQCBz1Zlxm0OJSIoIw04M+7zCGuYiznCfHww9AN6Ir+HXA7lfn2oBSJ2FOOh8SzINfmcAyITq8JX/sOMPx6A9LeYtVfwgCBZhdu25OB9/XmWWNPUEPD5dUuJ68wd1AqD2+w1PI9KxE9BW5t3z/igdYGWiL7L+wPv9jgVY8f0ZcbCKCuLAHN+c5wa69Zpr0J9t2KnpAGzyiAIPiFalJ8/xXrrA6Y+/8NoDnWCPNwFJzf5DpVkHte8hx76P+HU1+HEytEeSEIzAsu5r6wPJGu6oLz8VrKofXLce+ywIHhNa/Dmw8LrptWXZ4NKZm4pr/QQ7Qk8ehMrPtAF7PQCD309QgRgRZMKgAbFREAfBBXNalbHA9cEHMo4IgIUuPjjBWEUFEQpYTkhVO43eRiynJw9Jjj8TOUIlJExK+0wA4gWgQvcFBHAc7P4/u78/Ff4CC5ATB3P3oUwFClYgcALcxzp/B9Ez4DUV8RjBbsCBrMH4dLNwIDaCGhA6o3pXksdBvYBsktrXDgNJKAFy1Z+ZGIy5NXgXoBT8a3ZgVSPIUAMV6DjLxhsV8wX4n4ibbONObHNyCr8Z4FinNFjg8ziiF5zSV8A99u7Zdf5OisvVaAAAG3VJREFU/kIPAJLWX3hUIFD6o7MD4WkHIMXBk4IftSrPNBJVk0OoC7ice8HGS8XBKDoz/YFBLaQi392lGpCMJfhD9xVkx5Xbj73P9V4m1j0v73x9FjDDPlYvATkgFAVWcdNvJBamliOjAwRV0EpeRymAe717kMYRyy/j5FwFBX0fP7Dyx8gq8wn2ZXi8GfGYR+lFcGJSxa3Y84WgzBHetlU4cvKY44Ps4iP9fsgsPGEhQTAcHqwwGCj61SoPexKwasXFqtxq8qhD9SixoBBYcJEDNzmIoi3J7QkoJActVHocTVpPBCDhElAvMDK1PT/Sq3DwB/ygmyB9GNhYDH4so4Foy48kkPtZfZEv1PQTxYpyX0EI3Bu+/5krcN8fgwVdwWu2JNVNWAk+PcOOPMNdGFyAZ5Aj6gicgzNfwuHZg0HrLxBWfjSRl88fVCo/apX/IBrIvf65ZxtEoK9Bec4KZIPLe76osQns46NwW0pUPCPAyMc4A/KXOwZzFLGbAqD5xhhbgBcWfoJBAlarcCSQgdQJ+Movnih4gjZQTw51rz588y/ZgxVUEAQ8soCfX8OR26JwujCLGFAMsOjnwGrlPuQw9D/PPv8BYVR7pG/eeFtQpsLzR2KFI8SwKj9KlX++HeLOPuSBKrKeHBi7L4b+Kx184+ptAp4Trcscv69oARVYzWgaK01H1X0K3zNSmARKtxXYHvwJuT+8gLGGWgpHcWOmBeljFB2Ckg6wiAYOqfxEK3GMCAj6kIiTWdCBCXhkjUKMgJcLk271N9uLSbtvvK0S69OXAvoA5z94VsFubbmZvx4QAnXgBnJxENyQjy38wef81uPhxMpPJIQzr5ckuUTKe0wZyN57iFTWga8GvCwlh5UqvYgmaNV9XSxEVWs40kkosFwA70RgNOu8mLZfR6wDiwRa35y7j08NksqPQhcfkRBK/J8R75Iz+9C8gJpqzwiIeZII3QnYOkJWbVEI5jNuA+o2BwK82ifwnpSgHwaC+GNAdmW2VXfC+vPu6wR6lBj84C9WfvivZyUhZMJlJhjSukDlFJ3g4AvGJfC1iEpQJ/CaEd7G9wds7p71+odruKrHip/C7RdsxeVjzIxhoNkFGOW/+sk/YVAGtltfzZAIfzix8gcHhZCXpcGN2u69qWqD9OlRFAy7x2fQBhHUiETB+DocqvArYt98f+AEAXApsEmEcNLC0t2uPHCqPQIXwHYDfI4/9+8LMpchqr5HK39MJSrBXwnutNqjovjHFdq+fcHLp7YLR4mGgduW5hFpAXUoL4cTTuW5HJSkB5PC0S7A+8c+837DyoM1J9iv/po/o3BunlDqPjOSO/YbLFd+FGy9sxKFeT8b+nLNPrkAyD53FtT27yUS32yqUaEGTMBiASGcZ0FmK8nWxbvjC1q6WQC4VdWdAcBY8eFoAzIrC0b7Wt8wlPcIdE1FhUWeKU1Igv8Q/0dl4k/NnYSxdlDon8diUDeuQB4c8XVzcahRgyyZmNC+LAgeCfSVALde8/t1DCYawNoePGT83wlOpFUdOZKwxn89OsMEf0X8CxJCBN/dwKbFwkSMgx0ACJJDJD4iC1JEYh6XcEqVHpx4+J4I4UiAl26r5x64sttvSlAn3LBuQCz6edU8C+J5epBrC4YP52EFDgHrCw1B0eU9bOaTgh3wmYvQV3Oqqcf53XnVNXUBELX1xtSgFrirlII5d3HFulxBCNEfZx0h7K2f34XwdHpuYQcguN189Ow/nPXclaUcqMH5leCXjKOjbv3F0a7i2ZaRHmBe5zwnhA9S736ZC8AH8LHkg/T5znYgmES1dtuzGo92qwHIquiWX+4KgVLd8utv9Ml1BQNhEJW/FOgweiTguCUoQHkEwYhjfQIgm8eAzPKzHqAG5xGiiPyxeGRRaYetUpDVpHVC1T9bHGyaknb/TQTnuG7rDYwYCUT7/cMjtILzA+Go/FPw581F/mWeTkDuBsBCAK8ki+A29nMzPn4Rzjv6QV7xWW4fzQFUxb9jQQ1qc28kMi4mDl1NBr4usIsz5ltZqNm7AeJXfuTHd7nioLEyPBISU+8/tP1AC4Il/n+YGmjg2NiBRdl6yCw//zG5ph7bqaBuz8B4VMU/TqSsNPbwCeZA1cdxyG9SgKzRZPL+GXFOiH1/SFZ9wX8M3zUgvH8a4rMBjZj/h1W9MrwTiN6MlsCKiI4gycBzgV/xUaQGjGDHwHiYi0VIzeEAasCpNuL76AC7BIEl7i4AIxnAfoMxk35eJbZ68wWEUChs8IPz/EEE9BkUoNA4RCWSLJkY1h0Y/dG9bVCtUVPe7QRhtStXG4nOECDfUxc4Uw/Ik8JkA9o9+a83IrfHH11EdFUWc4phNgVFWkPsIHBnCvCCYBSgqEN9qtoXuwHhByYoJJA7BxIkkRwpDGgAHo+vQ3ZGOwCFJCJKUAx4MBpFZWvReeLgtBBkDDQu2OJxXa7SE/P4ZiUPHABjY1DsFIhPAaygWewiXK72hHjow/k8gCL6gKES8qcDZ7A+EhYlWCPGCX1wXIwzkQEKt8cP6iqkC0FEhFj/ZYtvXCtwuBLcDT5wXN+9H6ZEIkTwV/x/s78fXFX3siWHEKrC3tw7EFZ31Ll7ttknQyEMGgAqCaVe1bGk8r8nFWCQQR0h7CY0dsU/mIeIuA1AGCo02Q0YVXxub36sG1Qgfo0CBBUXxap+ECFEycQVyViBEBFPt14TK9rZHB9EwMG7DPXOv0OVHkdtx7OSCXfb3av4CFZGTwQBwT7/hKPHE4PzpJ4L4+FM9r1n8B+B+9R9I4Fu9brYUZgCunZWNxdQgIs8mASBQ4F8hJpEiaf4GPihk8FdAxin/kybjZjTj+mAQy6ihZ9whDvHAWB6BKrBXQr+5SBfqPaINwiz12UIwoTmbPACZY/fshBBBKNlW8ZCHwH/cVKSOZMm4Mxk4OwE9JeB+EFkn1IzcPQoiSB4vGgNeJSoik1A7m0TCmE/HrggB+/1M12C1Z18ACGoIeH1pH2IhAqFWgBq+kDFEWAvA3X8tpW0cnSD5WAOriOHhnYraF1eLTkS8P/QsHUBdtMPnOrMaANJE9AZiaKWII5Ue/8PTHn/UcCSTgIF2xN4zdmAQYIAKeBFl6FiO0aKfq5jcImHfPwTxcEdRmD3LcFoAva1Hdjm9UgGggI9YOoPkOBYLsT8HlG3nucMDGkOOJ8CkNOELdSO7D5qqAeJYBb2GpABgRi2gxLITgrOQ9C937HgB+0i7MeRx3gfPWCXLtgbLJAu/gCFBPzRX8eADJqCvA3FViC/BlOQC4LZyrBq8BdQAOUKoKjqR7v7EFfVFMojPgEoSlJesNIePyLHwW9NRgq7E6HvUN8A0yj0wyWDHRZ3J2A1jHdMyu3hCGwSDwdRir7h9VP7AKLgPoMCgKziOFLtrUm8aIFHlgxYfz8WBYUU55iAXauo+evJaIK/NTgRJM9sUcZRzcCnMdNKMJc7usnAyrpxHYkTRHK+n1HxS01LheAHqRWwKIDqLvQC0+PupHZgBawfVGsiniTVHwZHRqbUI/D4Cd+ftgyLAR1ehkIiqaKFw7MJEwUIuK5zsu4svoFYCFKgBJZACBuppOId2RDkPZas8H9kULcA9a0KTCQDGtpnzT+RMJiOGseHl4BQ1C29AWUXIIf/OIwwqoNEK3SCuA7FRiBrE9B4/PcrGJ1OQNj83F4Xbol/TgVHfMiIZLAdcaVkgh8sLrd+liNQH/FqsNTfj15m1J0X+ffZuq/gTY7QnvIfJz6UzBJLs83ItQpt3RfZz5iuGfNPajpngUm0R8DoA5jDlzsOTAwZjzsC3Jjxg7H914PjlcskGdghgx9HG4OOQH34uwQyzz61/0qiYNQjXxECuWYbGM/DrjtPH/Mw/K+gBLLSA+cEfPr4MroArzcDuybbr8Zc72i2UnzeHnTgzD4Ug78SzIvCoARVOQxaFFR3TzWnkkHUVFShEuqKxZnKz4p4YYcf8ZhYhuu8wFgSHcuuwCJagI4bgchJQK/qe9c/RT6nGcg6KGREJpb+MI0EY/b0jcsni3AJBeCQNsBOFVYoApcM2Aom4VFgIRdHpeIG8D3YaxBD+qCiQ+rBOSVnci8hzkAG1t/pgHA4uwDzmu8xFKkkkIqCfkIRs204r/hiDgutoAAcowBMZ9+KS0CcXVBOHCvJw2jMQSJyeoeExF2DuTuRcuWAo9sefyUQ6/oBaIjPtiRH1KvQKvygAHb171d+vc4GRMDPoxN/kL5pwlVh1mBQ1quQJAJ5j0TgOAis+h8d3mnC8xTKE34+8sDNjyVXE6nFMN+H39TQDmocHScENvN74LoGScGU4f7g6IG3n3C3qnG6JBS+Z5tHOOzRYQx+u7MZmAl0OSsRLAS/VIKfRAWU92+12aaVPksGDBWQuCMvgNy2M2Mt8EwqbjosZAec5xLEAmXmcFTHiOWARWglpNpjdEtBQRxJJU5VL5/7F1X86XntXgUK4q+KggsUoIIK8oA+kgy4+zLaACqQGTVOX6MBWdehL6BxHn+tlyBMDGAqufd7WOX5WTJwKYDfXJJP2GXDPk7Tj5Ed7BOG7DMFaBRAJgI/+H2Ngeb2SKb0zkoGlQBHkefDr7xMA5HZeJPtKIzyApI9gmnPgf1c3mulfhe0gFekDCdNFnrOwi4Gs6eTACNjB+Uegcgojog4V25P8bctRYY6RL8AJklE9ACFAGZdBEahd4d4CmghFhbzcwaXYH5qTlS6DY+KfNH5Avzjo2JJ0poDkSCMxLn73H/eB+ifvgvyIFCWAji7BWC8hd0qj0FziMdrS70BlVbgamIgcmotGZDNPwm0L9l5iHv7WRoAFx57ScFS2r2iwot8oKu8l+TOCOg2mZ2nFdjTgOFQENzKkJ8OjEnsE8f6AzyXwT6MNF3RDRnuj0Lwo6wTlBMDIyqaz6G+RiLJMg/KUrQV/rh9uH0tWduwoxmky0kSMQ+rnXxZsGadgnxfgk1pCnsIsGYltvfdzTOBIclIsN8MLAGcz5gBwj94AE8DuC9Molip/JGwB57nRyJiyD3pyk6q5ij+3TzRLohcqyqCEQBTepF15+WVmW8SEr5jMUUkx3oMIsrH3ndwAQganKzyMpOJNxMQooGBYwcByw7axIhgPRGEr6GSGJhkAELoQ1YRg+dPeD5IIRDIqq5PA2Jh0Rq0YcS8XBi0ghGRFpCtWTdum5+yLOsQf2EuYY8AfnbQZDgCjHxBSKwTGpt8QCIDVH3/4H5OwEvldhliINwAFLsEyyIfGKV+vm3eEehVqKTdNxtDiPoLHCRiuwTJxCECxMDqDjTvZ63KaPKvRgV2i/F3ohm88V8LN8hgJcXD5pVGIPPNn9EBqSQC0I4AMxBUcQNCkarkFgSn/oCs9GCVep4eUG5BRAOcQOCWlGSc3If0IFqRfURQGRrKewPKEJ9sLnIowKCcw+f48N6UHjqYtgInaCCkBbPSj8VEkCr2g8U43wY1xX/BNkwreQrzg+oaJghOCGTU8RBxuIp6VFOGoEXgEsBLIgV6gBgxoLSI5CgiYNT+GBHsU01GthrceiMUtv9KgAYktgVNeGrBbtiOQVi9x8WjiAW7UNUnm4Vet7WtsFgDCDYEwQ/EVL1PnQf/xCDLTowTh4c4HPRDoQaiwhKIAae4B7xgCBydI/CDPOrevK0FR4p6w3VfoXgQiB3T1N8Y1PCD0X19JqcHGfzB5WkQE4p/kdeXBcEVUXEIFqSij82lMyrWq/7c+LFHA7z5/dwOHHg8s/Y8C2CmhbmALtare+4UWLfb25BmXABKABTniC8gRAP2yvDAiUAsElnrxFzITQa/sAFecAOY7zPV/8jMQHSbWAiUPGkQNABhw85xrSCv+mMSzFR8+7mjw01A8f4F8S/td4jnDHYxpT8/OEyV3gz2+GTfdAeAszswfJNGlQhEIjB0Bls0BKn4Iw7WKu9f1gmSagmvqleEwJwnZwjO7npz1HdCJ1hS/mlBcRXyF3i/M7NxqJFoeH27z7nnJaBmpUZKHsTbGUc1ALEoIGsGYl9ixS50gjAT/VhB8IzvGTrBVfWEz1MzAkRFTtecW731VdjNQPukVdhdn0Y8d/a7WYH6i/TBPBzUFwAlHwtGHOQISrgb1AMUgDETTA3+THAdeRJhg59V/Ektofa9I8wxVICkC7QQSAd2O3cftzPzdMK6aA4iZI4ILfYRbb9RgqICt2AxVnYZ4kkBvHOBxT/zN9ybHx/f5Ql2fkGCX6ANm6F8WCfqAS+Eq5AGcHJd2IFHagTMHAAj+mWBnDXuc81CjhsAi5dL2K8QCYI1aJ/PJtSSxEFXASv7C2I3ZB9/a0j/7nDn/j1pHsz9Jr8fNpxPBUAUUYD4wz5GBlmyAiORjtAIGDFwzSUwqiNZ1d1tPiB7/Q9VeI9KeJU16/knkEeQJEALjY4rkp74fCZiMDSA/PgvT/aT2gYgp5E/P29AKBQAo6TRth5T4VesQFb0i4K7RA2MZpgyFXCEQHCOixuYMPgy2L7+45ezSSKt2oUkURlpXkEMOLSiXPuDQZjk63N5bmzOSxQdLHX7AhwUEA0BAeQPJIQzkAuFlOK/GtyLdiGDKEBdllQ7YouxV2Xdwza9So4Kp5Z0yAgUhTlJgFzSFrznIHYIwKcCu2/L3LsCg6UI1b1/CA+ApIV5/32HqOIjdQusE4azip5Wc1b0q/QGIAlaWEJbXP3r/L+AEipw/+BtkQVY9fIM2i/ZhgVEgJO6DZ1ksVtlYdoQAPhVO0oKmYBmnAYco4DRCRB3TwCziptaE0auER9/VzRqKNOEYINOQg2m1l9GpGNQAhh1v6UmxNQh2M4+LmlUzll0OTjYQOaGlZAEMCrdhmBphaMBwBADrSQQc3//He8KgFETT7p6BHnjj2X9EXsDjrgBS6ihoAmcSQVYmE4JgYWFpp1waAQRoqDzxDhU+HxSnZHz/9JEY6Y5MJA+cwoWrt99+U3Mc/9g/NQTFaigAEtwB1yBzwzucZSX7RZEILhR1d5GDCsBLVUdIQvsldZfEJt5i/MHx2hGJZFkVVyK242iFeh58oBUFqIQbkfp2DV2X0CkAYgv1sU+P+I/HmBu8nErugdRnUWhfp+A/ddlbEH3uQlBsNobUEMHasK1HOYn8BEEvCUaiuigXRIKj+sGOPA4KAWz9/s7WxcgB4+a6/fI2osEwv4yOENAiPf+wQhbc/5f0gGisWuQaRFmGoIqguARWsBQgTTocDLMT5OJUQnhqdCEig+/EShKSEgTVV0MBMnz04BcshPnLk/+OaV0/dwKzB4QUt1NB6uTDfGOP+cNm9mEsBAFiM7AQh9AKVEU75vy68jeOxrUC4mDEuYO0oLqoSdHaEF2eXYYSm0V+oEOwpLmYFOF3Z4CmAeBTIGueiIw2xoKPzDBJVBXQ5g5O8/twwA+QguIjJt3+g0NQEcDfUXgO5gsqlTBLkQLdl86K3CWneitQ8sg/5oWAUJP2C3V3RoEyji5n4b9lB4t9pz2CA+cAFn1Z9I/uzYsU/ELtEBOCHYQQqGcFejV+yeuRJX31zsKV5IGjway9z6PLDxKwNEPsBuOEiqw57jGgOtZ1Y++T50AuMFl7hPIbhskiOwsATtRoc7rS7dXrpcgrMCGJca6ELJo+Y0be0BW5ZKGcFz4y8W9BduwcDnK9iO5fagsKpp9ANnvDPxeP8THNyIVFo1AMas8Qk5v2Ytm0LCCYAXqn+wQsPTBh/5Bcnne14Os3uCQt28vsK1WUESJFviBgAW//3u9PLxusXchcCR2WsNzv/ImvgZzzkUByDUAIrjTvmSHAowpJBQE4SUlxMxnARlQbIqkArVAJ6pBBvELCCKlkyCDAP45BYfEPfcUpfMch3Vn4bheYK4E66BxAxHSVd5INgEPgU/NBCDfNQ8Ho1CoINAPQAW/QT8OCIZlNFCB84XhoDChFByHGjx35v9BLgyhmojqHYb5QYXnuAecvua0hZe6BV9f7v4ibvgvamrmAc1TmaEir0LQ9h97eYAYVoM/nWA60i8Q3Ifezha9BqaaL3zvqd6IAuwwLSCCuCLuJWch4h30giPtyiAphKEBcCu9BV5wwzkMxID8rhMwdwMhcSFgrBT3RUTQboAUg3+p+Qe1IGarOioVnazmefV3lHpwA0AcLWCahUiXwePHWJsP+GH1gnp/we5KfOhJAbsj0H/BIEb04TbrTPsAyb2LLu93KwfCvn5PLAwrOXAa72eEQRo1CNdw5IprsAZ3hApy9zlcITG2vpCihsRSYxNS+J4vdBZ6B52eqRcQ/QXmSjAWSfa/5GA5qEg4iJFtm624AqXLrSA2gx8p1Mdqcghv41S0lSp/xAYs9gakQc4Ie2RTUYwYgt748mV+FU1Xgp14eW3XYZ6cdqGTNHwHICTwEeTPl0jEZwIgP9gDEaogeg5IHWCF+1eoAhvEKPB/EAeTRsM/pSAP5wjWEUMM1/NJRhwJbpJSgK7S7zF3EOsI5jBQBK9DV80Z8Y0COzvmWzJXgDl40KEC6cqvqgi4OB5cpgLFYK/1CvDiItXqC6/S87wfAUfPtxqfGNzlYaOjlf1IsHPPvffHgDAoEeEST4ZLZUd/RSo91/BjXY5ggWgQ4In3fyj4mUqPrInHOCLKO3wUwRsfyXpt1nEIRLrqcWeTuk7bigsbid1zD4iDRQtnIdQsyIXnFCn1I9D7ADgxEhOvR5AJosoUbu1FkJyYCi9OhQERoIx+4AX/YqUXQhtYEwKN4Cy1HntLMmtaAQpqfrT/UCoLSxeswjA5UWPPi0mjajUWxMTdVusNvt/ChMdmILK5IRMFu90BMEzFYHdg2GAgeYVHMMJIBTA7EFTx/5fpgTFXz9w/en0ZjD8kCDoKPNGwlB01BmoWQbh+AxR689mBponGJOr9OwmMu3dtJ/ylW1Tik4ElUPmR9RqII+pVhD9ychABMQ51gOIZg+/G+5mGIzLB1JJC5WhzYjhJ7IWmLDpA8jzsAafUPkB2WnFBF4iSxkq1ty7f25rv/+EQLOxs2oUdTSA9HIR9swdBlCcFe9owPC3XWDDC0ISVzsEVbSCF/sWdA5Fu4HJqankp2SeQCYYrImNalfmhpVxYrGkUS4LeSUjg8dD7+D7w/ybIfy7vlB9/HJ978zr7/45Qgajzj+4EjIK/ULHPRAOlKr/aG0AFcqCyu0GcW45Igh6JMJmhA49/U+cEssHNJhtXDC1MOya3j/sAiAGcrEtqtgjBD6wEzSDc7D8o6C8rIqAZyPk+NQoNLAZ1hR64Yl1FBY648smUYKnSg1Xwk/0DyRyArByMUobyByhCcPnOaPyoegREFS4jNfYAw+IHCjdC1J2WDZBke/OyN85J24WiXwDYPoJyYuCD238ulvuzwt6KgHf0shWKsqCFFGjB/w8HU8eeTED9wAAAAABJRU5ErkJggg==";let AD=0;const YD=t=>{if(!t.environmentBRDFTexture){const K=t.useDelayedTextureLoading;t.useDelayedTextureLoading=!1;const D=t._blockEntityCollection;t._blockEntityCollection=!1;const a=U.g.CreateFromBase64String(RD,"EnvironmentBRDFTexture"+AD++,t,!0,!1,U.g.BILINEAR_SAMPLINGMODE);t._blockEntityCollection=D;const G=t.getEngine().getLoadedTexturesCache(),N=G.indexOf(a.getInternalTexture());-1!==N&&G.splice(N,1),a.isRGBD=!0,a.wrapU=U.g.CLAMP_ADDRESSMODE,a.wrapV=U.g.CLAMP_ADDRESSMODE,t.environmentBRDFTexture=a,t.useDelayedTextureLoading=K,gD.G.ExpandRGBDTexture(a);const W=t.getEngine().onContextRestoredObservable.add((()=>{a.isRGBD=!0;const K=t.onBeforeRenderObservable.add((()=>{a.isReady()&&(t.onBeforeRenderObservable.remove(K),gD.G.ExpandRGBDTexture(a))}))}));t.onDisposeObservable.add((()=>{t.getEngine().onContextRestoredObservable.remove(W)}))}return t.environmentBRDFTexture};var LD=D(527335),SD=D(185537);class fD extends LD.M{constructor(){super(...arguments),this.BRDF_V_HEIGHT_CORRELATED=!1,this.MS_BRDF_ENERGY_CONSERVATION=!1,this.SPHERICAL_HARMONICS=!1,this.SPECULAR_GLOSSINESS_ENERGY_CONSERVATION=!1}}class $D extends SD.y{_markAllSubMeshesAsMiscDirty(){this._internalMarkAllSubMeshesAsMiscDirty()}isCompatible(){return!0}constructor(t,K=!0){super(t,"PBRBRDF",90,new fD,K),this._useEnergyConservation=$D.DEFAULT_USE_ENERGY_CONSERVATION,this.useEnergyConservation=$D.DEFAULT_USE_ENERGY_CONSERVATION,this._useSmithVisibilityHeightCorrelated=$D.DEFAULT_USE_SMITH_VISIBILITY_HEIGHT_CORRELATED,this.useSmithVisibilityHeightCorrelated=$D.DEFAULT_USE_SMITH_VISIBILITY_HEIGHT_CORRELATED,this._useSphericalHarmonics=$D.DEFAULT_USE_SPHERICAL_HARMONICS,this.useSphericalHarmonics=$D.DEFAULT_USE_SPHERICAL_HARMONICS,this._useSpecularGlossinessInputEnergyConservation=$D.DEFAULT_USE_SPECULAR_GLOSSINESS_INPUT_ENERGY_CONSERVATION,this.useSpecularGlossinessInputEnergyConservation=$D.DEFAULT_USE_SPECULAR_GLOSSINESS_INPUT_ENERGY_CONSERVATION,this._internalMarkAllSubMeshesAsMiscDirty=t._dirtyCallbacks[16],this._enable(!0)}prepareDefines(t){t.BRDF_V_HEIGHT_CORRELATED=this._useSmithVisibilityHeightCorrelated,t.MS_BRDF_ENERGY_CONSERVATION=this._useEnergyConservation&&this._useSmithVisibilityHeightCorrelated,t.SPHERICAL_HARMONICS=this._useSphericalHarmonics,t.SPECULAR_GLOSSINESS_ENERGY_CONSERVATION=this._useSpecularGlossinessInputEnergyConservation}getClassName(){return"PBRBRDFConfiguration"}}$D.DEFAULT_USE_ENERGY_CONSERVATION=!0,$D.DEFAULT_USE_SMITH_VISIBILITY_HEIGHT_CORRELATED=!0,$D.DEFAULT_USE_SPHERICAL_HARMONICS=!0,$D.DEFAULT_USE_SPECULAR_GLOSSINESS_INPUT_ENERGY_CONSERVATION=!0,a.Cg([G.lK(),G.$z("_markAllSubMeshesAsMiscDirty")],$D.prototype,"useEnergyConservation",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsMiscDirty")],$D.prototype,"useSmithVisibilityHeightCorrelated",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsMiscDirty")],$D.prototype,"useSphericalHarmonics",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsMiscDirty")],$D.prototype,"useSpecularGlossinessInputEnergyConservation",void 0);var BD=D(626956),OD=D(239590),vD=D(591160);class pD extends LD.M{constructor(){super(...arguments),this.CLEARCOAT=!1,this.CLEARCOAT_DEFAULTIOR=!1,this.CLEARCOAT_TEXTURE=!1,this.CLEARCOAT_TEXTURE_ROUGHNESS=!1,this.CLEARCOAT_TEXTUREDIRECTUV=0,this.CLEARCOAT_TEXTURE_ROUGHNESSDIRECTUV=0,this.CLEARCOAT_BUMP=!1,this.CLEARCOAT_BUMPDIRECTUV=0,this.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE=!1,this.CLEARCOAT_REMAP_F0=!1,this.CLEARCOAT_TINT=!1,this.CLEARCOAT_TINT_TEXTURE=!1,this.CLEARCOAT_TINT_TEXTUREDIRECTUV=0,this.CLEARCOAT_TINT_GAMMATEXTURE=!1}}class jD extends SD.y{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}isCompatible(){return!0}constructor(t,K=!0){super(t,"PBRClearCoat",100,new pD,K),this._isEnabled=!1,this.isEnabled=!1,this.intensity=1,this.roughness=0,this._indexOfRefraction=jD._DefaultIndexOfRefraction,this.indexOfRefraction=jD._DefaultIndexOfRefraction,this._texture=null,this.texture=null,this._useRoughnessFromMainTexture=!0,this.useRoughnessFromMainTexture=!0,this._textureRoughness=null,this.textureRoughness=null,this._remapF0OnInterfaceChange=!0,this.remapF0OnInterfaceChange=!0,this._bumpTexture=null,this.bumpTexture=null,this._isTintEnabled=!1,this.isTintEnabled=!1,this.tintColor=s.v9.White(),this.tintColorAtDistance=1,this.tintThickness=1,this._tintTexture=null,this.tintTexture=null,this._internalMarkAllSubMeshesAsTexturesDirty=t._dirtyCallbacks[1]}isReadyForSubMesh(t,K,D){if(!this._isEnabled)return!0;const a=this._material._disableBumpMap;if(t._areTexturesDirty&&K.texturesEnabled){if(this._texture&&vD.h.ClearCoatTextureEnabled&&!this._texture.isReadyOrNotBlocking())return!1;if(this._textureRoughness&&vD.h.ClearCoatTextureEnabled&&!this._textureRoughness.isReadyOrNotBlocking())return!1;if(D.getCaps().standardDerivatives&&this._bumpTexture&&vD.h.ClearCoatBumpTextureEnabled&&!a&&!this._bumpTexture.isReady())return!1;if(this._isTintEnabled&&this._tintTexture&&vD.h.ClearCoatTintTextureEnabled&&!this._tintTexture.isReadyOrNotBlocking())return!1}return!0}prepareDefinesBeforeAttributes(t,K){this._isEnabled?(t.CLEARCOAT=!0,t.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE=this._useRoughnessFromMainTexture,t.CLEARCOAT_REMAP_F0=this._remapF0OnInterfaceChange,t._areTexturesDirty&&K.texturesEnabled&&(this._texture&&vD.h.ClearCoatTextureEnabled?XK.YT(this._texture,t,"CLEARCOAT_TEXTURE"):t.CLEARCOAT_TEXTURE=!1,this._textureRoughness&&vD.h.ClearCoatTextureEnabled?XK.YT(this._textureRoughness,t,"CLEARCOAT_TEXTURE_ROUGHNESS"):t.CLEARCOAT_TEXTURE_ROUGHNESS=!1,this._bumpTexture&&vD.h.ClearCoatBumpTextureEnabled?XK.YT(this._bumpTexture,t,"CLEARCOAT_BUMP"):t.CLEARCOAT_BUMP=!1,t.CLEARCOAT_DEFAULTIOR=this._indexOfRefraction===jD._DefaultIndexOfRefraction,this._isTintEnabled?(t.CLEARCOAT_TINT=!0,this._tintTexture&&vD.h.ClearCoatTintTextureEnabled?(XK.YT(this._tintTexture,t,"CLEARCOAT_TINT_TEXTURE"),t.CLEARCOAT_TINT_GAMMATEXTURE=this._tintTexture.gammaSpace):t.CLEARCOAT_TINT_TEXTURE=!1):(t.CLEARCOAT_TINT=!1,t.CLEARCOAT_TINT_TEXTURE=!1))):(t.CLEARCOAT=!1,t.CLEARCOAT_TEXTURE=!1,t.CLEARCOAT_TEXTURE_ROUGHNESS=!1,t.CLEARCOAT_BUMP=!1,t.CLEARCOAT_TINT=!1,t.CLEARCOAT_TINT_TEXTURE=!1,t.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE=!1,t.CLEARCOAT_DEFAULTIOR=!1,t.CLEARCOAT_TEXTUREDIRECTUV=0,t.CLEARCOAT_TEXTURE_ROUGHNESSDIRECTUV=0,t.CLEARCOAT_BUMPDIRECTUV=0,t.CLEARCOAT_REMAP_F0=!1,t.CLEARCOAT_TINT_TEXTUREDIRECTUV=0,t.CLEARCOAT_TINT_GAMMATEXTURE=!1)}bindForSubMesh(t,K,D,a){var G,N,W,x,b,n,e,i;if(!this._isEnabled)return;const z=a.materialDefines,I=this._material.isFrozen,Z=this._material._disableBumpMap,w=this._material._invertNormalMapX,m=this._material._invertNormalMapY;if(!t.useUbo||!I||!t.isSync){(this._texture||this._textureRoughness)&&vD.h.ClearCoatTextureEnabled&&(t.updateFloat4("vClearCoatInfos",null!==(N=null===(G=this._texture)||void 0===G?void 0:G.coordinatesIndex)&&void 0!==N?N:0,null!==(x=null===(W=this._texture)||void 0===W?void 0:W.level)&&void 0!==x?x:0,null!==(n=null===(b=this._textureRoughness)||void 0===b?void 0:b.coordinatesIndex)&&void 0!==n?n:0,null!==(i=null===(e=this._textureRoughness)||void 0===e?void 0:e.level)&&void 0!==i?i:0),this._texture&&XK.mA(this._texture,t,"clearCoat"),this._textureRoughness&&!z.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE&&XK.mA(this._textureRoughness,t,"clearCoatRoughness")),this._bumpTexture&&D.getCaps().standardDerivatives&&vD.h.ClearCoatTextureEnabled&&!Z&&(t.updateFloat2("vClearCoatBumpInfos",this._bumpTexture.coordinatesIndex,this._bumpTexture.level),XK.mA(this._bumpTexture,t,"clearCoatBump"),K._mirroredCameraPosition?t.updateFloat2("vClearCoatTangentSpaceParams",w?1:-1,m?1:-1):t.updateFloat2("vClearCoatTangentSpaceParams",w?-1:1,m?-1:1)),this._tintTexture&&vD.h.ClearCoatTintTextureEnabled&&(t.updateFloat2("vClearCoatTintInfos",this._tintTexture.coordinatesIndex,this._tintTexture.level),XK.mA(this._tintTexture,t,"clearCoatTint")),t.updateFloat2("vClearCoatParams",this.intensity,this.roughness);const a=1-this._indexOfRefraction,I=1+this._indexOfRefraction,u=Math.pow(-a/I,2),d=1/this._indexOfRefraction;t.updateFloat4("vClearCoatRefractionParams",u,d,a,I),this._isTintEnabled&&(t.updateFloat4("vClearCoatTintParams",this.tintColor.r,this.tintColor.g,this.tintColor.b,Math.max(1e-5,this.tintThickness)),t.updateFloat("clearCoatColorAtDistance",Math.max(1e-5,this.tintColorAtDistance)))}K.texturesEnabled&&(this._texture&&vD.h.ClearCoatTextureEnabled&&t.setTexture("clearCoatSampler",this._texture),this._textureRoughness&&!z.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE&&vD.h.ClearCoatTextureEnabled&&t.setTexture("clearCoatRoughnessSampler",this._textureRoughness),this._bumpTexture&&D.getCaps().standardDerivatives&&vD.h.ClearCoatBumpTextureEnabled&&!Z&&t.setTexture("clearCoatBumpSampler",this._bumpTexture),this._isTintEnabled&&this._tintTexture&&vD.h.ClearCoatTintTextureEnabled&&t.setTexture("clearCoatTintSampler",this._tintTexture))}hasTexture(t){return this._texture===t||this._textureRoughness===t||this._bumpTexture===t||this._tintTexture===t}getActiveTextures(t){this._texture&&t.push(this._texture),this._textureRoughness&&t.push(this._textureRoughness),this._bumpTexture&&t.push(this._bumpTexture),this._tintTexture&&t.push(this._tintTexture)}getAnimatables(t){this._texture&&this._texture.animations&&this._texture.animations.length>0&&t.push(this._texture),this._textureRoughness&&this._textureRoughness.animations&&this._textureRoughness.animations.length>0&&t.push(this._textureRoughness),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&t.push(this._bumpTexture),this._tintTexture&&this._tintTexture.animations&&this._tintTexture.animations.length>0&&t.push(this._tintTexture)}dispose(t){var K,D,a,G;t&&(null===(K=this._texture)||void 0===K||K.dispose(),null===(D=this._textureRoughness)||void 0===D||D.dispose(),null===(a=this._bumpTexture)||void 0===a||a.dispose(),null===(G=this._tintTexture)||void 0===G||G.dispose())}getClassName(){return"PBRClearCoatConfiguration"}addFallbacks(t,K,D){return t.CLEARCOAT_BUMP&&K.addFallback(D++,"CLEARCOAT_BUMP"),t.CLEARCOAT_TINT&&K.addFallback(D++,"CLEARCOAT_TINT"),t.CLEARCOAT&&K.addFallback(D++,"CLEARCOAT"),D}getSamplers(t){t.push("clearCoatSampler","clearCoatRoughnessSampler","clearCoatBumpSampler","clearCoatTintSampler")}getUniforms(){return{ubo:[{name:"vClearCoatParams",size:2,type:"vec2"},{name:"vClearCoatRefractionParams",size:4,type:"vec4"},{name:"vClearCoatInfos",size:4,type:"vec4"},{name:"clearCoatMatrix",size:16,type:"mat4"},{name:"clearCoatRoughnessMatrix",size:16,type:"mat4"},{name:"vClearCoatBumpInfos",size:2,type:"vec2"},{name:"vClearCoatTangentSpaceParams",size:2,type:"vec2"},{name:"clearCoatBumpMatrix",size:16,type:"mat4"},{name:"vClearCoatTintParams",size:4,type:"vec4"},{name:"clearCoatColorAtDistance",size:1,type:"float"},{name:"vClearCoatTintInfos",size:2,type:"vec2"},{name:"clearCoatTintMatrix",size:16,type:"mat4"}]}}}jD._DefaultIndexOfRefraction=1.5,a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],jD.prototype,"isEnabled",void 0),a.Cg([G.lK()],jD.prototype,"intensity",void 0),a.Cg([G.lK()],jD.prototype,"roughness",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],jD.prototype,"indexOfRefraction",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],jD.prototype,"texture",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],jD.prototype,"useRoughnessFromMainTexture",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],jD.prototype,"textureRoughness",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],jD.prototype,"remapF0OnInterfaceChange",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],jD.prototype,"bumpTexture",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],jD.prototype,"isTintEnabled",void 0),a.Cg([G.jT()],jD.prototype,"tintColor",void 0),a.Cg([G.lK()],jD.prototype,"tintColorAtDistance",void 0),a.Cg([G.lK()],jD.prototype,"tintThickness",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],jD.prototype,"tintTexture",void 0);class rD extends LD.M{constructor(){super(...arguments),this.IRIDESCENCE=!1,this.IRIDESCENCE_TEXTURE=!1,this.IRIDESCENCE_TEXTUREDIRECTUV=0,this.IRIDESCENCE_THICKNESS_TEXTURE=!1,this.IRIDESCENCE_THICKNESS_TEXTUREDIRECTUV=0}}class MD extends SD.y{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}isCompatible(){return!0}constructor(t,K=!0){super(t,"PBRIridescence",110,new rD,K),this._isEnabled=!1,this.isEnabled=!1,this.intensity=1,this.minimumThickness=MD._DefaultMinimumThickness,this.maximumThickness=MD._DefaultMaximumThickness,this.indexOfRefraction=MD._DefaultIndexOfRefraction,this._texture=null,this.texture=null,this._thicknessTexture=null,this.thicknessTexture=null,this._internalMarkAllSubMeshesAsTexturesDirty=t._dirtyCallbacks[1]}isReadyForSubMesh(t,K){if(!this._isEnabled)return!0;if(t._areTexturesDirty&&K.texturesEnabled){if(this._texture&&vD.h.IridescenceTextureEnabled&&!this._texture.isReadyOrNotBlocking())return!1;if(this._thicknessTexture&&vD.h.IridescenceTextureEnabled&&!this._thicknessTexture.isReadyOrNotBlocking())return!1}return!0}prepareDefinesBeforeAttributes(t,K){this._isEnabled?(t.IRIDESCENCE=!0,t._areTexturesDirty&&K.texturesEnabled&&(this._texture&&vD.h.IridescenceTextureEnabled?XK.YT(this._texture,t,"IRIDESCENCE_TEXTURE"):t.IRIDESCENCE_TEXTURE=!1,this._thicknessTexture&&vD.h.IridescenceTextureEnabled?XK.YT(this._thicknessTexture,t,"IRIDESCENCE_THICKNESS_TEXTURE"):t.IRIDESCENCE_THICKNESS_TEXTURE=!1)):(t.IRIDESCENCE=!1,t.IRIDESCENCE_TEXTURE=!1,t.IRIDESCENCE_THICKNESS_TEXTURE=!1,t.IRIDESCENCE_TEXTUREDIRECTUV=0,t.IRIDESCENCE_THICKNESS_TEXTUREDIRECTUV=0)}bindForSubMesh(t,K){var D,a,G,N,W,x,b,n;if(!this._isEnabled)return;const e=this._material.isFrozen;t.useUbo&&e&&t.isSync||((this._texture||this._thicknessTexture)&&vD.h.IridescenceTextureEnabled&&(t.updateFloat4("vIridescenceInfos",null!==(a=null===(D=this._texture)||void 0===D?void 0:D.coordinatesIndex)&&void 0!==a?a:0,null!==(N=null===(G=this._texture)||void 0===G?void 0:G.level)&&void 0!==N?N:0,null!==(x=null===(W=this._thicknessTexture)||void 0===W?void 0:W.coordinatesIndex)&&void 0!==x?x:0,null!==(n=null===(b=this._thicknessTexture)||void 0===b?void 0:b.level)&&void 0!==n?n:0),this._texture&&XK.mA(this._texture,t,"iridescence"),this._thicknessTexture&&XK.mA(this._thicknessTexture,t,"iridescenceThickness")),t.updateFloat4("vIridescenceParams",this.intensity,this.indexOfRefraction,this.minimumThickness,this.maximumThickness)),K.texturesEnabled&&(this._texture&&vD.h.IridescenceTextureEnabled&&t.setTexture("iridescenceSampler",this._texture),this._thicknessTexture&&vD.h.IridescenceTextureEnabled&&t.setTexture("iridescenceThicknessSampler",this._thicknessTexture))}hasTexture(t){return this._texture===t||this._thicknessTexture===t}getActiveTextures(t){this._texture&&t.push(this._texture),this._thicknessTexture&&t.push(this._thicknessTexture)}getAnimatables(t){this._texture&&this._texture.animations&&this._texture.animations.length>0&&t.push(this._texture),this._thicknessTexture&&this._thicknessTexture.animations&&this._thicknessTexture.animations.length>0&&t.push(this._thicknessTexture)}dispose(t){var K,D;t&&(null===(K=this._texture)||void 0===K||K.dispose(),null===(D=this._thicknessTexture)||void 0===D||D.dispose())}getClassName(){return"PBRIridescenceConfiguration"}addFallbacks(t,K,D){return t.IRIDESCENCE&&K.addFallback(D++,"IRIDESCENCE"),D}getSamplers(t){t.push("iridescenceSampler","iridescenceThicknessSampler")}getUniforms(){return{ubo:[{name:"vIridescenceParams",size:4,type:"vec4"},{name:"vIridescenceInfos",size:4,type:"vec4"},{name:"iridescenceMatrix",size:16,type:"mat4"},{name:"iridescenceThicknessMatrix",size:16,type:"mat4"}]}}}MD._DefaultMinimumThickness=100,MD._DefaultMaximumThickness=400,MD._DefaultIndexOfRefraction=1.3,a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],MD.prototype,"isEnabled",void 0),a.Cg([G.lK()],MD.prototype,"intensity",void 0),a.Cg([G.lK()],MD.prototype,"minimumThickness",void 0),a.Cg([G.lK()],MD.prototype,"maximumThickness",void 0),a.Cg([G.lK()],MD.prototype,"indexOfRefraction",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],MD.prototype,"texture",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],MD.prototype,"thicknessTexture",void 0);class kD extends LD.M{constructor(){super(...arguments),this.ANISOTROPIC=!1,this.ANISOTROPIC_TEXTURE=!1,this.ANISOTROPIC_TEXTUREDIRECTUV=0,this.ANISOTROPIC_LEGACY=!1,this.MAINUV1=!1}}class ta extends SD.y{set angle(t){this.direction.x=Math.cos(t),this.direction.y=Math.sin(t)}get angle(){return Math.atan2(this.direction.y,this.direction.x)}_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}_markAllSubMeshesAsMiscDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsMiscDirty()}isCompatible(){return!0}constructor(t,K=!0){super(t,"PBRAnisotropic",110,new kD,K),this._isEnabled=!1,this.isEnabled=!1,this.intensity=1,this.direction=new N.I9(1,0),this._texture=null,this.texture=null,this._legacy=!1,this.legacy=!1,this._internalMarkAllSubMeshesAsTexturesDirty=t._dirtyCallbacks[1],this._internalMarkAllSubMeshesAsMiscDirty=t._dirtyCallbacks[16]}isReadyForSubMesh(t,K){return!this._isEnabled||!(t._areTexturesDirty&&K.texturesEnabled&&this._texture&&vD.h.AnisotropicTextureEnabled&&!this._texture.isReadyOrNotBlocking())}prepareDefinesBeforeAttributes(t,K,D){this._isEnabled?(t.ANISOTROPIC=this._isEnabled,this._isEnabled&&!D.isVerticesDataPresent(R.R.TangentKind)&&(t._needUVs=!0,t.MAINUV1=!0),t._areTexturesDirty&&K.texturesEnabled&&(this._texture&&vD.h.AnisotropicTextureEnabled?XK.YT(this._texture,t,"ANISOTROPIC_TEXTURE"):t.ANISOTROPIC_TEXTURE=!1),t._areMiscDirty&&(t.ANISOTROPIC_LEGACY=this._legacy)):(t.ANISOTROPIC=!1,t.ANISOTROPIC_TEXTURE=!1,t.ANISOTROPIC_TEXTUREDIRECTUV=0,t.ANISOTROPIC_LEGACY=!1)}bindForSubMesh(t,K){if(!this._isEnabled)return;const D=this._material.isFrozen;t.useUbo&&D&&t.isSync||(this._texture&&vD.h.AnisotropicTextureEnabled&&(t.updateFloat2("vAnisotropyInfos",this._texture.coordinatesIndex,this._texture.level),XK.mA(this._texture,t,"anisotropy")),t.updateFloat3("vAnisotropy",this.direction.x,this.direction.y,this.intensity)),K.texturesEnabled&&this._texture&&vD.h.AnisotropicTextureEnabled&&t.setTexture("anisotropySampler",this._texture)}hasTexture(t){return this._texture===t}getActiveTextures(t){this._texture&&t.push(this._texture)}getAnimatables(t){this._texture&&this._texture.animations&&this._texture.animations.length>0&&t.push(this._texture)}dispose(t){t&&this._texture&&this._texture.dispose()}getClassName(){return"PBRAnisotropicConfiguration"}addFallbacks(t,K,D){return t.ANISOTROPIC&&K.addFallback(D++,"ANISOTROPIC"),D}getSamplers(t){t.push("anisotropySampler")}getUniforms(){return{ubo:[{name:"vAnisotropy",size:3,type:"vec3"},{name:"vAnisotropyInfos",size:2,type:"vec2"},{name:"anisotropyMatrix",size:16,type:"mat4"}]}}parse(t,K,D){super.parse(t,K,D),void 0===t.legacy&&(this.legacy=!0)}}a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ta.prototype,"isEnabled",void 0),a.Cg([G.lK()],ta.prototype,"intensity",void 0),a.Cg([G.WM()],ta.prototype,"direction",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],ta.prototype,"texture",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsMiscDirty")],ta.prototype,"legacy",void 0);class Ka extends LD.M{constructor(){super(...arguments),this.SHEEN=!1,this.SHEEN_TEXTURE=!1,this.SHEEN_GAMMATEXTURE=!1,this.SHEEN_TEXTURE_ROUGHNESS=!1,this.SHEEN_TEXTUREDIRECTUV=0,this.SHEEN_TEXTURE_ROUGHNESSDIRECTUV=0,this.SHEEN_LINKWITHALBEDO=!1,this.SHEEN_ROUGHNESS=!1,this.SHEEN_ALBEDOSCALING=!1,this.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE=!1}}class Da extends SD.y{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}isCompatible(){return!0}constructor(t,K=!0){super(t,"Sheen",120,new Ka,K),this._isEnabled=!1,this.isEnabled=!1,this._linkSheenWithAlbedo=!1,this.linkSheenWithAlbedo=!1,this.intensity=1,this.color=s.v9.White(),this._texture=null,this.texture=null,this._useRoughnessFromMainTexture=!0,this.useRoughnessFromMainTexture=!0,this._roughness=null,this.roughness=null,this._textureRoughness=null,this.textureRoughness=null,this._albedoScaling=!1,this.albedoScaling=!1,this._internalMarkAllSubMeshesAsTexturesDirty=t._dirtyCallbacks[1]}isReadyForSubMesh(t,K){if(!this._isEnabled)return!0;if(t._areTexturesDirty&&K.texturesEnabled){if(this._texture&&vD.h.SheenTextureEnabled&&!this._texture.isReadyOrNotBlocking())return!1;if(this._textureRoughness&&vD.h.SheenTextureEnabled&&!this._textureRoughness.isReadyOrNotBlocking())return!1}return!0}prepareDefinesBeforeAttributes(t,K){this._isEnabled?(t.SHEEN=!0,t.SHEEN_LINKWITHALBEDO=this._linkSheenWithAlbedo,t.SHEEN_ROUGHNESS=null!==this._roughness,t.SHEEN_ALBEDOSCALING=this._albedoScaling,t.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE=this._useRoughnessFromMainTexture,t._areTexturesDirty&&K.texturesEnabled&&(this._texture&&vD.h.SheenTextureEnabled?(XK.YT(this._texture,t,"SHEEN_TEXTURE"),t.SHEEN_GAMMATEXTURE=this._texture.gammaSpace):t.SHEEN_TEXTURE=!1,this._textureRoughness&&vD.h.SheenTextureEnabled?XK.YT(this._textureRoughness,t,"SHEEN_TEXTURE_ROUGHNESS"):t.SHEEN_TEXTURE_ROUGHNESS=!1)):(t.SHEEN=!1,t.SHEEN_TEXTURE=!1,t.SHEEN_TEXTURE_ROUGHNESS=!1,t.SHEEN_LINKWITHALBEDO=!1,t.SHEEN_ROUGHNESS=!1,t.SHEEN_ALBEDOSCALING=!1,t.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE=!1,t.SHEEN_GAMMATEXTURE=!1,t.SHEEN_TEXTUREDIRECTUV=0,t.SHEEN_TEXTURE_ROUGHNESSDIRECTUV=0)}bindForSubMesh(t,K,D,a){var G,N,W,x,b,n,e,i;if(!this._isEnabled)return;const z=a.materialDefines,I=this._material.isFrozen;t.useUbo&&I&&t.isSync||((this._texture||this._textureRoughness)&&vD.h.SheenTextureEnabled&&(t.updateFloat4("vSheenInfos",null!==(N=null===(G=this._texture)||void 0===G?void 0:G.coordinatesIndex)&&void 0!==N?N:0,null!==(x=null===(W=this._texture)||void 0===W?void 0:W.level)&&void 0!==x?x:0,null!==(n=null===(b=this._textureRoughness)||void 0===b?void 0:b.coordinatesIndex)&&void 0!==n?n:0,null!==(i=null===(e=this._textureRoughness)||void 0===e?void 0:e.level)&&void 0!==i?i:0),this._texture&&XK.mA(this._texture,t,"sheen"),this._textureRoughness&&!z.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE&&XK.mA(this._textureRoughness,t,"sheenRoughness")),t.updateFloat4("vSheenColor",this.color.r,this.color.g,this.color.b,this.intensity),null!==this._roughness&&t.updateFloat("vSheenRoughness",this._roughness)),K.texturesEnabled&&(this._texture&&vD.h.SheenTextureEnabled&&t.setTexture("sheenSampler",this._texture),this._textureRoughness&&!z.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE&&vD.h.SheenTextureEnabled&&t.setTexture("sheenRoughnessSampler",this._textureRoughness))}hasTexture(t){return this._texture===t||this._textureRoughness===t}getActiveTextures(t){this._texture&&t.push(this._texture),this._textureRoughness&&t.push(this._textureRoughness)}getAnimatables(t){this._texture&&this._texture.animations&&this._texture.animations.length>0&&t.push(this._texture),this._textureRoughness&&this._textureRoughness.animations&&this._textureRoughness.animations.length>0&&t.push(this._textureRoughness)}dispose(t){var K,D;t&&(null===(K=this._texture)||void 0===K||K.dispose(),null===(D=this._textureRoughness)||void 0===D||D.dispose())}getClassName(){return"PBRSheenConfiguration"}addFallbacks(t,K,D){return t.SHEEN&&K.addFallback(D++,"SHEEN"),D}getSamplers(t){t.push("sheenSampler","sheenRoughnessSampler")}getUniforms(){return{ubo:[{name:"vSheenColor",size:4,type:"vec4"},{name:"vSheenRoughness",size:1,type:"float"},{name:"vSheenInfos",size:4,type:"vec4"},{name:"sheenMatrix",size:16,type:"mat4"},{name:"sheenRoughnessMatrix",size:16,type:"mat4"}]}}}a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],Da.prototype,"isEnabled",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],Da.prototype,"linkSheenWithAlbedo",void 0),a.Cg([G.lK()],Da.prototype,"intensity",void 0),a.Cg([G.jT()],Da.prototype,"color",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],Da.prototype,"texture",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],Da.prototype,"useRoughnessFromMainTexture",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],Da.prototype,"roughness",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],Da.prototype,"textureRoughness",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],Da.prototype,"albedoScaling",void 0);class aa extends LD.M{constructor(){super(...arguments),this.SUBSURFACE=!1,this.SS_REFRACTION=!1,this.SS_REFRACTION_USE_INTENSITY_FROM_THICKNESS=!1,this.SS_TRANSLUCENCY=!1,this.SS_TRANSLUCENCY_USE_INTENSITY_FROM_THICKNESS=!1,this.SS_SCATTERING=!1,this.SS_DISPERSION=!1,this.SS_THICKNESSANDMASK_TEXTURE=!1,this.SS_THICKNESSANDMASK_TEXTUREDIRECTUV=0,this.SS_HAS_THICKNESS=!1,this.SS_REFRACTIONINTENSITY_TEXTURE=!1,this.SS_REFRACTIONINTENSITY_TEXTUREDIRECTUV=0,this.SS_TRANSLUCENCYINTENSITY_TEXTURE=!1,this.SS_TRANSLUCENCYINTENSITY_TEXTUREDIRECTUV=0,this.SS_TRANSLUCENCYCOLOR_TEXTURE=!1,this.SS_TRANSLUCENCYCOLOR_TEXTUREDIRECTUV=0,this.SS_REFRACTIONMAP_3D=!1,this.SS_REFRACTIONMAP_OPPOSITEZ=!1,this.SS_LODINREFRACTIONALPHA=!1,this.SS_GAMMAREFRACTION=!1,this.SS_RGBDREFRACTION=!1,this.SS_LINEARSPECULARREFRACTION=!1,this.SS_LINKREFRACTIONTOTRANSPARENCY=!1,this.SS_ALBEDOFORREFRACTIONTINT=!1,this.SS_ALBEDOFORTRANSLUCENCYTINT=!1,this.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=!1,this.SS_USE_THICKNESS_AS_DEPTH=!1,this.SS_USE_GLTF_TEXTURES=!1}}class Ga extends SD.y{get scatteringDiffusionProfile(){return this._scene.subSurfaceConfiguration?this._scene.subSurfaceConfiguration.ssDiffusionProfileColors[this._scatteringDiffusionProfileIndex]:null}set scatteringDiffusionProfile(t){this._scene.enableSubSurfaceForPrePass()&&t&&(this._scatteringDiffusionProfileIndex=this._scene.subSurfaceConfiguration.addDiffusionProfile(t))}get volumeIndexOfRefraction(){return this._volumeIndexOfRefraction>=1?this._volumeIndexOfRefraction:this._indexOfRefraction}set volumeIndexOfRefraction(t){this._volumeIndexOfRefraction=t>=1?t:-1}_markAllSubMeshesAsTexturesDirty(){this._enable(this._isRefractionEnabled||this._isTranslucencyEnabled||this._isScatteringEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}_markScenePrePassDirty(){this._internalMarkAllSubMeshesAsTexturesDirty(),this._internalMarkScenePrePassDirty()}isCompatible(){return!0}constructor(t,K=!0){super(t,"PBRSubSurface",130,new aa,K),this._isRefractionEnabled=!1,this.isRefractionEnabled=!1,this._isTranslucencyEnabled=!1,this.isTranslucencyEnabled=!1,this._isDispersionEnabled=!1,this.isDispersionEnabled=!1,this._isScatteringEnabled=!1,this.isScatteringEnabled=!1,this._scatteringDiffusionProfileIndex=0,this.refractionIntensity=1,this.translucencyIntensity=1,this.useAlbedoToTintRefraction=!1,this.useAlbedoToTintTranslucency=!1,this._thicknessTexture=null,this.thicknessTexture=null,this._refractionTexture=null,this.refractionTexture=null,this._indexOfRefraction=1.5,this.indexOfRefraction=1.5,this._volumeIndexOfRefraction=-1,this._invertRefractionY=!1,this.invertRefractionY=!1,this._linkRefractionWithTransparency=!1,this.linkRefractionWithTransparency=!1,this.minimumThickness=0,this.maximumThickness=1,this.useThicknessAsDepth=!1,this.tintColor=s.v9.White(),this.tintColorAtDistance=1,this.dispersion=0,this.diffusionDistance=s.v9.White(),this._useMaskFromThicknessTexture=!1,this.useMaskFromThicknessTexture=!1,this._refractionIntensityTexture=null,this.refractionIntensityTexture=null,this._translucencyIntensityTexture=null,this.translucencyIntensityTexture=null,this.translucencyColor=null,this._translucencyColorTexture=null,this.translucencyColorTexture=null,this._useGltfStyleTextures=!0,this.useGltfStyleTextures=!0,this._scene=t.getScene(),this.registerForExtraEvents=!0,this._internalMarkAllSubMeshesAsTexturesDirty=t._dirtyCallbacks[1],this._internalMarkScenePrePassDirty=t._dirtyCallbacks[32]}isReadyForSubMesh(t,K){if(!this._isRefractionEnabled&&!this._isTranslucencyEnabled&&!this._isScatteringEnabled)return!0;if(t._areTexturesDirty&&K.texturesEnabled){if(this._thicknessTexture&&vD.h.ThicknessTextureEnabled&&!this._thicknessTexture.isReadyOrNotBlocking())return!1;if(this._translucencyColorTexture&&vD.h.TranslucencyColorTextureEnabled&&!this._translucencyColorTexture.isReadyOrNotBlocking())return!1;if(this._translucencyIntensityTexture&&vD.h.TranslucencyIntensityTextureEnabled&&!this._translucencyIntensityTexture.isReadyOrNotBlocking())return!1;const t=this._getRefractionTexture(K);if(t&&vD.h.RefractionTextureEnabled&&!t.isReadyOrNotBlocking())return!1}return!0}prepareDefinesBeforeAttributes(t,K){if(!this._isRefractionEnabled&&!this._isTranslucencyEnabled&&!this._isScatteringEnabled)return t.SUBSURFACE=!1,t.SS_DISPERSION=!1,t.SS_TRANSLUCENCY=!1,t.SS_SCATTERING=!1,t.SS_REFRACTION=!1,t.SS_REFRACTION_USE_INTENSITY_FROM_THICKNESS=!1,t.SS_TRANSLUCENCY_USE_INTENSITY_FROM_THICKNESS=!1,t.SS_THICKNESSANDMASK_TEXTURE=!1,t.SS_THICKNESSANDMASK_TEXTUREDIRECTUV=0,t.SS_HAS_THICKNESS=!1,t.SS_REFRACTIONINTENSITY_TEXTURE=!1,t.SS_REFRACTIONINTENSITY_TEXTUREDIRECTUV=0,t.SS_TRANSLUCENCYINTENSITY_TEXTURE=!1,t.SS_TRANSLUCENCYINTENSITY_TEXTUREDIRECTUV=0,t.SS_REFRACTIONMAP_3D=!1,t.SS_REFRACTIONMAP_OPPOSITEZ=!1,t.SS_LODINREFRACTIONALPHA=!1,t.SS_GAMMAREFRACTION=!1,t.SS_RGBDREFRACTION=!1,t.SS_LINEARSPECULARREFRACTION=!1,t.SS_LINKREFRACTIONTOTRANSPARENCY=!1,t.SS_ALBEDOFORREFRACTIONTINT=!1,t.SS_ALBEDOFORTRANSLUCENCYTINT=!1,t.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=!1,t.SS_USE_THICKNESS_AS_DEPTH=!1,t.SS_USE_GLTF_TEXTURES=!1,t.SS_TRANSLUCENCYCOLOR_TEXTURE=!1,void(t.SS_TRANSLUCENCYCOLOR_TEXTUREDIRECTUV=0);if(t._areTexturesDirty){if(t.SUBSURFACE=!0,t.SS_DISPERSION=this._isDispersionEnabled,t.SS_TRANSLUCENCY=this._isTranslucencyEnabled,t.SS_TRANSLUCENCY_USE_INTENSITY_FROM_THICKNESS=!1,t.SS_SCATTERING=this._isScatteringEnabled,t.SS_THICKNESSANDMASK_TEXTURE=!1,t.SS_REFRACTIONINTENSITY_TEXTURE=!1,t.SS_TRANSLUCENCYINTENSITY_TEXTURE=!1,t.SS_HAS_THICKNESS=!1,t.SS_USE_GLTF_TEXTURES=!1,t.SS_REFRACTION=!1,t.SS_REFRACTION_USE_INTENSITY_FROM_THICKNESS=!1,t.SS_REFRACTIONMAP_3D=!1,t.SS_GAMMAREFRACTION=!1,t.SS_RGBDREFRACTION=!1,t.SS_LINEARSPECULARREFRACTION=!1,t.SS_REFRACTIONMAP_OPPOSITEZ=!1,t.SS_LODINREFRACTIONALPHA=!1,t.SS_LINKREFRACTIONTOTRANSPARENCY=!1,t.SS_ALBEDOFORREFRACTIONTINT=!1,t.SS_ALBEDOFORTRANSLUCENCYTINT=!1,t.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=!1,t.SS_USE_THICKNESS_AS_DEPTH=!1,t.SS_TRANSLUCENCYCOLOR_TEXTURE=!1,t._areTexturesDirty&&K.texturesEnabled&&(this._thicknessTexture&&vD.h.ThicknessTextureEnabled&&XK.YT(this._thicknessTexture,t,"SS_THICKNESSANDMASK_TEXTURE"),this._refractionIntensityTexture&&vD.h.RefractionIntensityTextureEnabled&&XK.YT(this._refractionIntensityTexture,t,"SS_REFRACTIONINTENSITY_TEXTURE"),this._translucencyIntensityTexture&&vD.h.TranslucencyIntensityTextureEnabled&&XK.YT(this._translucencyIntensityTexture,t,"SS_TRANSLUCENCYINTENSITY_TEXTURE"),this._translucencyColorTexture&&vD.h.TranslucencyColorTextureEnabled&&XK.YT(this._translucencyColorTexture,t,"SS_TRANSLUCENCYCOLOR_TEXTURE")),t.SS_HAS_THICKNESS=this.maximumThickness-this.minimumThickness!=0,t.SS_USE_GLTF_TEXTURES=this._useGltfStyleTextures,t.SS_REFRACTION_USE_INTENSITY_FROM_THICKNESS=this._useMaskFromThicknessTexture&&!this._refractionIntensityTexture,t.SS_TRANSLUCENCY_USE_INTENSITY_FROM_THICKNESS=this._useMaskFromThicknessTexture&&!this._translucencyIntensityTexture,this._isRefractionEnabled&&K.texturesEnabled){const D=this._getRefractionTexture(K);D&&vD.h.RefractionTextureEnabled&&(t.SS_REFRACTION=!0,t.SS_REFRACTIONMAP_3D=D.isCube,t.SS_GAMMAREFRACTION=D.gammaSpace,t.SS_RGBDREFRACTION=D.isRGBD,t.SS_LINEARSPECULARREFRACTION=D.linearSpecularLOD,t.SS_REFRACTIONMAP_OPPOSITEZ=this._scene.useRightHandedSystem&&D.isCube?!D.invertZ:D.invertZ,t.SS_LODINREFRACTIONALPHA=D.lodLevelInAlpha,t.SS_LINKREFRACTIONTOTRANSPARENCY=this._linkRefractionWithTransparency,t.SS_ALBEDOFORREFRACTIONTINT=this.useAlbedoToTintRefraction,t.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=D.isCube&&D.boundingBoxSize,t.SS_USE_THICKNESS_AS_DEPTH=this.useThicknessAsDepth)}this._isTranslucencyEnabled&&(t.SS_ALBEDOFORTRANSLUCENCYTINT=this.useAlbedoToTintTranslucency)}}hardBindForSubMesh(t,K,D,a){if(this._isRefractionEnabled||this._isTranslucencyEnabled||this._isScatteringEnabled)if(0===this.maximumThickness&&0===this.minimumThickness)t.updateFloat2("vThicknessParam",0,0);else{a.getRenderingMesh().getWorldMatrix().decompose(N.AA.Vector3[0]);const K=Math.max(Math.abs(N.AA.Vector3[0].x),Math.abs(N.AA.Vector3[0].y),Math.abs(N.AA.Vector3[0].z));t.updateFloat2("vThicknessParam",this.minimumThickness*K,(this.maximumThickness-this.minimumThickness)*K)}}bindForSubMesh(t,K,D,a){var G;if(!this._isRefractionEnabled&&!this._isTranslucencyEnabled&&!this._isScatteringEnabled)return;const N=a.materialDefines,W=this._material.isFrozen,x=this._material.realTimeFiltering,b=N.LODBASEDMICROSFURACE,n=this._getRefractionTexture(K);if(!t.useUbo||!W||!t.isSync){if(this._thicknessTexture&&vD.h.ThicknessTextureEnabled&&(t.updateFloat2("vThicknessInfos",this._thicknessTexture.coordinatesIndex,this._thicknessTexture.level),XK.mA(this._thicknessTexture,t,"thickness")),this._refractionIntensityTexture&&vD.h.RefractionIntensityTextureEnabled&&N.SS_REFRACTIONINTENSITY_TEXTURE&&(t.updateFloat2("vRefractionIntensityInfos",this._refractionIntensityTexture.coordinatesIndex,this._refractionIntensityTexture.level),XK.mA(this._refractionIntensityTexture,t,"refractionIntensity")),this._translucencyColorTexture&&vD.h.TranslucencyColorTextureEnabled&&N.SS_TRANSLUCENCYCOLOR_TEXTURE&&(t.updateFloat2("vTranslucencyColorInfos",this._translucencyColorTexture.coordinatesIndex,this._translucencyColorTexture.level),XK.mA(this._translucencyColorTexture,t,"translucencyColor")),this._translucencyIntensityTexture&&vD.h.TranslucencyIntensityTextureEnabled&&N.SS_TRANSLUCENCYINTENSITY_TEXTURE&&(t.updateFloat2("vTranslucencyIntensityInfos",this._translucencyIntensityTexture.coordinatesIndex,this._translucencyIntensityTexture.level),XK.mA(this._translucencyIntensityTexture,t,"translucencyIntensity")),n&&vD.h.RefractionTextureEnabled){t.updateMatrix("refractionMatrix",n.getRefractionTextureMatrix());let K=1;n.isCube||n.depth&&(K=n.depth);const D=n.getSize().width,a=this.volumeIndexOfRefraction;if(t.updateFloat4("vRefractionInfos",n.level,1/a,K,this._invertRefractionY?-1:1),t.updateFloat4("vRefractionMicrosurfaceInfos",D,n.lodGenerationScale,n.lodGenerationOffset,1/this.indexOfRefraction),x&&t.updateFloat2("vRefractionFilteringInfo",D,it.X.Log2(D)),n.boundingBoxSize){const K=n;t.updateVector3("vRefractionPosition",K.boundingBoxPosition),t.updateVector3("vRefractionSize",K.boundingBoxSize)}}this._isScatteringEnabled&&t.updateFloat("scatteringDiffusionProfile",this._scatteringDiffusionProfileIndex),t.updateColor3("vDiffusionDistance",this.diffusionDistance),t.updateFloat4("vTintColor",this.tintColor.r,this.tintColor.g,this.tintColor.b,Math.max(1e-5,this.tintColorAtDistance)),t.updateColor4("vTranslucencyColor",null!==(G=this.translucencyColor)&&void 0!==G?G:this.tintColor,0),t.updateFloat3("vSubSurfaceIntensity",this.refractionIntensity,this.translucencyIntensity,0),t.updateFloat("dispersion",this.dispersion)}K.texturesEnabled&&(this._thicknessTexture&&vD.h.ThicknessTextureEnabled&&t.setTexture("thicknessSampler",this._thicknessTexture),this._refractionIntensityTexture&&vD.h.RefractionIntensityTextureEnabled&&N.SS_REFRACTIONINTENSITY_TEXTURE&&t.setTexture("refractionIntensitySampler",this._refractionIntensityTexture),this._translucencyIntensityTexture&&vD.h.TranslucencyIntensityTextureEnabled&&N.SS_TRANSLUCENCYINTENSITY_TEXTURE&&t.setTexture("translucencyIntensitySampler",this._translucencyIntensityTexture),this._translucencyColorTexture&&vD.h.TranslucencyColorTextureEnabled&&N.SS_TRANSLUCENCYCOLOR_TEXTURE&&t.setTexture("translucencyColorSampler",this._translucencyColorTexture),n&&vD.h.RefractionTextureEnabled&&(b?t.setTexture("refractionSampler",n):(t.setTexture("refractionSampler",n._lodTextureMid||n),t.setTexture("refractionSamplerLow",n._lodTextureLow||n),t.setTexture("refractionSamplerHigh",n._lodTextureHigh||n))))}_getRefractionTexture(t){return this._refractionTexture?this._refractionTexture:this._isRefractionEnabled?t.environmentTexture:null}get disableAlphaBlending(){return this._isRefractionEnabled&&this._linkRefractionWithTransparency}fillRenderTargetTextures(t){vD.h.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget&&t.push(this._refractionTexture)}hasTexture(t){return this._thicknessTexture===t||this._refractionTexture===t||this._refractionIntensityTexture===t||this._translucencyIntensityTexture===t||this._translucencyColorTexture===t}hasRenderTargetTextures(){return!!(vD.h.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget)}getActiveTextures(t){this._thicknessTexture&&t.push(this._thicknessTexture),this._refractionTexture&&t.push(this._refractionTexture),this._translucencyColorTexture&&t.push(this._translucencyColorTexture),this._translucencyIntensityTexture&&t.push(this._translucencyIntensityTexture)}getAnimatables(t){this._thicknessTexture&&this._thicknessTexture.animations&&this._thicknessTexture.animations.length>0&&t.push(this._thicknessTexture),this._refractionTexture&&this._refractionTexture.animations&&this._refractionTexture.animations.length>0&&t.push(this._refractionTexture),this._translucencyColorTexture&&this._translucencyColorTexture.animations&&this._translucencyColorTexture.animations.length>0&&t.push(this._translucencyColorTexture),this._translucencyIntensityTexture&&this._translucencyIntensityTexture.animations&&this._translucencyIntensityTexture.animations.length>0&&t.push(this._translucencyIntensityTexture)}dispose(t){t&&(this._thicknessTexture&&this._thicknessTexture.dispose(),this._refractionTexture&&this._refractionTexture.dispose(),this._translucencyColorTexture&&this._translucencyColorTexture.dispose(),this._translucencyIntensityTexture&&this._translucencyIntensityTexture.dispose())}getClassName(){return"PBRSubSurfaceConfiguration"}addFallbacks(t,K,D){return t.SS_SCATTERING&&K.addFallback(D++,"SS_SCATTERING"),t.SS_TRANSLUCENCY&&K.addFallback(D++,"SS_TRANSLUCENCY"),D}getSamplers(t){t.push("thicknessSampler","refractionIntensitySampler","translucencyIntensitySampler","refractionSampler","refractionSamplerLow","refractionSamplerHigh","translucencyColorSampler")}getUniforms(){return{ubo:[{name:"vRefractionMicrosurfaceInfos",size:4,type:"vec4"},{name:"vRefractionFilteringInfo",size:2,type:"vec2"},{name:"vTranslucencyIntensityInfos",size:2,type:"vec2"},{name:"vRefractionInfos",size:4,type:"vec4"},{name:"refractionMatrix",size:16,type:"mat4"},{name:"vThicknessInfos",size:2,type:"vec2"},{name:"vRefractionIntensityInfos",size:2,type:"vec2"},{name:"thicknessMatrix",size:16,type:"mat4"},{name:"refractionIntensityMatrix",size:16,type:"mat4"},{name:"translucencyIntensityMatrix",size:16,type:"mat4"},{name:"vThicknessParam",size:2,type:"vec2"},{name:"vDiffusionDistance",size:3,type:"vec3"},{name:"vTintColor",size:4,type:"vec4"},{name:"vSubSurfaceIntensity",size:3,type:"vec3"},{name:"vRefractionPosition",size:3,type:"vec3"},{name:"vRefractionSize",size:3,type:"vec3"},{name:"scatteringDiffusionProfile",size:1,type:"float"},{name:"dispersion",size:1,type:"float"},{name:"vTranslucencyColor",size:4,type:"vec4"},{name:"vTranslucencyColorInfos",size:2,type:"vec2"},{name:"translucencyColorMatrix",size:16,type:"mat4"}]}}}a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],Ga.prototype,"isRefractionEnabled",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],Ga.prototype,"isTranslucencyEnabled",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],Ga.prototype,"isDispersionEnabled",void 0),a.Cg([G.lK(),G.$z("_markScenePrePassDirty")],Ga.prototype,"isScatteringEnabled",void 0),a.Cg([G.lK()],Ga.prototype,"_scatteringDiffusionProfileIndex",void 0),a.Cg([G.lK()],Ga.prototype,"refractionIntensity",void 0),a.Cg([G.lK()],Ga.prototype,"translucencyIntensity",void 0),a.Cg([G.lK()],Ga.prototype,"useAlbedoToTintRefraction",void 0),a.Cg([G.lK()],Ga.prototype,"useAlbedoToTintTranslucency",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],Ga.prototype,"thicknessTexture",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],Ga.prototype,"refractionTexture",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],Ga.prototype,"indexOfRefraction",void 0),a.Cg([G.lK()],Ga.prototype,"_volumeIndexOfRefraction",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],Ga.prototype,"volumeIndexOfRefraction",null),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],Ga.prototype,"invertRefractionY",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],Ga.prototype,"linkRefractionWithTransparency",void 0),a.Cg([G.lK()],Ga.prototype,"minimumThickness",void 0),a.Cg([G.lK()],Ga.prototype,"maximumThickness",void 0),a.Cg([G.lK()],Ga.prototype,"useThicknessAsDepth",void 0),a.Cg([G.jT()],Ga.prototype,"tintColor",void 0),a.Cg([G.lK()],Ga.prototype,"tintColorAtDistance",void 0),a.Cg([G.lK()],Ga.prototype,"dispersion",void 0),a.Cg([G.jT()],Ga.prototype,"diffusionDistance",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],Ga.prototype,"useMaskFromThicknessTexture",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],Ga.prototype,"refractionIntensityTexture",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],Ga.prototype,"translucencyIntensityTexture",void 0),a.Cg([G.jT()],Ga.prototype,"translucencyColor",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],Ga.prototype,"translucencyColorTexture",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],Ga.prototype,"useGltfStyleTextures",void 0);var Na=D(722736),Wa=D(384898);const xa={effect:null,subMesh:null};class ba extends LD.M{constructor(t){super(t),this.PBR=!0,this.NUM_SAMPLES="0",this.REALTIME_FILTERING=!1,this.MAINUV1=!1,this.MAINUV2=!1,this.MAINUV3=!1,this.MAINUV4=!1,this.MAINUV5=!1,this.MAINUV6=!1,this.UV1=!1,this.UV2=!1,this.UV3=!1,this.UV4=!1,this.UV5=!1,this.UV6=!1,this.ALBEDO=!1,this.GAMMAALBEDO=!1,this.ALBEDODIRECTUV=0,this.VERTEXCOLOR=!1,this.BAKED_VERTEX_ANIMATION_TEXTURE=!1,this.AMBIENT=!1,this.AMBIENTDIRECTUV=0,this.AMBIENTINGRAYSCALE=!1,this.OPACITY=!1,this.VERTEXALPHA=!1,this.OPACITYDIRECTUV=0,this.OPACITYRGB=!1,this.ALPHATEST=!1,this.DEPTHPREPASS=!1,this.ALPHABLEND=!1,this.ALPHAFROMALBEDO=!1,this.ALPHATESTVALUE="0.5",this.SPECULAROVERALPHA=!1,this.RADIANCEOVERALPHA=!1,this.ALPHAFRESNEL=!1,this.LINEARALPHAFRESNEL=!1,this.PREMULTIPLYALPHA=!1,this.EMISSIVE=!1,this.EMISSIVEDIRECTUV=0,this.GAMMAEMISSIVE=!1,this.REFLECTIVITY=!1,this.REFLECTIVITY_GAMMA=!1,this.REFLECTIVITYDIRECTUV=0,this.SPECULARTERM=!1,this.MICROSURFACEFROMREFLECTIVITYMAP=!1,this.MICROSURFACEAUTOMATIC=!1,this.LODBASEDMICROSFURACE=!1,this.MICROSURFACEMAP=!1,this.MICROSURFACEMAPDIRECTUV=0,this.METALLICWORKFLOW=!1,this.ROUGHNESSSTOREINMETALMAPALPHA=!1,this.ROUGHNESSSTOREINMETALMAPGREEN=!1,this.METALLNESSSTOREINMETALMAPBLUE=!1,this.AOSTOREINMETALMAPRED=!1,this.METALLIC_REFLECTANCE=!1,this.METALLIC_REFLECTANCE_GAMMA=!1,this.METALLIC_REFLECTANCEDIRECTUV=0,this.METALLIC_REFLECTANCE_USE_ALPHA_ONLY=!1,this.REFLECTANCE=!1,this.REFLECTANCE_GAMMA=!1,this.REFLECTANCEDIRECTUV=0,this.ENVIRONMENTBRDF=!1,this.ENVIRONMENTBRDF_RGBD=!1,this.NORMAL=!1,this.TANGENT=!1,this.BUMP=!1,this.BUMPDIRECTUV=0,this.OBJECTSPACE_NORMALMAP=!1,this.PARALLAX=!1,this.PARALLAX_RHS=!1,this.PARALLAXOCCLUSION=!1,this.NORMALXYSCALE=!0,this.LIGHTMAP=!1,this.LIGHTMAPDIRECTUV=0,this.USELIGHTMAPASSHADOWMAP=!1,this.GAMMALIGHTMAP=!1,this.RGBDLIGHTMAP=!1,this.REFLECTION=!1,this.REFLECTIONMAP_3D=!1,this.REFLECTIONMAP_SPHERICAL=!1,this.REFLECTIONMAP_PLANAR=!1,this.REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,this.REFLECTIONMAP_PROJECTION=!1,this.REFLECTIONMAP_SKYBOX=!1,this.REFLECTIONMAP_EXPLICIT=!1,this.REFLECTIONMAP_EQUIRECTANGULAR=!1,this.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,this.INVERTCUBICMAP=!1,this.USESPHERICALFROMREFLECTIONMAP=!1,this.USEIRRADIANCEMAP=!1,this.USESPHERICALINVERTEX=!1,this.REFLECTIONMAP_OPPOSITEZ=!1,this.LODINREFLECTIONALPHA=!1,this.GAMMAREFLECTION=!1,this.RGBDREFLECTION=!1,this.LINEARSPECULARREFLECTION=!1,this.RADIANCEOCCLUSION=!1,this.HORIZONOCCLUSION=!1,this.INSTANCES=!1,this.THIN_INSTANCES=!1,this.INSTANCESCOLOR=!1,this.PREPASS=!1,this.PREPASS_IRRADIANCE=!1,this.PREPASS_IRRADIANCE_INDEX=-1,this.PREPASS_ALBEDO_SQRT=!1,this.PREPASS_ALBEDO_SQRT_INDEX=-1,this.PREPASS_DEPTH=!1,this.PREPASS_DEPTH_INDEX=-1,this.PREPASS_NDC_DEPTH=!1,this.PREPASS_NDC_DEPTH_INDEX=-1,this.PREPASS_NORMAL=!1,this.PREPASS_NORMAL_INDEX=-1,this.PREPASS_NORMAL_WORLDSPACE=!1,this.PREPASS_WORLD_NORMAL=!1,this.PREPASS_WORLD_NORMAL_INDEX=-1,this.PREPASS_POSITION=!1,this.PREPASS_POSITION_INDEX=-1,this.PREPASS_LOCAL_POSITION=!1,this.PREPASS_LOCAL_POSITION_INDEX=-1,this.PREPASS_VELOCITY=!1,this.PREPASS_VELOCITY_INDEX=-1,this.PREPASS_VELOCITY_LINEAR=!1,this.PREPASS_VELOCITY_LINEAR_INDEX=-1,this.PREPASS_REFLECTIVITY=!1,this.PREPASS_REFLECTIVITY_INDEX=-1,this.SCENE_MRT_COUNT=0,this.NUM_BONE_INFLUENCERS=0,this.BonesPerMesh=0,this.BONETEXTURE=!1,this.BONES_VELOCITY_ENABLED=!1,this.NONUNIFORMSCALING=!1,this.MORPHTARGETS=!1,this.MORPHTARGETS_NORMAL=!1,this.MORPHTARGETS_TANGENT=!1,this.MORPHTARGETS_UV=!1,this.NUM_MORPH_INFLUENCERS=0,this.MORPHTARGETS_TEXTURE=!1,this.IMAGEPROCESSING=!1,this.VIGNETTE=!1,this.VIGNETTEBLENDMODEMULTIPLY=!1,this.VIGNETTEBLENDMODEOPAQUE=!1,this.TONEMAPPING=0,this.CONTRAST=!1,this.COLORCURVES=!1,this.COLORGRADING=!1,this.COLORGRADING3D=!1,this.SAMPLER3DGREENDEPTH=!1,this.SAMPLER3DBGRMAP=!1,this.DITHER=!1,this.IMAGEPROCESSINGPOSTPROCESS=!1,this.SKIPFINALCOLORCLAMP=!1,this.EXPOSURE=!1,this.MULTIVIEW=!1,this.ORDER_INDEPENDENT_TRANSPARENCY=!1,this.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!1,this.USEPHYSICALLIGHTFALLOFF=!1,this.USEGLTFLIGHTFALLOFF=!1,this.TWOSIDEDLIGHTING=!1,this.SHADOWFLOAT=!1,this.CLIPPLANE=!1,this.CLIPPLANE2=!1,this.CLIPPLANE3=!1,this.CLIPPLANE4=!1,this.CLIPPLANE5=!1,this.CLIPPLANE6=!1,this.POINTSIZE=!1,this.FOG=!1,this.LOGARITHMICDEPTH=!1,this.CAMERA_ORTHOGRAPHIC=!1,this.CAMERA_PERSPECTIVE=!1,this.FORCENORMALFORWARD=!1,this.SPECULARAA=!1,this.UNLIT=!1,this.DECAL_AFTER_DETAIL=!1,this.DEBUGMODE=0,this.rebuild()}reset(){super.reset(),this.ALPHATESTVALUE="0.5",this.PBR=!0,this.NORMALXYSCALE=!0}}class na extends yK.E{get realTimeFiltering(){return this._realTimeFiltering}set realTimeFiltering(t){this._realTimeFiltering=t,this.markAsDirty(1)}get realTimeFilteringQuality(){return this._realTimeFilteringQuality}set realTimeFilteringQuality(t){this._realTimeFilteringQuality=t,this.markAsDirty(1)}get canRenderToMRT(){return!0}_attachImageProcessingConfiguration(t){t!==this._imageProcessingConfiguration&&(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),this._imageProcessingConfiguration=t||this.getScene().imageProcessingConfiguration,this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add((()=>{this._markAllSubMeshesAsImageProcessingDirty()}))))}constructor(t,K,D=!1){super(t,K),this._directIntensity=1,this._emissiveIntensity=1,this._environmentIntensity=1,this._specularIntensity=1,this._lightingInfos=new N.IU(this._directIntensity,this._emissiveIntensity,this._environmentIntensity,this._specularIntensity),this._disableBumpMap=!1,this._albedoTexture=null,this._ambientTexture=null,this._ambientTextureStrength=1,this._ambientTextureImpactOnAnalyticalLights=na.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,this._opacityTexture=null,this._reflectionTexture=null,this._emissiveTexture=null,this._reflectivityTexture=null,this._metallicTexture=null,this._metallic=null,this._roughness=null,this._metallicF0Factor=1,this._metallicReflectanceColor=s.v9.White(),this._useOnlyMetallicFromMetallicReflectanceTexture=!1,this._metallicReflectanceTexture=null,this._reflectanceTexture=null,this._microSurfaceTexture=null,this._bumpTexture=null,this._lightmapTexture=null,this._ambientColor=new s.v9(0,0,0),this._albedoColor=new s.v9(1,1,1),this._reflectivityColor=new s.v9(1,1,1),this._reflectionColor=new s.v9(1,1,1),this._emissiveColor=new s.v9(0,0,0),this._microSurface=.9,this._useLightmapAsShadowmap=!1,this._useHorizonOcclusion=!0,this._useRadianceOcclusion=!0,this._useAlphaFromAlbedoTexture=!1,this._useSpecularOverAlpha=!0,this._useMicroSurfaceFromReflectivityMapAlpha=!1,this._useRoughnessFromMetallicTextureAlpha=!0,this._useRoughnessFromMetallicTextureGreen=!1,this._useMetallnessFromMetallicTextureBlue=!1,this._useAmbientOcclusionFromMetallicTextureRed=!1,this._useAmbientInGrayScale=!1,this._useAutoMicroSurfaceFromReflectivityMap=!1,this._lightFalloff=na.LIGHTFALLOFF_PHYSICAL,this._useRadianceOverAlpha=!0,this._useObjectSpaceNormalMap=!1,this._useParallax=!1,this._useParallaxOcclusion=!1,this._parallaxScaleBias=.05,this._disableLighting=!1,this._maxSimultaneousLights=4,this._invertNormalMapX=!1,this._invertNormalMapY=!1,this._twoSidedLighting=!1,this._alphaCutOff=.4,this._forceAlphaTest=!1,this._useAlphaFresnel=!1,this._useLinearAlphaFresnel=!1,this._environmentBRDFTexture=null,this._forceIrradianceInFragment=!1,this._realTimeFiltering=!1,this._realTimeFilteringQuality=8,this._forceNormalForward=!1,this._enableSpecularAntiAliasing=!1,this._imageProcessingObserver=null,this._renderTargets=new NK.L(16),this._globalAmbientColor=new s.v9(0,0,0),this._unlit=!1,this._applyDecalMapAfterDetailMap=!1,this._debugMode=0,this._shadersLoaded=!1,this._breakShaderLoadedCheck=!1,this.debugMode=0,this.debugLimit=-1,this.debugFactor=1,this._cacheHasRenderTargetTextures=!1;const a=this.getScene().getEngine();!a.isWebGPU||D||na.ForceGLSL||(this._uniformBuffer&&this._uniformBuffer.dispose(),this._uniformBuffer=new Wa.D(a,void 0,void 0,this.name,!0),this._shaderLanguage=1),this.brdf=new $D(this),this.clearCoat=new jD(this),this.iridescence=new MD(this),this.anisotropy=new ta(this),this.sheen=new Da(this),this.subSurface=new Ga(this),this.detailMap=new Na.c(this),this._attachImageProcessingConfiguration(null),this.getRenderTargetTextures=()=>(this._renderTargets.reset(),vD.h.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget&&this._renderTargets.push(this._reflectionTexture),this._eventInfo.renderTargets=this._renderTargets,this._callbackPluginEventFillRenderTargetTextures(this._eventInfo),this._renderTargets),this._environmentBRDFTexture=YD(this.getScene()),this.prePassConfiguration=new BD.J}get hasRenderTargetTextures(){return!!(vD.h.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget)||this._cacheHasRenderTargetTextures}get isPrePassCapable(){return!this.disableDepthWrite}getClassName(){return"PBRBaseMaterial"}get _disableAlphaBlending(){var t;return this._transparencyMode===na.PBRMATERIAL_OPAQUE||this._transparencyMode===na.PBRMATERIAL_ALPHATEST||(null===(t=this.subSurface)||void 0===t?void 0:t.disableAlphaBlending)}needAlphaBlending(){return!this._disableAlphaBlending&&(this.alpha<1||null!=this._opacityTexture||this._shouldUseAlphaFromAlbedoTexture())}needAlphaTesting(){var t;return!!this._forceAlphaTest||!(null===(t=this.subSurface)||void 0===t?void 0:t.disableAlphaBlending)&&this._hasAlphaChannel()&&(null==this._transparencyMode||this._transparencyMode===na.PBRMATERIAL_ALPHATEST)}_shouldUseAlphaFromAlbedoTexture(){return null!=this._albedoTexture&&this._albedoTexture.hasAlpha&&this._useAlphaFromAlbedoTexture&&this._transparencyMode!==na.PBRMATERIAL_OPAQUE}_hasAlphaChannel(){return null!=this._albedoTexture&&this._albedoTexture.hasAlpha||null!=this._opacityTexture}getAlphaTestTexture(){return this._albedoTexture}isReadyForSubMesh(t,K,D){var a;this._uniformBufferLayoutBuilt||this.buildUniformLayout();const G=K._drawWrapper;if(G.effect&&this.isFrozen&&G._wasPreviouslyReady&&G._wasPreviouslyUsingInstances===D)return!0;K.materialDefines||(this._callbackPluginEventGeneric(4,this._eventInfo),K.materialDefines=new ba(this._eventInfo.defineNames));const N=K.materialDefines;if(this._isReadyForSubMesh(K))return!0;const W=this.getScene(),x=W.getEngine();if(N._areTexturesDirty&&(this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._cacheHasRenderTargetTextures=this._eventInfo.hasRenderTargetTextures,W.texturesEnabled)){if(this._albedoTexture&&vD.h.DiffuseTextureEnabled&&!this._albedoTexture.isReadyOrNotBlocking())return!1;if(this._ambientTexture&&vD.h.AmbientTextureEnabled&&!this._ambientTexture.isReadyOrNotBlocking())return!1;if(this._opacityTexture&&vD.h.OpacityTextureEnabled&&!this._opacityTexture.isReadyOrNotBlocking())return!1;const t=this._getReflectionTexture();if(t&&vD.h.ReflectionTextureEnabled){if(!t.isReadyOrNotBlocking())return!1;if(t.irradianceTexture){if(!t.irradianceTexture.isReadyOrNotBlocking())return!1}else if(!t.sphericalPolynomial&&(null===(a=t.getInternalTexture())||void 0===a?void 0:a._sphericalPolynomialPromise))return!1}if(this._lightmapTexture&&vD.h.LightmapTextureEnabled&&!this._lightmapTexture.isReadyOrNotBlocking())return!1;if(this._emissiveTexture&&vD.h.EmissiveTextureEnabled&&!this._emissiveTexture.isReadyOrNotBlocking())return!1;if(vD.h.SpecularTextureEnabled){if(this._metallicTexture){if(!this._metallicTexture.isReadyOrNotBlocking())return!1}else if(this._reflectivityTexture&&!this._reflectivityTexture.isReadyOrNotBlocking())return!1;if(this._metallicReflectanceTexture&&!this._metallicReflectanceTexture.isReadyOrNotBlocking())return!1;if(this._reflectanceTexture&&!this._reflectanceTexture.isReadyOrNotBlocking())return!1;if(this._microSurfaceTexture&&!this._microSurfaceTexture.isReadyOrNotBlocking())return!1}if(x.getCaps().standardDerivatives&&this._bumpTexture&&vD.h.BumpTextureEnabled&&!this._disableBumpMap&&!this._bumpTexture.isReady())return!1;if(this._environmentBRDFTexture&&vD.h.ReflectionTextureEnabled&&!this._environmentBRDFTexture.isReady())return!1}if(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=N,this._eventInfo.subMesh=K,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),!this._eventInfo.isReadyForSubMesh)return!1;if(N._areImageProcessingDirty&&this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.isReady())return!1;x.getCaps().standardDerivatives||t.isVerticesDataPresent(R.R.NormalKind)||(t.createNormals(!0),i.V.Warn("PBRMaterial: Normals have been created for the mesh: "+t.name));const b=K.effect,n=N._areLightsDisposed;let e=this._prepareEffect(t,N,this.onCompiled,this.onError,D,null,K.getRenderingMesh().hasThinInstances),z=!1;if(e)if(this._onEffectCreatedObservable&&(xa.effect=e,xa.subMesh=K,this._onEffectCreatedObservable.notifyObservers(xa)),this.allowShaderHotSwapping&&b&&!e.isReady()){if(e=b,N.markAsUnprocessed(),z=this.isFrozen,n)return N._areLightsDisposed=!0,!1}else W.resetCachedMaterial(),K.setEffect(e,N,this._materialContext);return!(!K.effect||!K.effect.isReady()||(N._renderId=W.getRenderId(),G._wasPreviouslyReady=!z,G._wasPreviouslyUsingInstances=!!D,this._checkScenePerformancePriority(),0))}isMetallicWorkflow(){return!(null==this._metallic&&null==this._roughness&&!this._metallicTexture)}_prepareEffect(t,K,a=null,G=null,N=null,W=null,x){if(this._prepareDefines(t,K,N,W,x),!K.isDirty)return null;K.markAsProcessed();const b=this.getScene().getEngine(),n=new PK.J;let e=0;K.USESPHERICALINVERTEX&&n.addFallback(e++,"USESPHERICALINVERTEX"),K.FOG&&n.addFallback(e,"FOG"),K.SPECULARAA&&n.addFallback(e,"SPECULARAA"),K.POINTSIZE&&n.addFallback(e,"POINTSIZE"),K.LOGARITHMICDEPTH&&n.addFallback(e,"LOGARITHMICDEPTH"),K.PARALLAX&&n.addFallback(e,"PARALLAX"),K.PARALLAX_RHS&&n.addFallback(e,"PARALLAX_RHS"),K.PARALLAXOCCLUSION&&n.addFallback(e++,"PARALLAXOCCLUSION"),K.ENVIRONMENTBRDF&&n.addFallback(e++,"ENVIRONMENTBRDF"),K.TANGENT&&n.addFallback(e++,"TANGENT"),K.BUMP&&n.addFallback(e++,"BUMP"),e=XK.c4(K,n,this._maxSimultaneousLights,e++),K.SPECULARTERM&&n.addFallback(e++,"SPECULARTERM"),K.USESPHERICALFROMREFLECTIONMAP&&n.addFallback(e++,"USESPHERICALFROMREFLECTIONMAP"),K.USEIRRADIANCEMAP&&n.addFallback(e++,"USEIRRADIANCEMAP"),K.LIGHTMAP&&n.addFallback(e++,"LIGHTMAP"),K.NORMAL&&n.addFallback(e++,"NORMAL"),K.AMBIENT&&n.addFallback(e++,"AMBIENT"),K.EMISSIVE&&n.addFallback(e++,"EMISSIVE"),K.VERTEXCOLOR&&n.addFallback(e++,"VERTEXCOLOR"),K.MORPHTARGETS&&n.addFallback(e++,"MORPHTARGETS"),K.MULTIVIEW&&n.addFallback(0,"MULTIVIEW");const i=[R.R.PositionKind];K.NORMAL&&i.push(R.R.NormalKind),K.TANGENT&&i.push(R.R.TangentKind);for(let t=1;t<=6;++t)K["UV"+t]&&i.push(`uv${1===t?"":t}`);K.VERTEXCOLOR&&i.push(R.R.ColorKind),XK.ni(i,t,K,n),XK.ER(i,K),XK.IF(i,t,K),XK.J2(i,t,K);let z="pbr";const I=["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vAlbedoColor","vReflectivityColor","vMetallicReflectanceFactors","vEmissiveColor","visibility","vReflectionColor","vFogInfos","vFogColor","pointSize","vAlbedoInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vReflectionPosition","vReflectionSize","vEmissiveInfos","vReflectivityInfos","vReflectionFilteringInfo","vMetallicReflectanceInfos","vReflectanceInfos","vMicroSurfaceSamplerInfos","vBumpInfos","vLightmapInfos","mBones","albedoMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","reflectivityMatrix","normalMatrix","microSurfaceSamplerMatrix","bumpMatrix","lightmapMatrix","metallicReflectanceMatrix","reflectanceMatrix","vLightingIntensity","logarithmicDepthConstant","vSphericalX","vSphericalY","vSphericalZ","vSphericalXX_ZZ","vSphericalYY_ZZ","vSphericalZZ","vSphericalXY","vSphericalYZ","vSphericalZX","vSphericalL00","vSphericalL1_1","vSphericalL10","vSphericalL11","vSphericalL2_2","vSphericalL2_1","vSphericalL20","vSphericalL21","vSphericalL22","vReflectionMicrosurfaceInfos","vTangentSpaceParams","boneTextureWidth","vDebugMode","morphTargetTextureInfo","morphTargetTextureIndices"],Z=["albedoSampler","reflectivitySampler","ambientSampler","emissiveSampler","bumpSampler","lightmapSampler","opacitySampler","reflectionSampler","reflectionSamplerLow","reflectionSamplerHigh","irradianceSampler","microSurfaceSampler","environmentBrdfSampler","boneSampler","metallicReflectanceSampler","reflectanceSampler","morphTargets","oitDepthSampler","oitFrontColorSampler"],w=["Material","Scene","Mesh"],m={maxSimultaneousLights:this._maxSimultaneousLights,maxSimultaneousMorphTargets:K.NUM_MORPH_INFLUENCERS};this._eventInfo.fallbacks=n,this._eventInfo.fallbackRank=e,this._eventInfo.defines=K,this._eventInfo.uniforms=I,this._eventInfo.attributes=i,this._eventInfo.samplers=Z,this._eventInfo.uniformBuffersNames=w,this._eventInfo.customCode=void 0,this._eventInfo.mesh=t,this._eventInfo.indexParameters=m,this._callbackPluginEventGeneric(128,this._eventInfo),BD.J.AddUniforms(I),BD.J.AddSamplers(Z),qK.TV(I),OD.p&&(OD.p.PrepareUniforms(I,K),OD.p.PrepareSamplers(Z,K)),XK.Bb({uniformsNames:I,uniformBuffersNames:w,samplers:Z,defines:K,maxSimultaneousLights:this._maxSimultaneousLights});const u={};this.customShaderNameResolve&&(z=this.customShaderNameResolve(z,I,w,Z,K,i,u));const d=K.toString(),E=b.createEffect(z,{attributes:i,uniformsNames:I,uniformBuffersNames:w,samplers:Z,defines:d,fallbacks:n,onCompiled:a,onError:G,indexParameters:m,processFinalCode:u.processFinalCode,processCodeAfterIncludes:this._eventInfo.customCode,multiTarget:K.PREPASS,shaderLanguage:this._shaderLanguage,extraInitializationsAsync:this._shadersLoaded?void 0:async()=>{1===this.shaderLanguage?await Promise.all([D.e(8873).then(D.bind(D,308873)),D.e(88918).then(D.bind(D,788918))]):await Promise.all([D.e(60079).then(D.bind(D,60079)),D.e(99697).then(D.bind(D,499697))]),this._shadersLoaded=!0}},b);return this._eventInfo.customCode=void 0,E}_prepareDefines(t,K,D=null,a=null,G=!1){const N=this.getScene(),W=N.getEngine();XK.az(N,t,K,!0,this._maxSimultaneousLights,this._disableLighting),K._needNormals=!0,XK.VO(N,K);const x=this.needAlphaBlendingForMesh(t)&&this.getScene().useOrderIndependentTransparency;if(XK.N4(N,K,this.canRenderToMRT&&!x),XK.Nc(N,K,x),K.METALLICWORKFLOW=this.isMetallicWorkflow(),K._areTexturesDirty){K._needUVs=!1;for(let t=1;t<=6;++t)K["MAINUV"+t]=!1;if(N.texturesEnabled){K.ALBEDODIRECTUV=0,K.AMBIENTDIRECTUV=0,K.OPACITYDIRECTUV=0,K.EMISSIVEDIRECTUV=0,K.REFLECTIVITYDIRECTUV=0,K.MICROSURFACEMAPDIRECTUV=0,K.METALLIC_REFLECTANCEDIRECTUV=0,K.REFLECTANCEDIRECTUV=0,K.BUMPDIRECTUV=0,K.LIGHTMAPDIRECTUV=0,W.getCaps().textureLOD&&(K.LODBASEDMICROSFURACE=!0),this._albedoTexture&&vD.h.DiffuseTextureEnabled?(XK.YT(this._albedoTexture,K,"ALBEDO"),K.GAMMAALBEDO=this._albedoTexture.gammaSpace):K.ALBEDO=!1,this._ambientTexture&&vD.h.AmbientTextureEnabled?(XK.YT(this._ambientTexture,K,"AMBIENT"),K.AMBIENTINGRAYSCALE=this._useAmbientInGrayScale):K.AMBIENT=!1,this._opacityTexture&&vD.h.OpacityTextureEnabled?(XK.YT(this._opacityTexture,K,"OPACITY"),K.OPACITYRGB=this._opacityTexture.getAlphaFromRGB):K.OPACITY=!1;const t=this._getReflectionTexture();if(t&&vD.h.ReflectionTextureEnabled){switch(K.REFLECTION=!0,K.GAMMAREFLECTION=t.gammaSpace,K.RGBDREFLECTION=t.isRGBD,K.LODINREFLECTIONALPHA=t.lodLevelInAlpha,K.LINEARSPECULARREFLECTION=t.linearSpecularLOD,this.realTimeFiltering&&this.realTimeFilteringQuality>0?(K.NUM_SAMPLES=""+this.realTimeFilteringQuality,W._features.needTypeSuffixInShaderConstants&&(K.NUM_SAMPLES=K.NUM_SAMPLES+"u"),K.REALTIME_FILTERING=!0):K.REALTIME_FILTERING=!1,K.INVERTCUBICMAP=t.coordinatesMode===U.g.INVCUBIC_MODE,K.REFLECTIONMAP_3D=t.isCube,K.REFLECTIONMAP_OPPOSITEZ=K.REFLECTIONMAP_3D&&this.getScene().useRightHandedSystem?!t.invertZ:t.invertZ,K.REFLECTIONMAP_CUBIC=!1,K.REFLECTIONMAP_EXPLICIT=!1,K.REFLECTIONMAP_PLANAR=!1,K.REFLECTIONMAP_PROJECTION=!1,K.REFLECTIONMAP_SKYBOX=!1,K.REFLECTIONMAP_SPHERICAL=!1,K.REFLECTIONMAP_EQUIRECTANGULAR=!1,K.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,K.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,t.coordinatesMode){case U.g.EXPLICIT_MODE:K.REFLECTIONMAP_EXPLICIT=!0;break;case U.g.PLANAR_MODE:K.REFLECTIONMAP_PLANAR=!0;break;case U.g.PROJECTION_MODE:K.REFLECTIONMAP_PROJECTION=!0;break;case U.g.SKYBOX_MODE:K.REFLECTIONMAP_SKYBOX=!0;break;case U.g.SPHERICAL_MODE:K.REFLECTIONMAP_SPHERICAL=!0;break;case U.g.EQUIRECTANGULAR_MODE:K.REFLECTIONMAP_EQUIRECTANGULAR=!0;break;case U.g.FIXED_EQUIRECTANGULAR_MODE:K.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!0;break;case U.g.FIXED_EQUIRECTANGULAR_MIRRORED_MODE:K.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!0;break;case U.g.CUBIC_MODE:case U.g.INVCUBIC_MODE:default:K.REFLECTIONMAP_CUBIC=!0,K.USE_LOCAL_REFLECTIONMAP_CUBIC=!!t.boundingBoxSize}t.coordinatesMode!==U.g.SKYBOX_MODE&&(t.irradianceTexture?(K.USEIRRADIANCEMAP=!0,K.USESPHERICALFROMREFLECTIONMAP=!1):t.isCube&&(K.USESPHERICALFROMREFLECTIONMAP=!0,K.USEIRRADIANCEMAP=!1,this._forceIrradianceInFragment||this.realTimeFiltering||this._twoSidedLighting||W.getCaps().maxVaryingVectors<=8?K.USESPHERICALINVERTEX=!1:K.USESPHERICALINVERTEX=!0))}else K.REFLECTION=!1,K.REFLECTIONMAP_3D=!1,K.REFLECTIONMAP_SPHERICAL=!1,K.REFLECTIONMAP_PLANAR=!1,K.REFLECTIONMAP_CUBIC=!1,K.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,K.REFLECTIONMAP_PROJECTION=!1,K.REFLECTIONMAP_SKYBOX=!1,K.REFLECTIONMAP_EXPLICIT=!1,K.REFLECTIONMAP_EQUIRECTANGULAR=!1,K.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,K.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,K.INVERTCUBICMAP=!1,K.USESPHERICALFROMREFLECTIONMAP=!1,K.USEIRRADIANCEMAP=!1,K.USESPHERICALINVERTEX=!1,K.REFLECTIONMAP_OPPOSITEZ=!1,K.LODINREFLECTIONALPHA=!1,K.GAMMAREFLECTION=!1,K.RGBDREFLECTION=!1,K.LINEARSPECULARREFLECTION=!1;this._lightmapTexture&&vD.h.LightmapTextureEnabled?(XK.YT(this._lightmapTexture,K,"LIGHTMAP"),K.USELIGHTMAPASSHADOWMAP=this._useLightmapAsShadowmap,K.GAMMALIGHTMAP=this._lightmapTexture.gammaSpace,K.RGBDLIGHTMAP=this._lightmapTexture.isRGBD):K.LIGHTMAP=!1,this._emissiveTexture&&vD.h.EmissiveTextureEnabled?(XK.YT(this._emissiveTexture,K,"EMISSIVE"),K.GAMMAEMISSIVE=this._emissiveTexture.gammaSpace):K.EMISSIVE=!1,vD.h.SpecularTextureEnabled?(this._metallicTexture?(XK.YT(this._metallicTexture,K,"REFLECTIVITY"),K.ROUGHNESSSTOREINMETALMAPALPHA=this._useRoughnessFromMetallicTextureAlpha,K.ROUGHNESSSTOREINMETALMAPGREEN=!this._useRoughnessFromMetallicTextureAlpha&&this._useRoughnessFromMetallicTextureGreen,K.METALLNESSSTOREINMETALMAPBLUE=this._useMetallnessFromMetallicTextureBlue,K.AOSTOREINMETALMAPRED=this._useAmbientOcclusionFromMetallicTextureRed,K.REFLECTIVITY_GAMMA=!1):this._reflectivityTexture?(XK.YT(this._reflectivityTexture,K,"REFLECTIVITY"),K.MICROSURFACEFROMREFLECTIVITYMAP=this._useMicroSurfaceFromReflectivityMapAlpha,K.MICROSURFACEAUTOMATIC=this._useAutoMicroSurfaceFromReflectivityMap,K.REFLECTIVITY_GAMMA=this._reflectivityTexture.gammaSpace):K.REFLECTIVITY=!1,this._metallicReflectanceTexture||this._reflectanceTexture?(K.METALLIC_REFLECTANCE_USE_ALPHA_ONLY=this._useOnlyMetallicFromMetallicReflectanceTexture,this._metallicReflectanceTexture?(XK.YT(this._metallicReflectanceTexture,K,"METALLIC_REFLECTANCE"),K.METALLIC_REFLECTANCE_GAMMA=this._metallicReflectanceTexture.gammaSpace):K.METALLIC_REFLECTANCE=!1,this._reflectanceTexture&&(!this._metallicReflectanceTexture||this._metallicReflectanceTexture&&this._useOnlyMetallicFromMetallicReflectanceTexture)?(XK.YT(this._reflectanceTexture,K,"REFLECTANCE"),K.REFLECTANCE_GAMMA=this._reflectanceTexture.gammaSpace):K.REFLECTANCE=!1):(K.METALLIC_REFLECTANCE=!1,K.REFLECTANCE=!1),this._microSurfaceTexture?XK.YT(this._microSurfaceTexture,K,"MICROSURFACEMAP"):K.MICROSURFACEMAP=!1):(K.REFLECTIVITY=!1,K.MICROSURFACEMAP=!1),W.getCaps().standardDerivatives&&this._bumpTexture&&vD.h.BumpTextureEnabled&&!this._disableBumpMap?(XK.YT(this._bumpTexture,K,"BUMP"),this._useParallax&&this._albedoTexture&&vD.h.DiffuseTextureEnabled?(K.PARALLAX=!0,K.PARALLAX_RHS=N.useRightHandedSystem,K.PARALLAXOCCLUSION=!!this._useParallaxOcclusion):K.PARALLAX=!1,K.OBJECTSPACE_NORMALMAP=this._useObjectSpaceNormalMap):(K.BUMP=!1,K.PARALLAX=!1,K.PARALLAX_RHS=!1,K.PARALLAXOCCLUSION=!1,K.OBJECTSPACE_NORMALMAP=!1),this._environmentBRDFTexture&&vD.h.ReflectionTextureEnabled?(K.ENVIRONMENTBRDF=!0,K.ENVIRONMENTBRDF_RGBD=this._environmentBRDFTexture.isRGBD):(K.ENVIRONMENTBRDF=!1,K.ENVIRONMENTBRDF_RGBD=!1),this._shouldUseAlphaFromAlbedoTexture()?K.ALPHAFROMALBEDO=!0:K.ALPHAFROMALBEDO=!1}K.SPECULAROVERALPHA=this._useSpecularOverAlpha,this._lightFalloff===na.LIGHTFALLOFF_STANDARD?(K.USEPHYSICALLIGHTFALLOFF=!1,K.USEGLTFLIGHTFALLOFF=!1):this._lightFalloff===na.LIGHTFALLOFF_GLTF?(K.USEPHYSICALLIGHTFALLOFF=!1,K.USEGLTFLIGHTFALLOFF=!0):(K.USEPHYSICALLIGHTFALLOFF=!0,K.USEGLTFLIGHTFALLOFF=!1),K.RADIANCEOVERALPHA=this._useRadianceOverAlpha,!this.backFaceCulling&&this._twoSidedLighting?K.TWOSIDEDLIGHTING=!0:K.TWOSIDEDLIGHTING=!1,K.SPECULARAA=W.getCaps().standardDerivatives&&this._enableSpecularAntiAliasing}(K._areTexturesDirty||K._areMiscDirty)&&(K.ALPHATESTVALUE=`${this._alphaCutOff}${this._alphaCutOff%1==0?".":""}`,K.PREMULTIPLYALPHA=7===this.alphaMode||8===this.alphaMode,K.ALPHABLEND=this.needAlphaBlendingForMesh(t),K.ALPHAFRESNEL=this._useAlphaFresnel||this._useLinearAlphaFresnel,K.LINEARALPHAFRESNEL=this._useLinearAlphaFresnel),K._areImageProcessingDirty&&this._imageProcessingConfiguration&&this._imageProcessingConfiguration.prepareDefines(K),K.FORCENORMALFORWARD=this._forceNormalForward,K.RADIANCEOCCLUSION=this._useRadianceOcclusion,K.HORIZONOCCLUSION=this._useHorizonOcclusion,K._areMiscDirty&&(XK.fm(t,N,this._useLogarithmicDepth,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(t)||this._forceAlphaTest,K,this._applyDecalMapAfterDetailMap),K.UNLIT=this._unlit||(this.pointsCloud||this.wireframe)&&!t.isVerticesDataPresent(R.R.NormalKind),K.DEBUGMODE=this._debugMode),XK.OR(N,W,this,K,!!D,a,G),this._eventInfo.defines=K,this._eventInfo.mesh=t,this._callbackPluginEventPrepareDefinesBeforeAttributes(this._eventInfo),XK.qB(t,K,!0,!0,!0,this._transparencyMode!==na.PBRMATERIAL_OPAQUE),this._callbackPluginEventPrepareDefines(this._eventInfo)}forceCompilation(t,K,D){const a={clipPlane:!1,useInstances:!1,...D};this._uniformBufferLayoutBuilt||this.buildUniformLayout(),this._callbackPluginEventGeneric(4,this._eventInfo),(()=>{if(this._breakShaderLoadedCheck)return;const D=new ba(this._eventInfo.defineNames),G=this._prepareEffect(t,D,void 0,void 0,a.useInstances,a.clipPlane,t.hasThinInstances);this._onEffectCreatedObservable&&(xa.effect=G,xa.subMesh=null,this._onEffectCreatedObservable.notifyObservers(xa)),G.isReady()?K&&K(this):G.onCompileObservable.add((()=>{K&&K(this)}))})()}buildUniformLayout(){const t=this._uniformBuffer;t.addUniform("vAlbedoInfos",2),t.addUniform("vAmbientInfos",4),t.addUniform("vOpacityInfos",2),t.addUniform("vEmissiveInfos",2),t.addUniform("vLightmapInfos",2),t.addUniform("vReflectivityInfos",3),t.addUniform("vMicroSurfaceSamplerInfos",2),t.addUniform("vReflectionInfos",2),t.addUniform("vReflectionFilteringInfo",2),t.addUniform("vReflectionPosition",3),t.addUniform("vReflectionSize",3),t.addUniform("vBumpInfos",3),t.addUniform("albedoMatrix",16),t.addUniform("ambientMatrix",16),t.addUniform("opacityMatrix",16),t.addUniform("emissiveMatrix",16),t.addUniform("lightmapMatrix",16),t.addUniform("reflectivityMatrix",16),t.addUniform("microSurfaceSamplerMatrix",16),t.addUniform("bumpMatrix",16),t.addUniform("vTangentSpaceParams",2),t.addUniform("reflectionMatrix",16),t.addUniform("vReflectionColor",3),t.addUniform("vAlbedoColor",4),t.addUniform("vLightingIntensity",4),t.addUniform("vReflectionMicrosurfaceInfos",3),t.addUniform("pointSize",1),t.addUniform("vReflectivityColor",4),t.addUniform("vEmissiveColor",3),t.addUniform("vAmbientColor",3),t.addUniform("vDebugMode",2),t.addUniform("vMetallicReflectanceFactors",4),t.addUniform("vMetallicReflectanceInfos",2),t.addUniform("metallicReflectanceMatrix",16),t.addUniform("vReflectanceInfos",2),t.addUniform("reflectanceMatrix",16),t.addUniform("vSphericalL00",3),t.addUniform("vSphericalL1_1",3),t.addUniform("vSphericalL10",3),t.addUniform("vSphericalL11",3),t.addUniform("vSphericalL2_2",3),t.addUniform("vSphericalL2_1",3),t.addUniform("vSphericalL20",3),t.addUniform("vSphericalL21",3),t.addUniform("vSphericalL22",3),t.addUniform("vSphericalX",3),t.addUniform("vSphericalY",3),t.addUniform("vSphericalZ",3),t.addUniform("vSphericalXX_ZZ",3),t.addUniform("vSphericalYY_ZZ",3),t.addUniform("vSphericalZZ",3),t.addUniform("vSphericalXY",3),t.addUniform("vSphericalYZ",3),t.addUniform("vSphericalZX",3),super.buildUniformLayout()}bindForSubMesh(t,K,D){var a,G,N,W;const x=this.getScene(),b=D.materialDefines;if(!b)return;const n=D.effect;if(!n)return;this._activeEffect=n,K.getMeshUniformBuffer().bindToEffect(n,"Mesh"),K.transferToEffect(t);const e=x.getEngine();this._uniformBuffer.bindToEffect(n,"Material"),this.prePassConfiguration.bindForSubMesh(this._activeEffect,x,K,t,this.isFrozen),this._eventInfo.subMesh=D,this._callbackPluginEventHardBindForSubMesh(this._eventInfo),b.OBJECTSPACE_NORMALMAP&&(t.toNormalMatrix(this._normalMatrix),this.bindOnlyNormalMatrix(this._normalMatrix));const i=this._mustRebind(x,n,D,K.visibility);XK.f$(K,this._activeEffect,this.prePassConfiguration);let z=null;const I=this._uniformBuffer;if(i){if(this.bindViewProjection(n),z=this._getReflectionTexture(),!I.useUbo||!this.isFrozen||!I.isSync||D._drawWrapper._forceRebindOnNextCall){if(x.texturesEnabled){if(this._albedoTexture&&vD.h.DiffuseTextureEnabled&&(I.updateFloat2("vAlbedoInfos",this._albedoTexture.coordinatesIndex,this._albedoTexture.level),XK.mA(this._albedoTexture,I,"albedo")),this._ambientTexture&&vD.h.AmbientTextureEnabled&&(I.updateFloat4("vAmbientInfos",this._ambientTexture.coordinatesIndex,this._ambientTexture.level,this._ambientTextureStrength,this._ambientTextureImpactOnAnalyticalLights),XK.mA(this._ambientTexture,I,"ambient")),this._opacityTexture&&vD.h.OpacityTextureEnabled&&(I.updateFloat2("vOpacityInfos",this._opacityTexture.coordinatesIndex,this._opacityTexture.level),XK.mA(this._opacityTexture,I,"opacity")),z&&vD.h.ReflectionTextureEnabled){if(I.updateMatrix("reflectionMatrix",z.getReflectionTextureMatrix()),I.updateFloat2("vReflectionInfos",z.level,0),z.boundingBoxSize){const t=z;I.updateVector3("vReflectionPosition",t.boundingBoxPosition),I.updateVector3("vReflectionSize",t.boundingBoxSize)}if(this.realTimeFiltering){const t=z.getSize().width;I.updateFloat2("vReflectionFilteringInfo",t,it.X.Log2(t))}if(!b.USEIRRADIANCEMAP){const t=z.sphericalPolynomial;if(b.USESPHERICALFROMREFLECTIONMAP&&t)if(b.SPHERICAL_HARMONICS){const K=t.preScaledHarmonics;I.updateVector3("vSphericalL00",K.l00),I.updateVector3("vSphericalL1_1",K.l1_1),I.updateVector3("vSphericalL10",K.l10),I.updateVector3("vSphericalL11",K.l11),I.updateVector3("vSphericalL2_2",K.l2_2),I.updateVector3("vSphericalL2_1",K.l2_1),I.updateVector3("vSphericalL20",K.l20),I.updateVector3("vSphericalL21",K.l21),I.updateVector3("vSphericalL22",K.l22)}else I.updateFloat3("vSphericalX",t.x.x,t.x.y,t.x.z),I.updateFloat3("vSphericalY",t.y.x,t.y.y,t.y.z),I.updateFloat3("vSphericalZ",t.z.x,t.z.y,t.z.z),I.updateFloat3("vSphericalXX_ZZ",t.xx.x-t.zz.x,t.xx.y-t.zz.y,t.xx.z-t.zz.z),I.updateFloat3("vSphericalYY_ZZ",t.yy.x-t.zz.x,t.yy.y-t.zz.y,t.yy.z-t.zz.z),I.updateFloat3("vSphericalZZ",t.zz.x,t.zz.y,t.zz.z),I.updateFloat3("vSphericalXY",t.xy.x,t.xy.y,t.xy.z),I.updateFloat3("vSphericalYZ",t.yz.x,t.yz.y,t.yz.z),I.updateFloat3("vSphericalZX",t.zx.x,t.zx.y,t.zx.z)}I.updateFloat3("vReflectionMicrosurfaceInfos",z.getSize().width,z.lodGenerationScale,z.lodGenerationOffset)}this._emissiveTexture&&vD.h.EmissiveTextureEnabled&&(I.updateFloat2("vEmissiveInfos",this._emissiveTexture.coordinatesIndex,this._emissiveTexture.level),XK.mA(this._emissiveTexture,I,"emissive")),this._lightmapTexture&&vD.h.LightmapTextureEnabled&&(I.updateFloat2("vLightmapInfos",this._lightmapTexture.coordinatesIndex,this._lightmapTexture.level),XK.mA(this._lightmapTexture,I,"lightmap")),vD.h.SpecularTextureEnabled&&(this._metallicTexture?(I.updateFloat3("vReflectivityInfos",this._metallicTexture.coordinatesIndex,this._metallicTexture.level,this._ambientTextureStrength),XK.mA(this._metallicTexture,I,"reflectivity")):this._reflectivityTexture&&(I.updateFloat3("vReflectivityInfos",this._reflectivityTexture.coordinatesIndex,this._reflectivityTexture.level,1),XK.mA(this._reflectivityTexture,I,"reflectivity")),this._metallicReflectanceTexture&&(I.updateFloat2("vMetallicReflectanceInfos",this._metallicReflectanceTexture.coordinatesIndex,this._metallicReflectanceTexture.level),XK.mA(this._metallicReflectanceTexture,I,"metallicReflectance")),this._reflectanceTexture&&b.REFLECTANCE&&(I.updateFloat2("vReflectanceInfos",this._reflectanceTexture.coordinatesIndex,this._reflectanceTexture.level),XK.mA(this._reflectanceTexture,I,"reflectance")),this._microSurfaceTexture&&(I.updateFloat2("vMicroSurfaceSamplerInfos",this._microSurfaceTexture.coordinatesIndex,this._microSurfaceTexture.level),XK.mA(this._microSurfaceTexture,I,"microSurfaceSampler"))),this._bumpTexture&&e.getCaps().standardDerivatives&&vD.h.BumpTextureEnabled&&!this._disableBumpMap&&(I.updateFloat3("vBumpInfos",this._bumpTexture.coordinatesIndex,this._bumpTexture.level,this._parallaxScaleBias),XK.mA(this._bumpTexture,I,"bump"),x._mirroredCameraPosition?I.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?1:-1,this._invertNormalMapY?1:-1):I.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?-1:1,this._invertNormalMapY?-1:1))}if(this.pointsCloud&&I.updateFloat("pointSize",this.pointSize),b.METALLICWORKFLOW){s.IG.Color3[0].r=void 0===this._metallic||null===this._metallic?1:this._metallic,s.IG.Color3[0].g=void 0===this._roughness||null===this._roughness?1:this._roughness,I.updateColor4("vReflectivityColor",s.IG.Color3[0],1);const t=null!==(G=null===(a=this.subSurface)||void 0===a?void 0:a._indexOfRefraction)&&void 0!==G?G:1.5,K=1,D=Math.pow((t-K)/(t+K),2);this._metallicReflectanceColor.scaleToRef(D*this._metallicF0Factor,s.IG.Color3[0]);const N=this._metallicF0Factor;I.updateColor4("vMetallicReflectanceFactors",s.IG.Color3[0],N)}else I.updateColor4("vReflectivityColor",this._reflectivityColor,this._microSurface);I.updateColor3("vEmissiveColor",vD.h.EmissiveTextureEnabled?this._emissiveColor:s.v9.BlackReadOnly),I.updateColor3("vReflectionColor",this._reflectionColor),!b.SS_REFRACTION&&(null===(N=this.subSurface)||void 0===N?void 0:N._linkRefractionWithTransparency)?I.updateColor4("vAlbedoColor",this._albedoColor,1):I.updateColor4("vAlbedoColor",this._albedoColor,this.alpha),this._lightingInfos.x=this._directIntensity,this._lightingInfos.y=this._emissiveIntensity,this._lightingInfos.z=this._environmentIntensity*x.environmentIntensity,this._lightingInfos.w=this._specularIntensity,I.updateVector4("vLightingIntensity",this._lightingInfos),x.ambientColor.multiplyToRef(this._ambientColor,this._globalAmbientColor),I.updateColor3("vAmbientColor",this._globalAmbientColor),I.updateFloat2("vDebugMode",this.debugLimit,this.debugFactor)}x.texturesEnabled&&(this._albedoTexture&&vD.h.DiffuseTextureEnabled&&I.setTexture("albedoSampler",this._albedoTexture),this._ambientTexture&&vD.h.AmbientTextureEnabled&&I.setTexture("ambientSampler",this._ambientTexture),this._opacityTexture&&vD.h.OpacityTextureEnabled&&I.setTexture("opacitySampler",this._opacityTexture),z&&vD.h.ReflectionTextureEnabled&&(b.LODBASEDMICROSFURACE?I.setTexture("reflectionSampler",z):(I.setTexture("reflectionSampler",z._lodTextureMid||z),I.setTexture("reflectionSamplerLow",z._lodTextureLow||z),I.setTexture("reflectionSamplerHigh",z._lodTextureHigh||z)),b.USEIRRADIANCEMAP&&I.setTexture("irradianceSampler",z.irradianceTexture)),b.ENVIRONMENTBRDF&&I.setTexture("environmentBrdfSampler",this._environmentBRDFTexture),this._emissiveTexture&&vD.h.EmissiveTextureEnabled&&I.setTexture("emissiveSampler",this._emissiveTexture),this._lightmapTexture&&vD.h.LightmapTextureEnabled&&I.setTexture("lightmapSampler",this._lightmapTexture),vD.h.SpecularTextureEnabled&&(this._metallicTexture?I.setTexture("reflectivitySampler",this._metallicTexture):this._reflectivityTexture&&I.setTexture("reflectivitySampler",this._reflectivityTexture),this._metallicReflectanceTexture&&I.setTexture("metallicReflectanceSampler",this._metallicReflectanceTexture),this._reflectanceTexture&&b.REFLECTANCE&&I.setTexture("reflectanceSampler",this._reflectanceTexture),this._microSurfaceTexture&&I.setTexture("microSurfaceSampler",this._microSurfaceTexture)),this._bumpTexture&&e.getCaps().standardDerivatives&&vD.h.BumpTextureEnabled&&!this._disableBumpMap&&I.setTexture("bumpSampler",this._bumpTexture)),this.getScene().useOrderIndependentTransparency&&this.needAlphaBlendingForMesh(K)&&this.getScene().depthPeelingRenderer.bind(n),this._eventInfo.subMesh=D,this._callbackPluginEventBindForSubMesh(this._eventInfo),qK.gS(this._activeEffect,this,x),this.bindEyePosition(n)}else x.getEngine()._features.needToAlwaysBindUniformBuffers&&(this._needToBindSceneUbo=!0);!i&&this.isFrozen||(x.lightsEnabled&&!this._disableLighting&&XK.RL(x,K,this._activeEffect,b,this._maxSimultaneousLights),(x.fogEnabled&&K.applyFog&&x.fogMode!==QK.Z.FOGMODE_NONE||z||this.subSurface.refractionTexture||K.receiveShadows||b.PREPASS)&&this.bindView(n),XK.Yy(x,K,this._activeEffect,!0),b.NUM_MORPH_INFLUENCERS&&XK.nR(K,this._activeEffect),b.BAKED_VERTEX_ANIMATION_TEXTURE&&(null===(W=K.bakedVertexAnimationManager)||void 0===W||W.bind(n,b.INSTANCES)),this._imageProcessingConfiguration.bind(this._activeEffect),XK.DL(b,this._activeEffect,x)),this._afterBind(K,this._activeEffect,D),I.update()}getAnimatables(){const t=super.getAnimatables();return this._albedoTexture&&this._albedoTexture.animations&&this._albedoTexture.animations.length>0&&t.push(this._albedoTexture),this._ambientTexture&&this._ambientTexture.animations&&this._ambientTexture.animations.length>0&&t.push(this._ambientTexture),this._opacityTexture&&this._opacityTexture.animations&&this._opacityTexture.animations.length>0&&t.push(this._opacityTexture),this._reflectionTexture&&this._reflectionTexture.animations&&this._reflectionTexture.animations.length>0&&t.push(this._reflectionTexture),this._emissiveTexture&&this._emissiveTexture.animations&&this._emissiveTexture.animations.length>0&&t.push(this._emissiveTexture),this._metallicTexture&&this._metallicTexture.animations&&this._metallicTexture.animations.length>0?t.push(this._metallicTexture):this._reflectivityTexture&&this._reflectivityTexture.animations&&this._reflectivityTexture.animations.length>0&&t.push(this._reflectivityTexture),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&t.push(this._bumpTexture),this._lightmapTexture&&this._lightmapTexture.animations&&this._lightmapTexture.animations.length>0&&t.push(this._lightmapTexture),this._metallicReflectanceTexture&&this._metallicReflectanceTexture.animations&&this._metallicReflectanceTexture.animations.length>0&&t.push(this._metallicReflectanceTexture),this._reflectanceTexture&&this._reflectanceTexture.animations&&this._reflectanceTexture.animations.length>0&&t.push(this._reflectanceTexture),this._microSurfaceTexture&&this._microSurfaceTexture.animations&&this._microSurfaceTexture.animations.length>0&&t.push(this._microSurfaceTexture),t}_getReflectionTexture(){return this._reflectionTexture?this._reflectionTexture:this.getScene().environmentTexture}getActiveTextures(){const t=super.getActiveTextures();return this._albedoTexture&&t.push(this._albedoTexture),this._ambientTexture&&t.push(this._ambientTexture),this._opacityTexture&&t.push(this._opacityTexture),this._reflectionTexture&&t.push(this._reflectionTexture),this._emissiveTexture&&t.push(this._emissiveTexture),this._reflectivityTexture&&t.push(this._reflectivityTexture),this._metallicTexture&&t.push(this._metallicTexture),this._metallicReflectanceTexture&&t.push(this._metallicReflectanceTexture),this._reflectanceTexture&&t.push(this._reflectanceTexture),this._microSurfaceTexture&&t.push(this._microSurfaceTexture),this._bumpTexture&&t.push(this._bumpTexture),this._lightmapTexture&&t.push(this._lightmapTexture),t}hasTexture(t){return!!super.hasTexture(t)||this._albedoTexture===t||this._ambientTexture===t||this._opacityTexture===t||this._reflectionTexture===t||this._emissiveTexture===t||this._reflectivityTexture===t||this._metallicTexture===t||this._metallicReflectanceTexture===t||this._reflectanceTexture===t||this._microSurfaceTexture===t||this._bumpTexture===t||this._lightmapTexture===t}setPrePassRenderer(){var t;if(!(null===(t=this.subSurface)||void 0===t?void 0:t.isScatteringEnabled))return!1;const K=this.getScene().enableSubSurfaceForPrePass();return K&&(K.enabled=!0),!0}dispose(t,K){var D,a,G,N,W,x,b,n,e,i,z,I;this._breakShaderLoadedCheck=!0,K&&(this._environmentBRDFTexture&&this.getScene().environmentBRDFTexture!==this._environmentBRDFTexture&&this._environmentBRDFTexture.dispose(),null===(D=this._albedoTexture)||void 0===D||D.dispose(),null===(a=this._ambientTexture)||void 0===a||a.dispose(),null===(G=this._opacityTexture)||void 0===G||G.dispose(),null===(N=this._reflectionTexture)||void 0===N||N.dispose(),null===(W=this._emissiveTexture)||void 0===W||W.dispose(),null===(x=this._metallicTexture)||void 0===x||x.dispose(),null===(b=this._reflectivityTexture)||void 0===b||b.dispose(),null===(n=this._bumpTexture)||void 0===n||n.dispose(),null===(e=this._lightmapTexture)||void 0===e||e.dispose(),null===(i=this._metallicReflectanceTexture)||void 0===i||i.dispose(),null===(z=this._reflectanceTexture)||void 0===z||z.dispose(),null===(I=this._microSurfaceTexture)||void 0===I||I.dispose()),this._renderTargets.dispose(),this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),super.dispose(t,K)}}na.PBRMATERIAL_OPAQUE=p.i.MATERIAL_OPAQUE,na.PBRMATERIAL_ALPHATEST=p.i.MATERIAL_ALPHATEST,na.PBRMATERIAL_ALPHABLEND=p.i.MATERIAL_ALPHABLEND,na.PBRMATERIAL_ALPHATESTANDBLEND=p.i.MATERIAL_ALPHATESTANDBLEND,na.DEFAULT_AO_ON_ANALYTICAL_LIGHTS=0,na.LIGHTFALLOFF_PHYSICAL=0,na.LIGHTFALLOFF_GLTF=1,na.LIGHTFALLOFF_STANDARD=2,na.ForceGLSL=!1,a.Cg([G.n1()],na.prototype,"_imageProcessingConfiguration",void 0),a.Cg([G.$z("_markAllSubMeshesAsMiscDirty")],na.prototype,"debugMode",void 0);class ea extends na{get refractionTexture(){return this.subSurface.refractionTexture}set refractionTexture(t){this.subSurface.refractionTexture=t,t?this.subSurface.isRefractionEnabled=!0:this.subSurface.linkRefractionWithTransparency||(this.subSurface.isRefractionEnabled=!1)}get indexOfRefraction(){return this.subSurface.indexOfRefraction}set indexOfRefraction(t){this.subSurface.indexOfRefraction=t}get invertRefractionY(){return this.subSurface.invertRefractionY}set invertRefractionY(t){this.subSurface.invertRefractionY=t}get linkRefractionWithTransparency(){return this.subSurface.linkRefractionWithTransparency}set linkRefractionWithTransparency(t){this.subSurface.linkRefractionWithTransparency=t,t&&(this.subSurface.isRefractionEnabled=!0)}get usePhysicalLightFalloff(){return this._lightFalloff===na.LIGHTFALLOFF_PHYSICAL}set usePhysicalLightFalloff(t){t!==this.usePhysicalLightFalloff&&(this._markAllSubMeshesAsTexturesDirty(),this._lightFalloff=t?na.LIGHTFALLOFF_PHYSICAL:na.LIGHTFALLOFF_STANDARD)}get useGLTFLightFalloff(){return this._lightFalloff===na.LIGHTFALLOFF_GLTF}set useGLTFLightFalloff(t){t!==this.useGLTFLightFalloff&&(this._markAllSubMeshesAsTexturesDirty(),this._lightFalloff=t?na.LIGHTFALLOFF_GLTF:na.LIGHTFALLOFF_STANDARD)}get imageProcessingConfiguration(){return this._imageProcessingConfiguration}set imageProcessingConfiguration(t){this._attachImageProcessingConfiguration(t),this._markAllSubMeshesAsTexturesDirty()}get cameraColorCurvesEnabled(){return this.imageProcessingConfiguration.colorCurvesEnabled}set cameraColorCurvesEnabled(t){this.imageProcessingConfiguration.colorCurvesEnabled=t}get cameraColorGradingEnabled(){return this.imageProcessingConfiguration.colorGradingEnabled}set cameraColorGradingEnabled(t){this.imageProcessingConfiguration.colorGradingEnabled=t}get cameraToneMappingEnabled(){return this._imageProcessingConfiguration.toneMappingEnabled}set cameraToneMappingEnabled(t){this._imageProcessingConfiguration.toneMappingEnabled=t}get cameraExposure(){return this._imageProcessingConfiguration.exposure}set cameraExposure(t){this._imageProcessingConfiguration.exposure=t}get cameraContrast(){return this._imageProcessingConfiguration.contrast}set cameraContrast(t){this._imageProcessingConfiguration.contrast=t}get cameraColorGradingTexture(){return this._imageProcessingConfiguration.colorGradingTexture}set cameraColorGradingTexture(t){this._imageProcessingConfiguration.colorGradingTexture=t}get cameraColorCurves(){return this._imageProcessingConfiguration.colorCurves}set cameraColorCurves(t){this._imageProcessingConfiguration.colorCurves=t}constructor(t,K,D=!1){super(t,K,D),this.directIntensity=1,this.emissiveIntensity=1,this.environmentIntensity=1,this.specularIntensity=1,this.disableBumpMap=!1,this.ambientTextureStrength=1,this.ambientTextureImpactOnAnalyticalLights=ea.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,this.metallicF0Factor=1,this.metallicReflectanceColor=s.v9.White(),this.useOnlyMetallicFromMetallicReflectanceTexture=!1,this.ambientColor=new s.v9(0,0,0),this.albedoColor=new s.v9(1,1,1),this.reflectivityColor=new s.v9(1,1,1),this.reflectionColor=new s.v9(1,1,1),this.emissiveColor=new s.v9(0,0,0),this.microSurface=1,this.useLightmapAsShadowmap=!1,this.useAlphaFromAlbedoTexture=!1,this.forceAlphaTest=!1,this.alphaCutOff=.4,this.useSpecularOverAlpha=!0,this.useMicroSurfaceFromReflectivityMapAlpha=!1,this.useRoughnessFromMetallicTextureAlpha=!0,this.useRoughnessFromMetallicTextureGreen=!1,this.useMetallnessFromMetallicTextureBlue=!1,this.useAmbientOcclusionFromMetallicTextureRed=!1,this.useAmbientInGrayScale=!1,this.useAutoMicroSurfaceFromReflectivityMap=!1,this.useRadianceOverAlpha=!0,this.useObjectSpaceNormalMap=!1,this.useParallax=!1,this.useParallaxOcclusion=!1,this.parallaxScaleBias=.05,this.disableLighting=!1,this.forceIrradianceInFragment=!1,this.maxSimultaneousLights=4,this.invertNormalMapX=!1,this.invertNormalMapY=!1,this.twoSidedLighting=!1,this.useAlphaFresnel=!1,this.useLinearAlphaFresnel=!1,this.environmentBRDFTexture=null,this.forceNormalForward=!1,this.enableSpecularAntiAliasing=!1,this.useHorizonOcclusion=!0,this.useRadianceOcclusion=!0,this.unlit=!1,this.applyDecalMapAfterDetailMap=!1,this._environmentBRDFTexture=YD(this.getScene())}getClassName(){return"PBRMaterial"}clone(t,K=!0,D=""){const a=z.p.Clone((()=>new ea(t,this.getScene())),this,{cloneTexturesOnlyOnce:K});return a.id=t,a.name=t,this.stencil.copyTo(a.stencil),this._clonePlugins(a,D),a}serialize(){const t=super.serialize();return t.customType="BABYLON.PBRMaterial",t}static Parse(t,K,D){const a=z.p.Parse((()=>new ea(t.name,K)),t,K,D);return t.stencil&&a.stencil.parse(t.stencil,K,D),p.i._ParsePlugins(t,a,K,D),t.clearCoat&&a.clearCoat.parse(t.clearCoat,K,D),t.anisotropy&&a.anisotropy.parse(t.anisotropy,K,D),t.brdf&&a.brdf.parse(t.brdf,K,D),t.sheen&&a.sheen.parse(t.sheen,K,D),t.subSurface&&a.subSurface.parse(t.subSurface,K,D),t.iridescence&&a.iridescence.parse(t.iridescence,K,D),a}}ea.PBRMATERIAL_OPAQUE=na.PBRMATERIAL_OPAQUE,ea.PBRMATERIAL_ALPHATEST=na.PBRMATERIAL_ALPHATEST,ea.PBRMATERIAL_ALPHABLEND=na.PBRMATERIAL_ALPHABLEND,ea.PBRMATERIAL_ALPHATESTANDBLEND=na.PBRMATERIAL_ALPHATESTANDBLEND,ea.DEFAULT_AO_ON_ANALYTICAL_LIGHTS=na.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"directIntensity",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"emissiveIntensity",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"environmentIntensity",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"specularIntensity",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"disableBumpMap",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"albedoTexture",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"ambientTexture",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"ambientTextureStrength",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"ambientTextureImpactOnAnalyticalLights",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesAndMiscDirty")],ea.prototype,"opacityTexture",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"reflectionTexture",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"emissiveTexture",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"reflectivityTexture",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"metallicTexture",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"metallic",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"roughness",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"metallicF0Factor",void 0),a.Cg([G.jT(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"metallicReflectanceColor",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useOnlyMetallicFromMetallicReflectanceTexture",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"metallicReflectanceTexture",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"reflectanceTexture",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"microSurfaceTexture",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"bumpTexture",void 0),a.Cg([G.uM(),G.$z("_markAllSubMeshesAsTexturesDirty",null)],ea.prototype,"lightmapTexture",void 0),a.Cg([G.jT("ambient"),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"ambientColor",void 0),a.Cg([G.jT("albedo"),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"albedoColor",void 0),a.Cg([G.jT("reflectivity"),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"reflectivityColor",void 0),a.Cg([G.jT("reflection"),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"reflectionColor",void 0),a.Cg([G.jT("emissive"),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"emissiveColor",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"microSurface",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useLightmapAsShadowmap",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesAndMiscDirty")],ea.prototype,"useAlphaFromAlbedoTexture",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesAndMiscDirty")],ea.prototype,"forceAlphaTest",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesAndMiscDirty")],ea.prototype,"alphaCutOff",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useSpecularOverAlpha",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useMicroSurfaceFromReflectivityMapAlpha",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useRoughnessFromMetallicTextureAlpha",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useRoughnessFromMetallicTextureGreen",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useMetallnessFromMetallicTextureBlue",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useAmbientOcclusionFromMetallicTextureRed",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useAmbientInGrayScale",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useAutoMicroSurfaceFromReflectivityMap",void 0),a.Cg([G.lK()],ea.prototype,"usePhysicalLightFalloff",null),a.Cg([G.lK()],ea.prototype,"useGLTFLightFalloff",null),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useRadianceOverAlpha",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useObjectSpaceNormalMap",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useParallax",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useParallaxOcclusion",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"parallaxScaleBias",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsLightsDirty")],ea.prototype,"disableLighting",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"forceIrradianceInFragment",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsLightsDirty")],ea.prototype,"maxSimultaneousLights",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"invertNormalMapX",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"invertNormalMapY",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"twoSidedLighting",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useAlphaFresnel",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useLinearAlphaFresnel",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"environmentBRDFTexture",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"forceNormalForward",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"enableSpecularAntiAliasing",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useHorizonOcclusion",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsTexturesDirty")],ea.prototype,"useRadianceOcclusion",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsMiscDirty")],ea.prototype,"unlit",void 0),a.Cg([G.lK(),G.$z("_markAllSubMeshesAsMiscDirty")],ea.prototype,"applyDecalMapAfterDetailMap",void 0),J.Y5("BABYLON.PBRMaterial",ea);var ia=D(412067);class za{}za.DEFAULT_COLOR=s.v9.White(),za.DEFAULT_WIDTH_ATTENUATED=1,za.DEFAULT_WIDTH=.1;class Ia{static ConvertPoints(t){if(t.length&&Array.isArray(t)&&"number"==typeof t[0])return[t];if(t.length&&Array.isArray(t[0])&&"number"==typeof t[0][0])return t;if(t.length&&!Array.isArray(t[0])&&t[0]instanceof N.Pq){const K=[];for(let D=0;D<t.length;D++){const a=t[D];K.push(a.x,a.y,a.z)}return[K]}if(t.length>0&&Array.isArray(t[0])&&t[0].length>0&&t[0][0]instanceof N.Pq){const K=[];return t.forEach((t=>{K.push(t.flatMap((t=>[t.x,t.y,t.z])))})),K}if(t instanceof Float32Array)return[Array.from(t)];if(t.length&&t[0]instanceof Float32Array){const K=[];return t.forEach((t=>{K.push(Array.from(t))})),K}return[]}static OmitZeroLengthPredicate(t,K,D){const a=[];return K.subtract(t).lengthSquared()>0&&a.push([t,K]),D.subtract(K).lengthSquared()>0&&a.push([K,D]),t.subtract(D).lengthSquared()>0&&a.push([D,t]),0===a.length?null:a}static OmitDuplicatesPredicate(t,K,D,a){const G=[];return Ia._SearchInPoints(t,K,a)||G.push([t,K]),Ia._SearchInPoints(K,D,a)||G.push([K,D]),Ia._SearchInPoints(D,t,a)||G.push([D,t]),0===G.length?null:G}static _SearchInPoints(t,K,D){var a,G,N;for(const W of D)for(let D=0;D<W.length;D++)if((null===(a=W[D])||void 0===a?void 0:a.equals(t))&&((null===(G=W[D+1])||void 0===G?void 0:G.equals(K))||(null===(N=W[D-1])||void 0===N?void 0:N.equals(K))))return!0;return!1}static MeshesToLines(t,K){const D=[];return t.forEach(((t,a)=>{const G=t.getVerticesData(R.R.PositionKind),W=t.getIndices();if(G&&W)for(let x=0,b=0;x<W.length;x++){const n=3*W[b++],e=3*W[b++],i=3*W[b++],z=new N.Pq(G[n],G[n+1],G[n+2]),I=new N.Pq(G[e],G[e+1],G[e+2]),Z=new N.Pq(G[i],G[i+1],G[i+2]);if(K){const N=K(z,I,Z,D,x,n,t,a,G,W);if(N)for(const t of N)D.push(t)}else D.push([z,I],[I,Z],[Z,z])}})),D}static ToVector3Array(t){if(Array.isArray(t[0])){const K=[],D=t;for(const t of D){const D=[];for(let K=0;K<t.length;K+=3)D.push(new N.Pq(t[K],t[K+1],t[K+2]));K.push(D)}return K}const K=t,D=[];for(let t=0;t<K.length;t+=3)D.push(new N.Pq(K[t],K[t+1],K[t+2]));return D}static ToNumberArray(t){return t.flatMap((t=>[t.x,t.y,t.z]))}static GetPointsCountInfo(t){const K=new Array(t.length);let D=0;for(let a=t.length;a--;)K[a]=t[a].length/3,D+=K[a];return{total:D,counts:K}}static GetLineLength(t){if(0===t.length)return 0;let K;K="number"==typeof t[0]?Ia.ToVector3Array(t):t;const D=N.AA.Vector3[0];let a=0;for(let t=0;t<K.length-1;t++){const G=K[t];a+=K[t+1].subtractToRef(G,D).length()}return a}static GetLineLengthArray(t){const K=new Float32Array(t.length/3);let D=0;for(let a=0,G=t.length/3-1;a<G;a++){let G=t[3*a+0],N=t[3*a+1],W=t[3*a+2];G-=t[3*a+3],N-=t[3*a+4],W-=t[3*a+5],D+=Math.sqrt(G*G+N*N+W*W),K[a+1]=D}return K}static SegmentizeSegmentByCount(t,K,D){const a=[],G=K.subtract(t),W=N.AA.Vector3[0];W.setAll(D);const x=N.AA.Vector3[1];G.divideToRef(W,x);let b=t.clone();a.push(b);for(let t=0;t<D;t++)b=b.clone(),a.push(b.addInPlace(x));return a}static SegmentizeLineBySegmentLength(t,K){const D=t[0]instanceof N.Pq?Ia.GetLineSegments(t):"number"==typeof t[0]?Ia.GetLineSegments(Ia.ToVector3Array(t)):t,a=[];return D.forEach((t=>{t.length>K?Ia.SegmentizeSegmentByCount(t.point1,t.point2,Math.ceil(t.length/K)).forEach((t=>{a.push(t)})):(a.push(t.point1),a.push(t.point2))})),a}static SegmentizeLineBySegmentCount(t,K){const D="number"==typeof t[0]?Ia.ToVector3Array(t):t,a=Ia.GetLineLength(D)/K;return Ia.SegmentizeLineBySegmentLength(D,a)}static GetLineSegments(t){const K=[];for(let D=0;D<t.length-1;D++){const a=t[D],G=t[D+1],N=G.subtract(a).length();K.push({point1:a,point2:G,length:N})}return K}static GetMinMaxSegmentLength(t){const K=Ia.GetLineSegments(t).sort((t=>t.length));return{min:K[0].length,max:K[K.length-1].length}}static GetPositionOnLineByVisibility(t,K,D,a=!1){const G=K*D;let W=0,x=0;const b=t.length;for(let K=0;K<b;K++){if(G<=W+t[K].length){x=K;break}W+=t[K].length}const n=(G-W)/t[x].length;return t[x].point2.subtractToRef(t[x].point1,N.AA.Vector3[0]),N.AA.Vector3[1]=N.AA.Vector3[0].multiplyByFloats(n,n,n),a||N.AA.Vector3[1].addInPlace(t[x].point1),N.AA.Vector3[1].clone()}static GetCircleLinePoints(t,K,D=0,a=t,G=2*Math.PI/K){const W=[];for(let x=0;x<=K;x++)W.push(new N.Pq(Math.cos(x*G)*t,Math.sin(x*G)*a,D));return W}static GetBezierLinePoints(t,K,D,a){return dK.jj.CreateQuadraticBezier(t,K,D,a).getPoints().flatMap((t=>[t.x,t.y,t.z]))}static GetArrowCap(t,K,D,a,G,N=0,W=0){return{points:[t.clone(),t.add(K.multiplyByFloats(D,D,D))],widths:[a,G,N,W]}}static GetPointsFromText(t,K,D,a,G=0,N=!0){const W=[],x=function(t,K,D,a){const G=Array.from(t),N=K/a.resolution,W=(a.boundingBox.yMax-a.boundingBox.yMin+a.underlineThickness)*N,x=[];let b=0,n=0;for(let t=0;t<G.length;t++){const K=G[t];if("\n"===K)b=0,n-=W;else{const t=cD(K,N,b,n,D,a);t&&(b+=t.offsetX,x.push(t.shapePath))}}return x}(t,K,D,a);for(const t of x){for(const K of t.paths){const t=[],D=K.getPoints();for(const K of D)t.push(K.x,K.y,G);W.push(t)}if(N)for(const K of t.holes){const t=[],D=K.getPoints();for(const K of D)t.push(K.x,K.y,G);W.push(t)}}return W}static Color3toRGBAUint8(t){const K=new Uint8Array(4*t.length);for(let D=0,a=0;D<t.length;D++)K[a++]=255*t[D].r,K[a++]=255*t[D].g,K[a++]=255*t[D].b,K[a++]=255;return K}static CreateColorsTexture(t,K,D,a){var G;const N=null!==(G=a.getEngine().getCaps().maxTextureSize)&&void 0!==G?G:1,W=K.length>N?N:K.length,x=Math.ceil(K.length/N);x>1&&(K=[...K,...Array(W*x-K.length).fill(K[0])]);const b=Ia.Color3toRGBAUint8(K),n=new aK(b,W,x,ia.N.TEXTUREFORMAT_RGBA,a,!1,!0,D);return n.name=t,n}static PrepareEmptyColorsTexture(t){if(!za.EmptyColorsTexture){const K=new Uint8Array(4);za.EmptyColorsTexture=new aK(K,1,1,ia.N.TEXTUREFORMAT_RGBA,t,!1,!1,aK.NEAREST_NEAREST),za.EmptyColorsTexture.name="grlEmptyColorsTexture"}return za.EmptyColorsTexture}static DisposeEmptyColorsTexture(){var t;null===(t=za.EmptyColorsTexture)||void 0===t||t.dispose(),za.EmptyColorsTexture=null}static BooleanToNumber(t){return t?1:0}}class Za extends LD.M{constructor(){super(...arguments),this.GREASED_LINE_HAS_COLOR=!1,this.GREASED_LINE_SIZE_ATTENUATION=!1,this.GREASED_LINE_COLOR_DISTRIBUTION_TYPE_LINE=!1,this.GREASED_LINE_RIGHT_HANDED_COORDINATE_SYSTEM=!1,this.GREASED_LINE_CAMERA_FACING=!0}}class wa extends SD.y{constructor(t,K,D){var a,G,W,x,b,n,e,i,z,I,Z,w,m,u,d,E,l;D=D||{color:za.DEFAULT_COLOR};const Q=new Za;Q.GREASED_LINE_HAS_COLOR=!!D.color&&!D.useColors,Q.GREASED_LINE_SIZE_ATTENUATION=null!==(a=D.sizeAttenuation)&&void 0!==a&&a,Q.GREASED_LINE_COLOR_DISTRIBUTION_TYPE_LINE=1===D.colorDistributionType,Q.GREASED_LINE_RIGHT_HANDED_COORDINATE_SYSTEM=(null!=K?K:t.getScene()).useRightHandedSystem,Q.GREASED_LINE_CAMERA_FACING=null===(G=D.cameraFacing)||void 0===G||G,super(t,wa.GREASED_LINE_MATERIAL_NAME,200,Q),this.colorsTexture=null,this._scene=null!=K?K:t.getScene(),this._engine=this._scene.getEngine(),this._cameraFacing=null===(W=D.cameraFacing)||void 0===W||W,this.visibility=null!==(x=D.visibility)&&void 0!==x?x:1,this.useDash=null!==(b=D.useDash)&&void 0!==b&&b,this.dashRatio=null!==(n=D.dashRatio)&&void 0!==n?n:.5,this.dashOffset=null!==(e=D.dashOffset)&&void 0!==e?e:0,this.width=D.width?D.width:D.sizeAttenuation?za.DEFAULT_WIDTH_ATTENUATED:za.DEFAULT_WIDTH,this._sizeAttenuation=null!==(i=D.sizeAttenuation)&&void 0!==i&&i,this.colorMode=null!==(z=D.colorMode)&&void 0!==z?z:0,this._color=null!==(I=D.color)&&void 0!==I?I:null,this.useColors=null!==(Z=D.useColors)&&void 0!==Z&&Z,this._colorsDistributionType=null!==(w=D.colorDistributionType)&&void 0!==w?w:0,this.colorsSampling=null!==(m=D.colorsSampling)&&void 0!==m?m:aK.NEAREST_NEAREST,this._colors=null!==(u=D.colors)&&void 0!==u?u:null,this.dashCount=null!==(d=D.dashCount)&&void 0!==d?d:1,this.resolution=null!==(E=D.resolution)&&void 0!==E?E:new N.I9(this._engine.getRenderWidth(),this._engine.getRenderHeight()),D.colorsTexture?this.colorsTexture=D.colorsTexture:this._colors?this.colorsTexture=Ia.CreateColorsTexture(`${t.name}-colors-texture`,this._colors,this.colorsSampling,this._scene):(this._color=null!==(l=this._color)&&void 0!==l?l:za.DEFAULT_COLOR,Ia.PrepareEmptyColorsTexture(this._scene)),this._engine.onDisposeObservable.add((()=>{Ia.DisposeEmptyColorsTexture()})),this._enable(!0)}getAttributes(t){t.push("grl_offsets"),t.push("grl_widths"),t.push("grl_colorPointers"),t.push("grl_counters"),this._cameraFacing?(t.push("grl_previousAndSide"),t.push("grl_nextAndCounters")):t.push("grl_slopes")}getSamplers(t){t.push("grl_colors")}getActiveTextures(t){this.colorsTexture&&t.push(this.colorsTexture)}getUniforms(){const t=[{name:"grl_singleColor",size:3,type:"vec3"},{name:"grl_textureSize",size:2,type:"vec2"},{name:"grl_dashOptions",size:4,type:"vec4"},{name:"grl_colorMode_visibility_colorsWidth_useColors",size:4,type:"vec4"}];return this._cameraFacing&&t.push({name:"grl_projection",size:16,type:"mat4"},{name:"grl_aspect_resolution_lineWidth",size:4,type:"vec4"}),{ubo:t,vertex:this._cameraFacing?`\n                uniform vec4 grl_aspect_resolution_lineWidth;\n                uniform mat4 grl_projection;\n                `:"",fragment:`\n                uniform vec4 grl_dashOptions;\n                uniform vec2 grl_textureSize;\n                uniform vec4 grl_colorMode_visibility_colorsWidth_useColors;\n                uniform vec3 grl_singleColor;\n                `}}get isEnabled(){return!0}bindForSubMesh(t){var K,D,a;if(this._cameraFacing){const K=this._scene.activeCamera;if(!K)throw Error("GreasedLinePluginMaterial requires an active camera.");{const D=K.getProjectionMatrix();t.updateMatrix("grl_projection",D)}const D=N.AA.Vector4[0];D.x=this._aspect,D.y=this._resolution.x,D.z=this._resolution.y,D.w=this.width,t.updateVector4("grl_aspect_resolution_lineWidth",D)}const G=N.AA.Vector4[0];G.x=Ia.BooleanToNumber(this.useDash),G.y=this._dashArray,G.z=this.dashOffset,G.w=this.dashRatio,t.updateVector4("grl_dashOptions",G);const W=N.AA.Vector4[1];W.x=this.colorMode,W.y=this.visibility,W.z=this.colorsTexture?this.colorsTexture.getSize().width:0,W.w=Ia.BooleanToNumber(this.useColors),t.updateVector4("grl_colorMode_visibility_colorsWidth_useColors",W),this._color&&t.updateColor3("grl_singleColor",this._color);const x=null!==(K=this.colorsTexture)&&void 0!==K?K:za.EmptyColorsTexture;t.setTexture("grl_colors",x),t.updateFloat2("grl_textureSize",null!==(D=null==x?void 0:x.getSize().width)&&void 0!==D?D:1,null!==(a=null==x?void 0:x.getSize().height)&&void 0!==a?a:1)}prepareDefines(t,K,D){t.GREASED_LINE_HAS_COLOR=!!this.color&&!this.useColors,t.GREASED_LINE_SIZE_ATTENUATION=this._sizeAttenuation,t.GREASED_LINE_COLOR_DISTRIBUTION_TYPE_LINE=1===this._colorsDistributionType,t.GREASED_LINE_RIGHT_HANDED_COORDINATE_SYSTEM=K.useRightHandedSystem,t.GREASED_LINE_CAMERA_FACING=this._cameraFacing}getClassName(){return wa.GREASED_LINE_MATERIAL_NAME}getCustomCode(t){if("vertex"===t){const t={CUSTOM_VERTEX_DEFINITIONS:`\n                attribute float grl_widths;\n                attribute vec3 grl_offsets;\n                attribute float grl_colorPointers;\n                varying float grlCounters;\n                varying float grlColorPointer;\n\n                #ifdef GREASED_LINE_CAMERA_FACING\n                    attribute vec4 grl_previousAndSide;\n                    attribute vec4 grl_nextAndCounters;\n\n                    vec2 grlFix( vec4 i, float aspect ) {\n                        vec2 res = i.xy / i.w;\n                        res.x *= aspect;\n                        return res;\n                    }\n                #else\n                    attribute vec3 grl_slopes;\n                    attribute float grl_counters;\n                #endif\n                `,CUSTOM_VERTEX_UPDATE_POSITION:`\n                #ifdef GREASED_LINE_CAMERA_FACING\n                    vec3 grlPositionOffset = grl_offsets;\n                    positionUpdated += grlPositionOffset;\n                #else\n                    positionUpdated = (positionUpdated + grl_offsets) + (grl_slopes * grl_widths);\n                #endif\n                `,CUSTOM_VERTEX_MAIN_END:`\n                grlColorPointer = grl_colorPointers;\n\n                #ifdef GREASED_LINE_CAMERA_FACING\n\n                    float grlAspect = grl_aspect_resolution_lineWidth.x;\n                    float grlBaseWidth = grl_aspect_resolution_lineWidth.w;\n\n\n                    vec3 grlPrevious = grl_previousAndSide.xyz;\n                    float grlSide = grl_previousAndSide.w;\n\n                    vec3 grlNext = grl_nextAndCounters.xyz;\n                    grlCounters = grl_nextAndCounters.w;\n\n                    mat4 grlMatrix = viewProjection * finalWorld;\n                    vec4 grlFinalPosition = grlMatrix * vec4( positionUpdated , 1.0 );\n                    vec4 grlPrevPos = grlMatrix * vec4( grlPrevious + grlPositionOffset, 1.0 );\n                    vec4 grlNextPos = grlMatrix * vec4( grlNext + grlPositionOffset, 1.0 );\n\n                    vec2 grlCurrentP = grlFix( grlFinalPosition, grlAspect );\n                    vec2 grlPrevP = grlFix( grlPrevPos, grlAspect );\n                    vec2 grlNextP = grlFix( grlNextPos, grlAspect );\n\n                    float grlWidth = grlBaseWidth * grl_widths;\n\n                    vec2 grlDir;\n                    if( grlNextP == grlCurrentP ) grlDir = normalize( grlCurrentP - grlPrevP );\n                    else if( grlPrevP == grlCurrentP ) grlDir = normalize( grlNextP - grlCurrentP );\n                    else {\n                        vec2 grlDir1 = normalize( grlCurrentP - grlPrevP );\n                        vec2 grlDir2 = normalize( grlNextP - grlCurrentP );\n                        grlDir = normalize( grlDir1 + grlDir2 );\n                    }\n                    vec4 grlNormal = vec4( -grlDir.y, grlDir.x, 0., 1. );\n                    #ifdef GREASED_LINE_RIGHT_HANDED_COORDINATE_SYSTEM\n                        grlNormal.xy *= -.5 * grlWidth;\n                    #else\n                        grlNormal.xy *= .5 * grlWidth;\n                    #endif\n\n                    grlNormal *= grl_projection;\n\n                    #ifdef GREASED_LINE_SIZE_ATTENUATION\n                        grlNormal.xy *= grlFinalPosition.w;\n                        grlNormal.xy /= ( vec4( grl_aspect_resolution_lineWidth.yz, 0., 1. ) * grl_projection ).xy;\n                    #endif\n\n                    grlFinalPosition.xy += grlNormal.xy * grlSide;\n                    gl_Position = grlFinalPosition;\n\n                    vPositionW = vec3(grlFinalPosition);\n                #else\n                    grlCounters = grl_counters;\n                #endif\n                `};return this._cameraFacing&&(t["!gl_Position\\=viewProjection\\*worldPos;"]="//"),t}return"fragment"===t?{CUSTOM_FRAGMENT_DEFINITIONS:`\n                    varying float grlCounters;\n                    varying float grlColorPointer;\n                    uniform sampler2D grl_colors;\n                `,CUSTOM_FRAGMENT_MAIN_END:`\n                    float grlColorMode = grl_colorMode_visibility_colorsWidth_useColors.x;\n                    float grlVisibility = grl_colorMode_visibility_colorsWidth_useColors.y;\n                    float grlColorsWidth = grl_colorMode_visibility_colorsWidth_useColors.z;\n                    float grlUseColors = grl_colorMode_visibility_colorsWidth_useColors.w;\n\n                    float grlUseDash = grl_dashOptions.x;\n                    float grlDashArray = grl_dashOptions.y;\n                    float grlDashOffset = grl_dashOptions.z;\n                    float grlDashRatio = grl_dashOptions.w;\n\n                    gl_FragColor.a *= step(grlCounters, grlVisibility);\n                    if( gl_FragColor.a == 0. ) discard;\n\n                    if(grlUseDash == 1.){\n                        gl_FragColor.a *= ceil(mod(grlCounters + grlDashOffset, grlDashArray) - (grlDashArray * grlDashRatio));\n                        if (gl_FragColor.a == 0.) discard;\n                    }\n\n                    #ifdef GREASED_LINE_HAS_COLOR\n                        if (grlColorMode == ${0}.) {\n                            gl_FragColor.rgb = grl_singleColor;\n                        } else if (grlColorMode == ${1}.) {\n                            gl_FragColor.rgb += grl_singleColor;\n                        } else if (grlColorMode == ${2}.) {\n                            gl_FragColor.rgb *= grl_singleColor;\n                        }\n                    #else\n                        if (grlUseColors == 1.) {\n                            #ifdef GREASED_LINE_COLOR_DISTRIBUTION_TYPE_LINE\n                                vec4 grlColor = texture2D(grl_colors, vec2(grlCounters, 0.), 0.);\n                            #else\n                                vec2 lookup = vec2(fract(grlColorPointer / grl_textureSize.x), 1.0 - floor(grlColorPointer / grl_textureSize.x) / max(grl_textureSize.y - 1.0, 1.0));\n                                vec4 grlColor = texture2D(grl_colors, lookup, 0.0);\n                            #endif\n                            if (grlColorMode == ${0}.) {\n                                gl_FragColor = grlColor;\n                            } else if (grlColorMode == ${1}.) {\n                                gl_FragColor += grlColor;\n                            } else if (grlColorMode == ${2}.) {\n                                gl_FragColor *= grlColor;\n                            }\n                        }\n                    #endif\n\n                `}:null}dispose(){var t;null===(t=this.colorsTexture)||void 0===t||t.dispose(),super.dispose()}get colors(){return this._colors}set colors(t){this.setColors(t)}setColors(t,K=!1,D=!1){var a,G,N,W;const x=null!==(G=null===(a=this._colors)||void 0===a?void 0:a.length)&&void 0!==G?G:0;if(this._colors=t,null!==t&&0!==t.length){if(!K||D)if(this.colorsTexture&&x===t.length&&!D){const K=Ia.Color3toRGBAUint8(t);this.colorsTexture.update(K)}else null===(W=this.colorsTexture)||void 0===W||W.dispose(),this.colorsTexture=Ia.CreateColorsTexture(`${this._material.name}-colors-texture`,t,this.colorsSampling,this._scene)}else null===(N=this.colorsTexture)||void 0===N||N.dispose()}updateLazy(){this._colors&&this.setColors(this._colors,!1,!0)}get dashCount(){return this._dashCount}set dashCount(t){this._dashCount=t,this._dashArray=1/t}get sizeAttenuation(){return this._sizeAttenuation}set sizeAttenuation(t){this._sizeAttenuation=t,this.markAllDefinesAsDirty()}get color(){return this._color}set color(t){this.setColor(t)}setColor(t,K=!1){null===this._color&&null!==t||null!==this._color&&null===t?(this._color=t,!K&&this.markAllDefinesAsDirty()):this._color=t}get colorsDistributionType(){return this._colorsDistributionType}set colorsDistributionType(t){this._colorsDistributionType=t,this.markAllDefinesAsDirty()}get resolution(){return this._resolution}set resolution(t){this._aspect=t.x/t.y,this._resolution=t}serialize(){const t=super.serialize(),K={colorDistributionType:this._colorsDistributionType,colorsSampling:this.colorsSampling,colorMode:this.colorMode,dashCount:this._dashCount,dashOffset:this.dashOffset,dashRatio:this.dashRatio,resolution:this._resolution,sizeAttenuation:this._sizeAttenuation,useColors:this.useColors,useDash:this.useDash,visibility:this.visibility,width:this.width};return this._colors&&(K.colors=this._colors),this._color&&(K.color=this._color),t.greasedLineMaterialOptions=K,t}parse(t,K,D){var a;super.parse(t,K,D);const G=t.greasedLineMaterialOptions;null===(a=this.colorsTexture)||void 0===a||a.dispose(),G.color&&this.setColor(G.color,!0),G.colorDistributionType&&(this.colorsDistributionType=G.colorDistributionType),G.colors&&(this.colors=G.colors),G.colorsSampling&&(this.colorsSampling=G.colorsSampling),G.colorMode&&(this.colorMode=G.colorMode),G.useColors&&(this.useColors=G.useColors),G.visibility&&(this.visibility=G.visibility),G.useDash&&(this.useDash=G.useDash),G.dashCount&&(this.dashCount=G.dashCount),G.dashRatio&&(this.dashRatio=G.dashRatio),G.dashOffset&&(this.dashOffset=G.dashOffset),G.width&&(this.width=G.width),G.sizeAttenuation&&(this.sizeAttenuation=G.sizeAttenuation),G.resolution&&(this.resolution=G.resolution),this.colors?this.colorsTexture=Ia.CreateColorsTexture(`${this._material.name}-colors-texture`,this.colors,this.colorsSampling,K):Ia.PrepareEmptyColorsTexture(K),this.markAllDefinesAsDirty()}copyTo(t){var K;const D=t;null===(K=D.colorsTexture)||void 0===K||K.dispose(),this._colors&&(D.colorsTexture=Ia.CreateColorsTexture(`${D._material.name}-colors-texture`,this._colors,D.colorsSampling,this._scene)),D.setColor(this.color,!0),D.colorsDistributionType=this.colorsDistributionType,D.colorsSampling=this.colorsSampling,D.colorMode=this.colorMode,D.useColors=this.useColors,D.visibility=this.visibility,D.useDash=this.useDash,D.dashCount=this.dashCount,D.dashRatio=this.dashRatio,D.dashOffset=this.dashOffset,D.width=this.width,D.sizeAttenuation=this.sizeAttenuation,D.resolution=this.resolution,D.markAllDefinesAsDirty()}}wa.GREASED_LINE_MATERIAL_NAME="GreasedLinePluginMaterial",J.Y5(`BABYLON.${wa.GREASED_LINE_MATERIAL_NAME}`,wa);const ma=`precision highp float;uniform sampler2D grlColors;uniform float grlUseColors;uniform float grlUseDash;uniform float grlDashArray;uniform float grlDashOffset;uniform float grlDashRatio;uniform float grlVisibility;uniform float grlColorsWidth;uniform vec2 grl_colorModeAndColorDistributionType;uniform vec3 grlColor;varying float grlCounters;varying float grlColorPointer;void main() {float grlColorMode=grl_colorModeAndColorDistributionType.x;float grlColorDistributionType=grl_colorModeAndColorDistributionType.y;gl_FragColor=vec4(grlColor,1.);gl_FragColor.a=step(grlCounters,grlVisibility);if (gl_FragColor.a==0.) discard;if( grlUseDash==1. ){gl_FragColor.a=ceil(mod(grlCounters+grlDashOffset,grlDashArray)-(grlDashArray*grlDashRatio));if (gl_FragColor.a==0.) discard;}\nif (grlUseColors==1.) {vec4 textureColor;if (grlColorDistributionType==COLOR_DISTRIBUTION_TYPE_LINE) { \ntextureColor=texture2D(grlColors,vec2(grlCounters,0.),0.);} else {textureColor=texture2D(grlColors,vec2(grlColorPointer/grlColorsWidth,0.),0.);}\nif (grlColorMode==COLOR_MODE_SET) {gl_FragColor=textureColor;} else if (grlColorMode==COLOR_MODE_ADD) {gl_FragColor+=textureColor;} else if (grlColorMode==COLOR_MODE_MULTIPLY) {gl_FragColor*=textureColor;}}}\n`;Et.l.ShadersStore["greasedLinePixelShader"]=ma,D(427139),D(216313);const ua=`precision highp float;\n#include<instancesDeclaration>\nattribute float grl_widths;attribute vec3 grl_offsets;attribute float grl_colorPointers;attribute vec3 position;uniform mat4 viewProjection;uniform mat4 projection;varying float grlCounters;varying float grlColorPointer;\n#ifdef GREASED_LINE_CAMERA_FACING\nattribute vec4 grl_nextAndCounters;attribute vec4 grl_previousAndSide;uniform vec2 grlResolution;uniform float grlAspect;uniform float grlWidth;uniform float grlSizeAttenuation;vec2 grlFix( vec4 i,float aspect ) {vec2 res=i.xy/i.w;res.x*=aspect;return res;}\n#else\nattribute vec3 grl_slopes;attribute float grl_counters;\n#endif\nvoid main() {\n#include<instancesVertex>\ngrlColorPointer=grl_colorPointers;mat4 grlMatrix=viewProjection*finalWorld ;\n#ifdef GREASED_LINE_CAMERA_FACING\nfloat grlBaseWidth=grlWidth;vec3 grlPrevious=grl_previousAndSide.xyz;float grlSide=grl_previousAndSide.w;vec3 grlNext=grl_nextAndCounters.xyz;grlCounters=grl_nextAndCounters.w;vec3 grlPositionOffset=grl_offsets;vec4 grlFinalPosition=grlMatrix*vec4( position+grlPositionOffset ,1.0 );vec4 grlPrevPos=grlMatrix*vec4( grlPrevious+grlPositionOffset,1.0 );vec4 grlNextPos=grlMatrix*vec4( grlNext+grlPositionOffset,1.0 );vec2 grlCurrentP=grlFix( grlFinalPosition,grlAspect );vec2 grlPrevP=grlFix( grlPrevPos,grlAspect );vec2 grlNextP=grlFix( grlNextPos,grlAspect );float grlWidth=grlBaseWidth*grl_widths;vec2 grlDir;if( grlNextP==grlCurrentP ) grlDir=normalize( grlCurrentP-grlPrevP );else if( grlPrevP==grlCurrentP ) grlDir=normalize( grlNextP-grlCurrentP );else {vec2 grlDir1=normalize( grlCurrentP-grlPrevP );vec2 grlDir2=normalize( grlNextP-grlCurrentP );grlDir=normalize( grlDir1+grlDir2 );}\nvec4 grlNormal=vec4( -grlDir.y,grlDir.x,0.,1. );\n#ifdef GREASED_LINE_RIGHT_HANDED_COORDINATE_SYSTEM\ngrlNormal.xy*=-.5*grlWidth;\n#else\ngrlNormal.xy*=.5*grlWidth;\n#endif\ngrlNormal*=projection;if (grlSizeAttenuation==1.) {grlNormal.xy*=grlFinalPosition.w;grlNormal.xy/=( vec4( grlResolution,0.,1. )*projection ).xy;}\ngrlFinalPosition.xy+=grlNormal.xy*grlSide;gl_Position=grlFinalPosition;\n#else\ngrlCounters=grl_counters;vec4 grlFinalPosition=grlMatrix*vec4( (position+grl_offsets)+grl_slopes*grl_widths ,1.0 ) ;gl_Position=grlFinalPosition;\n#endif\n}\n`;Et.l.ShadersStore["greasedLineVertexShader"]=ua;class da extends JK{constructor(t,K,D){var a,G,W,x,b,n,e,i,z,I,Z,w,m,u;const d=[`COLOR_DISTRIBUTION_TYPE_LINE ${1}.`,`COLOR_DISTRIBUTION_TYPE_SEGMENT ${0}.`,`COLOR_MODE_SET ${0}.`,`COLOR_MODE_ADD ${1}.`,`COLOR_MODE_MULTIPLY ${2}.`],E=["position","grl_widths","grl_offsets","grl_colorPointers"];K.useRightHandedSystem&&d.push("GREASED_LINE_RIGHT_HANDED_COORDINATE_SYSTEM"),D.cameraFacing?(d.push("GREASED_LINE_CAMERA_FACING"),E.push("grl_previousAndSide","grl_nextAndCounters")):(E.push("grl_slopes"),E.push("grl_counters")),super(t,K,{vertex:"greasedLine",fragment:"greasedLine"},{attributes:E,uniforms:["world","viewProjection","view","projection","grlColorsWidth","grlUseColors","grlWidth","grlColor","grl_colorModeAndColorDistributionType","grlResolution","grlAspect","grlAizeAttenuation","grlDashArray","grlDashOffset","grlDashRatio","grlUseDash","grlVisibility"],samplers:["grlColors"],defines:d}),this._color=s.v9.White(),this._colorsDistributionType=0,this._colorsTexture=null,D=D||{color:za.DEFAULT_COLOR};const l=K.getEngine();this.visibility=null!==(a=D.visibility)&&void 0!==a?a:1,this.useDash=null!==(G=D.useDash)&&void 0!==G&&G,this.dashRatio=null!==(W=D.dashRatio)&&void 0!==W?W:.5,this.dashOffset=null!==(x=D.dashOffset)&&void 0!==x?x:0,this.dashCount=null!==(b=D.dashCount)&&void 0!==b?b:1,this.width=D.width?D.width:D.sizeAttenuation&&D.cameraFacing?za.DEFAULT_WIDTH_ATTENUATED:za.DEFAULT_WIDTH,this.sizeAttenuation=null!==(n=D.sizeAttenuation)&&void 0!==n&&n,this.color=null!==(e=D.color)&&void 0!==e?e:s.v9.White(),this.useColors=null!==(i=D.useColors)&&void 0!==i&&i,this.colorsDistributionType=null!==(z=D.colorDistributionType)&&void 0!==z?z:0,this.colorsSampling=null!==(I=D.colorsSampling)&&void 0!==I?I:aK.NEAREST_NEAREST,this.colorMode=null!==(Z=D.colorMode)&&void 0!==Z?Z:0,this._colors=null!==(w=D.colors)&&void 0!==w?w:null,this._cameraFacing=null===(m=D.cameraFacing)||void 0===m||m,this.resolution=null!==(u=D.resolution)&&void 0!==u?u:new N.I9(l.getRenderWidth(),l.getRenderHeight()),D.colorsTexture?this.colorsTexture=D.colorsTexture:this.colorsTexture=Ia.PrepareEmptyColorsTexture(K),this._colors&&this.useColors&&(this.colorsTexture=Ia.CreateColorsTexture(`${this.name}-colors-texture`,this._colors,this.colorsSampling,K)),l.onDisposeObservable.add((()=>{Ia.DisposeEmptyColorsTexture()}))}dispose(){var t;null===(t=this._colorsTexture)||void 0===t||t.dispose(),super.dispose()}_setColorModeAndColorDistributionType(){this.setVector2("grl_colorModeAndColorDistributionType",new N.I9(this._colorMode,this._colorsDistributionType))}updateLazy(){this._colors&&this.setColors(this._colors,!1,!0)}get colors(){return this._colors}set colors(t){this.setColors(t)}setColors(t,K=!1,D=!1){var a,G,N,W;const x=null!==(G=null===(a=this._colors)||void 0===a?void 0:a.length)&&void 0!==G?G:0;if(this._colors=t,null!==t&&0!==t.length){if(!K||D)if(this._colorsTexture&&x===t.length&&!D){const K=Ia.Color3toRGBAUint8(t);this._colorsTexture.update(K)}else null===(W=this._colorsTexture)||void 0===W||W.dispose(),this.colorsTexture=Ia.CreateColorsTexture(`${this.name}-colors-texture`,t,this.colorsSampling,this.getScene())}else null===(N=this._colorsTexture)||void 0===N||N.dispose()}get colorsTexture(){var t;return null!==(t=this._colorsTexture)&&void 0!==t?t:null}set colorsTexture(t){this._colorsTexture=t,this.setFloat("grlColorsWidth",this._colorsTexture.getSize().width),this.setTexture("grlColors",this._colorsTexture)}get width(){return this._width}set width(t){this._width=t,this.setFloat("grlWidth",t)}get useColors(){return this._useColors}set useColors(t){this._useColors=t,this.setFloat("grlUseColors",Ia.BooleanToNumber(t))}get colorsSampling(){return this._colorsSampling}set colorsSampling(t){this._colorsSampling=t}get visibility(){return this._visibility}set visibility(t){this._visibility=t,this.setFloat("grlVisibility",t)}get useDash(){return this._useDash}set useDash(t){this._useDash=t,this.setFloat("grlUseDash",Ia.BooleanToNumber(t))}get dashOffset(){return this._dashOffset}set dashOffset(t){this._dashOffset=t,this.setFloat("grlDashOffset",t)}get dashRatio(){return this._dashRatio}set dashRatio(t){this._dashRatio=t,this.setFloat("grlDashRatio",t)}get dashCount(){return this._dashCount}set dashCount(t){this._dashCount=t,this._dashArray=1/t,this.setFloat("grlDashArray",this._dashArray)}get sizeAttenuation(){return this._sizeAttenuation}set sizeAttenuation(t){this._sizeAttenuation=t,this.setFloat("grlSizeAttenuation",Ia.BooleanToNumber(t))}get color(){return this.color}set color(t){this.setColor(t)}setColor(t){t=null!=t?t:za.DEFAULT_COLOR,this._color=t,this.setColor3("grlColor",t)}get colorsDistributionType(){return this._colorsDistributionType}set colorsDistributionType(t){this._colorsDistributionType=t,this._setColorModeAndColorDistributionType()}get colorMode(){return this._colorMode}set colorMode(t){this._colorMode=t,this._setColorModeAndColorDistributionType()}get resolution(){return this._resolution}set resolution(t){this._resolution=t,this.setVector2("grlResolution",t),this.setFloat("grlAspect",t.x/t.y)}serialize(){const t=super.serialize(),K={colorDistributionType:this._colorsDistributionType,colorsSampling:this._colorsSampling,colorMode:this._colorMode,color:this._color,dashCount:this._dashCount,dashOffset:this._dashOffset,dashRatio:this._dashRatio,resolution:this._resolution,sizeAttenuation:this._sizeAttenuation,useColors:this._useColors,useDash:this._useDash,visibility:this._visibility,width:this._width,cameraFacing:this._cameraFacing};return this._colors&&(K.colors=this._colors),t.greasedLineMaterialOptions=K,t}parse(t,K,D){var a,G;const N=t.greasedLineMaterialOptions;null===(a=this._colorsTexture)||void 0===a||a.dispose(),N.color&&(this.color=N.color),N.colorDistributionType&&(this.colorsDistributionType=N.colorDistributionType),N.colorsSampling&&(this.colorsSampling=N.colorsSampling),N.colorMode&&(this.colorMode=N.colorMode),N.useColors&&(this.useColors=N.useColors),N.visibility&&(this.visibility=N.visibility),N.useDash&&(this.useDash=N.useDash),N.dashCount&&(this.dashCount=N.dashCount),N.dashRatio&&(this.dashRatio=N.dashRatio),N.dashOffset&&(this.dashOffset=N.dashOffset),N.width&&(this.width=N.width),N.sizeAttenuation&&(this.sizeAttenuation=N.sizeAttenuation),N.resolution&&(this.resolution=N.resolution),N.colors?this.colorsTexture=Ia.CreateColorsTexture(`${this.name}-colors-texture`,N.colors,this.colorsSampling,this.getScene()):this.colorsTexture=Ia.PrepareEmptyColorsTexture(K),this._cameraFacing=null===(G=N.cameraFacing)||void 0===G||G,this.setDefine("GREASED_LINE_CAMERA_FACING",this._cameraFacing)}}var Ea,la,Qa,Pa,ya;(function(t){t[t["POINTS_MODE_POINTS"]=0]="POINTS_MODE_POINTS",t[t["POINTS_MODE_PATHS"]=1]="POINTS_MODE_PATHS"})(Ea||(Ea={})),function(t){t[t["FACES_MODE_SINGLE_SIDED"]=0]="FACES_MODE_SINGLE_SIDED",t[t["FACES_MODE_SINGLE_SIDED_NO_BACKFACE_CULLING"]=1]="FACES_MODE_SINGLE_SIDED_NO_BACKFACE_CULLING",t[t["FACES_MODE_DOUBLE_SIDED"]=2]="FACES_MODE_DOUBLE_SIDED"}(la||(la={})),function(t){t[t["AUTO_DIRECTIONS_FROM_FIRST_SEGMENT"]=0]="AUTO_DIRECTIONS_FROM_FIRST_SEGMENT",t[t["AUTO_DIRECTIONS_FROM_ALL_SEGMENTS"]=1]="AUTO_DIRECTIONS_FROM_ALL_SEGMENTS",t[t["AUTO_DIRECTIONS_ENHANCED"]=2]="AUTO_DIRECTIONS_ENHANCED",t[t["AUTO_DIRECTIONS_FACE_TO"]=3]="AUTO_DIRECTIONS_FACE_TO",t[t["AUTO_DIRECTIONS_NONE"]=99]="AUTO_DIRECTIONS_NONE"}(Qa||(Qa={}));class qa extends Nt{constructor(t,K,D){var a,G,N,W;super(t,K,null,null,!1,!1),this.name=t,this._options=D,this._lazy=!1,this._updatable=!1,this._engine=K.getEngine(),this._lazy=null!==(a=D.lazy)&&void 0!==a&&a,this._updatable=null!==(G=D.updatable)&&void 0!==G&&G,this._vertexPositions=[],this._indices=[],this._uvs=[],this._points=[],this._colorPointers=null!==(N=D.colorPointers)&&void 0!==N?N:[],this._widths=null!==(W=D.widths)&&void 0!==W?W:new Array(D.points.length).fill(1)}getClassName(){return"GreasedLineMesh"}_updateWidthsWithValue(t){let K=0;for(const t of this._points)K+=t.length;const D=K/3*2-this._widths.length;for(let K=0;K<D;K++)this._widths.push(t)}updateLazy(){var t,K;this._setPoints(this._points),this._options.colorPointers||this._updateColorPointers(),this._createVertexBuffers(null===(t=this._options.ribbonOptions)||void 0===t?void 0:t.smoothShading),this.refreshBoundingInfo(),null===(K=this.greasedLineMaterial)||void 0===K||K.updateLazy()}addPoints(t,K){for(const K of t)this._points.push(K);this._lazy||this.setPoints(this._points,K)}dispose(t,K=!1){super.dispose(t,K)}isLazy(){return this._lazy}get uvs(){return this._uvs}set uvs(t){this._uvs=t instanceof Float32Array?t:new Float32Array(t),this._createVertexBuffers()}get offsets(){return this._offsets}set offsets(t){this._offsets=t,this._offsetsBuffer?this._offsetsBuffer.update(t):this._createOffsetsBuffer(t)}get widths(){return this._widths}set widths(t){this._widths=t,this._lazy||this._widthsBuffer&&this._widthsBuffer.update(t)}get colorPointers(){return this._colorPointers}set colorPointers(t){this._colorPointers=t,this._lazy||this._colorPointersBuffer&&this._colorPointersBuffer.update(t)}get greasedLineMaterial(){var t,K;if(this.material&&this.material instanceof da)return this.material;return(null===(K=null===(t=this.material)||void 0===t?void 0:t.pluginManager)||void 0===K?void 0:K.getPlugin(wa.GREASED_LINE_MATERIAL_NAME))||void 0}get points(){const t=[];return F.r.DeepCopy(this._points,t),t}setPoints(t,K){this._points=t,this._updateWidths(),(null==K?void 0:K.colorPointers)||this._updateColorPointers(),this._setPoints(t,K)}_initGreasedLine(){this._vertexPositions=[],this._indices=[],this._uvs=[]}_createLineOptions(){return{points:this._points,colorPointers:this._colorPointers,lazy:this._lazy,updatable:this._updatable,uvs:this._uvs,widths:this._widths,ribbonOptions:this._options.ribbonOptions}}serialize(t){super.serialize(t),t.type=this.getClassName(),t.lineOptions=this._createLineOptions()}_createVertexBuffers(t=!1){const K=new A.P;return K.positions=this._vertexPositions,K.indices=this._indices,K.uvs=this._uvs,t&&(K.normals=[],A.P.ComputeNormals(this._vertexPositions,this._indices,K.normals)),K.applyToMesh(this,this._options.updatable),K}_createOffsetsBuffer(t){const K=this._scene.getEngine(),D=new R.h(K,t,this._updatable,3);this.setVerticesBuffer(D.createVertexBuffer("grl_offsets",0,3)),this._offsetsBuffer=D}}Nt._GreasedLineMeshParser=(t,K)=>Xa.Parse(t,K);class Xa extends qa{constructor(t,K,D){super(t,K,D),this.name=t,this.intersectionThreshold=.1,this._previousAndSide=[],this._nextAndCounters=[],D.points&&this.addPoints(Ia.ConvertPoints(D.points))}getClassName(){return"GreasedLineMesh"}_updateColorPointers(){if(this._options.colorPointers)return;let t=0;this._colorPointers=[],this._points.forEach((K=>{for(let D=0;D<K.length;D+=3)this._colorPointers.push(t),this._colorPointers.push(t++)}))}_updateWidths(){}_setPoints(t){this._points=t,this._options.points=t,this._initGreasedLine();let K=0,D=0,a=0,G=0,N=0;t.forEach((t=>{D+=2*t.length,a+=2*(t.length-3),G+=4*t.length/3,N+=8*t.length/3}));const W=new Float32Array(D),x=D>65535?new Uint32Array(a):new Uint16Array(a),b=new Float32Array(G),n=new Float32Array(N),e=new Float32Array(N);let i=0,z=0,I=0,Z=0,w=0;t.forEach((t=>{const D=Ia.GetLineLengthArray(t),a=D[D.length-1];for(let D=0,a=0;a<t.length;D++,a+=3){const G=i+2*a;if(W[G+0]=t[a+0],W[G+1]=t[a+1],W[G+2]=t[a+2],W[G+3]=t[a+0],W[G+4]=t[a+1],W[G+5]=t[a+2],a<t.length-3){const t=2*D+K,G=z+2*a;x[G+0]=t,x[G+1]=t+1,x[G+2]=t+2,x[G+3]=t+2,x[G+4]=t+1,x[G+5]=t+3}}K+=t.length/3*2;const G=2*t.length,N=W.subarray(i,i+G);i+=G,z+=2*(t.length-3);const m=new Float32Array(N.length),u=new Float32Array(N.length),d=N.length/6;let E;E=Xa._CompareV3(0,d-1,N)?N.subarray(6*(d-2),6*(d-1)):N.subarray(0,6),m.set(E),m.set(N.subarray(0,N.length-6),6),u.set(N.subarray(6)),E=Xa._CompareV3(d-1,0,N)?N.subarray(6,12):N.subarray(6*(d-1),6*d),u.set(E,u.length-6);for(let t=0,K=N.length/3;t<K;t++)n[Z++]=m[3*t],n[Z++]=m[3*t+1],n[Z++]=m[3*t+2],n[Z++]=1-((1&t)<<1),e[w++]=u[3*t],e[w++]=u[3*t+1],e[w++]=u[3*t+2],e[w++]=D[t>>1]/a;if(this._options.uvs)for(let t=0;t<this._options.uvs.length;t++)b[I++]=this._options.uvs[t];else for(let t=0;t<d;t++){const K=D[t]/a,G=I+4*t;b[G+0]=K,b[G+1]=0,b[G+2]=K,b[G+3]=1}})),this._vertexPositions=W,this._indices=x,this._uvs=b,this._previousAndSide=n,this._nextAndCounters=e,this._lazy||(this._options.colorPointers||this._updateColorPointers(),this._createVertexBuffers(),this.refreshBoundingInfo())}clone(t=`${this.name}-cloned`,K){const D=this._createLineOptions(),a={};F.r.DeepCopy(D,a,["instance"],void 0,!0);const G=new Xa(t,this._scene,a);return K&&(G.parent=K),G.material=this.material,G}serialize(t){super.serialize(t),t.type=this.getClassName(),t.lineOptions=this._createLineOptions()}static Parse(t,K){const D=t.lineOptions,a=t.name;return new Xa(a,K,D)}_initGreasedLine(){super._initGreasedLine(),this._previousAndSide=[],this._nextAndCounters=[]}intersects(t,K,D,a=!1,G,N=!1){const W=new RK.G,x=this.findAllIntersections(t,K,D,a,G,N,!0);if(1===(null==x?void 0:x.length)){const K=x[0];W.hit=!0,W.distance=K.distance,W.ray=t,W.pickedMesh=this,W.pickedPoint=K.point}return W}findAllIntersections(t,K,D,a=!1,G,N=!1,W=!1){var x,b;if(a&&!N&&!1===t.intersectsSphere(this._boundingSphere,this.intersectionThreshold))return;const n=this.getIndices(),e=this.getVerticesData(R.R.PositionKind),i=this._widths,z=null!==(b=null===(x=this.greasedLineMaterial)||void 0===x?void 0:x.width)&&void 0!==b?b:1,I=[];if(n&&e&&i){let K=0,D=0;for(K=0,D=n.length-1;K<D;K+=3){const D=n[K],a=n[K+1];Xa._V_START.fromArray(e,3*D),Xa._V_END.fromArray(e,3*a),this._offsets&&(Xa._V_OFFSET_START.fromArray(this._offsets,3*D),Xa._V_OFFSET_END.fromArray(this._offsets,3*a),Xa._V_START.addInPlace(Xa._V_OFFSET_START),Xa._V_END.addInPlace(Xa._V_OFFSET_END));const G=Math.floor(K/3),N=void 0!==i[G]?i[G]:1,x=this.intersectionThreshold*(z*N)/2,b=t.intersectionSegment(Xa._V_START,Xa._V_END,x);if(-1!==b&&(I.push({distance:b,point:t.direction.normalize().multiplyByFloats(b,b,b).add(t.origin)}),W))return I}K=D}return I}get _boundingSphere(){return this.getBoundingInfo().boundingSphere}static _CompareV3(t,K,D){const a=6*t,G=6*K;return D[a]===D[G]&&D[a+1]===D[G+1]&&D[a+2]===D[G+2]}_createVertexBuffers(){const t=super._createVertexBuffers(),K=this._scene.getEngine(),D=new R.h(K,this._previousAndSide,!1,4);this.setVerticesBuffer(D.createVertexBuffer("grl_previousAndSide",0,4));const a=new R.h(K,this._nextAndCounters,!1,4);this.setVerticesBuffer(a.createVertexBuffer("grl_nextAndCounters",0,4));const G=new R.h(K,this._widths,this._updatable,1);this.setVerticesBuffer(G.createVertexBuffer("grl_widths",0,1)),this._widthsBuffer=G;const N=new R.h(K,this._colorPointers,this._updatable,1);return this.setVerticesBuffer(N.createVertexBuffer("grl_colorPointers",0,1)),this._colorPointersBuffer=N,t}}Xa._V_START=new N.Pq,Xa._V_END=new N.Pq,Xa._V_OFFSET_START=new N.Pq,Xa._V_OFFSET_END=new N.Pq,Nt._GreasedLineRibbonMeshParser=(t,K)=>ha.Parse(t,K);class ha extends qa{constructor(t,K,D,a){var G;if(super(t,K,D),this.name=t,!D.ribbonOptions)throw"'GreasedLineMeshOptions.ribbonOptions' is not set.";this._paths=[],this._counters=[],this._slopes=[],this._widths=null!==(G=D.widths)&&void 0!==G?G:[],this._ribbonWidths=[],this._pathsOptions=null!=a?a:[],D.points&&this.addPoints(Ia.ConvertPoints(D.points),D,!!a)}addPoints(t,K,D=!1){if(!K.ribbonOptions)throw"addPoints() on GreasedLineRibbonMesh instance requires 'GreasedLineMeshOptions.ribbonOptions'.";D||this._pathsOptions.push({options:K,pathCount:t.length}),super.addPoints(t,K)}getClassName(){return"GreasedLineRibbonMesh"}get isFlatLine(){return this._paths.length<3}get slopes(){return this._slopes}set slopes(t){this._slopes=t}_updateColorPointers(){if(this._options.colorPointers)return;let t=0;this._colorPointers=[];for(let K=0;K<this._pathsOptions.length;K++){const{options:D,pathCount:a}=this._pathsOptions[K],G=this._points[K];if(0===D.ribbonOptions.pointsMode)for(let K=0;K<a;K++)for(let K=0;K<G.length;K+=3)this._colorPointers.push(t),this._colorPointers.push(t++);else for(let K=0;K<G.length;K+=3){for(let K=0;K<a;K++)this._colorPointers.push(t);t++}}}_updateWidths(){super._updateWidthsWithValue(1)}_setPoints(t,K){var D,a;if(!this._options.ribbonOptions)throw"No 'GreasedLineMeshOptions.ribbonOptions' provided.";this._points=t,this._options.points=t,this._initGreasedLine();let G,N=0;for(let K=0,W=0;K<this._pathsOptions.length;K++){const{options:x,pathCount:b}=this._pathsOptions[K],n=t.slice(W,W+b);if(W+=b,1===(null===(D=x.ribbonOptions)||void 0===D?void 0:D.pointsMode))N=this._preprocess(Ia.ToVector3Array(n),N,x);else{if(99===(null===(a=x.ribbonOptions)||void 0===a?void 0:a.directionsAutoMode)){if(!x.ribbonOptions.directions)throw"In GreasedLineRibbonAutoDirectionMode.AUTO_DIRECTIONS_NONE 'GreasedLineMeshOptions.ribbonOptions.directions' must be defined.";G=ha._GetDirectionPlanesFromDirectionsOption(n.length,x.ribbonOptions.directions)}n.forEach(((t,K)=>{const D=ha._ConvertToRibbonPath(t,x.ribbonOptions,this._scene.useRightHandedSystem,G?G[K]:G);N=this._preprocess(D,N,x)}))}}this._lazy||(this._createVertexBuffers(),this.refreshBoundingInfo())}static _GetDirectionPlanesFromDirectionsOption(t,K){return Array.isArray(K)?K:new Array(t).fill(K)}static _CreateRibbonVertexData(t,K){var D,a,G;const N=t.length;if(N<2)throw"Minimum of two paths are required to create a GreasedLineRibbonMesh.";const W=[],x=[],b=t[0];for(let K=0;K<b.length;K++)for(let D=0;D<t.length;D++){const a=t[D][K];W.push(a.x,a.y,a.z)}const n=[1,0,N],e=null!==(a=2===(null===(D=K.ribbonOptions)||void 0===D?void 0:D.facesMode))&&void 0!==a&&a,i=1===(null===(G=K.ribbonOptions)||void 0===G?void 0:G.pointsMode)&&K.ribbonOptions.closePath;if(N>2)for(let t=0;t<b.length-1;t++){n[0]=1+N*t,n[1]=N*t,n[2]=(t+1)*N;for(let t=0;t<2*(N-1);t++)t%2!=0&&(n[2]+=1),t%2==0&&t>0&&(n[0]+=1,n[1]+=1),x.push(n[1]+(t%2!=0?N:0),n[0],n[2]),e&&x.push(n[0],n[1]+(t%2!=0?N:0),n[2])}else for(let t=0;t<W.length/3-3;t+=2)x.push(t,t+1,t+2),x.push(t+2,t+1,t+3),e&&(x.push(t+1,t,t+2),x.push(t+1,t+2,t+3));if(i){let t=N*(b.length-1);for(let K=0;K<N-1;K++)x.push(t,K+1,K),x.push(t+1,K+1,t),e&&(x.push(K,K+1,t),x.push(t,K+1,t+1)),t++}return{positions:W,indices:x}}_preprocess(t,K,D){var a,G,N,W;this._paths=t;const x=ha._CreateRibbonVertexData(t,D),b=x.positions;if(!this._options.widths)throw"No 'GreasedLineMeshOptions.widths' table is specified.";const n=Array.isArray(this._vertexPositions)?this._vertexPositions:Array.from(this._vertexPositions);this._vertexPositions=n;const e=Array.isArray(this._uvs)?this._uvs:Array.from(this._uvs);this._uvs=e;const i=Array.isArray(this._indices)?this._indices:Array.from(this._indices);this._indices=i;for(const t of b)n.push(t);let z=t;if(1===(null===(a=D.ribbonOptions)||void 0===a?void 0:a.pointsMode)&&D.ribbonOptions.closePath){z=[];for(let K=0;K<t.length;K++){const D=t[K].slice();D.push(t[K][0].clone()),z.push(D)}}this._calculateSegmentLengths(z);const I=z.length,Z=new Array(I).fill(0);for(let t=0;t<z[0].length;t++){let K=0;for(let D=0;D<I;D++){const a=Z[D]+this._vSegmentLengths[D][t]/this._vTotalLengths[D];this._counters.push(a),e.push(a,K),Z[D]=a,K+=this._uSegmentLengths[t][D]/this._uTotalLengths[t]}}for(let t=0,K=0;t<z[0].length;t++){const D=this._uSegmentLengths[t][0]/2,a=this._uSegmentLengths[t][I-1]/2;this._ribbonWidths.push(((null!==(G=this._widths[K++])&&void 0!==G?G:1)-1)*D);for(let t=0;t<I-2;t++)this._ribbonWidths.push(0);this._ribbonWidths.push(((null!==(N=this._widths[K++])&&void 0!==N?N:1)-1)*a)}const w=1===(null===(W=D.ribbonOptions)||void 0===W?void 0:W.pointsMode)?new Array(z[0].length*z.length*6).fill(0):ha._CalculateSlopes(z);for(const t of w)this._slopes.push(t);if(x.indices)for(let t=0;t<x.indices.length;t++)i.push(x.indices[t]+K);return K+b.length/3}static _ConvertToRibbonPath(t,K,D,a){if(0===K.pointsMode&&!K.width)throw"'GreasedLineMeshOptions.ribbonOptiosn.width' must be specified in GreasedLineRibbonPointsMode.POINTS_MODE_POINTS.";const G=[],W=[];if(0===K.pointsMode){const x=K.width/2,b=Ia.ToVector3Array(t);let n=null,e=null;if(0===K.directionsAutoMode&&(a=ha._GetDirectionFromPoints(b[0],b[1],null)),3===K.directionsAutoMode&&!(K.directions instanceof N.Pq))throw"In GreasedLineRibbonAutoDirectionMode.AUTO_DIRECTIONS_FACE_TO 'GreasedLineMeshOptions.ribbonOptions.directions' must be a Vector3.";N.AA.Vector3[1]=K.directions instanceof N.Pq?K.directions:ha.DIRECTION_XZ;for(let t=0;t<b.length-(a?0:1);t++){const i=b[t],z=b[t+1];if(a)n=a;else if(3===K.directionsAutoMode)z.subtractToRef(i,N.AA.Vector3[0]),n=N.Pq.CrossToRef(N.AA.Vector3[0],N.AA.Vector3[1],N.AA.Vector3[2]).normalize();else if(1===K.directionsAutoMode)n=ha._GetDirectionFromPoints(i,z,n);else{const t=z.subtract(i);t.applyRotationQuaternionInPlace(t.x>t.y&&t.x>t.z?D?ha._RightHandedForwardReadOnlyQuaternion:ha._LeftHandedForwardReadOnlyQuaternion:ha._LeftReadOnlyQuaternion),n=t.normalize()}e=n.multiplyByFloats(x,x,x),G.push(i.add(e)),W.push(i.subtract(e))}a||(G.push(b[b.length-1].add(e)),W.push(b[b.length-1].subtract(e)))}return[G,W]}static _GetDirectionFromPoints(t,K,D){return t.x!==K.x||D&&1!==(null==D?void 0:D.x)?t.y===K.y?ha.DIRECTION_XZ:t.z===K.z?ha.DIRECTION_XY:ha.DIRECTION_XZ:ha.DIRECTION_YZ}clone(t=`${this.name}-cloned`,K){const D=this._createLineOptions(),a={},G=[];F.r.DeepCopy(this._pathsOptions,G,void 0,void 0,!0),F.r.DeepCopy(D,a,["instance"],void 0,!0);const N=new ha(t,this._scene,a,G);return K&&(N.parent=K),N.material=this.material,N}serialize(t){super.serialize(t),t.type=this.getClassName(),t.lineOptions=this._createLineOptions(),t.pathsOptions=this._pathsOptions}static Parse(t,K){const D=t.lineOptions,a=t.name,G=t.pathOptions;return new ha(a,K,D,G)}_initGreasedLine(){super._initGreasedLine(),this._paths=[],this._counters=[],this._slopes=[],this._ribbonWidths=[]}_calculateSegmentLengths(t){const K=t.length;this._vSegmentLengths=new Array(K),this._vTotalLengths=new Array(K);let D=0;for(let a=0;a<K;a++){const K=t[a];this._vSegmentLengths[a]=[0],D=0;for(let t=0;t<K.length-1;t++){const G=Math.abs(K[t].subtract(K[t+1]).lengthSquared());D+=G,this._vSegmentLengths[a].push(G)}this._vTotalLengths[a]=D}const a=t[0].length;this._uSegmentLengths=new Array(a).fill([]),this._uTotalLengths=new Array(a).fill([]);const G=new N.Pq;for(let N=0;N<a;N++){D=0;for(let a=1;a<K;a++){t[a][N].subtractToRef(t[a-1][N],G);const K=G.length();D+=K,this._uSegmentLengths[N].push(K)}this._uTotalLengths[N]=D}}static _CalculateSlopes(t){const K=t[0],D=2===t.length?t[1]:t[t.length-1],a=[],G=new N.Pq;for(let N=0;N<K.length;N++)for(let W=0;W<t.length;W++)0===W||W===t.length-1?(K[N].subtract(D[N]).normalizeToRef(G),a.push(G.x,G.y,G.z),a.push(-G.x,-G.y,-G.z)):a.push(0,0,0,0,0,0);return a}_createVertexBuffers(){var t,K;this._uvs=null!==(t=this._options.uvs)&&void 0!==t?t:this._uvs;const D=super._createVertexBuffers(null===(K=this._options.ribbonOptions)||void 0===K?void 0:K.smoothShading),a=new R.h(this._engine,this._counters,this._updatable,1);this.setVerticesBuffer(a.createVertexBuffer("grl_counters",0,1));const G=new R.h(this._engine,this._colorPointers,this._updatable,1);this.setVerticesBuffer(G.createVertexBuffer("grl_colorPointers",0,1));const N=new R.h(this._engine,this._slopes,this._updatable,3);this.setVerticesBuffer(N.createVertexBuffer("grl_slopes",0,3));const W=new R.h(this._engine,this._ribbonWidths,this._updatable,1);return this.setVerticesBuffer(W.createVertexBuffer("grl_widths",0,1)),this._widthsBuffer=W,D}}ha.DEFAULT_WIDTH=.1,ha._RightHandedForwardReadOnlyQuaternion=N.PT.RotationAxis(N.Pq.RightHandedForwardReadOnly,Math.PI/2),ha._LeftHandedForwardReadOnlyQuaternion=N.PT.RotationAxis(N.Pq.LeftHandedForwardReadOnly,Math.PI/2),ha._LeftReadOnlyQuaternion=N.PT.RotationAxis(N.Pq.LeftReadOnly,Math.PI/2),ha.DIRECTION_XY=N.Pq.LeftHandedForwardReadOnly,ha.DIRECTION_XZ=N.Pq.UpReadOnly,ha.DIRECTION_YZ=N.Pq.LeftReadOnly,function(t){t[t["COLOR_DISTRIBUTION_NONE"]=0]="COLOR_DISTRIBUTION_NONE",t[t["COLOR_DISTRIBUTION_REPEAT"]=1]="COLOR_DISTRIBUTION_REPEAT",t[t["COLOR_DISTRIBUTION_EVEN"]=2]="COLOR_DISTRIBUTION_EVEN",t[t["COLOR_DISTRIBUTION_START"]=3]="COLOR_DISTRIBUTION_START",t[t["COLOR_DISTRIBUTION_END"]=4]="COLOR_DISTRIBUTION_END",t[t["COLOR_DISTRIBUTION_START_END"]=5]="COLOR_DISTRIBUTION_START_END"}(Pa||(Pa={})),function(t){t[t["WIDTH_DISTRIBUTION_NONE"]=0]="WIDTH_DISTRIBUTION_NONE",t[t["WIDTH_DISTRIBUTION_REPEAT"]=1]="WIDTH_DISTRIBUTION_REPEAT",t[t["WIDTH_DISTRIBUTION_EVEN"]=2]="WIDTH_DISTRIBUTION_EVEN",t[t["WIDTH_DISTRIBUTION_START"]=3]="WIDTH_DISTRIBUTION_START",t[t["WIDTH_DISTRIBUTION_END"]=4]="WIDTH_DISTRIBUTION_END",t[t["WIDTH_DISTRIBUTION_START_END"]=5]="WIDTH_DISTRIBUTION_START_END"}(ya||(ya={}));var Ja,Ta=D(171482),_a=D(435683);class Ca extends xt.t{constructor(t,K,D,a=!1,G=!0,N=null,W=null,x=!1){if(super(K),this._onLoad=null,this._onError=null,!t)throw new Error("Image url is not set");this._coordinatesMode=U.g.CUBIC_MODE,this.name=t,this.url=t,this._size=D,this._supersample=x,this._noMipmap=a,this.gammaSpace=G,this._onLoad=N,this._onError=W,this.hasAlpha=!1,this.isCube=!0,this._texture=this._getFromCache(t,this._noMipmap,void 0,void 0,void 0,this.isCube),this._texture?N&&(this._texture.isReady?m.S0.SetImmediate((()=>N())):this._texture.onLoadedObservable.add(N)):K.useDelayedTextureLoading?this.delayLoadState=4:this._loadImage((()=>this._loadTexture()),this._onError)}_loadImage(t,K){const D=this.getScene();if(!D)return;const a=D.getEngine().createRawCubeTexture(null,this._size,4,D.getEngine().getCaps().textureFloat?1:7,!this._noMipmap,!1,3);a.generateMipMaps=!this._noMipmap,D.addPendingData(a),a.url=this.url,a.isReady=!1,D.getEngine()._internalTexturesCache.push(a),this._texture=a;const G=document.createElement("canvas");_a.W$(this.url,(K=>{this._width=K.width,this._height=K.height,G.width=this._width,G.height=this._height;const D=G.getContext("2d");D.drawImage(K,0,0);const a=D.getImageData(0,0,K.width,K.height);this._buffer=a.data.buffer,G.remove(),t()}),((t,G)=>{D.removePendingData(a),K&&K(`${this.getClassName()} could not be loaded`,G)}),D?D.offlineProvider:null)}_loadTexture(){const t=this.getScene();if(!t)return;const K=(()=>{const t=this._getFloat32ArrayFromArrayBuffer(this._buffer),K=Ta.D.ConvertPanoramaToCubemap(t,this._width,this._height,this._size,this._supersample),D=[];for(let t=0;t<6;t++){const a=K[Ca._FacesMapping[t]];D.push(a)}return D})(),D=this._texture;t.getEngine().updateRawCubeTexture(D,K,D.format,D.type,D.invertY),D.isReady=!0,t.removePendingData(D),D.onLoadedObservable.notifyObservers(D),D.onLoadedObservable.clear(),this._onLoad&&this._onLoad()}_getFloat32ArrayFromArrayBuffer(t){const K=new DataView(t),D=new Float32Array(3*t.byteLength/4);let a=0;for(let G=0;G<t.byteLength;G++)(G+1)%4!=0&&(D[a++]=K.getUint8(G)/255);return D}getClassName(){return"EquiRectangularCubeTexture"}clone(){const t=this.getScene();if(!t)return this;const K=new Ca(this.url,t,this._size,this._noMipmap,this.gammaSpace);return K.level=this.level,K.wrapU=this.wrapU,K.wrapV=this.wrapV,K.coordinatesIndex=this.coordinatesIndex,K.coordinatesMode=this.coordinatesMode,K}}Ca._FacesMapping=["right","left","up","down","front","back"],function(t){t[t["INIT"]=0]="INIT",t[t["RUNNING"]=1]="RUNNING",t[t["DONE"]=2]="DONE",t[t["ERROR"]=3]="ERROR"}(Ja||(Ja={}));class Ha{constructor(t){this.name=t,this._isCompleted=!1,this._taskState=0}get isCompleted(){return this._isCompleted}get taskState(){return this._taskState}get errorObject(){return this._errorObject}_setErrorObject(t,K){this._errorObject||(this._errorObject={message:t,exception:K})}run(t,K,D){this._taskState=1,this.runTask(t,(()=>{this._onDoneCallback(K,D)}),((t,K)=>{this._onErrorCallback(D,t,K)}))}runTask(t,K,D){throw new Error("runTask is not implemented")}reset(){this._taskState=0}_onErrorCallback(t,K,D){this._taskState=3,this._errorObject={message:K,exception:D},this.onError&&this.onError(this,K,D),t()}_onDoneCallback(t,K){try{this._taskState=2,this._isCompleted=!0,this.onSuccess&&this.onSuccess(this),t()}catch(t){this._onErrorCallback(K,"Task is done, error executing success callback(s)",t)}}}class oa{constructor(t,K,D){this.remainingCount=t,this.totalCount=K,this.task=D}}class Ua extends Ha{constructor(t,K,D,a,G){super(t),this.name=t,this.meshesNames=K,this.rootUrl=D,this.sceneFilename=a,this.extension=G}runTask(t,K,D){Lt.cn.LoadAssetContainer(this.rootUrl,this.sceneFilename,t,(t=>{this.loadedContainer=t,this.loadedMeshes=t.meshes,this.loadedTransformNodes=t.transformNodes,this.loadedParticleSystems=t.particleSystems,this.loadedSkeletons=t.skeletons,this.loadedAnimationGroups=t.animationGroups,K()}),null,((t,K,a)=>{D(K,a)}),this.extension)}}class Va extends Ha{constructor(t,K,D,a,G){super(t),this.name=t,this.meshesNames=K,this.rootUrl=D,this.sceneFilename=a,this.extension=G}runTask(t,K,D){Lt.cn.ImportMesh(this.meshesNames,this.rootUrl,this.sceneFilename,t,((t,D,a,G,N)=>{this.loadedMeshes=t,this.loadedTransformNodes=N,this.loadedParticleSystems=D,this.loadedSkeletons=a,this.loadedAnimationGroups=G,K()}),null,((t,K,a)=>{D(K,a)}),this.extension)}}class sa extends Ha{constructor(t,K){super(t),this.name=t,this.url=K}runTask(t,K,D){t._loadFile(this.url,(t=>{this.text=t,K()}),void 0,!1,!1,((t,K)=>{t&&D(t.status+" "+t.statusText,K)}))}}class Fa extends Ha{constructor(t,K){super(t),this.name=t,this.url=K}runTask(t,K,D){t._loadFile(this.url,(t=>{this.data=t,K()}),void 0,!0,!0,((t,K)=>{t&&D(t.status+" "+t.statusText,K)}))}}class ca extends Ha{constructor(t,K){super(t),this.name=t,this.url=K}runTask(t,K,D){const a=new Image;m.S0.SetCorsBehavior(this.url,a),a.onload=()=>{this.image=a,K()},a.onerror=t=>{D("Error loading image",t)},a.src=this.url}}class ga extends Ha{constructor(t,K,D,a=!0,G=U.g.TRILINEAR_SAMPLINGMODE){super(t),this.name=t,this.url=K,this.noMipmap=D,this.invertY=a,this.samplingMode=G}runTask(t,K,D){this.texture=new U.g(this.url,t,this.noMipmap,this.invertY,this.samplingMode,(()=>{K()}),((t,K)=>{D(t,K)}))}}class Ra extends Ha{constructor(t,K,D,a,G,N){super(t),this.name=t,this.url=K,this.extensions=D,this.noMipmap=a,this.files=G,this.prefiltered=N}runTask(t,K,D){this.texture=new Zt(this.url,t,this.extensions,this.noMipmap,this.files,(()=>{K()}),((t,K)=>{D(t,K)}),void 0,this.prefiltered)}}class Aa extends Ha{constructor(t,K,D,a=!1,G=!0,N=!1,W=!1){super(t),this.name=t,this.url=K,this.size=D,this.noMipmap=a,this.generateHarmonics=G,this.gammaSpace=N,this.reserved=W}runTask(t,K,D){this.texture=new Tt(this.url,t,this.size,this.noMipmap,this.generateHarmonics,this.gammaSpace,this.reserved,(()=>{K()}),((t,K)=>{D(t,K)}))}}class Ya extends Ha{constructor(t,K,D,a=!1,G=!0){super(t),this.name=t,this.url=K,this.size=D,this.noMipmap=a,this.gammaSpace=G}runTask(t,K,D){this.texture=new Ca(this.url,t,this.size,this.noMipmap,this.gammaSpace,(()=>{K()}),((t,K)=>{D(t,K)}))}}class La{constructor(t){this._isLoading=!1,this._tasks=new Array,this._waitingTasksCount=0,this._totalTasksCount=0,this.onTaskSuccessObservable=new d.cP,this.onTaskErrorObservable=new d.cP,this.onTasksDoneObservable=new d.cP,this.onProgressObservable=new d.cP,this.useDefaultLoadingScreen=!0,this.autoHideLoadingUI=!0,this._scene=t||$.q.LastCreatedScene}addContainerTask(t,K,D,a,G){const N=new Ua(t,K,D,a,G);return this._tasks.push(N),N}addMeshTask(t,K,D,a,G){const N=new Va(t,K,D,a,G);return this._tasks.push(N),N}addTextFileTask(t,K){const D=new sa(t,K);return this._tasks.push(D),D}addBinaryFileTask(t,K){const D=new Fa(t,K);return this._tasks.push(D),D}addImageTask(t,K){const D=new ca(t,K);return this._tasks.push(D),D}addTextureTask(t,K,D,a,G=U.g.TRILINEAR_SAMPLINGMODE){const N=new ga(t,K,D,a,G);return this._tasks.push(N),N}addCubeTextureTask(t,K,D,a,G,N){const W=new Ra(t,K,D,a,G,N);return this._tasks.push(W),W}addHDRCubeTextureTask(t,K,D,a=!1,G=!0,N=!1,W=!1){const x=new Aa(t,K,D,a,G,N,W);return this._tasks.push(x),x}addEquiRectangularCubeTextureAssetTask(t,K,D,a=!1,G=!0){const N=new Ya(t,K,D,a,G);return this._tasks.push(N),N}removeTask(t){const K=this._tasks.indexOf(t);K>-1&&this._tasks.splice(K,1)}_decreaseWaitingTasksCount(t){this._waitingTasksCount--;try{this.onProgress&&this.onProgress(this._waitingTasksCount,this._totalTasksCount,t),this.onProgressObservable.notifyObservers(new oa(this._waitingTasksCount,this._totalTasksCount,t))}catch(t){i.V.Error("Error running progress callbacks."),i.V.Log(t)}if(0===this._waitingTasksCount){try{const t=this._tasks.slice();this.onFinish&&this.onFinish(t);for(const K of t)if(2===K.taskState){const t=this._tasks.indexOf(K);t>-1&&this._tasks.splice(t,1)}this.onTasksDoneObservable.notifyObservers(this._tasks)}catch(t){i.V.Error("Error running tasks-done callbacks."),i.V.Log(t)}this._isLoading=!1,this.autoHideLoadingUI&&this._scene.getEngine().hideLoadingUI()}}_runTask(t){const K=(K,D)=>{t._setErrorObject(K,D),this.onTaskError?this.onTaskError(t):t.onError||i.V.Error(this._formatTaskErrorMessage(t)),this.onTaskErrorObservable.notifyObservers(t),this._decreaseWaitingTasksCount(t)};t.run(this._scene,(()=>{try{this.onTaskSuccess&&this.onTaskSuccess(t),this.onTaskSuccessObservable.notifyObservers(t),this._decreaseWaitingTasksCount(t)}catch(t){K("Error executing task success callbacks",t)}}),K)}_formatTaskErrorMessage(t){let K="Unable to complete task "+t.name;return t.errorObject.message&&(K+=`: ${t.errorObject.message}`),t.errorObject.exception&&(K+=`: ${t.errorObject.exception}`),K}reset(){return this._isLoading=!1,this._tasks=new Array,this}load(){if(this._isLoading)return this;if(this._isLoading=!0,this._waitingTasksCount=this._tasks.length,this._totalTasksCount=this._tasks.length,0===this._waitingTasksCount)return this._isLoading=!1,this.onFinish&&this.onFinish(this._tasks),this.onTasksDoneObservable.notifyObservers(this._tasks),this;this.useDefaultLoadingScreen&&this._scene.getEngine().displayLoadingUI();for(let t=0;t<this._tasks.length;t++){const K=this._tasks[t];0===K.taskState&&this._runTask(K)}return this}loadAsync(){return new Promise(((t,K)=>{this._isLoading?t():(this.onTasksDoneObservable.addOnce((D=>{D&&D.length?K(D):t()})),this.load())}))}}var Sa=D(83193),fa=D(10534),$a=D(837557),Ba=D(775286),Oa=D(382297);const va=20,pa=120,ja=["ॉ","ं","ु","ा"],ra=["ั","ิ","ึ","็","้"];var Ma=D(695620),ka=D(505985),tG=D(262073);function KG(t){if(t){const t=window.devicePixelRatio||1,K=.7;return it.X.Clamp(1/t,K,.9)}return.5}function DG(t){let K=(t+tG.QW/2)%tG["do"];return K<0&&(K+=tG["do"]),Math.floor(K/tG.QW)}function aG(t,K,D=!0){t&&(t.setEnabled(K),t.getChildMeshes(!D).forEach((t=>t.setEnabled(K))))}const GG=D.p+"images/bulbsanima.651bd379.webp",NG=D.p+"images/bulbsd.ec66b83b.webp",WG=D.p+"images/rimd.5d9c9932.jpg",xG=D.p+"images/topupd.6f0a4461.jpg",bG=D.p+"images/topupe.dfcd83cd.jpg",nG=D.p+"images/topups.57bd32fb.jpg",eG=D.p+"images/vaultd.5ce57106.jpg",iG=D.p+"images/vaultn.e30eba28.jpg",zG=D.p+"images/vaults.5bb80cef.jpg",IG=D.p+"models/wheel.a855dbb2.babylon",ZG=D.p+"images/winanimati.50d09b7e.webp",wG=D.p+"images/winprogres.e7e17e5d.webp";var mG=D(126409);const uG={width:920*($a.DS.IS_PHONE?.8:1),height:960*($a.DS.IS_PHONE?.8:1)};function dG(){return new Promise((t=>{const K=EG.getInstance();K.allLoaded()?t():K.onLoadFinish=t}))}class EG{static getInstance(){return EG.instance||(EG.instance=new EG),EG.instance}constructor(){this.domElement=document.createElement("canvas"),this.sceneLoaded=!1,this.fontLoaded=!1,this.isRtl=!1,this.outerRingWinSectors=[],this.middleRingWinSectors=[],this.innerRingWinSectors=[],this.topUpSectors=[],this.vaultVisible=!0,this.topUpVisible=!0,this.highlightedSector=null,this.title="",this.timer="",this.topUpDiffuseTexture=null,this.topUpHighlightTexture=null,this.timeline=fa.qI,this.domElement.width=uG.width,this.domElement.height=uG.height,this.domElement.className=mG.A.canvas,this.engine=Sa.createEngine(this.domElement,Sa.createDefaultEngineOptions($a.DS),{...Sa.createDefaultEngineFeatures($a.DS),hardwareScale:KG($a.DS.IS_PHONE)}),this.scene=Sa.createScene(this.engine,{...Sa.createDefaultSceneFeatures(),needInput:!1}),this.scene.clearColor=new ut.ov(0,0,0,0),this.scene.ambientColor=new ut.v9(.6,.6,.6),Sa.setMaterialFeatures({...Sa.createDefaultMaterialFeatures(),AmbientTextureEnabled:!0,LightmapTextureEnabled:!1}),this.camera=new _("cam1",new ut.Pq,this.scene),this.camera.position.set(0,0,-50),this.camera.fov=30*ka.up,this.camera.setTarget(ut.Pq.Zero()),this.cameraContainer=new Wt.V("camContainer"),this.camera.parent=this.cameraContainer,this.light=new V("light",ut.Pq.Zero(),ut.Pq.Zero(),1.2,2,this.scene),this.shadow=new C.o(1024,this.light),this.shadow.usePoissonSampling=!0,this.wheels=new Wt.V("wheels",this.scene),this.wheels.position.z=fa.Yw,this.vaultWheel=new Wt.V("vaultWheel",this.scene),this.topUpWheel=new Wt.V("topUpWheel",this.scene),this.vaultWheel.setParent(this.wheels),this.topUpWheel.setParent(this.wheels),this.winProgressMaterial=new aD.F("winProgressMaterial",this.scene),this.winProgressMaterial.emissiveColor=ut.v9.White(),this.winProgressMaterial.ambientColor=ut.v9.White(),this.winProgressMaterial.diffuseColor=ut.v9.White(),this.winProgressMaterial.specularColor=ut.v9.Black(),this.winAnimatedMaterial=new aD.F("winAnimatedMaterial",this.scene),this.winAnimatedMaterial.emissiveColor=ut.v9.White(),this.winAnimatedMaterial.ambientColor=ut.v9.White(),this.winAnimatedMaterial.diffuseColor=ut.v9.White(),this.winAnimatedMaterial.specularColor=ut.v9.Black(),this.winSectorIndicator1=qD("winSectorIndicator1",{width:1.2,height:8.36},this.scene),this.winSectorIndicator1.material=this.winAnimatedMaterial,this.winSectorIndicator1.position.set(-2.05,6.1,-3.2),this.winSectorIndicator1.rotation.z=15*ka.up,this.winSectorIndicator2=qD("winSectorIndicator2",{width:1.2,height:8.36},this.scene),this.winSectorIndicator2.material=this.winProgressMaterial,this.winSectorIndicator2.position.set(2.05,6.1,-3.2),this.winSectorIndicator2.rotation.z=-15*ka.up,this.winSectorIndicator1.setParent(this.vaultWheel),this.winSectorIndicator2.setParent(this.vaultWheel),this.rimBulbsMaterial=new aD.F("rimBulbsMaterial",this.scene),this.rimBulbsMaterial.diffuseColor=ut.v9.White(),this.rimBulbsMaterial.ambientColor=ut.v9.White(),this.rimBulbsMaterial.emissiveColor=ut.v9.White(),this.rimBulbsMaterial.specularColor=ut.v9.Black(),this.rimBulbsMaterial.useAlphaFromDiffuseTexture=!0,this.rimBulbsAnimatedMaterial=new aD.F("rimBulbsAnimatedMaterial",this.scene),this.rimBulbsAnimatedMaterial.diffuseColor=ut.v9.White(),this.rimBulbsAnimatedMaterial.ambientColor=ut.v9.White(),this.rimBulbsAnimatedMaterial.emissiveColor=ut.v9.White(),this.rimBulbsAnimatedMaterial.specularColor=ut.v9.Black(),this.rimBulbsAnimatedMaterial.useAlphaFromDiffuseTexture=!0,this.topUpAxis=new Wt.V("topUpAxis",this.scene),this.topUpAxis.rotation.y=180*ka.up,this.topUpAxis.setParent(this.topUpWheel),this.labelTexture=new GD("",1024,this.scene,!1),this.labelTexture.hasAlpha=!0,this.labelContext=this.labelTexture.getContext(),this.labelMaterial=new aD.F("labelMaterial",this.scene),this.labelMaterial.specularColor=ut.v9.Black(),this.labelMaterial.emissiveColor=ut.v9.White(),this.labelMaterial.ambientColor=ut.v9.White(),this.labelMaterial.diffuseTexture=this.labelTexture,this.labelMaterial.useAlphaFromDiffuseTexture=!0,this.labelPlane=qD("labelPlane",{width:27.5,height:27.5},this.scene),this.labelPlane.material=this.labelMaterial,this.labelPlane.parent=this.topUpAxis,this.labelPlane.position.z=-.5,this.labelPlane.rotation.y=0,this.centerContainer=new Wt.V("centerContainer",this.scene),this.titleTexture=new GD("title",{width:tG.qM,height:tG.qM*tG.qG},this.scene,!1),this.titleTexture.hasAlpha=!0,this.titleContext=this.titleTexture.getContext();const t=new aD.F("titleMaterial",this.scene);t.diffuseTexture=this.titleTexture,t.emissiveColor=ut.v9.White(),t.specularColor=ut.v9.Black(),t.useAlphaFromDiffuseTexture=!0;const K=15,D=qD("titleMesh",{width:K,height:K*tG.qG},this.scene);D.material=t,D.position.z=-4,D.position.y=K/2*(2-tG.qG),this.timerTexture=new GD("timer",{width:170,height:70},this.scene,!1),this.timerTexture.hasAlpha=!0,this.timerContext=this.timerTexture.getContext();const a=new aD.F("timerMaterial",this.scene);a.diffuseTexture=this.timerTexture,a.emissiveColor=ut.v9.White(),a.specularColor=ut.v9.Black(),a.useAlphaFromDiffuseTexture=!0;const G=qD("timerMesh",{width:4.5,height:2},this.scene);G.material=a,G.position.z=-4.4,G.setParent(this.centerContainer),this.loadFonts(),this.loadSceneParts()}setSize(){this.domElement.setAttribute("width",`${uG.width}`),this.domElement.setAttribute("height",`${uG.height}`)}render(){this.scene.render()}applyDebugProps(t){this.debugProps&&t.hideReels===this.debugProps.hideReels||(aG(this.innerRingWin,!t.hideReels),aG(this.middleRingWin,!t.hideReels),aG(this.outerRingWin,!t.hideReels)),!this.topUpSectors||this.debugProps&&void 0===t.hideTopUpSectorsOn3DWheel||this.topUpSectors.forEach((K=>aG(K,!t.hideTopUpSectorsOn3DWheel))),this.debugProps={...tG.I_,...t},t.light&&this.applyLightProps(this.light,t.light,this.shadow);const K=180*ka.up,D=t.tilt||tG.I_.tilt||.5;this.cameraContainer.rotation.y=K*D-K/2,void 0!==t.wheelTransitionProgress&&this.applyWheelTransition(t.wheelTransitionProgress),void 0!==t.timer&&this.setTimer(t.timer)}applySceneChanges(t){var K,D,a,G,N;this.debugProps&&void 0!==this.debugProps.wheelTransitionProgress||this.applyWheelTransition((null===(K=t.wheelTransition)||void 0===K?void 0:K.visibility)||0),this.applyWinProgress((null===(D=t.winProgress)||void 0===D?void 0:D.scale)||0),this.applyWinAnimation((null===(a=t.winAnimation)||void 0===a?void 0:a.visibility)||0,(null===(G=t.winAnimation)||void 0===G?void 0:G.scale)||0),this.debugProps&&void 0!==this.debugProps.timer||this.applyTimer((null===(N=t.timer)||void 0===N?void 0:N.scale)||0),this.vaultVisible&&this.applyVaultWheelChanges(t),this.topUpVisible&&this.applyTopUpWheelChanges(t)}updateLabelsImage(t){const K=t(),D=this.labelContext.canvas;this.labelContext.clearRect(0,0,D.width,D.height),this.labelContext.drawImage(K,0,0),this.labelTexture.update()}setTitle(t){this.title!==t&&(this.title=t,this.redrawTitle())}setLangDirection(t){this.isRtl!==t&&(this.isRtl=t,this.redrawTitle())}setTimer(t){this.timer!==t&&(this.timer=t,this.redrawTimer())}allLoaded(){return this.sceneLoaded&&this.fontLoaded}redrawTitle(){(function(t,K,D,a,G,N,W,x,b,n=G,e=D/4,i){const z=null!=i?i:"bold";t.clearRect(0,0,t.canvas.width,t.canvas.height),t.font=`${z} ${D}px ${a}, sans-serif`,t.fillStyle=G,t.shadowBlur=e,t.shadowColor=n,b&&(t.textAlign="center",K=[...K].reverse().join(""));const I=b?pa:va,Z=(t.canvas.width/2-I)/t.measureText(K).width;Z<1&&(t.font=`${z} ${D*Z}px ${a}, sans-serif`);const w=t.measureText(K).width,m=2*Math.PI*x,u=2*Math.PI*w/m,d=-w/x/2;t.save(),t.translate(N,W);let E=0;for(let D=0;D<K.length;D++){let a=K[D];const G=D+1;G<=K.length&&(ja.includes(K[G])||ra.includes(K[G]))&&(a=K[D]+K[G],D++);const N=t.measureText(a).width,W=d+(E+N/2)/w*u;t.save(),t.rotate(W),t.fillText(a,-N/2,-x),t.restore(),E+=N}t.restore()})(this.titleContext,this.title,40*tG.eU,Oa.Zn,"white",.5*tG.qM,tG.qM,349*tG.eU,this.isRtl,ka.RR,void 0,Oa.Wo),this.titleTexture.update()}redrawTimer(){(function(t,K,D,a,G){const{width:N,height:W}=t.canvas;t.clearRect(0,0,N,W),t.textBaseline="middle",t.font=`${G} ${D}px ${a}, sans-serif`,t.fillStyle="white",t.shadowBlur=D/4,t.shadowColor="rgb(251, 220, 1)";const x=t.measureText(K),b=x.width,n=x.actualBoundingBoxDescent/2;t.fillText(K,(N-b)/2,(W+n)/2)})(this.timerContext,this.timer,44,Oa.Zn,Oa.Wo),this.timerTexture.update()}applyLightProps(t,K,D){const a=-60,G=a*K.x-a/2,N=60,W=N*K.y-N/2,x=-100,b=x*K.z-x/2,n=1e-5*K.shadowBias;t.position.set(-G,W,b),t.setDirectionToTarget(new ut.Pq),t.intensity=K.intensity,t.range=K.radius,D&&(D.bias=n)}applyWheelTransition(t,K=!1){if(t===this.transitionValue&&!K)return;this.transitionValue=t;const D=this.timeline.totalTime,a=this.timeline.getProps(D*t);if(this.wheels.rotation.y=a.wheelRotation,this.wheels.position.z=a.wheelPosition,this.centerHandles){this.centerHandles.rotation.z=a.handlesRotation;const t=a.handlesScale;this.centerHandles.scaling.set(t,t,t)}this.centerContainer.position.z=a.lockPosition,this.setVaultWheelVisible(t<1),this.setTopUpWheelVisible(t>0)}setVaultWheelVisible(t){this.vaultVisible!==t&&(this.vaultVisible=t,aG(this.vaultWheel,t))}setTopUpWheelVisible(t){this.topUpVisible!==t&&(this.topUpVisible=t,aG(this.topUpWheel,t))}checkAllLoaded(){this.allLoaded()&&this.onLoadFinish&&this.onLoadFinish()}loadFonts(){const t=()=>{this.fontLoaded=!0,this.redrawTitle(),this.redrawTimer(),this.checkAllLoaded()};Ba.Al(Oa.Zn).then(t).catch(t)}loadSceneParts(){const t=new La(this.scene);t.useDefaultLoadingScreen=!1;const[K,D]=function(t){const K=document.createElement("a");K.href=t;const D=K.href,a=D.lastIndexOf("/");return[D.substr(0,a+1),D.substr(a+1)]}(IG),a=t.addMeshTask("","",K,D),G=t.addTextureTask("",eG),N=t.addTextureTask("",iG),W=t.addTextureTask("",zG),x=t.addTextureTask("",xG),b=t.addTextureTask("",nG),n=t.addTextureTask("",bG),e=t.addTextureTask("",WG),i=t.addTextureTask("",NG),z=t.addTextureTask("",GG),I=t.addTextureTask("",wG),Z=t.addTextureTask("",ZG);t.onTasksDoneObservable.add((()=>{this.topUpDiffuseTexture=x.texture,this.topUpHighlightTexture=n.texture;const t=new aD.F("vaultMat",this.scene);t.diffuseTexture=G.texture,t.bumpTexture=N.texture,t.specularTexture=W.texture,t.ambientColor=new ut.v9(1,1,1),t.specularColor=new ut.v9(1,1,1),t.twoSidedLighting=!0;const K=new aD.F("topUpMat",this.scene);K.diffuseTexture=x.texture,K.specularTexture=b.texture,K.ambientColor=new ut.v9(1,1,1),K.specularColor=new ut.v9(1,1,1);const D=new aD.F("staticMat",this.scene);D.diffuseTexture=x.texture,D.specularTexture=b.texture,D.ambientColor=new ut.v9(1,1,1),D.specularColor=new ut.v9(1,1,1);const w=new aD.F("rimMat",this.scene);w.diffuseTexture=e.texture,w.ambientColor=ut.v9.White(),w.diffuseColor=ut.v9.White(),w.emissiveColor=ut.v9.White(),w.specularColor=ut.v9.Black(),this.rimBulbsMaterial.diffuseTexture=i.texture,this.rimBulbsMaterial.diffuseTexture.hasAlpha=!0,this.rimBulbsAnimatedMaterial.diffuseTexture=z.texture,this.rimBulbsAnimatedMaterial.diffuseTexture.hasAlpha=!0,this.initLoadedMeshes(a.loadedMeshes,t,K,D,w),I.texture.uScale=1/ka.gT,this.winProgressMaterial.diffuseTexture=I.texture,this.winProgressMaterial.diffuseTexture.hasAlpha=!0,this.winProgressMaterial.useAlphaFromDiffuseTexture=!0,Z.texture.uScale=1/4,this.winAnimatedMaterial.diffuseTexture=Z.texture,this.winAnimatedMaterial.diffuseTexture.hasAlpha=!0,this.winAnimatedMaterial.useAlphaFromDiffuseTexture=!0,this.sceneLoaded=!0,this.scene.meshes.forEach((t=>{t.isPickable=!1})),this.checkAllLoaded()})),t.load()}initLoadedMeshes(t,K,D,a,G){this.wheels.rotation.y=0,this.wheels.position.z=fa.Yw,this.topUpAxis.rotation.z=0;const N=t.find((t=>"default_wheel"===t.name));N&&(N.getChildMeshes(!1).forEach((t=>{t.material=K,t.receiveShadows=!0,this.shadow.addShadowCaster(t)})),N.setParent(this.vaultWheel));const W=t.find((t=>"top_up_wheel"===t.name));W&&(W.material=D,W.receiveShadows=!0,W.getChildMeshes(!1).forEach((t=>{t.material=D,t.receiveShadows=!0})),W.setParent(this.topUpAxis)),this.rim=t.find((t=>"rim"===t.name)),this.rim&&(this.rim.material=G,this.rim.receiveShadows=!0,this.shadow.addShadowCaster(this.rim)),this.rimBulbs=t.find((t=>"bulbs"===t.name)),this.rimBulbs&&(this.rimBulbs.material=this.rimBulbsMaterial);const x=t.find((t=>"win_sector"===t.name));x&&(x.material=a,this.shadow.addShadowCaster(x)),this.centerLock=t.find((t=>"center_lock"===t.name)),this.centerLock&&(this.centerLock.material=a,this.shadow.addShadowCaster(this.centerLock),this.centerLock.parent=this.centerContainer),this.centerHandles=t.find((t=>"center_handles"===t.name)),this.centerHandles&&(this.centerHandles.material=a,this.shadow.addShadowCaster(this.centerHandles)),this.outerRing=t.find((t=>"out_ring"===t.name)),this.outerRingWin=t.find((t=>"outer_sector"===t.name)),this.outerRingWinSectors=[t.find((t=>"outer_sector_6"===t.name)),t.find((t=>"outer_sector_5"===t.name)),t.find((t=>"outer_sector_4"===t.name)),t.find((t=>"outer_sector_3"===t.name)),t.find((t=>"outer_sector_2"===t.name)),t.find((t=>"outer_sector_1"===t.name))],this.middleRing=t.find((t=>"middle_ring"===t.name)),this.middleRingWin=t.find((t=>"middle_sector"===t.name)),this.middleRingWinSectors=[t.find((t=>"middle_sector_4"===t.name)),t.find((t=>"middle_sector_3"===t.name)),t.find((t=>"middle_sector_2"===t.name)),t.find((t=>"middle_sector_1"===t.name))],this.innerRing=t.find((t=>"inner_ring"===t.name)),this.innerRingWin=t.find((t=>"inner_sector"===t.name)),this.innerRingWinSectors=[t.find((t=>"inner_sector_4"===t.name)),t.find((t=>"inner_sector_3"===t.name)),t.find((t=>"inner_sector_2"===t.name)),t.find((t=>"inner_sector_1"===t.name))];const b=t.find((t=>"gradient_planes"===t.name));if(b){const t=new aD.F("",this.scene);t.diffuseColor=ut.v9.Black(),t.specularColor=ut.v9.Black(),t.emissiveColor=ut.v9.Black(),b.material=t}for(let K=0;K<15;K++){const a=`top_up_sector_${16-K-1}`,G=t.find((t=>t.name===a));G&&(G.material=D.clone(a)),this.topUpSectors[K]=G}this.applyWheelTransition(this.transitionValue||0,!0)}applyVaultWheelChanges(t){var K,D,a,G,N,W,x;const b=(null===(K=t.ringOut)||void 0===K?void 0:K.rotation)||0,n=(null===(D=t.ringOut)||void 0===D?void 0:D.scale)||0,e=n*tG.qh,i=(null===(a=t.ringMid)||void 0===a?void 0:a.rotation)||0,z=(null===(G=t.ringMid)||void 0===G?void 0:G.scale)||0,I=z*tG.kA,Z=(null===(N=t.ringInn)||void 0===N?void 0:N.rotation)||0,w=(null===(W=t.ringInn)||void 0===W?void 0:W.scale)||0,m=w*tG.vS,u=null===(x=t.lock)||void 0===x?void 0:x.rotation,d=5-DG(b),E=d>=0&&d<=5?d:void 0,l=n*tG.JV,Q=3-DG(i),P=Q>=0&&Q<=3?Q:void 0,y=z*tG.Fd,q=3-DG(Z),X=q>=0&&q<=3?q:void 0,h=w*tG.EW;this.outerRing&&(this.outerRing.position.z=e),this.middleRing&&(this.middleRing.position.z=I),this.innerRing&&(this.innerRing.position.z=m),this.outerRingWin&&(this.outerRingWin.rotation.z=-b-ka.pe);for(let t=0;t<6;t++){const K=this.outerRingWinSectors[t];K&&(K.position.z=t===E?-l:-e)}this.middleRingWin&&(this.middleRingWin.rotation.z=-i-ka.jV);for(let t=0;t<4;t++){const K=this.middleRingWinSectors[t];K&&(K.position.z=t===P?-y:-I)}this.innerRingWin&&(this.innerRingWin.rotation.z=-Z-ka.Yr);for(let t=0;t<4;t++){const K=this.innerRingWinSectors[t];K&&(K.position.z=t===X?-h:-m)}this.centerHandles&&void 0!==u&&(this.centerHandles.rotation.z=u)}applyTopUpWheelChanges(t){var K;const D=(null===(K=t.topUp)||void 0===K?void 0:K.rotation)||0;this.topUpAxis.rotation.z=-D;const a=t.topUpSectorLight&&1===t.topUpSectorLight.visibility?function(t){let K=(t-tG.Rp/2)%tG["do"];return K<0&&(K+=tG["do"]),Math.floor(K/tG.Rp)}(D):null;this.setHighlightedSector(a)}setHighlightedSector(t){this.highlightedSector!==t&&(this.highlightedSector=t,this.topUpSectors.forEach(((K,D)=>{K&&(K.material.diffuseTexture=D===t?this.topUpHighlightTexture:this.topUpDiffuseTexture)})))}applyWinProgress(t){(t=it.X.Clamp(t,0,1))<.01&&(t=0);const K=Math.min(Math.ceil(t*ka.gT),ka.gT-1)/ka.gT,D=this.winProgressMaterial.diffuseTexture;D&&(D.uOffset=K)}applyWinAnimation(t,K){const D=t>0,a=D?this.winAnimatedMaterial:this.winProgressMaterial;this.winSectorIndicator1.material=a,this.winSectorIndicator2.material=a;const G=Math.round(K*ka.dR)/ka.dR,N=this.winAnimatedMaterial.diffuseTexture;N&&(N.uOffset=G),this.rimBulbs&&(this.rimBulbs.material=D?this.rimBulbsAnimatedMaterial:this.rimBulbsMaterial,D)&&(this.rimBulbsAnimatedMaterial.diffuseTexture.vOffset=G)}applyTimer(t){this.setTimer(Ma.fE(t))}}},262073:(t,K,D)=>{D.d(K,{EW:()=>z,Fd:()=>e,I_:()=>a,JV:()=>b,QW:()=>N,Rp:()=>W,do:()=>G,eU:()=>Z,kA:()=>n,qG:()=>w,qM:()=>I,qh:()=>x,vS:()=>i});const a={light:{x:.5,y:.64,z:.78,shadowBias:.5,intensity:2.42,radius:35},tilt:.5,wheelTransitionProgress:void 0},G=2*Math.PI,N=G/12,W=G/15,x=0,b=1,n=0,e=.635,i=0,z=.96,I=1024,Z=I/512,w=.5},505985:(t,K,D)=>{D.d(K,{RR:()=>n,Yr:()=>b,dR:()=>a,gT:()=>G,jV:()=>x,pe:()=>W,up:()=>N});const a=4,G=14,N=Math.PI/180,W=-Math.PI/2+Math.PI/6-15*N,x=-Math.PI/3+Math.PI/6-15*N,b=-Math.PI/3+Math.PI/6-15*N,n="rgb(251, 220, 1)"},10534:(t,K,D)=>{D.d(K,{qI:()=>I,Yw:()=>b});var a=D(384511);function G(t,K){const D=function(t,K){const D=K-t;return K=>t+D*K}(t,K);return G=>a.qE(D(G),Math.min(t,K),Math.max(t,K))}var N=D(882446);class W{constructor(t){this.config=function(t){const K={};for(const D in t)if(t.hasOwnProperty(D)){const a=t[D];K[D]=a.concat().sort(((t,K)=>t.startTime-K.startTime))}return K}(t),this.totalTime=this.timelineTotalTime(t)}getProps(t){const K={};for(const D in this.config)if(this.config.hasOwnProperty(D)){const a=this.config[D],[G,W]=N.A(a,(({startTime:K})=>K<=t)),x=G.length>0?G[G.length-1]:W.length>0?W[0]:void 0;if(x){const a=(t-x.startTime)/x.duration;K[D]=x.value(a)}}return K}timelineTotalTime(t){const K=Object.keys(t).map((K=>{const D=t[K].map((t=>t.startTime+t.duration));return Math.max(...D)}));return Math.max(...K)}}var x=D(505985);const b=-1,n=0,e={transition:[{startTime:n,duration:1,value:G(0,1)}]},i={handlesRotation:[{startTime:n,duration:.8,value:G(0,-360*x.up)}],handlesScale:[{startTime:n+.8,duration:.2,value:G(1,.6)},{startTime:n+1,duration:1,value:(z=0,()=>z)}],wheelPosition:[{startTime:n+1,duration:1,value:G(b,6)},{startTime:n+2.3,duration:.7,value:G(6,b)}],wheelRotation:[{startTime:n+1.6,duration:.7,value:G(0,180*x.up)}],lockPosition:[{startTime:n+1,duration:.6,value:G(0,9)},{startTime:n+2.3,duration:.7,value:G(9,.7)}]};var z;new W(e);const I=new W(i)},937807:(t,K,D)=>{D.d(K,{Od:()=>e,ST:()=>I,TJ:()=>W,TV:()=>i,a8:()=>z,dm:()=>w,kz:()=>Z});var a=D(160739),G=D(457626);function N(t){return t.gameLayout}const W=a.Mz(N,(t=>t.currentGameState)),x=a.Mz(N,(t=>t.previousGameState)),b=a.Mz(N,(t=>t.layoutSwitchedToTopUp)),n=a.Mz(W,x,b,((t,K,D)=>"Qualified"===t&&("Qualifying"===K&&D||"Qualifying"!==K))),e=a.Mz(W,n,((t,K)=>"Qualifying"===t||"Qualified"===t&&!K)),i=a.Mz(W,n,((t,K)=>"Qualified"===t&&K)),z=a.Mz(N,(t=>t.isCongratulationMessageVisible)),I=a.Mz(N,(t=>t.isBonusRoundVisible)),Z=a.Mz(W,x,((t,K)=>"BonusRound"===t&&"Qualified"===K)),w=a.Mz(e,i,G.x,((t,K,D)=>(t||K)&&D))},530113:(t,K,D)=>{D.d(K,{S:()=>a});const a={customizableButton:{customizable:{mainLight:{gradient:"linear-gradient(180deg, rgba(255, 255, 255, 0.20) 0%, rgba(255, 255, 255, 0.00) 56.26%)"},midBody:{gradient:"linear-gradient(180deg, #1D2733 0%, #000 100%)",strokeColor:"linear-gradient(0deg, rgba(255, 255, 255, 0.15) 0%,rgba(255, 255, 255, 0.3) 100%)",gradientActivated:"#2C3C4E",strokeColorActivated:"linear-gradient(180deg, #1D2733 0%, #577599 100%"}}}}},224169:(t,K,D)=>{D.d(K,{Z:()=>MK});var a=D(64922),G=D(794140),N=D(36638),W=D(967810),x=D(9676),b=D(499532),n=D(284824);const e=({dispatch:t})=>K=>D=>{switch(D.type){case b.Vy:{const{key:K,value:a}=D.payload;K===n.bR&&!0===a&&t(W.QH());break}}return K(D)};var i=D(313085);const z={bonus:D(1941).wx,decisionPlayers:i.LV};var I=D(838930),Z=D(712787);const w=({dispatch:t})=>K=>D=>(I.F(D)&&t(Z.Nb()),K(D));var m=D(467380);const u={boxes:D(496464).oA,playerActions:m.sd},d={currentGameState:"Unknown",previousGameState:"Unknown",isCongratulationMessageVisible:!1,layoutSwitchedToTopUp:!1,isBonusRoundVisible:!1};function E(t){return{type:"GameLayout/SET_LAYOUT_SWITCHED_TO_TOPUP",payload:t}}function l(t){return{type:"GameLayout/SET_IS_BONUS_ROUND_VISIBLE",payload:t}}const Q={gameLayout:function(t=d,K){switch(K.type){case"GameLayout/SET_CURRENT_GAME_STATE":return{...t,currentGameState:K.payload};case"GameLayout/SET_PREVIOUS_GAME_STATE":return{...t,previousGameState:K.payload};case"GameLayout/SHOW_CONGRATULATION_MESSAGE":return{...t,isCongratulationMessageVisible:!0};case"GameLayout/HIDE_CONGRATULATION_MESSAGE":return{...t,isCongratulationMessageVisible:!1};case"GameLayout/SET_LAYOUT_SWITCHED_TO_TOPUP":return{...t,layoutSwitchedToTopUp:K.payload};case"GameLayout/SET_IS_BONUS_ROUND_VISIBLE":return{...t,isBonusRoundVisible:K.payload};default:return t}}};var P=D(931170),y=D(923148),q=D(40729),X=D(977927),h=D(357223),J=D(238733),T=D(465082),_=D(422194),C=D(276111),H=D(769413);function o({target:t,multiplier:K,durationIn:D=.5,easingIn:a=C.dV}){const G=H.M(t.scale);return G.animateTo({x:t.scale.x*K,y:t.scale.y*K},D,a),G}var U=D(280948),V=D(170877),s=D(315049),F=D(234341),c=D(853964);const g="in vec2 aPosition;out vec2 vTextureCoord;uniform vec4 uInputSize;uniform vec4 uOutputFrame;uniform vec4 uOutputTexture;vec4 filterVertexPosition(void){vec2 position=aPosition*uOutputFrame.zw+uOutputFrame.xy;position.x=position.x*(2./uOutputTexture.x)-1.;position.y=position.y*(2.*uOutputTexture.z/uOutputTexture.y)-uOutputTexture.z;return vec4(position,0.,1.);}vec2 filterTextureCoord(void){return aPosition*(uOutputFrame.zw*uInputSize.zw);}void main(void){gl_Position=filterVertexPosition();vTextureCoord=filterTextureCoord();}",R="in vec2 vTextureCoord;out vec4 finalColor;uniform sampler2D uTexture;uniform float uLightness;void main(){vec4 color=texture(uTexture,vTextureCoord);vec3 resultRGB=color.rgb;resultRGB=mix(resultRGB,vec3(ceil(uLightness))*color.a,abs(uLightness));finalColor=vec4(resultRGB,color.a);}";class A extends J.dJT{constructor(t){super({glProgram:J.M2g.from({vertex:g,fragment:R,name:"lightness-filter"}),resources:{lightnessUniforms:{uLightness:{value:t,type:"f32"}}}})}get lightness(){return this.resources.lightnessUniforms.uniforms.uLightness}set lightness(t){this.resources.lightnessUniforms.uniforms.uLightness=t}}function Y(t){const K=new A(0);return t.container.filters=[K],Object.defineProperty({...t},"lightness",{get:()=>K.lightness,set:t=>{K.lightness=t}})}const L={scatter:0,scatter2x:2,scatter3x:3,scatter5x:5,scatter10x:10},S=q.Sw/1e3;class f extends J.mcf{constructor(t){super(),this.params=t}async getAnimation(){const{beam:t}=await c.a.get(),K=F.M();return this.calcBeamDestination().forEach((D=>{const a=t({from:this.getPartOfVector(.2,D),to:D,animationTimeSec:.8*S});this.addChild(a),K.callback((()=>{a.startAnimation()})).delay(S)})),K}calcBeamDestination(){const{appSize:t,platform:K}=this.params,{height:D,width:a}=t;let G=0,N=0,W=0,x=1;switch(K){case V.OD.Phone:{const t=$(),K=27*t;N=K/8,G=D-16*t-K-60+.5*N,W=a/3,x=.8;break}case V.OD.Tablet:{const t=$();N=27*1.8*t/8,G=8*t+.5*N,W=a/8,x=.7;break}case V.OD.Desktop:N=.55*D/8,G=.2*D+.5*N,W=a/10,x=.7}const b=[];for(let t=0;t<8;t++)b.push({x:W,y:G+t*N});for(let t=0;t<8;t++)b.push({x:a-W,y:G+t*N});return b.map((t=>this.getPartOfVector(x,t)))}getPartOfVector(t,K){const{startPoint:D}=this.params;return{x:D.x+(K.x-D.x)*t,y:D.y+(K.y-D.y)*t}}}function $(){return parseInt(getComputedStyle(document.body).getPropertyValue("--root-size"),10)}const B=.6,O=1.3,v=.9;class p{constructor(t){this.params=t,this.stop=()=>{}}async play(){void 0!==this.animation&&this.animation.fastForward(),this.animation=await this.createAnimation(),this.stop=s.l({anim:this.animation,repeat:0,ticker:T._,dispose:!0})}dispose(){var t;this.stop(),null===(t=this.animation)||void 0===t||t.dispose()}async createAnimation(){const{onStep:t,app:K,totalMultiplier:D,targetPoint:a,platform:G}=this.params,N=this.createRootContainer();K.stage.addChild(N);const W=this.createOverlay(),x=await this.createScatters(),[b,n,e]=x,i=await async function(t,K,D){const{multiplyScatterTextures:a,winLight:G}=await c.a.get(),N=new J.mcf({...t}),W=G({animationTimeSec:.4,scale:2.2});W.setSize(K.width),N.addChild(W),W.show();const x=new J.kxk(a["Scatter_filled"]);x.width=K.width,x.height=K.height,x.anchor.set(.5),N.addChild(x);const b=new J.kxk(a["Scatter_blank"]);b.width=K.width,b.height=K.height,b.anchor.set(.5),N.addChild(b),b.visible=!1,x.visible=!1;let n=D;const e=new J.T7$({text:`${D}x`,style:{fontFamily:"scatterMultiplierFont",fontSize:50}});return e.anchor.set(.5,.6),b.addChild(e),Y({container:N,startAnimation:()=>{W.startRotateAnimation()},setMultiplierValue:t=>{b.visible=t>0,x.visible=t<=0,n=t,e&&(e.text=`${t}x`)},getMultiplierValue:()=>n})}(a,this.scatterSize,D),z=new f({appSize:this.appSize,platform:G,startPoint:a}),I=await z.getAnimation();N.addChild(W,n.container,b.container,e.container,z,i.container),i.container.visible=!1;const Z=n.container.position;return F.M().callback((()=>t("start"))).parallel([_.X({target:W,durationIn:.5,destinationAlpha:G===V.OD.Phone?1:.8}),H.M({}).callback((()=>x.forEach((t=>t.startAnimation())))),H.M({}).delay(B)]).sequence(this.moveScatterTo(b,Z)).callback((()=>{i.container.position.set(n.container.position.x,n.container.position.y),N.removeChild(n.container,b.container),i.setMultiplierValue(n.getMultiplierValue()+b.getMultiplierValue()),i.container.visible=!0})).sequence(this.shakeScatter(i,Z)).sequence(this.moveScatterTo(e,Z)).callback((()=>{N.removeChild(e.container),i.setMultiplierValue(e.getMultiplierValue()+i.getMultiplierValue())})).sequence(this.shakeScatter(i,Z)).parallel([this.moveScatterTo(i,a),o({target:i.container,durationIn:.5,multiplier:1.2*this.scalingMultiplier})]).callback((()=>{t("showCongratulationMessage"),t("switchToTopUpRound")})).sequence(o({target:i.container,durationIn:.3,multiplier:this.scalingMultiplier})).callback((()=>{i.startAnimation(),t("applyMultiplier")})).delay(.2).parallel([I,_.X({target:W,durationIn:.5,destinationAlpha:.8})]).callback((()=>{t("hideCongratulationMessage")})).sequence(_.X({target:W,durationIn:.15,destinationAlpha:1})).parallel([_.X({target:W,durationIn:.2,destinationAlpha:0}),this.hideScatter(i)]).callback((()=>{t("finish")})).onDispose((()=>{K.stage.removeChild(N)}))}createRootContainer(){const t=new J.mcf({x:0,y:0,...this.appSize});return t.zIndex=1,t}createOverlay(){return function({size:t,color:K=0,alpha:D=0}){const a=new J.A1g({alpha:D});return a.rect(0,0,t.width,t.height),a.fill(K),a}({size:this.appSize})}async createScatters(){const{scattersData:t}=this.params;return await Promise.all(t.map((t=>async function(t,K){const{symbols:D,winLight:a}=await c.a.get(),{position:G,size:N,symbolName:W}=t,x=new J.mcf({...G}),b=a({animationTimeSec:K,scale:1.7});b.setSize(N.width),x.addChild(b);const n=D[W](K);n.setSize(N.width,N.height),x.addChild(n);const e=L[W]||0;return Y({container:x,startAnimation:()=>{b.startShowAnimation(),n.startAnimation()},getMultiplierValue:()=>e,setMultiplierValue:()=>{}})}(t,B))))}get appSize(){const{app:t}=this.params;return{width:t.renderer.width,height:t.renderer.height}}moveScatterTo(t,K){return U.t({target:t.container,destination:K,durationIn:.25})}shakeScatter(t,K){return function({target:t,shift:K,startPoint:D,durationIn:a=.5,easingIn:G=C.dV}){const N=H.M(t.position),W=a/5;return N.animateTo({x:D.x+K},W,G),N.animateTo({x:D.x-K},W,G),N.animateTo({y:D.y-K},W,G),N.animateTo({y:D.y+K},W,G),N.animateTo({x:D.x,y:D.y},W,G),N}({target:t.container,shift:15,startPoint:K,durationIn:.15})}get scalingMultiplier(){const{platform:t}=this.params;return t===V.OD.Phone?v:O}get scatterSize(){const{scattersData:t}=this.params;return t[0].size}hideScatter(t){const K=.1,D=.2,{targetPoint:a}=this.params;return F.M().sequence(H.M(t).animateTo({lightness:1},.1,C.AR)).parallel([o({target:t.container,durationIn:K,multiplier:1.2,easingIn:C.ME}),U.t({target:t.container,durationIn:K,destination:a,easingIn:C.ME})]).delay(.2).parallel([o({target:t.container,durationIn:D,multiplier:0,easingIn:C.ME}),U.t({target:t.container,durationIn:D,destination:a,easingIn:C.ME})])}}var j=D(937807);const r=2e3;function M(t,K){setTimeout((()=>{const D=h.WN(t());(function(t,K){switch(t){case"Qualifying":X.A("GameInitSlot",K);break;case"Qualified":X.A("GameInitTopUp");break;case"Resolved":case"BonusRound":X.A("GameInitDond")}})(K||"Qualifying",D&&"Normal"!==D?"GameInitXxxtremeSpinsActive":"GameInitXxxtremeSpinsInactive")}),2e3)}const k=({dispatch:t})=>K=>D=>{return P.V(D)&&t((a=D.payload,async(t,K,{pixiAppContainer:D,getAG:G})=>{const N=D.get();if(!N)return;const W=G().platform;new p({...a,platform:W,app:N.app,targetPoint:{x:N.size.width/2,y:N.size.height/2},onStep:K=>{switch(K){case"start":X.A("ScatterSum");break;case"showCongratulationMessage":t({type:"GameLayout/SHOW_CONGRATULATION_MESSAGE"});break;case"applyMultiplier":t(q.W());break;case"switchToTopUpRound":t(E(!0));break;case"hideCongratulationMessage":t({type:"GameLayout/HIDE_CONGRATULATION_MESSAGE"});break;case"finish":t((t=>{t({type:"GameLayout/HIDE_CONGRATULATION_MESSAGE"})}))}}}).play()})),K(D);var a};var tt=D(199002);class Kt{constructor(){this.instance=void 0,this.waiter=new tt.h}get(){return this.instance}async getAsync(){return this.waiter}set(t){this.instance=t,this.waiter.resolve(t)}dispose(){this.instance&&(this.instance.dispose(),this.instance=void 0),this.waiter=new tt.h}}const Dt={pixiAppContainer:new Kt};var at=D(131087);const Gt={slotMachineContainer:new Kt};var Nt=D(727798),Wt=D(551817);const xt={dondSlotGame:at.YB,qualification:Nt.km,xxxtreme:Wt.Wl},bt={...Gt};var nt=D(510504),et=D(728920);const it=({dispatch:t})=>K=>D=>(nt.m(D)&&t(et.V_(D.spinMode)),K(D)),zt="qualifiedPlayers/SET",It=0,Zt={qualifiedPlayersCount:function(t=It,K){return K.type===zt?K.payload:t}},wt={splashScreen:D(711582).g};var mt=D(209901),ut=D(495476);const dt={topUp:mt.LU,topUpWheel:ut.oT};var Et=D(65746),lt=D(838998);const Qt=({dispatch:t})=>K=>D=>(Et._(D)&&t(lt.U5()),K(D));var Pt=D(179062);const yt={dondWinnersList:D(302607).tO};var qt=D(160739),Xt=D(641286),ht=D(13799);const Jt=qt.Mz(ht.DB,(t=>{var K;return"true"===(null===(K=null==t?void 0:t.rawConfig)||void 0===K?void 0:K.help_volatility)}));var Tt=D(730837),_t=D(816340);const Ct=qt.Mz(ht.DB,(t=>{var K;return"true"===(null===(K=null==t?void 0:t.rawConfig)||void 0===K?void 0:K.help_show_malfunction_note)})),Ht=qt.Mz(Tt.RB,Ct,(ot=9.9,qt.Mz((Ut=ot,qt.Mz(ht.DB,(t=>{var K;return Xt.R(null===(K=null==t?void 0:t.rawConfig)||void 0===K?void 0:K.volatility_index,Ut)}))),Jt,((t,K)=>({index:t,visible:K})))),_t.K,_t.F,((t,K,D,a,G)=>({turboMode:t,showMalfunctionNote:K,volatility:D,disableFeatureBuy:G,disableXXXtremeSpins:!a})));var ot,Ut,Vt=D(85),st=D(436794),Ft=D(837557),ct=D(207499),gt=D(277082),Rt=D(530113),At=D(732990),Yt=D(151739);const Lt="dond.playerState";function St(t,K){return t=>{if(function(t){const{type:K,payload:D}=t;return K===Lt&&"object"==typeof D&&null!==D&&"error"in D}(t)&&t.type===Lt){const{error:{code:D}}=t.payload;K(Yt.f1({errorId:`error_${D}`}))}}}var ft=D(555405);const $t="dond.playerState";function Bt(t){const{type:K,payload:D}=t;return K===$t&&"object"==typeof D&&null!==D&&"game"in D}function Ot(t){if(!Bt(t))return!1;const{state:K}=t.payload.game;return"BonusRound"===K||"Resolved"===K}const vt=()=>!1,pt=qt.Mz(ht.DB,(t=>t.getRevealDelay()));function jt(t,K){if(function(t){if(!Bt(t))return!1;const{state:K}=t.payload.game;return"BonusRound"!==K&&"Resolved"!==K}(t))return{sync:!1,shouldFlush:Ot,additionalDelay:0};if(!Ot(t))return{sync:!1,shouldFlush:vt,additionalDelay:0};const{game:D}=t.payload,a=K();return"Resolved"!==D.state||ft.H2(a)?"BonusRound"===D.state&&void 0!==D.offer||"Resolved"===D.state&&!0===D.hiddenOffer?{sync:!1,shouldFlush:Ot,additionalDelay:0}:{sync:ft.f9(a),shouldFlush:vt,additionalDelay:pt(a)}:{sync:!1,shouldFlush:vt,additionalDelay:0}}function rt(t,K){return t=>{if(!Ot(t))return;const{game:D}=t.payload;K(q.XR({boxes:D.boxes})),"BonusRound"===D.state&&D.offer&&K(Z.AD({canSwap:D.canSwitch,decisionTimeRemaining:D.decisionTimeRemaining,iteration:D.iteration,offer:D.offer})),"BonusRound"===D.state&&K(Z.gf(D.totalBetAmount)),"Resolved"===D.state&&K(Z.bN({winAmount:D.winAmount,bonusRoundWinType:D.bonusRoundWinType,bonusRoundWinAmount:D.bonusRoundWinAmount})),"Resolved"===D.state&&!0===D.hiddenOffer&&K(Z.FH({decisionTimeRemaining:D.decisionTimeRemaining,iteration:D.iteration}))}}var Mt=D(222456);const kt="dond.decisionStats";function tK(t,K){return t=>{if(t.type===kt){const{decisions:D}=t.payload;K(Mt.uA(D))}}}const KK="dond.playerState";function DK(t,K){return t=>{var D;if(t.type===KK&&t.type===KK){const{game:a}=t.payload;void 0!==a&&K((D=a.state,async(t,K)=>{const a=K(),G=j.TJ(a);G!==D&&("Qualifying"===D?(t(E(!1)),M(K,D)):"Unknown"===G&&M(K,D),"BonusRound"!==G&&"Resolved"!==G||"Qualifying"!==D||X.A("DondReturnToQualification"),t(function(t){return{type:"GameLayout/SET_PREVIOUS_GAME_STATE",payload:t}}(G)),t(function(t){return{type:"GameLayout/SET_CURRENT_GAME_STATE",payload:t}}(D)),"BonusRound"===D||"Resolved"===D?("Qualified"===G&&await y.u(r),t(l(!0))):t(l(!1)))}))}}}var aK=D(556972);const GK="dond.playerState";function NK(t,K){return t=>{var D;if(!function(t){var K,D,a;if(t.type!==GK)return!1;const G=null==t?void 0:t.payload;return"Qualifying"===(null===(K=null==G?void 0:G.game)||void 0===K?void 0:K.state)||"Qualified"===(null===(D=null==G?void 0:G.game)||void 0===D?void 0:D.state)&&void 0!==(null===(a=null==G?void 0:G.game)||void 0===a?void 0:a.spinResult)}(t))return;const{game:a,error:G,replyToId:N,slotStates:W}=t.payload;if(K(Nt.Zw(null!==(D=a.playerGameId)&&void 0!==D?D:"")),void 0!==G)return void K(aK.H4(G));const{spinResult:x,state:b,winAmount:n=0,totalScatterMultiplier:e,qualificationWinType:i="Small",nextQualificationClosesIn:z}=a;K(Nt.Xh("Qualifying"===b)),K(Nt.Tp(null!=z?z:0)),void 0!==N&&void 0!==x&&K(aK.ky({outcome:x.grid,paylinesAndPayouts:x.winLines,qualified:x.qualified,winAmount:n,totalScatterMultiplier:e,qualificationWinType:i,nextSymbols:x.nextSymbols})),K(Nt.pI(W))}}const WK="dond.qualifiedPlayersCount";function xK(t,K){return(t,D)=>{var a;t.type===WK&&t.type===WK&&K((a=t.payload.qualifiedPlayersCount,{type:zt,payload:a}))}}var bK=D(185214);const nK="dond.playerState";function eK(t,K){return t=>{(function(t){var K;if(t.type!==nK)return!1;const D=t.payload;return"string"==typeof(null===(K=null==D?void 0:D.game)||void 0===K?void 0:K.number)})(t)&&K(bK.yO(t.payload.game.number))}}const iK="dond.playerState";function zK(t,K){return t=>{var D;if(!function(t){var K,D;if(t.type!==iK)return!1;const a=t.payload;return"Qualified"===(null===(K=null==a?void 0:a.game)||void 0===K?void 0:K.state)||"Qualifying"===(null===(D=null==a?void 0:a.game)||void 0===D?void 0:D.state)}(t))return;const{game:a,error:G,replyToId:N}=t.payload;K(mt.Zw(null!==(D=a.playerGameId)&&void 0!==D?D:"")),G&&K(lt.H4(G)),"Qualifying"!==a.state?K(lt.$j({...a,replayToSpin:void 0!==N})):K(lt.yS())}}var IK=D(969695),ZK=D(786596),wK=D(536144);const mK="dond.winnersList";function uK(t,K){return t=>{(function(t){const{type:K,payload:D}=t;if(K!==mK)return!1;if("object"!=typeof D||null===D||!("winners"in D))return!1;const a=null==D?void 0:D.winners;return Array.isArray(a)})(t)&&function(t,K){const D=IK.kP({type:IK.Jh.DealNoDeal,winners:t.payload.winners});t.payload.totalWinners>0&&D.push({type:ZK.Q.TotalWin,players:t.payload.totalWinners,totalWin:t.payload.totalAmount}),K(wK.Mx(D))}(t,K)}}class dK{constructor(t){this.messageHandler=t,this.delayedMessages=[]}add(t){this.delayedMessages.push({message:t,receivedTime:Date.now()})}flushIfNeeded(t){[...this.delayedMessages].forEach((({message:K,receivedTime:D})=>{t(K)&&this.handleMessage(K,Date.now()-D)}))}handleIfHasNotAlready(t,K){this.delayedMessages.find((K=>K.message===t))&&this.handleMessage(t,K)}handleMessage(t,K){this.messageHandler(t,K),this.delayedMessages.splice(this.delayedMessages.findIndex((K=>K.message===t)),1)}}function EK(t,K){return({dispatch:D,getState:a})=>{const G=function(t,K,D,a){const G=new dK(a);return async N=>{const{sync:W,shouldFlush:x,additionalDelay:b}=D(N,K);G.flushIfNeeded(x),W?(G.add(N),t.wait(function(t){var K;return null!==(K=t.timestamp)&&void 0!==K?K:0}(N)+b).then((t=>{G.handleIfHasNotAlready(N,t)})).catch((()=>{}))):a(N,0)}}(K,a,jt,(N=[NK(0,D),xK(0,D),uK(0,D),DK(0,D),zK(0,D),St(0,D),rt(0,D),tK(0,D),eK(0,D)],(t,K)=>{for(const D of N)D(t,K)}));var N;return t.incomingMessages.onValue((t=>G(t))),t=>K=>t(K)}}var lK=D(881357);const QK=({children:t})=>a.jsx(a.Fragment,{children:t});var PK=D(4961),yK=D(212429),qK=D(73816),XK=D(779204),hK=D(484802),JK=D(926610),TK=D(394532),_K=D(977804),CK=D(892510),HK=D(747992),oK=D(706809),UK=D(735821),VK=D(444792),sK=D(767359);function FK(t,K,D){const a=sK._9(cK(D,t));if(!a)return null;try{(function(t,K){if(!oK.A(t))throw new yK.ew("Autoplay state is not an object.");const{lastActiveSession:D,selectedRounds:a,isRunning:G}=t;if(D!==K)throw new yK.ew("Autoplay state contains stale data from a non-current session.");if(!UK.A(a))throw new yK.ew("Autoplay state contains invalid selectedRounds.");if(!VK.A(G))throw new yK.ew("Autoplay state contains invalid isRunning.")})(a,K);const{lastActiveSession:t,...D}=a;return D}catch(t){return 1&&window.console.warn(`Unable to load existing Autoplay state from session storage: ${t}`),null}}function cK(t,K){return`${t}-${K}`}function gK(){window.EVO_LOADER.sendLog("CLIENT_ERROR",{message:"Autoplay is unable to use session storage."})}const RK="SlotsAutoplayState";class AK{constructor(t,K){this.ag=t,this.options=K,this.isRunning=new hK.L(!1),this.isStartable=new hK.L(!1),this.isAvailable=new hK.L(!1),this.roundsLeft=new hK.L(0),this.selectedRounds=new hK.L(0),this.lossLimit=new hK.L(0),this.singleWin=new hK.L(0),this.totalBetToRepeat=new hK.L(0),this.limitsEnabled=new hK.L(!1),this.repeatCount=0,this.runningLoss=0,this.lastWin=0,this.pendingStopReason=null,this.unsubscribers={common:[],running:[],lossLimit:[]},this.start=()=>{if(!this.isStartable.value||this.isRunning.value)return;this.roundsLeft.value=this.selectedRounds.value,this.isRunning.value=!0,this.unsubscribers.running.push(this.ag.network.status.subscribe(this.trackNetworkStatus),this.ag.lifecycle.current.subscribe(this.trackLifecycle,!1),this.ag.compliance.realityCheck.status.subscribe(this.trackRealityCheck,!1)),this.limitsEnabled.value&&this.unsubscribers.running.push(this.ag.gameResult.amount.subscribe(this.trackLastWin,!1));const t=this.limitsEnabled.value?{lossLimit:this.lossLimit.value,singleWin:this.singleWin.value}:{};this.log({type:HK.Gn.ClientStartAutoplay,payload:{selectedRounds:this.selectedRounds.value,totalBet:this.totalBetToRepeat.value,...t}}),this.repeatBets()},this.stop=(t,K=!1)=>{if(!this.isRunning.value)return;if(K&&!YK(this.ag.lifecycle.current.value))return void(this.pendingStopReason=t);const D=this.repeatCount;this.unsubscribe(this.unsubscribers.running),this.isRunning.value=!1,this.roundsLeft.value=0,this.repeatCount=0,this.runningLoss=0,this.lastWin=0,this.pendingStopReason=null,this.log({type:HK.Gn.ClientStoppedAutoplay,payload:{reason:t,roundsPlayed:D}}),this.ag.autoplayUI.setStopReason(t)},this.dispose=()=>{Object.keys(this.unsubscribers).forEach((t=>this.unsubscribe(this.unsubscribers[t]))),this.stop(TK.G_.ManualStop),this.isStartable.value=!1},this.setSelectedRounds=t=>{const K=this.selectedRounds.value,D=Math.max(0,t);K!==D&&(this.selectedRounds.value=D,this.isRunning.value&&(this.roundsLeft.value=D),this.log({type:HK.Gn.ClientUpdateAutoplayRounds,payload:{previousSelectedRounds:K,selectedRounds:D}}))},this.setLossLimit=t=>{const K=this.lossLimit.value,D=Math.max(0,t);0!==D&&K!==D&&(this.unsubscribe(this.unsubscribers.lossLimit),this.lossLimit.value=D,this.log({type:HK.Gn.ClientUpdateAutoplayLossLimit,payload:{previousLossLimit:K,lossLimit:D}}))},this.setSingleWin=t=>{const K=this.singleWin.value,D=Math.max(0,t);K!==D&&(this.singleWin.value=D,this.log({type:HK.Gn.ClientUpdateAutoplaySingleWin,payload:{previousSingleWin:K,singleWin:D}}))},this.placeBets=()=>{this.repeatBets()},this.triggerBetsChanged=()=>{},this.trackLifecycle=t=>{if(YK(t)){if(this.pendingStopReason)return void this.stop(this.pendingStopReason);this.repeatBets()}},this.repeatBets=(t=!1)=>{var K,D,a;if(this.ag.balance.totalBet.value<=0||this.ag.balance.totalBetToRepeat.value<=0)return void console.error("SlotsAutoplay works based on the agreement that the game always has the total bet and the total bet to repeat > 0.",`Total bet: ${this.ag.balance.totalBet.value}.`,`Total bet to repeat: ${this.ag.balance.totalBetToRepeat.value}.`);if(!this.isRunning.value||!YK(this.ag.lifecycle.current.value))return;const G=null!==(K=this.ag.balance.server.value)&&void 0!==K?K:0,N=LK(this.ag.balance.activeId.value);if(!N&&this.totalBetToRepeat.value>G||N&&0===G)return void this.stop(TK.G_.NoBalance);const W=this.ag.popups.current.value,x=!!W&&W.id!==_K.QD.LOW_BALANCE,b=_K.Ns.includes(null==W?void 0:W.id)&&(null==W?void 0:W.isVisible);if(!x||x&&t&&b){if(!(this.selectedRounds.value<=0)){if(this.limitsEnabled.value&&this.repeatCount>0){if(this.runningLoss+this.totalBetToRepeat.value>this.lossLimit.value)return void this.stop(TK.G_.LossReached);if(0!==this.singleWin.value&&this.lastWin>=this.singleWin.value)return void this.stop(TK.G_.WinReached);this.lastWin=0}return this.roundsLeft.value--,this.repeatCount++,this.limitsEnabled.value&&(this.runningLoss+=this.ag.balance.totalBetToRepeat.value),this.options.repeatBets(),this.log({type:HK.Gn.ClientBetChip,payload:{type:"AutoPlay",roundsLeft:this.roundsLeft.value,...null===(a=(D=this.options).selectBetChipLogFields)||void 0===a?void 0:a.call(D)}},this.options.betChipLogEnhancers),this.roundsLeft.value<=0?this.stop(TK.G_.RoundsEnded,!0):void 0}this.stop(TK.G_.RoundsEnded)}else b||this.unsubscribers.common.push(this.ag.popups.current.subscribe(this.continueAutoplayAfterClosingPopup))},this.continueAutoplayAfterClosingPopup=t=>{t||this.repeatBets()},this.updateIsAvailable=({balance:t=0,balanceId:K,totalBetToRepeat:D})=>{LK(K)?this.isAvailable.value=t>0:this.isAvailable.value=t>0&&t>=D},this.updateIsStartable=({isAvailable:t,selectedRounds:K})=>{this.isStartable.value=t&&K>0},this.updateTotalBetToRepeat=({totalBetToRepeat:t})=>{const K=this.totalBetToRepeat.value;this.isRunning.value&&K!==t&&(console.warn(`A single spin bet changed during Autoplay run (${K} -> ${t}).`,"Autoplay forcibly stopped."),this.stop(TK.G_.ManualBetsReplaced)),this.totalBetToRepeat.value=t},this.updateLossLimit=({totalBetToRepeat:t,selectedRounds:K})=>{const D=this.lossLimit.value,a=K*t;D!==a&&(this.lossLimit.value=a,this.log({type:HK.Gn.ClientUpdateAutoplayLossLimit,payload:{previousLossLimit:D,lossLimit:a}}))},this.trackLastWin=t=>{t>0&&this.repeatCount>0&&(this.lastWin=t,this.runningLoss-=t)},this.trackNetworkStatus=t=>{[JK.XW.Reconnecting,JK.XW.Disconnected].includes(t)&&this.stop(TK.G_.Disconnected)},this.trackRealityCheck=t=>{switch(t){case PK.LK.Stopped:this.stop(TK.G_.ManualStop);break;case PK.LK.Inactive:this.repeatBets(!0)}},this.saveState=()=>{var t,K,D;t={isRunning:this.isRunning.value,selectedRounds:this.selectedRounds.value,lastActiveSession:this.ag.settings.bareSessionId()},K=this.ag.tableId,D=RK,sK.J2(cK(D,K),t,gK)},this.restoreState=()=>{let t=FK(this.ag.tableId,this.ag.settings.bareSessionId(),RK);if(t||(t=FK(this.ag.tableId,this.ag.settings.sessionId(),RK),t&&yK.vV(new yK.bE("Deprecated sessionId still in use","Deprecation"))),!t)return;const{selectedRounds:K,isRunning:D}=t;this.selectedRounds.value=K,this.isRunning.value=D},this.unsubscribe=t=>{t.forEach((t=>t())),t.length=0},this.log=(t,K=[])=>{this.ag.log(HK.CM(t,K))},this.restoreState(),this.limitsEnabled.value=t.settings.isUKGC(),this.isRunning.value&&this.stop(TK.G_.PageRefreshed),this.unsubscribers.common.push(lK.vT({balance:t.balance.server,balanceId:t.balance.activeId,totalBetToRepeat:this.totalBetToRepeat}).subscribe(this.updateIsAvailable),lK.vT({isAvailable:this.isAvailable,selectedRounds:this.selectedRounds}).subscribe(this.updateIsStartable),lK.vT({totalBetToRepeat:t.balance.totalBetToRepeat}).subscribe(this.updateTotalBetToRepeat),lK.vT({isRunning:this.isRunning,selectedRounds:this.selectedRounds}).subscribe(this.saveState)),this.limitsEnabled.value&&this.unsubscribers.lossLimit.push(lK.vT({totalBetToRepeat:this.totalBetToRepeat,selectedRounds:this.selectedRounds}).subscribe(this.updateLossLimit))}}function YK(t){return t===CK.P.BetsOpen||t===CK.P.InteractionOpen}function LK(t){const K=qK.Z2(t);return K===XK.D.FreeRounds||K===XK.D.SpinGifts}var SK=D(320693);var fK=D(399158),$K=D(79697),BK=D(791839),OK=D(443505);const vK=qt.Mz(ht.DB,_t.K,_t.F,$K.Y,BK.d,BK.K,OK.B,((t,K,D,a,G,N,W)=>{const x=K&&!D;return{min:a.min,max:Math.min(W.max,Math.max(a.max,K?N.max:0,x?G.max:0)+t.qualificationTopUpMaxBet())}})),pK={text:"",color:"gold",theme:D(215672).H.MobileTransparentLight};function jK(t){return t.DeviceSupport.IS_DESKTOP?{[gt.LayoutType.ImmersiveV2]:{videoStream:Pt.z.Standard,labelTranslationId:void 0}}:{[gt.LayoutType.PhoneV2]:{videoStream:Pt.z.Standard,disabledPhoneOrientation:st.t.Landscape}}}function rK(t,K,D={},a){x.W._init(t.setup,t.styles,t.tableConfig,K);const G=K.IS_DESKTOP;var b;const n=(m={config:{layout:{initialLayout:(b=x.W,b.DeviceSupport.IS_DESKTOP?gt.LayoutType.ImmersiveV2:gt.LayoutType.PhoneV2),layouts:jK(x.W),hasHelpSupportChatButton:!0,layoutClassicIsHidden:!0,useCustomizableButton:{all:!G},autoplay:{disableControls:"desktop",disableButton:"all",bubblePosition:{phone:{portrait:"TopRight",landscape:"LeftCenter"},tablet:{landscape:"TopRight"}}}},compliance:{enableNetPosition:x.W.getComplianceNetposition()!==ct.d.None},chipstack:{disabledComponents:"all",disableLimitChipAmounts:!0},helpNamespace:"liveslotdealnodeal",showOnboardingHintsOptionInSettings:!0,video:{enabled:!0,isPauseEnabled:!1},soundSettings:{music:{enabled:!0}},chat:{oneLineType:{landscape:N.X.Top,portrait:N.X.Bottom}}},settings:x.W,game:{preferenceConfiguration:{...W.J0(),...At.R(),...D.defaultPreferences},reducers:{...xt,...Q,...dt,...u,...z,...Zt,...wt,...yt},createMiddlewares:({transport:t,videoSync:K})=>[EK(0?0:t,K),it,e,k,Qt,w],realityCheckOptions:{videoSyncDisabled:!0},loader:t,mockBalanceManager:D.mockBalanceManager,thunkExtraArguments:{...bt,...Dt}},lobby:a},d=D.transports,Vt.I({...m,game:{...m.game,mockTransports:d,gameFamily:"live"}})),{store:i,ag:I}=n,Z=vK(i.getState());var m,d;I.globalStyles.setGlobalStyles(Rt.S),I.tableLimits.setMin(Z.min),I.tableLimits.setMax(Z.max),I.statusBar.setProps(pK);const E=function(t){return lK.vT({balance:t.balance.available,betAmounts:t.betAmounts.amounts,betModifier:t.betAmounts.betModifier}).subscribe((({balance:K,betAmounts:D,betModifier:a})=>{K>=Math.min(...D.map((({value:t})=>t)))/a?t.balance.setEnough():t.balance.setLow()}))}(I);(function(t,K){const D={min:K.tableLimits.min.value,max:K.tableLimits.max.value};K.setHelpCustomConfig({...Ht(t),tableLimits:D})})(i.getState(),I);const{AutoplayProvider:l,autoplayDispose:P}=function({ag:t,clientApi:K,store:D}){if(!t.settings.autoplayApiEnabled())return{AutoplayProvider:QK,autoplayDispose:()=>{}};const{AutoplayProvider:a,dispose:G}=function(t,K,D){return SK.PS(AK,t,K,D)}(t,{repeatBets:()=>{D.dispatch(aK.t0)}},K);return{AutoplayProvider:a,autoplayDispose:()=>{G()}}}({ag:I,clientApi:t.clientApi,store:i});return{...n,store:i,AutoplayProvider:l,dispose:()=>(P(),E(),n.dispose())}}async function MK(t,K,D){const{getReactRoot:N,dispose:W,ag:x,AutoplayProvider:b}=rK(t,Ft.DS,void 0,D),n=N(K());await x.preferences.initialization;const e=await c.a.prepare();await async function(){await fK.g()}();const i=G.H(t.getRoot());return i.render(a.jsx(b,{children:a.jsx(n,{})})),await x.video.ready,{root:i,abstractGameDispose:async()=>(await e(),W())}}},259919:(t,K,D)=>{var a,G;D.d(K,{U:()=>a,r:()=>G}),function(t){t["ClientBetChip"]="CLIENT_BET_CHIP",t["ClientBetRejected"]="CLIENT_BET_REJECTED",t["ClientPopupDecisionMade"]="CLIENT_DOND_DECISION_MADE",t["ClientPressedTurboButton"]="CLIENT_DOND_PRESSED_TURBO_BUTTON",t["ClientPressedSpinStopButton"]="CLIENT_DOND_PRESSED_SPIN_STOP",t["ClientOpenedXXXtremeSpins"]="CLIENT_DOND_XXX_SPINS_OPEN",t["ClientToggledXXXtremeSpins"]="CLIENT_DOND_XXX_SPINS",t["ClientFinalMultipliers"]="CLIENT_DOND_FINAL_MULTIPLIERS",t["ClientPressedBetSelector"]="CLIENT_DOND_PRESSED_BETSELECTOR",t["ClientPressedInfoScreen"]="CLIENT_DOND_PRESSED_INFO_SCREEN"}(a||(a={})),function(t){t["QualificationClickSpin"]="dond.spinRequest",t["QualificationAutoPlaySpin"]="AutoPlay",t["QualificationHotkeySpin"]="dond.spinRequest.shortcut",t["QualificationClickTurboSpin"]="dond.spinRequest.turbo",t["QualificationAutoPlayTurboSpin"]="AutoPlay.turbo",t["QualificationHotkeyTurboSpin"]="dond.spinRequest.shortcut.turbo",t["TopUpClickSpin"]="dond.topUpRequest",t["TopUpAutoPlaySpin"]="TopUpAutoPlay",t["TopUpHotkeySpin"]="dond.topUpRequest.shortcut",t["TopUpClickTurboSpin"]="dond.topUpRequest.turbo",t["TopUpAutoPlayTurboSpin"]="TopUpAutoPlay.turbo",t["TopUpHotkeyTurboSpin"]="dond.topUpRequest.shortcut.turbo"}(G||(G={}))},784596:(t,K,D)=>{function a({gameState:t,amount:K,spinMode:D}){if("Qualifying"!==t&&"Qualified"!==t)return{};const a="SuperXXXtreme"===D?"FeatureBuy":`${D}Spin`;return{["Qualifying"===t?a:"TopUpSpin"]:K}}D.d(K,{O:()=>a})},283503:(t,K,D)=>{D.d(K,{P:()=>G});var a=D(259919);function G({gamePhase:t,trigger:K,isTurbo:D}){return a.r[`${t}${K}${D?"Turbo":""}Spin`]}},241665:(t,K,D)=>{D.d(K,{AD:()=>I,Mk:()=>w,VT:()=>m,Vu:()=>n,W4:()=>z,Z6:()=>e,gJ:()=>i,kR:()=>Z,p7:()=>b,pX:()=>u});var a=D(838998),G=D(259919);const N=["currency"],W=["balance"],x=[...W,...N,"tableLimits"];function b(t){return{payload:t,type:G.U.ClientPressedTurboButton}}function n(t){return{payload:t,type:G.U.ClientPressedSpinStopButton,enhancers:[...W,...N]}}function e(){return{type:G.U.ClientOpenedXXXtremeSpins,enhancers:N}}function i(t){return{payload:t,type:G.U.ClientToggledXXXtremeSpins,enhancers:N}}function z(t){return{payload:t,type:G.U.ClientPressedBetSelector,enhancers:N}}function I(t){return{payload:t,type:G.U.ClientFinalMultipliers,enhancers:N}}function Z(t){return{payload:{decisionType:t,popupId:a.uH},type:G.U.ClientPopupDecisionMade}}function w(t){return{payload:t,type:G.U.ClientPressedInfoScreen,enhancers:N}}function m(t){return{payload:t,type:G.U.ClientBetRejected,enhancers:x}}function u(t){return{payload:t,type:G.U.ClientBetChip,enhancers:N}}},853964:(t,K,D)=>{D.d(K,{a:()=>It});var a=D(238733),G=(D(123036),D(837557)),N=D(163095),W=D(276111),x=D(234341),b=D(769413),n=D(315049),e=D(465082);class i extends a.kxk{constructor(t){const{texture:K,from:D}=t;super({texture:K,position:D,alpha:0}),this.params=t,this.disposeAnimation=()=>{},this.rotation=this.calcAngle(),this.anchor.set(.5)}startAnimation(){const{from:t,to:K,animationTimeSec:D}=this.params;void 0!==this.animation&&(this.animation.fastForward(),this.animation.reset()),this.animation=x.M().sequence(b.M(this).callback((()=>{this.position=t,this.alpha=.5})).animateTo({x:this.getPartOfVector(.8).x,y:this.getPartOfVector(.8).y},.8*D,W.AU).animateTo({x:K.x,y:K.y,alpha:0},.2*D,W.sn)),this.disposeAnimation=N.A(n.l({anim:this.animation,repeat:0,ticker:e._,dispose:!0}))}stopAnimation(){var t;null===(t=this.animation)||void 0===t||t.fastForward(),this.disposeAnimation()}calcAngle(){const{from:t,to:K}=this.params;return Math.atan2(K.y-t.y,K.x-t.x)}getPartOfVector(t){const{from:K,to:D}=this.params;return{x:K.x+(D.x-K.x)*t,y:K.y+(D.y-K.y)*t}}}const z=D.p+"images/goldentext.e4a4762a.webp",I=URL.createObjectURL(new Blob([`<?xml version="1.0" encoding="UTF-8"?>\n<font>\n    <info face="GoldenText" size="100" bold="0" italic="0" charset="" unicode="1" stretchH="100" smooth="1" aa="1" padding="1,1,1,1" spacing="1,1"/>\n    <common lineHeight="100" base="100" scaleW="1024" scaleH="1024" pages="1" packed="0"/>\n    <pages>\n        <page id="0" file="${z}"/>\n    </pages>\n    <chars count="79">\n        <char id="35" x="1" y="1" width="219" height="258" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="65020" x="222" y="1" width="122" height="143" xoffset="0" yoffset="0" xadvance="100" page="0" chnl="0"/>\n        <char id="3647" x="1" y="261" width="85" height="133" xoffset="0" yoffset="-10" xadvance="85" page="0" chnl="0"/>\n        <char id="87" x="88" y="261" width="129" height="106" xoffset="0" yoffset="0" xadvance="130" page="0" chnl="0"/>\n        <char id="35" x="219" y="261" width="111" height="128" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="8353" x="346" y="1" width="93" height="127" xoffset="0" yoffset="-10" xadvance="85" page="0" chnl="0"/>\n        <char id="8361" x="222" y="146" width="127" height="107" xoffset="0" yoffset="0" xadvance="130" page="0" chnl="0"/>\n        <char id="36" x="351" y="130" width="86" height="125" xoffset="0" yoffset="-10" xadvance="85" page="0" chnl="0"/>\n        <char id="402" x="332" y="257" width="96" height="125" xoffset="0" yoffset="-10" xadvance="85" page="0" chnl="0"/>\n        <char id="81" x="1" y="396" width="95" height="124" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="8363" x="98" y="391" width="83" height="120" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="109" x="183" y="391" width="113" height="90" xoffset="0" yoffset="15" xadvance="115" page="0" chnl="0"/>\n        <char id="269" x="298" y="391" width="78" height="111" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="8372" x="441" y="1" width="84" height="110" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="8360" x="439" y="130" width="85" height="109" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="8362" x="439" y="241" width="84" height="108" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="8377" x="430" y="351" width="74" height="108" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="48" x="1" y="522" width="89" height="108" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="54" x="92" y="522" width="87" height="108" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="56" x="181" y="513" width="91" height="108" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="57" x="274" y="504" width="87" height="108" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="79" x="363" y="504" width="94" height="108" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="83" x="527" y="1" width="90" height="107" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="67" x="527" y="110" width="86" height="107" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="85" x="506" y="351" width="93" height="107" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="163" x="525" y="241" width="84" height="107" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="74" x="506" y="460" width="69" height="107" xoffset="0" yoffset="0" xadvance="65" page="0" chnl="0"/>\n        <char id="8369" x="619" y="1" width="94" height="107" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="8364" x="615" y="110" width="93" height="107" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="71" x="611" y="219" width="92" height="107" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="162" x="611" y="328" width="78" height="107" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="8365" x="601" y="437" width="97" height="107" xoffset="0" yoffset="0" xadvance="115" page="0" chnl="0"/>\n        <char id="8366" x="1" y="632" width="88" height="107" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="322" x="91" y="632" width="63" height="107" xoffset="0" yoffset="0" xadvance="75" page="0" chnl="0"/>\n        <char id="51" x="156" y="632" width="86" height="107" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="53" x="244" y="623" width="86" height="107" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="103" x="332" y="614" width="83" height="107" xoffset="0" yoffset="15" xadvance="75" page="0" chnl="0"/>\n        <char id="8371" x="417" y="614" width="93" height="107" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="393" x="577" y="546" width="95" height="107" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="77" x="715" y="1" width="107" height="106" xoffset="0" yoffset="0" xadvance="100" page="0" chnl="0"/>\n        <char id="579" x="691" y="328" width="97" height="107" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="65" x="705" y="219" width="103" height="106" xoffset="0" yoffset="0" xadvance="100" page="0" chnl="0"/>\n        <char id="82" x="710" y="110" width="92" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="90" x="700" y="437" width="87" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="66" x="700" y="545" width="92" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="84" x="1" y="741" width="90" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="72" x="93" y="741" width="91" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="69" x="186" y="741" width="85" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="73" x="273" y="732" width="66" height="106" xoffset="0" yoffset="0" xadvance="60" page="0" chnl="0"/>\n        <char id="80" x="341" y="723" width="92" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="89" x="435" y="723" width="100" height="106" xoffset="0" yoffset="0" xadvance="100" page="0" chnl="0"/>\n        <char id="165" x="674" y="653" width="100" height="106" xoffset="0" yoffset="0" xadvance="100" page="0" chnl="0"/>\n        <char id="86" x="537" y="655" width="102" height="106" xoffset="0" yoffset="0" xadvance="100" page="0" chnl="0"/>\n        <char id="68" x="789" y="437" width="91" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="75" x="824" y="1" width="91" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="107" x="804" y="109" width="84" height="106" xoffset="0" yoffset="0" xadvance="75" page="0" chnl="0"/>\n        <char id="70" x="790" y="327" width="85" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="47" x="810" y="217" width="77" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="78" x="794" y="545" width="91" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="8378" x="776" y="653" width="76" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="88" x="1" y="849" width="97" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="50" x="100" y="849" width="84" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="49" x="186" y="849" width="64" height="106" xoffset="0" yoffset="0" xadvance="70" page="0" chnl="0"/>\n        <char id="76" x="252" y="849" width="84" height="106" xoffset="0" yoffset="0" xadvance="75" page="0" chnl="0"/>\n        <char id="52" x="338" y="840" width="92" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="956" x="432" y="831" width="84" height="106" xoffset="0" yoffset="15" xadvance="85" page="0" chnl="0"/>\n        <char id="926" x="518" y="831" width="82" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="321" x="602" y="763" width="91" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="55" x="695" y="761" width="84" height="106" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="8381" x="781" y="761" width="74" height="99" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n        <char id="101" x="781" y="862" width="82" height="91" xoffset="0" yoffset="15" xadvance="75" page="0" chnl="0"/>\n        <char id="97" x="917" y="1" width="83" height="91" xoffset="0" yoffset="15" xadvance="75" page="0" chnl="0"/>\n        <char id="1083" x="854" y="653" width="88" height="90" xoffset="0" yoffset="15" xadvance="85" page="0" chnl="0"/>\n        <char id="114" x="917" y="94" width="69" height="90" xoffset="0" yoffset="15" xadvance="65" page="0" chnl="0"/>\n        <char id="1074" x="877" y="325" width="83" height="89" xoffset="0" yoffset="15" xadvance="85" page="0" chnl="0"/>\n        <char id="122" x="889" y="217" width="79" height="89" xoffset="0" yoffset="15" xadvance="85" page="0" chnl="0"/>\n        <char id="44" x="378" y="384" width="48" height="61" xoffset="0" yoffset="60" xadvance="45" page="0" chnl="0"/>\n        <char id="46" x="378" y="447" width="48" height="51" xoffset="0" yoffset="55" xadvance="45" page="0" chnl="0"/>\n        <char id="8297" x="1" y="1" width="0" height="0" xoffset="0" yoffset="0" xadvance="0" page="0" chnl="0"/>\n        <char id="8294" x="1" y="1" width="0" height="0" xoffset="0" yoffset="0" xadvance="0" page="0" chnl="0"/>\n        <char id="32" x="1" y="1" width="0" height="0" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n    </chars>\n    <kernings count="0">\n    </kernings>\n</font>\n`])),Z=URL.createObjectURL(new Blob([`<?xml version="1.0" encoding="UTF-8"?>\n<font>\n    <info face="GoldenTextBack" size="100" bold="0" italic="0" charset="" unicode="1" stretchH="100" smooth="1" aa="1" padding="1,1,1,1" spacing="1,1"/>\n    <common lineHeight="100" base="100" scaleW="1024" scaleH="1024" pages="1" packed="0"/>\n    <pages>\n        <page id="0" file="${z}"/>\n    </pages>\n    <chars count="79">\n        <char id="35" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="65020" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="100" page="0" chnl="0"/>\n        <char id="3647" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="87" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="130" page="0" chnl="0"/>\n        <char id="35" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="8353" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="8361" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="130" page="0" chnl="0"/>\n        <char id="36" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="402" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="81" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="8363" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="109" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="115" page="0" chnl="0"/>\n        <char id="269" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="8372" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="8360" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="8362" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="8377" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="48" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="54" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="56" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="57" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="79" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="83" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="67" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="85" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="163" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="74" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="65" page="0" chnl="0"/>\n        <char id="8369" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="8364" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="71" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="162" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="8365" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="115" page="0" chnl="0"/>\n        <char id="8366" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="322" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="75" page="0" chnl="0"/>\n        <char id="51" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="53" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="103" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="75" page="0" chnl="0"/>\n        <char id="8371" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="393" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="77" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="100" page="0" chnl="0"/>\n        <char id="579" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="65" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="100" page="0" chnl="0"/>\n        <char id="82" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="90" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="66" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="84" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="72" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="69" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="73" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="60" page="0" chnl="0"/>\n        <char id="80" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="89" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="100" page="0" chnl="0"/>\n        <char id="165" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="100" page="0" chnl="0"/>\n        <char id="86" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="100" page="0" chnl="0"/>\n        <char id="68" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="75" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="107" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="75" page="0" chnl="0"/>\n        <char id="70" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="47" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="78" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="8378" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="88" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="50" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="49" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="70" page="0" chnl="0"/>\n        <char id="76" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="75" page="0" chnl="0"/>\n        <char id="52" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="956" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="926" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="321" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="55" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="8381" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="101" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="75" page="0" chnl="0"/>\n        <char id="97" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="75" page="0" chnl="0"/>\n        <char id="1083" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="114" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="65" page="0" chnl="0"/>\n        <char id="1074" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="122" x="1" y="1" width="219" height="258" xoffset="-65" yoffset="-76" xadvance="85" page="0" chnl="0"/>\n        <char id="44" x="219" y="261" width="111" height="128" xoffset="-27" yoffset="20" xadvance="45" page="0" chnl="0"/>\n        <char id="46" x="219" y="261" width="111" height="128" xoffset="-27" yoffset="20" xadvance="45" page="0" chnl="0"/>\n        <char id="8297" x="1" y="1" width="0" height="0" xoffset="0" yoffset="0" xadvance="0" page="0" chnl="0"/>\n        <char id="8294" x="1" y="1" width="0" height="0" xoffset="0" yoffset="0" xadvance="0" page="0" chnl="0"/>\n        <char id="32" x="1" y="1" width="0" height="0" xoffset="0" yoffset="0" xadvance="85" page="0" chnl="0"/>\n    </chars>\n    <kernings count="0">\n    </kernings>\n</font>\n`])),w=D.p+"images/scattermul.eb4ed128.webp",m=URL.createObjectURL(new Blob([`<?xml version="1.0" encoding="UTF-8"?><font><info face="scatterMultiplierFont" size="108" bold="0" italic="0" charset="" unicode="1" stretchH="100" smooth="1" aa="1" padding="1,1,1,1" spacing="1,1"/><common lineHeight="118" base="88" scaleW="392" scaleH="446" pages="1" packed="0"/><pages><page id="0" file="${w}"/></pages><chars count="12"><char id="32" x="0" y="0" width="0" height="0" xoffset="0" yoffset="0" xadvance="31" page="0" chnl="15"/>\x3c!--   --\x3e<char id="48" x="0" y="0" width="133" height="111" xoffset="-1" yoffset="-1" xadvance="131" page="0" chnl="15"/>\x3c!-- 0 --\x3e<char id="49" x="263" y="224" width="91" height="111" xoffset="-1" yoffset="-1" xadvance="89" page="0" chnl="15"/>\x3c!-- 1 --\x3e<char id="50" x="0" y="336" width="126" height="110" xoffset="-1" yoffset="-1" xadvance="124" page="0" chnl="15"/>\x3c!-- 2 --\x3e<char id="51" x="0" y="224" width="129" height="111" xoffset="-1" yoffset="-1" xadvance="127" page="0" chnl="15"/>\x3c!-- 3 --\x3e<char id="52" x="0" y="112" width="133" height="111" xoffset="-1" yoffset="-1" xadvance="131" page="0" chnl="15"/>\x3c!-- 4 --\x3e<char id="53" x="134" y="0" width="129" height="111" xoffset="-1" yoffset="-1" xadvance="127" page="0" chnl="15"/>\x3c!-- 5 --\x3e<char id="54" x="263" y="112" width="127" height="111" xoffset="-1" yoffset="-1" xadvance="125" page="0" chnl="15"/>\x3c!-- 6 --\x3e<char id="55" x="134" y="225" width="128" height="111" xoffset="-1" yoffset="-1" xadvance="126" page="0" chnl="15"/>\x3c!-- 7 --\x3e<char id="56" x="134" y="112" width="128" height="112" xoffset="-1" yoffset="-1" xadvance="126" page="0" chnl="15"/>\x3c!-- 8 --\x3e<char id="57" x="264" y="0" width="128" height="111" xoffset="-1" yoffset="-1" xadvance="126" page="0" chnl="15"/>\x3c!-- 9 --\x3e<char id="120" x="134" y="337" width="113" height="83" xoffset="-1" yoffset="27" xadvance="111" page="0" chnl="15"/>\x3c!-- x --\x3e</chars></font>`]));class u extends a.mcf{constructor(t){super(),this.animatedSprite=this.addChild(new a.Dl5(t)),this.animatedSprite.anchor.set(.5),this.animatedSprite.animationSpeed=.2,this.animatedSprite.play()}play(){this.animatedSprite.play()}stop(){this.animatedSprite.stop()}}const d=JSON.parse('{"frames":{"bar__00007.png":{"frame":{"x":0,"y":0,"w":386,"h":160},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":114,"w":386,"h":160},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00008.png":{"frame":{"x":386,"y":0,"w":386,"h":160},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":114,"w":386,"h":160},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00009.png":{"frame":{"x":772,"y":0,"w":386,"h":160},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":114,"w":386,"h":160},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00010.png":{"frame":{"x":1158,"y":0,"w":386,"h":160},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":114,"w":386,"h":160},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00011.png":{"frame":{"x":1544,"y":0,"w":386,"h":160},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":114,"w":386,"h":160},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00003.png":{"frame":{"x":0,"y":160,"w":386,"h":159},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":114,"w":386,"h":159},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00004.png":{"frame":{"x":386,"y":160,"w":386,"h":159},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":114,"w":386,"h":159},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00005.png":{"frame":{"x":772,"y":160,"w":386,"h":159},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":114,"w":386,"h":159},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00006.png":{"frame":{"x":1158,"y":160,"w":386,"h":159},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":114,"w":386,"h":159},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00012.png":{"frame":{"x":1544,"y":160,"w":386,"h":159},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":114,"w":386,"h":159},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00013.png":{"frame":{"x":0,"y":319,"w":386,"h":159},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":114,"w":386,"h":159},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00014.png":{"frame":{"x":386,"y":319,"w":386,"h":159},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":114,"w":386,"h":159},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00015.png":{"frame":{"x":772,"y":319,"w":386,"h":159},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":114,"w":386,"h":159},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00002.png":{"frame":{"x":1158,"y":319,"w":357,"h":143},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":16,"y":122,"w":357,"h":143},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00016.png":{"frame":{"x":1515,"y":319,"w":333,"h":134},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":28,"y":127,"w":333,"h":134},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00001.png":{"frame":{"x":1515,"y":453,"w":318,"h":122},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":36,"y":133,"w":318,"h":122},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00017.png":{"frame":{"x":1158,"y":462,"w":317,"h":122},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":36,"y":133,"w":317,"h":122},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"bar__00000.png":{"frame":{"x":0,"y":478,"w":313,"h":114},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":38,"y":137,"w":313,"h":114},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":2048,"h":600},"scale":1}}'),E=D.p+"images/barsprites.5c168552.webp",l=JSON.parse('{"frames":{"wild":{"frame":{"x":0.5,"y":0.5,"w":110.5,"h":82.5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":110.5,"h":82.5},"sourceSize":{"w":110.5,"h":82.5},"pivot":{"x":0.5,"y":0.5}},"scatter":{"frame":{"x":0.5,"y":84,"w":110,"h":109.5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":110,"h":109.5},"sourceSize":{"w":110,"h":109.5},"pivot":{"x":0.5,"y":0.5}},"scatter_x1":{"frame":{"x":111.5,"y":84,"w":110,"h":109.5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":110,"h":109.5},"sourceSize":{"w":110,"h":109.5},"pivot":{"x":0.5,"y":0.5}},"scatter_x10":{"frame":{"x":0.5,"y":194.5,"w":110,"h":109.5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":110,"h":109.5},"sourceSize":{"w":110,"h":109.5},"pivot":{"x":0.5,"y":0.5}},"scatter_x2":{"frame":{"x":111.5,"y":194.5,"w":110,"h":109.5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":110,"h":109.5},"sourceSize":{"w":110,"h":109.5},"pivot":{"x":0.5,"y":0.5}},"scatter_x3":{"frame":{"x":222.5,"y":0.5,"w":110,"h":109.5},"rotated":true,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":110,"h":109.5},"sourceSize":{"w":110,"h":109.5},"pivot":{"x":0.5,"y":0.5}},"scatter_x5":{"frame":{"x":222.5,"y":111.5,"w":110,"h":109.5},"rotated":true,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":110,"h":109.5},"sourceSize":{"w":110,"h":109.5},"pivot":{"x":0.5,"y":0.5}},"wild_x2":{"frame":{"x":112,"y":0.5,"w":102.5,"h":82.5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":102.5,"h":82.5},"sourceSize":{"w":102.5,"h":82.5},"pivot":{"x":0.5,"y":0.5}},"wild_x5":{"frame":{"x":0.5,"y":305,"w":102.5,"h":82.5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":102.5,"h":82.5},"sourceSize":{"w":102.5,"h":82.5},"pivot":{"x":0.5,"y":0.5}},"double_bar":{"frame":{"x":222.5,"y":222.5,"w":91.5,"h":60},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":91.5,"h":60},"sourceSize":{"w":91.5,"h":60},"pivot":{"x":0.5,"y":0.5}},"triple_bar":{"frame":{"x":104,"y":305,"w":91.5,"h":71.5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":91.5,"h":71.5},"sourceSize":{"w":91.5,"h":71.5},"pivot":{"x":0.5,"y":0.5}},"bar":{"frame":{"x":222.5,"y":283.5,"w":90,"h":49},"rotated":true,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":90,"h":49},"sourceSize":{"w":90,"h":49},"pivot":{"x":0.5,"y":0.5}},"cherry":{"frame":{"x":333,"y":0.5,"w":73.5,"h":89},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":73.5,"h":89},"sourceSize":{"w":73.5,"h":89},"pivot":{"x":0.5,"y":0.5}},"triple_seven":{"frame":{"x":315,"y":222.5,"w":88.5,"h":78},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":88.5,"h":78},"sourceSize":{"w":88.5,"h":78},"pivot":{"x":0.5,"y":0.5}},"phone":{"frame":{"x":272.5,"y":301.5,"w":80.5,"h":83},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":80.5,"h":83},"sourceSize":{"w":80.5,"h":83},"pivot":{"x":0.5,"y":0.5}},"seven":{"frame":{"x":333,"y":90.5,"w":64.5,"h":81},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64.5,"h":81},"sourceSize":{"w":64.5,"h":81},"pivot":{"x":0.5,"y":0.5}},"double_seven":{"frame":{"x":0.5,"y":388.5,"w":71.5,"h":73.5},"rotated":true,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":71.5,"h":73.5},"sourceSize":{"w":71.5,"h":73.5},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"blurred.png","format":"RGBA8888","size":{"w":512,"h":512},"scale":0.4}}'),Q=D.p+"images/blurred.ef79b4a0.webp",P=JSON.parse('{"frames":{"cherry__00009.png":{"frame":{"x":0,"y":0,"w":321,"h":321},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":44,"y":38,"w":321,"h":321},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00008.png":{"frame":{"x":321,"y":0,"w":318,"h":323},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":30,"y":31,"w":318,"h":323},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00007.png":{"frame":{"x":0,"y":321,"w":317,"h":338},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":7,"y":21,"w":317,"h":338},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00010.png":{"frame":{"x":639,"y":0,"w":318,"h":322},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":32,"y":32,"w":318,"h":322},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00006.png":{"frame":{"x":957,"y":0,"w":317,"h":334},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":15,"y":24,"w":317,"h":334},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00011.png":{"frame":{"x":317,"y":323,"w":318,"h":322},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":41,"y":36,"w":318,"h":322},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00012.png":{"frame":{"x":317,"y":645,"w":318,"h":322},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":32,"w":318,"h":322},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00002.png":{"frame":{"x":0,"y":659,"w":303,"h":308},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":43,"y":37,"w":303,"h":308},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00013.png":{"frame":{"x":635,"y":323,"w":318,"h":322},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":32,"w":318,"h":322},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00014.png":{"frame":{"x":953,"y":334,"w":318,"h":322},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":32,"w":318,"h":322},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00015.png":{"frame":{"x":635,"y":645,"w":318,"h":322},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":32,"w":318,"h":322},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00003.png":{"frame":{"x":1271,"y":334,"w":318,"h":321},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":36,"y":34,"w":318,"h":321},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00004.png":{"frame":{"x":1589,"y":334,"w":318,"h":321},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":36,"y":34,"w":318,"h":321},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00005.png":{"frame":{"x":1274,"y":0,"w":318,"h":321},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":36,"y":34,"w":318,"h":321},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00016.png":{"frame":{"x":1592,"y":0,"w":294,"h":299},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":46,"y":39,"w":294,"h":299},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00001.png":{"frame":{"x":1271,"y":655,"w":262,"h":265},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":64,"y":51,"w":262,"h":265},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00017.png":{"frame":{"x":953,"y":656,"w":252,"h":256},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":67,"y":52,"w":252,"h":256},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"cherry__00000.png":{"frame":{"x":1533,"y":655,"w":238,"h":244},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":76,"y":59,"w":238,"h":244},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":2048,"h":1100},"scale":1}}'),y=D.p+"images/cherryspri.7a96895a.webp",q=JSON.parse('{"frames":{"phone__00000.png":{"frame":{"x":687,"y":1045,"w":297,"h":247},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":47,"y":68,"w":297,"h":247},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00001.png":{"frame":{"x":375,"y":1045,"w":312,"h":260},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":40,"y":62,"w":312,"h":260},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00002.png":{"frame":{"x":1504,"y":329,"w":360,"h":301},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":15,"y":42,"w":360,"h":301},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00003.png":{"frame":{"x":0,"y":0,"w":378,"h":349},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":6,"y":7,"w":378,"h":349},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00004.png":{"frame":{"x":378,"y":0,"w":376,"h":348},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":7,"y":7,"w":376,"h":348},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00005.png":{"frame":{"x":754,"y":0,"w":375,"h":349},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":7,"w":375,"h":349},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00006.png":{"frame":{"x":753,"y":349,"w":376,"h":348},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":7,"y":7,"w":376,"h":348},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00007.png":{"frame":{"x":378,"y":348,"w":375,"h":349},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":7,"w":375,"h":349},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00008.png":{"frame":{"x":375,"y":697,"w":376,"h":348},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":7,"y":7,"w":376,"h":348},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00009.png":{"frame":{"x":0,"y":349,"w":375,"h":349},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":7,"w":375,"h":349},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00010.png":{"frame":{"x":751,"y":697,"w":376,"h":348},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":7,"y":7,"w":376,"h":348},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00011.png":{"frame":{"x":1129,"y":0,"w":375,"h":349},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":7,"w":375,"h":349},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00012.png":{"frame":{"x":1127,"y":698,"w":376,"h":348},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":7,"y":7,"w":376,"h":348},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00013.png":{"frame":{"x":1129,"y":349,"w":375,"h":349},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":7,"w":375,"h":349},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00014.png":{"frame":{"x":1503,"y":698,"w":376,"h":348},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":7,"y":7,"w":376,"h":348},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00015.png":{"frame":{"x":0,"y":698,"w":375,"h":349},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":7,"w":375,"h":349},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00016.png":{"frame":{"x":1504,"y":0,"w":351,"h":329},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":21,"y":14,"w":351,"h":329},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"phone__00017.png":{"frame":{"x":0,"y":1047,"w":301,"h":290},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":38,"y":34,"w":301,"h":290},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":2048,"h":1400},"scale":1}}'),X=D.p+"images/phonesprit.5f62378d.webp",h=JSON.parse('{"frames":{"scatter_x10__00003.png":{"frame":{"x":0,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00004.png":{"frame":{"x":389,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00005.png":{"frame":{"x":778,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00006.png":{"frame":{"x":1167,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00007.png":{"frame":{"x":1556,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00008.png":{"frame":{"x":0,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00009.png":{"frame":{"x":389,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00010.png":{"frame":{"x":778,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00011.png":{"frame":{"x":1167,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00012.png":{"frame":{"x":1556,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00013.png":{"frame":{"x":0,"y":680,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00014.png":{"frame":{"x":389,"y":680,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00015.png":{"frame":{"x":778,"y":680,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00002.png":{"frame":{"x":1167,"y":680,"w":367,"h":318},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":10,"y":34,"w":367,"h":318},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00016.png":{"frame":{"x":1534,"y":680,"w":345,"h":298},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":22,"y":44,"w":345,"h":298},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00000.png":{"frame":{"x":1534,"y":978,"w":337,"h":289},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":25,"y":48,"w":337,"h":289},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00017.png":{"frame":{"x":1167,"y":998,"w":336,"h":289},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":26,"y":48,"w":336,"h":289},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x10__00001.png":{"frame":{"x":0,"y":1020,"w":327,"h":281},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":31,"y":52,"w":327,"h":281},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":2048,"h":1400},"scale":1}}'),J=D.p+"images/scatter10x.2b5958f5.webp",T=JSON.parse('{"frames":{"scatter_x2__00003.png":{"frame":{"x":0,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00004.png":{"frame":{"x":389,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00005.png":{"frame":{"x":778,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00006.png":{"frame":{"x":1167,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00007.png":{"frame":{"x":1556,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00008.png":{"frame":{"x":0,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00009.png":{"frame":{"x":389,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00010.png":{"frame":{"x":778,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00011.png":{"frame":{"x":1167,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00012.png":{"frame":{"x":1556,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00013.png":{"frame":{"x":0,"y":680,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00014.png":{"frame":{"x":389,"y":680,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00015.png":{"frame":{"x":778,"y":680,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00002.png":{"frame":{"x":1167,"y":680,"w":367,"h":318},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":10,"y":34,"w":367,"h":318},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00016.png":{"frame":{"x":1534,"y":680,"w":345,"h":298},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":22,"y":44,"w":345,"h":298},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00000.png":{"frame":{"x":1534,"y":978,"w":337,"h":289},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":25,"y":48,"w":337,"h":289},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00017.png":{"frame":{"x":1167,"y":998,"w":336,"h":289},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":26,"y":48,"w":336,"h":289},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x2__00001.png":{"frame":{"x":0,"y":1020,"w":327,"h":281},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":31,"y":52,"w":327,"h":281},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":2048,"h":1400},"scale":1}}'),_=D.p+"images/scatter2xs.423ec8d7.webp",C=JSON.parse('{"frames":{"scatter_x3__00003.png":{"frame":{"x":0,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00004.png":{"frame":{"x":389,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00005.png":{"frame":{"x":778,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00006.png":{"frame":{"x":1167,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00007.png":{"frame":{"x":1556,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00008.png":{"frame":{"x":0,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00009.png":{"frame":{"x":389,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00010.png":{"frame":{"x":778,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00011.png":{"frame":{"x":1167,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00012.png":{"frame":{"x":1556,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00013.png":{"frame":{"x":0,"y":680,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00014.png":{"frame":{"x":389,"y":680,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00015.png":{"frame":{"x":778,"y":680,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00002.png":{"frame":{"x":1167,"y":680,"w":367,"h":318},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":10,"y":34,"w":367,"h":318},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00016.png":{"frame":{"x":1534,"y":680,"w":345,"h":298},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":22,"y":44,"w":345,"h":298},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00000.png":{"frame":{"x":1534,"y":978,"w":337,"h":289},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":25,"y":48,"w":337,"h":289},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00017.png":{"frame":{"x":1167,"y":998,"w":336,"h":289},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":26,"y":48,"w":336,"h":289},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x3__00001.png":{"frame":{"x":0,"y":1020,"w":327,"h":281},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":31,"y":52,"w":327,"h":281},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":2048,"h":1400},"scale":1}}'),H=D.p+"images/scatter3xs.6a5e6aab.webp",o=JSON.parse('{"frames":{"scatter_x5__00003.png":{"frame":{"x":0,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00004.png":{"frame":{"x":389,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00005.png":{"frame":{"x":778,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00006.png":{"frame":{"x":1167,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00007.png":{"frame":{"x":1556,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00008.png":{"frame":{"x":0,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00009.png":{"frame":{"x":389,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00010.png":{"frame":{"x":778,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00011.png":{"frame":{"x":1167,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00012.png":{"frame":{"x":1556,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00013.png":{"frame":{"x":0,"y":680,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00014.png":{"frame":{"x":389,"y":680,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00015.png":{"frame":{"x":778,"y":680,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00002.png":{"frame":{"x":1167,"y":680,"w":367,"h":318},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":10,"y":34,"w":367,"h":318},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00016.png":{"frame":{"x":1534,"y":680,"w":345,"h":298},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":22,"y":44,"w":345,"h":298},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00000.png":{"frame":{"x":1534,"y":978,"w":337,"h":289},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":25,"y":48,"w":337,"h":289},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00017.png":{"frame":{"x":1167,"y":998,"w":336,"h":289},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":26,"y":48,"w":336,"h":289},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter_x5__00001.png":{"frame":{"x":0,"y":1020,"w":327,"h":281},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":31,"y":52,"w":327,"h":281},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":2048,"h":1400},"scale":1}}'),U=D.p+"images/scatter5xs.2fcbe506.webp",V=JSON.parse('{"frames":{"scatter__00003.png":{"frame":{"x":0,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00004.png":{"frame":{"x":389,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00005.png":{"frame":{"x":778,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00006.png":{"frame":{"x":1167,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00007.png":{"frame":{"x":1556,"y":0,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00008.png":{"frame":{"x":0,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00009.png":{"frame":{"x":389,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00010.png":{"frame":{"x":778,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00011.png":{"frame":{"x":1167,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00012.png":{"frame":{"x":1556,"y":340,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00013.png":{"frame":{"x":0,"y":680,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00014.png":{"frame":{"x":389,"y":680,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00015.png":{"frame":{"x":778,"y":680,"w":389,"h":340},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":23,"w":389,"h":340},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00002.png":{"frame":{"x":1167,"y":680,"w":367,"h":318},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":10,"y":34,"w":367,"h":318},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00016.png":{"frame":{"x":1534,"y":680,"w":345,"h":298},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":22,"y":44,"w":345,"h":298},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00000.png":{"frame":{"x":1534,"y":978,"w":337,"h":289},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":25,"y":48,"w":337,"h":289},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00017.png":{"frame":{"x":1167,"y":998,"w":336,"h":289},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":26,"y":48,"w":336,"h":289},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"scatter__00001.png":{"frame":{"x":0,"y":1020,"w":327,"h":281},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":31,"y":52,"w":327,"h":281},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":2048,"h":1400},"scale":1}}'),s=D.p+"images/scatterspr.8aea2f4a.webp",F=JSON.parse('{"frames":{"seven__00003.png":{"frame":{"x":0,"y":0,"w":318,"h":328},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":33,"w":318,"h":328},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00004.png":{"frame":{"x":318,"y":0,"w":318,"h":328},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":33,"w":318,"h":328},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00005.png":{"frame":{"x":636,"y":0,"w":318,"h":328},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":33,"w":318,"h":328},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00006.png":{"frame":{"x":954,"y":0,"w":318,"h":328},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":33,"w":318,"h":328},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00007.png":{"frame":{"x":1272,"y":0,"w":318,"h":328},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":33,"w":318,"h":328},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00008.png":{"frame":{"x":1590,"y":0,"w":318,"h":328},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":33,"w":318,"h":328},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00009.png":{"frame":{"x":0,"y":328,"w":318,"h":328},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":33,"w":318,"h":328},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00010.png":{"frame":{"x":318,"y":328,"w":318,"h":328},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":33,"w":318,"h":328},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00011.png":{"frame":{"x":636,"y":328,"w":318,"h":328},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":33,"w":318,"h":328},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00012.png":{"frame":{"x":954,"y":328,"w":318,"h":328},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":33,"w":318,"h":328},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00013.png":{"frame":{"x":1272,"y":328,"w":318,"h":328},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":33,"w":318,"h":328},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00014.png":{"frame":{"x":1590,"y":328,"w":318,"h":328},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":33,"w":318,"h":328},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00015.png":{"frame":{"x":0,"y":656,"w":318,"h":328},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":34,"y":33,"w":318,"h":328},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00002.png":{"frame":{"x":318,"y":656,"w":290,"h":300},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":48,"y":47,"w":290,"h":300},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00016.png":{"frame":{"x":608,"y":656,"w":286,"h":296},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":50,"y":49,"w":286,"h":296},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00001.png":{"frame":{"x":894,"y":656,"w":243,"h":252},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":72,"y":71,"w":243,"h":252},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00017.png":{"frame":{"x":1137,"y":656,"w":242,"h":250},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":72,"y":72,"w":242,"h":250},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"seven__00000.png":{"frame":{"x":1379,"y":656,"w":235,"h":242},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":76,"y":76,"w":235,"h":242},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":2048,"h":1000},"scale":1}}'),c=D.p+"images/sevensprit.8d60c6dd.webp",g=JSON.parse('{"frames":{"triple_bar__00005.png":{"frame":{"x":0,"y":0,"w":381,"h":246},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":73,"w":381,"h":246},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00006.png":{"frame":{"x":381,"y":0,"w":381,"h":246},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":73,"w":381,"h":246},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00007.png":{"frame":{"x":762,"y":0,"w":381,"h":246},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":73,"w":381,"h":246},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00008.png":{"frame":{"x":1143,"y":0,"w":381,"h":246},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":73,"w":381,"h":246},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00009.png":{"frame":{"x":1524,"y":0,"w":381,"h":246},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":73,"w":381,"h":246},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00010.png":{"frame":{"x":0,"y":246,"w":381,"h":246},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":73,"w":381,"h":246},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00011.png":{"frame":{"x":381,"y":246,"w":381,"h":246},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":73,"w":381,"h":246},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00012.png":{"frame":{"x":762,"y":246,"w":381,"h":246},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":73,"w":381,"h":246},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00013.png":{"frame":{"x":1143,"y":246,"w":381,"h":246},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":73,"w":381,"h":246},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00004.png":{"frame":{"x":1524,"y":246,"w":381,"h":239},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":80,"w":381,"h":239},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00014.png":{"frame":{"x":1524,"y":485,"w":381,"h":232},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":87,"w":381,"h":232},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00003.png":{"frame":{"x":0,"y":492,"w":381,"h":230},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":89,"w":381,"h":230},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00015.png":{"frame":{"x":381,"y":492,"w":381,"h":227},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":92,"w":381,"h":227},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00002.png":{"frame":{"x":762,"y":492,"w":353,"h":217},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":18,"y":91,"w":353,"h":217},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00016.png":{"frame":{"x":1115,"y":492,"w":328,"h":211},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":31,"y":90,"w":328,"h":211},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00000.png":{"frame":{"x":1115,"y":703,"w":326,"h":210},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":32,"y":90,"w":326,"h":210},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00017.png":{"frame":{"x":762,"y":717,"w":326,"h":209},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":32,"y":90,"w":326,"h":209},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_bar__00001.png":{"frame":{"x":381,"y":719,"w":325,"h":209},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":33,"y":90,"w":325,"h":209},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":2048,"h":1000},"scale":1}}'),R=D.p+"images/triplebars.b061702b.webp",A=JSON.parse('{"frames":{"triple_seven__00005.png":{"frame":{"x":0,"y":0,"w":385,"h":325},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":37,"w":385,"h":325},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00006.png":{"frame":{"x":385,"y":0,"w":385,"h":325},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":37,"w":385,"h":325},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00007.png":{"frame":{"x":770,"y":0,"w":385,"h":325},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":37,"w":385,"h":325},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00008.png":{"frame":{"x":1155,"y":0,"w":385,"h":325},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":37,"w":385,"h":325},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00009.png":{"frame":{"x":1540,"y":0,"w":385,"h":325},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":37,"w":385,"h":325},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00010.png":{"frame":{"x":0,"y":325,"w":385,"h":325},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":37,"w":385,"h":325},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00011.png":{"frame":{"x":385,"y":325,"w":385,"h":325},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":37,"w":385,"h":325},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00012.png":{"frame":{"x":770,"y":325,"w":385,"h":325},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":37,"w":385,"h":325},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00013.png":{"frame":{"x":1155,"y":325,"w":385,"h":325},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":37,"w":385,"h":325},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00004.png":{"frame":{"x":1540,"y":325,"w":375,"h":325},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":13,"y":37,"w":375,"h":325},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00014.png":{"frame":{"x":0,"y":650,"w":373,"h":325},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":14,"y":37,"w":373,"h":325},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00003.png":{"frame":{"x":373,"y":650,"w":359,"h":325},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":20,"y":37,"w":359,"h":325},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00015.png":{"frame":{"x":732,"y":650,"w":357,"h":325},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":20,"y":37,"w":357,"h":325},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00002.png":{"frame":{"x":1089,"y":650,"w":347,"h":303},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":20,"y":48,"w":347,"h":303},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00016.png":{"frame":{"x":1436,"y":650,"w":343,"h":299},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":21,"y":50,"w":343,"h":299},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00001.png":{"frame":{"x":1436,"y":949,"w":340,"h":258},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":24,"y":71,"w":340,"h":258},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00017.png":{"frame":{"x":1089,"y":953,"w":339,"h":256},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":25,"y":72,"w":339,"h":256},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"triple_seven__00000.png":{"frame":{"x":0,"y":975,"w":334,"h":244},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":27,"y":78,"w":334,"h":244},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":2048,"h":1300},"scale":1}}'),Y=D.p+"images/tripleseve.21ffbb0e.webp",L=JSON.parse('{"frames":{"wild_x2__00004.png":{"frame":{"x":0,"y":0,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00005.png":{"frame":{"x":379,"y":0,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00006.png":{"frame":{"x":758,"y":0,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00007.png":{"frame":{"x":1137,"y":0,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00008.png":{"frame":{"x":1516,"y":0,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00009.png":{"frame":{"x":0,"y":259,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00010.png":{"frame":{"x":379,"y":259,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00011.png":{"frame":{"x":758,"y":259,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00012.png":{"frame":{"x":1137,"y":259,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00013.png":{"frame":{"x":1516,"y":259,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00003.png":{"frame":{"x":0,"y":518,"w":371,"h":251},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":9,"y":72,"w":371,"h":251},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00014.png":{"frame":{"x":371,"y":518,"w":368,"h":248},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":10,"y":73,"w":368,"h":248},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00000.png":{"frame":{"x":739,"y":518,"w":350,"h":231},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":19,"y":82,"w":350,"h":231},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00017.png":{"frame":{"x":1089,"y":518,"w":350,"h":231},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":19,"y":82,"w":350,"h":231},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00001.png":{"frame":{"x":1439,"y":518,"w":336,"h":222},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":26,"y":87,"w":336,"h":222},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00002.png":{"frame":{"x":1439,"y":740,"w":324,"h":215},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":32,"y":90,"w":324,"h":215},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00015.png":{"frame":{"x":739,"y":749,"w":318,"h":211},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":35,"y":92,"w":318,"h":211},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x2__00016.png":{"frame":{"x":371,"y":766,"w":300,"h":197},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":43,"y":99,"w":300,"h":197},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":2048,"h":1000},"scale":1}}'),S=D.p+"images/wild2xspri.4af696ca.webp",f=JSON.parse('{"frames":{"wild_x5__00004.png":{"frame":{"x":0,"y":0,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00005.png":{"frame":{"x":379,"y":0,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00006.png":{"frame":{"x":758,"y":0,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00007.png":{"frame":{"x":1137,"y":0,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00008.png":{"frame":{"x":1516,"y":0,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00009.png":{"frame":{"x":0,"y":259,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00010.png":{"frame":{"x":379,"y":259,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00011.png":{"frame":{"x":758,"y":259,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00012.png":{"frame":{"x":1137,"y":259,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00013.png":{"frame":{"x":1516,"y":259,"w":379,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":68,"w":379,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00003.png":{"frame":{"x":0,"y":518,"w":371,"h":251},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":9,"y":72,"w":371,"h":251},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00014.png":{"frame":{"x":371,"y":518,"w":368,"h":248},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":10,"y":73,"w":368,"h":248},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00000.png":{"frame":{"x":739,"y":518,"w":350,"h":231},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":19,"y":82,"w":350,"h":231},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00017.png":{"frame":{"x":1089,"y":518,"w":350,"h":231},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":19,"y":82,"w":350,"h":231},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00001.png":{"frame":{"x":1439,"y":518,"w":336,"h":222},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":26,"y":87,"w":336,"h":222},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00002.png":{"frame":{"x":1439,"y":740,"w":324,"h":215},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":32,"y":90,"w":324,"h":215},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00015.png":{"frame":{"x":739,"y":749,"w":318,"h":211},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":35,"y":92,"w":318,"h":211},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild_x5__00016.png":{"frame":{"x":371,"y":766,"w":300,"h":197},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":43,"y":99,"w":300,"h":197},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":2048,"h":1000},"scale":1}}'),$=D.p+"images/wild5xspri.ff47198d.webp",B={phone:{atlas:q,texture:X},seven:{atlas:F,texture:c},bar:{atlas:d,texture:E},seven3:{atlas:A,texture:Y},bar3:{atlas:g,texture:R},cherry:{atlas:P,texture:y},wild:{atlas:JSON.parse('{"frames":{"wild__00004.png":{"frame":{"x":0,"y":0,"w":389,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":68,"w":389,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00005.png":{"frame":{"x":389,"y":0,"w":389,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":68,"w":389,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00006.png":{"frame":{"x":778,"y":0,"w":389,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":68,"w":389,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00007.png":{"frame":{"x":1167,"y":0,"w":389,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":68,"w":389,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00008.png":{"frame":{"x":1556,"y":0,"w":389,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":68,"w":389,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00009.png":{"frame":{"x":0,"y":259,"w":389,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":68,"w":389,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00010.png":{"frame":{"x":389,"y":259,"w":389,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":68,"w":389,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00011.png":{"frame":{"x":778,"y":259,"w":389,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":68,"w":389,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00012.png":{"frame":{"x":1167,"y":259,"w":389,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":68,"w":389,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00013.png":{"frame":{"x":1556,"y":259,"w":389,"h":259},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":68,"w":389,"h":259},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00014.png":{"frame":{"x":0,"y":518,"w":382,"h":248},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":3,"y":73,"w":382,"h":248},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00003.png":{"frame":{"x":382,"y":518,"w":374,"h":251},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":7,"y":72,"w":374,"h":251},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00000.png":{"frame":{"x":0,"y":766,"w":350,"h":231},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":19,"y":82,"w":350,"h":231},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00017.png":{"frame":{"x":756,"y":518,"w":350,"h":231},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":19,"y":82,"w":350,"h":231},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00001.png":{"frame":{"x":1106,"y":518,"w":331,"h":222},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":29,"y":87,"w":331,"h":222},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00015.png":{"frame":{"x":1437,"y":518,"w":317,"h":211},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":35,"y":92,"w":317,"h":211},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00016.png":{"frame":{"x":1754,"y":518,"w":290,"h":197},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":48,"y":99,"w":290,"h":197},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}},"wild__00002.png":{"frame":{"x":1437,"y":729,"w":308,"h":215},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":40,"y":90,"w":308,"h":215},"sourceSize":{"w":390,"h":390},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"texture.png","format":"RGBA8888","size":{"w":2048,"h":1000},"scale":1}}'),texture:D.p+"images/wildsprite.04081b6d.webp"},wild2x:{atlas:L,texture:S},wild5x:{atlas:f,texture:$},scatter:{atlas:V,texture:s},scatter2x:{atlas:T,texture:_},scatter3x:{atlas:C,texture:H},scatter5x:{atlas:o,texture:U},scatter10x:{atlas:h,texture:J}},O={atlas:l,spriteUrl:Q},v=Object.keys(B);var p=D(738759);class j extends a.mcf{constructor({name:t,animationTimeSec:K,textures:D}){super(),this.label=`Symbol-${t}`,this.textures=D,this.animationTimeSec=K,this.animationSprite=new a.Dl5(this.textures),this.animationSprite.anchor.set(.5,.5),this.addChild(this.animationSprite)}setSize(t,K){if(this.parent){const D=p.mZ(),a=Math.max(this.textures[0].width,this.textures[0].height);this.animationSprite.setSize(a,a),this.animationSprite.scale.set(D);const G=Math.max(t,K);this.parent.scale.set(G/(D*a))}else this.animationSprite.setSize(t,K)}get spriteScale(){return this.animationSprite.scale}startAnimation(){this.animationSprite.textures=this.animationFrameObject,this.animationSprite.loop=!1,this.animationSprite.animationSpeed=1,this.animationSprite.gotoAndPlay(0)}reset(){this.animationSprite.textures=[this.firstFrame]}stopAnimation(t){t?(this.animationSprite.stop(),this.animationSprite.textures=[this.lastFrame]):this.animationSprite.gotoAndStop(0)}get firstFrame(){return this.textures[0]}get lastFrame(){return this.textures[this.textures.length-1]}get animationFrameObject(){const{textures:t,animationTimeSec:K}=this;return t.map((D=>({texture:D,time:1e3*K/t.length})))}}class r extends a.kxk{constructor({animationTimeSec:t,scale:K,texture:D}){super({texture:D,visible:!1,alpha:0}),this.disposeAnimation=()=>{},this.permanentScale=K,this.anchor.set(.5),this.showAnimation=b.M(this).callback((()=>{this.visible=!0,this.alpha=0})).animateTo({alpha:1},t,W.dV),this.hideAnimation=b.M(this).callback((()=>{this.show()})).animateTo({alpha:0},t,W.dV).callback((()=>{this.visible=!1})),this.rotateAnimation=b.M(this).callback((()=>{this.show()})).animateTo({rotation:2*-Math.PI},t,W.sn)}setSize(t){const K=t*this.permanentScale;super.setSize(K)}show(){this.visible=!0,this.alpha=1}startShowAnimation(){this.startAnimation([this.showAnimation])}startHideAnimation(){this.startAnimation([this.hideAnimation])}startShowAndHideAnimation(){this.startAnimation([this.showAnimation,this.hideAnimation])}startRotateAnimation(){this.startAnimation([this.rotateAnimation],Number.MAX_VALUE)}stopAnimation(){var t;null===(t=this.currentAnimation)||void 0===t||t.fastForward(),this.disposeAnimation()}startAnimation(t,K=0){void 0!==this.currentAnimation&&(this.currentAnimation.fastForward(),this.currentAnimation.reset()),this.currentAnimation=x.M(),t.forEach((t=>{var K;null===(K=this.currentAnimation)||void 0===K||K.sequence(t)})),this.disposeAnimation=N.A(n.l({anim:this.currentAnimation,repeat:K,ticker:e._,dispose:!1}))}}const M=JSON.parse('{"frames":{"LightSweep":{"frame":{"x":0,"y":0,"w":185.4,"h":354},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":185.4,"h":354},"sourceSize":{"w":185.4,"h":354},"pivot":{"x":0.5,"y":0.5}}},"meta":{"image":"lightSweep-mobile.webp","format":"RGBA8888","size":{"w":185,"h":354},"scale":0.6}}'),k=D.p+"images/lightsweep.0375b980.webp",tt=JSON.parse('{"frames":{"LightSweep":{"frame":{"x":0,"y":0,"w":640,"h":590},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":640,"h":590},"sourceSize":{"w":640,"h":590}}},"meta":{"format":"RGBA8888","size":{"w":640,"h":590},"scale":"1"}}'),Kt=D.p+"images/lightsweep.4758a495.webp",Dt=JSON.parse('{"frames":{"nearwin__00005.png":{"frame":{"x":0,"y":0,"w":97.60000000000001,"h":903.2},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":97.60000000000001,"h":903.2},"sourceSize":{"w":97.60000000000001,"h":903.2},"pivot":{"x":0.5,"y":0.5}},"nearwin__00015.png":{"frame":{"x":97.60000000000001,"y":0,"w":97.60000000000001,"h":901.6},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":97.60000000000001,"h":901.6},"sourceSize":{"w":97.60000000000001,"h":901.6},"pivot":{"x":0.5,"y":0.5}},"nearwin__00006.png":{"frame":{"x":195.20000000000002,"y":0,"w":93.60000000000001,"h":899.2},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":93.60000000000001,"h":899.2},"sourceSize":{"w":93.60000000000001,"h":899.2},"pivot":{"x":0.5,"y":0.5}},"nearwin__00004.png":{"frame":{"x":288.8,"y":0,"w":93.60000000000001,"h":898.4000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":93.60000000000001,"h":898.4000000000001},"sourceSize":{"w":93.60000000000001,"h":898.4000000000001},"pivot":{"x":0.5,"y":0.5}},"nearwin__00014.png":{"frame":{"x":382.40000000000003,"y":0,"w":88.80000000000001,"h":896.8000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":88.80000000000001,"h":896.8000000000001},"sourceSize":{"w":88.80000000000001,"h":896.8000000000001},"pivot":{"x":0.5,"y":0.5}},"nearwin__00016.png":{"frame":{"x":471.20000000000005,"y":0,"w":88.80000000000001,"h":896},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":88.80000000000001,"h":896},"sourceSize":{"w":88.80000000000001,"h":896},"pivot":{"x":0.5,"y":0.5}},"nearwin__00007.png":{"frame":{"x":560,"y":0,"w":72,"h":892},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":72,"h":892},"sourceSize":{"w":72,"h":892},"pivot":{"x":0.5,"y":0.5}},"nearwin__00003.png":{"frame":{"x":632,"y":0,"w":70.4,"h":891.2},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":70.4,"h":891.2},"sourceSize":{"w":70.4,"h":891.2},"pivot":{"x":0.5,"y":0.5}},"nearwin__00013.png":{"frame":{"x":702.4000000000001,"y":0,"w":68.8,"h":890.4000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68.8,"h":890.4000000000001},"sourceSize":{"w":68.8,"h":890.4000000000001},"pivot":{"x":0.5,"y":0.5}},"nearwin__00017.png":{"frame":{"x":771.2,"y":0,"w":68.8,"h":889.6},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68.8,"h":889.6},"sourceSize":{"w":68.8,"h":889.6},"pivot":{"x":0.5,"y":0.5}},"nearwin__00008.png":{"frame":{"x":840,"y":0,"w":59.2,"h":886.4000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":59.2,"h":886.4000000000001},"sourceSize":{"w":59.2,"h":886.4000000000001},"pivot":{"x":0.5,"y":0.5}},"nearwin__00012.png":{"frame":{"x":899.2,"y":0,"w":56.800000000000004,"h":884.8000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":56.800000000000004,"h":884.8000000000001},"sourceSize":{"w":56.800000000000004,"h":884.8000000000001},"pivot":{"x":0.5,"y":0.5}},"nearwin__00002.png":{"frame":{"x":956,"y":0,"w":51.2,"h":884},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":51.2,"h":884},"sourceSize":{"w":51.2,"h":884},"pivot":{"x":0.5,"y":0.5}},"nearwin__00018.png":{"frame":{"x":1007.2,"y":0,"w":49.6,"h":882.4000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":49.6,"h":882.4000000000001},"sourceSize":{"w":49.6,"h":882.4000000000001},"pivot":{"x":0.5,"y":0.5}},"nearwin__00009.png":{"frame":{"x":1056.8,"y":0,"w":49.6,"h":879.2},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":49.6,"h":879.2},"sourceSize":{"w":49.6,"h":879.2},"pivot":{"x":0.5,"y":0.5}},"nearwin__00011.png":{"frame":{"x":1106.4,"y":0,"w":48,"h":879.2},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":48,"h":879.2},"sourceSize":{"w":48,"h":879.2},"pivot":{"x":0.5,"y":0.5}},"nearwin__00010.png":{"frame":{"x":1154.4,"y":0,"w":43.2,"h":876.8000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":43.2,"h":876.8000000000001},"sourceSize":{"w":43.2,"h":876.8000000000001},"pivot":{"x":0.5,"y":0.5}},"nearwin__00001.png":{"frame":{"x":1197.6000000000001,"y":0,"w":38.400000000000006,"h":876},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":38.400000000000006,"h":876},"sourceSize":{"w":38.400000000000006,"h":876},"pivot":{"x":0.5,"y":0.5}},"nearwin__00019.png":{"frame":{"x":1236,"y":0,"w":36.800000000000004,"h":874.4000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":36.800000000000004,"h":874.4000000000001},"sourceSize":{"w":36.800000000000004,"h":874.4000000000001},"pivot":{"x":0.5,"y":0.5}},"nearwin__00000.png":{"frame":{"x":1272.8000000000002,"y":0,"w":25.6,"h":868},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":25.6,"h":868},"sourceSize":{"w":25.6,"h":868},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"spritesheet_nearwin_dividers.png","format":"RGBA8888","size":{"w":1298,"h":903},"scale":0.8}}'),at=D.p+"images/spriteshee.0515324d.webp",Gt=D.p+"images/background.2cffd6a6.webp",Nt=JSON.parse('{"frames":{"xxxstreme_deviders__00005.png":{"frame":{"x":0,"y":0,"w":92.80000000000001,"h":903.2},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":92.80000000000001,"h":903.2},"sourceSize":{"w":92.80000000000001,"h":903.2},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00015.png":{"frame":{"x":92.80000000000001,"y":0,"w":87.2,"h":901.6},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":87.2,"h":901.6},"sourceSize":{"w":87.2,"h":901.6},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00006.png":{"frame":{"x":180,"y":0,"w":84.80000000000001,"h":899.2},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":84.80000000000001,"h":899.2},"sourceSize":{"w":84.80000000000001,"h":899.2},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00004.png":{"frame":{"x":264.8,"y":0,"w":78.4,"h":898.4000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":78.4,"h":898.4000000000001},"sourceSize":{"w":78.4,"h":898.4000000000001},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00014.png":{"frame":{"x":343.20000000000005,"y":0,"w":80,"h":896.8000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":80,"h":896.8000000000001},"sourceSize":{"w":80,"h":896.8000000000001},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00016.png":{"frame":{"x":423.20000000000005,"y":0,"w":73.60000000000001,"h":896},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":73.60000000000001,"h":896},"sourceSize":{"w":73.60000000000001,"h":896},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00007.png":{"frame":{"x":496.8,"y":0,"w":76,"h":892},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":76,"h":892},"sourceSize":{"w":76,"h":892},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00003.png":{"frame":{"x":572.8000000000001,"y":0,"w":64,"h":891.2},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":891.2},"sourceSize":{"w":64,"h":891.2},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00013.png":{"frame":{"x":636.8000000000001,"y":0,"w":73.60000000000001,"h":890.4000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":73.60000000000001,"h":890.4000000000001},"sourceSize":{"w":73.60000000000001,"h":890.4000000000001},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00017.png":{"frame":{"x":710.4000000000001,"y":0,"w":60.800000000000004,"h":889.6},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":60.800000000000004,"h":889.6},"sourceSize":{"w":60.800000000000004,"h":889.6},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00008.png":{"frame":{"x":771.2,"y":0,"w":71.2,"h":886.4000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":71.2,"h":886.4000000000001},"sourceSize":{"w":71.2,"h":886.4000000000001},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00012.png":{"frame":{"x":842.4000000000001,"y":0,"w":68,"h":884.8000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":884.8000000000001},"sourceSize":{"w":68,"h":884.8000000000001},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00002.png":{"frame":{"x":910.4000000000001,"y":0,"w":51.2,"h":884},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":51.2,"h":884},"sourceSize":{"w":51.2,"h":884},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00018.png":{"frame":{"x":961.6,"y":0,"w":49.6,"h":882.4000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":49.6,"h":882.4000000000001},"sourceSize":{"w":49.6,"h":882.4000000000001},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00009.png":{"frame":{"x":1011.2,"y":0,"w":64.8,"h":879.2},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64.8,"h":879.2},"sourceSize":{"w":64.8,"h":879.2},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00011.png":{"frame":{"x":1076,"y":0,"w":64.8,"h":879.2},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64.8,"h":879.2},"sourceSize":{"w":64.8,"h":879.2},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00010.png":{"frame":{"x":1140.8,"y":0,"w":63.2,"h":876.8000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":63.2,"h":876.8000000000001},"sourceSize":{"w":63.2,"h":876.8000000000001},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00001.png":{"frame":{"x":1204,"y":0,"w":38.400000000000006,"h":876},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":38.400000000000006,"h":876},"sourceSize":{"w":38.400000000000006,"h":876},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00019.png":{"frame":{"x":1242.4,"y":0,"w":36.800000000000004,"h":874.4000000000001},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":36.800000000000004,"h":874.4000000000001},"sourceSize":{"w":36.800000000000004,"h":874.4000000000001},"pivot":{"x":0.5,"y":0.5}},"xxxstreme_deviders__00000.png":{"frame":{"x":1279.2,"y":0,"w":25.6,"h":868},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":25.6,"h":868},"sourceSize":{"w":25.6,"h":868},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"xxxstreme_deviders.png","format":"RGBA8888","size":{"w":1305,"h":903},"scale":0.8}}'),Wt=D.p+"images/xxxstremed.3897fc09.webp",xt=JSON.parse('{"frames":{"Seven":{"frame":{"x":0,"y":0,"w":1047.2,"h":86.8},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":1047.2,"h":86.8},"sourceSize":{"w":1047.2,"h":86.8},"pivot":{"x":0.5,"y":0.5}},"Wild":{"frame":{"x":0,"y":86.8,"w":1047.2,"h":86.8},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":1047.2,"h":86.8},"sourceSize":{"w":1047.2,"h":86.8},"pivot":{"x":0.5,"y":0.5}},"Phone":{"frame":{"x":0,"y":173.6,"w":1045.8,"h":86.8},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":1045.8,"h":86.8},"sourceSize":{"w":1045.8,"h":86.8},"pivot":{"x":0.5,"y":0.5}},"Bar":{"frame":{"x":0,"y":260.4,"w":1044.3999999999999,"h":86.8},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":1044.3999999999999,"h":86.8},"sourceSize":{"w":1044.3999999999999,"h":86.8},"pivot":{"x":0.5,"y":0.5}},"Cherry":{"frame":{"x":0,"y":347.2,"w":1044.3999999999999,"h":86.8},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":1044.3999999999999,"h":86.8},"sourceSize":{"w":1044.3999999999999,"h":86.8},"pivot":{"x":0.5,"y":0.5}},"Separator":{"frame":{"x":0,"y":434,"w":20.299999999999997,"h":1033.8999999999999},"rotated":true,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":20.299999999999997,"h":1033.8999999999999},"sourceSize":{"w":20.299999999999997,"h":1033.8999999999999},"pivot":{"x":0.5,"y":0.5}},"NearWinHighlight":{"frame":{"x":0,"y":454.29999999999995,"w":377.29999999999995,"h":677.5999999999999},"rotated":true,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":377.29999999999995,"h":677.5999999999999},"sourceSize":{"w":377.29999999999995,"h":677.5999999999999},"pivot":{"x":0.5,"y":0.5}},"SeparatorsAttentionNormal":{"frame":{"x":1033.8999999999999,"y":434,"w":10.5,"h":210},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":10.5,"h":210},"sourceSize":{"w":10.5,"h":210},"pivot":{"x":0.5,"y":0.5}},"SeparatorsAttentionXxxtreme":{"frame":{"x":677.5999999999999,"y":454.29999999999995,"w":10.5,"h":210},"rotated":true,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":10.5,"h":210},"sourceSize":{"w":10.5,"h":210},"pivot":{"x":0.5,"y":0.5}},"WinLight":{"frame":{"x":677.5999999999999,"y":644,"w":170.79999999999998,"h":171.5},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":170.79999999999998,"h":171.5},"sourceSize":{"w":170.79999999999998,"h":171.5},"pivot":{"x":0.5,"y":0.5}},"Beam":{"frame":{"x":677.5999999999999,"y":815.5,"w":134.39999999999998,"h":8.399999999999999},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":134.39999999999998,"h":8.399999999999999},"sourceSize":{"w":134.39999999999998,"h":8.399999999999999},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://free-tex-packer.com","version":"0.6.7","image":"sprites_mobile.webp","format":"RGBA8888","size":{"w":1047,"h":832},"scale":0.7}}'),bt=D.p+"images/spritesmob.5eebf575.webp",nt=JSON.parse('{"frames":{"Bar":{"frame":{"h":124,"w":1492,"x":1045,"y":0},"rotated":true,"spriteSourceSize":{"h":124,"w":1492,"x":4,"y":4},"sourceSize":{"h":128,"w":1500},"trimmed":true},"Beam":{"frame":{"h":12,"w":192,"x":282,"y":970},"rotated":false,"spriteSourceSize":{"h":12,"w":192,"x":0,"y":45},"sourceSize":{"h":108,"w":192},"trimmed":true},"Cherry":{"frame":{"h":124,"w":1492,"x":919,"y":0},"rotated":true,"spriteSourceSize":{"h":124,"w":1492,"x":4,"y":4},"sourceSize":{"h":128,"w":1500},"trimmed":true},"NearWinHighlight":{"frame":{"h":968,"w":539,"x":0,"y":0},"rotated":false,"spriteSourceSize":{"h":968,"w":539,"x":0,"y":0},"sourceSize":{"h":968,"w":539},"trimmed":false},"Phone":{"frame":{"h":124,"w":1494,"x":793,"y":0},"rotated":true,"spriteSourceSize":{"h":124,"w":1494,"x":4,"y":4},"sourceSize":{"h":128,"w":1500},"trimmed":true},"Separator":{"frame":{"h":1477,"w":30,"x":1171,"y":0},"rotated":false,"spriteSourceSize":{"h":1477,"w":30,"x":0,"y":12},"sourceSize":{"h":1500,"w":32},"trimmed":true},"SeparatorsAttentionNormal":{"frame":{"h":300,"w":16,"x":264,"y":970},"rotated":false,"spriteSourceSize":{"h":300,"w":16,"x":6,"y":0},"sourceSize":{"h":300,"w":30},"trimmed":true},"SeparatorsAttentionXxxtreme":{"frame":{"h":300,"w":16,"x":246,"y":970},"rotated":false,"spriteSourceSize":{"h":300,"w":16,"x":6,"y":0},"sourceSize":{"h":300,"w":30},"trimmed":true},"Seven":{"frame":{"h":124,"w":1496,"x":667,"y":0},"rotated":true,"spriteSourceSize":{"h":124,"w":1496,"x":2,"y":4},"sourceSize":{"h":128,"w":1500},"trimmed":true},"Wild":{"frame":{"h":124,"w":1496,"x":541,"y":0},"rotated":true,"spriteSourceSize":{"h":124,"w":1496,"x":2,"y":4},"sourceSize":{"h":128,"w":1500},"trimmed":true},"WinLight":{"frame":{"h":245,"w":244,"x":0,"y":970},"rotated":false,"spriteSourceSize":{"h":245,"w":244,"x":6,"y":6},"sourceSize":{"h":256,"w":256},"trimmed":true}},"meta":{"scale":1}}'),et=D.p+"images/sprites.adde8f93.webp",it=JSON.parse('{"frames":{"Scatter_blank":{"frame":{"h":202,"w":234,"x":0,"y":230},"rotated":false,"spriteSourceSize":{"h":202,"w":234,"x":11,"y":30},"sourceSize":{"h":256,"w":256},"trimmed":true},"Scatter_filled":{"frame":{"h":228,"w":262,"x":0,"y":0},"rotated":false,"spriteSourceSize":{"h":228,"w":262,"x":7,"y":25},"sourceSize":{"h":276,"w":276},"trimmed":true}},"meta":{"image":"multiplyScatterNumbers.webp","format":"RGBA8888","size":{"w":265,"h":432},"scale":"1"}}'),zt=D.p+"images/multiplysc.c24f2ed2.webp";class It{static async prepare(){const{dispose:t}=await It.cache;return async()=>{t(),It._cache=void 0}}static get(){return It.cache}static async load(){return await async function(t){var K;const D=(null===(K=a.Ppp.config)||void 0===K?void 0:K.preferWorkers)||!0;return a.sP.setPreferences({preferWorkers:D}),{bundle:await a.sP.load(t),aliases:t}}(this.aliases)}static get cache(){return void 0===It._cache&&(It._cache=async function(t){const{bundle:K,aliases:D}=await t,[,N,,,,W,x,b,n]=D,[e,z,I,Z,w,m,d]=await Promise.all([Zt(K[W],O.atlas),Zt(K["sprites"],G.DS.IS_PHONE?xt:nt),Zt(K[x],G.DS.IS_PHONE?M:tt),Zt(K[b],Dt),Zt(K["multiplyScatterNumbers"],it),Promise.all(v.map((async t=>{const D=K[t],a=B[t].atlas;return[t,(G={name:t,textures:wt((await Zt(D,a)).textures)},t=>new j({...G,animationTimeSec:t}))];var G}))),Zt(K[n],Nt)]),E=m.reduce(((t,[K,D])=>(t[K]=D,t)),{}),l=[z.textures.Seven,z.textures.Bar,z.textures.Cherry,z.textures.Phone,z.textures.Wild],Q={normal:z.textures.SeparatorsAttentionNormal,xxxtreme:z.textures.SeparatorsAttentionXxxtreme},P=wt(d.textures),y=[new u(P),new u(P),new u(P),new u(P)];let q=0;const X=Object.entries(Z.textures);return X.sort((([t],[K])=>t<K?-1:1)),{symbols:E,background:K[N],winLight:t=>new r({texture:z.textures.WinLight,...t}),beam:t=>new i({texture:z.textures.Beam,...t}),xxxtremeSeparator:()=>{const t=q++%y.length;return y[t]},blurredSymbols:{...e.textures,scatter2x:e.textures.scatter_x2,scatter3x:e.textures.scatter_x3,scatter5x:e.textures.scatter_x5,scatter10x:e.textures.scatter_x10,wild2x:e.textures.wild,wild5x:e.textures.wild,seven3:e.textures.triple_seven,bar3:e.textures.triple_bar},separator:z.textures.Separator,winlines:l,multiplyScatterTextures:w.textures,nearWin:z.textures.NearWinHighlight,separatorsAttention:Q,lightSweep:I.textures.LightSweep,nearWinDividers:X.map((([,t])=>t)),dispose:()=>(I.dispose(),Z.dispose(),e.dispose(),z.dispose(),w.dispose(),d.dispose(),a.sP.unload(D))}}(this.load())),It._cache}}async function Zt(t,K){const D=new a.zo6(t,K);return await D.parse(),{textures:D.textures,dispose:()=>{D.destroy()}}}function wt(t){const K=Object.entries(t);return K.sort((([t],[K])=>t.localeCompare(K))),K.map((([,t])=>t))}It.onBeforeUnload=[],It.aliases=function(){const t="sprites",K="goldenText",D="goldenTextBack",N="scatterMultiplierFont",W="blurred",x="lightSweep",b="nearWinDividers",n="background",e="extremeSeparator",i=[t,n,K,D,N,W,x,b,e];a.sP.add({alias:K,src:Z,loadParser:"loadTxt"}),a.sP.add({alias:n,src:Gt}),a.sP.add({alias:D,src:I,loadParser:"loadTxt"}),a.sP.add({alias:N,src:m,loadParser:"loadTxt"}),a.sP.add({alias:W,src:O.spriteUrl}),a.sP.add({alias:t,src:G.DS.IS_PHONE?bt:et}),a.sP.add({alias:x,src:G.DS.IS_PHONE?k:Kt}),a.sP.add({alias:b,src:at}),a.sP.add({alias:e,src:Wt});const z="multiplyScatterNumbers";a.sP.add({alias:z,src:zt}),i.push(z);for(const t of v){const K=B[t].texture;a.sP.add({alias:t,src:K}),i.push(t)}return i}(),It._cache=void 0},465082:(t,K,D)=>{D.d(K,{_:()=>G});var a=D(478128);function G(t){const K=()=>{t(a.RvI.shared.deltaMS)};return a.RvI.shared.add(K),()=>{a.RvI.shared.remove(K)}}},442914:(t,K,D)=>{D.d(K,{TO:()=>P,h9:()=>y});var a=D(377810),G=D(282427),N=D(837557),W=D(738759),x=D(238733),b=D(136685),n=D(168850),e=D(384511);const i={copy:t=>({x:t.x,y:t.y}),lerp:(t,K,D,a)=>{a.set(e.Cc(t.x,K.x,D),e.Cc(t.y,K.y,D))}},z=[t=>{if(t instanceof x.bRX||t instanceof x.oA$)return i}],I="__PIXI__",Z={waitForAppOptions:!1,destroyOnUnmount:!0,devTools:!0};function w(t){null==t||t.destroy(!0,!0)}class m{constructor(t){this.app=t,this.children=[],this.disposed=!1,this.adjustLayout=()=>{this.children.forEach((t=>t.adjustLayout()))},this.app.stage.label="SlotMachineContainer",this.app.stage.eventMode="none"}removeChild(t){var K;if(this.disposed)return;if(void 0===t)return;const D=this.children.indexOf(t);-1!==D&&(this.children.splice(D,1),null===(K=this.app.stage)||void 0===K||K.removeChild(t))}addChild(t){this.children.push(t),this.app.stage.addChild(t),this.adjustLayout()}dispose(){var t,K;null===(t=this.app.stage)||void 0===t||t.removeAllListeners(),null===(K=this.app.stage)||void 0===K||K.removeChildren(),this.children.length=0,this.disposed=!0}get size(){return{width:this.app.renderer.width,height:this.app.renderer.height}}}const u=(t,K,{pixiAppContainer:D})=>{D.dispose()},d=W.mZ(),E=!((l=N.DS).IS_IOS&&l.cmpVersions(l.DeviceProperties.osVersion,"15.0")>=0&&l.cmpVersions(l.DeviceProperties.osVersion,"15.5")<0||l.IS_SAFARI&&l.cmpVersions(l.DeviceProperties.browserVersion,"15.0")>=0&&l.cmpVersions(l.DeviceProperties.browserVersion,"15.5")<0);var l;const Q={backgroundAlpha:0,resolution:N.DS.IS_PHONE?Math.min(2,d):d,autoDensity:!0,antialias:E,useContextAlpha:!1,powerPreference:"high-performance"},P=a.createContext(void 0);function y(){const{application:t}=function(t){const{appOptions:K,waitForAppOptions:D,destroyOnUnmount:G,devTools:N}={...Z,...t},[e,i]=a.useState(),[m,u]=a.useState(),d=a.useRef(!1);a.useEffect((()=>()=>{d.current=!0}),[]),a.useEffect((()=>{if(!K&&D)return;let t,a=!1;return async function(t,K=!0){const D=new x.lgM;await D.init({preference:"webgl",hello:!1,...t});const a=D.renderer.context.webGLVersion;W.KC(a),b.ui(I,z);const G=D.destroy.bind(D);return D.destroy=(...t)=>{b.Xv(I),G(...t)},K&&n.c(D),{application:D}}(K,N).then((K=>{t=K.application,a?w(t):i(t)}),(t=>{a||u(t)})),()=>{a=!0,d.current||w(t)}}),[K]),a.useEffect((()=>()=>{d.current&&e&&G&&(w(e),i(void 0))}),[e,G]);const E=a.useMemo((()=>{if(e&&!G)return(...t)=>{const[K=!0,D=!0]=t;e.destroy(K,D)}}),[e,G]);return{application:e,error:m,destroy:E}}({appOptions:Q}),K=G.wA(),[D,N]=a.useState(void 0);return a.useEffect((()=>{if(void 0===t)return;const D=new m(t);var a;return K((a=D,(t,K,{pixiAppContainer:D})=>{D.set(a)})),N(D),()=>{N(void 0),K(u)}}),[t,K]),D}},441164:(t,K,D)=>{D.d(K,{L:()=>H});var a=D(64922),G=D(912986),N=D(282427),W=D(530113),x=D(494475),b=D(872443),n=D(346160),e=D(827424),i=D(28230),z=D(822381),I=D(205156);const Z="container--a4d47",w="popupBubble--3ef4f";var m=D(13799),u=D(850449),d=D(864105),E=D(572989);const l=x.Oe((({state:t,ag:K})=>{const D=m.DB(t),{CustomBetPerRoundComponent:a,CustomBottomComponent:G}=d.R9().AutoplayCustomComponents||{},{isLargeScreen:N,isMediumScreen:W,isSmallScreen:x}=e.Qo(K.viewport.size.value);return{availableRounds:D.autoplayApiRounds(),currencySymbol:b.o2(t),gameTheme:u.SJ(t),gameDimensions:m.Ay(t),isDesktop:N,isLandscape:m.O5(t),isTablet:W,isMobile:x,isRtl:n.sU(),CustomBetPerRoundComponent:a,CustomBottomComponent:G,totalBet:K.balance.totalBet,isSettingsWindowOpen:K.autoplayUI.isSettingsWindowOpen,notification:K.autoplayUI.notification,closeSettings:K.autoplayUI.closeSettings,clearStopReason:K.autoplayUI.clearStopReason,setPreviousTotalBetVisibility:K.autoplayUI.setPreviousTotalBetVisibility}}),(t=>[t.viewport.size]))((({isSettingsWindowOpen:t,children:K,...D})=>{const{closeSettings:G,isLandscape:N}=D;return a.jsx(i.f,{position:"TopCenter",width:z.o1(42),isSlidingAppearance:!0,isCloseButtonEnabled:!0,isLandscape:N,visible:t,onClose:G,className:w,content:a.jsx("div",{className:Z,children:a.jsx(I._,{...D,withTitle:!0})}),wrapContent:!1,children:K})}));l.displayName="AutoplaySettingsPopupConnectedToAg";const Q=E.s((t=>({isRunning:t.isRunning,limitsEnabled:t.limitsEnabled,lossLimit:t.lossLimit,roundsLeft:t.roundsLeft,selectedRounds:t.selectedRounds,singleWin:t.singleWin,totalBetToRepeat:t.totalBetToRepeat})),(t=>({setLossLimit:t.setLossLimit,setSelectedRounds:t.setSelectedRounds,setSingleWin:t.setSingleWin,start:t.start,stop:t.stop})))(l);var P=D(2782);const y="slotsAutoplayButton--4ff88",q=t=>a.jsx("div",{className:y,children:a.jsx(Q,{children:a.jsx(P.L,{...t})})});var X=D(901577),h=D(170877),J=D(715907),T=D(730837);const _="autoplayButtonStub--d7502",C=({isDesktop:t=!1,isAutoplayEnabled:K=!1,disabled:D})=>K?t?a.jsx(q,{size:"M",disabled:D,layerStyles:W.S.customizableButton,type:"customizable"}):a.jsx(P.L,{disabled:D,layerStyles:W.S.customizableButton,type:"customizable"}):a.jsx(J.$,{onClick:G.A,size:t?"M":"S",className:_}),H=()=>{const t=N.d4(m.md),K=X.O().settings.autoplayApiEnabled(),D=N.d4(T.jN);return a.jsx(C,{isDesktop:t===h.OD.Desktop,isAutoplayEnabled:K,disabled:!D&&!K})}},542749:(t,K,D)=>{D.d(K,{SK:()=>d,YQ:()=>Q});var a=D(64922),G=D(377810),N=D(282427),W=D(415452),x=D(802548),b=D(730837),n=D(556972),e=D(977927),i=D(872496),z=D(170935),I=D(50141),Z=D(923968),w=D(484802),m=D(837925),u=D(357223);const d={fill:{default:"radial-gradient(57.34% 57.34% at 50% 32.06%, #1FE43E 0%, #085C3E 100%)",hover:"radial-gradient(57.34% 57.34% at 50% 32.06%, #1FE43E 0%, #1AC43E 64%, #085C3E 100%)"},underlayer:{activated:"linear-gradient(180deg, #685017 0%, #82621F 100%)"},stroke:{default:"linear-gradient(45deg, rgba(23, 157, 20, 1) 0%, rgba(9, 93, 38, 1) 100%)"},border:{outer:"linear-gradient(0deg, #876A27 0%, #EFC558 29.99%, #F8E39B 46.19%, #C49F44 63.9%, #EFC759 87.03%, #FFFCD5 100%)",inner:"linear-gradient(358deg, #D1B65F 1.79%, #DFB755 26.54%, #FFED8E 47.96%, #CFA043 71.05%, #9B7827 97.76%)"}},E={Normal:d,XXXtreme:{fill:{default:"radial-gradient(57.34% 57.34% at 50% 32.06%, #FFD600 0%, #DB4400 50%, #8E0100 100%)",hover:"radial-gradient(57.34% 57.34% at 50% 32.06%, #FFD600 5.21%, #F9BE00 20.83%, #DB4400 73.96%, #8E0100 100%)"},underlayer:{activated:"linear-gradient(180deg, #685017 0%, #82621F 100%)"},stroke:{default:"#B5981F"},border:{outer:"linear-gradient(0deg, #876A27 0%, #EFC558 29.99%, #F8E39B 46.19%, #C49F44 63.9%, #EFC759 87.03%, #FFFCD5 100%)",inner:"linear-gradient(358deg, #D1B65F 1.79%, #DFB755 26.54%, #FFED8E 47.96%, #CFA043 71.05%, #9B7827 97.76%)"}},SuperXXXtreme:{fill:{default:"radial-gradient(57.34% 57.34% at 50% 32.06%, #FFD600 0%, #DB4400 50%, #8E0100 100%)",hover:"radial-gradient(57.34% 57.34% at 50% 32.06%, #FFD600 5.21%, #F9BE00 20.83%, #DB4400 73.96%, #8E0100 100%)"},underlayer:{activated:"linear-gradient(180deg, #685017 0%, #82621F 100%)"},stroke:{default:"#B5981F"},border:{outer:"linear-gradient(0deg, #876A27 0%, #EFC558 29.99%, #F8E39B 46.19%, #C49F44 63.9%, #EFC759 87.03%, #FFFCD5 100%)",inner:"linear-gradient(358deg, #D1B65F 1.79%, #DFB755 26.54%, #FFED8E 47.96%, #CFA043 71.05%, #9B7827 97.76%)"}}},l=new w.L(!1),Q=()=>{const t=I._(),K=N.d4(b.jN),D=N.d4(u.WN),w=N.d4(u.Ut),d=N.d4(m.xl),Q=N.d4(m.Ww),P=G.useRef(null),y=N.d4(b.w7),q=Z.V((t=>{var K;return(null===(K=t.autoplay)||void 0===K?void 0:K.isRunning)||l})),X=G.useCallback((()=>{e.A("ButtonSpinRelease"),t(n.t0)}),[t]),h=G.useCallback((()=>{Q||(e.A("QuickStop"),t(n.gn))}),[t,Q]),J=G.useCallback((()=>{e.A("ButtonSpinPress")}),[]),T=G.useCallback((()=>{e.A("ButtonSpinReleaseOutside")}),[]),_=G.useCallback((()=>{!K||q||w?d&&h():X()}),[K,q,w,d,h,X]);return z.G(_),W.E({isQualificationRound:!0,elementRef:P}),a.jsx(x.h,{onClick:X,onPress:J,onReleaseOutside:T,onDisabledClick:h,disabled:!K||q,labelText:i.T("spinButton.spin"),layerStyles:E[D],ref:P,tooltip:y?void 0:"tooltip.balanceTooLow"})}},41778:(t,K,D)=>{D.d(K,{b:()=>Q});var a=D(64922),G=D(699695),N=D(872496);const W="catchScattersMessage--82da9",x="message--a30bc",b="isPhone--38fdb",n="isTablet--6ac84",e="scatter--f56a4",i="text--b05af",z=D.p+"images/scatter.b942562f.png",I=({className:t,isMobile:K,isTablet:D})=>{const I={[b]:K,[n]:D},Z=N.T("catchScattersMessage.part1"),w=N.T("catchScattersMessage.part2"),m=10,u=Math.min(.425,m/Math.max(w.length,Math.max(m,Z.length))),d={fontSize:`${K?4*u:2}ch`},E=K?Math.max(.9,u):1;return a.jsx("div",{className:G.A(W,I,t),children:a.jsxs("div",{className:G.A(x,I),children:[a.jsx("span",{className:G.A(i,I),style:d,children:Z}),a.jsx("img",{src:z,alt:"scatter",className:G.A(e,I),style:{transform:`scale(${E})`}}),a.jsx("span",{className:G.A(i,I),style:d,children:w})]})})},Z="container--c106d",w="isPhone--80958",m="xxxtremeMode--0a72c",u="isTablet--cf20d",d=D.p+"images/superxxxtr.addf529f.webp",E={XXXtreme:D.p+"images/xxxtreme.2b88b413.webp",SuperXXXtreme:d};function l({mode:t,isMobile:K,isTablet:D}){const N=E[t];return a.jsx("img",{className:G.A(m,{[w]:K,[u]:D}),src:N,alt:t})}const Q=({spinMode:t,isMobile:K,className:D,isTablet:N})=>a.jsx("div",{className:G.A(Z,D,{[w]:K,[u]:N}),children:"Normal"===t?a.jsx(I,{isMobile:K,isTablet:N}):a.jsx(l,{mode:t,isMobile:K,isTablet:N})})},861880:(t,K,D)=>{D.d(K,{D:()=>d,v:()=>u});var a=D(64922),G=D(912986),N=D(377810),W=D(282427),x=D(530113),b=D(241665),n=D(977927),e=D(901577),i=D(715907),z=D(767140),I=D(554267),Z=D(730837),w=D(727798);const m="turboButtonStub--d1f5a",u=({active:t=!1,onClick:K=()=>{},isMobile:D=!1,isDesktop:N=!1,disabled:W=!1})=>{const b=t?"Activated":void 0;return W?a.jsx(i.$,{onClick:G.A,size:D?"S":"M",className:m}):a.jsx(i.g,{state:b,onClick:K,iconComponent:a.jsx(z.Q,{speed:t?I.hR.Fast:I.hR.Normal,speedModeCount:2},"turbo-icon"),layerStyles:x.S.customizableButton,size:D?"S":"M",tooltip:N?"turboModeTooltip":void 0})},d=()=>{const t=W.wA(),K=W.d4(Z.RB),D=W.d4(Z.Tx),G=W.d4(Z.xf),{platform:x,log:i}=e.O(),z=N.useCallback((()=>{const K=w.UL();return n.A(D?"GameSpeedNormal":"GameSpeedFast"),i(b.p7({gamePhase:"Qualification",playerGameId:G,speedFrom:D?"Turbo":"Normal",speedTo:D?"Normal":"Turbo"})),t(K)}),[t,i,G,D]);return a.jsx(u,{active:D,onClick:z,disabled:!K,isMobile:"Phone"===x,isDesktop:"Desktop"===x})}},552652:(t,K,D)=>{D.d(K,{h:()=>H});var a=D(64922),G=D(699695),N=D(912986),W=D(377810),x=D(282427),b=D(977927),n=D(872496),e=D(232737),i=D(923968),z=D(901577),I=D(484802),Z=D(462566),w=D(541310),m=D(357223);const u=D.p+"images/xxxtreme.d193461a.webp",d="xxxtremeButton--3c024",E="disabled--0ea46",l="mobile--f2974",Q="background--3b951",P="defaultMode--ca216",y="xtremeMode--70a3e",q="superXtremeMode--af2bd",X="backgroundMobile--52f5d",h="label--30f38",J="text--23078",T="xxxtreme--e5f46",_=Z.u((({disabled:t=!1,isActivated:K,isMobile:D=!1,tooltipComponent:x,className:e,spinMode:i,showTooltip:z,onClick:I=N.A})=>{const Z=K?n.T("deactivate.uppercase"):n.T("activate.uppercase"),w=W.useCallback((()=>{null==z||z(),t||("Normal"!==i||K||b.A("XxxtremeOpen"),"XXXtreme"===i&&K&&b.A("XxxtremeDeactivate"),"SuperXXXtreme"===i&&K&&b.A("SuperXxxtremeDeactivate"),I())}),[t,K,I,z,i]);return a.jsxs("div",{className:G.A(e,d,{[l]:D,[E]:t,[P]:"Normal"===i,[y]:"XXXtreme"===i,[q]:"SuperXXXtreme"===i}),children:[x,a.jsxs("div",{className:h,onClick:w,children:[a.jsx("div",{className:J,children:Z}),a.jsx("img",{src:u,className:G.A(T,{[l]:D}),alt:"XXXtreme"})]}),a.jsx("div",{className:D?X:Q})]})}),{hasAnchor:!0,shouldShowImmediately:!0,persistAfterClick:!0}),C=new I.L(!1),H=({playerGameId:t})=>{const K=e.y(w.S$);W.useEffect((()=>K(t)),[K,t]);const D=x.d4(m.WN),G=x.d4(m.WY),N=i.V((t=>{var K;return(null===(K=t.autoplay)||void 0===K?void 0:K.isRunning)||C})),{platform:b}=z.O(),n=x.d4(m.KX),I=e.y((()=>w.Y_(t))),Z=x.d4(m.Y$),u=x.d4(m.p5),d=!G&&(N||!n),E=d&&!N?Z||u||"tooltip.balanceTooLow":void 0;return a.jsx(_,{spinMode:D,isActivated:G,disabled:d,tooltip:E,isMobile:"Phone"===b||"Tablet"===b,onClick:I})}},559979:(t,K,D)=>{D.d(K,{D:()=>ht});var a=D(64922),G=D(699695),N=D(377810),W=D(977927),x=D(462566),b=D(715907),n=D(872496),e=D(587698);const i="betStakePicker--e14da",z="fill--76660",I="stroke--a84f6",Z="mediumText--9155c",w="smallText--b099f",m="smallestText--d526d",u="Phone--e849c";function d(t){const K=t.length,D=0?0:4;let a;return K>=9+D?a=m:K>=7+D?a=w:K>=5+D&&(a=Z),a}const E=N.memo((({text:t,isPhone:K})=>a.jsxs("div",{className:G.A(i,{[u]:K},d(t)),children:[a.jsxs("span",{className:I,children:[" ",t," "]}),a.jsxs("span",{className:z,children:[" ",t," "]})]})));var l=D(5519);const Q="#843B05",P="#3F1C02",y="#C39547",q="#7E6330",X=["Default","Promo","CallToAction","Hovered","PromoHovered","CallToAction2"];function h(t,K,D="Default",G){const N="Activated"===K?G?`url(#${G})`:Q:y,W="Activated"===K?P:q;return a.jsxs(a.Fragment,{children:[a.jsx("g",{filter:`url(#${t})`,children:a.jsx("path",{d:"Small"===D?"M25 2.95691C25 2.55306 24.546 2.31584 24.2145 2.54646L2.59003 17.5895C2.30407 17.7885 2.30407 18.2115 2.59002 18.4105L24.2145 33.4535C24.546 33.6842 25 33.4469 25 33.0431V2.95691Z":"M36 3.869a1 1 0 0 0-1.555-.833L4.248 23.168a1 1 0 0 0 0 1.664l30.197 20.132A1 1 0 0 0 36 44.132V3.869Z",fill:N})}),a.jsx("path",{d:"Small"===D?"M24.5 2.95691L2.87556 18L24.5 33.0431L24.5 2.95691Z":"M35.5 3.869a.5.5 0 0 0-.777-.417L4.525 23.584a.5.5 0 0 0 0 .832l30.198 20.131a.5.5 0 0 0 .777-.415V3.869Z",stroke:W})]})}function J(t,K="Default"){return a.jsx("path",{d:"Small"===K?"M25 2.95691C25 2.55306 24.546 2.31584 24.2145 2.54646L2.59003 17.5895C2.30407 17.7885 2.30407 18.2115 2.59002 18.4105L24.2145 33.4535C24.546 33.6842 25 33.4469 25 33.0431V2.95691Z":"M36 3.869a1 1 0 0 0-1.555-.833L4.248 23.168a1 1 0 0 0 0 1.664l30.197 20.132A1 1 0 0 0 36 44.132V3.869Z",fill:`url(#${t})`})}function T(t,K,D="Default"){return a.jsx("path",{d:"Small"===D?"M24.5 2.95691L2.87556 18L24.5 33.0431L24.5 2.95691Z":"M35.5 3.869a.5.5 0 0 0-.777-.417L4.525 23.584a.5.5 0 0 0 0 .832l30.198 20.131a.5.5 0 0 0 .777-.415V3.869Z",fill:`url(#${t})`,stroke:`url(#${K})`})}const _=({state:t,size:K="Default",customizable:D})=>{var G,W,x,b,n,e,i,z,I,Z,w,m,u,d,E,l,Q,P,y,q,_,C,H,o,U,V,s,F,c,g,R,A,Y,L,S,f,$,B,O,v,p,j;const r=N.useId(),M=N.useId(),k=N.useId(),tt=N.useId(),Kt=N.useId(),Dt=N.useId(),at=N.useId(),Gt=N.useId(),Nt=N.useId(),Wt=N.useId(),xt=N.useId(),bt=N.useId(),nt=N.useId(),et=N.useId(),it=N.useId(),zt=N.useId(),It=N.useId(),Zt=N.useId(),wt=N.useId(),mt=N.useId(),ut=N.useId(),dt=N.useId(),Et=N.useId(),lt=N.useId(),Qt=N.useId(),Pt=N.useId(),yt={Default:J((null===(G=null==D?void 0:D.mainBody)||void 0===G?void 0:G.Default)?Et:r),Disabled:T((null===(W=null==D?void 0:D.mainBody)||void 0===W?void 0:W.Disabled)?Pt:M,k),Activated:h(tt,"Activated",void 0,(null===(x=null==D?void 0:D.mainBody)||void 0===x?void 0:x.Activated)&&Qt),Hovered:J((null===(b=null==D?void 0:D.mainBody)||void 0===b?void 0:b.Hovered)?lt:Nt),Promo:J(Kt),PromoActive:h(Dt,"PromoActive"),CallToAction:J(at),CallToAction2:J(Gt),PromoHovered:J(Wt)},qt={Default:J((null==D?void 0:D.mainBody.Default)?Et:r,"Small"),Disabled:T((null==D?void 0:D.mainBody.Disabled)?Pt:M,k,"Small"),Activated:h(tt,"Activated","Small",(null===(n=null==D?void 0:D.mainBody)||void 0===n?void 0:n.Activated)&&Qt),Hovered:J((null===(e=null==D?void 0:D.mainBody)||void 0===e?void 0:e.Hovered)?lt:Nt,"Small"),Promo:J(Kt,"Small"),PromoActive:h(Dt,"PromoActive","Small"),CallToAction:J(at,"Small"),CallToAction2:J(Gt,"Small"),PromoHovered:J(Wt,"Small")},Xt={Default:(null===(i=null==D?void 0:D.outerStroke)||void 0===i?void 0:i.Default)?it:bt,Disabled:(null===(z=null==D?void 0:D.outerStroke)||void 0===z?void 0:z.Disabled)?Zt:bt,Activated:(null===(I=null==D?void 0:D.outerStroke)||void 0===I?void 0:I.Activated)?It:bt,Hovered:(null===(Z=null==D?void 0:D.outerStroke)||void 0===Z?void 0:Z.Hovered)?zt:bt,Promo:bt,PromoActive:bt,CallToAction:bt,CallToAction2:bt,PromoHovered:bt},ht={Default:(null===(w=null==D?void 0:D.innerStroke)||void 0===w?void 0:w.Default)?wt:nt,Disabled:(null===(m=null==D?void 0:D.innerStroke)||void 0===m?void 0:m.Disabled)?dt:nt,Activated:(null===(u=null==D?void 0:D.innerStroke)||void 0===u?void 0:u.Activated)?ut:nt,Hovered:(null===(d=null==D?void 0:D.innerStroke)||void 0===d?void 0:d.Hovered)?mt:nt,Promo:nt,PromoActive:nt,CallToAction:nt,CallToAction2:nt,PromoHovered:nt},Jt=X.includes(t),Tt="Small"===K;return a.jsxs("svg",{width:"Small"===K?"28":"40",height:"Small"===K?"36":"48",viewBox:"Small"===K?"0 0 28 36":"0 0 40 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsxs(a.Fragment,{children:[a.jsx("path",{d:Tt?"M23.6434 1.72555C24.638 1.03369 26 1.74537 26 2.95691V33.0431C26 34.2546 24.638 34.9663 23.6434 34.2744L2.01896 19.2314C1.16108 18.6346 1.1611 17.3654 2.01896 16.7686L23.6434 1.72555Z":"M33.89 2.204C35.22 1.318 37 2.271 37 3.87v40.26c0 1.598-1.78 2.55-3.11 1.665L3.694 25.664a2 2 0 0 1 0-3.328L33.891 2.204Z",fill:`url(#${bt})`,stroke:`url(#${Xt[t]})`,strokeWidth:"2"}),a.jsx("path",{d:Tt?"M23.9289 2.136C24.592 1.67476 25.5 2.14922 25.5 2.95691V33.0431C25.5 33.8508 24.592 34.3252 23.9289 33.864L2.30449 18.8209C1.73258 18.423 1.73258 17.5769 2.30449 17.1791L23.9289 2.136Z":"M34.168 2.62c.997-.664 2.332.05 2.332 1.249V44.13c0 1.199-1.335 1.913-2.332 1.249L3.97 25.248a1.5 1.5 0 0 1 0-2.496L34.168 2.62Z",stroke:`url(#${ht[t]})`}),Tt?qt[t]:yt[t],Jt&&a.jsx("path",{d:Tt?"M25 2.95691C25 2.55306 24.546 2.31584 24.2145 2.54646L2.59003 17.5895C2.30407 17.7885 2.30407 18.2115 2.59002 18.4105L24.2145 33.4535C24.546 33.6842 25 33.4469 25 33.0431V2.95691Z":"M36 3.869a1 1 0 0 0-1.555-.833L4.248 23.168a1 1 0 0 0 0 1.664l30.197 20.132A1 1 0 0 0 36 44.132V3.869Z",fill:`url(#${et})`,fillOpacity:"0.5"}),a.jsx("path",{d:Tt?"M13.5 16.6875H20.5V19.3125H13.5V16.6875Z":"M20 22.125h10v3.75H20v-3.75Z",fill:"#FEF0CC",opacity:"Disabled"===t?".4":"1"})]}),a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:bt,x1:"24",y1:"49",x2:"24.576",y2:"-10.995",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#AA5D0B"}),a.jsx("stop",{offset:".162",stopColor:"#EBC573"}),a.jsx("stop",{offset:".266",stopColor:"#D3923F"}),a.jsx("stop",{offset:".361",stopColor:"#D69847"}),a.jsx("stop",{offset:".492",stopColor:"#E3B866"}),a.jsx("stop",{offset:".671",stopColor:"#E09D1C"}),a.jsx("stop",{offset:"1",stopColor:"#F0ECBA"})]}),a.jsx("linearGradient",{id:it,x1:"24",y1:"49",x2:"24.576",y2:"-10.995",gradientUnits:"userSpaceOnUse",transform:null===(E=null==D?void 0:D.outerStroke)||void 0===E?void 0:E.gradientTransform,children:null===(Q=null===(l=null==D?void 0:D.outerStroke)||void 0===l?void 0:l.Default)||void 0===Q?void 0:Q.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:zt,x1:"24",y1:"49",x2:"24.576",y2:"-10.995",gradientUnits:"userSpaceOnUse",transform:null===(P=null==D?void 0:D.outerStroke)||void 0===P?void 0:P.gradientTransform,children:null===(q=null===(y=null==D?void 0:D.outerStroke)||void 0===y?void 0:y.Hovered)||void 0===q?void 0:q.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:It,x1:"24",y1:"49",x2:"24.576",y2:"-10.995",gradientUnits:"userSpaceOnUse",transform:null===(_=null==D?void 0:D.outerStroke)||void 0===_?void 0:_.gradientTransform,children:null===(H=null===(C=null==D?void 0:D.outerStroke)||void 0===C?void 0:C.Activated)||void 0===H?void 0:H.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:Zt,x1:"24",y1:"49",x2:"24.576",y2:"-10.995",gradientUnits:"userSpaceOnUse",transform:null===(o=null==D?void 0:D.outerStroke)||void 0===o?void 0:o.gradientTransform,children:null===(V=null===(U=null==D?void 0:D.outerStroke)||void 0===U?void 0:U.Disabled)||void 0===V?void 0:V.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsxs("linearGradient",{id:xt,x1:"24",y1:"49",x2:"24.576",y2:"-10.995",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#AA5D0B"}),a.jsx("stop",{offset:".162",stopColor:"#EBC573"}),a.jsx("stop",{offset:".266",stopColor:"#D3923F"}),a.jsx("stop",{offset:".361",stopColor:"#D69847"}),a.jsx("stop",{offset:".492",stopColor:"#E3B866"}),a.jsx("stop",{offset:".671",stopColor:"#E09D1C"}),a.jsx("stop",{offset:"1",stopColor:"#F0ECBA"})]}),a.jsx("linearGradient",{id:wt,x1:"24",y1:"49",x2:"24.576",y2:"-10.995",gradientUnits:"userSpaceOnUse",transform:null===(s=null==D?void 0:D.innerStroke)||void 0===s?void 0:s.gradientTransform,children:null===(c=null===(F=null==D?void 0:D.innerStroke)||void 0===F?void 0:F.Default)||void 0===c?void 0:c.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:mt,x1:"24",y1:"49",x2:"24.576",y2:"-10.995",gradientUnits:"userSpaceOnUse",transform:null===(g=null==D?void 0:D.innerStroke)||void 0===g?void 0:g.gradientTransform,children:null===(A=null===(R=null==D?void 0:D.innerStroke)||void 0===R?void 0:R.Hovered)||void 0===A?void 0:A.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:ut,x1:"24",y1:"49",x2:"24.576",y2:"-10.995",gradientUnits:"userSpaceOnUse",transform:null===(Y=null==D?void 0:D.innerStroke)||void 0===Y?void 0:Y.gradientTransform,children:null===(S=null===(L=null==D?void 0:D.innerStroke)||void 0===L?void 0:L.Activated)||void 0===S?void 0:S.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:dt,x1:"24",y1:"49",x2:"24.576",y2:"-10.995",gradientUnits:"userSpaceOnUse",transform:null===(f=null==D?void 0:D.innerStroke)||void 0===f?void 0:f.gradientTransform,children:null===(B=null===($=null==D?void 0:D.innerStroke)||void 0===$?void 0:$.Disabled)||void 0===B?void 0:B.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsxs("linearGradient",{id:nt,x1:"33.407",y1:"29.77",x2:"-.064",y2:"29.77",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#F8E39B"}),a.jsx("stop",{offset:".268",stopColor:"#EFC558"}),a.jsx("stop",{offset:".5",stopColor:"#F8E39B"}),a.jsx("stop",{offset:".75",stopColor:"#EFC558"}),a.jsx("stop",{offset:"1",stopColor:"#876A27"})]}),a.jsxs("linearGradient",{id:r,x1:"34.5",y1:"22.842",x2:"4",y2:"22.842",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#622E04"}),a.jsx("stop",{offset:".992",stopColor:"#291201"})]}),a.jsxs("linearGradient",{id:M,x1:"35.192",y1:"3.2",x2:"35.192",y2:"45.046",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#251101"}),a.jsx("stop",{offset:"1",stopColor:"#291201"})]}),a.jsxs("linearGradient",{id:k,x1:"3.065",y1:"46",x2:"3.065",y2:"2.173",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#1E1D1A"}),a.jsx("stop",{offset:"1",stopColor:"#3D3D3D"})]}),a.jsxs("filter",{id:tt,x:"2.803",y:"1.867",width:"34.197",height:"44.266",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[a.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),a.jsx("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),a.jsx("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),a.jsx("feOffset",{dx:"1",dy:"1"}),a.jsx("feGaussianBlur",{stdDeviation:"2"}),a.jsx("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),a.jsx("feColorMatrix",{values:"0 0 0 0 0.0833333 0 0 0 0 0.0362153 0 0 0 0 0.00138889 0 0 0 0.7 0"}),a.jsx("feBlend",{in2:"shape",result:"effect1_innerShadow_75_819"}),a.jsx("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),a.jsx("feOffset",{dx:"-1",dy:"-1"}),a.jsx("feGaussianBlur",{stdDeviation:"2"}),a.jsx("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),a.jsx("feColorMatrix",{values:"0 0 0 0 0.0823529 0 0 0 0 0.0352941 0 0 0 0 0 0 0 0 0.7 0"}),a.jsx("feBlend",{in2:"effect1_innerShadow_75_819",result:"effect2_innerShadow_75_819"})]}),a.jsxs("linearGradient",{id:Kt,x1:"19.5",y1:"2.823",x2:"19.5",y2:"46",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#CAA453"}),a.jsx("stop",{offset:"1",stopColor:"#80510B"})]}),a.jsxs("filter",{id:Dt,x:"2.803",y:"1.867",width:"34.197",height:"44.266",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[a.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),a.jsx("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),a.jsx("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),a.jsx("feOffset",{dx:"1",dy:"1"}),a.jsx("feGaussianBlur",{stdDeviation:"2"}),a.jsx("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),a.jsx("feColorMatrix",{values:"0 0 0 0 0.0833333 0 0 0 0 0.0362153 0 0 0 0 0.00138889 0 0 0 0.7 0"}),a.jsx("feBlend",{in2:"shape",result:"effect1_innerShadow_729_12377"}),a.jsx("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),a.jsx("feOffset",{dx:"-1",dy:"-1"}),a.jsx("feGaussianBlur",{stdDeviation:"2"}),a.jsx("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),a.jsx("feColorMatrix",{values:"0 0 0 0 0.0823529 0 0 0 0 0.0352941 0 0 0 0 0 0 0 0 0.7 0"}),a.jsx("feBlend",{in2:"effect1_innerShadow_729_12377",result:"effect2_innerShadow_729_12377"})]}),a.jsxs("linearGradient",{id:at,x1:"16.5",y1:"0.822907",x2:"16.5",y2:"44",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#EFC558"}),a.jsx("stop",{offset:"1",stopColor:"#80510B"})]}),a.jsxs("linearGradient",{id:Gt,x1:"19.5",y1:"3.2",x2:"19.5",y2:"45.046",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#FB360A"}),a.jsx("stop",{offset:"1",stopColor:"#9B2006"})]}),a.jsxs("linearGradient",{id:Nt,x1:"34.5",y1:"22.842",x2:"4",y2:"22.842",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#834412"}),a.jsx("stop",{offset:".992",stopColor:"#5A2A06"})]}),a.jsxs("linearGradient",{id:Wt,x1:"19.5",y1:"2.823",x2:"19.5",y2:"46",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#D6B97A"}),a.jsx("stop",{offset:"1",stopColor:"#AF6F0F"})]}),a.jsx("linearGradient",{id:Et,x1:"34.5",y1:"22.842",x2:"4",y2:"22.842",gradientUnits:"userSpaceOnUse",children:null===(O=null==D?void 0:D.mainBody.Default)||void 0===O?void 0:O.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:lt,x1:"34.5",y1:"22.842",x2:"4",y2:"22.842",gradientUnits:"userSpaceOnUse",children:null===(v=null==D?void 0:D.mainBody.Hovered)||void 0===v?void 0:v.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:Qt,x1:"34.5",y1:"22.842",x2:"4",y2:"22.842",gradientUnits:"userSpaceOnUse",children:null===(p=null==D?void 0:D.mainBody.Activated)||void 0===p?void 0:p.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:Pt,x1:"34.5",y1:"22.842",x2:"4",y2:"22.842",gradientUnits:"userSpaceOnUse",children:null===(j=null==D?void 0:D.mainBody.Disabled)||void 0===j?void 0:j.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsxs("linearGradient",{id:et,x1:"26",y1:"2",x2:"25.5",y2:"46",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#fff",stopOpacity:".7"}),a.jsx("stop",{offset:"1",stopColor:"#fff",stopOpacity:"0"})]})]})]})};function C(t,K,D="Default"){return a.jsx("path",{d:"Small"===D?"M3.5 2.957 25.124 18 3.5 33.043V2.957Z":"M4.5 3.869a.5.5 0 0 1 .777-.417l30.198 20.132a.5.5 0 0 1 0 .832L5.277 44.547a.5.5 0 0 1-.777-.415V3.869Z",fill:`url(#${t})`,stroke:`url(#${K})`})}function H(t,K,D="Default",G){const N="Activated"===K?G?`url(#${G})`:Q:y,W="Activated"===K?P:q;return a.jsxs(a.Fragment,{children:[a.jsx("g",{filter:`url(#${t})`,children:a.jsx("path",{d:"Small"===D?"M3 2.957a.5.5 0 0 1 .786-.41L25.41 17.59a.5.5 0 0 1 0 .82L3.786 33.453a.5.5 0 0 1-.786-.41V2.957Z":"M4 3.869a1 1 0 0 1 1.555-.833l30.197 20.132a1 1 0 0 1 0 1.664L5.555 44.964A1 1 0 0 1 4 44.132V3.869Z",fill:N})}),a.jsx("path",{d:"Small"===D?"M3.5 2.957 25.124 18 3.5 33.043V2.957Z":"M4.5 3.869a.5.5 0 0 1 .777-.417l30.198 20.132a.5.5 0 0 1 0 .832L5.277 44.547a.5.5 0 0 1-.777-.415V3.869Z",stroke:W})]})}function o(t,K="Default"){return a.jsx("path",{d:"Small"===K?"M3 2.957a.5.5 0 0 1 .786-.41L25.41 17.59a.5.5 0 0 1 0 .82L3.786 33.453a.5.5 0 0 1-.786-.41V2.957Z":"M4 3.86863C4 3.06993 4.89015 2.59354 5.5547 3.03657L35.7519 23.1681C36.3457 23.5639 36.3457 24.4363 35.7519 24.8322L5.5547 44.9636C4.89015 45.4067 4 44.9303 4 44.1316V3.86863Z",fill:`url(#${t})`})}const U=({state:t,size:K="Default",customizable:D})=>{var G,W,x,b,n,e,i,z,I,Z,w,m,u,d,E,l,Q,P,y,q,h,J,T,_,U,V,s,F,c,g,R,A,Y,L,S,f,$,B,O,v,p,j,r,M,k,tt,Kt;const Dt=X.includes(t),at="Small"===K,Gt=N.useId(),Nt=N.useId(),Wt=N.useId(),xt=N.useId(),bt=N.useId(),nt=N.useId(),et=N.useId(),it=N.useId(),zt=N.useId(),It=N.useId(),Zt=N.useId(),wt=N.useId(),mt=N.useId(),ut=N.useId(),dt=N.useId(),Et=N.useId(),lt=N.useId(),Qt=N.useId(),Pt=N.useId(),yt=N.useId(),qt=N.useId(),Xt=N.useId(),ht=N.useId(),Jt=N.useId(),Tt=N.useId(),_t=N.useId(),Ct={Default:o((null===(G=null==D?void 0:D.mainBody)||void 0===G?void 0:G.Default)?ht:Gt),Disabled:C((null===(W=null==D?void 0:D.mainBody)||void 0===W?void 0:W.Disabled)?_t:Nt,Wt),Activated:H(xt,"Activated",void 0,(null===(x=null==D?void 0:D.mainBody)||void 0===x?void 0:x.Activated)&&Tt),Hovered:o((null===(b=null==D?void 0:D.mainBody)||void 0===b?void 0:b.Hovered)?Jt:zt),Promo:o(bt),PromoActive:H(nt,"PromoActive"),CallToAction:o(et),CallToAction2:o(it),PromoHovered:o(It)},Ht={Default:o((null==D?void 0:D.mainBody.Default)?ht:Gt,"Small"),Disabled:C((null==D?void 0:D.mainBody.Disabled)?_t:Nt,Wt,"Small"),Activated:H(xt,"Activated","Small",(null===(n=null==D?void 0:D.mainBody)||void 0===n?void 0:n.Activated)&&Tt),Hovered:o((null===(e=null==D?void 0:D.mainBody)||void 0===e?void 0:e.Hovered)?Jt:zt,"Small"),Promo:o(bt,"Small"),PromoActive:H(nt,"PromoActive","Small"),CallToAction:o(et,"Small"),CallToAction2:o(it,"Small"),PromoHovered:o(It,"Small")},ot={Default:(null===(i=null==D?void 0:D.outerStroke)||void 0===i?void 0:i.Default)?dt:wt,Disabled:(null===(z=null==D?void 0:D.outerStroke)||void 0===z?void 0:z.Disabled)?Qt:wt,Activated:(null===(I=null==D?void 0:D.outerStroke)||void 0===I?void 0:I.Activated)?lt:wt,Hovered:(null===(Z=null==D?void 0:D.outerStroke)||void 0===Z?void 0:Z.Hovered)?Et:wt,Promo:wt,PromoActive:wt,CallToAction:wt,CallToAction2:wt,PromoHovered:wt},Ut={Default:(null===(w=null==D?void 0:D.innerStroke)||void 0===w?void 0:w.Default)?Pt:mt,Disabled:(null===(m=null==D?void 0:D.innerStroke)||void 0===m?void 0:m.Disabled)?Xt:mt,Activated:(null===(u=null==D?void 0:D.innerStroke)||void 0===u?void 0:u.Activated)?qt:mt,Hovered:(null===(d=null==D?void 0:D.innerStroke)||void 0===d?void 0:d.Hovered)?yt:mt,Promo:mt,PromoActive:mt,CallToAction:mt,CallToAction2:mt,PromoHovered:mt};return a.jsxs("svg",{width:at?"28":"40",height:at?"36":"48",viewBox:at?"0 0 28 36":"0 0 40 48",fill:"none",xmlns:"http://www.w3.org/2000/svg","data-role":"triangle-plus-svg",children:[a.jsxs(a.Fragment,{children:[a.jsx("path",{d:at?"M4.357 1.726C3.362 1.034 2 1.746 2 2.956v30.087c0 1.212 1.362 1.923 2.357 1.231L25.98 19.231a1.5 1.5 0 0 0 0-2.462L4.357 1.726Z":"M6.1094 2.20442C4.78029 1.31834 3 2.27113 3 3.86852V44.1315C3 45.7289 4.7803 46.6817 6.1094 45.7956L36.3066 25.6641C37.4941 24.8725 37.4941 23.1275 36.3066 22.3359L6.1094 2.20442Z",fill:`url(#${wt})`,stroke:`url(#${ot[t]})`,strokeWidth:"2"}),a.jsx("path",{d:at?"M4.071 2.136a1 1 0 0 0-1.571.82v30.087a1 1 0 0 0 1.571.821l21.625-15.043a1 1 0 0 0 0-1.642L4.07 2.136Z":"M5.83205 2.62044C4.83522 1.95589 3.5 2.67048 3.5 3.86852V44.1315C3.5 45.3295 4.83522 46.0441 5.83205 45.3796L36.0293 25.2481C36.9199 24.6543 36.9199 23.3457 36.0293 22.7519L5.83205 2.62044Z",stroke:`url(#${Ut[t]})`}),at?Ht[t]:Ct[t],Dt&&a.jsx("path",{d:at?"M3 2.957a.5.5 0 0 1 .786-.41L25.41 17.59a.5.5 0 0 1 0 .82L3.786 33.453a.5.5 0 0 1-.786-.41V2.957Z":"M4 3.86863C4 3.06993 4.89015 2.59354 5.5547 3.03657L35.7519 23.1681C36.3457 23.5639 36.3457 24.4363 35.7519 24.8322L5.5547 44.9636C4.89015 45.4067 4 44.9303 4 44.1316V3.86863Z",fill:`url(#${ut})`,fillOpacity:"0.5"}),a.jsx("path",{d:at?"M12.313 16.688v-2.625H9.687v2.624H7.063v2.625h2.625v2.625h2.624v-2.625h2.626v-2.625h-2.626Z":"M17.875 22.125V18.375H14.125L14.125 22.125H10.375V25.875H14.125L14.125 29.625H17.875V25.875H21.625V22.125H17.875Z",fill:"#FEF0CC",opacity:"Disabled"===t?".4":"1"})]}),a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:wt,x1:"16",y1:"49",x2:"15.4244",y2:"-10.9945",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#AA5D0B"}),a.jsx("stop",{offset:"0.161945",stopColor:"#EBC573"}),a.jsx("stop",{offset:"0.266017",stopColor:"#D3923F"}),a.jsx("stop",{offset:"0.361014",stopColor:"#D69847"}),a.jsx("stop",{offset:"0.492138",stopColor:"#E3B866"}),a.jsx("stop",{offset:"0.670549",stopColor:"#E09D1C"}),a.jsx("stop",{offset:"1",stopColor:"#F0ECBA"})]}),a.jsx("linearGradient",{id:dt,x1:"16",y1:"49",x2:"15.4244",y2:"-10.9945",gradientUnits:"userSpaceOnUse",transform:null===(E=null==D?void 0:D.outerStroke)||void 0===E?void 0:E.gradientTransform,children:null===(Q=null===(l=null==D?void 0:D.outerStroke)||void 0===l?void 0:l.Default)||void 0===Q?void 0:Q.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:Et,x1:"16",y1:"49",x2:"15.4244",y2:"-10.9945",gradientUnits:"userSpaceOnUse",transform:null===(P=null==D?void 0:D.outerStroke)||void 0===P?void 0:P.gradientTransform,children:null===(q=null===(y=null==D?void 0:D.outerStroke)||void 0===y?void 0:y.Hovered)||void 0===q?void 0:q.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:lt,x1:"16",y1:"49",x2:"15.4244",y2:"-10.9945",gradientUnits:"userSpaceOnUse",transform:null===(h=null==D?void 0:D.outerStroke)||void 0===h?void 0:h.gradientTransform,children:null===(T=null===(J=null==D?void 0:D.outerStroke)||void 0===J?void 0:J.Activated)||void 0===T?void 0:T.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:Qt,x1:"16",y1:"49",x2:"15.4244",y2:"-10.9945",gradientUnits:"userSpaceOnUse",transform:null===(_=null==D?void 0:D.outerStroke)||void 0===_?void 0:_.gradientTransform,children:null===(V=null===(U=null==D?void 0:D.outerStroke)||void 0===U?void 0:U.Disabled)||void 0===V?void 0:V.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsxs("linearGradient",{id:Zt,x1:"16",y1:"49",x2:"15.4244",y2:"-10.9945",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#AA5D0B"}),a.jsx("stop",{offset:"0.161945",stopColor:"#EBC573"}),a.jsx("stop",{offset:"0.266017",stopColor:"#D3923F"}),a.jsx("stop",{offset:"0.361014",stopColor:"#D69847"}),a.jsx("stop",{offset:"0.492138",stopColor:"#E3B866"}),a.jsx("stop",{offset:"0.670549",stopColor:"#E09D1C"}),a.jsx("stop",{offset:"1",stopColor:"#F0ECBA"})]}),a.jsx("linearGradient",{id:Pt,x1:"16",y1:"49",x2:"15.4244",y2:"-10.9945",gradientUnits:"userSpaceOnUse",transform:null===(s=null==D?void 0:D.innerStroke)||void 0===s?void 0:s.gradientTransform,children:null===(c=null===(F=null==D?void 0:D.innerStroke)||void 0===F?void 0:F.Default)||void 0===c?void 0:c.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:yt,x1:"16",y1:"49",x2:"15.4244",y2:"-10.9945",gradientUnits:"userSpaceOnUse",transform:null===(g=null==D?void 0:D.innerStroke)||void 0===g?void 0:g.gradientTransform,children:null===(A=null===(R=null==D?void 0:D.innerStroke)||void 0===R?void 0:R.Hovered)||void 0===A?void 0:A.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:qt,x1:"16",y1:"49",x2:"15.4244",y2:"-10.9945",gradientUnits:"userSpaceOnUse",transform:null===(Y=null==D?void 0:D.innerStroke)||void 0===Y?void 0:Y.gradientTransform,children:null===(S=null===(L=null==D?void 0:D.innerStroke)||void 0===L?void 0:L.Activated)||void 0===S?void 0:S.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:Xt,x1:"16",y1:"49",x2:"15.4244",y2:"-10.9945",gradientUnits:"userSpaceOnUse",transform:null===(f=null==D?void 0:D.innerStroke)||void 0===f?void 0:f.gradientTransform,children:null===(B=null===($=null==D?void 0:D.innerStroke)||void 0===$?void 0:$.Disabled)||void 0===B?void 0:B.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsxs("linearGradient",{id:mt,x1:"6.59286",y1:"29.7705",x2:"40.0643",y2:"29.7705",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#F8E39B"}),a.jsx("stop",{offset:"0.267728",stopColor:"#EFC558"}),a.jsx("stop",{offset:"0.5",stopColor:"#F8E39B"}),a.jsx("stop",{offset:"0.75",stopColor:"#EFC558"}),a.jsx("stop",{offset:"1",stopColor:"#876A27"})]}),a.jsxs("linearGradient",{id:Gt,x1:"5.5",y1:"22.8421",x2:"36",y2:"22.8421",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#622E04"}),a.jsx("stop",{offset:"0.991667",stopColor:"#291201"})]}),a.jsxs("linearGradient",{id:Nt,x1:"4.80779",y1:"3.19992",x2:"4.80779",y2:"45.0458",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#251101"}),a.jsx("stop",{offset:"1",stopColor:"#291201"})]}),a.jsxs("linearGradient",{id:Wt,x1:"36.9351",y1:"46",x2:"36.9351",y2:"2.17304",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#1E1D1A"}),a.jsx("stop",{offset:"1",stopColor:"#3D3D3D"})]}),a.jsxs("filter",{id:xt,x:"3",y:"1.86694",width:"34.1973",height:"44.2661",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[a.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),a.jsx("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),a.jsx("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),a.jsx("feOffset",{dx:"1",dy:"1"}),a.jsx("feGaussianBlur",{stdDeviation:"2"}),a.jsx("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),a.jsx("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.0833333 0 0 0 0 0.0362153 0 0 0 0 0.00138889 0 0 0 0.7 0"}),a.jsx("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow_75_247"}),a.jsx("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),a.jsx("feOffset",{dx:"-1",dy:"-1"}),a.jsx("feGaussianBlur",{stdDeviation:"2"}),a.jsx("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),a.jsx("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.0823529 0 0 0 0 0.0352941 0 0 0 0 0 0 0 0 0.7 0"}),a.jsx("feBlend",{mode:"normal",in2:"effect1_innerShadow_75_247",result:"effect2_innerShadow_75_247"})]}),a.jsxs("linearGradient",{id:bt,x1:"20.5",y1:"2.823",x2:"20.5",y2:"46",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#CAA453"}),a.jsx("stop",{offset:"1",stopColor:"#80510B"})]}),a.jsxs("filter",{id:nt,x:"3",y:"1.867",width:"34.197",height:"44.266",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[a.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),a.jsx("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),a.jsx("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),a.jsx("feOffset",{dx:"1",dy:"1"}),a.jsx("feGaussianBlur",{stdDeviation:"2"}),a.jsx("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),a.jsx("feColorMatrix",{values:"0 0 0 0 0.0833333 0 0 0 0 0.0362153 0 0 0 0 0.00138889 0 0 0 0.7 0"}),a.jsx("feBlend",{in2:"shape",result:"effect1_innerShadow_729_12319"}),a.jsx("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),a.jsx("feOffset",{dx:"-1",dy:"-1"}),a.jsx("feGaussianBlur",{stdDeviation:"2"}),a.jsx("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),a.jsx("feColorMatrix",{values:"0 0 0 0 0.0823529 0 0 0 0 0.0352941 0 0 0 0 0 0 0 0 0.7 0"}),a.jsx("feBlend",{in2:"effect1_innerShadow_729_12319",result:"effect2_innerShadow_729_12319"})]}),a.jsxs("linearGradient",{id:et,x1:"16.5",y1:"0.822907",x2:"16.5",y2:"44",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#EFC558"}),a.jsx("stop",{offset:"1",stopColor:"#80510B"})]}),a.jsxs("linearGradient",{id:it,x1:"20.5",y1:"3.2",x2:"20.5",y2:"45.046",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#FB360A"}),a.jsx("stop",{offset:"1",stopColor:"#9B2006"})]}),a.jsxs("linearGradient",{id:zt,x1:"5.5",y1:"22.842",x2:"36",y2:"22.842",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#834412"}),a.jsx("stop",{offset:".992",stopColor:"#5A2A06"})]}),a.jsxs("linearGradient",{id:It,x1:"20.5",y1:"2.823",x2:"20.5",y2:"46",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"#D6B97A"}),a.jsx("stop",{offset:"1",stopColor:"#AF6F0F"})]}),a.jsx("linearGradient",{id:ht,x1:"5.5",y1:"22.8421",x2:"36",y2:"22.8421",gradientUnits:"userSpaceOnUse",transform:null===(O=null==D?void 0:D.mainBody)||void 0===O?void 0:O.gradientTransform,children:null===(p=null===(v=null==D?void 0:D.mainBody)||void 0===v?void 0:v.Default)||void 0===p?void 0:p.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:Jt,x1:"5.5",y1:"22.8421",x2:"36",y2:"22.8421",gradientUnits:"userSpaceOnUse",transform:null===(j=null==D?void 0:D.mainBody)||void 0===j?void 0:j.gradientTransform,children:null===(r=null==D?void 0:D.mainBody.Hovered)||void 0===r?void 0:r.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:Tt,x1:"5.5",y1:"22.8421",x2:"36",y2:"22.8421",gradientUnits:"userSpaceOnUse",transform:null===(M=null==D?void 0:D.mainBody)||void 0===M?void 0:M.gradientTransform,children:null===(k=null==D?void 0:D.mainBody.Activated)||void 0===k?void 0:k.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsx("linearGradient",{id:_t,x1:"5.5",y1:"22.8421",x2:"36",y2:"22.8421",gradientUnits:"userSpaceOnUse",transform:null===(tt=null==D?void 0:D.mainBody)||void 0===tt?void 0:tt.gradientTransform,children:null===(Kt=null==D?void 0:D.mainBody.Disabled)||void 0===Kt?void 0:Kt.map((t=>a.jsx("stop",{offset:t.offset,stopColor:t.stopColor},t.stopColor)))}),a.jsxs("linearGradient",{id:ut,x1:"14",y1:"2",x2:"14.5",y2:"46",gradientUnits:"userSpaceOnUse",children:[a.jsx("stop",{stopColor:"white",stopOpacity:"0.7"}),a.jsx("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})]})]})]})},V="baseButtonContainer--d3dd7",s=N.memo((({state:t,isPhone:K,isTablet:D,onClick:G,type:W,customizable:x})=>{const[b,n]=N.useState(!1),[e,i]=N.useState(!1),z="Disabled"===t,I=!D&&!K,Z=N.useCallback((()=>{!z&&I&&n(!0)}),[z,I]),w=N.useCallback((()=>{z||(i(!1),G())}),[z,G]),m=N.useCallback((()=>{z||i(!0)}),[z]),u=K||D?"Small":"Default",d="plus"===W?U:_,E=function(t){switch(t){case"Default":case"Disabled":case"Activated":return t;default:return"Default"}}(t);return a.jsx("div",{className:V,onPointerEnter:Z,onPointerLeave:()=>{n(!1)},onPointerDown:m,onPointerUp:w,children:a.jsx(l.S,{role:`triangle-button-${W}`,isPhone:K,isTablet:D,state:E,size:"adjusting",buttonContent:a.jsx(d,{state:F({state:t,isClicked:e,isHovered:b}),size:u,customizable:x})})})}));function F({state:t,isClicked:K,isHovered:D}){if("Disabled"===t)return"Disabled";if("Default"===t){if(K)return"Activated";if(D)return"Hovered"}if("Promo"===t){if(K)return"PromoActive";if(D)return"PromoHovered"}return"CallToAction"===t&&D?"CallToAction2":t}s.displayName="TriangleButton";const c="container--888fd",g=[{offset:"0%",stopColor:"#876A27"},{offset:"25%",stopColor:"#EFC558"},{offset:"50%",stopColor:"#F8E39B"},{offset:"73.23%",stopColor:"rgb(239, 197, 88)"},{offset:"100%",stopColor:"rgb(248, 227, 155)"}],R=[{offset:"1.79%",stopColor:"#D1B65F"},{offset:"26.54%",stopColor:"#DFB755"},{offset:"47.96%",stopColor:"#FFED8E"},{offset:"71.05%",stopColor:"#CFA043"},{offset:"100%",stopColor:"#9B7827"}],A={mainBody:{Default:[{offset:"0%",stopColor:"#1D2733"},{offset:"100%",stopColor:"#000"}],Activated:[{offset:"0%",stopColor:"#2C3C4E"}],Disabled:[{offset:"9%",stopColor:"#1D1D1D"},{offset:"100%",stopColor:"#252525"}],Hovered:[{offset:"0%",stopColor:"#253241"},{offset:"100%",stopColor:"#121921"}]},innerStroke:{Default:R,Activated:R,Disabled:R,Hovered:R},outerStroke:{Default:g,Disabled:g,Hovered:g,Activated:g}},Y=x.u((({type:t,onClick:K,disabled:D,isPhone:G=!1,isTablet:W=!1,showTooltip:x,tooltipComponent:b})=>{const n=N.useCallback((()=>{if(D&&x)return x()}),[D,x]);return a.jsxs("div",{className:c,[G||W?"onPoniterUp":"onClick"]:n,children:[b,a.jsx(s,{type:t,onClick:K,isPhone:G,isTablet:W,state:D?"Disabled":"Default",customizable:A})]})}),{persistAfterClick:!0,shouldShowImmediately:!0,hasAnchor:!1}),L="xxxtremeBetStake--fc540",S="Phone--51c77",f="betStakeRow--13857",$="Tablet--33a86",B="betStakeInfo--c5f4e",O="betPerSpinText--16af1",v="left--af34f",p="right--13a40",j="baseBet--cb011",r="baseBetValue--63699",M=({currencySymbol:t,isPhone:K,isTablet:D,betPerSpin:x,baseBet:b,isIncreaseEnabled:i,increase:z,isDecreaseEnabled:I,decrease:Z,increaseDisabledTooltip:w,decreaseDisabledTooltip:m})=>{const u=N.useCallback((()=>{W.A("XxxtremeDecrease"),Z()}),[Z]),d=N.useCallback((()=>{W.A("XxxtremeIncrease"),z()}),[z]);return a.jsx("div",{className:G.A(L,{[S]:K,[$]:D}),children:a.jsxs("div",{className:f,children:[a.jsx("div",{className:v,children:a.jsx(Y,{onClick:u,type:"minus",disabled:!I,isPhone:K,isTablet:D,tooltip:m})}),a.jsxs("div",{className:B,children:[a.jsx("div",{className:O,children:n.T("bet.perSpin.uppercase")}),a.jsx(E,{isPhone:K,text:e.ej(x,{currencySymbol:t})}),a.jsxs("div",{className:j,children:[n.T("bet.base"),":",a.jsx("span",{className:r,children:e.ej(b,{currencySymbol:t})})]})]}),a.jsx("div",{className:p,children:a.jsx(Y,{onClick:d,type:"plus",disabled:!i,isPhone:K,isTablet:D,tooltip:w})})]})})},k="bonusList--b1b1b",tt="Phone--2e541",Kt="bonusHeader--c77a4",Dt="bonusItem--89dd9",at="bonusTitle--2a01d",Gt="shadow--874f7",Nt="fill--424e0",Wt="bonusDescription--69c8d",xt=t=>{const{className:K,children:D}=t;return a.jsx("div",{className:G.A(K,k),children:D})},bt=D.p+"images/xxxtreme.63f89595.webp",nt=N.memo((({isPhone:t})=>a.jsxs(xt,{className:G.A({[tt]:t}),children:[a.jsxs("div",{className:G.A(at,{[tt]:t}),children:[a.jsxs("span",{className:Gt,children:[" ",n.T("xxxtremedrawer.xxxtreme.title.uppercase")," "]}),a.jsxs("span",{className:Nt,children:[" ",n.T("xxxtremedrawer.xxxtreme.title.uppercase")," "]})]}),a.jsx("img",{src:bt,className:G.A(Kt,{[tt]:t})}),a.jsxs("div",{className:Dt,children:[a.jsxs("div",{className:Wt,children:["★ ",n.T("xxxtremedrawer.xxxtreme.description.p1.uppercase")," "]}),a.jsxs("div",{className:Wt,children:["★ ",n.T("xxxtremedrawer.xxxtreme.description.p2.uppercase")," "]})]})]}))),et=N.memo((({isPhone:t})=>a.jsxs(xt,{className:G.A({[tt]:t}),children:[a.jsxs("div",{className:G.A(at,{[tt]:t}),children:[a.jsxs("span",{className:Gt,children:[" ",n.T("xxxtremedrawer.superxxxtreme.title.uppercase")," "]}),a.jsxs("span",{className:Nt,children:[" ",n.T("xxxtremedrawer.superxxxtreme.title.uppercase")," "]})]}),a.jsx("img",{src:bt,className:G.A(Kt,{[tt]:t})}),a.jsxs("div",{className:Dt,children:[a.jsxs("div",{className:Wt,children:["★ ",n.T("xxxtremedrawer.superxxxtreme.description.p1.uppercase")," "]}),a.jsxs("div",{className:Wt,children:["★ ",n.T("xxxtremedrawer.superxxxtreme.description.p2.uppercase")," "]})]})]}))),it=D.p+"images/glassmobil.f7cf8ee8.webp",zt=D.p+"images/glass.57f8ac35.webp",It=D.p+"images/starsmobil.39bbdf58.webp",Zt=D.p+"images/stars.638288cd.webp",wt="xxxtremeSelectionMode--11c44",mt="Phone--12710",ut="background--10f98",dt="innerBorder--8fe69",Et="glass--bd090",lt="stars--76d90",Qt="activateButton--f8830",Pt="active-button",yt={XXXtreme:"xxxtreme--13594",SuperXXXtreme:"superxxxtreme--69f97"},qt={XXXtreme:nt,SuperXXXtreme:et},Xt={customizable:{mainLight:{gradient:"linear-gradient(180deg, rgba(252, 252, 252, 0.7) 0%, rgba(252, 252, 252, 0) 56.26%);"},midBody:{strokeColor:"linear-gradient(0deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.3) 100%)",gradient:"linear-gradient(180deg, #1D2733 0%, #000000 100%)"},border:{baseBorderGradient:"linear-gradient(0deg, #F8E296 0%, #EFC353 26.77%, #F8E296 50%, #EFC353 75%, #836726 100%)",midBorderGradient:"linear-gradient(360deg, #A55A0B 0.62%, #EAC36F 16.61%, #D2903B 26.88%, #D59643 36.25%, #E2B662 49.2%, #DC9A1B 66.81%, #EFEBB6 100%)"}}},ht=N.memo((({isPhone:t,isTablet:K,mode:D,betPerSpin:n,baseBet:e,currencySymbol:i,isIncreaseEnabled:z,onIncrease:I,isDecreaseEnabled:Z,onDecrease:w,isSelectionEnabled:m,onSelect:u,getTooltipForDisabled:d})=>{const E=Z?void 0:d(D,"decrease"),l=z?void 0:d(D,"increase"),Q=qt[D],P=N.useCallback((()=>{m&&(W.A("XXXtreme"===D?"XxxtremeActivate":"SuperXxxtremeActivate"),u(D))}),[u,D,m]),y=m?void 0:"tooltip.balanceTooLow",q=!m,X=x.u(b.$,{persistAfterClick:!0,shouldShowImmediately:!0}),h="SuperXXXtreme"===D,J=t?It:Zt,T=t?it:zt;return a.jsxs("div",{className:G.A(wt,{[mt]:t}),"data-role":D,children:[a.jsx("div",{className:dt,children:a.jsxs("div",{className:G.A(ut,yt[D]),children:[h&&a.jsx("img",{src:J,className:lt}),a.jsx("img",{src:T,className:Et}),a.jsx(Q,{isDisabled:q,isPhone:t}),a.jsx(M,{currencySymbol:i,isPhone:t,isTablet:K,betPerSpin:n,baseBet:e,isIncreaseEnabled:z,increase:I,isDecreaseEnabled:Z,decrease:w,decreaseDisabledTooltip:E,increaseDisabledTooltip:l})]})}),a.jsx(X,{role:Pt,label:"activate.uppercase",labelPosition:"Inside",size:"S",fitWidth:!1,onClick:P,tooltip:y,className:G.A(Qt,{[mt]:t}),state:m?"Default":"Disabled",layerStyles:Xt})]})}))},563054:(t,K,D)=>{D.d(K,{e:()=>e});var a=D(377810),G=D(282427),N=D(816340),W=D(232737),x=D(901577),b=D(357223),n=D(541310);function e(t){const K=G.d4(b.Ut),D=x.O(),e=G.d4(b.Y4),i=G.d4(b.FW),z=G.d4(N.F),I=D.currencySymbol.value,Z=W.y(n.fD),w=W.y(n.Ns),m=a.useCallback((K=>{w(K,t),Z()}),[w,Z,t]),u=W.y(n.Ve),d=W.y(n.JC),E=W.y(n.wW),l=W.y(n.GZ),Q=G.d4(b.am),P=G.d4(b.jl),y=G.d4(b.p4),q=G.d4(b.Y$),X=G.d4(b.iQ),h=G.d4(b.V0),J=G.d4(b.sd),T=G.d4(b.KM),_=G.d4(b.p5),C=G.d4(b.vI),H=a.useCallback(((t,K)=>({XXXtreme:{increase:q,decrease:X},SuperXXXtreme:{increase:_,decrease:C}}[t][K])),[_,q,C,X]);return{isOpen:K,onClose:Z,currencySymbol:I,setSpinMode:m,xxxtremeBaseBet:e,decreaseXXXtremeBet:u,increaseXXXtremeBet:d,xxxtremeBetPerSpin:Q,isXXXtremeDecreaseEnabled:P,isXXXtremeIncreaseEnabled:y,disableFeatureBuy:z,superXXXtremeBetPerSpin:h,superXXXtremeBaseBet:i,decreaseSuperXXXtremeBet:E,increaseSuperXXXtremeBet:l,isSuperXXXtremeDecreaseEnabled:J,isSuperXXXtremeIncreaseEnabled:T,getTooltipForDisabled:H}}},927228:(t,K,D)=>{D.d(K,{f:()=>I});var a=D(64922),G=D(699695),N=D(282427),W=D(170877),x=D(357223);const b="topGradient--2785b",n="isPhone--244a6",e="isTablet--19647",i="bottomGradient--680ec",z=({platform:t})=>a.jsxs(a.Fragment,{children:[a.jsx("div",{className:G.A(b,{[n]:t===W.OD.Phone,[e]:t===W.OD.Tablet})}),a.jsx("div",{className:G.A(i,{[n]:t===W.OD.Phone,[e]:t===W.OD.Tablet})})]}),I=t=>N.d4(x.WY)?a.jsx(z,{...t}):null},849279:(t,K,D)=>{D.d(K,{F:()=>i});var a=D(64922),G=D(699695),N=D(282427),W=D(357223);const x="overlay--ff5fb",b="visible--c0686",n="isPhone--2ec89",e=({isVisible:t,isMobile:K})=>a.jsx("div",{className:G.A(x,{[b]:t,[n]:K})}),i=t=>{const K=N.d4(W.WY);return K?a.jsx(e,{isVisible:K,...t}):null}},962578:(t,K,D)=>{D.d(K,{A:()=>Z});var a=D(64922),G=D(699695),N=D(282427),W=D(170877),x=D(357223);const b="topContainer--b3b34",n="topCircleGradient--34234",e="isTablet--9edc4",i="bottomContainer--f8300",z="bottomCircleGradient--7a8ab",I=({platform:t})=>a.jsxs(a.Fragment,{children:[a.jsx("div",{className:b,children:a.jsx("div",{className:G.A(n,{[e]:t===W.OD.Tablet})})}),a.jsx("div",{className:i,children:a.jsx("div",{className:G.A(z,{[e]:t===W.OD.Tablet})})})]}),Z=t=>{const K=N.d4(x.WY),D=N.d4(x.WN);return K&&"SuperXXXtreme"===D?a.jsx(I,{...t}):null}},541310:(t,K,D)=>{D.d(K,{GZ:()=>d,JC:()=>m,Ns:()=>i,S$:()=>l,Ve:()=>w,Y_:()=>E,fD:()=>Z,h$:()=>z,wW:()=>u});var a=D(241665),G=D(730837),N=D(79697),W=D(732990),x=D(301258),b=D(551817),n=D(357223),e=D(510504);function i(t,K){return(D,N,{getAG:b})=>{const i=N(),{betAmounts:z,log:I}=b(),Z=n.WN(i),w=n.BF[t],m=w?"Activated":"Deactivated",u=w?w(i).baseBet:G.xv(i),d=w?w(i).value:G.xv(i);if(I(a.gJ({spinModeFrom:Z,spinModeTo:t,baseBet:u,totalBet:d,status:m,playerGameId:K})),D(e.V(t)),D(W.o(t)),z.setBetModifier(x.n[t]),!w)return;const E=w(i).value;z.selectBetAmount(E)}}function z(t){return K=>{K(i("Normal",t))}}function I(t,K,D=0){const a=K.findIndex((K=>K.baseBet===t));let G=a;if(-1===G)return 0;for(;G>0&&!K[G].enabled;)G--;if(K[G].enabled)return G;G=a;const N=K.length-1;for(;G<N&&!K[G].enabled;)G++;if(K[G].enabled)return G;const W=K.findIndex((t=>t.baseBet>=D));return-1===W?0:W}function Z(){return t=>{t(b._l(!1))}}function w(){return(t,K)=>{const D=K(),a=n.UW(D),G=n.Jd(D);n.KZ(a,G)&&t(b.Wt("XXXtreme",G-1))}}function m(){return(t,K)=>{const D=K(),a=n.UW(D),G=n.Jd(D);n.Ol(a,G)&&t(b.Wt("XXXtreme",G+1))}}function u(){return(t,K)=>{const D=K(),a=n.d0(D),G=n.gQ(D);n.KZ(a,G)&&t(b.Wt("SuperXXXtreme",G-1))}}function d(){return(t,K)=>{const D=K(),a=n.d0(D),G=n.gQ(D);n.Ol(a,G)&&t(b.Wt("SuperXXXtreme",G+1))}}function E(t){return(K,D,{getAG:G})=>{const W=D();if(n.WY(W))K(i("Normal",t));else{const{log:t}=G();t(a.Z6()),K(((t,K,{getAG:D})=>{const a=D(),G=K(),W=a.betAmounts.lastSelectedAmount.value,x=N.Y(G).min,e=I(W,n.UW(G),x),i=I(W,n.d0(G),x);t(b.Wt("XXXtreme",e)),t(b.Wt("SuperXXXtreme",i)),t(b._l(!0))}))}}}function l(t){return(K,D,{getAG:a})=>a().balance.available.subscribe((function(a){const G=D();if(!n.WY(G))return;const N=n.WN(G),W=n.BF[N];W&&W(G).value>a&&K(z(t))}))}},551817:(t,K,D)=>{D.d(K,{Wl:()=>W,Wt:()=>N,_l:()=>G});const a={drawerOpen:!1,baseXXXtremeBetIndex:0,baseSuperXXXtremeBetIndex:0};function G(t){return{type:"XXXtreme/SET_DRAWER_OPEN",payload:t}}function N(t,K){return{type:"XXXtreme/SET_BET_INDEX",payload:{mode:t,index:K}}}function W(t=a,K){switch(K.type){case"XXXtreme/SET_DRAWER_OPEN":return{...t,drawerOpen:K.payload};case"XXXtreme/SET_BET_INDEX":const D=K.payload.index,a="SuperXXXtreme"===K.payload.mode?{baseSuperXXXtremeBetIndex:D}:{baseXXXtremeBetIndex:D};return{...t,...a};default:return t}}},357223:(t,K,D)=>{D.d(K,{BF:()=>F,FW:()=>T,Jd:()=>z,KM:()=>X,KX:()=>_,KZ:()=>P,Ol:()=>Q,UW:()=>u,Ut:()=>Z,V0:()=>l,WN:()=>e,WY:()=>i,Y$:()=>o,Y4:()=>J,am:()=>d,d0:()=>E,gQ:()=>I,iQ:()=>V,jl:()=>q,p4:()=>y,p5:()=>U,sd:()=>h,vI:()=>s});var a=D(160739),G=D(967810),N=D(949570),W=D(87245),x=D(301258),b=D(791839);function n(t){return t.xxxtreme}const e=a.Mz(G.Yq,(t=>"dondSpinMode"in t?t.dondSpinMode:"Normal")),i=a.Mz(e,(t=>"Normal"!==t)),z=a.Mz(n,(t=>t.baseXXXtremeBetIndex)),I=a.Mz(n,(t=>t.baseSuperXXXtremeBetIndex)),Z=a.Mz(n,(t=>t.drawerOpen));function w(t,K,D,a){return D>t?"tooltip.balanceTooLow":K<a.min?"tooltip.minBetReached":K>a.max?"tooltip.maxBetReached":void 0}function m(t,K,D,a){const G=w(t,K,D,a);return Boolean(G)}const u=a.Mz(b.K,N.eu,W.jC,((t,K,D)=>D.map((D=>{const a=D*x.n.XXXtreme;return{value:a,baseBet:D,enabled:!m(K,a,a,t)}})))),d=a.Mz(u,z,((t,K)=>t[K])),E=a.Mz(b.d,N.eu,W.jC,((t,K,D)=>D.map((D=>{const a=D*x.n.SuperXXXtreme;return{value:a,baseBet:D,enabled:!m(K,a,a,t)}})))),l=a.Mz(E,I,((t,K)=>t[K])),Q=(t,K)=>K<t.length-1&&t.slice(K+1).some((t=>t.enabled)),P=(t,K)=>K>0&&t.slice(0,K).some((t=>t.enabled)),y=a.Mz(u,z,Q),q=a.Mz(u,z,P),X=a.Mz(E,I,Q),h=a.Mz(E,I,P),J=a.Mz(u,z,((t,K)=>t[K].baseBet)),T=a.Mz(E,I,((t,K)=>t[K].baseBet)),_=a.Mz(u,E,((t,K)=>t.some((t=>t.enabled))||K.some((t=>t.enabled))));function C(t,K,D,a){const G=t[K+1];return void 0===G||!G.enabled&&a>=G.value?"tooltip.maxBetReached":w(a,G.baseBet,G.value,D)}function H(t,K,D,a){const G=t[K-1];return void 0===G?"tooltip.minBetReached":w(a,G.baseBet,G.value,D)}const o=a.Mz(u,z,b.K,N.eu,C),U=a.Mz(E,I,b.d,N.eu,C),V=a.Mz(u,z,b.K,N.eu,H),s=a.Mz(E,I,b.d,N.eu,H),F={XXXtreme:d,SuperXXXtreme:l}},510504:(t,K,D)=>{D.d(K,{V:()=>G,m:()=>N});const a="XXXtreme/signal/SPIN_MODE_CHANGED";function G(t){return{type:a,spinMode:t}}function N(t){return"object"==typeof t&&null!==t&&"type"in t&&t["type"]===a}},732990:(t,K,D)=>{D.d(K,{R:()=>N,o:()=>W});var a=D(499532),G=D(717236);function N(t="dealnodeal",K){return{dondSpinMode:{storageKey:G.$9({game:t,platform:"Common",key:"spinMode",isRng:!!K}),isValidValue(t){return"string"==typeof(K=t)&&"Normal"===K||"XXXtreme"===K||"SuperXXXtreme"===K;var K},getDefaultValue:()=>"Normal"}}}const W=t=>a.$7({key:"dondSpinMode",value:t})},301258:(t,K,D)=>{D.d(K,{n:()=>a});const a={Normal:1,XXXtreme:15,SuperXXXtreme:75}},791839:(t,K,D)=>{D.d(K,{K:()=>b,d:()=>n});var a=D(160739),G=D(301258),N=D(443505),W=D(13799),x=D(87245);const b=a.Mz(W.DB,N.B,x.jC,((t,K,D)=>{const a=D.map((t=>t*G.n.XXXtreme)).filter((D=>D>=K.min&&D>=t.qualificationSpinMinBet()*G.n.XXXtreme&&D<=K.max&&D<=t.qualificationSpinMaxBet()*G.n.XXXtreme));return{min:Math.min(...a),max:Math.max(...a)}})),n=a.Mz(W.DB,N.B,x.jC,((t,K,D)=>{const a=D.map((t=>t*G.n.SuperXXXtreme)).filter((D=>D>=K.min&&D>=t.qualificationSpinMinBet()*G.n.SuperXXXtreme&&D<=K.max&&D<=t.qualificationSpinMaxBet()*G.n.SuperXXXtreme));return{min:Math.min(...a),max:Math.max(...a)}}))},992486:(t,K,D)=>{D.d(K,{a:()=>wK});var a=D(377810),G=D(282427),N=D(442914),W=D(923968),x=D(901577),b=D(238733),n=D(853964),e=D(465082),i=D(977927),z=D(422194),I=D(332635),Z=D(315049),w=D(923148);const m=2e3,u=1e3;class d{constructor(){this.isWinAnimationShowing=!1}async runShowCyclically(t,K,D){for(const a of t){if(!this.isWinAnimationShowing)return;D(),K(a),await w.u(m)}this.isWinAnimationShowing&&this.runShowCyclically(t,K,D)}async runShowOnce(t,K,D){for(const D of t)K(D);await w.u(m),null==D||D()}showAnimation(){this.isWinAnimationShowing=!0}hideAnimation(){this.isWinAnimationShowing=!1}async waitForAnimation({paylineIds:t,qualified:K,winlineAnimationMode:D}){0!==t.length&&("OneAnimation"===D&&await w.u(m),"CyclingAnimation"===D&&K&&await w.u(m*t.length))}}var E=D(730996);const l=[0,1,2,3,4],Q={0:[1,1,1],1:[0,0,0],2:[2,2,2],3:[0,1,2],4:[2,1,0]};function P(t){return 3===t||4===t}function y(t){return t.map((t=>t.payLine))}var q=D(737697),X=D(276111),h=D(769413),J=D(439893);const T=.77,_=.02,C=.02,H=.05,o=0,U=50,V=1+1,s=4,F=1900,c=1350,g=2,R=.3,A=1e3;class Y extends b.mcf{constructor({assets:t,gameDimensions:K,winlineManager:D}){super(),this.separatorsContainer=this.addChild(new b.mcf),this.superXxxxtremeSeparatorsContainer=this.addChild(new b.mcf),this.separators=[],this.xxxtremeSeparators=[],this.winlines={},this.separatorsAttentionNormal=[],this.separatorsAttentionXxxtreme=[],this.separatorsAttentionCancellation=new J.X,this.gameDimensions=K,this.winlineManager=D,this.separatorsContainer.label="separatorContainer",this.superXxxxtremeSeparatorsContainer.label="xxxtremeSeparatorContainer";for(let K=0;K<s;K++){const K=new b.mcf,D=b.kxk.from(t.separator);D.anchor.set(.5,0);const a=b.kxk.from(t.separatorsAttention.normal);a.anchor.set(.5,0),a.scale.set(g),this.separatorsAttentionNormal.push(a);const G=b.kxk.from(t.separatorsAttention.xxxtreme);G.anchor.set(.5,0),G.scale.set(g),this.separatorsAttentionXxxtreme.push(G),this.xxxtremeSeparators.push(this.superXxxxtremeSeparatorsContainer.addChild(t.xxxtremeSeparator())),K.addChild(D,a,G),this.separatorsContainer.addChild(K),this.separators.push(K)}this.winlineContainer=new b.mcf,this.winlineContainer.label="winlineContainer",this.addChild(this.winlineContainer),this.x=(this.gameDimensions.appSize.width-this.gameDimensions.slotSize.width)/2;const{appSize:a,slotSize:G}=this.gameDimensions,N=a.height*T/2;this.y=N-G.height/2;for(const K of t.winlines)for(const t of l){const D=b.kxk.from(K);D.anchor.set(.5,.5),D.alpha=0,this.winlineContainer.addChild(D);const a=K.label;if(!E.Es.includes(a))throw new Error(`Asset ID doesn't match the possible symbol types: ${a} was not found among ${E.Es}`);void 0===this.winlines[a]&&(this.winlines[a]={}),this.winlines[a][t]=D}this.backgroundImage=this.addChild(new b.QL7({texture:t.background,leftWidth:40,rightWidth:40,topHeight:60,bottomHeight:60,width:1.2*G.width,height:1.2*G.height})),this.updateTheme("Normal"),this.hideSeparatorsAttentions("Normal"),this.hideSeparatorsAttentions("XXXtreme")}adjustLayout(){const{symbolSize:t,slotSize:K}=this.gameDimensions;this.x=(this.gameDimensions.appSize.width-this.gameDimensions.slotSize.width)/2;const D=1300,a=1.2,G=(K.height-this.gameDimensions.slotReelHeight)/2,N=K.height/F;this.separators.forEach(((t,D)=>{t.visible=this.gameDimensions.separatorsLayout[D],t.scale.set(N),t.y=G,t.x=K.width/2}));const W=_*K.width,x=C*K.width;this.separators[1].x+=-t.width/2-W/2,this.separators[2].x+=t.width/2+x/2,this.separators[0].x=this.separators[1].x-t.width-W,this.separators[3].x=this.separators[2].x+t.width+x;const b=3*t.width*(1-H),n=K.height/c;this.xxxtremeSeparators.forEach(((t,D)=>{t.visible=this.gameDimensions.separatorsLayout[D],t.scale.set(n),t.x=this.separators[D].x,t.y=K.height/2}));const e=this.backgroundImage.leftWidth+this.backgroundImage.rightWidth-30,i=this.backgroundImage.topHeight+this.backgroundImage.bottomHeight;this.backgroundImage.x=-e/2,this.backgroundImage.y=-i/2,this.backgroundImage.width=K.width+e,this.backgroundImage.height=K.height+i;for(const t of Object.values(this.winlines))for(const[G,N]of Object.entries(t)){const t=Number(G),W=P(t),x=b*(W?a:1)/D,n=x;if(N.scale.set(x,n),N.x=K.width/2,W)N.y=K.height/2,N.rotation=37*Math.PI/180*(3===t?1:-1);else{N.y=K.height/2;const D=1===t?-1:2===t?1:0;N.y+=this.gameDimensions.slotReelRowHeight*D}}}dispose(){this.destroy()}async showWinlines({paylineIds:t,outcome:K,winlineAnimationMode:D}){const a=function(t,K){return t.map((t=>{const D=Q[t].map(((t,D)=>K[D][t])).reduce(((t,K)=>E.pq(K)?{...t,wildCount:t.wildCount+1}:{...t,notWildSymbol:K}),{wildCount:0,notWildSymbol:void 0});return{paylineID:t,symbolType:D.wildCount>1?"Wild":E.PE(D.notWildSymbol||4)}}))}(t,K),G=t=>{this.winlines[t.symbolType][t.paylineID].alpha=1};"OneAnimation"===D?this.winlineManager.runShowOnce(a,G):(await this.winlineManager.runShowOnce(a,G),this.winlineManager.runShowCyclically(a,G,this.hideWinlines.bind(this)))}updateTheme(t){this.separatorsContainer.visible="SuperXXXtreme"!==t,this.superXxxxtremeSeparatorsContainer.visible="SuperXXXtreme"===t,this.backgroundImage.visible="SuperXXXtreme"===t}hideWinlines(){for(const t of Object.values(this.winlines))for(const K of Object.values(t))K.alpha=0}stopSeparatorsAttentions(){this.separatorsAttentionCancellation.cancel()}playSeparatorsAttentions(t){this.separatorsAttentionCancellation.cancel(),this.separatorsAttentionCancellation=new J.X,this.playSingleSeparatorsAttention(t);const K=setInterval((()=>{this.playSingleSeparatorsAttention(t)}),A+1e3*R);this.separatorsAttentionCancellation.addListener((()=>{clearInterval(K)}))}hideSeparatorsAttentions(t){const K=this.getSeparatorsAttentionsForGameMode(t),D=F/3+2*this.gameDimensions.symbolSize.height;K.forEach((t=>{t.visible=!1,t.position.set(0,D)}))}playSingleSeparatorsAttention(t){const K=this.getSeparatorsAttentionsForGameMode(t);K.forEach((t=>{t.visible=!0}));const D=F/3+2*this.gameDimensions.symbolSize.height,a=h.M({y:D});a.animateTo({y:0},R,X.sn).onUpdate((({y:t})=>{K.forEach((K=>{K.position.set(0,t)}))})).onDispose((()=>{this.hideSeparatorsAttentions(t)})),Z.l({anim:a,dispose:!0})}getSeparatorsAttentionsForGameMode(t){return"SuperXXXtreme"===t?[]:"Normal"===t?this.separatorsAttentionNormal:this.separatorsAttentionXxxtreme}}class L extends b.mcf{constructor(t,K,D=!0){if(super(),this.textLayers=[],D){const D=new b.T7$({text:t,style:{fontFamily:"GoldenTextBack",fontSize:K},label:"shadowText"});D.anchor.set(.5),this.textLayers.push(D),this.addChild(D)}const a=new b.T7$({text:t,style:{fontFamily:"GoldenText",fontSize:K},label:"mainText"});a.anchor.set(.5),this.textLayers.push(a),this.addChild(a),this.adjustLayout(K)}set text(t){this.textLayers.forEach((K=>{K.text=t}))}dispose(){this.textLayers.forEach((t=>{t.destroy()}))}adjustLayout(t){this.textLayers.forEach((K=>{K.style.fontSize=t}))}}var S=D(587698);const f=.4;class $ extends b.mcf{constructor({gameDimensions:t,winlineManager:K,currencySymbol:D}){super(),this.gameDimensions=t,this.winlineManager=K,this.currencySymbol=D,this.winAmountContainer=new b.mcf,this.winAmountContainer.label="winAmountContainer",this.addChild(this.winAmountContainer);const{symbolSize:a}=this.gameDimensions;this.winAmountText=new L("",a.width*f,!0),this.winAmountText.alpha=0,this.winAmountContainer.addChild(this.winAmountText)}adjustLayout(){const{appSize:t,symbolSize:K,slotSize:D}=this.gameDimensions,a=t.width;this.winAmountText.adjustLayout(K.width*f);const G=t.height*T/2-D.height/2+this.gameDimensions.slotReelRowHeight;this.winAmountText.x=a/2,this.winAmountText.y=G}dispose(){this.destroy(),this.winAmountText.destroy()}hideWinAmounts(){this.hideCurrentWinAmount()}async showWinAmounts({paylinesAndPayouts:t,winlineAnimationMode:K,winAmount:D,autoplay:a}){const{appSize:G,slotSize:N}=this.gameDimensions,W=G.height*T/2-N.height/2+this.gameDimensions.slotReelRowHeight;let x;(function(t){t[t["Top"]=0]="Top",t[t["Center"]=1]="Center",t[t["Bottom"]=2]="Bottom"})(x||(x={}));const b=(t,K,D,a,G)=>{D.y=W+K*this.gameDimensions.slotReelRowHeight,D.text=S.ej(t,{currencySymbol:a}),this.winAmountTimeoutId=setTimeout((()=>{D.alpha=1}),G)},n=t=>{this.winAmountText.scale.set(1,1),b(t,x.Center,this.winAmountText,this.currencySymbol,500)};"OneAnimation"===K?this.winlineManager.runShowOnce([D],n):(await this.winlineManager.runShowOnce([D],n),t.length>1&&(a||this.winlineManager.runShowCyclically(t,(t=>{const K=Q[t.payLine][1];this.winAmountText.scale.set(.7,.7),b(t.payout,K,this.winAmountText,this.currencySymbol,500)}),this.hideCurrentWinAmount.bind(this))))}hideCurrentWinAmount(){this.winAmountText.alpha=0,clearTimeout(this.winAmountTimeoutId)}}var B=D(170877),O=D(436794),v=D(145331);const p=[!0,!0,!0,!0],j=[!1,!0,!0,!1],r=1,M=1.3,k=2,tt=2.5;class Kt{constructor(t,K){this.sourceAppSize=t,this.device=K}get appSize(){return this.sourceAppSize}get slotSize(){return{width:this.slotWidth,height:this.slotHeight}}get slotReelHeightRatio(){const t=6*H;return this.slotSize.height/(this.symbolSize.height*(1+t))+o}get slotReelHeight(){const t=this.slotReelHeightRatio-o;return this.symbolSize.height*t}get slotReelRowHeight(){return this.slotReelHeight/3}get symbolSize(){const t=this.slotWidth/v.AX;return{width:t*(1-H),height:t*(1-H)}}get separatorsLayout(){return this.device.platform===B.OD.Tablet||this.device.platform===B.OD.Phone?j:p}get divisor(){return"Phone"===this.device.platform?r:"Tablet"===this.device.platform?this.device.orientation.value===O.t.Portrait?M:k:tt}get reelsYPosition(){const{appSize:t,symbolSize:K,slotSize:D}=this;return t.height*T/2-D.height/2+K.height}get reelsXPosition(){const t=_*this.slotSize.width,K=C*this.slotSize.width,D=this.slotSize.width/2-this.symbolSize.width/2;return[D-this.symbolSize.width-t,D,D+this.symbolSize.width+K]}get slotWidth(){return this.sourceAppSize.width/this.divisor}get slotHeight(){return this.symbolSize.height*v.oW}}var Dt=D(9676);const at="in vec2 aPosition;out vec2 vLightsweepTextureCoord;out vec2 vTextureCoord;uniform vec4 uInputSize;uniform vec4 uOutputFrame;uniform vec4 uOutputTexture;vec4 filterVertexPosition(void){vec2 position=aPosition*uOutputFrame.zw+uOutputFrame.xy;position.x=position.x*(2./uOutputTexture.x)-1.;position.y=position.y*(2.*uOutputTexture.z/uOutputTexture.y)-uOutputTexture.z;return vec4(position,0.,1.);}vec2 filterTextureCoord(void){return aPosition*(uOutputFrame.zw*uInputSize.zw);}void main(void){vec4 vertexPosition=filterVertexPosition();float multiplier=-((uOutputTexture.x/uOutputTexture.y)/0.5);vLightsweepTextureCoord=(vec2(vertexPosition.x*multiplier,vertexPosition.y)+vec2(1.,1.))*0.5;gl_Position=vertexPosition;vTextureCoord=filterTextureCoord();}",Gt="uniform sampler2D uLightSweep;uniform float uProgress;uniform sampler2D uTexture;in vec2 vTextureCoord;in vec2 vLightsweepTextureCoord;out vec4 finalColor;void main(){vec2 movement=vec2(-1.,0.)+vec2(1.,0.)*uProgress;vec4 lightColor=texture2D(uLightSweep,vLightsweepTextureCoord+movement);vec4 textureColor=texture(uTexture,vTextureCoord);finalColor=mix(textureColor,lightColor,textureColor.a*lightColor.a);}",Nt=1;class Wt{constructor(t){this.filter=this.setupLightSweepFilter(t),this.cancellation=new J.X}async playSweepInterval(t=!1){this.cancellation.cancel(),this.cancellation=new J.X;const K=Dt.W.lightSweepAnimationInterval();t&&this.playSweep();const D=setInterval((()=>{this.cancellation.isCancelled||this.playSweep()}),K);this.cancellation.addListener((()=>clearInterval(D)))}stopSweep(){this.cancellation.cancel()}addFilterToContainer(t){t.filters=[this.filter]}async playSweep(){if(this.cancellation.isCancelled)return;const t=h.M({x:0});t.animateTo({x:2},Nt,X.dV).onUpdate((({x:t})=>{this.filter.resources.base.uniforms.uProgress=t})).onDispose((()=>{this.resetFilterUniforms()}));const K=Z.l({anim:t,dispose:!0});this.cancellation.addListener((()=>{K(),this.resetFilterUniforms()}))}setupLightSweepFilter(t){return new b.dJT({glProgram:new b.M2g({fragment:Gt,vertex:at}),resources:{base:{uProgress:{value:0,type:"f32"}},uLightSweep:t.source}})}resetFilterUniforms(){this.filter.resources.base.uniforms.uProgress=0}}var xt=D(652958),bt=D(654560),nt=D(721120);class et{constructor(t){this.value=t,this.next=void 0}}class it{get length(){return this._length}constructor(){this.head=void 0,this.tail=void 0,this._length=0}enqueue(t){const K=new et(t);this.head?this.tail&&(this.tail.next=K,this.tail=K):(this.head=K,this.tail=K),this._length++}dequeue(){if(!this.head)return;const t=this.head.value;return this.head=this.head.next,this._length--,t}clear(){this.head=void 0,this.tail=void 0,this._length=0}isEmpty(){return 0===this._length}}var zt,It=D(885580),Zt=D(746380),wt=D(206288);function mt(t,K){return"forward"===K?ut(t)+t.preBufferSize*Et(t).y:dt(t)-t.preBufferSize*Et(t).y}function ut(t){switch(t.alignment){case bt.bj.Bottom:return t.visibleHeight;case bt.bj.Center:return.5*t.visibleHeight;case bt.bj.Top:return 0;default:return.5*t.visibleHeight}}function dt(t){switch(t.alignment){case bt.bj.Bottom:return 0;case bt.bj.Center:return.5*-t.visibleHeight;case bt.bj.Top:return-t.visibleHeight;default:return.5*-t.visibleHeight}}function Et(t){const K={x:1,y:1};return t.normalizeTo===bt.He.ReelHeight&&(K.y=t.visibleHeight/t.symbolCount),K}function lt(t,K){return yt(t)>=K}function Qt(t,K){return Pt(t)<=K}function Pt(t){return t.position.y+.5*t.dimensions.y}function yt(t){return t.position.y-.5*t.dimensions.y}function qt(t,K){const D=t.buffer;let a=D.length-1,G=0;for(let t=a;t>=K;--t)if(void 0!==D[t]){G=t+K;for(let t=a;t<=G;++t)D.push(void 0),a=D.length-1;break}for(let t=a;t>=K;--t)D[t]=D[t-K];for(let t=0;t<K;++t)D[t]=void 0}function Xt(t,K){if(K<=0)return;const{buffer:D}=t.data,a=Math.min(K,D.length);for(let K=0;K<a;K++)ht(t,D[K]);D.splice(0,a);for(let t=0;t<a;t++)D.push(void 0)}function ht(t,K){return void 0!==K&&(K.isDead=!0,t.destroySymbol(K),!0)}function Jt(t,K,D){const a=t.data.buffer,G=t.data.bufferSize-1;let N=G;for(let t=G;t>=0;t--)if(void 0!==a[t]){N=t;break}if(N===G)return-1;const W=N+1,x=t.setSymbolByID(K,W,bt.nU.Absolute,D),b=a[N];return void 0!==b&&(x.position.y=b.position.y-.5*b.dimensions.y-.5*x.dimensions.y,x.synchronize({x:0,y:0})),W}function Tt(t,K,D){let a=0;const G=t.data.buffer,N=t.data.bufferSize;for(let t=0;t<N;++t)if(void 0!==G[t]){a=t;break}if(0===a){const G=mt(t.data,"forward"),N=t.setSymbolByID(K,a,bt.nU.Absolute,D);return N.position.y=G+.5*N.dimensions.y,0}const W=a-1,x=t.setSymbolByID(K,W,bt.nU.Absolute,D),b=G[a];return void 0!==b&&(x.position.y=b.position.y+.5*b.dimensions.y+.5*x.dimensions.y),W}function _t(t){return t.data.preBufferSize+t.data.symbolCount}function Ct(t){const K=t.data.preBufferSize,D=t.data.buffer;for(let a=0;a<K;++a)ht(t,D[a]),D[a]=void 0}function Ht(t,K){return"backward"===K?ut(t)+t.preBufferSize*Et(t).y:dt(t)-t.preBufferSize*Et(t).y}class ot{get data(){return this.reel.data}constructor(t,K){this.reel=t,this.onOutcomeAppeared=K}onStopSpin(t){return"forward"===t?this.data.outcome.length:0}appendOutcomeSymbols(t,K){const D=this.data.outcome,a=this.data.bufferSize-this.data.postBufferSize,G=this.data.buffer;let N=t,W=G[a];const x=mt(this.data,K);for(;(void 0===W||lt(W,x))&&!(N>=D.length);){const t=D[N];Xt(this.reel,1);const x=Jt(this.reel,t,{dimensions:0===this.data.outcomeDimensions.length||this.data.normalizeTo===bt.He.ReelHeight?Et(this.data):this.data.outcomeDimensions[N],landingPosition:{reelIndex:this.reel.id,symbolIndex:N},isOutcome:!0});if(x>-1){const t=G[x];this.clampAppendedSymbolPosition(t,Ht(this.data,K)),0===N&&this.onOutcomeAppeared(t)}W=G[a],N+=1}if(N>=D.length){Xt(this.reel,this.data.postBufferSize);for(let t=0;t<this.data.postBufferSize;t++){const t=this.reel.reelStrip.getNextSymbol(It.H.Forwards),D=G[Jt(this.reel,t.id,{dimensions:t.dimensions,landingPosition:{reelIndex:this.reel.id,symbolIndex:NaN,reelsetName:this.reel.reelsetName},isOutcome:!1})];this.clampAppendedSymbolPosition(D,Ht(this.data,K))}}return N}prependOutcomeSymbols(t,K){var D;if(t<0)return t;const a=this.data.outcome,G=this.data.preBufferSize-1,N=this.data.buffer;let W=N[G];const x=mt(this.data,K);let b=t;for(;(void 0===W||lt(W,x))&&(b-=1,!(b<0));){const t=a[b];qt(this.data,1);const D=Tt(this.reel,t,{dimensions:0===this.data.outcomeDimensions.length||this.data.normalizeTo===bt.He.ReelHeight?Et(this.data):this.data.outcomeDimensions[b],landingPosition:{reelIndex:this.reel.id,symbolIndex:b,reelsetName:this.reel.reelsetName},isOutcome:!0});if(D>-1){const t=N[D];this.clampPrependedSymbolPosition(t,Ht(this.data,K)),b===a.length-1&&this.onOutcomeAppeared(t)}W=N[G]}if(b<0){qt(this.data,this.data.preBufferSize);for(let t=0;t<this.data.preBufferSize;++t){let a=this.reel.reelStrip.getNextSymbol(It.H.Backwards);for(;null===(D=a.dimensions)||void 0===D?void 0:D.colossalData;){const K=this.data.preBufferSize-t,D=a.dimensions.colossalData,G=D.colossalSize.y-D.positionInColossalSpace.y;if(K>=G)break;this.reel.reelStrip.applyIndexOffset(-(G-1)),a=this.reel.reelStrip.getNextSymbol(It.H.Backwards)}const G=N[Tt(this.reel,a.id,{dimensions:a.dimensions,landingPosition:{reelIndex:this.reel.id,symbolIndex:NaN,reelsetName:this.reel.reelsetName},isOutcome:!1})];this.clampPrependedSymbolPosition(G,Ht(this.data,K))}}return b}clampAppendedSymbolPosition(t,K){t&&lt(t,K)&&(t.position.y=K)}clampPrependedSymbolPosition(t,K){t&&Qt(t,K)&&(t.position.y=K)}}class Ut{get data(){return this.reel.data}constructor(t,K){this.reel=t,this.onOutcomeAppeared=K,this.nudgeQueue=new it}onStopSpin(t,K){const D="forward"===t,a=this.data.outcome.length,G=Math.max(K-a,0),N=0===G?this.applyPartialSpin(t,K):this.applyFullSpin(t);this.enqueueFillerSymbols(G,t),D?this.enqueuePrependOutcome(N):this.enqueueAppendOutcome(N);const W=D?this.data.preBufferSize:this.data.postBufferSize;if(this.enqueueFillerSymbols(W,t),D)this.refSymbol=this.data.buffer[this.data.preBufferSize],Ct(this.reel);else{this.refSymbol=this.data.buffer[_t(this.reel)-1];const t=_t(this.reel);this.data.buffer.splice(t)}return N}appendOutcomeSymbols(t,K){const D=mt(this.data,K);if(this.refSymbol&&!lt(this.refSymbol,D))return t;let a=t;for(;!this.nudgeQueue.isEmpty();){const t=this.nudgeQueue.dequeue();if(!t)return a;t.position={x:0,y:this.refSymbol?this.refSymbol.position.y-this.refSymbol.dimensions.y:D},this.data.buffer.push(t),this.spawnSymbol(t),this.refSymbol=t,t.isOutcome&&(a+=1)}return a}prependOutcomeSymbols(t,K){const D=mt(this.data,K);if(this.refSymbol&&!Qt(this.refSymbol,D))return t;const a=this.nudgeQueue.dequeue();if(!a)return t;a.position={x:0,y:this.refSymbol?this.refSymbol.position.y+this.refSymbol.dimensions.y:D},this.data.buffer[0]&&qt(this.data,1),this.data.buffer[0]=a,this.spawnSymbol(a),this.refSymbol=a;const G=a.isOutcome?t-1:t;for(;G<0&&!this.nudgeQueue.isEmpty();){const t=this.nudgeQueue.dequeue();if(!t)break;t.position={x:0,y:this.refSymbol?this.refSymbol.position.y+this.refSymbol.dimensions.y:D},this.data.buffer[0]&&qt(this.data,1),this.data.buffer[0]=t,this.spawnSymbol(t),this.refSymbol=t}return G}applyPartialSpin(t,K){return"forward"===t?this.applyPartialSpinForward(K):this.applyPartialSpinBackward(K)}applyPartialSpinForward(t){const K=this.data.outcome.length;for(const D of this.data.buffer){if(void 0===D||Number.isNaN(D.landingPosition.symbolIndex))continue;const a=D.landingPosition.symbolIndex+t,G=a>K-1?NaN:a;D.landingPosition={reelIndex:this.reel.id,symbolIndex:G,reelsetName:this.reel.reelsetName},G===this.data.outcome.length-1&&this.onOutcomeAppeared(D)}return Ct(this.reel),t-1}applyPartialSpinBackward(t){for(const K of this.data.buffer){if(void 0===K||Number.isNaN(K.landingPosition.symbolIndex))continue;const D=K.landingPosition.symbolIndex-t,a=D<0?NaN:D;K.landingPosition={reelIndex:this.reel.id,symbolIndex:a,reelsetName:this.reel.reelsetName},0===a&&this.onOutcomeAppeared(K)}return function(t){const K=t.data.preBufferSize,D=t.data.buffer;for(let a=K+t.data.symbolCount;a<D.length;++a)ht(t,D[a]),D[a]=void 0}(this.reel),this.data.outcome.length-t}applyFullSpin(t){const K=this.data.outcome.length;return"forward"===t?K-1:0}spawnSymbol(t){this.reel.initSymbol(t),t.onSpawn(),t.synchronize({x:0,y:0}),t.isOutcome&&this.onOutcomeAppeared(t)}enqueueAppendOutcome(t){const K=this.data.outcome.length;for(let D=t;D<K;D++){const t=this.data.outcome[D],K=this.data.pool.pop(t);K.dimensions=0===this.data.outcomeDimensions.length||this.data.normalizeTo===bt.He.ReelHeight?Et(this.data):this.data.outcomeDimensions[D],K.landingPosition={reelIndex:this.reel.id,symbolIndex:D,reelsetName:this.reel.reelsetName},K.isOutcome=!0,this.nudgeQueue.enqueue(K)}}enqueuePrependOutcome(t){for(let K=t;K>=0;K--){const t=this.data.outcome[K],D=this.data.pool.pop(t);D.dimensions=0===this.data.outcomeDimensions.length||this.data.normalizeTo===bt.He.ReelHeight?Et(this.data):this.data.outcomeDimensions[K],D.landingPosition={reelIndex:this.reel.id,symbolIndex:K,reelsetName:this.reel.reelsetName},D.isOutcome=!0,this.nudgeQueue.enqueue(D)}}enqueueFillerSymbols(t,K){var D;for(let a=0;a<t;a++){const t="forward"===K?this.reel.reelStrip.getNextSymbol(It.H.Backwards):this.reel.reelStrip.getNextSymbol(It.H.Forwards),a=this.data.pool.pop(t.id);a.dimensions=null!==(D=t.dimensions)&&void 0!==D?D:Et(this.data),a.landingPosition={reelIndex:this.reel.id,symbolIndex:NaN,reelsetName:this.reel.reelsetName},a.isOutcome=!1,this.nudgeQueue.enqueue(a)}}}(function(t){t[t["Normal"]=0]="Normal",t[t["Nudge"]=1]="Nudge"})(zt||(zt={}));const Vt="NudgableSpin";class st extends wt.${get direction(){return this._direction}set direction(t){if(this.data.postBufferSize!==this.data.preBufferSize)throw new Error("Non-symmetric buffers are not yet supported.");t!==this._direction&&(this._direction=t,this.trimBufferToSize(),this.reverseBuffer())}get startBounceFactor(){return this.currentConfig.startBounceFactor}get stopBounceFactor(){return this.currentConfig.stopBounceFactor}get endBounceFunction(){const t=this.currentConfig.bounceType;return this.getEndBounceFunction(t)}get numberOfBounces(){var t;return null!==(t=this.currentConfig.numberOfBounces)&&void 0!==t?t:0}get deaccelerationDistance(){var t;return null!==(t=this.currentConfig.deaccelerationDistance)&&void 0!==t?t:0}get deaccelerationFinalVelocity(){var t;return null!==(t=this.currentConfig.deaccelerationFinalVelocity)&&void 0!==t?t:0}get nudgeAmount(){return this._nudgeAmount}set nudgeAmount(t){this._nudgeAmount=t}get currentConfig(){return this.spinMode===zt.Normal?this.normalConfig:this.nudgeConfig}constructor(t,K){var D,a,G,N;super(t,Vt),this.velocity=0,this.outcomeSymbolToAddIndex=0,this.accumulatedDistance=0,this.despawnPoint=0,this.isOutcomeLanding=!1,this.accumulatedBounceDistance=0,this.stopBounceThreshold=0,this.hasBounced=!1,this.lowestOutcomeSymbol=void 0,this.endBounceFunctions=[this.singleBounce,this.multipleBounce,this.ballBounce],this.deaccelerationThreshold=0,this.currentAcceleration=0,this.hasStartedDeaccelerating=!1,this.currentDeaccelerationVelocity=0,this.spinMode=null!==(D=K.spinModeId)&&void 0!==D?D:zt.Normal,this.normalConfig=K.normal,this.nudgeConfig=null!==(a=K.nudge)&&void 0!==a?a:K.normal,this._direction=null!==(G=K.direction)&&void 0!==G?G:"forward",this._nudgeAmount=null!==(N=this.nudgeConfig.nudgeAmount)&&void 0!==N?N:0,this.preOutcomeQueue=new it,this.normalSpinMode=new ot(this.reel,this.onOutcomeAppeared.bind(this)),this.nudgeSpinMode=new Ut(this.reel,this.onOutcomeAppeared.bind(this))}onActivate(){this.onOutcomeUpdated()}onOutcomeUpdated(){this.despawnPoint=this.calculateDespawnPoint()}onStartSpin(){this.lowestOutcomeSymbol=void 0,this.despawnPoint=this.calculateDespawnPoint(),this.data.targetHighestPointOffset=-Number.MAX_VALUE,this.accumulatedDistance=0,this.accumulatedBounceDistance=0,this.data.spinTimer.stopTime=this.startBounceDuration,this.fillWithReelStripSymbols(),this.reel.reelStrip.applyIndexOffset(-this.data.preBufferSize-this.data.postBufferSize),this.snap(),this.hasBounced=!1,this.hasStartedDeaccelerating=!1,this.stopBounceThreshold=Number.POSITIVE_INFINITY,this.deaccelerationThreshold=Number.POSITIVE_INFINITY,this.currentDeaccelerationVelocity=Number.POSITIVE_INFINITY,this.currentAcceleration=Number.POSITIVE_INFINITY;const t=this.data.buffer,K=t.length;for(let D=0;D<K;++D){const K=t[D];void 0!==K&&void 0!==K.onStartSpin&&K.onStartSpin()}}startSpin(){const t=this.accumulatedBounceDistance,K=nt.ub(this.startBounceFactor,this.data.spinTimer.progress);this.accumulatedBounceDistance=K,this.velocity=t-K,this.spinImplementation(),this.synchronizeSymbols()}onStopSpin(){this.stopBounceThreshold=Number.POSITIVE_INFINITY,this.data.spinTimer.stopTime=Number.POSITIVE_INFINITY,this.data.spinTimer.accumulator=0,this.outcomeSymbolToAddIndex=this.getCurrentSpinMode().onStopSpin(this.direction,this._nudgeAmount)}onIdle(){this.isNudgeMode()&&this.isDirectionBackward()&&Xt(this.reel,this._nudgeAmount),this.isOutcomeLanding=!1;const t=this.data.outcome.slice(),K=t.length,D=this.data.buffer;this.squashPrebuffer(),this.trimBufferToSize();const a=this.data.preBufferSize;for(let G=0;G<K;++G){const K=G+a,N=D[K];void 0!==N&&N.id===t[G]||this.reel.setSymbolByID(t[G],K,bt.nU.Absolute,{isOutcome:!0,landingPosition:{reelIndex:this.reel.id,symbolIndex:K,reelsetName:this.reel.reelsetName}})}this.velocity=0,this.outcomeSymbolToAddIndex=0,this.snap(),this.stopBounceThreshold=Number.POSITIVE_INFINITY,this.synchronizeSymbols();for(let t=0;t<D.length;t++){const K=D[t];void 0!==K&&K.land()}this.reel.onStopBounceEnd(this.reel.id)}stopSpin(t){if(!this.preOutcomeQueue.isEmpty()&&this.isNormalMode())return this.velocity=this.spinVelocity*t,this.spinImplementation(),this.isDirectionForward()?this.prependQueuedSymbols():this.appendQueuedSymbols(),void this.synchronizeSymbols();this.isDirectionForward()?this.prependOutcomeSymbols():this.appendOutcomeSymbols(),this.calculateStoppingVelocity(t),this.spinImplementation(),this.synchronizeSymbols(),this.calculateStopBounce(),this.checkForDeacceleration()}spin(t){this.isNudgeMode()||(this.velocity=this.spinVelocity*t,this.spinImplementation(),this.isDirectionForward()?this.prependReelStripSymbols():this.appendReelStripSymbols(),this.synchronizeSymbols())}synchronizeSymbols(){this.despawnSymbols();for(const t of this.data.buffer)void 0!==t&&t.synchronize({x:0,y:this.velocity})}calculateDespawnPoint(){return"backward"===this._direction?ut(this.data)+this.data.preBufferSize*Et(this.data).y:dt(this.data)-this.data.preBufferSize*Et(this.data).y}reverseBuffer(){this.snap();for(let t=0;t<this.data.buffer.length;t++){const K=this.data.buffer[t];void 0!==K&&K.synchronize({x:0,y:0})}}trimBufferToSize(){this.trimExcess();const t=this.data.bufferSize;this.data.buffer.splice(t,this.data.buffer.length-t)}spinImplementation(){const t=this.data.buffer;this.accumulatedDistance+=Math.abs(this.velocity);for(const K of t)if(void 0!==K){const t="backward"===this._direction?-1:1;K.position.y-=this.velocity*t}}onOutcomeAppeared(t){if(this.lowestOutcomeSymbol)return;this.lowestOutcomeSymbol=t,"forward"===this.direction&&(this.stopBounceThreshold=yt(t)-dt(this.data)),"backward"===this._direction&&(this.stopBounceThreshold=Math.abs(Pt(t)-ut(this.data))),this.deaccelerationThreshold=Math.max(0,this.stopBounceThreshold-this.deaccelerationDistance);const K=this.deaccelerationFinalVelocity-this.spinVelocity;this.currentAcceleration=(this.spinVelocity*K+K*K/2)/this.deaccelerationDistance,this.accumulatedDistance=0,this.isOutcomeLanding=!0}calculateStoppingVelocity(t){if(this.accumulatedDistance>=this.stopBounceThreshold){const t=this.accumulatedBounceDistance,K=this.endBounceFunction(this.data.spinTimer.progress);this.accumulatedBounceDistance=K,this.velocity=K-t}else this.accumulatedDistance>=this.deaccelerationThreshold?(this.velocity=this.currentDeaccelerationVelocity*t+this.currentAcceleration*t*t/2,this.currentDeaccelerationVelocity+=this.currentAcceleration*t,this.accumulatedDistance+this.velocity>this.stopBounceThreshold&&(this.velocity=this.stopBounceThreshold-this.accumulatedDistance)):(this.velocity=this.spinVelocity*t,this.accumulatedDistance+this.velocity>this.stopBounceThreshold?this.velocity=this.stopBounceThreshold-this.accumulatedDistance:this.accumulatedDistance+this.velocity>this.deaccelerationThreshold&&(this.velocity=this.deaccelerationThreshold-this.accumulatedDistance))}calculateStopBounce(){!this.hasBounced&&this.accumulatedDistance>=this.stopBounceThreshold&&(this.hasBounced=!0,this.data.spinTimer.accumulator=0,this.data.spinTimer.stopTime=this.stopBounceDuration,this.accumulatedDistance=this.stopBounceThreshold,this.accumulatedBounceDistance=0,this.velocity=0,this.notifyBounce())}checkForDeacceleration(){!this.hasStartedDeaccelerating&&this.accumulatedDistance>=this.deaccelerationThreshold&&(this.hasStartedDeaccelerating=!0,this.currentDeaccelerationVelocity=this.spinVelocity)}notifyBounce(){const t=this.data.buffer,K=t.length;for(let D=0;D<K;++D){const K=t[D];void 0!==K&&void 0!==K.bounce&&K.bounce()}this.reel.onStopBounceBegin(this.reel.id)}prependOutcomeSymbols(){this.outcomeSymbolToAddIndex<0||(this.outcomeSymbolToAddIndex=this.getCurrentSpinMode().prependOutcomeSymbols(this.outcomeSymbolToAddIndex,this.direction),void 0!==this.lowestOutcomeSymbol&&(this.reel.alignOutcome(),this.onOutcomeAppeared(this.lowestOutcomeSymbol)))}appendOutcomeSymbols(){const t=this.data.outcome;this.outcomeSymbolToAddIndex<0||this.outcomeSymbolToAddIndex>=t.length||(this.outcomeSymbolToAddIndex=this.getCurrentSpinMode().appendOutcomeSymbols(this.outcomeSymbolToAddIndex,this.direction),void 0!==this.lowestOutcomeSymbol&&this.reel.alignOutcome())}despawnSymbols(){const t=this.data.buffer,K=t.length;for(let D=this.isOutcomeLanding?this.data.bufferSize:0;D<K;++D){const K=t[D];void 0!==K&&this.isSymbolBelowPoint(K,this.despawnPoint)&&(K.isDead=!0)}}isSymbolAbovePoint(t,K){const D=yt(t);return"backward"===this.direction?D>K:D<K}isSymbolBelowPoint(t,K){const D=Pt(t);return"backward"===this.direction?D>K:D<K}clampPrependedSymbolPosition(t){void 0!==t&&this.isSymbolBelowPoint(t,this.despawnPoint)&&(t.position.y=this.despawnPoint)}prependReelStripSymbols(t=0,K=void 0){const D=this.data.buffer,a=this.data.preBufferSize-1;let G=D[a];const N=mt(this.data,this.direction);let W=0;for(;void 0===G||this.isSymbolAbovePoint(G,N);){this.squashPrebuffer();const N=this.reel.reelStrip.getNextSymbol(It.H.Backwards);this.shiftSymbolsDown(1);const x=D[this.prependSymbol(N.id,{dimensions:null!=K?K:N.dimensions,isOutcome:!1,landingPosition:{reelIndex:this.reel.id,symbolIndex:NaN,reelsetName:this.reel.reelsetName}})];if(this.clampPrependedSymbolPosition(x),G=D[a],t>0&&++W>=t)break}}prependQueuedSymbols(){const t=this.data.buffer,K=this.data.preBufferSize-1;let D=t[K];const a=mt(this.data,this.direction);for(;!this.preOutcomeQueue.isEmpty()&&(void 0===D||this.isSymbolAbovePoint(D,a));){this.squashPrebuffer();const a=this.preOutcomeQueue.dequeue();if(!a)break;this.shiftSymbolsDown(1);const G=t[this.prependSymbol(a.id,{dimensions:a.dimensions,isOutcome:!1,landingPosition:{reelIndex:this.reel.id,symbolIndex:NaN,reelsetName:this.reel.reelsetName}})];this.clampPrependedSymbolPosition(G),D=t[K]}}appendReelStripSymbols(t=0,K=void 0){const D=this.data.buffer,a=this.data.bufferSize-this.data.postBufferSize;let G=D[a];const N=mt(this.data,this.direction);let W=0;for(;void 0===G||this.isSymbolAbovePoint(G,N);){const N=this.reel.reelStrip.getNextSymbol(It.H.Forwards);Xt(this.reel,1);const x=D[Jt(this.reel,N.id,{dimensions:null!=K?K:N.dimensions,isOutcome:!1,landingPosition:{reelIndex:this.reel.id,symbolIndex:NaN,reelsetName:this.reel.reelsetName}})];if(this.clampPrependedSymbolPosition(x),G=D[a],t>0&&++W>=t)break}}appendQueuedSymbols(){const t=this.data.buffer,K=this.data.bufferSize-this.data.postBufferSize;let D=t[K];const a=mt(this.data,this.direction);for(;!this.preOutcomeQueue.isEmpty()&&(void 0===D||this.isSymbolAbovePoint(D,a));){const a=this.preOutcomeQueue.dequeue();if(!a)break;Xt(this.reel,1);const G=t[Jt(this.reel,a.id,{dimensions:a.dimensions,isOutcome:!1,landingPosition:{reelIndex:this.reel.id,symbolIndex:NaN,reelsetName:this.reel.reelsetName}})];this.clampPrependedSymbolPosition(G),D=t[K]}}get startBounceDuration(){return this.currentConfig.startBounceDuration}get stopBounceDuration(){return this.currentConfig.stopBounceDuration}get spinVelocity(){return this.currentConfig.spinVelocity}setSpinVelocity(t,K){this.getConfig(K).spinVelocity=t}setStartBounceFactor(t,K){this.getConfig(K).startBounceFactor=t}setStartBounceDuration(t,K){this.getConfig(K).startBounceDuration=t}setStopBounceFactor(t,K){this.getConfig(K).stopBounceFactor=t}setStopBounceDuration(t,K){this.getConfig(K).stopBounceDuration=t}setNumberOfBounces(t,K){this.getConfig(K).numberOfBounces=t}getConfig(t){return t===zt.Normal?this.normalConfig:this.nudgeConfig}getEndBounceFunction(t){return void 0===t?this.endBounceFunctions[0]:this.endBounceFunctions[t]}setBounceType(t,K){this.getConfig(K).bounceType=t}singleBounce(t){return nt.a7(0,0,this.stopBounceFactor,t)}multipleBounce(t){return nt.Cj(0,0,this.stopBounceFactor,t)}ballBounce(t){return Zt.ys(this.stopBounceFactor,this.numberOfBounces,t)}isNudgeMode(){return this.spinMode===zt.Nudge}isNormalMode(){return this.spinMode===zt.Normal}isDirectionForward(){return"forward"===this.direction}isDirectionBackward(){return"backward"===this.direction}getCurrentSpinMode(){return this.isNormalMode()?this.normalSpinMode:this.nudgeSpinMode}enqueuePreOutcomeSymbol(t){this.preOutcomeQueue.enqueue(t)}}class Ft{constructor(t,K){this.buffer=[],this.ctor="ctor"in t?t.ctor:K=>new t(K),this.symbolID=K}create(){return this.ctor(this.symbolID)}pop(){let t=this.buffer.pop();return void 0===t&&(t=this.create()),t}push(t){t.position={x:NaN,y:NaN},t.landingPosition={reelIndex:NaN,symbolIndex:NaN},t.isDead=!1,t.isOutcome=!1,this.buffer.push(t)}clear(){const t=this.buffer;this.buffer=[];for(const K of t)null==K||K.onDespawn()}}class ct{constructor(){this.pools=[]}initializePools(t,K,D=[]){for(let a=0;a<K;++a){const K=D.find((t=>t.symbolID===a));void 0===K?this.pools.push(new Ft(t,a)):this.pools.push(new Ft(K.ctor,a))}}push(t){this.pools[t.id].push(t)}pop(t){return this.pools[t].pop()}clear(){const t=this.pools;this.pools=[];for(const K of t)K.clear()}}var gt=D(415215);class Rt{constructor(){this.reelsets=new Map,this._poolGroup=new ct,this.activeReelsets=[]}get poolGroup(){return this._poolGroup}addReelset(t){this.reelsets.set(t.name,t)}getReelset(t){if(!this.reelsets.has(t)||void 0===this.reelsets.get(t))throw new Error(`No reelset with the name ${t} exists.`);return this.reelsets.get(t)}activateReelset(t,K){const D=this.getReelset(t);if(!this.activeReelsets.includes(D)){if(this.activeReelsets.push(D),void 0!==K){const t=this.getReelset(K);D.setOutcome(t.outcome,{dimensions:t.outcomeDimensions})}D.presentOutcome()}}deactivateReelset(t,K=!0){const D=this.getActiveReelset(t),a=this.activeReelsets.indexOf(D);this.activeReelsets[a].clear(!1,K),this.activeReelsets.splice(a,1)}clear(){for(const t of this.reelsets)t[1].clear(!0);this.activeReelsets=[],this.reelsets.clear()}getActiveReelset(t){if(0===this.activeReelsets.length)throw new Error("Trying to get an active reelset when there are no active.");if(void 0===t){if(this.activeReelsets.length>1)throw new Error("A reelset name has to be provided when there are more than one reelset active");return this.activeReelsets[0]}const K=this.getReelset(t);if(-1===this.activeReelsets.indexOf(K))throw new Error(`Trying to get active reelset with name '${t}' but it's not active.`);return K}timestep(t){const K=Zt.fP(t);for(let t=0;t<this.activeReelsets.length;t++)this.activeReelsets[t].timestep(K);gt.C.timestep(K)}createSymbol(t,K){const D=this.poolGroup.pop(t);return D.dimensions=void 0===K?{x:1,y:1}:K,D.onSpawn(),D}destroySymbol(t){t.onDespawn(),this.poolGroup.push(t)}}var At=D(663062);class Yt{constructor(t){this.reels=[],this.outcome=[],this.outcomeDimensions=[],this._onReelStartSequenceBegin=Zt.lQ,this._onReelStartSequenceEnd=Zt.lQ,this._onReelStopSequenceBegin=Zt.lQ,this._onReelStopSequenceEnd=Zt.lQ,this._onReelStopBounceBegin=Zt.lQ,this._onReelStopBounceEnd=Zt.lQ,this.onStartSequenceBegin=Zt.lQ,this.onStartSequenceEnd=Zt.lQ,this.onStopSequenceBegin=Zt.lQ,this.onStopSequenceEnd=Zt.lQ,this.reelsToExclude=[],this.reelsToTimestep=[],this.name=t}addReel(t){t.id=this.reels.length,this.reels.push(t),t.onStartSequenceBegin=this._onReelStartSequenceBegin,t.onStartSequenceEnd=this._onReelStartSequenceEnd,t.onStopSequenceBegin=this._onReelStopSequenceBegin,t.onStopSequenceEnd=this._onReelStopSequenceEnd,t.onStopBounceBegin=this._onReelStopBounceBegin,t.onStopBounceEnd=this._onReelStopBounceEnd}popReel(){const t=this.reels.pop();if(void 0!==t){const K=this.reelsToTimestep.indexOf(t);K>-1&&this.reelsToTimestep.splice(K,1),t.clear()}return t}removeReel(t){if(t>=this.reels.length||t<0)return;const K=this.reelsToTimestep.indexOf(this.reels[t]);K>-1&&this.reelsToTimestep.splice(K,1);const D=this.reels[t];D.clear(),this.reels.splice(t,1);for(let K=t;K<this.reels.length;++K){const t=this.reels[K];t.id=K,t.updateSymbolLandingPositions()}return D}excludeReels(...t){this.reelsToExclude=[...t]}async startSpin(...t){this.onStartSequenceBegin();const K=[],D=this.reels;for(let a=0;a<D.length;++a)this.reelsToExclude.includes(a)||(D[a].setStartDelay(Number.isNaN(Number(t[a]))?D[a].startDelay:t[a]),this.reelsToTimestep.push(D[a]),K.push(D[a].startSpin()));await Promise.all(K),this.onStartSequenceEnd()}async stopSpin(...t){this.onStopSequenceBegin();const K=[],D=this.reels;for(let a=0;a<D.length;++a)if(!this.reelsToExclude.includes(a))if(Zt.yL(t[a]))K.push(D[a].stopSpin(t[a]));else{const G="number"==typeof t[a];D[a].setStopDelay(G?t[a]:D[a].stopDelay),K.push(D[a].stopSpin())}await Promise.all(K),this.onStopSequenceEnd(),this.reelsToExclude=[],this.reelsToTimestep=[]}timestep(t){for(let K=0;K<this.reelsToTimestep.length;K++)this.reelsToTimestep[K].timeStep(t)}clear(t=!1,K=!0){for(const K of this.reels)K.clear(t);t&&this.onDispose(),K&&(this.reels.length=0)}onDispose(){}presentOutcome(){for(let t=0;t<this.reels.length;t++)this.reels[t].presentOutcome()}setOutcome(t,K){if(t.length!==this.reelCount)throw new RangeError(`The provided outcome length must be ${this.reelCount}. Actual value is ${t.length}.`);let D=null==K?void 0:K.dimensions;const a=null==K?void 0:K.colossalSymbolFeature;if(a){void 0!==D&&0!==D.length||(D=this.createDefaultDimensions(t));const{colossalSymbols:K,synchronizeReels:G}=a;this.handleColossalDimensions(D,K),G&&this.synchronizeColossalReels(K)}this.outcome=t,this.outcomeDimensions=null!=D?D:[];for(let K=0;K<this.reelCount;++K){if(0===t[K].length)throw new RangeError(`There is no outcome to set for reel: '${K}`);this.reels[K].setOutcome(t[K],this.outcomeDimensions.length>0?this.outcomeDimensions[K]:[])}}setSymbol(t,K,D=bt.nU.Visible,a){return this.reels[K.reelIndex].setSymbol(t,K.symbolIndex,D,a)}setSymbolByID(t,K,D=bt.nU.Visible,a){return this.reels[K.reelIndex].setSymbolByID(t,K.symbolIndex,D,{dimensions:a})}swapSymbol(t,K,D=bt.nU.Visible,a){return this.reels[K.reelIndex].swapSymbol(t,K.symbolIndex,D,a)}getSymbol(t,K=bt.nU.Visible){return this.reels[t.reelIndex].getSymbol(t.symbolIndex,K)}forgetSymbol(t,K=bt.nU.Visible){return this.reels[t.reelIndex].forgetSymbol(t.symbolIndex,K)}printState(){console.log("Printing state for reelset:");for(let t=0;t<this.reels.length;t++)this.reels[t].printState()}get reelCount(){return this.reels.length}getReel(t){return this.reels[t]}setSpinMode(t){for(let K=0;K<this.reels.length;K++)this.reels[K].currentSpinMechanic.spinMode=t}setSpinModeForReel(t,K){this.reels[K].currentSpinMechanic.spinMode=t}setReelStripsSymbols(t){if(t.length!==this.reelCount)throw new RangeError(`The provided reel strips length must be ${this.reelCount}`);for(let K=0;K<t.length;K++)this.setReelStripSymbolsForReel(t[K],K)}setReelStripSymbolsForReel(t,K){const D=this.reels[K];D.isMaster&&D.reelStrip.setSymbols(t)}setReelStripsDimensions(t){if(t.length!==this.reelCount&&t.length>0)throw new RangeError(`The provided reel strips length must be ${this.reelCount}, or 0 if the reel is supposed to have homogenous dimensions.`);for(let K=0;K<t.length;K++)this.setReelStripDimensionsForReel(t[K],K)}setReelStripDimensionsForReel(t,K){const D=this.reels[K];D.isMaster&&D.reelStrip.setDimensions(t)}set onReelStartSequenceBegin(t){this._onReelStartSequenceBegin=t;for(let t=0;t<this.reelCount;++t)this.reels[t].onStartSequenceBegin=this._onReelStartSequenceBegin}get onReelStartSequenceBegin(){return this._onReelStartSequenceBegin}set onReelStartSequenceEnd(t){this._onReelStartSequenceEnd=t;for(let t=0;t<this.reelCount;++t)this.reels[t].onStartSequenceEnd=this._onReelStartSequenceEnd}get onReelStartSequenceEnd(){return this._onReelStartSequenceEnd}set onReelStopSequenceBegin(t){this._onReelStopSequenceBegin=t;for(let t=0;t<this.reelCount;++t)this.reels[t].onStopSequenceBegin=this._onReelStopSequenceBegin}get onReelStopSequenceBegin(){return this._onReelStopSequenceBegin}set onReelStopSequenceEnd(t){this._onReelStopSequenceEnd=t;for(let t=0;t<this.reelCount;++t)this.reels[t].onStopSequenceEnd=this.onReelStopSequenceEnd}get onReelStopSequenceEnd(){return this._onReelStopSequenceEnd}set onReelStopBounceBegin(t){this._onReelStopBounceBegin=t;for(let t=0;t<this.reelCount;++t)this.reels[t].onStopBounceBegin=this._onReelStopBounceBegin}get onReelStopBounceBegin(){return this._onReelStopBounceBegin}set onReelStopBounceEnd(t){this._onReelStopBounceEnd=t;for(let t=0;t<this.reelCount;++t)this.reels[t].onStopBounceEnd=this._onReelStopBounceEnd}get onReelStopBounceEnd(){return this._onReelStopBounceEnd}createDefaultDimensions(t){const K=[];for(let D=0;D<this.reels.length;D++){const a=[];for(let K=0;K<t[D].length;K++)a.push(this.reels[D].currentSpinMechanic.defaultSymbolDimensions());K.push(a)}return K}handleColossalDimensions(t,K){for(const D of K){const{position:K,size:a}=D,{reelIndex:G,symbolIndex:N}=K;for(let K=0;K<D.size.x;K++)for(let W=0;W<D.size.y;W++)t[G+K][N+W]={x:0===K&&0===W?a.x:0,y:1,colossalData:{colossalSize:{...D.size},positionInColossalSpace:{x:K,y:W}}}}}synchronizeColossalReels(t){const K=[];for(const D of t){const{position:t,size:a}=D;for(let D=t.reelIndex;D<t.reelIndex+a.x;D++)K.includes(D)||K.push(D)}if(0===K.length)return;let D=0;for(let t=1;t<K.length;t++)if(K[t]-K[t-1]>1){const a=this.getReel(K[D]),G=K.slice(D+1,t).map((t=>this.getReel(t)));a.synchronize(G,At.l.Timers),D=t}else if(t===K.length-1){const t=this.getReel(K[D]),a=K.slice(D+1,K.length).map((t=>this.getReel(t)));t.synchronize(a,At.l.Timers)}}}const Lt=30;class St extends bt.X3{constructor(t,K,D){super(t,D,"dondReel"),this.reelConfiguration=D,this.nameToId={},this._container=new b.mcf,this._container.label=`GameReelContainer_${K}`}speedUp(){this.currentSpinMechanic instanceof st&&this.currentSpinMechanic.setSpinVelocity(this.currentSpinMechanic.spinVelocity*this.reelConfiguration.nearWinSpinVelocityMultiplier,zt.Normal)}slowDown(){this.currentSpinMechanic instanceof st&&this.currentSpinMechanic.setSpinVelocity(this.currentSpinMechanic.spinVelocity/this.reelConfiguration.nearWinSpinVelocityMultiplier,zt.Normal)}adjustLayout(){for(let t=0;t<v.oW+V;t++){const K=this.getSymbol(t,bt.nU.Absolute);null==K||K.adjustLayout()}}showWinOrNoWinIndication(t){for(let K=0;K<v.oW;K++){const D=this.getSymbol(K,bt.nU.Visible);t.includes(K)?null==D||D.showWinIndication():null==D||D.showNoWinIndication()}}addSpinMechanic(t,K){const D=super.addSpinMechanic(t);return K&&(this.nameToId[K]=D),D}setCurrentMechanicsByName(t){const K=this.nameToId[t];this.setCurrentMechanics(K)}hideWinOrNoWinIndication(){for(let t=0;t<v.oW;t++){const K=this.getSymbol(t,bt.nU.Visible);null==K||K.hideWinOrNoWinIndication()}}initializeSymbol(t){this._container.addChild(t.container)}get container(){return this._container}}var ft=D(738759);const $t={0:"scatter",1:"wild",3:"phone",4:"cherry",5:"seven3",6:"seven",7:"bar3",8:"bar",9:"wild2x",10:"wild5x",11:"scatter2x",12:"scatter3x",13:"scatter5x",14:"scatter10x"},Bt=.5,Ot=-.1,vt=.5;class pt{constructor(t,K,D,a,G=()=>0){this.id=t,this.gameDimensions=D,this.outOfMaskGlobalLayer=a,this.getSpeedUpProgress=G,this.dimensions={x:1,y:1},this.position={x:0,y:0},this.landingPosition={reelIndex:0,symbolIndex:0},this.isDead=!1,this.isOutcome=!1,this.disposeAnimation=null,this.restoreParent=null;const N=(m-u)/1e3;this._container=new b.mcf,this._container.cullable=!0,this._container.label="DondSymbol";const W=$t[this.id];this.animatedSymbol=K.symbols[this.symbolName](N),this.winLight=K.winLight({animationTimeSec:N,scale:1.75*ft.mZ()}),this.blurredSymbol=b.kxk.from(K.blurredSymbols[W]),this.blurredSymbol.anchor.set(.5),this.staticSymbol=b.kxk.from(this.animatedSymbol.firstFrame),this.staticSymbol.anchor.set(.5),this._container.addChild(this.winLight,this.animatedSymbol,this.staticSymbol,this.blurredSymbol),this.blurred=!1}land(){this.adjustLayout()}onSpawn(){this.adjustLayout()}onDespawn(){var t;this.animatedSymbol.reset(),null===(t=this._container.parent)||void 0===t||t.removeChild(this._container)}synchronize(){const{symbolSize:t,reelsXPosition:K}=this.gameDimensions;this.isGlobalPositioned?this._container.position.set(K[this.landingPosition.reelIndex]+t.width/2,-(this.position.y-.5)*t.height):this._container.position.set((this.position.x+.5)*t.width,-(this.position.y-.5)*t.height),this.lerpAlphaBetweenStaticAndBlurredSprite(this.getSpeedUpProgress(this.landingPosition.reelIndex))}adjustLayout(){const{symbolSize:t}=this.gameDimensions;this.animatedSymbol.setSize(t.width,t.height),this.winLight.setSize(t.width),this.blurredSymbol.scale.set(this.animatedSymbol.spriteScale.x),this.synchronize()}showWinIndication(){this.playWin()}showNoWinIndication(){this.animatedSymbol.tint=5592405}hideWinOrNoWinIndication(){this.animatedSymbol.tint=16777215,this.disposeAnimation&&(this.disposeAnimation(),this.disposeAnimation=null),this.adjustLayout()}get container(){return this._container}playAnimation(){this.animatedSymbol.startAnimation()}skipToLastFrame(){this.animatedSymbol.stopAnimation(!0)}elevateToGlobalLayer(){this.restoreParent||(this.restoreParent=function(t,K){const{parent:D}=t,a=t.getGlobalPosition();return K.addChild(t),t.position.copyFrom(K.toLocal(a)),()=>{null==D||D.addChild(t),t.position.copyFrom(D.toLocal(a))}}(this._container,this.outOfMaskGlobalLayer))}restoreToReelLayer(){this.restoreParent&&(this.restoreParent(),this.restoreParent=null)}get symbolName(){return $t[this.id]}get isGlobalPositioned(){return this._container.parent===this.outOfMaskGlobalLayer}playWin(){this.animatedSymbol.startAnimation(),this.winLight.startShowAndHideAnimation(),this.disposeAnimation=()=>{this.winLight.stopAnimation(),this.animatedSymbol.stopAnimation()}}set blurred(t){this.blurred!==t&&(this.blurredSymbol.visible=t,this.staticSymbol.visible=t,this.animatedSymbol.visible=!t)}get blurred(){return this.blurredSymbol.visible}lerpAlphaBetweenStaticAndBlurredSprite(t){this.blurred=t>.2,this.staticSymbol.alpha=Math.min(t,Bt),this.animatedSymbol.alpha=Math.max(1-t,1-Bt);const K=ft.mZ();this.staticSymbol.scale.set(K+K*t*Ot,K+K*t*vt),this.blurredSymbol.scale.copyFrom(this.staticSymbol.scale)}}const jt=.2,rt=2/3,Mt=2;class kt extends b.mcf{constructor(t,K,D){super(),this.gameDimensions=D,this._isPlaying=!1;const a=b.kxk.from(t);a.anchor.set(.5,.5),this.highlight=a,this.dividersAnimations=this.createDividersAnimations(K),this.cancellation=new J.X,this.adjustLayout()}async playStart(){this._isPlaying=!0,this.alpha=0,this.addChild(this.highlight,...this.dividersAnimations),this.dividersAnimations[0].gotoAndPlay(0),this.dividersAnimations[1].gotoAndPlay(0),this.playHighlightPulseInterval(),this.fadeIn(),i.A("NearWin",2)}async playStop(){this._isPlaying&&(this.cancellation.cancel(),this.addChild(this.highlight,...this.dividersAnimations),this.fadeOut(),this._isPlaying=!1)}stop(){this.cancellation.cancel(),this.removeChild(this.highlight,...this.dividersAnimations),this.dividersAnimations[0].stop(),this.dividersAnimations[1].stop(),this.highlight.alpha=0}adjustLayout(){const{symbolSize:t,slotSize:K}=this.gameDimensions,D=(K.height-this.gameDimensions.slotReelHeight)/2,a=1.22;this.highlight.position.set(K.width-t.width/2,D*a),this.highlight.width=1.45*t.width,this.highlight.height=this.gameDimensions.slotReelHeight*a,this.positionDividerAnimation(0,2),this.positionDividerAnimation(1,3);const G=this.gameDimensions.slotReelHeight*(1+H)/this.dividersAnimations[0].height;this.dividersAnimations[0].scale.set(G),this.dividersAnimations[1].scale.set(G)}playHighlightPulseInterval(){this.cancellation.cancel(),this.cancellation=new J.X,this.playHighlightPulse();const t=setInterval((()=>{this.cancellation.isCancelled||this.playHighlightPulse()}),1e3);this.cancellation.addListener((()=>clearInterval(t)))}async playHighlightPulse(){if(this.cancellation.isCancelled)return;const t=h.M({x:0});t.animateTo({x:1},rt/2,X.dV).animateTo({x:0},rt/2,X.dV).onUpdate((({x:t})=>{this.highlight.alpha=t}));const K=Z.l({anim:t,dispose:!0});this.cancellation.addListener((()=>{K()}))}get isPlaying(){return this._isPlaying}createDividerAnimation(t){const K=new b.Dl5([t[0]]);return K.textures=t.map((K=>({texture:K,time:1e3*Mt/t.length}))),K.loop=!0,K.animationSpeed=1,K.anchor.set(.5),K}createDividersAnimations(t){return[this.createDividerAnimation(t),this.createDividerAnimation(t)]}positionDividerAnimation(t,K){const{symbolSize:D,slotSize:a}=this.gameDimensions;this.dividersAnimations[t].position.set(D.width*K+D.width*H*K+D.width*H/2,a.height/2+2*D.width*H-this.gameDimensions.slotReelHeight/2)}fadeIn(){Z.l({anim:z.X({target:this,durationIn:jt,destinationAlpha:1}),repeat:0,ticker:e._})}fadeOut(){Z.l({anim:z.X({target:this,durationIn:jt,destinationAlpha:0}),repeat:0,ticker:e._})}}var tK=D(280948),KK=D(234341);const DK=.2,aK=.4,GK=.1,NK=.05;class WK{constructor(t,K){this.gameDimensions=K,this._container=new b.mcf,this._container.label="ReelHighlights",this.highlights=Array.from({length:3},(()=>{const K=b.kxk.from(t);return K.anchor.set(.5),K.visible=!1,this.container.addChild(K)})),this.adjustLayout()}async playStart(t){this.highlights[t].visible||(this.highlights[t].visible=!0,this.highlights[t].alpha=0,this.highlights[t].y=1.5*this.gameDimensions.slotReelHeight,Z.l({anim:KK.M().delay(t*GK+NK).parallel([z.X({target:this.highlights[t],durationIn:DK,destinationAlpha:aK}),tK.t({target:this.highlights[t],durationIn:DK,destination:{x:this.highlights[t].x,y:this.highlights[t].y-1.15*this.gameDimensions.slotReelHeight},easingIn:X.sn})]).sequence(z.X({target:this.highlights[t],durationIn:DK,destinationAlpha:0})).callback((()=>{this.highlights[t].visible=!1})),ticker:e._}))}adjustLayout(){const{symbolSize:t,slotSize:K,reelsXPosition:D}=this.gameDimensions;this.highlights.forEach(((a,G)=>{a.position.set(t.width/2+D[G],t.height),a.width=K.width/3+t.width*H,a.height=this.gameDimensions.slotReelHeight}))}get container(){return this._container}}class xK extends st{constructor(t,K,D){super(t,{...K,nudge:{...K.nudge,nudgeAmount:1,spinVelocity:D?K.nudgeSpinVelocityTurbo:K.nudge.spinVelocity}}),this.minimalVelocity=5,this.speedingUpDuration=1.5,this.speedingUpTimer=0}onStartSpin(){super.onStartSpin(),this.speedingUpTimer=0}spin(t){super.spin(t),this.speedingUpTimer=Math.min(this.speedingUpTimer+t,this.speedingUpDuration)}get speedingUpProgress(){return X.ot(this.speedingUpTimer/this.speedingUpDuration)}get spinVelocity(){return this.isNudgeMode()?super.spinVelocity:this.minimalVelocity+(super.spinVelocity-this.minimalVelocity)*this.speedingUpProgress}}class bK extends st{constructor(t,K){super(t,{...K,direction:t.id%2==0?"backward":"forward",normal:{...K.normal,spinVelocity:7,startBounceFactor:0,startBounceDuration:0,stopBounceDuration:0,stopBounceFactor:0}})}}const nK=["nearWin","reels","winAnimations"];class eK extends b.mcf{constructor({assets:t,...K}){super(),this.reelsBlurState=[!1,!1,!1],this.scattersPositionOrderApparence=[-1,-1,-1],this.previousOutcome=null,this.paylinesIDs=[],this.spinMode=null,this.spinStartTime=0,this.hideWinOrNoWinIndication=()=>{this.reels.forEach((t=>t.hideWinOrNoWinIndication()))},this.handleStartSequenceBegin=()=>{i.A("SpinStart")},this.handleStartSequenceEnd=()=>{this.isShuffling&&i.A("ReelsMoveStart")},this.handleStopSequenceEnd=()=>{i.A("SpinComplete"),this.isShuffling&&i.A("ReelsMoveStop"),q.t$(this.outcome)&&i.A("Qualified")},this.handleReelStartSequenceBegin=t=>{this.getSymbol(t,0).restoreToReelLayer(),this.getSymbol(t,2).restoreToReelLayer()},this.handleReelStartSequenceEnd=t=>{this.reelsBlurState[t]=!0},this.handleReelStopSequenceBegin=t=>{const K=this.prevReelsWithScatterPositions[t];if(K>-1&&K<2){const D=this.countActiveScatters(this.scattersPositionOrderApparence),a=this.scattersPositionOrderApparence[t],G=-1===a&&0===D||0===a?"FirstStickyScatter":"SecondStickyScatter",N=0===K?"StartMiddle":"StartBottom";-1===a&&(this.scattersPositionOrderApparence[t]=D),i.A(`${G}${N}`,t)}this.isReelShuffling(t)||(this.reelsBlurState[t]=!1)},this.handleReelStopSequenceEnd=t=>{const K=this.prevReelsWithScatterPositions[t],D=this.countActiveScatters(this.scattersPositionOrderApparence),a=this.scattersPositionOrderApparence[t];if(K>-1&&K<2){const G=-1===a&&0===D||0===a?"FirstStickyScatter":"SecondStickyScatter",N=0===K?"StopMiddle":"StopBottom";i.A(`${G}${N}`,t)}else if(this.outcome[t].some(E.xQ)){const K=2;if(this.countActiveScatters(this.prevReelsWithScatterPositions)===K||D===K)i.A("ThirdScatterLand",t);else{const K=-1===a&&0===D||0===a?"FirstScatterLand":"SecondScatterLand";-1===a&&(this.scattersPositionOrderApparence[t]=D),i.A(K,t)}}if(!q.t$(this.outcome)){const K=q.a8(this.outcome[t]);null===K||this.isSlamStopping||this.getSymbol(t,K).playAnimation()}q.b3(this.outcome[t]).forEach((K=>{(function(t,{reelId:K,rowId:D}){return t.some((t=>Q[t][K]===D))})(this.paylinesIDs,{reelId:t,rowId:K})||this.getSymbol(t,K).playAnimation()})),this.shouldPlayNearWin&&1===t&&(this.nearWinAnimation.playStart(),this.getReel(2).speedUp()),2===t&&this.nearWinAnimation.isPlaying&&(this.nearWinAnimation.playStop(),this.getReel(2).slowDown()),this.reelsBlurState[t]=!1},this.handleReelStopBounceBegin=t=>{this.getSymbol(t,0).elevateToGlobalLayer(),this.getSymbol(t,2).elevateToGlobalLayer(),i.A("ReelBounce",t)},this.getSpeedingUpProgress=t=>{if(!this.spinEngine)return 0;const{currentSpinMechanic:K}=this.getReel(t);return K instanceof xK&&K.currentSpinSequence===xt.J.Spin?K.speedingUpProgress:0},this.interactiveChildren=!1,this.spinConfig=K.spinConfig,this.gameDimensions=K.gameDimensions,this.winlineManager=K.winlineManager,this.background=K.background,this.reelsMask=K.mask,this.layers=this.setupLayers(),this.layers.reels.addChild(this.reelsMask),this.layers.reels.mask=this.reelsMask,this.spinEngine=this.createSpinEngine(this.createSymbolFactory(pt,t),K.initialOutcome),this.disconnectFromTicker=e._((t=>{this.spinEngine.timestep(t)})),this.nearWinAnimation=new kt(t.nearWin,t.nearWinDividers,K.gameDimensions),this.layers.nearWin.addChild(this.nearWinAnimation),this.reelHighlights=new WK(t.nearWin,K.gameDimensions),this.layers.reels.addChild(this.reelHighlights.container),this.lightSweepAnimation=new Wt(t.lightSweep),this.lightSweepAnimation.addFilterToContainer(this),this.updateSpinMechanics(!1,!1),this.getStopDelays=this.getDefaultStopDelays,this.previousOutcome=K.initialOutcome}adjustLayout(){const{appSize:t,slotSize:K,reelsYPosition:D,reelsXPosition:a}=this.gameDimensions,G=(t.width-K.width)/2;this.x=G,this.y=D,this.updateMaskLayout(this.layers.reels.mask),this.reels.forEach(((t,K)=>{t.container.x=a[K],t.adjustLayout()})),this.nearWinAnimation.adjustLayout(),this.reelHighlights.adjustLayout()}spin(t,K,D){this.spinMode=t,this.previousOutcome=this.outcome,this.getStopDelays=K?this.getTurboStopDelays:this.getDefaultStopDelays,this.updateSpinMechanics(!1,K);const a=q.hK(this.outcome);this.outcome=q.SX(this.outcome,D);const G=this.reels.map(((t,K)=>K*(a[K]?this.spinConfig.nudge.startDelay:this.spinConfig.normal.startDelay))),N=this.prevReelsWithScatterPositions.reduce(((t,K)=>t+(2===K?1:0)),0);N>0&&(this.scattersPositionOrderApparence=this.scattersPositionOrderApparence.map(((t,K)=>2===this.prevReelsWithScatterPositions[K]?-1:-1!==t?t-N:t))),this.reels.forEach((t=>{this.reelHighlights.playStart(t.id)})),this.background.playSeparatorsAttentions(t),this.spinStartTime=Date.now(),this.spinningPromise=this.reelset.startSpin(...G);const{stopDelay:W,stopBounceDuration:x}=this.spinConfig.nudge;this.reels.forEach(((t,K)=>{a[K]&&(t.setSymbolByID(this.outcome[K][0],0,bt.nU.Absolute),t.setStopDelay(K*(W+x)),t.currentSpinMechanic instanceof xK&&t.currentSpinMechanic.setSpinVelocity(1/this.reels.length,zt.Nudge),t.stopSpin(Promise.resolve()))}))}shuffle(t){this.previousOutcome=null,this.scattersPositionOrderApparence=[-1,-1,-1],this.getStopDelays=this.getShuffleStopDelays,this.updateSpinMechanics(!0,!1),this.background.playSeparatorsAttentions(t),this.spinningPromise=this.reelset.startSpin()}slamStop(){this.getStopDelays=this.getSlamStopDelays;const t=this.getStopDelays();this.reels.forEach((K=>{this.isReelNudging(K.id)&&K.currentSpinMechanic.setSpinVelocity(10,K.currentSpinMechanic.spinMode),K.setStopDelay(t[K.id])})),this.nearWinAnimation.isPlaying&&(this.nearWinAnimation.playStop(),this.getReel(2).slowDown()),this.background.stopSeparatorsAttentions()}async stop({timeToFullyStop:t,outcome:K,paylineIds:D}){this.paylinesIDs=D,this.outcome=K;const a=this.getStopDelays(),G=Math.max(...a),N=Math.max(t-G,0);let W=a.map((t=>t+N));this.getStopDelays!==this.getSlamStopDelays&&(W=W.map(((t,K)=>{if(this.isReelNudging(K)){const{stopDelay:D,stopBounceDuration:a}=this.spinConfig.normal;t+=K*(D+a);const G=Date.now()-this.spinStartTime,W=this.spinConfig,{stopDelay:x,stopBounceDuration:b}=W.nudge,n=N+(x+b)+K*(x+b),e=Math.max(1,n-G),i=Math.max(e,t-G),z=Math.min(2,Math.max(.3,W.nudge.spinVelocity*(i/e))),I=this.reelset.getReel(K).currentSpinMechanic;return I instanceof xK&&I.setSpinVelocity(1/z,zt.Nudge),0}return t}))),this.background.stopSeparatorsAttentions(),this.lightSweepAnimation.playSweepInterval(),await this.spinningPromise,await this.reelset.stopSpin(...W)}dispose(){this.spinEngine.clear(),this.spinEngine.poolGroup.clear(),this.destroy(),this.disconnectFromTicker()}async showWinOrNoWinIndication({paylineIds:t,winlineAnimationMode:K}){this.lightSweepAnimation.stopSweep();const D=function(t){return t.map((t=>Q[t]))}(t),a=t=>{const K=new Set;for(const a of D)K.add(a[t]);const a=Array.from(K);this.getReel(t).showWinOrNoWinIndication(a)};"OneAnimation"===K?this.winlineManager.runShowOnce([...Array(v.AX).keys()],a):(await this.winlineManager.runShowOnce([...Array(v.AX).keys()],a),this.winlineManager.runShowCyclically(D,(t=>{t.forEach(((t,K)=>{this.getReel(K).showWinOrNoWinIndication([t])}))}),this.hideWinOrNoWinIndication))}getSymbol(t,K){return this.reelset.getReel(t).getSymbol(K)}createSpinEngine(t,K){const D=new Rt;D.poolGroup.initializePools(t,E.rv+1);const a=this.createReelset(D);var G;return D.addReelset(a),D.activateReelset(a.name),a.setOutcome(K),a.setReelStripsSymbols((G="ALLOW_ONE_SCATTER",Array.from({length:v.AX},(()=>Array.from({length:Lt},(()=>E.Qp(G))))))),a.presentOutcome(),D}createReelset(t){const K=new Yt("default"),D=Array.from({length:v.AX}).map(((K,D)=>new St(t.poolGroup,D,{normalizeTo:bt.He.ReelHeight,nearWinSpinVelocityMultiplier:this.spinConfig.nearWinSpeedMultiplier}))),{slotSize:a,symbolSize:G}=this.gameDimensions,N=a.height/(G.height*(1+6*H));for(const t of D)t.visibleHeight=N+o,K.addReel(t),t.addSpinMechanic(new xK(t,this.spinConfig,!1),"nudge"),t.addSpinMechanic(new xK(t,this.spinConfig,!0),"nudgeTurbo"),t.addSpinMechanic(new bK(t,this.spinConfig),"shuffle"),this.layers.reels.addChild(t.container);return K.onStartSequenceBegin=this.handleStartSequenceBegin,K.onStartSequenceEnd=this.handleStartSequenceEnd,K.onStopSequenceEnd=this.handleStopSequenceEnd,K.onReelStartSequenceBegin=this.handleReelStartSequenceBegin,K.onReelStartSequenceEnd=this.handleReelStartSequenceEnd,K.onReelStopSequenceBegin=this.handleReelStopSequenceBegin,K.onReelStopSequenceEnd=this.handleReelStopSequenceEnd,K.onReelStopBounceBegin=this.handleReelStopBounceBegin,K}getShuffleStopDelays(){return[0,0,0]}getTurboStopDelays(){return this.reels.map((t=>this.spinConfig[this.isReelNudging(t.id)?"nudge":"normal"].stopDelay))}getSlamStopDelays(){return[0,0,0]}getDefaultStopDelays(){const t=[];let K=0;for(let D=0;D<v.AX;D++){if(this.isReelNudging(D)){t.push(0);continue}if(this.shouldPlayNearWin&&2===D){t.push(Dt.W.nearWinDuration());continue}const{stopDelay:a,stopBounceDuration:G}=this.spinConfig.normal,N=a+G;t.push(K),K+=N}return t}updateSpinMechanics(t,K){const D=q.hK(this.outcome),a=t?"shuffle":K?"nudgeTurbo":"nudge";this.reels.forEach((K=>{K.setCurrentMechanicsByName(a);const G=D[K.id]&&!t,N=K.currentSpinMechanic;N.spinMode=G&&N instanceof st?zt.Nudge:zt.Normal}))}countActiveScatters(t){return t.filter((t=>-1!==t&&2!==t)).length}updateMaskLayout(t){const{symbolSize:K,slotSize:D}=this.gameDimensions;t.width=D.width+2*U,t.height=D.height,t.y=-K.height,t.x=-U}createSymbolFactory(t,K){return{ctor:D=>new t(D,K,this.gameDimensions,this.layers.winAnimations,this.getSpeedingUpProgress)}}setupLayers(){return nK.reduce(((t,K)=>(t[K]=this.addChild(new b.mcf),t[K].label=`Layer(${K})`,t)),{})}get prevReelsWithScatterPositions(){return this.previousOutcome?q.tj(this.previousOutcome):[-1,-1,-1]}getReel(t){return this.reelset.getReel(t)}get reelset(){return this.spinEngine.getReelset("default")}get reels(){return Array.from({length:v.AX},((t,K)=>this.reelset.getReel(K)))}isReelNudging(t){const K=this.reelset.getReel(t);return K.currentSpinMechanic instanceof st&&K.currentSpinMechanic.isNudgeMode()}isReelShuffling(t){return this.reelset.getReel(t).currentSpinMechanic instanceof bK}set outcome(t){this.reelset.setOutcome(t)}get outcome(){return this.reelset.outcome}get isSlamStopping(){return this.getStopDelays===this.getSlamStopDelays}get isShuffling(){return this.getStopDelays===this.getShuffleStopDelays}get isDefaultSpin(){return this.getStopDelays===this.getDefaultStopDelays}get shouldPlayNearWin(){const t=q.tj(this.outcome);return"SuperXXXtreme"!==this.spinMode&&Dt.W.nearWinAllowed()&&this.isDefaultSpin&&t[0]>-1&&t[1]>-1&&!this.isReelNudging(2)}}const iK={Small:"SlotSmallWin",Medium:"SlotMediumWin",Large:"SlotLargeWin"};class zK{constructor(t,K){this.app=t,this.device=K,this.winlineManager=new d,this.disposeBag=new I.C}async init(t,K,D){const a=await n.a.get();await n.a.load(),this.background=new Y({assets:a,gameDimensions:this.gameDimensions,winlineManager:this.winlineManager}),this.app.addChild(this.background),this.disposeBag.addDisposable(this.background),this.disposeBag.addDisposable((()=>{this.app.removeChild(this.background)})),void 0===zK.slotsMask&&(zK.slotsMask=this.createSlotsMask()),this.slots=new eK({assets:a,initialOutcome:t,spinConfig:K,gameDimensions:this.gameDimensions,winlineManager:this.winlineManager,background:this.background,mask:zK.slotsMask.sprite}),this.app.addChild(this.slots),this.disposeBag.addDisposable(this.slots),this.disposeBag.addDisposable((()=>{this.app.removeChild(this.slots)})),this.foreground=new $({gameDimensions:this.gameDimensions,winlineManager:this.winlineManager,currencySymbol:D}),this.app.addChild(this.foreground),this.disposeBag.addDisposable(this.foreground),this.disposeBag.addDisposable((()=>{this.app.removeChild(this.foreground)}))}start({turboModeIsOn:t,spinMode:K,nextSymbols:D}){var a,G,N,W;this.winlineManager.hideAnimation(),null===(a=this.slots)||void 0===a||a.hideWinOrNoWinIndication(),null===(G=this.background)||void 0===G||G.hideWinlines(),null===(N=this.foreground)||void 0===N||N.hideWinAmounts(),null===(W=this.slots)||void 0===W||W.spin(K,t,D)}shuffle({spinMode:t}){var K,D,a,G;this.winlineManager.hideAnimation(),null===(K=this.slots)||void 0===K||K.hideWinOrNoWinIndication(),null===(D=this.background)||void 0===D||D.hideWinlines(),null===(a=this.foreground)||void 0===a||a.hideWinAmounts(),null===(G=this.slots)||void 0===G||G.shuffle(t)}slamStop(){var t;null===(t=this.slots)||void 0===t||t.slamStop()}async stop(t){var K;await(null===(K=this.slots)||void 0===K?void 0:K.stop({...t,paylineIds:y(t.paylinesAndPayouts)}))}updateTheme(t){var K;null===(K=this.background)||void 0===K||K.updateTheme(t)}async playWinningLinesAnimation(t){var K,D,a;const G=y(t.paylinesAndPayouts),N={...t,paylineIds:G},W=!t.hideYouWinOnLowCelebration||t.hideYouWinOnLowCelebration&&t.winAmount>t.totalBet;t.paylinesAndPayouts.length>0&&(this.winlineManager.showAnimation(),null===(K=this.slots)||void 0===K||K.showWinOrNoWinIndication(N),null===(D=this.background)||void 0===D||D.showWinlines(N),null===(a=this.foreground)||void 0===a||a.showWinAmounts(t),W&&i.A(iK[t.qualificationWinType])),await this.winlineManager.waitForAnimation(N)}prepareForQualifiedAnimation({outcome:t}){var K,D,a;const{slots:G}=this;if(void 0===G)return;null===(K=this.winlineManager)||void 0===K||K.hideAnimation(),G.hideWinOrNoWinIndication(),null===(D=this.background)||void 0===D||D.hideWinlines(),null===(a=this.foreground)||void 0===a||a.hideWinAmounts();const N=q.K_(t);return null!==N?N.map(((t,K)=>{const D=G.getSymbol(K,t);return{position:function(t,K){const D=K.container;return t.stage.worldTransform.applyInverse(D.getGlobalPosition())}(this.app.app,D),size:this.gameDimensions.symbolSize,symbolName:D.symbolName}})):void 0}dispose(){this.disposeBag.dispose()}hide(t){const{slots:K,background:D,foreground:a}=this;if(void 0===K||void 0===D||void 0===a)return;const G={_alpha:K.alpha,get alpha(){return this._alpha},set alpha(t){this._alpha=t,K.alpha=t,D.alpha=t,a.alpha=t}};Z.l({anim:z.X({target:G,destinationAlpha:0,durationIn:t/1e3}),repeat:0,ticker:e._,dispose:!1})}createSlotsMask(){const t=.115,K=.115,D=.02,a=[{color:0,stop:0},{color:0,stop:t},{color:16711680,stop:t+D},{color:16711680,stop:.5},{color:16711680,stop:1-K-D},{color:0,stop:1-K},{color:0,stop:1}],G=new b._2(0,0,0,this.gameDimensions.slotSize.height);a.forEach((({color:t,stop:K})=>{G.addColorStop(K,t)}));const N=(new b.A1g).rect(0,0,1,this.gameDimensions.slotSize.height).fill(G),W=this.app.app.renderer.generateTexture({target:N});return{sprite:b.kxk.from(W),texture:W,graphic:N,fill:G}}get gameDimensions(){return new Kt(this.app.app.renderer,this.device)}}var IK=D(837925),ZK=D(728920);function wK({visible:t}){const K=G.wA(),D=a.useContext(N.TO),b=G.d4(IK.vt),n=G.d4(IK.al),e=W.V((t=>t.currencySymbol)),i=x.O();return a.useEffect((()=>{if(!D)return;const t=new zK(D,i);return t.init(null!=n?n:q.CF("FORBID_SCATTERS"),b,e),K(ZK.Dj(t)),()=>{K(ZK.FZ())}}),[D]),a.useEffect((()=>{t||K(ZK.WH())}),[t]),null}},737697:(t,K,D)=>{D.d(K,{CF:()=>N,Ft:()=>w,K_:()=>W,SX:()=>e,a8:()=>i,b3:()=>z,hK:()=>b,js:()=>Z,t$:()=>I,tj:()=>x});var a=D(145331),G=D(730996);function N(t){return Array.from({length:a.AX},(()=>Array.from({length:a.oW},(()=>G.Qp(t)))))}function W(t){const K=[];for(const D of t){const t=D.findIndex(G.xQ);if(-1===t)return console.error("getScattersPositions should be invoked with 'qualificating' outcome"),null;K.push(t)}return K}function x(t){return t.map((t=>t.findIndex(G.xQ)))}function b(t){return x(t).map((t=>t>-1&&t<2))}function n(t){return 3===t.length&&t.every(G.zK)}function e(t,K){if(K.every((t=>null===t)))return t;const D=[];return t.forEach(((t,a)=>{let G=[...t];const N=K[a];null!==N&&(G=[N,t[0],t[1]]),D.push(G)})),3===(a=D).length&&a.every(n)?D:t;var a}function i(t){const K=t.findIndex(G.xQ);return-1===K?null:K}function z(t){return t.reduce(((t,K,D)=>(G.pq(K)&&t.push(D),t)),[])}function I(t){return t.every((t=>t.some(G.xQ)))}function Z(t){return t.some((t=>t.some(G.xQ)))}function w(t,K){return t.every(((t,D)=>t.every(((t,a)=>t===K[D][a]))))}},145331:(t,K,D)=>{D.d(K,{AX:()=>a,oW:()=>G});const a=3,G=3},728920:(t,K,D)=>{D.d(K,{BZ:()=>I,Dj:()=>Z,FZ:()=>w,H0:()=>d,Jx:()=>e,MC:()=>i,V_:()=>E,WH:()=>m,ek:()=>x,gu:()=>b,iF:()=>u,p5:()=>z,py:()=>n});var a=D(737697),G=D(131087),N=D(837925),W=D(931170);function x({turboModeIsOn:t,shuffle:K,minSpinDuration:D,spinMode:a}){return(W,x,{slotMachineContainer:b})=>{const n=Date.now()+D;W(G.Ao()),W(G.wL(n));const e=b.get();if(!e)throw new Error("Slot machine is not initialized, cannot start");if(K)e.shuffle({spinMode:null!=a?a:"Normal"});else{const K=x();e.start({spinMode:null!=a?a:"Normal",turboModeIsOn:t,nextSymbols:N.Ro(K)})}}}function b(t){return async(K,D,{slotMachineContainer:a})=>{const W=D();if(!N.xl(W))return;const x=N.Fo(W),b=N.Ww(W)?0:x-Date.now(),n=a.get();await(null==n?void 0:n.stop({...t,timeToFullyStop:b})),K(G.zE(t.nextSymbols)),K(G.g7(t.outcome))}}function n(){return async(t,K,{slotMachineContainer:D})=>{const a=K();if(!N.OM(a))return;const W=D.get();null==W||W.slamStop(),t(G.FU())}}function e(t){return async(K,D,{slotMachineContainer:a,getAG:G})=>{var W,x;const b=D();if(N.xl(b))return;const n=Boolean(G().settings.autoplayApiEnabled()&&(null===(x=null===(W=G().autoplay)||void 0===W?void 0:W.isRunning)||void 0===x?void 0:x.value)),e=a.get();await(null==e?void 0:e.playWinningLinesAnimation({...t,autoplay:n}))}}function i(t){return async(K,D,{slotMachineContainer:W})=>{const n=D();if(N.hY(n))return void K(G.L9(t));const e=N.al(D());if(null!==e&&(a.Ft(t,e)||!a.js(t)&&!a.js(e)))return;await W.getAsync(),K(G.Qb()),N.xl(n)||K(x({turboModeIsOn:!1,shuffle:!0,minSpinDuration:300})),await K(b({outcome:t,paylinesAndPayouts:[],qualified:!1,winAmount:1,nextSymbols:[null,null,null]})),K(G.Y8());const z=D(),I=N.jM(z);null!==I&&(K(G.Iu()),K(i(I)))}}function z(t){return(K,D)=>{N.xl(D())&&K(b({outcome:t,paylinesAndPayouts:[],qualified:!1,winAmount:0,nextSymbols:[null,null,null]}))}}function I(t){return async(K,D,{slotMachineContainer:a})=>{var G;const N=a.get(),x=null==N?void 0:N.prepareForQualifiedAnimation({...t});void 0!==x&&K(W.z({scattersData:x,totalMultiplier:null!==(G=t.totalScatterMultiplier)&&void 0!==G?G:1}))}}function Z(t){return(K,D,{slotMachineContainer:a})=>{a.set(t)}}function w(){return(t,K,{slotMachineContainer:D})=>{D.dispose()}}function m(){return(t,K,{slotMachineContainer:D})=>{const a=D.get();null==a||a.hide(500)}}function u(t){return K=>{K(G.WS(t))}}function d(){return t=>{t(G.WS(a.CF("FORBID_SCATTERS")))}}function E(t){return async(K,D,{slotMachineContainer:a})=>{const G=await a.getAsync();null==G||G.updateTheme(t)}}},521942:(t,K,D)=>{D.d(K,{E:()=>G,u:()=>N});var a=D(737697);const G=void 0,N={spinningEndingTime:G,isShuffling:!1,isSlamStopping:!1,nextShuffleOutcome:null,currentOutcome:a.CF("FORBID_SCATTERS"),nextSymbols:[null,null,null]}},730996:(t,K,D)=>{D.d(K,{Es:()=>b,PE:()=>I,Qp:()=>n,pq:()=>i,rv:()=>a,xQ:()=>e,zK:()=>z});const a=14,G=[0,11,12,13,14],N=[1,9,10],W=[5,6],x=[7,8],b=["Phone","Wild","Seven","Cherry","Bar","Scatter"];function n(t="NO_LIMITS"){const K="FORBID_SCATTERS"===t?1:0,D="NO_LIMITS"!==t?a-(G.length-1)-(N.length-1):a,W=Math.floor(Math.random()*(D-K)+K);return 2===W?D:W}function e(t){return G.includes(t)}function i(t){return N.includes(t)}function z(t){return[0,1,3,4,5,11,12,13,14,9,10,6,7,8].includes(t)}function I(t){return e(t)?"Scatter":i(t)?"Wild":function(t){return W.includes(t)}(t)?"Seven":function(t){return x.includes(t)}(t)?"Bar":3===t?"Phone":"Cherry"}},131087:(t,K,D)=>{D.d(K,{Ao:()=>n,FU:()=>b,Iu:()=>i,L9:()=>e,Qb:()=>z,WS:()=>N,Y8:()=>I,YB:()=>Z,g7:()=>x,wL:()=>G,zE:()=>W});var a=D(521942);function G(t){return{type:"dondSlotGame/SPIN_DOND_SLOT_GAME",payload:t}}function N(t){return{type:"dondSlotGame/SET_CURRENT_OUTCOME",payload:t}}function W(t){return{type:"dondSlotGame/SET_NEXT_SYMBOLS",payload:t}}function x(t){return{type:"dondSlotGame/STOP_DOND_SLOT_GAME",payload:t}}function b(){return{type:"dondSlotGame/SLAM_STOP_DOND_SLOT_GAME"}}function n(){return{type:"dondSlotGame/END_SLAM_STOP_DOND_SLOT_GAME"}}function e(t){return{type:"dondSlotGame/SET_NEXT_SHUFFLE_OUTCOME",payload:t}}function i(){return e(null)}function z(){return{type:"dondSlotGame/START_SHUFFLE"}}function I(){return{type:"dondSlotGame/STOP_SHUFFLE"}}function Z(t=a.u,K){switch(K.type){case"dondSlotGame/SET_CURRENT_OUTCOME":return{...t,currentOutcome:K.payload};case"dondSlotGame/SPIN_DOND_SLOT_GAME":return{...t,spinningEndingTime:K.payload};case"dondSlotGame/SET_NEXT_SYMBOLS":return{...t,nextSymbols:[...K.payload]};case"dondSlotGame/STOP_DOND_SLOT_GAME":return t.spinningEndingTime===a.E?t:{...t,currentOutcome:K.payload,spinningEndingTime:a.E};case"dondSlotGame/SET_NEXT_SHUFFLE_OUTCOME":return{...t,nextShuffleOutcome:K.payload};case"dondSlotGame/START_SHUFFLE":return{...t,isShuffling:!0};case"dondSlotGame/STOP_SHUFFLE":return{...t,isShuffling:!1};case"dondSlotGame/SLAM_STOP_DOND_SLOT_GAME":return{...t,isSlamStopping:!0};case"dondSlotGame/END_SLAM_STOP_DOND_SLOT_GAME":return{...t,isSlamStopping:!1};default:return t}}},837925:(t,K,D)=>{D.d(K,{Fo:()=>n,OM:()=>z,Ro:()=>u,Ww:()=>e,al:()=>w,hY:()=>Z,jM:()=>m,vt:()=>I,xl:()=>b});var a=D(160739),G=D(641286),N=D(13799),W=D(521942);function x(t){return t.dondSlotGame}const b=a.Mz(x,(t=>t.spinningEndingTime!==W.E)),n=a.Mz(x,(t=>{var K;return null!==(K=t.spinningEndingTime)&&void 0!==K?K:0})),e=a.Mz(x,(t=>t.isSlamStopping)),i=a.Mz(N.DB,(t=>{var K;return"true"===(null===(K=null==t?void 0:t.rawConfig)||void 0===K?void 0:K.slam_stop_slot)})),z=a.Mz(i,b,((t,K)=>t&&K)),I=a.Mz(N.DB,(t=>({normal:{startDelay:1e3*G.R(t.rawConfig.normal_spin_start_delay,.1),stopDelay:1e3*G.R(t.rawConfig.normal_spin_stop_delay,.6),spinVelocity:G.R(t.rawConfig.normal_spin_velocity,30),startBounceFactor:G.R(t.rawConfig.normal_spin_start_bounce_factor,.1),startBounceDuration:G.R(t.rawConfig.normal_spin_start_bounce_duration,.05),stopBounceFactor:G.R(t.rawConfig.normal_spin_stop_bounce_factor,.2),stopBounceDuration:G.R(t.rawConfig.normal_spin_stop_bounce_duration,.1),bounceType:G.Q(t.rawConfig.normal_spin_bounce_type,0),numberOfBounces:G.Q(t.rawConfig.normal_spin_number_of_bounces,0),deaccelerationDistance:G.R(t.rawConfig.normal_spin_deacceleration_distance,0),deaccelerationFinalVelocity:G.R(t.rawConfig.normal_spin_deacceleration_final_velocity,0)},nudge:{startDelay:1e3*G.R(t.rawConfig.nudgable_spin_start_delay,0),stopDelay:1e3*G.R(t.rawConfig.nudgable_spin_stop_delay,0),spinVelocity:G.R(t.rawConfig.nudgable_spin_velocity,.5),startBounceFactor:G.R(t.rawConfig.nudgable_spin_start_bounce_factor,0),startBounceDuration:G.R(t.rawConfig.nudgable_spin_start_bounce_duration,0),stopBounceFactor:G.R(t.rawConfig.nudgable_spin_stop_bounce_factor,.1),stopBounceDuration:G.R(t.rawConfig.nudgable_spin_stop_bounce_duration,.48),bounceType:G.Q(t.rawConfig.nudgable_spin_bounce_type,0),numberOfBounces:G.Q(t.rawConfig.nudgable_spin_number_of_bounces,0),deaccelerationDistance:G.R(t.rawConfig.nudgable_spin_deacceleration_distance,0),deaccelerationFinalVelocity:G.R(t.rawConfig.nudgable_spin_deacceleration_final_velocity,0)},nudgeSpinVelocityTurbo:G.R(t.rawConfig.nudgable_spin_velocity_turbo,.91),nearWinSpeedMultiplier:G.R(t.rawConfig.near_win_speed_multiplier,2.8)}))),Z=a.Mz(x,(t=>t.isShuffling)),w=a.Mz(x,(t=>t.currentOutcome)),m=a.Mz(x,(t=>t.nextShuffleOutcome)),u=a.Mz(x,(t=>t.nextSymbols))},931170:(t,K,D)=>{D.d(K,{V:()=>N,z:()=>G});const a="dondSlotGame/signal/PLAY_QUALIFIED_ANIMATION";function G(t){return{type:a,payload:t}}function N(t){return"object"==typeof t&&null!==t&&"type"in t&&t["type"]===a}},556972:(t,K,D)=>{D.d(K,{ky:()=>h,Zq:()=>y,H4:()=>J,gn:()=>X,t0:()=>q});var a=D(263601),G=D(929468),N=D(967810),W=D(784596),x=D(283503),b=D(241665),n=D(443505),e=D(97908),i=D(179062),z=D(756437),I=D(87245),Z=D(881357),w=D(394532),m=D(728920),u=D(655648),d=D(541310),E=D(357223),l=D(727798),Q=D(730837),P=D(79697);const y=(t,K,{getAG:D})=>{const W=D(),x=K();t(N.Dh()),t(e.I(i.z.Standard)),t(d.Ns(E.WN(x),Q.xf(x)));const b=P.Y(x),I=W.settings.getChipAmounts().filter((t=>t>=b.min&&t<=b.max));W.betAmounts.setBetAmounts(I);const{max:w}=n.B(x);W.betAmounts.setMaxEnabledAmount(w),W.autoplayUI.closeSettings(),W.lifecycle.openBets(),t(l._w(!1)),t(m.iF(Q.se(x))),W.setGameRoundId(G.A("round_id"));const u=W.betAmounts.lastSelectedAmount.subscribe((function(t){Q.kC(K())||(W.balance.setTotalBet(t),W.balance.setTotalBetToRepeat(t))}),!0),y=a.A((()=>{Q.kC(K())||t(m.MC(Q.se(K())))}),100),q=Z.vT({betAmount:W.betAmounts.lastSelectedAmount,betModifier:W.betAmounts.betModifier}).subscribe(y,!0);return t(z.aj(W.settings.getQualificationVolumeMultiplier())),()=>{t(m.H0()),u(),q()}},q=(t,K,{getAG:D})=>{var a;const G=K(),N=D(),n=window.__predictableBeState_betAmounts?window.__predictableBeState_betAmounts:N.betAmounts.lastSelectedAmount.value/N.betAmounts.betModifier.value,e=E.WN(G),i=Q.Tx(G);t(function({betAmount:t,spinMode:K}){return(D,a,{getAG:G})=>{const N=G(),W={type:"dond.spin",args:{betAmount:t,spinMode:K,betTags:u.F(a())}};N.transport.sendStandardMessage(null,W)}}({betAmount:n,spinMode:e})),N.lifecycle.closeBets(),N.gameResult.setAmount(0),N.balance.reserveBet(N.betAmounts.lastSelectedAmount.value),N.balance.pauseBalanceUpdate(),t(m.ek({turboModeIsOn:i,shuffle:!1,minSpinDuration:Q.RV(G),spinMode:e}));const z=null===(a=N.autoplay)||void 0===a?void 0:a.isRunning.value,Z=I.gY(G);N.log(b.pX({amount:Z,spinId:Q.xf(G),codes:W.O({gameState:"Qualifying",amount:Z,spinMode:e}),type:x.P({gamePhase:"Qualification",trigger:z?"AutoPlay":"Click",isTurbo:i}),timeBeforeNextQualification:Q.lX(G)}))},X=(t,K,{getAG:D})=>{const a=K(),{autoplay:G,log:N}=D(),W=null==G?void 0:G.isRunning.value,x=E.WN(a),n=Q.xf(a);W||(N(b.Vu({gamePhase:"Qualification",playerGameId:n,baseBet:Q.xv(a),spinMode:x})),t(m.py()))};function h(t){return async(K,D,{getAG:a})=>{var G,N,W,x;const n=a(),e=null!==(N=null===(G=n.autoplay)||void 0===G?void 0:G.isRunning.value)&&void 0!==N&&N?"OneAnimation":"CyclingAnimation";if(await K(m.gu(t)),n.gameResult.setAmount(t.winAmount),n.balance.reserveBet(0),n.balance.resumeBalanceUpdate(),await K(m.Jx({...t,totalBet:n.balance.totalBet.value,winlineAnimationMode:e,hideYouWinOnLowCelebration:n.settings.hideYouWinOnLowCelebration()})),t.qualified){K(l._w(!0)),null===(W=n.autoplay)||void 0===W||W.stop(w.G_.RoundsEnded),n.autoplayUI.closeSettings(),n.log(b.AD({finalMultiplier:null!==(x=t.totalScatterMultiplier)&&void 0!==x?x:1})),await K(m.BZ(t));const a=Q.xf(D());K(d.h$(a))}else n.lifecycle.openBets()}}function J(t){return(K,D,{getAG:a})=>{var G,N,W;const n=D(),e=a();e.log(b.VT({amount:I.gY(n),spinId:Q.xf(n),errorId:t.code,errorMessage:null!==(G=t.msg)&&void 0!==G?G:"",type:x.P({gamePhase:"Qualification",trigger:(null===(N=e.autoplay)||void 0===N?void 0:N.isRunning.value)?"AutoPlay":"Click",isTurbo:Q.Tx(n)})})),K(m.p5(Q.se(n))),e.lifecycle.openBets(),e.balance.reserveBet(0),e.balance.resumeBalanceUpdate(),null===(W=e.autoplay)||void 0===W||W.stop(w.G_.MissedRound)}}},727798:(t,K,D)=>{D.d(K,{km:()=>e,Tp:()=>n,Zw:()=>b,_w:()=>x,pI:()=>W,Xh:()=>N,UL:()=>G});const a={turboModeIsOn:!1,backendAllowsSpin:!1,slotStates:[],isPlayerQualified:!1,playerGameId:"",nextQualificationClosesIn:0};function G(){return{type:"qualification/TOGGLE_TURBO_MODE"}}function N(t){return{type:"qualification/SET_SPIN_ALLOWED",payload:t}}function W(t){return{type:"qualification/SET_SLOT_STATES",payload:t}}function x(t){return{type:"qualification/SET_PLAYER_QUALIFIED",payload:t}}function b(t){return{type:"qualification/SET_PLAYER_GAME_ID",payload:t}}function n(t){return{type:"qualification/NEXT_QUALIFICATION_CLOSE_IN",payload:t}}function e(t=a,K){switch(K.type){case"qualification/TOGGLE_TURBO_MODE":return{...t,turboModeIsOn:!t.turboModeIsOn};case"qualification/SET_SPIN_ALLOWED":return{...t,backendAllowsSpin:K.payload};case"qualification/SET_SLOT_STATES":return{...t,slotStates:K.payload};case"qualification/SET_PLAYER_QUALIFIED":return{...t,isPlayerQualified:K.payload};case"qualification/SET_PLAYER_GAME_ID":return{...t,playerGameId:K.payload};case"qualification/NEXT_QUALIFICATION_CLOSE_IN":return{...t,nextQualificationClosesIn:K.payload};default:return t}}},730837:(t,K,D)=>{D.d(K,{RB:()=>d,RV:()=>y,Tx:()=>u,jN:()=>m,kC:()=>h,lX:()=>T,se:()=>X,w7:()=>w,xf:()=>J,xv:()=>q});var a=D(160739),G=D(641286),N=D(87245),W=D(949570),x=D(13799),b=D(55798),n=D(837925),e=D(737697),i=D(357223),z=D(301258),I=D(79697);function Z(t){return t.qualification}const w=a.Mz(N.gY,W.eu,((t,K)=>K>=t)),m=a.Mz(b.yq,Z,n.xl,N.gY,I.Y,W.eu,i.WN,((t,K,D,a,G,N,W)=>t&&K.backendAllowsSpin&&!D&&a>=G.min*z.n[W]&&a<=G.max*z.n[W]&&N>=a)),u=a.Mz(Z,(t=>t.turboModeIsOn)),d=a.Mz(x.DB,(t=>{var K;return"true"===(null===(K=null==t?void 0:t.rawConfig)||void 0===K?void 0:K.turbo_spin_enabled)})),E=1600,l=a.Mz(x.DB,(t=>G.Q(t.rawConfig.turbo_spin_duration,E))),Q=2e3,P=a.Mz(x.DB,(t=>G.Q(t.rawConfig.slot_spin_duration,Q))),y=a.Mz(u,l,P,((t,K,D)=>t?K:D)),q=a.Mz(N.gY,N.Zk,((t,K)=>t/K)),X=a.Mz(Z,i.WN,q,((t,K,D)=>{var a,G;return null!==(G=null===(a=t.slotStates.find((t=>t.key.spinMode===K&&t.key.betAmount===D)))||void 0===a?void 0:a.value.grid)&&void 0!==G?G:e.CF("FORBID_SCATTERS")})),h=a.Mz(Z,(t=>t.isPlayerQualified)),J=a.Mz(Z,(t=>t.playerGameId)),T=a.Mz(Z,(t=>t.nextQualificationClosesIn))},79697:(t,K,D)=>{D.d(K,{Y:()=>W});var a=D(160739),G=D(443505),N=D(13799);const W=a.Mz(N.DB,G.B,((t,K)=>{const D=t.getChipAmounts().filter((D=>D>=K.min&&D>=t.qualificationSpinMinBet()&&D<=K.max&&D<=t.qualificationSpinMaxBet()));return{min:Math.min(...D),max:Math.max(...D)}}))},443505:(t,K,D)=>{D.d(K,{B:()=>N});var a=D(160739),G=D(13799);const N=a.Mz(G.DB,(t=>({min:t.isTableBetMinLimitSet()?t.getTableBetMinLimit():0,max:t.isTableBetMaxLimitSet()?t.getTableBetMaxLimit():1/0})))},816340:(t,K,D)=>{D.d(K,{F:()=>b,K:()=>W});var a=D(160739),G=D(13799);const N="true",W=a.Mz(G.DB,(t=>"true"===(t.rawConfig.enable_XXXtreme_spins||N))),x=!1,b=a.Mz(G.DB,(t=>"true"===(t.rawConfig.disable_featureBuy||x)))},977927:(t,K,D)=>{D.d(K,{A:()=>G});var a=D(764522);function G(t,...K){a.triggerEvent(t,...K)}},842092:(t,K,D)=>{D.d(K,{v:()=>Z});var a=D(64922),G=D(377810),N=D(282427),W=D(802548),x=D(977927),b=D(872496),n=D(170935),e=D(50141),i=D(909141),z=D(838998),I=D(304166);const Z=()=>{const t=e._(),K=N.d4(i.NJ),D=G.useRef(null),Z=N.d4(I.Ww),[w,m]=G.useState("#43360F"),u=N.d4(i.w7),d=G.useCallback((()=>{x.A("TopUpButtonSpinRelease"),t(z.HJ())}),[t]),E=G.useCallback((()=>{x.A("TopUpButtonSpinPress")}),[]),l=G.useCallback((()=>{x.A("TopUpButtonSpinReleaseOutside")}),[]),Q=G.useCallback((()=>{Z||t(z.gn)}),[t,Z]),P=G.useCallback((()=>{K?d():Q()}),[K,Q,d]);n.G(P);const y=G.useCallback((()=>{m("#82621F")}),[]),q=G.useCallback((()=>{m("#43360F")}),[]);return a.jsx(W.h,{onClick:d,onPress:E,onMouseEnter:y,onMouseLeave:q,onReleaseOutside:l,disabled:!K,onDisabledClick:Q,labelText:b.T("spinButton.topUp"),layerStyles:{fill:{default:"radial-gradient(55.35% 58.82% at 50% 33.09%, #E2AE48 0%, #805500 100%)",hover:"radial-gradient(55.35% 58.82% at 50% 33.09%, #E2AE48 0%, #E2AE48 65%, #805500 100%)"},underlayer:{default:w,activated:"linear-gradient(180deg, #685017 0%, #82621F 100%)"},stroke:{default:"#E2AE48"},border:{outer:"linear-gradient(0deg, #876A27 0%, #EFC558 29.99%, #F8E39B 46.19%, #C49F44 63.9%, #EFC759 87.03%, #FFFCD5 100%)",inner:"linear-gradient(358deg, #D1B65F 1.79%, #DFB755 26.54%, #FFED8E 47.96%, #CFA043 71.05%, #9B7827 97.76%)"}},ref:D,tooltip:u?void 0:"tooltip.balanceTooLow"})}},748398:(t,K,D)=>{D.d(K,{w:()=>et});var a=D(64922),G=D(377810),N=D(282427),W=D(160739),x=D(967810),b=D(13799),n=D(554267);const e=W.Mz(x.Yq,b.DB,((t,K)=>{const D=(a=t.speedMode,K.reduceSpinTimeDuringSpeedMode()&&a===n.hR.Fast?.5:1);var a;return{middleReelStartDelay:K.getMiddleReelStartDelay()/1e3*D,outerReelStartDelay:K.getOuterReelStartDelay()/1e3*D,innerReelSpinTime:K.getInnerReelSpinTime()/1e3*D,middleReelSpinTime:K.getMiddleReelSpinTime()/1e3*D,middleReelQualifyingSpinTime:K.getMiddleReelQualifyingSpinTime()/1e3*D,outerReelSpinTime:K.getOuterReelSpinTime()/1e3*D,outerReelQualifyingSpinTime:K.getOuterReelQualifyingSpinTime()/1e3*D,topUpSpinTime:K.getTopUpSpinTime()/1e3*D,timeMultiplier:D}}));var i,z=D(244160),I=D(699695),Z=D(266600),w=D(361494);(function(t){t["RingOut"]="ringOut",t["RingMid"]="ringMid",t["RingInn"]="ringInn",t["Lock"]="lock",t["WinProgress"]="winProgress",t["TopUp"]="topUp",t["TopUpSectorLight"]="topUpSectorLight",t["WinAnimation"]="winAnimation",t["WinSectorAnimation"]="winSectorAnimation",t["WheelTransition"]="wheelTransition",t["Timer"]="timer"})(i||(i={}));var m=D(434036),u=D(924958),d=D(695620),E=D(346160),l=D(718284),Q=D(382297),P=D(221770),y=D(587698),q=D(775286);let X=null;const h=l.A((t=>{let K;return()=>{if(K)return K;const D=1024;K=document.createElement("canvas"),K.width=D,K.height=D;const a=K.getContext("2d");return a&&function(t,K,D,a,G){t.translate(D,a);const N=K.map((t=>d.cQ(t)?P.i(t):t%1>0?y.ej(t):t.toString())),W=Math.max(...N.map((t=>t.replace(/[,.]/g,"").length)));N.forEach(((K,D)=>{const a=Q.up*(6+360*(D-3)/Q.z2.length);t.save(),t.rotate(a);const N=K.toString().split(""),x=128;let b=0;N.forEach(((K,D)=>{t.save();let a=45*(1-.15*D);switch(W){case 1:case 2:case 3:a*=1.6;break;case 4:a*=1.4;break;default:a*=1.3}t.font=`${Q.Wo} ${a}px ${Q.Zn}, sans-serif`,t.fillStyle="white",t.textBaseline="middle",t.textAlign="center","."!==K&&","!==K||(b-=.5*a),t.translate(G/2-b-a/3-x,0),t.rotate(Math.PI/2),t.shadowOffsetX=1,t.shadowOffsetY=1,t.shadowBlur=3,t.shadowColor="rgba(0,0,0,0.3)",t.fillText(K,0,0),b+=.9*a,t.restore()})),t.restore()}))}(a,t,D/2,D/2,905),K}}),(t=>t[0]));var J=D(399158),T=D(262073),_=D(126409);class C extends G.Component{constructor(){super(...arguments),this.redraw=t=>{const K=J.t.getInstance();K.applySceneChanges(t),K.render()},this.setContainer=t=>{if(t){const K=J.t.getInstance(),D=K.domElement;t.appendChild(D),K.setSize(),K.applyDebugProps(this.props.debugProps||T.I_),this.props.onReady(this.redraw)}}}render(){return a.jsx("div",{className:_.A.container,ref:this.setContainer})}componentDidMount(){this.applyProps(),this.applyTitle(this.props.title),this.applyLangDirection(this.props.isRtl)}componentDidUpdate(t){this.applyProps(),t.title!==this.props.title&&this.applyTitle(this.props.title),t.isRtl!==this.props.isRtl&&this.applyLangDirection(this.props.isRtl)}applyProps(){const t=J.t.getInstance();t.applyDebugProps({...T.I_,...this.props.debugProps}),t.updateLabelsImage(function(t){if(!X){const t=q.t_(Q.Zn);null!=X||t||q.Al(Q.Zn).then((()=>{X=!0})),X=t}return h(t)}(this.props.topUpPrizesList)),t.render()}applyTitle(t){J.t.getInstance().setTitle(t)}applyLangDirection(t){J.t.getInstance().setLangDirection(t)}}var H=D(710928);const o="wheelWrapper--67354",U="timerPlaceholder--53c68",V="delayHidden--4a750",s="topUpPrizeAmountTooltip--3f856";class F extends G.PureComponent{constructor(){super(...arguments),this.state={isTooltipShown:!1},this.onMouseEnter=()=>{this.props.enabled&&this.setState({isTooltipShown:!0})},this.onMouseLeave=()=>{this.props.enabled&&this.setState({isTooltipShown:!1})}}render(){return a.jsxs("div",{className:s,children:[a.jsx("svg",{viewBox:"0 0 400 400",children:a.jsx("polygon",{points:"192,175 207,175 233,57 230,53 208,51 200,63 192,51 168,54 168,60 ",onMouseLeave:this.onMouseLeave,onMouseEnter:this.onMouseEnter})}),this.props.enabled&&a.jsx(H.m_,{isVisible:this.state.isTooltipShown,horizontalPosition:H.hV.Center,verticalPosition:H.Ne.Top,label:this.props.label})]})}}var c=D(10534);D(808966);class g{constructor(){this._easingMode=g.EASINGMODE_EASEIN}setEasingMode(t){const K=Math.min(Math.max(t,0),2);this._easingMode=K}getEasingMode(){return this._easingMode}easeInCore(t){throw new Error("You must implement this method")}ease(t){switch(this._easingMode){case g.EASINGMODE_EASEIN:return this.easeInCore(t);case g.EASINGMODE_EASEOUT:return 1-this.easeInCore(1-t)}return t>=.5?.5*(1-this.easeInCore(2*(1-t)))+.5:.5*this.easeInCore(2*t)}}g.EASINGMODE_EASEIN=0,g.EASINGMODE_EASEOUT=1,g.EASINGMODE_EASEINOUT=2;class R extends g{constructor(t=1){super(),this.amplitude=t}easeInCore(t){const K=Math.max(0,this.amplitude);return Math.pow(t,3)-t*K*Math.sin(3.141592653589793*t)}}var A=D(948733),Y=D(615473),L=D(505985);const S=2*Math.PI;class f{constructor(t,K){this.angle=0,this.speed=0,this.scale=0,this.angleTransition=null,this.speedTransition=null,this.scaleTransition=null,this.rotateToAngle=(t,K,{easing:D}={easing:g.EASINGMODE_EASEOUT})=>{if(K<=0)return void(this.angle=t);const a=B(this.angle,t),G=this.angle+a;let N=null;D&&(N=new R(.2),N.setEasingMode(D)),this.angleTransition=v(this.angle,G,K,N)},this.angle=t,this.speed=K}setAngle(t){this.angle=t}transitSpeedTo(t,K,D=0){K>0?this.speedTransition=v(this.speed,t,K,null,D):this.speed=t}slowdownToAngle(t,K=0,D=null,a=0){const G=this.speedTransition;this.cancelAllTransitions();const N=this.speed,W=this.angle;let x=0,b=0,n=0,e=0,i=0,z=0,I=0,Z=0,w=0,m=0,u=0,d=N,E=W,l=K;if(G){const t=G.getTimePassed(),D=G.getDuration(),a=G.getDelay(),e=Math.min(a+D,K),i=Math.max(a-t,0),z=Math.max(e-t-i,.001),Z=G.getValue(t),w=G.getValue(e);u=(w-Z)/z;const m=W+N*z+u*z*z/2;x=i,b=x+z,n=b,I=n,l=Math.max(0,l-z),d=w,E=m}if(Math.abs(d)<A.bH)return this.speed=0,null!==t&&(this.angle=t),{animationDuration:0,soundTime:0,stopAngle:this.angle};let Q=E,P=E,y=d,q=0;if(D){const t=Math.max(0,D.time-n);i=n+t,e=i,Q=E+d*t,y=d*D.multiplier,q=(y-d)/D.duration,P=Q+d*D.duration+q*D.duration*D.duration/2,z=i+D.duration,I=z,l=Math.max(0,l-t-D.duration)}const X=y<0?-1:1,h=25*L.up*X,J=-.3*y,T=Math.abs(h/J),_=l-T;let C=t;if(null===C){const t=P+y*_;C=Math.ceil(t/a)*a}const H=P+y*_,o=H+O(H,C+h,X);w=I+(o-P)/y,Z=w,m=w+T;const U=O(o,C,-X),V=o+U,s=t=>{let K=W;if(t<x)return K;if(t>=x&&t<b&&(K=W+N*(t-=x)+u*t*t/2),t>=n&&t<e){const D=Y.X.Normalize(t,n,e);K=Y.X.Denormalize(D,E,Q)}if(t>=i&&t<z&&(K=Q+d*(t-=i)+q*t*t/2),t>=I&&t<Z){const D=Y.X.Normalize(t,I,Z);K=Y.X.Denormalize(D,P,o)}if(t>=w){const D=Y.X.Clamp(Y.X.Normalize(t,w,m));K=Y.X.Denormalize(D,o,V)}return K};let F=0;return this.angleTransition={getDuration:()=>m,getDelay:()=>0,getTimePassed:()=>F,evaluate:t=>(F+=t,s(F)),getValue:s,isDone:()=>F>=m},{animationDuration:m,soundTime:w,stopAngle:C}}scaleTo(t,K,D=0){const a=new R(.2);a.setEasingMode(g.EASINGMODE_EASEOUT),this.scaleTransition=v(this.scale,t,K,a,D)}updateState(t){if(!(t<=0)){if(this.angleTransition)this.angle=this.angleTransition.evaluate(t),this.angleTransition.isDone()&&(this.angleTransition=null,this.speed=0);else if(this.speedTransition){const K=this.speed;this.speed=this.speedTransition.evaluate(t);const D=K*t+(this.speed-K)/t*t*t/2;this.angle=$(this.angle+D),this.speedTransition.isDone()&&(this.speedTransition=null)}this.angle=$(this.angle+this.speed*t),this.scaleTransition&&(this.scale=this.scaleTransition.evaluate(t),this.scaleTransition.isDone()&&(this.scaleTransition=null))}}getAngle(){return this.angle}getScale(){return this.scale}getSpeed(){return this.speed}reset(){this.cancelAllTransitions(),this.speed=0,this.scale=0}cancelAllTransitions(){this.angleTransition=null,this.speedTransition=null}}function $(t){return t%S+ +(t<0)*S}function B(t,K){const D=2*Math.PI,a=(K-t+Math.PI)%D-Math.PI;return a<-Math.PI?a+D:a}function O(t,K,D){let a=B(t,K);return a*D<0&&(a+=S*D),a}function v(t,K,D,a=null,G=0){let N=0;const W=N=>{if((N-=G)<0)return t;if(D<=0)return K;let W=Math.max(0,N);return W=Math.min(W/D,1),null!==a&&(W="function"==typeof a?a(W):a.ease(W)),Y.X.Denormalize(W,t,K)};return{evaluate:t=>(N+=t,W(N)),isDone:()=>N>=D+G,getDuration:()=>D,getDelay:()=>G,getTimePassed:()=>N,getValue:W}}const p=.5,j=(Math.PI,Q.z2.length),r=20,M=1;var k,tt;(function(t){t["Default"]="default",t["Spinning"]="spinning",t["Slowing"]="slowing"})(k||(k={})),function(t){t["Outer"]="outer",t["Middle"]="middle",t["Inner"]="inner"}(tt||(tt={}));class Kt{constructor(t,K,D){this.topUpWheelStatus=k.Default,this.spinStartTime=0,this.playSoundQueue=[],this.stopSoundQueue=[],this.delayedCalls=[],this.winAnimationCycle=function(t){let K=0;return{update:D=>(K+=D,K%=t,K/t)}}(p),this.wheelTransition=function(t){let K=t,D=t,a=0,G=0;return{tweenTo(N,W){K=t,D=N,a=0,G=W},evaluate(N){if(a+=N,G<=0)t=D;else{const N=Math.min(1,a/G);t=Y.X.Denormalize(N,K,D)}return t}}}(0);const a=D||Math.floor(Math.random()*j);this.topUpReelState=new f(Dt(a),0),this.setFinishTimestamp=t,this.onWheelChanged=K}getChanges(t,K){this.applyProps(K),this.executeDelayedCalls(t);const D=this.wheelTransition.evaluate(t),a=D>0,G=K.areBulbsAnimated,N={wheelTransition:{visibility:D},winAnimation:{visibility:G?1:0,scale:G?this.winAnimationCycle.update(t):0},winSectorAnimation:{visibility:K.qualified&&K.wheelStatus===z.Am.Finished?1:0}};if(K.timeSelector&&(N.timer={scale:K.timeSelector(Date.now())}),a){const D=K.areBulbsAnimated?1:0;this.topUpReelState.updateState(t),N.topUp={rotation:this.topUpReelState.getAngle()},N.topUpSectorLight={visibility:D}}return{drawChanges:N,soundChanges:this.getSoundChanges(t)}}applyProps(t){if(!this.props||this.props.wheelType!==t.wheelType){const K=c.qI,D=this.props?K.totalTime:0;this.wheelTransition.tweenTo(1,D),t.wheelStatus!==z.Am.Spinning&&this.topUpReelState.transitSpeedTo(0,0)}this.applyTopUpWheelStatus(t),this.props=t}applyTopUpWheelStatus(t){var K;const D=this.topUpWheelStatus;let a;if(t.wheelStatus===z.Am.Default?(a=k.Default,this.topUpReelState.transitSpeedTo(0,0)):t.wheelStatus===z.Am.Spinning?a=t.hasResults?k.Slowing:k.Spinning:(a=k.Default,this.topUpReelState.transitSpeedTo(0,0)),D!==a){if(this.topUpWheelStatus=a,D!==k.Spinning&&a===k.Spinning)this.transitTopUpToSpinning(t);else if(a===k.Slowing){D!==k.Spinning&&this.transitTopUpToSpinning(t);const K=this.transitTopUpToFinished(t)+Date.now();this.setFinishTimestamp(K)}this.onWheelChanged()}t.isSlamStopping&&!(null===(K=this.props)||void 0===K?void 0:K.isSlamStopping)&&(this.transitTopUpToFinished(t),this.setFinishTimestamp(Date.now()),this.onWheelChanged())}transitTopUpToSpinning(t){this.spinStartTime=Date.now(),this.topUpReelState.transitSpeedTo(r,M*t.spinnerConfig.timeMultiplier)}transitTopUpToFinished(t){const K=1e3*t.spinnerConfig.topUpSpinTime,D=Date.now()-this.spinStartTime,a=t.isSlamStopping?0:.001*Math.max(0,K-D);if(void 0===t.prize)return this.topUpReelState.cancelAllTransitions(),0;const G=Dt(t.prize);return 1e3*this.topUpReelState.slowdownToAngle(G,a).animationDuration}getSoundChanges(t){const K=[],D=[];for(let D=this.playSoundQueue.length-1;D>=0;D--){const a=this.playSoundQueue[D];a.delay-=t,a.delay<=0&&(this.playSoundQueue.splice(D,1),K.push({src:a.src,loop:a.loop}))}for(let K=this.stopSoundQueue.length-1;K>=0;K--){const a=this.stopSoundQueue[K];a.delay-=t,a.delay<=0&&(this.stopSoundQueue.splice(K,1),D.push(a.src))}return{play:K,stop:D}}executeDelayedCalls(t){for(let K=this.delayedCalls.length-1;K>=0;K--){const D=this.delayedCalls[K];D.update(t),D.isDone()&&this.delayedCalls.splice(K,1)}}}function Dt(t){return(-1-t)*(2*Math.PI/j)}class at extends G.Component{constructor(t){super(t),this.lastFrameTime=0,this.placeholderRef=G.createRef(),this.onViewReady=t=>{this.drawHandler=t},this.updateCanvas=t=>{var K;if(this.request=window.requestAnimationFrame(this.updateCanvas),null===(K=this.props.debugProps)||void 0===K?void 0:K.pauseFrameUpdate)return;if(this.props.wheelStatus===z.Am.Hidden)return;const D=t-this.lastFrameTime;this.lastFrameTime=t;const a=.001*D,{drawChanges:G,soundChanges:N}=this.wheelSpinner.getChanges(a,this.props);this.drawHandler&&!function(t,K){var D,a;if(void 0===t)return!1;const G=Z.A(w.A(t,i.Timer),w.A(K,i.Timer));if(!G)return!1;const N=t[i.Timer]?d.fE((null===(D=t[i.Timer])||void 0===D?void 0:D.scale)||0):void 0,W=K[i.Timer]?d.fE((null===(a=K[i.Timer])||void 0===a?void 0:a.scale)||0):void 0;return G&&N===W}(this.prevDrawChanges,G)&&(this.prevDrawChanges=G,this.drawHandler(G)),this.applySoundChanges(N)},this.showTimeRemainingTooltip=()=>{if(!this.placeholderRef.current||this.props.wheelStatus===z.Am.Hidden)return;const t=this.placeholderRef.current.getBoundingClientRect();this.props.addAbsTooltip({labelTranslationId:"nextGameShowStartsIn",left:t.left+t.width/2-this.props.gameDimensions.left,top:t.top+t.height/3-this.props.gameDimensions.top})},this.wheelSpinner=new Kt(t.setFinishTimestamp,t.onWheelChanged,t.prize)}shouldComponentUpdate(t){return this.props.onWheelChanged!==t.onWheelChanged||this.props.wheelType!==t.wheelType||this.props.wheelStatus!==t.wheelStatus||this.props.renderType!==t.renderType||this.props.hasResults!==t.hasResults||this.props.ringsBoughtCount!==t.ringsBoughtCount||this.props.qualified!==t.qualified||this.props.topUpPrizesList!==t.topUpPrizesList||this.props.prize!==t.prize||this.props.areBulbsAnimated!==t.areBulbsAnimated||this.props.debugProps!==t.debugProps||this.props.isDefaultWheelUnlocked!==t.isDefaultWheelUnlocked||this.props.isSlamStopping!==t.isSlamStopping}render(){const t={wheelType:this.props.wheelType,wheelStatus:this.props.wheelStatus,title:Gt(this.props),onReady:this.onViewReady,currencySymbol:this.props.currencySymbol,topUpPrizesList:this.props.topUpPrizesList,isRtl:this.props.isRtl,debugProps:this.props.debugProps,isSlamStopping:this.props.isSlamStopping},K=a.jsx(C,{...t});return a.jsxs("div",{className:I.A(o,{[V]:this.props.wheelStatus===z.Am.Hidden}),children:[K,void 0!==this.props.prize&&a.jsx(F,{enabled:this.props.wheelStatus===z.Am.Finished&&d.cQ(this.props.topUpPrizesList[this.props.prize]),label:`${this.props.currencySymbol} ${this.props.topUpPrizesList[this.props.prize]}`}),a.jsx("div",{className:U,ref:this.placeholderRef,onClick:this.showTimeRemainingTooltip})]})}componentDidMount(){this.request=window.requestAnimationFrame(this.updateCanvas)}componentDidUpdate(t){(t.wheelType!==this.props.wheelType||t.wheelStatus!==this.props.wheelStatus&&this.props.wheelStatus===z.Am.Hidden)&&this.stopSpinSound()}componentWillUnmount(){this.request&&window.cancelAnimationFrame(this.request),this.stopSpinSound()}applySoundChanges(t){t&&(t.stop.forEach((t=>{m.wr(t)})),t.play.forEach((({src:t,loop:K})=>{m.Ak(t,K)})))}stopSpinSound(){m.wr(u.t.WheelSpinning)}}function Gt(t){var K;return void 0!==(null===(K=t.debugProps)||void 0===K?void 0:K.title)?t.debugProps.title:t.isDefaultWheelUnlocked||3===t.ringsBoughtCount&&t.wheelType!==z.QZ.TopUp?E.Tl("wheelStatus.unlocked"):t.wheelType===z.QZ.TopUp?E.Tl("wheelStatus.topUp"):E.Tl("wheelStatus.locked")}var Nt=D(977927),Wt=D(232737),xt=D(185214),bt=D(304166),nt=D(284619);const et=({isMobile:t})=>{const K=N.d4(b.Ay),D=N.d4(e),W=N.d4(bt.oi),x=N.d4(bt.it),n=Wt.y(nt.GK),i=Wt.y(nt.Nr),I=Wt.y(xt.$y),Z=N.d4(bt.u2),w=N.d4(bt.MX),m=N.d4(bt.vo),u=N.d4(bt.fh),d=N.d4(bt.So),l={ringsBoughtCount:1,qualified:!0,wheelType:z.QZ.TopUp,isDefaultWheelUnlocked:!1,renderType:"3d",topUpPerformed:!1,currencySymbol:"$"},Q=G.useRef(new Set),P=G.useCallback((t=>{const K=Math.max(u-t,0);if(K>=1e3&&K<11e3){const t=Math.floor(K/1e3);Q.current.has(t)||(Q.current.add(t),Nt.A("TopUpCounter",t))}return K}),[u]);return a.jsx(at,{isMobile:t,spinnerConfig:D,wheelStatus:W,areBulbsAnimated:x,gameDimensions:K,onWheelChanged:i,setFinishTimestamp:n,addAbsTooltip:I,timeSelector:P,isRtl:E.sU(),topUpPrizesList:Z,prize:w,hasResults:m,isSlamStopping:d,...l})}},284619:(t,K,D)=>{D.d(K,{BI:()=>z,GK:()=>b,Nr:()=>x,R5:()=>I,VF:()=>Z,e3:()=>i,gf:()=>n,jk:()=>e});var a=D(244160),G=D(977927),N=D(495476),W=D(304166);function x(){return()=>{console.log("wheelStateChanged")}}function b(t){return async(K,D)=>{K(N.rR(t));const x=W.hp(D());await x.start(t-Date.now()),W.oi(D())===a.Am.Spinning&&(K(N.Jm(!1)),G.A("TopUpSpinComplete"))}}function n(){return t=>{t(N.zx()),t(N.Jm(!0)),t(N.oI(void 0)),G.A("TopUpSpinStart")}}function e(t){return async(K,D)=>{if(K(N.gk(t)),W.oi(D())===a.Am.Spinning)return W.QV(D())&&K(N.oI("starting")),W.hp(D()).wait()}}function i(t){return K=>{K(N.jI(t))}}function z(){return t=>{t(N.Cc(!0))}}function I(){return t=>{t(N.Cc(!1))}}function Z(){return(t,K)=>{const D=K();W.OM(D)&&(W.vo(D)?(t(N.oI("starting")),t(N.rR(Date.now())),t(N.Jm(!1)),G.A("TopUpSpinComplete")):t(N.oI("needs result")))}}},495476:(t,K,D)=>{D.d(K,{zx:()=>n,rR:()=>W,Cc:()=>i,Jm:()=>x,jI:()=>e,oI:()=>z,gk:()=>b,oT:()=>I});var a=D(438020);const G=-1,N={animationEndTime:-1,spinEndingTimer:new class{constructor(){this.timerId=G,this.waiter=Promise.resolve(),this.resolver=void 0,this.creatNewWaiter()}start(t){this.timerId!==G&&clearTimeout(this.timerId);const K=()=>{var t;this.timerId=G,null===(t=this.resolver)||void 0===t||t.call(this),this.creatNewWaiter()};return t>=0?(this.timerId=setTimeout(K,t),this.waiter):(K(),Promise.resolve())}wait(){return this.waiter}creatNewWaiter(){this.waiter=new Promise((t=>{this.resolver=t}))}},debugProps:{},isSpinning:!1,slamStop:void 0,spinResult:0,roundEndTime:0,areBulbsAnimated:!1};function W(t){return{type:"wheel/SET_WHEEL_END_TIME",payload:t}}function x(t){return{type:"wheel/SET_IS_SPINNING",payload:t}}function b(t){return{type:"wheel/SET_SPIN_RESULT",payload:t}}function n(){return{type:"wheel/RESET_SPIN_RESULT"}}const e=t=>({type:"wheel/SET_ROUND_END_TIME",payload:t}),i=t=>({type:"wheel/SET_ARE_BULBS_ANIMATED",payload:t}),z=t=>({type:"wheel/SET_SLAM_STOP",payload:t});function I(t=N,K){switch(K.type){case"wheel/SET_WHEEL_END_TIME":return{...t,animationEndTime:K.payload};case"wheel/SET_IS_SPINNING":return{...t,isSpinning:K.payload};case"wheel/SET_SPIN_RESULT":return{...t,spinResult:K.payload};case"wheel/RESET_SPIN_RESULT":return{...t,spinResult:void 0};case"wheel/SET_ROUND_END_TIME":return{...t,roundEndTime:K.payload};case"wheel/SET_ARE_BULBS_ANIMATED":return{...t,areBulbsAnimated:K.payload};case a.YE:return{...t,debugProps:K.payload};case"wheel/SET_SLAM_STOP":return{...t,slamStop:K.payload};default:return t}}},304166:(t,K,D)=>{D.d(K,{MX:()=>Q,OM:()=>m,QV:()=>z,So:()=>I,Ww:()=>Z,fh:()=>P,hp:()=>n,it:()=>y,oi:()=>u,u2:()=>E,vo:()=>l});var a=D(160739),G=D(244160),N=D(733780),W=D(13799),x=D(87245);function b(t){return t.topUpWheel}a.Mz(b,(t=>t.animationEndTime));const n=a.Mz(b,(t=>t.spinEndingTimer)),e=a.Mz(b,(t=>t.debugProps)),i=a.Mz(b,(t=>t.isSpinning)),z=a.Mz(b,(t=>"needs result"===t.slamStop)),I=a.Mz(b,(t=>"starting"===t.slamStop)),Z=I,w=a.Mz(W.DB,(t=>{var K;return"true"===(null===(K=null==t?void 0:t.rawConfig)||void 0===K?void 0:K.slam_stop_wheel)})),m=a.Mz(w,i,Z,z,((t,K,D,a)=>t&&K&&!D&&!a)),u=a.Mz(i,(t=>t?G.Am.Spinning:G.Am.Default)),d=Array(15).fill(100),E=a.Mz(e,x.gY,((t,K)=>t.setEqualTopUpLabelsAmount?d:N.m(K))),l=a.Mz(b,(t=>void 0!==t.spinResult)),Q=a.Mz(b,(t=>{var K;return null!==(K=t.spinResult)&&void 0!==K?K:0})),P=a.Mz(b,(t=>t.roundEndTime)),y=a.Mz(b,(t=>t.areBulbsAnimated))},838998:(t,K,D)=>{D.d(K,{uH:()=>Q,Er:()=>h,H4:()=>T,yS:()=>H,gn:()=>X,U5:()=>C,HJ:()=>y,$j:()=>J});var a=D(923148),G=D(746351),N=D(40729),W=D(784596),x=D(283503),b=D(241665),n=D(977927),e=D(97908),i=D(179062),z=D(87245),I=D(346160),Z=D(977804),w=D(495476),m=D(284619),u=D(655648),d=D(502753),E=D(209901),l=D(909141);const Q="SkipBonusRoundDecisionPopup",P={Small:"TopUpWinLow",Medium:"TopUpWinMedium",Large:"TopUpWinHigh"};function y(){return(t,K,{getAG:D})=>{const a=K(),n=D(),e=window.__predictableBeState_betAmounts?window.__predictableBeState_betAmounts:n.betAmounts.lastSelectedAmount.value;n.balance.reserveBet(e),n.balance.pauseBalanceUpdate(),n.lifecycle.closeBets(),t(function({betAmount:t,selectedBox:K}){return(D,a,{getAG:G})=>{const N=G(),W={type:"dond.topUp",args:{betAmount:t,selectedBox:K,betTags:u.F(a())}};N.transport.sendStandardMessage(null,W)}}({betAmount:e,selectedBox:G.Bz(a)})),t(w.oI(void 0)),t(m.gf()),t(((t,K,{getAG:D})=>{const a=D(),G=a.balance.totalBet.value,N=a.betAmounts.lastSelectedAmount.value;a.balance.setTotalBet(G+N)})),t(E.K1(!1)),t(N.AT()),t(C()),n.log(b.pX({amount:e,spinId:l.xf(a),codes:W.O({gameState:"Qualified",amount:e,spinMode:"Normal"}),type:x.P({gamePhase:"TopUp",trigger:"Click",isTurbo:!1}),timeBeforeNextQualification:l.HJ(a).nextQualificationClosesIn}))}}function q(t){return(K,D,{getAG:a})=>{if(l.wt(D())){const D=a();D.log(b.kR(t)),D.popups.close(Q),K(E.oE(!1))}}}const X=(t,K,{getAG:D})=>{const a=K(),{log:G}=D(),N=l.xf(a);G(b.Vu({gamePhase:"TopUp",playerGameId:N,baseBet:z.gY(a),spinMode:"Normal"})),t(m.VF())};function h(){return(t,K,{getAG:D})=>{const a=D();t(e.I(i.z.TopUp));const G=K(),W=d.J(G),x=a.settings.getChipAmounts().filter((t=>t>=W.min&&t<=W.max));return a.betAmounts.setBetAmounts(x),a.betAmounts.setMaxEnabledAmount(W.max),a.lifecycle.openBets(),a.gameResult.setAmount(0),a.balance.setTotalBet(a.balance.totalBet.value),t(N.Yk()),l.ZL(G)&&t(((t,K,{getAG:D})=>{const a=D();t(E.oE(!0)),a.popups.open(new Z.$J({id:Q}).addPriority(Z.bx.High).setIsAutoClosing(!1).addTitle(I.Tl("skipBonusGamePopup.title")).addContentText(I.Tl("skipBonusGamePopup.text")).addButtons([{id:"Cancel",labelTranslationId:"skipBonusGamePopup.topUp.uppercase"},{id:"Close",labelTranslationId:"skipBonusGamePopup.bonus.uppercase",isDefault:!0}]).addCallback((K=>{"Cancel"===K&&t(((t,K,{getAG:D})=>{D().transport.sendStandardMessage(null,{type:"dond.skipBonusRound",args:{}})})),t(q("Cancel"===K?"TopUp":"Bonus"))})))})),n.A("TopUpEnter"),()=>t(q("Skipped"))}}function J(t){return async(K,D,{getAG:G})=>{var W;const{totalBetAmount:x,lastTopUp:b,nextQualificationClosesIn:e,totalScatterMultiplier:i,canSkipBonusRound:z,boxes:I,replayToSpin:Z}=t,w=G();var u;w.balance.setTotalBet(x),void 0!==e&&(K(m.e3(Date.now()+e)),K(E.Zx(e,Date.now()))),K(E.N_(Boolean(z))),await K(m.jk(null!==(W=null==b?void 0:b.spinResult)&&void 0!==W?W:0)),Z&&b&&(K((u=b.selectedBox,async t=>{t(function(t){return K=>{K(N.cU(t)),K(m.BI())}}(u)),await a.u(_),t(C())})),K(N.Yk()),w.lifecycle.openBets(),w.balance.resumeBalanceUpdate(),w.balance.reserveBet(0),n.A(P[b.winType]));const d=l._F(D());K(N.XR({boxes:I,multiplier:d?i:1}))}}function T(t){return(K,D,{getAG:a})=>{var G;const W=D(),n=a();n.log(b.VT({amount:z.gY(W),spinId:l.xf(W),errorId:t.code,errorMessage:null!==(G=t.msg)&&void 0!==G?G:"",type:x.P({gamePhase:"TopUp",trigger:"Click",isTurbo:!1})})),K(E.K1(!0)),K(C()),K(N.Yk()),n.lifecycle.openBets(),n.balance.resumeBalanceUpdate(),n.balance.reserveBet(0)}}const _=3e3;function C(){return t=>{t(N.Yl()),t(m.R5())}}function H(){return t=>{t(E.GY(!0))}}},502753:(t,K,D)=>{D.d(K,{J:()=>W});var a=D(160739),G=D(443505),N=D(13799);const W=a.Mz(N.DB,G.B,N.cl,((t,K,D)=>({min:t.qualificationTopUpMinBet(),max:Math.min(K.max-D,t.qualificationTopUpMaxBet())})))},209901:(t,K,D)=>{D.d(K,{N_:()=>N,K1:()=>G,Zx:()=>W,Zw:()=>n,oE:()=>x,GY:()=>b,LU:()=>e});const a={isLastSpinFailed:!1,nextQualification:{nextQualificationClosesIn:0,setTimestamp:0},showSkipBonusPopup:!1,canSkipBonusRound:!1,wasInQualificationRound:!1,playerGameId:""};function G(t){return{type:"TopUp/SET_IS_LAST_SPIN_FAILED",payload:t}}function N(t){return{type:"TopUp/CAN_SKIP_BONUS_ROUND",payload:t}}function W(t,K){return{type:"TopUp/NEXT_QUALIFICATION",payload:{nextQualificationClosesIn:t,setTimestamp:K}}}function x(t){return{type:"TopUp/SET_SHOW_SKIP_BONUS_POPUP",payload:t}}function b(t){return{type:"TopUp/WAS_IN_QUALIFICATION_ROUND",payload:t}}function n(t){return{type:"TopUp/SET_PLAYER_GAME_ID",payload:t}}function e(t=a,K){switch(K.type){case"TopUp/SET_IS_LAST_SPIN_FAILED":return{...t,isLastSpinFailed:K.payload};case"TopUp/SET_SHOW_SKIP_BONUS_POPUP":return{...t,showSkipBonusPopup:K.payload};case"TopUp/CAN_SKIP_BONUS_ROUND":return{...t,canSkipBonusRound:K.payload};case"TopUp/NEXT_QUALIFICATION":return{...t,nextQualification:K.payload};case"TopUp/WAS_IN_QUALIFICATION_ROUND":return{...t,wasInQualificationRound:K.payload};case"TopUp/SET_PLAYER_GAME_ID":return{...t,playerGameId:K.payload};default:return t}}},909141:(t,K,D)=>{D.d(K,{HJ:()=>d,NJ:()=>I,ZL:()=>l,_F:()=>P,w7:()=>z,wt:()=>Q,xf:()=>y});var a=D(160739),G=D(244160),N=D(641286),W=D(87245),x=D(949570),b=D(13799),n=D(55798),e=D(304166),i=D(502753);const z=a.Mz(W.gY,x.eu,((t,K)=>K>=t)),I=a.Mz(e.oi,n.yq,W.gY,i.J,x.eu,((t,K,D,a,N)=>t!==G.Am.Spinning&&K&&D>=a.min&&D<=a.max&&N>=D));function Z(t){return t.topUp}const w=3e3,m=1e4,u=a.Mz(b.DB,(t=>[N.Q(t.rawConfig.skip_bonus_round_decision_range_from_ms,w),N.Q(t.rawConfig.skip_bonus_round_decision_range_to_ms,m)])),d=a.Mz(Z,(t=>t.nextQualification)),E=a.Mz(Z,(t=>t.canSkipBonusRound));function l(t){const{nextQualificationClosesIn:K,setTimestamp:D}=d(t),[a,G]=u(t),N=E(t),W=K-(Date.now()-D);return W>=a&&W<=G&&N}a.Mz(Z,(t=>t.isLastSpinFailed));const Q=a.Mz(Z,(t=>t.showSkipBonusPopup)),P=a.Mz(Z,(t=>t.wasInQualificationRound)),y=a.Mz(Z,(t=>t.playerGameId))},872496:(t,K,D)=>{D.d(K,{T:()=>a});const a=D(346160).Tl},655648:(t,K,D)=>{D.d(K,{F:()=>n});var a=D(55798),G=D(755073),N=D(13799),W=D(864442),x=D(277082),b=D(993483);function n(t){const K={...W.y(),latency:a.dG(t),videoProtocol:x.selectVideoPlayerName(t),btVideoQuality:b.n6(x.selectVideoCurrentQuality(t)),btTableView:`${G.selectVideoStreamForLayout(t,t.layout.selectedLayout)}`,orientation:N.V6(t)};return Object.keys(K).reduce(((t,D)=>{const a=K[D];return void 0!==a&&(t[D]=a.toString()),t}),{})}},422194:(t,K,D)=>{D.d(K,{X:()=>N});var a=D(276111),G=D(769413);function N({target:t,destinationAlpha:K=.8,durationIn:D=.5,easingIn:N=a.dV,delay:W=0}){const x=G.M(t);return x.delay(W).animateTo({alpha:K},D,N),x}},280948:(t,K,D)=>{D.d(K,{t:()=>N});var a=D(769413);function G(t){const K=1.70158;return(K+1)*t*t*t-K*t*t}function N({target:t,durationIn:K=.5,easingIn:D=G,destination:N}){const W=a.M(t);return W.animateTo({position:N},K,D),W}},232737:(t,K,D)=>{D.d(K,{y:()=>N});var a=D(377810),G=D(282427);function N(t){const K=G.wA();return a.useCallback(((...D)=>K(t(...D))),[t,K])}},170935:(t,K,D)=>{D.d(K,{G:()=>W});var a=D(377810),G=D(901577),N=D(148999);function W(t){const K=G.O();a.useEffect((()=>K.shortcuts.register({id:N.MZ(),keyStrokes:["Spacebar"],onPress:()=>{void 0===K.popups.current.value&&t()}})),[t])}},50141:(t,K,D)=>{D.d(K,{_:()=>a});const a=D(282427).wA},41553:(t,K,D)=>{D.d(K,{e:()=>N});var a=D(64922),G=D(377810);function N(t){return K=>D=>{const{visible:N}=D,[W,x]=G.useState(N),[b,n]=G.useState(!1);return G.useEffect((()=>{if(N)return void x(N);const K=setTimeout((()=>{x(N)}),t);return()=>{clearTimeout(K)}}),[N]),G.useEffect((()=>{if(!W)return;if(!N)return void n(!1);let t=requestAnimationFrame((()=>{t=requestAnimationFrame((()=>{n(N)}))}));return()=>{cancelAnimationFrame(t)}}),[N,W]),W?a.jsx(K,{...D,visible:b}):null}}},179062:(t,K,D)=>{var a;D.d(K,{z:()=>a}),function(t){t[t["Standard"]=0]="Standard",t[t["Dond"]=1]="Dond",t[t["TopUp"]=2]="TopUp"}(a||(a={}))},97908:(t,K,D)=>{async function a(t,K){return K.video.requestStreamById(t),new Promise((D=>{K&&K.video&&K.video.ready||D(t),K.video.ready.then((()=>{const t=a=>{K.video.currentStreamId.unsubscribe(t),D(a)};K.video.currentStreamId.subscribe(t)}))}))}function G(t){return(K,D,{getAG:G})=>{const N=G();(async function(t,K){let D=K.video.currentStreamId.value;const G=4;for(let N=0;N<G;++N)if(D=await a(t,K),D===t)return;K.video.setStream(t)})(t,N)}}D.d(K,{I:()=>G})},337234:(t,K,D)=>{D.d(K,{N:()=>z});var a=D(64922),G=D(699695),N=(D(377810),D(282427)),W=D(13799),x=D(277082);function b(t){const K=W.DB(t).DeviceSupport.IS_DESKTOP;return W.DB(t).DeviceSupport.IS_TABLET?"tabletLandscape":K?"desktopImmersive":"mobilePortrait"}function n(t){const K=t.layout.selectedLayout===x.LayoutType.ImmersiveV2,D=W.DB(t),a=K?D.getVideoOverlayDesktopImage():D.getVideoOverlayMobileImage();if(a)return G=a,`${window.EVO_CDN||window.EVO_ORIGIN||""}/player/games/assets/dond/overlays/${G}`;var G}const e={videoOverlay:"videoOverlay--6b697",dimmed:"dimmed--16af7",desktopImmersive:"desktopImmersive--26eac",tabletLandscape:"tabletLandscape--31bc9",mobilePortrait:"mobilePortrait--5a4e2"},i=({image:t,className:K,isCoverVisible:D,dimmed:N})=>{const W=G.A(e.videoOverlay,e[K],{[e.dimmed]:N}),x=t?{backgroundImage:`url("${t}")`}:void 0;return D?a.jsx("div",{className:W,style:x}):null},z=t=>{const K=N.d4(n),D=N.d4(b);return a.jsx(i,{...t,image:K,className:D})}},482060:(t,K,D)=>{D.d(K,{A:()=>z,B:()=>i});var a=D(64922),G=D(170877),N=D(436794),W=D(346160),x=D(50415),b=D(528981),n=D(127793),e=D(99210);const i=async(t,K,{customConfig:e,currencySymbol:i,customizableButton:z})=>{if(!e)throw new Error("Help custom config is not defined");const{AutoplayChapter:I,GameObjectiveChapter:Z,GameRulesChapter:w,PlaceBetsChapter:m,PayoutsChapter:u,ReturnToPlayerChapter:d,ShortcutKeysChapter:E}=await D.e(83841).then(D.bind(D,279891)),{AutoplayChapter:l}=await D.e(50967).then(D.bind(D,321502)),Q=K.getTableName(),P=t!==G.OD.Desktop,y=P&&x.vc()===N.t.Landscape,q={id:"GameObjective",title:W.Tl("help.gameObjective.title"),content:a.jsx(Z,{gameTranslationKey:"history.dealnodeal"})},X={id:"GameRules",title:W.Tl("help.gameRules.title"),content:a.jsx(w,{currencySymbol:i,isMobile:P,disableXXXtremeSpins:e.disableXXXtremeSpins,disableFeatureBuy:e.disableFeatureBuy})},h={id:"Payouts",title:W.Tl("help.payouts.title"),content:a.jsx(u,{showMalfunctionNote:e.showMalfunctionNote})},J=K.isUKGC(),T=K.autoplayApiRounds(),_={id:b.t.AutoplayApi,title:W.Tl("help.autoplay3.title"),content:a.jsxs(a.Fragment,{children:[a.jsx(l,{currencySymbol:i,limitsEnabled:J,platform:t,availableRounds:T,gameTheme:n.q.Golden,isLandscape:y,isRtl:!1,buttonType:z.all?"customizable":"secondaryGold"}),a.jsx(I,{})]})},C={id:"ReturnToPlayer",title:W.Tl("help.returnToPlayer.title"),content:a.jsx(d,{volatility:e.volatility,disableXXXtremeSpins:e.disableXXXtremeSpins,disableFeatureBuy:e.disableFeatureBuy})},H={id:"PlaceBets",title:W.Tl("help.placeBets.title"),content:a.jsx(m,{currencySymbol:i,tableName:Q,maxLimit:e.tableLimits.max,minLimit:e.tableLimits.min,platform:t,turboSpinEnabled:e.turboMode})},o={id:b.t.ShortcutKeys,title:W.Tl("help.shortcutKeys.title"),content:a.jsx(E,{})};return[q,X,h,C,_,H,b.t.LiveSupport,b.t.Chat,b.t.GameNumber,b.t.Sound,b.t.GameHistory,b.t.SettingsWithoutSideBets,b.t.DepositAndWithdraw,b.t.ResponsibleGaming,b.t.InformazioniAams,b.t.ErrorHandling,b.t.DisconnectionPolicy,b.t.AutomatedDecision,b.t.MoreGames,b.t.MultiGamePlay,o,b.t.Home]},z=async({settings:t,customConfig:K,currencySymbol:N})=>{const{GameObjectiveChapter:x,GameRulesChapter:b,PlaceBetsChapter:n,PayoutsChapter:i,ReturnToPlayerChapter:z,ShortcutKeysChapter:I}=await D.e(83841).then(D.bind(D,279891)),Z=t.getTableName(),w=t.DeviceSupport.PLATFORM,m=w!==G.OD.Desktop;return{overrideDefaultChapters:{[e.C.ShortcutKeys]:{content:a.jsx(I,{})}},customChapters:{gameDetails:[{chapters:[{id:"GameObjective",title:W.Tl("help.gameObjective.title"),content:a.jsx(x,{gameTranslationKey:"history.dealnodeal"})},{id:"GameRules",title:W.Tl("help.gameRules.title"),content:a.jsx(b,{currencySymbol:N,isMobile:m,disableXXXtremeSpins:K.disableXXXtremeSpins,disableFeatureBuy:K.disableFeatureBuy})},{id:"PlaceBets",title:W.Tl("help.placeBets.title"),content:a.jsx(n,{currencySymbol:N,tableName:Z,maxLimit:K.tableLimits.max,minLimit:K.tableLimits.min,platform:w,turboSpinEnabled:K.turboMode})},{id:"Payouts",title:W.Tl("help.payouts.title"),content:a.jsx(i,{showMalfunctionNote:K.showMalfunctionNote})},{id:"ReturnToPlayer",title:W.Tl("help.returnToPlayer.title"),content:a.jsx(z,{volatility:K.volatility,disableXXXtremeSpins:K.disableXXXtremeSpins,disableFeatureBuy:K.disableFeatureBuy})}]}]},filterMap:{overrideDefault:{[e.C.Shuffling]:!1,[e.C.SpeedMode]:!1}}}}},610262:(t,K,D)=>{var a=D(224169),G=D(64922),N=D(377810),W=D(840703),x=D(482060),b=D(741542),n=D(718484),e=D(350680),i=D(277082),z=D(897899),I=D(343298),Z=D(282427),w=D(699695),m=D(433962),u=D(787014);const d="logo--549c1",E="image--c9610",l="scaleByWidth--0b44e",Q="loaded--604d0";class P extends N.PureComponent{constructor(){super(...arguments),this.state={loaded:!1},this.onImageLoaded=()=>{this.setState({loaded:!0})}}render(){return G.jsx("div",{className:w.A(d,{[Q]:this.state.loaded||void 0!==this.props.tableLogo}),children:G.jsx("img",{className:w.A(E,{[l]:this.props.scaleByWidth}),src:this.props.tableLogo,onLoad:this.onImageLoaded})})}}u.S((t=>({tableLogo:m.R(t)})))(P);const y=u.S((t=>({tableLogo:m.R(t,!0)})))(P);var q=D(805195),X=D(913611),h=D(41553),J=D(170877),T=D(2809),_=D(160163),C=D(719315),H=D(448826),o=D(712787),U=D(118100);const V="desktopBonusLayout--d4fb1",s="boxes--65e3f",F="youWinContainer--8a07a",c="offerContainer--0c04a",g="decisionControlsContainer--5188c",R="playAgainButtonContainer--1c278",A="decisionPlayers--19c87",Y=h.e(1e3)((({visible:t})=>{const K=Z.wA();return N.useEffect((()=>K(o.Nr())),[K]),G.jsxs("div",{className:w.A(V),children:[t&&G.jsx(X.S,{platform:J.OD.Desktop}),G.jsx("div",{className:s,children:G.jsx(q.i,{platform:J.OD.Desktop,type:"Bonus",visible:t})}),G.jsx("div",{"data-role":"offer-win-container",className:c,children:G.jsx(T.q,{})}),G.jsx("div",{"data-role":"you-win-container",className:F,children:G.jsx(U.j,{visible:t})}),G.jsx("div",{"data-role":"decision-controls-container",className:g,children:G.jsx(_.g,{})}),G.jsx("div",{"data-role":"play-again-button-container",className:R,children:G.jsx(H.u,{visible:t,platform:J.OD.Desktop})}),G.jsx("div",{className:A,children:G.jsx(C.Z,{})})]})}));var L=D(653086),S=D(572914),f=D(937807),$=D(442914),B=D(901577);function O(t){return t.debug_force_outcome_env}const v="debug_donod_force_bonus_outcome_value",p=`[\n    [1, 2, 3],\n    [4, 5, 6, 7],\n    [8, 9, 10, 11],\n    [12, 13, 14],\n    [15]\n]`;async function j(t){const K=function({env:t,tableId:K,operation:D}){return`${r(t)}/${D}/${K}`}(t);try{return async function(t){if(200===t.status)return"";const K=await t.json();return"object"==typeof K?tt(K):String(K)}(await fetch(K,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.body)}))}catch(t){return t instanceof Error?t.message:String(t)}}function r(t){return`https://${t}-prototype.evolutiongaming.com/restricted/liveslotdealnodeal`}function M({userId:t,body:K={}}){return{userId:t,operation:{...K,type:"Put"}}}function k({userId:t}={}){return{userId:t,operation:{type:"Remove"}}}function tt(t,K=""){const D=K;return Object.prototype.hasOwnProperty.call(t,"msg")?`${D} ${t.msg}`:Object.keys(t).reduce(((K,D)=>{const a=t[D];return"object"!=typeof a?K:tt(a,K)}),D)}const Kt="wrong format of outcome it should be an array of arrays (x3,x4,x4,x3,x1) of numbers (1-15)",Dt="predictableBeState--eba80",at="error--c7049",Gt="outcome--b1dc2",Nt="buttons--cf0a2",Wt="button--3a119",xt="paramName--c48e2",bt="paramValue--73c0d",nt=({settings:t,setError:K})=>{const[D,a]=N.useState(window.localStorage.getItem(v)||p);return G.jsxs(G.Fragment,{children:[G.jsx("h2",{children:"Force Bonus Slot Outcome"}),G.jsx("textarea",{className:Gt,value:D,onBlur:()=>{K(function(t){let K;try{K=JSON.parse(t)}catch(t){return Kt}return Array.isArray(K)?5!==K.length?Kt:Array.isArray(K[0])&&3===K[0].length&&Array.isArray(K[1])&&4===K[1].length&&Array.isArray(K[2])&&4===K[2].length&&Array.isArray(K[3])&&3===K[3].length&&Array.isArray(K[4])&&1===K[4].length?K.flat().some((t=>"number"!=typeof t||t<=0||t>15))?Kt:"":Kt:Kt}(D))},onInput:t=>{const K=t.target.value;a(K),function(t){window.localStorage.setItem(v,t)}(K)},rows:7}),G.jsxs("div",{className:Nt,children:[G.jsx("button",{className:Wt,onClick:async()=>{const a=await async function(t){const K=JSON.parse(t.eliminationSequence).map((t=>t.map((t=>String(t)))));return j({tableId:t.tableId,env:t.env,body:M({body:{eliminationSequence:K}}),operation:"forcedBonusRoundOutcome"})}({tableId:t.getTableId(),env:O(t.rawConfig),eliminationSequence:D});K(a)},children:"put"}),G.jsx("button",{className:Wt,onClick:async()=>{const D=await async function(t){return j({tableId:t.tableId,env:t.env,body:k(),operation:"forcedBonusRoundOutcome"})}({tableId:t.getTableId(),env:O(t.rawConfig)});K(D)},children:"reset"})]})]})},et=()=>{const[t,K]=N.useState(void 0!==window.__predictableBeState_betAmounts);return G.jsxs(G.Fragment,{children:[G.jsx("h2",{children:"Force error"}),G.jsxs("label",{children:["Set bet to 100000",G.jsx("input",{type:"checkbox",checked:t,onChange:()=>{K((t=>(window.__predictableBeState_betAmounts=t?void 0:1e5,!t)))}})]})]})},it=({settings:t,setError:K})=>G.jsxs(G.Fragment,{children:[G.jsx("h2",{children:"Player State"}),G.jsx("div",{children:G.jsx("button",{className:Wt,onClick:async()=>{const D=await async function({env:t,tableId:K,userId:D}){const a=`${r(t)}/resetPlayerState/${K}/${D}`;try{const t=await fetch(a,{method:"POST",body:""});return 200===t.status?"":t.text()}catch(t){return t instanceof Error?t.message:String(t)}}({tableId:t.getTableId(),env:O(t.rawConfig),userId:t.userId()});K(D)},children:"Reset Player State"})})]}),zt="debug_donod_force_qualification_outcome_value",It=`[\n  [0, 1, 3],\n  [3, 4, 5],\n  [6, 7, 8]\n]`,Zt="wrong format of outcome it should be an array (3*3) of numbers (0-14, except 2)",wt=({settings:t,setError:K})=>{const[D,a]=N.useState(window.localStorage.getItem(zt)||It);return G.jsxs(G.Fragment,{children:[G.jsx("h2",{children:"Force Qualification Slot Outcome"}),G.jsx("textarea",{className:Gt,value:D,onBlur:()=>{K(function(t){let K;try{K=JSON.parse(t)}catch(t){return Zt}if(!Array.isArray(K))return Zt;if(3!==K.length)return Zt;for(const t of K){if(!Array.isArray(t))return Zt;if(3!==t.length)return Zt}return K.flat().some((t=>"number"!=typeof t||t<0||t>14||2===t))?Zt:""}(D))},onInput:t=>{const K=t.target.value;a(K),function(t){window.localStorage.setItem(zt,t)}(K)},rows:5}),G.jsxs("div",{className:Nt,children:[G.jsx("button",{className:Wt,onClick:async()=>{const a=await async function(t){const K=JSON.parse(t.outcome);return j({tableId:t.tableId,env:t.env,body:M({userId:t.userId,body:{grid:K}}),operation:"forcedQualificationSlotOutcome"})}({tableId:t.getTableId(),env:O(t.rawConfig),userId:t.userId(),outcome:D});K(a)},children:"put"}),G.jsx("button",{className:Wt,onClick:async()=>{const D=await async function(t){return j({tableId:t.tableId,env:t.env,body:k(t),operation:"forcedQualificationSlotOutcome"})}({tableId:t.getTableId(),env:O(t.rawConfig),userId:t.userId()});K(D)},children:"reset"})]})]})},mt="sector should be an integer between 0 and 14",ut=({settings:t})=>{const[K,D]=N.useState(""),[a,W]=N.useState();return G.jsxs(G.Fragment,{children:[G.jsx("h2",{children:"Force Top Up Outcome"}),G.jsx("input",{className:Gt,onInput:t=>{const K=t.target.valueAsNumber;W(Number.isNaN(K)?void 0:K)},onBlur:()=>{var t;D(void 0!==a?(t=a)>=0&&t<=14?"":mt:"")},type:"number",min:0,max:14}),G.jsx("div",{className:at,children:K}),G.jsxs("div",{className:Nt,children:[G.jsx("button",{className:Wt,onClick:async()=>{if(void 0===a||Number.isNaN(a))return;const K=await async function(t){return j({tableId:t.tableId,env:t.env,body:M({userId:t.userId,body:{sector:t.sector}}),operation:"forcedTopUpSlotOutcome"})}({tableId:t.getTableId(),env:O(t.rawConfig),userId:t.userId(),sector:a});D(K)},children:"put"}),G.jsx("button",{className:Wt,onClick:async()=>{const K=await async function(t){return j({tableId:t.tableId,env:t.env,body:k(t),operation:"forcedTopUpSlotOutcome"})}({tableId:t.getTableId(),env:O(t.rawConfig),userId:t.userId()});D(K)},children:"reset"})]})]})},dt=()=>{const[t,K]=N.useState(""),{settings:D,preferences:a}=B.O();return"true"!==D.rawConfig.debug_force_outcome_window?null:G.jsxs("div",{className:Dt,children:[G.jsx(Et,{name:"Tabel ID",value:D.getTableId()}),G.jsx(Et,{name:"User ID",value:D.userId()}),G.jsx(wt,{settings:D,setError:K}),G.jsx(ut,{settings:D}),G.jsx(it,{settings:D,setError:K}),G.jsx(nt,{settings:D,setError:K}),G.jsx(et,{}),G.jsx("button",{className:Wt,onClick:()=>a.setPreferences({key:"dondFirstTimeUser",value:!0}),children:'Set "first time user" to true'}),G.jsx("div",{className:at,children:t})]})},Et=({name:t,value:K})=>G.jsxs("div",{children:[G.jsx("span",{className:xt,children:t})," = ",G.jsx("span",{className:bt,children:K})]});var lt=D(357223),Qt=D(925174);const Pt="container--77a2c",yt="overlay--3b871",qt="visible--c80a3",Xt=({visible:t,children:K})=>G.jsxs("div",{className:Pt,children:[G.jsx("div",{className:w.A(yt,{[qt]:t})}),K]});var ht=D(816340),Jt=D(441164),Tt=D(542749),_t=D(992486),Ct=D(41778),Ht=D(556972),ot=D(730837),Ut=D(861880),Vt=D(962578),st=D(927228),Ft=D(552652),ct=D(664887),gt=D(715907),Rt=D(491317);const At="desktopDrawerContainer--2a47a",Yt="desktopDrawer--22d4b",Lt="visible--04d4e",St="background--b2a35",ft="backgroundWrapper--aebe8",$t="closeButton--e135c",Bt=300,Ot=h.e(Bt)((({onClose:t,visible:K,className:D,children:a})=>{const W=N.useRef(null);return ct.L(W,K,t,{capture:!0}),G.jsx("div",{ref:W,className:w.A(At,D),style:{"--disappearDuration":`${Bt}ms`},children:G.jsx("div",{className:w.A(Yt,{[Lt]:K}),children:G.jsx("div",{className:St,children:G.jsxs("div",{className:ft,children:[G.jsx(gt.$,{className:$t,size:"XXS",role:"close",onClick:t,iconComponent:G.jsx(Rt.b,{}),type:"borderless"}),a]})})})})}));var vt=D(977927),pt=D(837557),jt=D(563054),rt=D(559979);const Mt="selectionContainer--b4024",kt=({currencySymbol:t,isTablet:K,xxxtremeBetPerSpin:D,xxxtremeBaseBet:a,isXXXtremeIncreaseEnabled:N,increaseXXXtremeBet:W,isXXXtremeDecreaseEnabled:x,decreaseXXXtremeBet:b,isXXXtremeSelectionAvailable:n,disableFeatureBuy:e,superXXXtremeBetPerSpin:i,superXXXtremeBaseBet:z,isSuperXXXtremeIncreaseEnabled:I,increaseSuperXXXtremeBet:Z,isSuperXXXtremeDecreaseEnabled:w,decreaseSuperXXXtremeBet:m,isSuperXXXtremeSelectionAvailable:u,setSpinMode:d,getTooltipForDisabled:E})=>G.jsxs("div",{className:Mt,children:[G.jsx(rt.D,{isPhone:!1,isTablet:K,mode:"XXXtreme",betPerSpin:D,baseBet:a,currencySymbol:t,isIncreaseEnabled:N,onIncrease:W,isDecreaseEnabled:x,onDecrease:b,isSelectionEnabled:n,onSelect:d,getTooltipForDisabled:E}),!e&&G.jsx(rt.D,{isPhone:!1,isTablet:K,mode:"SuperXXXtreme",betPerSpin:i,baseBet:z,currencySymbol:t,isIncreaseEnabled:I,onIncrease:Z,isDecreaseEnabled:w,onDecrease:m,isSelectionEnabled:u,onSelect:d,getTooltipForDisabled:E})]});var tK=D(872496);const KK=D.p+"images/xxxtremehe.7788538b.webp",DK="xxxtremeSelectionHeader--88085",aK="title--cefb7",GK="fill--f4666",NK="stroke--6ba0e",WK="logo--99a1b",xK=N.memo((()=>G.jsxs("div",{className:DK,children:[G.jsxs("span",{className:aK,"data-text":tK.T("xxxtremedrawer.qualifyFaster.uppercase"),children:[G.jsxs("span",{className:NK,children:[" ",tK.T("xxxtremedrawer.qualifyFaster.uppercase")," "]}),G.jsxs("span",{className:GK,children:[" ",tK.T("xxxtremedrawer.qualifyFaster.uppercase")," "]})]}),G.jsx("img",{className:WK,src:KK})]}))),bK="xxxtremeDrawerDesktop--64c23",nK="disableFeatureBuy--c1f58",eK=t=>{const{isOpen:K,onClose:D,disableFeatureBuy:a}=t,W=N.useCallback((()=>{vt.A("XxxtremeClose"),D()}),[D]);return G.jsx(Ot,{visible:K,onClose:W,className:w.A(bK,{[nK]:a}),children:G.jsxs(G.Fragment,{children:[G.jsx(xK,{}),G.jsx(kt,{...t})]})})},iK=({playerGameId:t})=>{const{xxxtremeBetPerSpin:K,superXXXtremeBetPerSpin:D,...a}=jt.e(t);return G.jsx(eK,{isPhone:!1,isTablet:pt.DS.IS_TABLET,xxxtremeBetPerSpin:K.value,superXXXtremeBetPerSpin:D.value,isXXXtremeSelectionAvailable:K.enabled,isSuperXXXtremeSelectionAvailable:D.enabled,...a})};var zK=D(849279);const IK="desktopQualificationLayout--c4773",ZK="desktopQualificationMaskOverlayLayout--a9203",wK="catchScattersMessage--cd59e",mK="visible--d4d76",uK="buttonZone--ce647",dK="xxxtremeButton--9717c",EK="bettingPanel--de06d",lK="betStake--72936",QK=1e3,PK=h.e(QK)((({visible:t})=>{const K=Z.wA(),D=Z.d4(lt.Ut),a=Z.d4(ht.K),W=Z.d4(lt.WN),x=Z.d4(ot.xf);return N.useEffect((()=>K(Ht.Zq)),[K]),G.jsxs("div",{className:w.A(IK,{[mK]:t}),style:{"--disappearDuration":`${QK}ms`},children:[G.jsx(Vt.A,{platform:J.OD.Desktop}),G.jsx(X.S,{platform:J.OD.Desktop}),G.jsx(st.f,{platform:J.OD.Desktop}),G.jsx(Ct.b,{spinMode:W,className:wK}),G.jsx(_t.a,{visible:t}),G.jsxs("div",{className:uK,children:[a&&G.jsx("div",{className:dK,children:G.jsx(Ft.h,{playerGameId:x})}),G.jsxs("div",{className:EK,children:[G.jsx(Ut.D,{}),G.jsx(Tt.YQ,{}),G.jsx(Jt.L,{})]}),G.jsx("div",{className:lK,children:G.jsx(Qt.H,{gamePhase:"Qualification"})})]}),a&&G.jsx(Xt,{visible:D,children:G.jsx(iK,{playerGameId:x})})]})})),yK=h.e(QK)((({visible:t})=>G.jsx("div",{className:w.A(ZK,{[mK]:t}),style:{"--disappearDuration":`${QK}ms`},children:G.jsx(zK.F,{})})));var qK=D(873666);const XK="desktopQualifiedPlayersLayout--b8f89",hK="qualifiedPlayers--d1c3b",JK="visible--07dc6",TK=1e3,_K=h.e(TK)((({visible:t})=>G.jsx("div",{className:w.A(XK,{[JK]:t}),style:{"--disappearDuration":`${TK}ms`},children:G.jsx(qK.c,{className:hK})})));var CK=D(324978),HK=D(838998),oK=D(842092),UK=D(748398);const VK="desktopTopUpLayout--c307b",sK="wheel--02375",FK="visible--9a3d0",cK="boxes--6607c",gK="bettingPanel--57a9e",RK=1e3,AK=h.e(RK)((({visible:t})=>{const K=Z.wA();return N.useEffect((()=>K(HK.Er())),[K]),G.jsxs("div",{className:w.A(VK,{[FK]:t}),style:{"--disappearDuration":`${RK}ms`},children:[G.jsx("div",{className:sK,children:G.jsx(UK.w,{isMobile:!1})}),G.jsx(X.S,{platform:J.OD.Desktop}),G.jsx("div",{className:cK,children:G.jsx(q.i,{platform:J.OD.Desktop,type:"TopUp",visible:!0})}),G.jsxs("div",{className:gK,children:[G.jsx(oK.v,{}),G.jsx(Qt.H,{gamePhase:"TopUp"})]})]})}));var YK=D(337234),LK=D(700429),SK=D(969695),fK=D(786596);const $K="winnersListContainer--61811",BK=()=>G.jsx("div",{className:$K,children:G.jsx(LK.A,{position:SK.C1.Right,speed:fK.q.Medium})});var OK=D(886490),vK=D(537658),pK=D(499096),jK=D(708978);const rK=({className:t})=>{const{settings:K}=B.O();return K.isPublicChatEnabled()?G.jsxs("div",{"data-role":"quick-chat-container",className:t,children:[G.jsx(pK.QG,{}),G.jsx(jK.E,{isReversed:!0,messageCount:1})]}):null},MK="desktopOverlay--19e34",kK="logoContainer--e3f9c",tD="chat--92e21",KD=N.memo((({children:t})=>G.jsxs(G.Fragment,{children:[G.jsx(b.iZ,{}),G.jsx(n.k,{}),t||null]})));KD.displayName="ImmersiveLayout";const DD={LayoutBetLimitsHeader:()=>G.jsx(z.V,{showPayouts:!1}),LayoutBetLimitsBody:()=>G.jsx(I.o,{isMobile:!1}),LayoutBottomRightButtons:[W.H],GameOverlays:()=>{const t=Z.d4(f.Od),K=Z.d4(f.TV),D=Z.d4(f.a8),a=Z.d4(f.ST),W=Z.d4(f.kz),x=Z.d4(f.dm),b=Z.d4(m.y),n=$.h9(),e=Z.d4(lt.WN),i=t?"Qualification":K?"TopUp":"BonusRound";return N.useEffect((()=>OK.w9((()=>setTimeout((()=>{null==n||n.adjustLayout()}),50)))),[n]),G.jsx("div",{className:MK,children:G.jsxs($.TO.Provider,{value:n,children:[G.jsx(YK.N,{dimmed:"Normal"!==e,isCoverVisible:t||K}),G.jsx(yK,{visible:t}),G.jsx(PK,{visible:t}),G.jsx(AK,{visible:K}),G.jsx(Y,{visible:a}),G.jsx("div",{className:kK,children:G.jsx(y,{})}),n?G.jsx(vK.m,{application:n.app,style:{pointerEvents:"none",position:"absolute"}}):null,G.jsx(S.R,{visible:D}),G.jsx(rK,{className:tD}),G.jsx(L.m,{visible:W,logo:b}),G.jsx(BK,{}),G.jsx(dt,{}),G.jsx(_K,{visible:x}),G.jsx(CK.S,{gamePhase:i,isDesktop:!0})]})})},HelpComponentListCreator:x.B,HelpCreator:x.A,Layouts:{...e.Layouts,[i.LayoutType.ImmersiveV2]:KD}};var aD=D(346160),GD=D(809024),ND=D(357947);window.EVO_LOADER.publishApplication("/frontend/evo/r2/","liveslot-dealnodeal.desktop",{initialize:async function(t){aD.JL(t.i18nData,"liveslotdealnodeal");return async function(t,K){return a.Z(t,(()=>DD),K)}(t,ND.K({gameLoaderParams:t}))},dispose:GD.L,applicationType:"game"})},259726:(t,K,D)=>{var a=D(224169),G=D(482060),N=D(64922),W=D(377810),x=D(282427),b=D(433962),n=D(12078),e=D(25407),i=D(805195),z=D(913611),I=D(840703);const Z=window.innerWidth/1.982,w=window.innerWidth/2.514,m=window.innerWidth/window.innerHeight<.5?30:0,u=0!==m?Z+m:void 0,d=w-20+m,E=-window.innerWidth/4.296+window.innerWidth/10.827+32;var l=D(41553),Q=D(755073),P=D(436794),y=D(170877),q=D(2809),X=D(160163),h=D(719315),J=D(448826),T=D(712787),_=D(118100);const C="boxes--3dffb",H="youWinContainer--e57fa",o="offerContainer--87e83",U="decisionControlsContainer--5f188",V="playAgainButtonContainer--afc8a",s="infoButtonContainer--b3494",F="decisionPlayers--7b38b",c=l.e(1e3)((({visible:t})=>{const K=x.wA();W.useEffect((()=>K(T.Nr())),[K]);const D=E+60;return N.jsxs(N.Fragment,{children:[t&&N.jsx(z.S,{platform:y.OD.Tablet,bottomPx:D}),N.jsxs(Q.MobileSafeContainerConnected,{isRng:!1,children:[N.jsx("div",{className:C,children:N.jsx(i.i,{platform:y.OD.Tablet,type:"Bonus",visible:t})}),N.jsx("div",{"data-role":"offer-win-container",className:o,children:N.jsx(q.q,{orientation:P.t.Landscape})}),N.jsx("div",{"data-role":"you-win-container",className:H,children:N.jsx(_.j,{visible:t,isMobile:!1})}),N.jsx("div",{"data-role":"decision-controls-container",className:U,children:N.jsx(X.g,{direction:e.iX.Row,orientation:P.t.Landscape,isMobile:!1})}),N.jsx("div",{"data-role":"play-again-button-container",className:V,children:N.jsx(J.u,{visible:t,orientation:P.t.Landscape,platform:y.OD.Tablet})}),N.jsx("div",{"data-role":"info-button-container",className:s,children:N.jsx(I.H,{})})]}),N.jsx("div",{className:F,children:N.jsx(h.Z,{})})]})})),g="youWinContainer--8db49",R="offerContainer--67e53",A="decisionControlsContainer--52734",Y="playAgainButtonContainer--6ea7b",L="boxes--117bf",S="infoButtonContainer--e80c8",f="decisionPlayers--115ee",$=l.e(1e3)((({visible:t})=>{const K=x.wA();return W.useEffect((()=>K(T.Nr())),[K]),N.jsxs(N.Fragment,{children:[N.jsx(z.S,{platform:y.OD.Phone,containerHeightPx:u}),N.jsxs(Q.MobileSafeContainerConnected,{isRng:!1,children:[N.jsx("div",{className:L,children:N.jsx(i.i,{platform:y.OD.Phone,type:"Bonus",visible:t})}),N.jsx("div",{"data-role":"offer-win-container",className:R,children:N.jsx(q.q,{orientation:P.t.Portrait})}),N.jsx("div",{"data-role":"you-win-container",className:g,children:N.jsx(_.j,{visible:t,isMobile:!0})}),N.jsx("div",{"data-role":"decision-controls-container",className:A,children:N.jsx(X.g,{direction:e.iX.Column,orientation:P.t.Portrait,isMobile:!0})}),N.jsx("div",{"data-role":"play-again-button-container",className:Y,children:N.jsx(J.u,{visible:t,orientation:P.t.Portrait,platform:y.OD.Phone})}),N.jsx("div",{"data-role":"info-button-container",className:S,children:N.jsx(I.H,{})}),N.jsx("div",{className:f,children:N.jsx(h.Z,{})})]})]})}));var B=D(653086),O=D(572914),v=D(937807),p=D(442914),j=D(699695),r=D(925174),M=D(816340),k=D(923968),tt=D(441164),Kt=D(542749),Dt=D(992486),at=D(41778),Gt=D(556972),Nt=D(730837),Wt=D(861880),xt=D(357223),bt=D(849279),nt=D(962578),et=D(927228),it=D(552652),zt=D(977927),It=D(742257),Zt=D(632205),wt=D(901577),mt=D(346160),ut=D(523219),dt=D(999780),Et=D(626239),lt=D(563054),Qt=D(559979),Pt=D(872496);const yt=D.p+"images/xxxtremehe.7d05e6d9.webp",qt="xxxtremeSelectionHeader--78742",Xt="title--0e1ce",ht="fill--5259b",Jt="stroke--8e062",Tt="logo--8d880",_t=W.memo((()=>N.jsxs("div",{className:qt,children:[N.jsxs("span",{className:Xt,"data-text":Pt.T("xxxtremedrawer.qualifyFaster.uppercase"),children:[N.jsxs("span",{className:Jt,children:[" ",Pt.T("xxxtremedrawer.qualifyFaster.uppercase")," "]}),N.jsxs("span",{className:ht,children:[" ",Pt.T("xxxtremedrawer.qualifyFaster.uppercase")," "]})]}),N.jsx("img",{className:Tt,src:yt})]}))),Ct="xxxtremeContainer--7821b",Ht="Tablet--5fb86",ot="selectionContainer--40821",Ut="Phone--67009",Vt="landscape--cca26",st=W.forwardRef(((t,K)=>{const{currencySymbol:D,isLandscape:a,isPhone:G,isTablet:W,xxxtremeBetPerSpin:x,xxxtremeBaseBet:b,isXXXtremeIncreaseEnabled:n,increaseXXXtremeBet:e,isXXXtremeDecreaseEnabled:i,decreaseXXXtremeBet:z,isXXXtremeSelectionAvailable:I,disableFeatureBuy:Z,superXXXtremeBetPerSpin:w,superXXXtremeBaseBet:m,isSuperXXXtremeIncreaseEnabled:u,increaseSuperXXXtremeBet:d,decreaseSuperXXXtremeBet:E,isSuperXXXtremeSelectionAvailable:l,setSpinMode:Q,isSuperXXXtremeDecreaseEnabled:P,getTooltipForDisabled:y}=t;return N.jsxs("div",{className:j.A(Ct,{[Vt]:a,[Ut]:G,[Ht]:W}),ref:K,children:[N.jsx(_t,{}),N.jsxs("div",{className:ot,children:[N.jsx(Qt.D,{isPhone:G,isTablet:W,mode:"XXXtreme",betPerSpin:x,baseBet:b,currencySymbol:D,isIncreaseEnabled:n,onIncrease:e,isDecreaseEnabled:i,onDecrease:z,isSelectionEnabled:I,onSelect:Q,getTooltipForDisabled:y}),!Z&&N.jsx(Qt.D,{isPhone:G,isTablet:W,mode:"SuperXXXtreme",betPerSpin:w,baseBet:m,currencySymbol:D,isIncreaseEnabled:u,onIncrease:d,isDecreaseEnabled:P,onDecrease:E,isSelectionEnabled:l,onSelect:Q,getTooltipForDisabled:y})]})]})})),Ft=[50,90],ct=90,gt=90,Rt=t=>{const{isTablet:K,isOpen:D,setSpinMode:a,onClose:G,showDimBackground:x=!0}=t,b=W.useState(!1),n=Ft[1],e=W.useCallback((t=>{a(t)}),[a]),i=W.useCallback((()=>{zt.A("XxxtremeClose"),G()}),[G]),z=K?gt:ct;return ut.W0.useLiteMobileDrawer()?N.jsx(It.Q,{id:"XXXtremeDrawer",isOpen:D,portrait:{snapPoints:[`${n}%`]},landscape:{snapPoints:[`${z}%`]},onCloseTransitionEnd:i,children:N.jsx(dt.y,{children:N.jsx(st,{...t,setSpinMode:e})})}):D?N.jsx(Zt.u,{titleText:"",isRtl:mt.sU(),id:"XXXtremeDrawer",styleOptions:{scrimOpacity:x?.7:0},portrait:{openHeight:n},landscape:{openWidth:z},fullscreen:b?{height:Ft[1],breakpoint:(Ft[1]+n)/2}:void 0,onClose:i,disabledDangerZone:!0,children:N.jsx(Et.Xl,{children:N.jsx(st,{...t,setSpinMode:e})})}):null},At=({playerGameId:t})=>{const{xxxtremeBetPerSpin:K,superXXXtremeBetPerSpin:D,...a}=lt.e(t),G=k.V((t=>t.gameDimensions)),W=k.V((t=>t.orientation)),{platform:x}=wt.O();return N.jsx(Rt,{isPhone:x===y.OD.Phone,isTablet:x===y.OD.Tablet,gameDimensionHeight:G.height,gameDimensionWidth:G.width,isLandscape:"landscape"===W,xxxtremeBetPerSpin:K.value,superXXXtremeBetPerSpin:D.value,isXXXtremeSelectionAvailable:K.enabled,isSuperXXXtremeSelectionAvailable:D.enabled,...a})},Yt="mobileQualificationLayout--353f0",Lt="catchScattersMessage--b851c",St="buttonZone--21ce2",ft="bettingPanel--0bd43",$t="visible--3a15f",Bt="landscape--91933",Ot="xxxtremeButtonAndBetStake--ac826",vt="infoButton--439ae",pt="container--46a22",jt=1e3,rt=l.e(jt)((({visible:t})=>{const K=x.wA(),D=x.d4(M.K),a=k.V((t=>t.orientation)),G=x.d4(xt.WN),b=x.d4(Nt.xf);W.useEffect((()=>K(Gt.Zq)),[K]);const n=E+60;return N.jsxs("div",{className:j.A(Yt,{[$t]:t,[Bt]:a===P.t.Landscape}),style:{"--disappearDuration":`${jt}ms`},children:[N.jsx(bt.F,{}),N.jsx(nt.A,{platform:y.OD.Tablet}),N.jsx(z.S,{platform:y.OD.Tablet,bottomPx:n}),N.jsx(et.f,{platform:y.OD.Tablet}),N.jsx(Dt.a,{visible:t}),N.jsx(Q.MobileSafeContainerConnected,{isRng:!1,children:N.jsxs("div",{className:pt,children:[N.jsx(at.b,{isTablet:!0,spinMode:G,className:Lt}),N.jsxs("div",{className:St,children:[N.jsxs("div",{className:Ot,children:[D&&N.jsx(it.h,{playerGameId:b}),N.jsx(r.H,{gamePhase:"Qualification"})]}),N.jsxs("div",{className:ft,children:[N.jsx(Wt.D,{}),N.jsx(Kt.YQ,{}),N.jsx(tt.L,{})]}),N.jsx("div",{className:vt,children:N.jsx(I.H,{})})]})]})}),D&&N.jsx(At,{playerGameId:b})]})})),Mt="mobileQualificationLayout--bba13",kt="catchScattersMessage--c113d",tK="buttonZone--c5a20",KK="bettingPanel--c7874",DK="visible--06a3c",aK="xxxtremeButton--04466",GK="container--799cc",NK="menuButtonsContainer--73d68",WK="betStake--8d590",xK="menuButtonSpace--3021b",bK=1e3,nK=l.e(bK)((({visible:t})=>{const K=x.wA(),D=x.d4(M.K),a=x.d4(xt.WN),G=x.d4(Nt.xf);W.useEffect((()=>K(Gt.Zq)),[K]);const b=W.useRef(null),n=W.useMemo((()=>{var t,K;const D=null===(K=null===(t=b.current)||void 0===t?void 0:t.lastChild)||void 0===K?void 0:K.firstChild;return D?window.innerHeight-D.clientHeight:0}),[b.current]);return N.jsxs("div",{ref:b,className:j.A(Mt,{[DK]:t}),style:{"--disappearDuration":`${bK}ms`},children:[N.jsx(bt.F,{}),N.jsx(nt.A,{platform:y.OD.Phone}),N.jsx(z.S,{platform:y.OD.Phone,containerHeightPx:u}),N.jsx(et.f,{platform:y.OD.Phone}),N.jsx(Dt.a,{visible:t}),N.jsxs(Q.MobileSafeContainerConnected,{isRng:!1,children:[N.jsxs("div",{className:GK,children:[N.jsx(at.b,{isMobile:!0,spinMode:a,className:kt}),N.jsxs("div",{className:NK,children:[N.jsx(I.H,{}),N.jsx("div",{className:WK,children:N.jsx(r.H,{gamePhase:"Qualification"})}),N.jsx("div",{className:xK})]})]}),N.jsxs("div",{className:tK,style:{bottom:`${d-n}px`},children:[D&&N.jsx("div",{className:aK,children:N.jsx(it.h,{playerGameId:G})}),N.jsxs("div",{className:KK,children:[N.jsx(Wt.D,{}),N.jsx(Kt.YQ,{}),N.jsx(tt.L,{})]})]})]}),D&&N.jsx(At,{playerGameId:G})]})}));var eK=D(873666);const iK="qualifiedPlayers--d94cb",zK="visible--936b0",IK=1e3,ZK=l.e(IK)((({visible:t})=>N.jsx("div",{className:j.A({[zK]:t}),style:{"--disappearDuration":`${IK}ms`},children:N.jsx(Q.MobileSafeContainerConnected,{isRng:!1,children:N.jsx(eK.c,{className:iK})})}))),wK="qualifiedPlayers--f6624",mK="visible--e8f09",uK=1e3,dK=l.e(uK)((({visible:t})=>N.jsx("div",{className:j.A({[mK]:t}),style:{"--disappearDuration":`${uK}ms`},children:N.jsx(Q.MobileSafeContainerConnected,{isRng:!1,children:N.jsx(eK.c,{className:wK})})})));var EK=D(324978),lK=D(838998),QK=D(842092),PK=D(748398);const yK="tabletTopUpLayout--001b7",qK="container--be296",XK="wheel--ddff3",hK="visible--764a0",JK="footer--53e18",TK="bettingPanel--f2f70",_K="bettingPanelElement--7d806",CK="betStake--d9726",HK="spinButton--8b831",oK="infoButton--832c7",UK="boxes--c339f",VK=1e3,sK=l.e(VK)((({visible:t})=>{const K=x.wA();W.useEffect((()=>K(lK.Er())),[K]);const D=E+60;return N.jsx("div",{className:j.A(yK,{[hK]:t}),style:{"--disappearDuration":`${VK}ms`},children:N.jsx(Q.MobileSafeContainerConnected,{isRng:!1,children:N.jsxs("div",{className:qK,children:[N.jsx("div",{className:XK,children:N.jsx(PK.w,{isMobile:!1})}),N.jsx("div",{className:JK,children:N.jsx(z.S,{platform:y.OD.Tablet,bottomPx:D})}),N.jsx("div",{className:UK,children:N.jsx(i.i,{platform:y.OD.Tablet,type:"TopUp",visible:!0})}),N.jsxs("div",{className:TK,children:[N.jsx("div",{className:j.A(_K,CK),children:N.jsx(r.H,{gamePhase:"TopUp"})}),N.jsx("div",{className:j.A(_K,HK),children:N.jsx(QK.v,{})}),N.jsx("div",{className:oK,children:N.jsx(I.H,{})})]})]})})})})),FK="mobileTopUpLayout--8ce8c",cK="container--2b306",gK="wheel--19cc0",RK="visible--1c6f9",AK="buttonZone--b2f3b",YK="bettingPanel--cf6c4",LK="menuButtonsContainer--42eab",SK="betStake--2d86c",fK="menuButtonSpace--4e8f0",$K="boxes--96114",BK=1e3,OK=l.e(BK)((({visible:t})=>{const K=x.wA();W.useEffect((()=>K(lK.Er())),[K]);const D=W.useRef(null),a=W.useMemo((()=>{var t,K;const a=null===(K=null===(t=D.current)||void 0===t?void 0:t.lastChild)||void 0===K?void 0:K.firstChild;return a?window.innerHeight-a.clientHeight:0}),[D.current]);return N.jsxs("div",{ref:D,className:j.A(FK,{[RK]:t}),style:{"--disappearDuration":`${BK}ms`},children:[N.jsx(z.S,{platform:y.OD.Phone,containerHeightPx:u}),N.jsx(Q.MobileSafeContainerConnected,{isRng:!1,children:N.jsxs("div",{className:cK,children:[N.jsx("div",{className:gK,children:N.jsx(PK.w,{isMobile:!0})}),N.jsx("div",{className:$K,children:N.jsx(i.i,{platform:y.OD.Phone,type:"TopUp",visible:!0})}),N.jsxs("div",{className:LK,children:[N.jsx(I.H,{}),N.jsx("div",{className:SK,children:N.jsx(r.H,{gamePhase:"TopUp"})}),N.jsx("div",{className:fK})]}),N.jsx("div",{className:AK,style:{bottom:`${d-a}px`},children:N.jsx("div",{className:YK,children:N.jsx(QK.v,{})})})]})})]})}));var vK=D(537658);const pK="mobileOverlay--0b591";var jK=D(343298),rK=D(509407),MK=D(132006),kK=D(25581),tD=D(897899),KD=D(744327);const DD=({betMinLimit:t,betMaxLimit:K,currencySymbol:D,tableMinLimit:a,tableMaxLimit:G,tableName:x,tBodyComponent:b,preSection:n,areLimitsInlined:e=!1,hideTitle:i=!1,isTablet:z=!1,showPayouts:I,legacyMenuMode:Z})=>{const w=W.useContext(MK.lv),m=W.useMemo((()=>rK.Q({lowerLimit:t,upperLimit:K,currencySymbol:D})),[t,K,D]),u=W.useMemo((()=>{if(G&&a)return rK.Q({lowerLimit:a,upperLimit:G,currencySymbol:D})}),[a,G,D]);return N.jsxs(N.Fragment,{children:[N.jsx(kK.y,{className:KD.A.container,useMobileScrollable:!0,dataRole:Z?void 0:"drawer-scrollable",hasContentFadeOut:!Z,refCallback:null==w?void 0:w.assignScrollable,children:N.jsxs("div",{className:KD.A.scrollContainer,children:[!i&&N.jsxs("div",{className:j.A(KD.A.tableInfo,{[KD.A.tablet]:z}),children:[N.jsxs("div",{children:[`${mt.Tl("table")}: `,N.jsx("span",{className:KD.A.tableName,children:x})]}),N.jsxs("div",{children:[N.jsx("span",{children:mt.Tl("betlimits3")})," ",N.jsx("span",{className:KD.A.limits,children:m})]}),!!u&&N.jsxs("div",{"data-role":"table-limits",children:[N.jsx("span",{children:mt.Tl("tableLimits3")})," ",N.jsx("span",{className:KD.A.limits,children:u})]})]}),n,N.jsxs("table",{className:KD.A.table,children:[N.jsx(tD.V,{isMobile:!0,areLimitsInlined:e,showPayouts:I,legacyMenuMode:Z}),b]})]})}),Z&&N.jsx("div",{className:j.A(KD.A.shadow,{[KD.A.tablet]:z})})]})};DD.displayName="MobileBetLimitsAndPayoutsTable";var aD=D(337234),GD=D(13799),ND=D(700749),WD=D(137832);const xD="videoContainer--55c5b",bD="isTablet--35f07",nD="landscape--2fefb",eD="gradientContainer--cdd79",iD="gradient--4d634",zD="11,7,3",ID={MobileVideoWithOverlay:function(){var t,K;const D=WD.P(GD.DB),a=WD.P(GD.V6),G=null!==(K=null===(t=D.brandedClothGradient())||void 0===t?void 0:t.dark)&&void 0!==K?K:zD,[b,n]=W.useState(null),e=wt.O();e.video.mobile.disableScaleAnimation();const i=x.d4(v.ST);return W.useEffect((()=>{e.gameDimensions.subscribe(n,!0)}),[]),W.useEffect((()=>{b&&(e.video.mobile.setShouldApplyTransform(!i),i||e.video.mobile.setScale(b.height/b.boxHeight))}),[i,b]),N.jsx("div",{"data-role":"video",className:j.A(xD,{[nD]:a===P.t.Landscape,[bD]:D.DeviceSupport.IS_TABLET}),style:{background:`rgb(${G})`},children:N.jsx(ND.T,{})})},MobileVideoGradients:[function(){var t,K;const D=null!==(K=null===(t=WD.P(GD.DB).brandedClothGradient())||void 0===t?void 0:t.dark)&&void 0!==K?K:zD,a=x.d4(v.ST),[G,b]=W.useState(0);function n(){const t=document.querySelector("#video-wrapper video");t instanceof HTMLVideoElement?setTimeout((()=>{const K=t.getBoundingClientRect();b(K.height)}),1e3):globalThis.requestAnimationFrame(n)}W.useEffect((()=>{0===G?n():a||b(0)}),[G,a]);const e=`\n            linear-gradient(\n                to bottom,\n                rgba(0, 0, 0, 0) 0%,\n                rgb(${D}) 100%\n            )\n        `,i={height:`${G}px`};return N.jsx("div",{className:j.A(eD),style:i,children:N.jsx("div",{className:j.A(iD),style:{background:e}})})}],MobileVideoOverlays:[function(){const t=x.d4(xt.WN),K=x.d4(v.Od),D=x.d4(v.TV);return N.jsx(aD.N,{dimmed:"Normal"!==t,isCoverVisible:K||D})}],MobileGameOverlayContainer:()=>{const t=x.d4(v.Od),K=x.d4(v.TV),D=x.d4(v.ST),a=x.d4(v.kz),G=x.d4(b.y),e=x.d4(v.a8),i=x.d4(v.dm),z=p.h9(),{platform:I}=wt.O(),Z=k.V((t=>t.orientation)),w=I===y.OD.Tablet,m=t?"Qualification":K?"TopUp":"BonusRound";return n.w(null==z?void 0:z.adjustLayout),W.useEffect((()=>{z&&z.adjustLayout()}),[null==z?void 0:z.app]),N.jsx("div",{className:pK,children:N.jsxs(p.TO.Provider,{value:z,children:[w?N.jsxs(N.Fragment,{children:[N.jsx(rt,{visible:t}),N.jsx(sK,{visible:K}),N.jsx(c,{visible:D}),N.jsx(ZK,{visible:i}),N.jsx(EK.S,{gamePhase:m,isTablet:!0})]}):N.jsxs(N.Fragment,{children:[N.jsx(nK,{visible:t}),(K||D)&&N.jsx(OK,{visible:K}),D&&N.jsx($,{visible:D}),i&&N.jsx(dK,{visible:i}),N.jsx(EK.S,{gamePhase:m,isPhone:!0})]}),z?N.jsx(vK.m,{application:z.app,style:{pointerEvents:"none",position:"absolute"}}):null,e&&N.jsx(O.R,{visible:e}),a&&N.jsx(B.m,{orientation:Z,visible:a,logo:G})]})})},HelpComponentListCreator:G.B,HelpCreator:G.A,MobileMenuNavigationMap:{betLimits:()=>{const{settings:t}=wt.O(),K=t.DeviceSupport.IS_TABLET,D=t.getTableName(),a=k.V((t=>t.currencySymbol)),G=k.V((t=>t.tableLimits.min)),W=k.V((t=>t.tableLimits.max));return N.jsx(DD,{tableName:D,currencySymbol:a,betMinLimit:G,betMaxLimit:W,tBodyComponent:N.jsx(jK.o,{isMobile:!0}),isTablet:K})}}};var ZD=D(837557),wD=D(809024),mD=D(357947),uD=D(441650),dD=D(671837);window.EVO_LOADER.publishApplication("/frontend/evo/r2/","liveslot-dealnodeal.mobile",{initialize:async function(t){ut.W0._init(t.setup,t.styles,t.tableConfig,ZD.DS),mt.JL(t.i18nData,"liveslotdealnodeal");return async function(t,K){return a.Z(t,(()=>ID),K)}(t,mD.K({animation:uD.hp.FromLeftToRight,backgroundGradientColor:dD.n(t),gameLoaderParams:t}))},dispose:wD.L,applicationType:"game"})},235805:(t,K,D)=>{var a=D(881880);D.o(a,"createDefaultEngineFeatures")&&D.d(K,{createDefaultEngineFeatures:function(){return a.createDefaultEngineFeatures}}),D.o(a,"createDefaultEngineOptions")&&D.d(K,{createDefaultEngineOptions:function(){return a.createDefaultEngineOptions}}),D.o(a,"createDefaultMaterialFeatures")&&D.d(K,{createDefaultMaterialFeatures:function(){return a.createDefaultMaterialFeatures}}),D.o(a,"createDefaultSceneFeatures")&&D.d(K,{createDefaultSceneFeatures:function(){return a.createDefaultSceneFeatures}}),D.o(a,"createEngine")&&D.d(K,{createEngine:function(){return a.createEngine}}),D.o(a,"createScene")&&D.d(K,{createScene:function(){return a.createScene}}),D.o(a,"setMaterialFeatures")&&D.d(K,{setMaterialFeatures:function(){return a.setMaterialFeatures}})},881880:()=>{},670459:(t,K,D)=>{D.d(K,{P:()=>Q});var a=D(548949),G=D(738759),N=D(136685),W=D(332290),x=D(604910),b=D(384511);const n={copy:t=>t.clone(),lerp:(t,K,D,a)=>{W.v9.LerpToRef(t,K,D,a)}},e={copy:t=>t.clone(),lerp:(t,K,D,a)=>{W.ov.LerpToRef(t,K,D,a)}},i={copy:t=>t.clone(),lerp:(t,K,D,a)=>{x.uq.LerpToRef(t,K,D,a)}},z={copy:t=>t.clone(),lerp:(t,K,D,a)=>{x.PT.SlerpToRef(t,K,D,a)}},I={copy:t=>t.clone(),lerp:(t,K,D,a)=>{a.set(b.Cc(t.x,K.x,D),b.Cc(t.y,K.y,D))}},Z={copy:t=>t.clone(),lerp:(t,K,D,a)=>{x.Pq.LerpToRef(t,K,D,a)}},w=[t=>{if(t instanceof W.v9)return n},t=>{if(t instanceof W.ov)return e},t=>{if(t instanceof x.PT)return z},t=>{if(t instanceof x.uq)return i},t=>{if(t instanceof x.I9)return I},t=>{if(t instanceof x.Pq)return Z}],m="__BABYLONJS__";var u=D(412067),d=D(277082),E=D(328910);class l extends u.N{getHardwareScalingLevel(t=!0){const K=t?d.getReverseScale():1;return super.getHardwareScalingLevel()*K}dispose(){E.tx(),super.dispose()}}function Q(t,K,D){const W=new l(t,void 0,K,D.adaptToDeviceRatio);return W.enableOfflineSupport=D.enableOfflineSupport,W.renderEvenInBackground=D.renderEvenInBackground,W.disableManifestCheck=D.disableManifestCheck,W.disablePerformanceMonitorInBackground=D.disablePerformanceMonitorInBackground,a.cn.ForceFullSceneLoadingForIncremental=D.forceFullSceneLoadingForIncremental,a.cn.ShowLoadingScreen=!1,D.highPrecisionShaderSupported||(W.getCaps().highPrecisionShaderSupported=!1),D.disableHardwareScaling||W.setHardwareScalingLevel(D.hardwareScale),G.KC(W.webGLVersion),N.ui(m,w),W.onDisposeObservable.addOnce((()=>{N.Xv(m)})),W._features.forceBitmapOverHTMLImageElement="function"==typeof createImageBitmap,W}},217057:(t,K,D)=>{D.d(K,{D:()=>G});var a=D(615473);function G(t){return{disableManifestCheck:!0,enableOfflineSupport:!1,renderEvenInBackground:!1,adaptToDeviceRatio:!1,highPrecisionShaderSupported:!t.IS_HIGH_PRECISION_SHADER_DISABLED,disableHardwareScaling:!1,forceFullSceneLoadingForIncremental:!0,hardwareScale:N(t),disablePerformanceMonitorInBackground:!0}}function N(t){const K=window.devicePixelRatio||1;if(t.IS_PHONE){const t=.7;return a.X.Clamp(1/K,t,.9)}return a.X.Clamp(1/K,.6,.8)}},787170:(t,K,D)=>{function a(t){return{audioEngine:!1,antialias:!N(t),disableWebGL2Support:G(t),xrCompatible:!1}}function G(t){return t.IS_ANDROID&&(!t.IS_ANDROID8_0_0_PLUS&&t.IS_SAMSUNG_NATIVE_BROWSER||t.IS_UCBROWSER||t.IS_QQBROWSER||t.IS_MEIZUBROWSER||t.IS_CHROME120)}function N(t){return t.IS_IOS&&t.cmpVersions(t.DeviceProperties.osVersion,"15.4")>=0&&t.cmpVersions(t.DeviceProperties.osVersion,"15.5")<0||t.IS_SAFARI&&t.cmpVersions(t.DeviceProperties.browserVersion,"15.4")>=0&&t.cmpVersions(t.DeviceProperties.browserVersion,"15.5")<0}D.d(K,{k_:()=>a})},929139:(t,K,D)=>{D.d(K,{createDefaultEngineFeatures:()=>b.D,createDefaultEngineOptions:()=>n.k_,createDefaultMaterialFeatures:()=>G.u,createDefaultSceneFeatures:()=>W.t,createEngine:()=>x.P,createScene:()=>N.B,setMaterialFeatures:()=>G.P});var a=D(328617);D.o(a,"createDefaultEngineFeatures")&&D.d(K,{createDefaultEngineFeatures:function(){return a.createDefaultEngineFeatures}}),D.o(a,"createDefaultEngineOptions")&&D.d(K,{createDefaultEngineOptions:function(){return a.createDefaultEngineOptions}}),D.o(a,"createDefaultMaterialFeatures")&&D.d(K,{createDefaultMaterialFeatures:function(){return a.createDefaultMaterialFeatures}}),D.o(a,"createDefaultSceneFeatures")&&D.d(K,{createDefaultSceneFeatures:function(){return a.createDefaultSceneFeatures}}),D.o(a,"createEngine")&&D.d(K,{createEngine:function(){return a.createEngine}}),D.o(a,"createScene")&&D.d(K,{createScene:function(){return a.createScene}}),D.o(a,"setMaterialFeatures")&&D.d(K,{setMaterialFeatures:function(){return a.setMaterialFeatures}});var G=D(534565),N=D(934724),W=D(168111),x=D(670459),b=D(217057),n=D(787170)},534565:(t,K,D)=>{D.d(K,{P:()=>G,u:()=>N});var a=D(32138);function G(t){a.F.LightmapTextureEnabled=t.LightmapTextureEnabled,a.F.AmbientTextureEnabled=t.AmbientTextureEnabled,a.F.RefractionTextureEnabled=t.RefractionTextureEnabled,a.F.ReflectionTextureEnabled=t.ReflectionTextureEnabled,a.F.ColorGradingTextureEnabled=t.ColorGradingTextureEnabled,a.F.FresnelEnabled=t.FresnelEnabled,a.F.SpecularTextureEnabled=t.SpecularTextureEnabled}function N(){return{AmbientTextureEnabled:!1,RefractionTextureEnabled:!0,ReflectionTextureEnabled:!0,ColorGradingTextureEnabled:!1,LightmapTextureEnabled:!0,FresnelEnabled:!1,SpecularTextureEnabled:!0}}},934724:(t,K,D)=>{D.d(K,{B:()=>x});var a=D(889460),G=D(898973),N=D(706211),W=D(968556);function x(t,K){const D=new a.Z(t);return K.pointerMovePredicate&&(D.pointerMovePredicate=K.pointerMovePredicate),K.pointerDownPredicate&&(D.pointerDownPredicate=K.pointerDownPredicate),K.pointerUpPredicate&&(D.pointerUpPredicate=K.pointerUpPredicate),K.clearColor&&(D.clearColor=K.clearColor),D.collisionsEnabled=K.collisionsEnabled,D.autoClear=K.autoClear,D.autoClearDepthAndStencil=K.autoClearDepthAndStencil,D.fogEnabled=K.fogEnabled,D.lensFlaresEnabled=K.lensFlaresEnabled,D.postProcessesEnabled=K.postProcessesEnabled,D.probesEnabled=K.probesEnabled,D.proceduralTexturesEnabled=K.proceduralTexturesEnabled,D.spritesEnabled=K.spritesEnabled,D.skeletonsEnabled=K.skeletonsEnabled,D.shadowsEnabled=K.shadowsEnabled,D.physicsEnabled=K.physicsEnabled,D.particlesEnabled=K.particlesEnabled,K.needInput?(function(t){const K=`${G.S0.GetPointerPrefix(t.getEngine())}cancel`,D=K=>{t._inputManager._onPointerUp(K)};window.addEventListener(K,D,!1),t.onDisposeObservable.addOnce((()=>{window.removeEventListener(K,D,!1)}))}(D),function(t){const K=K=>{t.onPointerObservable.notifyObservers(new N.mx(W.S.POINTER_LEAVE,K,null))},D=t.getEngine().getRenderingCanvas();D&&(D.addEventListener("pointerout",K,!1),t.onDisposeObservable.addOnce((()=>{D.removeEventListener("pointerout",K,!1)})))}(D)):D.detachControl(),D}},168111:(t,K,D)=>{function a(){return{pointerDownPredicate:t=>t.isPickable&&t.isVisible,pointerMovePredicate:t=>t.isPickable&&t.isVisible&&t.enablePointerMoveEvents,pointerUpPredicate:t=>t.isPickable&&t.isVisible,needInput:!0,collisionsEnabled:!1,autoClear:!1,autoClearDepthAndStencil:!1,fogEnabled:!1,lensFlaresEnabled:!1,probesEnabled:!1,proceduralTexturesEnabled:!1,spritesEnabled:!1,skeletonsEnabled:!1,postProcessesEnabled:!1,shadowsEnabled:!0,renderTargetsEnabled:!1,physicsEnabled:!1,particlesEnabled:!0}}D.d(K,{t:()=>a})},328617:()=>{},83193:(t,K,D)=>{D.d(K,{createDefaultEngineFeatures:()=>G.createDefaultEngineFeatures,createDefaultEngineOptions:()=>G.createDefaultEngineOptions,createDefaultMaterialFeatures:()=>G.createDefaultMaterialFeatures,createDefaultSceneFeatures:()=>G.createDefaultSceneFeatures,createEngine:()=>G.createEngine,createScene:()=>G.createScene,setMaterialFeatures:()=>G.setMaterialFeatures});var a=D(235805);D.o(a,"createDefaultEngineFeatures")&&D.d(K,{createDefaultEngineFeatures:function(){return a.createDefaultEngineFeatures}}),D.o(a,"createDefaultEngineOptions")&&D.d(K,{createDefaultEngineOptions:function(){return a.createDefaultEngineOptions}}),D.o(a,"createDefaultMaterialFeatures")&&D.d(K,{createDefaultMaterialFeatures:function(){return a.createDefaultMaterialFeatures}}),D.o(a,"createDefaultSceneFeatures")&&D.d(K,{createDefaultSceneFeatures:function(){return a.createDefaultSceneFeatures}}),D.o(a,"createEngine")&&D.d(K,{createEngine:function(){return a.createEngine}}),D.o(a,"createScene")&&D.d(K,{createScene:function(){return a.createScene}}),D.o(a,"setMaterialFeatures")&&D.d(K,{setMaterialFeatures:function(){return a.setMaterialFeatures}});var G=D(929139)},968556:(t,K,D)=>{D.d(K,{S:()=>G});var a=D(706211);class G extends a.Zp{}G.POINTER_LEAVE=-1},328910:(t,K,D)=>{D.d(K,{tx:()=>G}),D(625735),D(432050),D(938868);const a={};function G(){for(const t of Object.keys(a))delete a[t]}},173674:(t,K,D)=>{D.d(K,{l:()=>Z});var a=D(64922),G=D(377810),N=D(494475),W=D(904506),x=D(436794),b=D(827424),n=D(277082),e=D(892510),i=D(901577),z=D(127241),I=D(836341);const Z=N.Oe((({ag:t,state:K})=>{var D;const a=(null===(D=t.autoplay)||void 0===D?void 0:D.isRunning.value)||t.balance.isLow.value||t.lifecycle.current.value===e.P.BetsClosed;return{currencySymbol:t.currencySymbol,stakes:t.betAmounts.amounts,orientation:t.orientation,decreaseBetAmount:t.betAmounts.decreaseBetAmount,increaseBetAmount:t.betAmounts.increaseBetAmount,selectBetAmount:t.betAmounts.selectBetAmount,currencyCode:t.currency.code,selectedValue:I.P6(K),alwaysShowActionButtons:I.Un(K),decreaseButtonState:a?"disabled":I.ND(K),increaseButtonState:a?"disabled":I.vY(K),middleButtonState:a?"disabled":I.Rq(K)}}),(t=>{var K,D;return[t.balance.isLow,t.lifecycle.current,t.currencySymbol,t.currency.code,...(null===(K=t.autoplay)||void 0===K?void 0:K.isRunning)?[null===(D=t.autoplay)||void 0===D?void 0:D.isRunning]:[]]}))((({Selector:t,Controls:K=n.DefaultControls,label:D,withoutBorders:N,layerStyles:e,onStakeSelect:I,controlsTheme:Z,currencySymbol:w,stakes:m,orientation:u,selectedValue:d,alwaysShowActionButtons:E,decreaseButtonState:l,increaseButtonState:Q,middleButtonState:P,decreaseBetAmount:y,increaseBetAmount:q,selectBetAmount:X,currencyCode:h,size:J,selectorTitle:T})=>{const _=i.O(),{isLargeScreen:C,isSmallScreen:H}=b.Qo(_.viewport.size.value),o=G.useCallback((()=>{if(!I)return;const{value:t}=_.betAmounts.lastSelectedAmount,K=m.findIndex((K=>K.value===t));I(t,K)}),[_,I,m]),U=G.useCallback((t=>{X(t,void 0,"betSelector"),o()}),[X,o]),V=G.useCallback((()=>{y("betSelector"),o()}),[y,o]),s=G.useCallback((()=>{q("betSelector"),o()}),[q,o]),F=G.useMemo((()=>W.c(K)),[K]),c=C?n.DefaultDesktopSelector:z.l,g=function(t,K,D){const{isLargeScreen:a,isMediumScreen:G,isSmallScreen:N}=b.Qo(D.viewport.size.value);if(K||a)return!1;const W=N&&t===x.t.Landscape;return G||W}(u,E,_),R=H?"sm":"md";return a.jsx(n.BetStakeV2,{Selector:null!=t?t:c,currencySymbol:w,decreaseButtonState:l,increaseButtonState:Q,middleButtonState:P,onBetSelect:U,onDecreaseClick:V,onIncreaseClick:s,stakes:m,Controls:F,controlsTheme:Z,selectedValue:d,hideActionButtons:g,withoutBorders:N,label:D,layerStyles:e,currencyCode:h,size:null!=J?J:R,selectorTitle:T})}))},127241:(t,K,D)=>{D.d(K,{l:()=>u});var a=D(64922),G=D(377810),N=D(742257),W=D(632205),x=D(346160),b=D(523219),n=D(39968),e=D(489186),i=D(999780),z=D(626239);const I={openHeight:50},Z={snapPoints:["50%",n.t$]},w={height:95,breakpoint:65},m={openWidth:50},u=G.memo((({children:t,isOpen:K,onClose:D,currencyCode:n,title:u=x.Tl("betlabel.lowercase")})=>{const d=G.useMemo((()=>n?a.jsx(e.p,{currencyCode:n}):void 0),[n]);return b.W0.useLiteMobileDrawer()?a.jsx(N.Q,{titleText:u,onCloseTransitionEnd:D,portrait:Z,id:"betSelector",titleIcon:d,isOpen:K,children:a.jsx(i.y,{children:t})}):K?a.jsx(W.u,{titleText:u,isRtl:x.sU(),onClose:D,portrait:I,landscape:m,fullscreen:w,id:"betSelector",titleIcon:d,children:a.jsx(z.Xl,{children:t})}):null}));u.displayName="DefaultMobileSelector"},904506:(t,K,D)=>{D.d(K,{c:()=>n});var a=D(64922),G=D(494475),N=D(346239),W=D(836341),x=D(277082),b=D(892510);function n(t){return G.Oe((({ag:t,state:K})=>{var D;const a=(G=t.balance.isLow.value,x=null===(D=t.autoplay)||void 0===D?void 0:D.isRunning.value,n=t.lifecycle.current.value,G?N.m.lowBalance:x?N.m.autoplayRunning:n===b.P.BetsClosed?N.m.gameRoundInProgress:void 0);var G,x,n;return{decreaseButtonTooltip:null!=a?a:function({isForceDisabled:t,isDisabled:K,customTooltip:D}){return t?D:K?N.m.minBetReached:N.m.decreaseBet}({isForceDisabled:W.VA(K),isDisabled:"disabled"===W.ND(K),customTooltip:W.aY(K)}),middleButtonTooltip:null!=a?a:function({isDisabled:t,customTooltip:K}){return t?K:N.m.selectBet}({isDisabled:"disabled"===W.Rq(K),customTooltip:W.Es(K)}),increaseButtonTooltip:null!=a?a:function({isForceDisabled:t,isDisabled:K,customTooltip:D}){return t?D:K?N.m.maxBetReached:N.m.increaseBet}({isForceDisabled:W.D3(K),isDisabled:"disabled"===W.vY(K),customTooltip:W.kn(K)})}}),(t=>{var K,D;return[t.balance.isLow,t.lifecycle.current,...(null===(K=t.autoplay)||void 0===K?void 0:K.isRunning)?[null===(D=t.autoplay)||void 0===D?void 0:D.isRunning]:[]]}))((({decreaseButtonState:K,decreaseButtonTooltip:D,increaseButtonState:G,increaseButtonTooltip:N,middleButtonState:W,middleButtonTooltip:b,...n})=>{const e=x.useBetStakeTooltip({isDecreaseButtonDisabled:"disabled"===K,decreaseButtonTooltip:D,isMiddleButtonDisabled:"disabled"===W,middleButtonTooltip:b,isIncreaseButtonDisabled:"disabled"===G,increaseButtonTooltip:N});return a.jsx(t,{...n,...e,decreaseButtonState:K,increaseButtonState:G,middleButtonState:W})}))}},836341:(t,K,D)=>{D.d(K,{D3:()=>i,Es:()=>b,ND:()=>Z,P6:()=>u,Rq:()=>w,Un:()=>W,VA:()=>e,aY:()=>x,kn:()=>n,vY:()=>m});var a=D(160739),G=D(753357),N=D(87245);function W(t){return t.betStake.alwaysShowActionButtons}function x(t){return t.betStake.decrementButton.tooltipTranslationKey}function b(t){return t.betStake.middleButton.tooltipTranslationKey}function n(t){return t.betStake.incrementButton.tooltipTranslationKey}function e(t){return t.betStake.decrementButton.isDisabled}function i(t){return t.betStake.incrementButton.isDisabled}const z=a.Mz(N.Xh,N.gY,((t,K)=>{var D;return(null===(D=t[0])||void 0===D?void 0:D.value)===K})),I=a.Mz(N.Xh,N.gY,((t,K)=>{var D;const a=t.findIndex((t=>t.value===K));return a===t.length-1||!(null===(D=t[a+1])||void 0===D?void 0:D.enabled)})),Z=a.Mz(e,z,((t,K)=>t||K?"disabled":"default"));function w(t){return t.betStake.middleButton.isDisabled?"disabled":"default"}const m=a.Mz(i,I,((t,K)=>t||K?"disabled":"default")),u=a.Mz(N.gY,G.Pu,G.pg,G.Jc,((t,K,D,a)=>(K||D)&&a?a.betAmount:t))},882695:(t,K,D)=>{D.d(K,{y:()=>i});var a=D(170877),G=D(876759),N=D(827424),W=D(48415),x=D(872197),b=D(600686),n=D(494475),e=D(13799);const i=n.Oe((({state:t,ownProps:K})=>{var D,b;const n=e.md(t),i=e.uD(t),{isLargeScreen:z}=N.Qo(W.Q.size.value),I=!G.I()&&(z||i.IS_IOS||i.IS_ANDROID5_0_0_PLUS||!1);let Z=null!==(D=K.displayStars)&&void 0!==D?D:I,w=null!==(b=K.displayCoins)&&void 0!==b?b:I;return void 0!==K.winType&&(Z=I&&x.D0(K.winType),w=I&&x.il(K.winType)),{displayStars:Z,displayCoins:w,useLiteRenderMode:n!==a.OD.Desktop}}),(()=>[W.Q.size]))(b.pb)},721120:(t,K,D)=>{function a(t,K){return(1-K)**2*K*3*t+3*(1-K)*K*K*t}function G(t,K,D,a){const G=1-a;return G**3*t+G**2*a*3*(t+D)+3*G*a*a*(K+D)+a*a*a*K}function N(t,K,D,a){const G=2*Math.PI/3,N=function(t,K,D){return(1-D)*t+D*K}(t,K,a);return N+2**(-10*a)*Math.sin(10*a*G)*D}D.d(K,{Cj:()=>N,a7:()=>G,ub:()=>a}),D(228174)},537658:(t,K,D)=>{D.d(K,{m:()=>N});var a=D(64922),G=D(377810);const N=G.memo((t=>{const{application:K,shouldResizeToParent:D=!0,style:N}=t,W=G.useCallback((t=>{t&&(D&&(K.resizeTo=t),t.appendChild(K.view))}),[K,D]);return a.jsx("div",{ref:W,style:{width:"100%",height:"100%",pointerEvents:"none"===K.stage.eventMode?"none":"auto",...N}})}));N.displayName="DirectPixiRoot"},168850:(t,K,D)=>{D.d(K,{c:()=>G});var a=D(357117);async function G(t){if(a.ZQ()){const K=await D.e(22421).then(D.bind(D,276432));await K.PixiDevToolsPlugin({application:t,toggleDevTools:N})}}function N(t,K){var D,a;if(t)null===(D=window.__PIXI_APP_INIT__)||void 0===D||D.call(window,K);else{let t=window;for(;t&&(t.__PIXI_DEVTOOLS__=void 0,null===(a=t.__PIXI_DEVTOOLS_WRAPPER__)||void 0===a||a.reset(),t.parent!==t);)t=t.parent}}},439893:(t,K,D)=>{D.d(K,{X:()=>a});class a{constructor(){this.cancellationListeners=new Map,this._isCancelled=!1}get isCancelled(){return this._isCancelled}addListener(t){const K=Symbol("callback");return this.cancellationListeners.set(K,t),K}removeListener(t){return this.cancellationListeners.delete(t)}cancel(){this._isCancelled||(this._isCancelled=!0,this.cancellationListeners.forEach((t=>{t()})),this.cancellationListeners.clear())}clearListeners(){this.cancellationListeners.clear()}}},663062:(t,K,D)=>{var a;D.d(K,{l:()=>a}),function(t){t[t["None"]=0]="None",t[t["Symbols"]=1]="Symbols",t[t["Dimensions"]=2]="Dimensions",t[t["Outcome"]=4]="Outcome",t[t["Timers"]=8]="Timers"}(a||(a={}))},654560:(t,K,D)=>{D.d(K,{He:()=>G,X3:()=>i,bj:()=>N,nU:()=>a});var a,G,N,W=D(652958),x=D(746380),b=D(663062),n=D(885580),e=D(415215);(function(t){t[t["Absolute"]=0]="Absolute",t[t["Visible"]=1]="Visible"})(a||(a={})),function(t){t[t["SymbolHeight"]=0]="SymbolHeight",t[t["ReelHeight"]=1]="ReelHeight"}(G||(G={})),function(t){t[t["Center"]=0]="Center",t[t["Top"]=1]="Top",t[t["Bottom"]=2]="Bottom"}(N||(N={}));class i{constructor(t,K,D=""){this._timeScale=1,this._isSlowedDown=!1,this._wasSlowedDown=!1,this.forciblyStopped=!1,this.spinMechanics=[],this.currentSpinMechanicIndex=0,this.onStartSequenceBegin=x.lQ,this.onStartSequenceEnd=x.lQ,this.onStopSequenceBegin=x.lQ,this.onStopSequenceEnd=x.lQ,this.onStopBounceBegin=x.lQ,this.onStopBounceEnd=x.lQ,this.id=-1,this.syncSlaves=[],this.nextSequence=W.J.Spin,this.startPromise=Promise.resolve(),this.stopPromise=Promise.resolve(),this.isStarting=!1,this.isStopping=!1;const a={preBufferSize:null!==(z=null==(i=K)?void 0:i.preBufferSize)&&void 0!==z?z:1,postBufferSize:null!==(I=null==i?void 0:i.postBufferSize)&&void 0!==I?I:1,startDelay:null!==(Z=null==i?void 0:i.startDelay)&&void 0!==Z?Z:0,stopDelay:null!==(w=null==i?void 0:i.stopDelay)&&void 0!==w?w:0,reelStrip:null!==(m=null==i?void 0:i.reelStrip)&&void 0!==m?m:new n.x,normalizeTo:null!==(u=null==i?void 0:i.normalizeTo)&&void 0!==u?u:G.SymbolHeight,alignment:null!==(d=null==i?void 0:i.alignment)&&void 0!==d?d:N.Center};var i,z,I,Z,w,m,u,d;this.reelsetName=D,this._data={pool:t,symbolCount:0,visibleHeight:1,preBufferSize:a.preBufferSize,postBufferSize:a.postBufferSize,bufferSize:0,spinTimer:new e.C,startDelayTimer:new e.C(x.fP(a.startDelay)),stopDelayTimer:new e.C(x.fP(a.stopDelay)),buffer:[],outcome:[],outcomeDimensions:[],reelStrip:a.reelStrip,synchronizationFlags:b.l.None,normalizeTo:a.normalizeTo,alignment:a.alignment,targetHighestPointOffset:0}}desynchronize(){for(let t=0;t<this.syncSlaves.length;++t)this.syncSlaves[t]._syncMaster=void 0,this.syncSlaves[t]._data.synchronizationFlags=b.l.None;this.syncSlaves=[],this._syncMaster=void 0,this._data.synchronizationFlags=b.l.None}synchronize(t,K=b.l.None,D=!0){if(this.desynchronize(),K!==b.l.None){for(let K=0;K<t.length;++K)if(t[K].currentSpinMechanic.id!==this.currentSpinMechanic.id)throw new Error("Can not synchronize reels with different kinds of spin mechanics.");this._data.synchronizationFlags=K;for(let K=0;K<t.length;++K)this.syncSlaves.push(t[K]),t[K]._syncMaster=this,t[K].mimicReel(this,this._data.synchronizationFlags,D)}}mimicReel(t,K,D=!0){this._data.synchronizationFlags=K;const G=x._i(K,b.l.Symbols),N=x._i(K,b.l.Dimensions),W=x._i(K,b.l.Outcome),n=x._i(K,b.l.Timers),{outcome:e,buffer:i}=t._data,z=this._data.buffer;if(this._data.preBufferSize=t._data.preBufferSize,this._data.postBufferSize=t._data.postBufferSize,(N||G)&&this.updateBuffer(t._data.symbolCount),W){this._data.outcome=[];const t=this._data.outcome;for(let K=0;K<e.length;++K)t.push(e[K])}if(D){const t=Math.min(z.length,i.length);for(let K=0;K<t;++K){const t=i[K],D=z[K];if(G&&void 0===t&&void 0!==D)D.isDead=!0;else if(void 0!==t&&(G||N)){const W=void 0===D?void 0:D.id,b=G?t.id:W;if(void 0!==b){const G=N||void 0===D?x.Io(t.dimensions):x.Io(D.dimensions);this.setSymbolByID(b,K,a.Absolute,{landingPosition:x.a1(t.landingPosition),dimensions:G,isOutcome:t.isOutcome}).position=x.Io(t.position)}}}}n&&this.copyTimers(t),this.reelStrip.synchronize(t._data.reelStrip,null!=K?K:b.l.None)}copyTimers(t){this._data.startDelayTimer.accumulator=t._data.startDelayTimer.accumulator,this._data.startDelayTimer.stopTime=t._data.startDelayTimer.stopTime,this._data.stopDelayTimer.accumulator=t._data.stopDelayTimer.accumulator,this._data.stopDelayTimer.stopTime=t._data.stopDelayTimer.stopTime,this._data.spinTimer.accumulator=t._data.spinTimer.accumulator,this._data.spinTimer.stopTime=t._data.spinTimer.stopTime}updateBuffer(t){const K=0|t;this._data.symbolCount=K;const D=this._data.preBufferSize+K+this._data.postBufferSize,a=this._data.buffer;this._data.bufferSize=D;for(let t=a.length;t<D;++t)a.push(void 0)}clear(t=!1){const K=this._data.buffer;for(let t=0;t<K.length;++t){const D=K[t];void 0!==D&&this.destroySymbol(D),K[t]=void 0}this._data.outcome=[],this._data.outcomeDimensions=[],this._data.buffer=[],this._data.reelStrip=new n.x,this._data.bufferSize=0,this._data.symbolCount=0,this._data.synchronizationFlags=b.l.None,this._data.visibleHeight=0,t&&this.onDispose()}onDispose(){}setSymbol(t,K,D=a.Visible,G){const N=this._data.buffer,W=K+D*this._data.preBufferSize;if(W<N.length&&W>=0){const K=this.copyAndReplaceSymbol(t,W,{dimensions:G});return void 0!==K&&this.destroySymbol(K),t}throw new Error("Symbol index out of bounds.")}setSymbolByID(t,K,D=a.Visible,G){const N=this._data.buffer,W=K+D*this._data.preBufferSize,x=N.length;if(W<x&&W>=0){const K=this._data.pool.pop(t),D=this.copyAndReplaceSymbol(K,W,G);return K.onSpawn(),void 0!==D&&this.destroySymbol(D),K}throw new Error(`Symbol index (${W}) out of bounds (${x}).`)}swapSymbol(t,K,D=a.Visible,G){const N=this._data.buffer,W=K+D*this._data.preBufferSize;if(W<N.length&&W>=0)return this.copyAndReplaceSymbol(t,W,{dimensions:G});throw new Error("Symbol index out of bounds.")}copyAndReplaceSymbol(t,K,D){var a,G,N;const W=this._data.buffer,x=W[K];let b=!1,n={x:1,y:1},e={reelIndex:this.id,symbolIndex:NaN,reelsetName:this.reelsetName};return void 0!==x&&(b=x.isOutcome,e=x.landingPosition),void 0!==D?(b=null!==(a=D.isOutcome)&&void 0!==a?a:b,e=null!==(G=D.landingPosition)&&void 0!==G?G:e,n=null!==(N=D.dimensions)&&void 0!==N?N:this.currentSpinMechanic.defaultSymbolDimensions()):n=this.currentSpinMechanic.defaultSymbolDimensions(),t.isOutcome=b,t.dimensions={...n},t.landingPosition=e,t.position=this.currentSpinMechanic.getPositionForIndex(K),t.position.x=.5*(t.dimensions.x-1),W[K]=t,this.initializeSymbol(t),t.synchronize({x:0,y:0}),x}getSymbol(t,K=a.Visible){const D=this._data.buffer,G=this._data.preBufferSize,N=t+K*G;if(N<D.length&&N>=0)return D[t+K*G];console.warn(`Symbol index out of bounds for reel ${this.id}: Index is ${N}, buffer size is ${D.length} (prebufferSize = ${G}, symbolCount = ${this._data.symbolCount}, postBufferSize = ${this._data.postBufferSize}`)}forgetSymbol(t,K=a.Visible){const D=this._data.buffer,G=this._data.preBufferSize,N=t+K*G;if(N<D.length&&N>=0){const a=this.getSymbol(t,K);return D[t+K*G]=void 0,a}throw new Error("Symbol index out of bounds.")}destroySymbol(t){t.onDespawn(),this._data.pool.push(t)}addSpinMechanic(t){const K=this.spinMechanics.length;return this.spinMechanics.push(t),K}setCurrentMechanics(t){this.desynchronize(),this.currentSpinMechanic.onDeactivate(),this.currentSpinMechanicIndex=t,this.currentSpinMechanic.onActivate()}initSymbol(t){this.initializeSymbol(t)}updateSymbolLandingPositions(){for(let t=0;t<this._data.buffer.length;++t){const K=this._data.buffer[t];void 0!==K&&(K.landingPosition={reelIndex:this.id,symbolIndex:K.landingPosition.symbolIndex,reelsetName:this.reelsetName})}}destroyDeadSymbols(){const t=this._data.buffer;for(let K=t.length-1;K>=0;--K){const D=t[K];void 0!==D&&D.isDead&&(t[K]=void 0,this.destroySymbol(D))}}timeStep(t){const K=t*this._timeScale;if(this.isMaster){this.currentSpinMechanic.timeStep(K),this.destroyDeadSymbols();for(let t=0;t<this.syncSlaves.length;++t)this.syncSlaves[t].currentSpinMechanic.timeStep(K),this.syncSlaves[t].destroyDeadSymbols()}}async startSpinInternal(){this.isStarting=!0,this._wasSlowedDown=!1,this.nextSequence=W.J.Spin,await this._data.startDelayTimer.wait(),this.startSequenceBegin(),this.onStartSequenceBegin(this.id),this.currentSpinMechanic.setSpinSequence(W.J.Start);const t=this._data.spinTimer.wait();await t,this.startSequenceEnd(),this.onStartSequenceEnd(this.id),this.currentSpinMechanic.setSpinSequence(this.nextSequence),this.isStarting=!1}async startSpin(){return this.forciblyStopped=!1,this.isStarting||(this.startPromise=this.startSpinInternal()),this.startPromise}applyOutcome(){this.updateBuffer(this.outcome.length);const t=this._data.outcomeDimensions;if(this._data.normalizeTo===G.SymbolHeight)if(0===t.length)this._data.visibleHeight=this._data.outcome.length;else{let K=0;for(let D=0;D<t.length;++D)K+=t[D].y;this._data.visibleHeight=K}this.currentSpinMechanic.onOutcomeUpdated()}forceStop(){this.forciblyStopped=!0,this._data.stopDelayTimer.forceStop()}async stopSpinInternal(t){this.isStopping=!0,await this.startPromise,this.currentSpinMechanic.currentSpinSequence===W.J.Start&&(this.nextSequence=W.J.Stop,await this._data.spinTimer.wait()),t?await t:(this.forciblyStopped&&(this._data.stopDelayTimer.stopTime=0),await this._data.stopDelayTimer.wait()),this.applyOutcome(),this.stopSequenceBegin(),this.onStopSequenceBegin(this.id),this.currentSpinMechanic.setSpinSequence(W.J.Stop),this.levelSyncedReels(),await this._data.spinTimer.wait(),this.stopSequenceEnd(),this.onStopSequenceEnd(this.id),this.currentSpinMechanic.setSpinSequence(W.J.Idle),this.isStopping=!1}async stopSpin(t=null){this.isStopping||(this.stopPromise=this.stopSpinInternal(t)),await this.stopPromise}get currentSpinMechanic(){return this.spinMechanics[this.currentSpinMechanicIndex]}set visibleHeight(t){this._data.visibleHeight=t}get visibleHeight(){return this._data.visibleHeight}set timeScale(t){const K=Math.min(t,1),D=this._timeScale;D<1&&1===K?(this._isSlowedDown=!1,this._wasSlowedDown=!0):1===D&&K<1&&(this._isSlowedDown=!0,this._wasSlowedDown=!1),this._timeScale=K,this.data.spinTimer.timeScale=K,this.data.startDelayTimer.timeScale=K,this.data.stopDelayTimer.timeScale=K}get bufferSize(){return this._data.bufferSize}printState(){console.log(`State for Reel ${this.id}: `),console.log(`Visible height:  ${this._data.visibleHeight} `),console.log("Buffer:"),console.log(this._data.buffer)}setOutcome(t,K=[]){if(K.length>0&&K.length!==t.length)throw new Error(`Outcome dimensions length should be equal to 0 or the same length as outcome. Outcome length is ${t.length} and dimensions length is ${K.length}.`);const D=x._i(this._data.synchronizationFlags,b.l.Outcome);if((this.isMaster||!D)&&(this._data.outcome=t,this._data.outcomeDimensions=K,D))for(let K=0;K<this.syncSlaves.length;++K)this.syncSlaves[K]._data.outcome=t}presentOutcome(){if(this.isMaster||!x._i(this._data.synchronizationFlags,b.l.Outcome)){this.presentOutcomeInternal();for(let t=0;t<this.syncSlaves.length;++t)this.syncSlaves[t].presentOutcomeInternal()}}presentOutcomeInternal(){const t=this.outcome.length;this.applyOutcome();for(let K=0;K<t;++K){const t=this.outcome[K];this.setSymbolByID(t,K,a.Visible,{isOutcome:!0,landingPosition:{reelIndex:this.id,symbolIndex:K,reelsetName:this.reelsetName},dimensions:this._data.outcomeDimensions.length>0?this._data.outcomeDimensions[K]:void 0})}this._data.reelStrip.isEmpty()||this.currentSpinMechanic.fillWithReelStripSymbols();for(let t=0;t<this._data.bufferSize;++t){const K=this._data.buffer[t];void 0!==K&&(K.position=this.currentSpinMechanic.getPositionForIndex(t),K.synchronize({x:0,y:0}))}}setStartDelay(t,K=!0){if(this.isMaster&&(this.setStartDelayInternal(t,K),x._i(this._data.synchronizationFlags,b.l.Timers)))for(let D=0;D<this.syncSlaves.length;++D)this.syncSlaves[D].setStartDelayInternal(t,K)}setStartDelayInternal(t,K=!0){this._data.startDelayTimer.stopTime=x.fP(t),K&&(this._data.startDelayTimer.accumulator=0)}setStopDelay(t,K=!0){if(this.isMaster&&(this.setStopDelayInternal(t,K),x._i(this._data.synchronizationFlags,b.l.Timers)))for(let D=0;D<this.syncSlaves.length;++D)this.syncSlaves[D].setStopDelayInternal(t,K)}setAvalancheGravity(t){this._data.reelGravity=t}levelSyncedReels(){if(this.isMaster&&x._i(this._data.synchronizationFlags,b.l.Timers)){let t=this.getHighestPoint();for(let K=0;K<this.syncSlaves.length;++K){const D=this.syncSlaves[K].getHighestPoint();D>t&&(t=D)}this.setTargetHighestPoint(t);for(let K=0;K<this.syncSlaves.length;++K)this.syncSlaves[K].setTargetHighestPoint(t)}}getFirstInsertedOutcomeSymbol(){const t=this.getFirstInsertedOutcomeSymbolIndex();return this._data.buffer[t]}getFirstInsertedOutcomeSymbolIndex(){for(let t=this._data.buffer.length-1;t>=0;--t){const K=this._data.buffer[t];if(void 0!==K&&K.isOutcome)return t}return-1}alignOutcome(){var t;const K=x._i(this._data.synchronizationFlags,b.l.Timers);if(!this.isMaster&&K)return;const D=null!==(t=this._syncMaster)&&void 0!==t?t:this,a=D.getFirstInsertedOutcomeSymbol();if(void 0!==a)for(let t=0;t<D.syncSlaves.length;++t){const K=D.syncSlaves[t].getFirstInsertedOutcomeSymbolIndex();if(K>-1){const G=D.syncSlaves[t]._data.buffer[K];let N=a.position.y-.5*a.dimensions.y;G.position.y=N+.5*G.dimensions.y;let W=G.position.y+.5*G.dimensions.y;for(let a=K+1;a<D.syncSlaves[t]._data.buffer.length;++a){const K=D.syncSlaves[t]._data.buffer[a];void 0!==K&&(K.position.y=N-.5*K.dimensions.y,N-=K.dimensions.y)}for(let a=K-1;a>=0;--a){const K=D.syncSlaves[t]._data.buffer[a];void 0!==K&&(K.position.y=W+.5*K.dimensions.y,W+=K.dimensions.y)}}}}setStopDelayInternal(t,K=!0){this._data.stopDelayTimer.stopTime=x.fP(t),K&&(this._data.stopDelayTimer.accumulator=0)}setTargetHighestPoint(t){this.currentSpinMechanic.setTargetHighestPoint(t)}getHighestPoint(){return this.currentSpinMechanic.getHighestPoint()}get startDelay(){return x.Wj(this._data.startDelayTimer.stopTime)}get stopDelay(){return x.Wj(this._data.stopDelayTimer.stopTime)}get symbolCount(){return this._data.symbolCount}get outcomeSymbolCount(){return this.outcome.length}get preBufferSize(){return this._data.preBufferSize}get postBufferSize(){return this._data.postBufferSize}get reelStrip(){return this._data.reelStrip}get isMaster(){return void 0===this._syncMaster}get syncMaster(){return this._syncMaster}get visibleSymbolCountDuringSpin(){const t=this._data.buffer;let K=0;const D=.5*this.visibleHeight,a=-D;for(let G=0;G<t.length;G++){const N=t[G];if(void 0!==N){const t=.5*N.dimensions.y;N.position.y+t>=a&&N.position.y-t<=D&&++K}}return K}get outcome(){return this._data.outcome}get data(){return this._data}startSequenceBegin(){x.lQ()}startSequenceEnd(){x.lQ()}stopSequenceBegin(){x.lQ()}stopSequenceEnd(){x.lQ()}get isSlowedDown(){return this._isSlowedDown}get wasSlowedDown(){return this._wasSlowedDown}}},885580:(t,K,D)=>{D.d(K,{H:()=>a,x:()=>W});var a,G=D(746380),N=D(663062);(function(t){t[t["Forwards"]=1]="Forwards",t[t["Backwards"]=-1]="Backwards"})(a||(a={}));class W{constructor(){this.symbols=[],this.dimensions=[],this._possibleDimensions=[],this.symbolsIndex=0,this.dimensionsIndex=0}getNextSymbol(t){return{id:this.getNextSymbolID(t),dimensions:this.getNextSymbolDimensions(t)}}synchronize(t,K){G._i(K,N.l.Symbols)&&(this.symbols=t.symbols,this.symbolsIndex=t.symbolsIndex),G._i(K,N.l.Dimensions)&&(this.dimensions=t.dimensions,this.dimensionsIndex=t.dimensionsIndex)}getNextSymbolID(t){return this.symbolsIndex+=t,this.wrapSymbolsIndex(),this.symbols[this.symbolsIndex]}getNextSymbolDimensions(t){return this.dimensionsIndex+=t,this.wrapDimensionsIndex(),this.dimensions.length>0?this.dimensions[this.dimensionsIndex]:void 0}getCurrentSymbol(){return{id:this.getCurrentSymbolID(),dimensions:this.getCurrentSymbolDimensions()}}getCurrentSymbolID(){return this.symbols[this.symbolsIndex]}getCurrentSymbolDimensions(){return this.dimensions[this.dimensionsIndex]}setSymbols(t){this.symbols=t,this.symbolsIndex=this.symbols.length-1}setDimensions(t){this.dimensions=t,this.dimensionsIndex=this.dimensions.length-1,this.updatePossibleDimensions()}isEmpty(){return 0===this.symbols.length}applyIndexOffset(t){this.applySymbolIndexOffset(t),this.applyDimensionsIndexOffset(t)}applySymbolIndexOffset(t){this.symbolsIndex+=t,this.wrapSymbolsIndex()}applyDimensionsIndexOffset(t){this.dimensionsIndex+=t,this.wrapDimensionsIndex()}wrapSymbolsIndex(){this.symbolsIndex=G._g(this.symbolsIndex,this.symbols.length)}wrapDimensionsIndex(){this.dimensionsIndex=G._g(this.dimensionsIndex,this.dimensions.length)}get possibleDimensions(){return this._possibleDimensions}updatePossibleDimensions(){this._possibleDimensions=[];for(let t=0;t<this.dimensions.length;++t)void 0===this._possibleDimensions.find((K=>K.x===this.dimensions[t].x&&K.y===this.dimensions[t].y))&&this._possibleDimensions.push(this.dimensions[t])}}},415215:(t,K,D)=>{D.d(K,{C:()=>G});var a=D(746380);class G{constructor(t=0){this.accumulator=0,this.stopTime=0,this.onStop=a.lQ,this.promise=Promise.resolve(),this.isActive=!1,this._timeScale=1,this.resolve=a.lQ,this._isResolved=!1,this.stopTime=t}async wait(t=!0){return this.isActive||(this.promise=new Promise((K=>{this.resolve=K,this.start(t)}))),this.promise}create(){return this.isActive||(this.promise=new Promise((t=>{this.resolve=t}))),this.promise}forceStop(){if(this.resolve(),this._isResolved=!0,this.isActive){const t=G.timers;this.isActive=!1,t.splice(t.indexOf(this),1)}this.onStop()}start(t=!0){t&&(this.accumulator=0,this._isResolved=!1),this._isResolved||G.timers.includes(this)||(this.isActive=!0,G.timers.push(this))}get progress(){const t=this.accumulator/this.stopTime,K=Math.min(Math.max(t,0),1);return Number.isNaN(Number(K))?1:K}timestep(t){const K=t*this._timeScale;if(this.accumulator+=K,this.accumulator>=this.stopTime){this.accumulator=0;const t=G.timers;t.splice(t.indexOf(this),1),this.isActive=!1,this.resolve(),this._isResolved=!0,this.onStop()}}static timestep(t){const K=G.timers;for(let D=K.length-1;D>=0;--D)K[D].timestep(t)}get timeScale(){return this._timeScale}set timeScale(t){this._timeScale=Math.min(t,1)}}G.timers=[]},652958:(t,K,D)=>{var a;D.d(K,{J:()=>a}),function(t){t[t["Idle"]=0]="Idle",t[t["Start"]=1]="Start",t[t["Spin"]=2]="Spin",t[t["Stop"]=3]="Stop"}(a||(a={}))},206288:(t,K,D)=>{D.d(K,{$:()=>x});var a=D(654560),G=D(885580),N=D(746380),W=D(652958);class x{constructor(t,K){this.timestepFunction=N.lQ,this._spinMode=0,this._currentSpinSequence=W.J.Idle,this._id=K,this.reel=t,this.data=t.data}timeStep(t){this.timestepFunction(t)}setSpinSequence(t){if(t!==this.currentSpinSequence)switch(t){case W.J.Start:this._currentSpinSequence=W.J.Start,this.onStartSpin(),this.timestepFunction=this.startSpin.bind(this);break;case W.J.Stop:this._currentSpinSequence=W.J.Stop,this.onStopSpin(),this.timestepFunction=this.stopSpin.bind(this);break;case W.J.Spin:this._currentSpinSequence=W.J.Spin,this.onSpin(),this.timestepFunction=this.spin.bind(this);break;default:this._currentSpinSequence=W.J.Idle,this.onIdle(),this.timestepFunction=N.lQ}}synchronizeSymbols(){for(let t=0;t<this.data.buffer.length;t++){const K=this.data.buffer[t];void 0!==K&&K.synchronize({x:0,y:0})}}onIdle(){N.lQ()}onStartSpin(){N.lQ()}onSpin(){N.lQ()}onStopSpin(){N.lQ()}defaultSymbolDimensions(){const t={x:1,y:1};return this.data.normalizeTo===a.He.ReelHeight&&(t.y=this.data.visibleHeight/this.data.symbolCount),t}getPostBufferIndex(){return this.data.preBufferSize+this.data.symbolCount}getDimensionsForIndex(t){var K,D;return null!==(D=null===(K=this.data.buffer[t])||void 0===K?void 0:K.dimensions)&&void 0!==D?D:this.defaultSymbolDimensions()}getPositionForIndex(t){let K=0,D=0,G=0;const N=this.getPostBufferIndex();let W,x=0;for(let a=0;a<this.data.bufferSize;++a){const W=this.getDimensionsForIndex(a).y;K+=W,a<this.data.preBufferSize&&(D+=W),a>=N&&(G+=W),a<t&&(x+=W)}return W=this.data.alignment===a.bj.Bottom?this.calculateVisibleAreaBottom()-G+K-x-.5*this.getDimensionsForIndex(t).y:this.calculateVisibleAreaTop()+D-x-.5*this.getDimensionsForIndex(t).y,{x:0,y:W}}fillWithReelStripSymbols(){const t=this.reel.reelStrip,K=this.data.preBufferSize,D=this.data.bufferSize,N=this.data.buffer,W=this.getPostBufferIndex(),x=this.reel;for(let D=0;D<K;++D)if(void 0===N[D]){const N=t.getNextSymbol(G.H.Backwards);x.setSymbolByID(N.id,D-K,a.nU.Visible,{dimensions:N.dimensions})}t.applyIndexOffset(K);for(let K=W;K<D;++K)if(void 0===N[K]){const D=t.getNextSymbol(G.H.Forwards);x.setSymbolByID(D.id,K,a.nU.Absolute,{dimensions:D.dimensions})}}trimExcess(){const t=this.data.bufferSize,K=this.data.buffer;for(let D=t;D<K.length;++D)this.tryDestroySymbol(K[D]),K[D]=void 0}trimPreBuffer(){const t=this.data.preBufferSize,K=this.data.buffer;for(let D=0;D<t;++D)this.tryDestroySymbol(K[D]),K[D]=void 0}trimPostBuffer(){const t=this.data.preBufferSize,K=this.data.buffer;for(let D=t+this.data.symbolCount;D<K.length;++D)this.tryDestroySymbol(K[D]),K[D]=void 0}trimOffBuffers(){this.trimPreBuffer(),this.trimPostBuffer()}onActivate(){N.lQ()}onDeactivate(){N.lQ()}appendSymbol(t,K){const D=this.data.buffer,G=this.data.bufferSize-1;let N=G;for(let t=G;t>=0;t--)if(void 0!==D[t]){N=t;break}if(N===G)return-1;const W=N+1,x=this.reel.setSymbolByID(t,W,a.nU.Absolute,K),b=D[N];return void 0!==b&&(x.position.y=b.position.y-.5*b.dimensions.y-.5*x.dimensions.y,x.synchronize({x:0,y:0})),W}prependSymbol(t,K){let D=0;const G=this.data.buffer,N=this.data.bufferSize;for(let t=0;t<N;++t)if(void 0!==G[t]){D=t;break}if(0===D)return-1;const W=D-1,x=this.reel.setSymbolByID(t,W,a.nU.Absolute,K),b=G[D];return void 0!==b&&(x.position.y=b.position.y+.5*b.dimensions.y+.5*x.dimensions.y),W}shiftSymbolsDown(t){const K=this.data.buffer;let D=K.length-1,a=0;for(let G=D;G>=t;--G)if(void 0!==K[G]){a=G+t;for(let t=D;t<=a;++t)K.push(void 0),D=K.length-1;break}for(let a=D;a>=t;--a)K[a]=K[a-t];for(let D=0;D<t;++D)K[D]=void 0}shiftSymbolsUp(t){if(t<=0)return;const{buffer:K}=this.data,D=Math.min(t,K.length);for(let t=0;t<D;t++)this.tryDestroySymbol(K[t]);K.splice(0,D);for(let t=0;t<D;t++)K.push(void 0)}tryDestroySymbol(t){return void 0!==t&&(t.isDead=!0,this.reel.destroySymbol(t),!0)}setTargetHighestPoint(t){this.data.targetHighestPointOffset=t-this.getHighestPoint()}getHighestPoint(){for(let t=0;t<this.data.buffer.length;++t){const K=this.data.buffer[t];if(void 0!==K)return K.position.y+.5*K.dimensions.y}return 0}snap(){for(let t=0;t<this.data.buffer.length;++t){const K=this.data.buffer[t];void 0!==K&&(K.position.y=this.getPositionForIndex(t).y)}}calculateVisibleAreaTop(){switch(this.data.alignment){case a.bj.Bottom:return this.data.visibleHeight;case a.bj.Center:return.5*this.data.visibleHeight;case a.bj.Top:return 0;default:return.5*this.data.visibleHeight}}calculateVisibleAreaBottom(){switch(this.data.alignment){case a.bj.Bottom:return 0;case a.bj.Center:return.5*-this.data.visibleHeight;case a.bj.Top:return-this.data.visibleHeight;default:return.5*-this.data.visibleHeight}}squashPrebuffer(){for(let t=0;t<this.data.preBufferSize;++t)void 0===this.data.buffer[t]&&this.data.buffer.splice(t,1)}calculateSpawnPoint(){return this.calculateVisibleAreaTop()+this.defaultSymbolDimensions().y*this.data.preBufferSize}calculateDespawnPoint(){return this.calculateVisibleAreaBottom()-this.data.postBufferSize*this.defaultSymbolDimensions().y}onOutcomeUpdated(){N.lQ()}get id(){return this._id}set spinMode(t){this.reel.desynchronize(),this._spinMode=t}get spinMode(){return this._spinMode}get currentSpinSequence(){return this._currentSpinSequence}}},746380:(t,K,D)=>{D.d(K,{Io:()=>b,Wj:()=>i,_g:()=>N,_i:()=>x,a1:()=>n,fP:()=>e,lQ:()=>G,yL:()=>z,ys:()=>W});var a=D(721120);function G(){}const N=(t,K)=>(K+t%K)%K;function W(t,K,D){if(K<=0)return 0;let G=0,N=0;for(let a=0;a<K;a++){const W=1/K*a,x=1/K*(a+1),b=1-(1-W)*(1-W),n=1-(1-x)*(1-x);if(D>=b&&D<=n){const K=n-b;G=(D-b)/K,N=t*K;break}}return-a.ub(N,G)}const x=(t,K)=>(t&K)===K,b=t=>({x:t.x,y:t.y}),n=t=>({symbolIndex:t.symbolIndex,reelIndex:t.reelIndex,reelsetName:void 0===t.reelsetName?"":`${t.reelsetName}`}),e=t=>.001*t,i=t=>1e3*t;function z(t){return null!==t&&"object"==typeof t&&"function"==typeof t.then&&"function"==typeof t.catch}},33258:(t,K,D)=>{D.d(K,{w:()=>d});var a=D(64922),G=D(377810),N=D(346160),W=D(168855),x=D(699695),b=D(587698),n=D(764522),e=D(189741);const i="item--cfc33",z="disabled--46d01",I="selected--2ce0d",Z=G.memo((({currencySymbol:t,onSelect:K,stake:D,isSelected:N})=>{const{value:W,enabled:Z}=D,w=G.useMemo((()=>W>=1e6?b.K3(W,t):b.ej(W,{currencySymbol:t})),[W,t]);return a.jsx("div",{"data-role":"bet-stake-list-item",className:x.A(i,{[z]:!Z,[I]:N}),onClick:()=>{Z&&(n.triggerEvent(e._.BetStakeListItemRelease),K(W))},onPointerDown:()=>{Z&&n.triggerEvent(e._.BetStakeListItemPress)},children:w})}));Z.displayName="BetStakeItem";const w="list--add8a",m=G.memo((({currencySymbol:t,onBetSelect:K,stakes:D,selectedStakeIndex:G})=>a.jsx("div",{"data-role":"bet-stake-list",className:w,children:D.map(((D,N)=>a.jsx(Z,{onSelect:K,currencySymbol:t,stake:D,isSelected:G===N},D.value)))})));m.displayName="BetStakeList";const u="betStake--d52f6",d=G.memo((({Controls:t,Selector:K,label:D=N.Tl("betlabel"),controlsTheme:x,currencySymbol:b,currencyCode:n,onBetSelect:e,selectedValue:i,stakes:z,onDecreaseClick:I,onIncreaseClick:Z,middleButtonState:w,decreaseButtonState:d,increaseButtonState:E,hideActionButtons:l,withoutBorders:Q,layerStyles:P,size:y,selectorTitle:q})=>{const[X,h]=G.useState(!1),J=G.useRef(null),T=G.useMemo((()=>z.findIndex((t=>t.value===i))),[z,i]),_=G.useCallback((()=>{h(!1)}),[]),C=G.useCallback((()=>{h((t=>!t))}),[]),H=G.useCallback((t=>{e(t),h(!1)}),[e]);G.useEffect((()=>{"disabled"===w&&h(!1)}),[w]);const o=W.F(["betStake","customizableButton","popupBubble"],P);return a.jsxs("div",{style:o,className:u,children:[a.jsx(K,{controlsRef:J,isOpen:X,onClose:_,selectedStakeIndex:T,stakesCount:z.length,currencyCode:n,title:q,children:a.jsx(m,{currencySymbol:b,onBetSelect:H,selectedStakeIndex:T,stakes:z})}),a.jsx(t,{label:D,theme:x,currencySymbol:b,onMiddleClick:C,onIncreaseClick:Z,onDecreaseClick:I,decreaseButtonState:d,increaseButtonState:E,middleButtonState:w,isSelectorOpen:X,selectedValue:i,hideActionButtons:l,controlsRef:J,withoutBorders:Q,size:y})]})}));d.displayName="BetStakeV2"},596702:(t,K,D)=>{D.d(K,{w:()=>A});var a=D(64922),G=D(699695),N=D(377810);const W={container:"container--91d91",border:"border--e8497",outerBorder:"outerBorder--52a9d",sm:"sm--64fb2",md:"md--7a948",lg:"lg--8cb3e",midBorderStroke:"midBorderStroke--96e5b",midBorder:"midBorder--751d6",innerBorder:"innerBorder--984b8",promotion:"promotion--70373",ctaPulseKeyframes:"ctaPulseKeyframes--88939"},x=N.memo((({children:t,hideBorders:K,theme:D,size:N})=>K?a.jsx(a.Fragment,{children:t}):a.jsx("div",{"data-role":"bet-stake-borders",className:G.A(W.container,W[N]),children:a.jsx("div",{className:G.A(W.border,W.outerBorder),children:a.jsx("div",{className:G.A(W.border,W.midBorderStroke),children:a.jsx("div",{className:G.A(W.border,W.midBorder),children:a.jsx("div",{className:G.A(W.border,W.innerBorder,{[W.promotion]:"promo"===D}),children:t})})})})})));x.displayName="Borders";const b="container--3b322",n="layer--c424f",e="midBody--1e2c0",i="promo--ec236",z="callToAction--ac6f3",I="fill--ef235",Z="mainLight--345f6",w=N.memo((({theme:t})=>a.jsx("div",{className:G.A(b,{[z]:"callToAction"===t,[i]:"promo"===t}),children:a.jsxs("div",{className:G.A(n,e),children:[a.jsx("div",{className:G.A(n,I)}),a.jsx("div",{className:G.A(n,Z)})]})})));w.displayName="LayerStyles";var m=D(346838),u=D(843717),d=D(764522),E=D(189741);const l="tooltipContainer--fdb0e",Q="inner--cb561",P=({children:t})=>a.jsx("div",{className:l,children:a.jsx("div",{className:Q,children:t})});var y=D(124315),q=D(822381);function X({containerElement:t,textElement:K,minFontSize:D,recalculated:a}){const G=window.getComputedStyle(K),N=parseFloat(G.fontSize),W=q._V(),x=t.clientWidth,b=K.scrollWidth,n=b>x,e=function(t,K,D){return D*(t/K)}(x,b,N),i=e/W,z=D/W;if(!n)return"";if(e<D){if(a){const t=i.toFixed(3);return q._m(t)}if(D>W)return q._m(1);const t=z.toFixed(3);return q._m(t)}const I=i.toFixed(3);return q._m(I)}const h={label:"label--e88e2",sm:"sm--9e590",md:"md--c3dc3",lg:"lg--0cbb7"},J=N.memo((({label:t,middleRef:K,size:D})=>{const W=N.useRef(null);return function(t,K,D){const a=y.i();N.useEffect((()=>{t&&K&&a&&(K.style.fontSize=X({containerElement:t,textElement:K,minFontSize:10}))}),[t,K,a,D])}(K.current,W.current,t),a.jsx("div",{"data-role":"bet-stake-label",ref:W,className:G.A(h.label,h[D]),children:t})}));J.displayName="Label";var T=D(587698);const _={stake:"stake--07c78",sm:"sm--a3cf6",md:"md--a6a1a",lg:"lg--e2e29"},C=N.memo((({middleRef:t,stake:K,currencySymbol:D,size:W})=>{const x=N.useRef(null);(function({containerElement:t,stakeElement:K,currentStake:D,currencySymbol:a,betStakeSize:G}){const W=y.i();N.useEffect((()=>{t&&K&&W&&function({containerElement:t,amountElement:K,minFontSize:D,currentStake:a,currencySymbol:G}){K.style.fontSize="";const N=""===G?2:void 0,W=window.getComputedStyle(K),x=document.createElement("div");document.body.appendChild(x),x.style.fontSize=W.fontSize,x.style.fontWeight=W.fontWeight,x.style.whiteSpace="nowrap",x.style.width=W.width,x.style.visibility="hidden",x.textContent=K.textContent,x.style.fontSize=X({containerElement:t,textElement:x,minFontSize:D}),x.scrollWidth-1>t.clientWidth&&(x.textContent=T.ej(a,{currencySymbol:G,maximumDecimalCount:N}),x.scrollWidth>t.clientWidth&&(x.style.fontSize=X({containerElement:t,textElement:x,minFontSize:D,recalculated:!0}))),K.style.fontSize=x.style.fontSize,K.textContent=x.textContent,document.body.removeChild(x)}({containerElement:t,amountElement:K,minFontSize:"lg"===G||"md"===G?12:11,currentStake:D,currencySymbol:a})}),[t,a,D,W,K,G])})({containerElement:t.current,stakeElement:x.current,currencySymbol:D,currentStake:K,betStakeSize:W});const b=N.useMemo((()=>K>=1e6?T.K3(K,D):T.ej(K,{currencySymbol:D})),[K,D]);return a.jsx("div",{"data-role":"bet-stake-amount",ref:x,className:G.A(_.stake,_[W]),children:b})}));C.displayName="Stake";const H={middle:"middle--cad48",sm:"sm--15882",md:"md--d44ca",lg:"lg--8a8c2",rounded:"rounded--9f5d4",disabled:"disabled--6e31f",active:"active--f1d99",promo:"promo--5390a",callToAction:"callToAction--7c74e",content:"content--5e67f"},o=N.memo((({label:t,state:K,stake:D,currencySymbol:W,rounded:x,onClick:b,theme:n,activated:e,size:i,tooltipProps:z,isSelectorOpen:I})=>{const{onPointerEnter:Z,onPointerLeave:w,onPointerUp:l,tooltipComponent:Q,showTooltip:y}=z,q=N.useRef(null),X="disabled"===K,{playSound:h}=m.D();return a.jsxs("button",{"data-state":K,"data-role":"middle",className:G.A(H.middle,H[i],{[H.rounded]:x,[H.disabled]:X,[H.active]:e,[H.callToAction]:"callToAction"===n,[H.promo]:"promo"===n}),onPointerUp:t=>{"touch"===t.pointerType&&(t.preventDefault(),X&&(null==l||l(t))),X?null==y||y():(h(u.Wo.BetStakeClick),I?d.triggerEvent(E._.BetStakeSelectorCloseRelease):d.triggerEvent(E._.BetStakeSelectorOpenRelease),b())},onPointerEnter:Z,onPointerLeave:w,onPointerDown:()=>{X||(I?d.triggerEvent(E._.BetStakeSelectorClosePress):d.triggerEvent(E._.BetStakeSelectorOpenPress))},children:[!!Q&&a.jsx(P,{children:Q}),a.jsxs("div",{ref:q,className:H.content,children:[a.jsx(J,{label:t,middleRef:q,size:i}),a.jsx(C,{middleRef:q,currencySymbol:W,stake:D,size:i})]})]})}));o.displayName="Middle";const U=()=>a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M6 9.75H18V14.25H6V9.75Z",fill:"#FEF0CC"})}),V=()=>a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M14.25 9.75V5.25H9.75L9.75 9.75H5.25V14.25H9.75L9.75 18.75H14.25V14.25H18.75V9.75H14.25Z",fill:"#FEF0CC"})}),s={icon:"icon--56dfc",lg:"lg--8473a",button:"button--f8ffa",increase:"increase--b1025",decrease:"decrease--69f2e",disabled:"disabled--3de44",callToAction:"callToAction--3ccc7",promo:"promo--806c4"},F=N.memo((({state:t,onClick:K,type:D,theme:N,size:W,onPointerEnter:x,onPointerLeave:b,showTooltip:n})=>{const{playSound:e}=m.D(),i="disabled"===t,z="decrease"===D?U:V;return a.jsx("button",{onPointerLeave:b,onPointerEnter:x,"data-state":t,"data-role":`bet-stake-${D}`,className:G.A(s.button,s[D],{[s.disabled]:i,[s.promo]:"promo"===N,[s.callToAction]:"callToAction"===N}),onPointerUp:()=>{if(i)return null==n||n(),e(u.Wo.BetStakeLimitsReached),void("decrease"===D?d.triggerEvent(E._.BetStakeMinRelease):d.triggerEvent(E._.BetStakeMaxRelease));"decrease"===D?d.triggerEvent(E._.BetStakeDecreaseRelease):d.triggerEvent(E._.BetStakeIncreaseRelease),K()},onPointerDown:()=>{i||("decrease"===D?d.triggerEvent(E._.BetStakeDecreasePress):d.triggerEvent(E._.BetStakeIncreasePress))},children:a.jsx("span",{className:G.A(s.icon,"lg"===W&&s[W]),children:a.jsx(z,{})})})}));F.displayName="ActionButton";const c={side:"side--88612",increase:"increase--ba705",decrease:"decrease--dac3e",separatorLine:"separatorLine--5a62c"},g=N.memo((({theme:t,onClick:K,state:D,type:N,size:W,tooltipProps:x})=>{const{tooltipComponent:b,onPointerEnter:n,onPointerLeave:e,onPointerUp:i,showTooltip:z}=x;return a.jsxs("div",{className:G.A(c.side,c[N]),children:[!!b&&a.jsx(P,{children:b}),a.jsx(F,{theme:t,onClick:K,state:D,type:N,size:W,onPointerEnter:n,onPointerLeave:e,onPointerUp:i,showTooltip:z}),a.jsx("div",{className:G.A(c.separatorLine,c[N])})]})}));g.displayName="SideControl";const R={controls:"controls--2a3b6",ctaPulseKeyframes:"ctaPulseKeyframes--0cd5d",sm:"sm--d3936",hiddenActionButtons:"hiddenActionButtons--542d7",md:"md--b7347",lg:"lg--97295",controlsInner:"controlsInner--97b08"},A=N.memo((({currencySymbol:t,selectedValue:K,middleButtonState:D,decreaseButtonState:N,increaseButtonState:W,label:b,onDecreaseClick:n,onMiddleClick:e,onIncreaseClick:i,isSelectorOpen:z,hideActionButtons:I=!1,theme:Z="default",controlsRef:m,withoutBorders:u=!1,size:d="sm",decreaseButtonTooltipProps:E,middleButtonTooltipProps:l,increaseButtonTooltipProps:Q})=>a.jsx("div",{className:G.A(R.controls,R[d],{[R.hiddenActionButtons]:I}),ref:m,"data-role":"bet-stake-controls",children:a.jsx(x,{theme:Z,hideBorders:u,size:d,children:a.jsxs("div",{className:R.controlsInner,children:[a.jsx(w,{theme:Z}),!I&&a.jsx(g,{type:"decrease",onClick:n,state:N,theme:Z,size:d,tooltipProps:E}),a.jsx(o,{activated:z,onClick:e,label:b,stake:K,state:D,currencySymbol:t,rounded:I,theme:Z,size:d,tooltipProps:l,isSelectorOpen:z}),!I&&a.jsx(g,{type:"increase",onClick:i,state:W,theme:Z,size:d,tooltipProps:Q})]})})})));A.displayName="DefaultControls"},547514:(t,K,D)=>{D.d(K,{P:()=>q});var a=D(64922),G=D(377810),N=D(346160),W=D(699695),x=D(346838),b=D(843717),n=D(491317),e=D(28230),i=D(25581),z=D(410376);const I="container--e523f",Z="titleContainer--9cb00",w="rtl--2dde0",m="icon--df4ba",u="title--10170",d="content--cc251",E="closeButton--0b14d",l="scroller--8bcf4",Q=({visible:t,onClose:K,titleIcon:D,titleText:N,children:Q,isRtl:P,betStakeButtonRef:y,scrollPosition:q,setScrollableRef:X})=>{const{playSound:h}=x.D(),J=G.useRef(null);(function(t,K,D,a){G.useEffect((()=>{const G=K=>{if(t.current&&(null==a?void 0:a.current)){const G=K.target;t.current.contains(G)||a.current.contains(G)||D()}};if(K)return document.addEventListener("pointerdown",G),()=>{document.removeEventListener("pointerdown",G)}}),[K,a,t,D])})(J,t,K,y);const T=G.useCallback((()=>{K(),h(b.Wo.ClickUIButton)}),[h,K]),_=a.jsxs("div",{ref:J,className:I,"data-role":"bet-stake-bubble-content",children:[a.jsxs("div",{className:W.A(Z,{[w]:P}),children:[!!D&&a.jsx("div",{className:m,"data-role":"betstake-bubble-icon",children:D}),a.jsx("div",{className:u,children:N})]}),a.jsx("div",{className:E,onClick:T,"data-role":"bet-selector-close",children:a.jsx(n.b,{})}),a.jsx("div",{className:d,"data-role":"bet-selector-content",children:a.jsx(i.y,{className:l,scrollBarBehavior:z.tz.AlwaysHideThumb,hasContentFadeOut:!0,position:q,refCallback:X,children:Q})})]});return a.jsx(e.f,{visible:t,position:"TopCenter",isLandscape:!1,content:_,wrapContent:!1})};var P=D(489186),y=D(607439);const q=G.memo((({children:t,isOpen:K,controlsRef:D,onClose:W,selectedStakeIndex:x,stakesCount:b,currencyCode:n,title:e=N.Tl("betlabel.lowercase")})=>{const i=G.useMemo((()=>n?a.jsx(P.p,{currencyCode:n}):void 0),[n]),{scrollPosition:z,setScrollableRef:I}=function({itemCount:t,selectedItem:K}){const[D,a]=G.useState(null),[N,W]=G.useState(0);return G.useLayoutEffect((()=>{if(!D||K<0)return;const a=D.scrollHeight,G=.5*D.clientHeight,N=100*((K+1)*(a/t)-G)/(a-G-G);W(y.A(N,0,100))}),[D,t,K]),{scrollPosition:N,setScrollableRef:a}}({selectedItem:x,itemCount:b});return a.jsx(Q,{visible:K,onClose:W,titleIcon:i,titleText:e,isRtl:N.sU(),betStakeButtonRef:D,scrollPosition:z,setScrollableRef:I,children:t})}));q.displayName="DefaultDesktopSelector"},50142:(t,K,D)=>{D.d(K,{_:()=>i});var a=D(64922),G=D(377810),N=D(346160),W=D(827424),x=D(48415),b=D(710928),n=D(894116);function e(t){const{isLargeScreen:K}=W.Qo(x.Q.size.value),{tooltip:D="",tooltipLabel:e="",hideTooltipAfterClick:i=!0,tooltipPositionHorizontal:z=b.hV.Center,tooltipPositionVertical:I=b.Ne.Top,hasAnchor:Z=K,tooltipContentRootDivElement:w,onPointerEnter:m,onPointerLeave:u,onPointerUp:d,tooltipOnTransitionEnd:E,onVisibilityChange:l,shouldShowImmediately:Q=!1}=t,[P,y]=G.useState(!1),[q,X]=G.useState(!0),h=G.useRef(),J=G.useRef(),T=n.o(((t=!0)=>{J.current&&(window.clearTimeout(J.current),J.current=void 0),X(t),y(!1),null==l||l(!1)})),_=n.o((()=>{h.current&&(window.clearTimeout(h.current),h.current=void 0),T()})),C=G.useRef(!0),H=n.o((()=>{C.current&&(J.current=window.setTimeout(T,b.p_))})),o=n.o((()=>T()));G.useEffect((()=>()=>{J.current&&window.clearTimeout(J.current),h.current&&window.clearTimeout(h.current),document.removeEventListener("click",_),document.removeEventListener("pointerdown",o)}),[]);const U=n.o(((t=!0,D=!0)=>{P||(C.current=D,y(!0),H(),null==l||l(!0),X(t)),K||document.addEventListener("pointerdown",o,{once:!0})})),V=n.o((t=>{"touch"===(null==t?void 0:t.pointerType)&&(U(),null==d||d(t))})),s=n.o((t=>{"touch"!==(null==t?void 0:t.pointerType)&&(K&&i&&document.addEventListener("click",_,{once:!0}),Q?U(!0,!1):h.current=window.setTimeout((()=>U(!0,!1)),b.QR),null==m||m(t))})),F=n.o((t=>{"touch"!==(null==t?void 0:t.pointerType)&&(document.removeEventListener("click",_),h.current&&(window.clearTimeout(h.current),h.current=void 0),T(),null==u||u(t))}));return G.useMemo((()=>{if(!e&&!D)return{};const t={isVisible:P,label:e||(D?N.Tl(D):""),horizontalPosition:z,verticalPosition:I,onTransitionEnd:E,contentRootDivElement:w,animateTooltip:q,hasAnchor:Z};return{tooltipComponent:a.jsx(b.m_,{...t}),onPointerEnter:s,onPointerLeave:F,onPointerUp:V,showTooltip:U,hideTooltip:T}}),[q,Z,T,P,s,F,V,U,D,w,e,E,z,I])}function i({isDecreaseButtonDisabled:t,isMiddleButtonDisabled:K,isIncreaseButtonDisabled:D,decreaseButtonTooltip:a,increaseButtonTooltip:G,middleButtonTooltip:N}){return{decreaseButtonTooltipProps:e({tooltip:a,hideTooltipAfterClick:!t}),middleButtonTooltipProps:e({tooltip:N,hideTooltipAfterClick:!K}),increaseButtonTooltipProps:e({tooltip:G,hideTooltipAfterClick:!D})}}},189741:(t,K,D)=>{var a;D.d(K,{_:()=>a}),function(t){t["BetStakeSelectorOpenPress"]="BetStakeSelectorOpenPress",t["BetStakeSelectorClosePress"]="BetStakeSelectorClosePress",t["BetStakeSelectorOpenRelease"]="BetStakeSelectorOpenRelease",t["BetStakeSelectorCloseRelease"]="BetStakeSelectorCloseRelease",t["BetStakeIncreasePress"]="BetStakeIncreasePress",t["BetStakeIncreaseRelease"]="BetStakeIncreaseRelease",t["BetStakeDecreasePress"]="BetStakeDecreasePress",t["BetStakeDecreaseRelease"]="BetStakeDecreaseRelease",t["BetStakeMaxRelease"]="BetStakeMaxRelease",t["BetStakeMinRelease"]="BetStakeMinRelease",t["BetStakeListItemPress"]="BetStakeListItemPress",t["BetStakeListItemRelease"]="BetStakeListItemRelease"}(a||(a={}))},554267:(t,K,D)=>{var a;D.d(K,{CX:()=>W,OZ:()=>G,Qz:()=>N,hR:()=>a}),function(t){t["Normal"]="normal",t["Fast"]="fast",t["Slow"]="slow"}(a||(a={}));const G={[a.Fast]:"fast",[a.Normal]:"normal",[a.Slow]:"relax"},N={[a.Fast]:"fastAllCaps",[a.Normal]:"normalAllCaps",[a.Slow]:"relaxAllCaps"},W=[a.Fast,a.Normal,a.Slow];a.Fast,a.Normal},235874:(t,K,D)=>{D.d(K,{M:()=>x,Y:()=>W});var a=D(64922),G=D(532836),N=D(33597);const W=({children:t,...K})=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:N.A.icon,...K,children:a.jsx("path",{d:"m15.78 17.31-4.95-4.95 4.95-4.95L14.37 6 8 12.36l6.37 6.36 1.41-1.41Z"})}),x=G.m(W);W.displayName="LeftSVG",x.displayName="Left"},767140:(t,K,D)=>{D.d(K,{Q:()=>z});var a=D(64922),G=D(699695),N=D(554267),W=D(532836),x=D(33597);const b="M10.5 3.11A10 10 0 0 0 3.34 18h2.42A8 8 0 0 1 10.5 5.14V3.11Zm3 2.03A8 8 0 0 1 18.24 18h2.42A10 10 0 0 0 13.5 3.11v2.03Zm-2.47 10.59c.94.56 2.16.23 2.7-.75.55-.96.23-2.21-.72-2.77C12.07 11.65 7 11 7 11s3.08 4.17 4.03 4.73Z",n="M17.33 4.54c.4.25.8.54 1.16.85l-1.42 1.42a8 8 0 0 0-10.14 0L5.51 5.4a10 10 0 0 1 11.82-.85Zm2.62 9.37a8 8 0 0 1-1.7 4.09h2.41a10 10 0 0 0-.2-10.34L19 9.13a7.98 7.98 0 0 1 .95 4.78ZM4.79 9.54A8 8 0 0 1 5 9.13L3.54 7.66A10 10 0 0 0 3.34 18h2.42a8 8 0 0 1-.97-8.46ZM12 16a2 2 0 1 1 0-4c1.1 0 6 2 6 2s-4.9 2-6 2Z",e="M17.33 4.54c.4.25.8.54 1.16.85l-1.42 1.42a8 8 0 0 0-10.14 0L5.51 5.4a10 10 0 0 1 11.82-.85Zm2.62 9.37a8 8 0 0 1-1.7 4.09h2.41a10 10 0 0 0-.2-10.34L19 9.13a7.98 7.98 0 0 1 .95 4.78ZM4.79 9.54A8 8 0 0 1 5 9.13L3.54 7.66A10 10 0 0 0 3.34 18h2.42a8 8 0 0 1-.97-8.46ZM14 15a2 2 0 1 1-4 0c0-1.1 2-6 2-6s2 4.9 2 6Z";function i({speed:t,speedModeCount:K,className:D,...W}){const i=function(t,K){const D=2===K;switch(t){case N.hR.Slow:return D?b:n;case N.hR.Normal:return D?b:e;case N.hR.Fast:return D?b:n;default:return""}}(t,K),z=2===K&&t===N.hR.Fast||3===K&&t===N.hR.Slow?"scaleX(-1) translateX(-24px)":"scaleX(1) translateX(0)";return a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",className:G.A(x.A.icon,D),"data-role":`speed-icon-${t}`,...W,children:a.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:i,style:{transform:z}})})}const z=W.m(i);i.displayName="SpeedSVG",z.displayName="Speed"},600686:(t,K,D)=>{D.d(K,{pb:()=>s});var a=D(64922),G=D(699695),N=D(377810),W=D(680151),x=D(886490),b=D(328382),n=D(822381),e=D(872197),i=D(426782),z=D(306335),I=D(730375),Z=D(963340),w=D(874965),m=D(422906),u=D(129517);const d=[];let E;const l=2.5,Q=2*Math.PI,P=Math.PI/180,y=1200,q=300,X=400,h=150,J=18,T=800,_=400,C=200,H=4,o=.25,U=40,V=10;class s extends N.Component{constructor(t){super(t),this.canvasScale=1,this.coins=[],this.particles=[],this.stars=[],this.width=0,this.height=0,this.coinSize=0,this.updateTime=0,this.coinCount=0,this.starCount=0,this.isComponentMounted=!1,this.animationFrameRequestId=0,this.updateSizeDependantValues=()=>{if(!this.canvas||!this.ctx)return this.handleMountingException();const{width:t,height:K}=this.canvas.getBoundingClientRect();this.width=t,this.canvas.width=t,this.height=K,this.canvas.height=K,this.canvasScale=Math.round(this.width/T*1e3)/1e3,this.coinSize=J*this.canvasScale,this.coinGradient=this.ctx.createLinearGradient(-this.coinSize,0,this.coinSize,0),this.coinGradient.addColorStop(.02,"#DE8A25"),this.coinGradient.addColorStop(.18,"#FED049"),this.coinGradient.addColorStop(.26,"#FBDA78"),this.coinGradient.addColorStop(.38,"#F8E8BF"),this.coinGradient.addColorStop(.4,"#F7E8B9"),this.coinGradient.addColorStop(.43,"#F7E8A9"),this.coinGradient.addColorStop(.47,"#F7E88F"),this.coinGradient.addColorStop(.48,"#F7E887"),this.coinGradient.addColorStop(.51,"#F7E581"),this.coinGradient.addColorStop(.55,"#F7DE71"),this.coinGradient.addColorStop(.6,"#F6D358"),this.coinGradient.addColorStop(.65,"#F5C239"),this.coinGradient.addColorStop(1,"#DA8022"),this.coinEdgeGradient=this.ctx.createLinearGradient(-this.coinSize,0,this.coinSize,0),this.coinEdgeGradient.addColorStop(0,"#794200"),this.coinEdgeGradient.addColorStop(.42,"#FFB40F"),this.coinEdgeGradient.addColorStop(.58,"#FFE2A3"),this.coinEdgeGradient.addColorStop(.73,"#FFB000"),this.coinEdgeGradient.addColorStop(1,"#936724")},this.renderFrame=()=>{const t=performance.now()/1e3;this.update(t-this.updateTime),this.updateTime=t,this.animationFrameRequestId=window.requestAnimationFrame(this.renderFrame)},this.drawMirrorImage=(t,K)=>{t.width<1||(K.save(),K.translate(T*this.canvasScale,0),K.scale(-1,1),K.drawImage(t,0,0),K.restore())},this.drawStars=(t,K)=>{for(let D=0;D<this.starCount;D++)K.save(),this.updateStar(t,this.stars[D]),K.restore()},this.drawCoins=(t,K)=>{for(let D=0;D<this.coinCount;D++)K.save(),this.updateCoin(t,this.coins[D]),K.restore()},this.drawParticles=(t,K)=>{for(const D of this.particles)K.save(),this.updateParticle(t,D),K.restore()},this.drawEllipse=(t,K)=>{if(!this.ctx)return this.handleMountingException();this.ctx.ellipse?this.ctx.ellipse(0,t*this.canvasScale,this.coinSize,K,0,0,Q):(this.ctx.save(),this.ctx.translate(0,t*this.canvasScale),this.ctx.scale(this.coinSize,K),this.ctx.arc(0,0,1,0,Q,!1),this.ctx.restore())},this.setCanvas=this.setCanvas.bind(this),this.coinCount=t.useLiteRenderMode?15:U,this.starCount=t.useLiteRenderMode?8:V}componentDidMount(){this.isComponentMounted=!0;const{displayStars:t,displayCoins:K}=this.props;if(!t)return null;if(this.updateTime=performance.now()/1e3,!this.canvas)return this.handleMountingException();const D=this.canvas.getContext("2d");if(!D)return W.M("Canvas context is empty");this.ctx=D,E||(E=[z,I,Z,w,m,u].map(((t,K)=>new Promise((D=>{const a=new Image;0||(a.onload=()=>D()),a.onerror=()=>D(),a.src=t,d[K]=a}))))),x.w9(this.updateSizeDependantValues),this.updateSizeDependantValues();const a=(T-C)/2/l,G=T/2,N=_/2;if(K)for(let t=0;t<this.coinCount;t++){const K=N+(Math.random()>.5?1:-1)*Math.random()*_*.05,D=360*Math.random(),W=360*Math.random(),x=Math.random()*(X-q)+q,b=a*(.5*Math.random()+.5);let n,e,i,z=Math.random()*T*.15;t%2?(z+=G+C/2,n=(T-z)/b,K<N?(i=(-90+90*Math.random())*P,e=K/b):(e=(_-K)/b,i=90*Math.random()*P)):(z=G-C/2-z,n=z/b,K<N?(e=K/b,i=(180+90*Math.random())*P):(e=(_-K)/b,i=(90+90*Math.random())*P));const I=Math.min(n,e),Z=y/I;this.coins.push({flipCount:0,lifeTime:0,x:z,y:K,flipDegrees:D,rotationOffset:W,distance:y,movementAngle:i,speedZ:Z,speedXY:b,moveTime:I,flipSpeed:x})}for(let t=0;t<this.starCount;t++){const K=N+(Math.random()>.5?1:-1)*Math.random()*_*.15;let D=Math.random()*T*.2;t%2?D+=G+C/2:D=G-C/2-D;const a=360*Math.random(),W=t<this.starCount/2?.5*Math.random()+.5:1*Math.random()+1,x=t<this.starCount/2?0:Math.random()*l*o,b=.3*Math.random()*l+.7*l;this.stars.push({x:D,y:K,lifeTime:0,scale:W,rotation:a,delay:x,animationTime:b,img:d[5]})}this.particles=[{x:.35*T,y:.47*_,lifeTime:0,animationTime:1.1,img:d[0],scale:.6},{x:.335*T,y:.54*_,lifeTime:0,animationTime:1.2,img:d[0],scale:.67},{x:.29*T,y:.33*_,lifeTime:0,animationTime:1.3,img:d[0],scale:1.35},{x:.26*T,y:.38*_,lifeTime:0,animationTime:1.2,img:d[0],scale:.7},{x:.245*T,y:.44*_,lifeTime:0,animationTime:1.1,img:d[0],scale:.7},{x:.28*T,y:.5*_,lifeTime:0,animationTime:1.1,img:d[0],scale:.7},{x:.26*T,y:.55*_,lifeTime:0,animationTime:1.2,img:d[0],scale:1},{x:.21*T,y:.33*_,lifeTime:0,animationTime:1.1,img:d[0],scale:.7},{x:.17*T,y:.36*_,lifeTime:0,animationTime:1.2,img:d[0],scale:.7},{x:.18*T,y:.51*_,lifeTime:0,animationTime:1.1,img:d[0],scale:1},{x:.15*T,y:.3*_,lifeTime:0,animationTime:1.1,img:d[4],scale:1.3},{x:.19*T,y:.455*_,lifeTime:0,animationTime:1.1,img:d[3],scale:1.35},{x:.205*T,y:.41*_,lifeTime:0,animationTime:1.1,img:d[2],scale:1.3},{x:.26*T,y:.29*_,lifeTime:0,animationTime:1.1,img:d[1],scale:1.3}],Promise.all(E).then((()=>{this.isComponentMounted&&(this.animationFrameRequestId=window.requestAnimationFrame(this.renderFrame))}))}componentWillUnmount(){this.isComponentMounted=!1,window.cancelAnimationFrame(this.animationFrameRequestId),x.Fu(this.updateSizeDependantValues)}render(){const{maxSizeFull:t,useMediaContainer:K,scale:D,displayStars:N}=this.props;if(!N)return null;const W=G.A(i.A.container,{[i.A.maxSizeFull]:t,[i.A.useMediaContainer]:K}),x=D||s.defaultProps.scale,e=T/b.SG*x,z=_/b.SG*x;return a.jsx("canvas",{className:W,ref:this.setCanvas,"data-role":"coins-and-stars",style:{width:n.o1(e),height:n.o1(z)}})}setCanvas(t){t&&(this.canvas=t)}update(t){if(!this.canvas||!this.ctx)return this.handleMountingException();const{useLiteRenderMode:K,displayCoins:D,displayStars:a}=this.props;this.ctx.clearRect(0,0,this.width,this.height),a&&(this.drawParticles(t,this.ctx),K||this.drawMirrorImage(this.canvas,this.ctx),this.drawStars(t,this.ctx),D&&this.drawCoins(t,this.ctx),K&&this.drawMirrorImage(this.canvas,this.ctx))}updateCoin(t,K){if(K.lifeTime+=t,K.lifeTime>K.moveTime)return;K.flipDegrees+=Math.floor(K.flipSpeed*t),K.distance-=Math.floor(K.speedZ*t);const D=K.speedXY*t;K.x+=D*Math.cos(K.movementAngle),K.y+=D*Math.sin(K.movementAngle);const a=Math.min((y-K.distance)/y,1);if(!this.ctx||!this.coinEdgeGradient||!this.coinGradient)return this.handleMountingException();const{useLiteRenderMode:G}=this.props;if(!G){const t=e.X0(K.lifeTime,K.moveTime);if(0===t)return;t<1&&(this.ctx.globalAlpha=t)}const N=Math.floor(K.flipDegrees)%90?K.flipDegrees:K.flipDegrees+1;let W=Math.abs(Math.sin(N*P))*this.coinSize;W=Math.round(1e3*W)/1e3,this.ctx.translate(this.canvasScale*K.x,this.canvasScale*K.y),this.ctx.rotate((K.rotationOffset+N)/2*P),this.ctx.scale(this.canvasScale*a,this.canvasScale*a);const x=1-W/this.coinSize;if(this.ctx.beginPath(),this.ctx.fillStyle=G?"#FBDA78":this.coinEdgeGradient,!G){let t=-H;for(;t<=H;)this.drawEllipse(a*t*x*this.canvasScale,W),t+=o}this.ctx.fill(),this.ctx.beginPath(),G||(this.ctx.fillStyle=this.coinGradient);const b=K.flipCount%2?1:-1;this.drawEllipse(a*H*x*b,W),this.ctx.fill(),K.flipCount=Math.max(Math.floor(N/90),K.flipCount)}updateParticle(t,K){K.lifeTime+=t;const D=e.WD(K.lifeTime,K.animationTime);if(!D)return;if(!this.ctx)return this.handleMountingException();const a=K.scale*K.img.width*this.canvasScale,G=K.scale*K.img.height*this.canvasScale;this.ctx.globalAlpha=D,this.ctx.translate(K.x*this.canvasScale,K.y*this.canvasScale),this.ctx.drawImage(K.img,0,0,a,G)}updateStar(t,K){if(K.delay>0)return void(K.delay-=t);K.lifeTime+=t,K.rotation+=h*t;const D=e.WD(K.lifeTime,K.animationTime);if(!D)return;if(!this.ctx)return this.handleMountingException();const a=K.scale*e.zS(K.lifeTime,K.animationTime),G=a*K.img.width*this.canvasScale,N=a*K.img.height*this.canvasScale,W=G/2,x=N/2;this.ctx.globalAlpha=D,this.ctx.translate(K.x*this.canvasScale-W,K.y*this.canvasScale-x),this.ctx.translate(W,x),this.ctx.rotate(K.rotation*P),this.ctx.drawImage(K.img,-W,-x,G,N)}handleMountingException(){return W.M("Trying to access context before it was mounted")}}s.displayName="CoinsAndStars",s.defaultProps={displayCoins:!0,displayStars:!0,maxSizeFull:!1,useMediaContainer:!1,scale:1,useLiteRenderMode:!1}},872197:(t,K,D)=>{D.d(K,{D0:()=>x,WD:()=>N,X0:()=>G,il:()=>b,zS:()=>W});var a=D(981298);function G(t,K){const D=.7*K,a=.9*K;let G=1;if(t>D)if(t<a){const K=t-D;G=Math.max(1-K/(a-D),0)}else G=0;return G}function N(t,K){let D;const a=.3*K,G=.7*K;return D=t<a?t/a:t<G?1:Math.max(1-(t-G)/a,0),D}function W(t,K){let D=1;const a=.2*K;return t<a&&(D=t/a),D}function x(t){return t===a.R.Medium||t===a.R.Big}function b(t){return t===a.R.Big}},124315:(t,K,D)=>{D.d(K,{i:()=>W});var a=D(377810);const G=new Set;function N(t){const K=document.fonts.check(t);return K&&!G.has(t)&&G.add(t),K}function W(t="10px / 12px Inter",...K){const D=[t,...K].filter(Boolean),W=D.join(),[x,b]=a.useState((()=>D.every((t=>N(t)))));return a.useEffect((()=>{const t=D.filter((t=>!N(t)));0!==t.length?Promise.all(t.map((async t=>await async function(t){const K=!!(await document.fonts.load(t))[0];return K&&G.add(t),K}(t)))).then((t=>{const K=t.every((t=>t));b(K)})):b(!0)}),[W]),x}},791376:!1,345645:!1,647525:(t,K,D)=>{t.exports=D.p+"images/barsymbol.98f27034.webp"},349531:(t,K,D)=>{t.exports=D.p+"images/cherrysymb.2ce58691.webp"},611466:(t,K,D)=>{t.exports=D.p+"images/phonesymbo.20bb34c8.webp"},437280:(t,K,D)=>{t.exports=D.p+"images/scattersym.dcc856e6.webp"},458293:(t,K,D)=>{t.exports=D.p+"images/sevensymbo.42428dcd.webp"},369982:(t,K,D)=>{t.exports=D.p+"images/tripleseve.b9be9096.webp"},776376:(t,K,D)=>{t.exports=D.p+"images/triplesymb.3ddd88fe.webp"},682174:(t,K,D)=>{t.exports=D.p+"images/wild2xsymb.c1fff13a.webp"},207147:(t,K,D)=>{t.exports=D.p+"images/wild5xsymb.40a141c6.webp"},540160:(t,K,D)=>{t.exports=D.p+"images/wildsymbol.15514b7c.webp"},575960:!1,306335:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAMAAABF0y+mAAAASFBMVEW+mwAAAAChfAC8lgDDnwDFngDJowC1jADLpADIogDHoQDNpgDMpQDIogDKowDGoADLpQDMpQDLpADMpgDLpADLpQDMpgDNpwA8whaAAAAAGHRSTlMWAAYRHCA0DEctJG9PODAnWFI/XTpjYWWZkBniAAAA8ElEQVQoz53SV27DMBAE0PU29mYpzv1vGsqOiikhATx/xAMXIHfg9kd2RAMsAmTwhMhqrb33JE/4hghzs06YgaVoEnNAlBYdwxpJjjZEP1kPW4jYZbMiT1bgGALnzAsp1n5vUBVcEF3IMCKJmgWpNoGTQhbsKEHhjORzR9RQ4EJZTUf7JVcICjcwceJP8J+xmIK/Qk7Un1KCXqFX7AiPyFdT/YI4BwenyEzPj+epymicPD4RXbAyWFbzu0+TBmVdhi740up4o3KfAQ8FKzVE9cIs3t1tprdqIrn2/agtxmYV9mrunS5Zc2EaSr0Ge47nH/PICJioE/XSAAAAAElFTkSuQmCC"},730375:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFMAAABDCAMAAADXusmpAAAAmVBMVEUAAAAuLgDJyR/u3T3t5UXw4D3h0S6qqiuAgAD254f26Gnr4Tjp3Tjl1zba1y/253ry5lvy5Uzw5knv5FDu4kT79dX36p/3547154H26Hv16HD152X052H89+D57a747Kn254v16HX052zz5lv05VHy5E+ZmQD8+en58b3366P37Kf255T27Kr255T05mvz51vy5Wn05lX///8KzdSXAAAAMnRSTlMAAgkdJiAQBgSjbBkWEw2HSzozLyrkv7OWj3lkX+3Jxq2CdFJDOAXy1MG5tq6KclROSOzvFrEAAAElSURBVFjD7dTXboNAEAXQu4WlFxtsU1zjkt74/4/Lgx9ASsAYJiKR9zztSqPVzmh0MQqfgxxj0LT+PhmosZnAr+MgZ73i74gsULNWEuRYhxJPgdokywVonYrVeoIeAtto/meaG33myDeyudT10UW8nIIY391nCgN5AnVWMXc4Bko3AeoCqTBUHDE04AbIfcxcUFNH1rhv5ORcgZoIObT/yJRTcV6yfA8iyW7hnMPDvgMNdngs7Rg9NSRsEj6/CfS0/rk1M5kYDD1Z0LQbZz5wVJ4SUJCocVl19lxQ8+ytgctOyqwufHlAG3cxlx1GF4X7anj+bMvRxpBduklLW1QJFcXfn/FxJV4sHIU2LxmuFUj/QoEJTRvZ0REgxsLyHdSmjsCIvgA08QtzF1artgAAAABJRU5ErkJggg=="},963340:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGkAAABTCAMAAACrvdnDAAAAz1BMVEUAAACMjARVVQDa1i3w4UEAAACqqivt3T28vCXj1Svv3z/z6F7z6FXz51Pv5Eng0Tr57a3z5k3x5Unu40fr4Tj26Iv154H153D26Gr06F7z5lry5WDs40D365325of253n153L16G315mf05lT05VTt4ULw5EXo3DrS0i359M/48Lr57rL255T16HT154b152Py5Evw5Fb8+uz8+OT79tz58cL58sL255L37bH26Hz26Hz366X154bn2zf79dX58sn47p705Xbz51Px43n///+3xuR8AAAARHRSTlMABAMNIQIGHAcSH1VLQS8QyT00LBitmnpvWlFOJ72ki351Z0ZEKiUWC+DSzLeDZ2I3M/Xv6djRr6aSkXt7FOTc0EU/N0kQ5+4AAAIASURBVGje7dVnj+IwEAbg13acTkIJvXdY4IBtt/Xq/v/fdFpOOkVREiAKwx6b51OkyGPZM57Bp2DZIPKli4tl9G3QKH2rMJDgozE+CG0CGrycN0CjOeA4LaYgJbzjII74ml6XKOGyFUFEPuBkxtiH/c1mEYCZE0jsN/ZQfLW3um3gSByJ1DtH5/H5Q1S2AirPLaRKSBBhs7Ncn8r9p30rBf4OkArhwl0NdP+Zgm9giiQagSHtdR9Nc97WkA72apqu3H3d1wLdKH+/UXNbjjiqJn3BPCNmbA7X9YInd4tYIIjdENinmc/hn8JT1UQEY9RtL6ubGQ5hluJ3Ugc3iwIiaPXl9W3HNnCI/o8hdnq+NukrGFmo9BRE8Kzy/K4ydBFUC1nSvLOwIwF4nZBcaFNEEcVa5XE9VhHkhqRIar5M6lscx3BGuZYABV0IhmReQEXiP8RA5cECEc5xRoyDBG/ZBQMnJaZ459Xy5RzDKb20d7emPF0vGjrCaBKpeFXwzrUqPQdh9BsbqTJaJkMYWZohk7lkKqOaVOUu0qEsW4jV/IV0TPIOMuRkbQMa6lUfRHSeShSnKECiWG4PJQ4lBBLLLb7XGQ6kVVcTJDWtrxVE4VUHfoWruY3EmBpXdRb8tH5PAQ2mI3NePxuINKqCiGPhImggMnszQCR7oxlC7haH+gMolhyEpPrLPgAAAABJRU5ErkJggg=="},874965:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAABLCAMAAAD0x38HAAAAmVBMVEUAAAAAAABhYQDc1C7Cwh6qqiXy51jz51Hx5Ffp3Tv05l/y5Wju4kjk1jvMzBr16Zf153T152f15mb05lLv5Enw4Ubt3T78+uv79+D477f366H154T26Hr16HX15nj052Hz52Py5Vjv5V/s4kXv3z38+/P79df58sj58sf355H578D1537253j152/053T05m/y5k3s4IP///91k58SAAAAMnRSTlMAAgMOCAZOQTUWXEwqEgq5fmpmRS4hG/Ts0MCgjoRnYFQ6MCcf+ebb27WhlIp5YUc8KZAGwKkAAAEASURBVFjD7ZVHCsMwEEVHsiU77nFJ7723+x8uZJGAshBYn4QUv4XBSI8RjOaL3gND5Fp9JMxtZ9FpALX3nk3mcEYVhoguYnO/vDOuE4C/pT8mkYh9HNO3E1uIPamC4kPgSN5HXhKY27O46QG1011OJTgLNW4jJcygKHT9+/NJAGEzVP49tUaqHzj2VFvdPWjlyMkKTr+OTVocV7vaz5huxtproancv/S0vXUL0pD1JNAdFv1wayddSP/7N6rmnCxjmctO7DBTWwyXbeBeT9PhDAkDu1x0ILQC5Ko1bp9NQB/BIHkcS5a3g/wReCsLGVtBFa+hkEhjDvMMsKejkN7IFVI0CVRTnLcDAAAAAElFTkSuQmCC"},422906:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEoAAAA9CAMAAAA9KQ86AAAAnFBMVEUAAAA3NwCiohfv5EfKyiTp3jbi1DHy5E3u4kDd1C/t3jzU1Cy6uiL254Xz51v26H3052z06F7y5lj05lX05lDx417254n16ID15nH06HD051ft4kTw4Dr79t369M/58sn58cL58b758L3253f9/Pb59Mv577H57a337Kj354/36Z316HX36qb15mf052Hz53fy5lny5XGSkib///+mKr4eAAAAM3RSTlMAAgUvCRYRNyYOHAsHoFSTc1lOR0I0qJZ8eUoqIOvg3NfVzYr73svIubSmhXtmX1ZQTwSDlyIfAAABIklEQVRYw+3W126EMBAF0GtjMJ2lLm17ei///2952yATFpmMlCBx3iwX2XMlazBzMmhBpD4YoOJgQVE0H5OIfQxFHiWYJLeheLk6cdAwYwMLhdcYFkjwbB0kAnqY6zL0OM/Xm8qEHmMd/ZAvT4v70Ous8jGKJbtdgj5Lyu6lnqQ6n6HHLksbRJzfJmXpXyUNB9J2oes1wmJ2/BpUrAdoCm0Q4ccVqLAPaBI3FqjkDH/FkyamEVC8bSbm4RxT9eMP6ok5vttQcMwQM0El3pKdxSXD/+HRJXtX6fQ3Lb80LXT6m0B+b7RdTJfut+E5nOa2cDDE9HFZu6qa88AtHgcfJA6r0Yyc7kBgUL408iO46YMGC4OYg4Q4fUYWaGRlxkCEqFRfojILLn7a+80AAAAASUVORK5CYII="},129517:(t,K,D)=>{t.exports=D.p+"images/star.529998ec.png"},242634:()=>{},301654:t=>{t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.__esModule=!0,t.exports["default"]=t.exports},610162:(t,K,D)=>{D.d(K,{A:()=>a});const a=D(976438)},668949:(t,K,D)=>{D.d(K,{A:()=>N});var a=D(510405),G="Expected a function";const N=function(t,K){var D;if("function"!=typeof K)throw new TypeError(G);return t=a.A(t),function(){return--t>0&&(D=K.apply(this,arguments)),t<=1&&(K=void 0),D}}},551599:(t,K,D)=>{D.d(K,{A:()=>W});var a=D(510405),G=D(171267);var N=D(56988);const W=function(t,K,D,W){var x=null==t?0:t.length;return x?(D&&"number"!=typeof D&&N.A(t,K,D)&&(D=0,W=x),function(t,K,D,N){var W=t.length;for((D=a.A(D))<0&&(D=-D>W?0:W+D),(N=void 0===N||N>W?W:a.A(N))<0&&(N+=W),N=D>N?0:G.A(N);D<N;)t[D++]=K;return t}(t,K,D,W)):[]}},444792:(t,K,D)=>{D.d(K,{A:()=>W});var a=D(156568),G=D(258214),N="[object Boolean]";const W=function(t){return!0===t||!1===t||G.A(t)&&a.A(t)==N}},163095:(t,K,D)=>{D.d(K,{A:()=>G});var a=D(668949);const G=function(t){return a.A(2,t)}},171267:(t,K,D)=>{D.d(K,{A:()=>W});var a=D(202129),G=D(510405),N=4294967295;const W=function(t){return t?a.A(G.A(t),0,N):0}},929468:(t,K,D)=>{D.d(K,{A:()=>N});var a=D(957842),G=0;const N=function(t){var K=++G;return a.A(t)+K}},164596:(t,K,D)=>{D.d(K,{A:()=>N});const a='(function () {\n    \'use strict\';\n\n    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";\n    async function checkImageBitmap() {\n      try {\n        if (typeof createImageBitmap !== "function")\n          return false;\n        const response = await fetch(WHITE_PNG);\n        const imageBlob = await response.blob();\n        const imageBitmap = await createImageBitmap(imageBlob);\n        return imageBitmap.width === 1 && imageBitmap.height === 1;\n      } catch (e) {\n        return false;\n      }\n    }\n    void checkImageBitmap().then((result) => {\n      self.postMessage(result);\n    });\n\n})();\n';let G=null;class N{constructor(){G||(G=URL.createObjectURL(new Blob([a],{type:"application/javascript"}))),this.worker=new Worker(G)}}N.revokeObjectURL=function(){G&&(URL.revokeObjectURL(G),G=null)}},981656:(t,K,D)=>{D.d(K,{A:()=>N});const a='(function () {\n    \'use strict\';\n\n    async function loadImageBitmap(url, alphaMode) {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\n      }\n      const imageBlob = await response.blob();\n      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);\n    }\n    self.onmessage = async (event) => {\n      try {\n        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);\n        self.postMessage({\n          data: imageBitmap,\n          uuid: event.data.uuid,\n          id: event.data.id\n        }, [imageBitmap]);\n      } catch (e) {\n        self.postMessage({\n          error: e,\n          uuid: event.data.uuid,\n          id: event.data.id\n        });\n      }\n    };\n\n})();\n';let G=null;class N{constructor(){G||(G=URL.createObjectURL(new Blob([a],{type:"application/javascript"}))),this.worker=new Worker(G)}}N.revokeObjectURL=function(){G&&(URL.revokeObjectURL(G),G=null)}},176959:(t,K,D)=>{D.d(K,{l:()=>n});var a=D(992178),G=D(339254),N=D(748459),W=D(858678),x=D(5319);const b=class t{constructor(...t){this.stage=new N.mc,void 0!==t[0]&&x.t6(x.lj,"Application constructor options are deprecated, please use Application.init() instead.")}async init(K){K={...K},this.renderer=await G.q(K),t._plugins.forEach((t=>{t.init.call(this,K)}))}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return x.t6(x.lj,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(K=!1,D=!1){const a=t._plugins.slice(0);a.reverse(),a.forEach((t=>{t.destroy.call(this)})),this.stage.destroy(D),this.stage=null,this.renderer.destroy(K),this.renderer=null}};b._plugins=[];let n=b;a.XO.handleByList(a.Ag.Application,n._plugins),a.XO.add(W.M)},192828:(t,K,D)=>{D.d(K,{s:()=>J});var a=D(992178),G=D(794583),N=D(229995),W=D(960118),x=D(363020),b=D(11277),n=D(424056),e=D(125518),i=D(435977),z=D(7412),I=D(761403),Z=D(368342),w=D(9444),m=D(968316),u=D(90586),d=D(984727),E=D(464193),l=D(175661),Q=D(428230),P=D(149814),y=D(358149),q=D(282637),X=D(309313),h=D(509384);const J=new class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new q.x,this.loader=new w.a,this.cache=x.l,this._backgroundLoader=new W.o(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var K,D,a;if(this._initialized)return void N.R("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let K=t.manifest;"string"==typeof K&&(K=await this.load(K)),this.resolver.addManifest(K)}const G=null!==(D=null===(K=t.texturePreference)||void 0===K?void 0:K.resolution)&&void 0!==D?D:1,W="number"==typeof G?[G]:G,x=await this._detectFormats({preferredFormats:null===(a=t.texturePreference)||void 0===a?void 0:a.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:x,resolution:W}}),t.preferences&&this.setPreferences(t.preferences)}add(t){this.resolver.add(t)}async load(t,K){this._initialized||await this.init();const D=h.a(t),a=X.z(t).map((t=>{if("string"!=typeof t){const K=this.resolver.getAlias(t);return K.some((t=>!this.resolver.hasKey(t)))&&this.add(t),Array.isArray(K)?K[0]:K}return this.resolver.hasKey(t)||this.add({alias:t,src:t}),t})),G=this.resolver.resolve(a),N=await this._mapLoadToResolve(G,K);return D?N[a[0]]:N}addBundle(t,K){this.resolver.addBundle(t,K)}async loadBundle(t,K){this._initialized||await this.init();let D=!1;"string"==typeof t&&(D=!0,t=[t]);const a=this.resolver.resolveBundle(t),G={},N=Object.keys(a);let W=0,x=0;const b=()=>{null==K||K(++W/x)},n=N.map((t=>{const K=a[t];return x+=Object.keys(K).length,this._mapLoadToResolve(K,b).then((K=>{G[t]=K}))}));return await Promise.all(n),D?G[t[0]]:G}async backgroundLoad(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const K=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(K))}async backgroundLoadBundle(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const K=this.resolver.resolveBundle(t);Object.values(K).forEach((t=>{this._backgroundLoader.add(Object.values(t))}))}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if("string"==typeof t)return x.l.get(t);const K={};for(let D=0;D<t.length;D++)K[D]=x.l.get(t[D]);return K}async _mapLoadToResolve(t,K){const D=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const a=await this.loader.load(D,K);this._backgroundLoader.active=!0;const G={};return D.forEach((t=>{const K=a[t.src],D=[t.src];t.alias&&D.push(...t.alias),D.forEach((t=>{G[t]=K})),x.l.set(D,K)})),G}async unload(t){this._initialized||await this.init();const K=X.z(t).map((t=>"string"!=typeof t?t.src:t)),D=this.resolver.resolve(K);await this._unloadFromResolved(D)}async unloadBundle(t){this._initialized||await this.init(),t=X.z(t);const K=this.resolver.resolveBundle(t),D=Object.keys(K).map((t=>this._unloadFromResolved(K[t])));await Promise.all(D)}async _unloadFromResolved(t){const K=Object.values(t);K.forEach((t=>{x.l.remove(t.src)})),await this.loader.unload(K)}async _detectFormats(t){let K=[];t.preferredFormats&&(K=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const D of t.detections)t.skipDetections||await D.test()?K=await D.add(K):t.skipDetections||(K=await D.remove(K));return K=K.filter(((t,D)=>K.indexOf(t)===D)),K}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach((K=>{K.config&&Object.keys(K.config).filter((K=>K in t)).forEach((D=>{K.config[D]=t[D]}))}))}};a.XO.handleByList(a.Ag.LoadParser,J.loader.parsers).handleByList(a.Ag.ResolveParser,J.resolver.parsers).handleByList(a.Ag.CacheParser,J.cache.parsers).handleByList(a.Ag.DetectionParser,J.detections),a.XO.add(b.P,e.M,n.Q,Z.Y,i.p,z.G,I.d,m.F,u.f,d.e,E.Z,l.P,Q.Qj,G.R,G.w,y.j,P.u);const T={loader:a.Ag.LoadParser,resolver:a.Ag.ResolveParser,cache:a.Ag.CacheParser,detection:a.Ag.DetectionParser};a.XO.handle(a.Ag.Asset,(t=>{const K=t.ref;Object.entries(T).filter((([t])=>!!K[t])).forEach((([t,D])=>{var G;return a.XO.add(Object.assign(K[t],{extension:null!==(G=K[t].extension)&&void 0!==G?G:D}))}))}),(t=>{const K=t.ref;Object.keys(T).filter((t=>!!K[t])).forEach((t=>a.XO.remove(K[t])))}))},960118:(t,K,D)=>{D.d(K,{o:()=>a});class a{constructor(t,K=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=K}add(t){t.forEach((t=>{this._assetList.push(t)})),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],K=Math.min(this._assetList.length,this._maxConcurrent);for(let D=0;D<K;D++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}},363020:(t,K,D)=>{D.d(K,{l:()=>N});var a=D(229995),G=D(309313);const N=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const K=this._cache.get(t);return K||a.R(`[Assets] Asset id ${t} was not found in the Cache`),K}set(t,K){const D=G.z(t);let N;for(let t=0;t<this.parsers.length;t++){const a=this.parsers[t];if(a.test(K)){N=a.getCacheableAssets(D,K);break}}const W=new Map(Object.entries(N||{}));N||D.forEach((t=>{W.set(t,K)}));const x=[...W.keys()],b={cacheKeys:x,keys:D};D.forEach((t=>{this._cacheMap.set(t,b)})),x.forEach((t=>{const D=N?N[t]:K;this._cache.has(t)&&this._cache.get(t)!==D&&a.R("[Cache] already has key:",t),this._cache.set(t,W.get(t))}))}remove(t){if(!this._cacheMap.has(t))return void a.R(`[Assets] Asset id ${t} was not found in the Cache`);const K=this._cacheMap.get(t);K.cacheKeys.forEach((t=>{this._cache.delete(t)})),K.keys.forEach((t=>{this._cacheMap.delete(t)}))}get parsers(){return this._parsers}}},11277:(t,K,D)=>{D.d(K,{P:()=>N});var a=D(992178),G=D(177487);const N={extension:{type:a.Ag.CacheParser,name:"cacheTextureArray"},test:t=>Array.isArray(t)&&t.every((t=>t instanceof G.g)),getCacheableAssets:(t,K)=>{const D={};return t.forEach((t=>{K.forEach(((K,a)=>{D[t+(0===a?"":a+1)]=K}))})),D}}},424056:(t,K,D)=>{D.d(K,{Q:()=>N});var a=D(992178),G=D(174594);const N={extension:{type:a.Ag.DetectionParser,priority:1},test:async()=>G.P("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter((t=>"avif"!==t))}},125518:(t,K,D)=>{D.d(K,{M:()=>N});var a=D(992178);const G=["png","jpg","jpeg"],N={extension:{type:a.Ag.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...G],remove:async t=>t.filter((t=>!G.includes(t)))}},435977:(t,K,D)=>{D.d(K,{p:()=>N});var a=D(992178),G=D(585848);const N={extension:{type:a.Ag.DetectionParser,priority:0},test:async()=>G.b("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter((t=>"mp4"!==t&&"m4v"!==t))}},7412:(t,K,D)=>{D.d(K,{G:()=>N});var a=D(992178),G=D(585848);const N={extension:{type:a.Ag.DetectionParser,priority:0},test:async()=>G.b("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter((t=>"ogv"!==t))}},761403:(t,K,D)=>{D.d(K,{d:()=>N});var a=D(992178),G=D(585848);const N={extension:{type:a.Ag.DetectionParser,priority:0},test:async()=>G.b("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter((t=>"webm"!==t))}},368342:(t,K,D)=>{D.d(K,{Y:()=>N});var a=D(992178),G=D(174594);const N={extension:{type:a.Ag.DetectionParser,priority:0},test:async()=>G.P("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter((t=>"webp"!==t))}},174594:(t,K,D)=>{async function a(t){if("Image"in globalThis)return new Promise((K=>{const D=new Image;D.onload=()=>{K(!0)},D.onerror=()=>{K(!1)},D.src=t}));if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const K=await(await fetch(t)).blob();await createImageBitmap(K)}catch(t){return!1}return!0}return!1}D.d(K,{P:()=>a})},585848:(t,K,D)=>{D.d(K,{b:()=>G});const a="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function G(t){return!a&&""!==document.createElement("video").canPlayType(t)}},9444:(t,K,D)=>{D.d(K,{a:()=>x});var a=D(229995),G=D(58496),N=D(309313),W=D(509384);class x{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,K,D)=>(this._parsersValidated=!1,t[K]=D,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,K){const D={promise:null,parser:null};return D.promise=(async()=>{var G,N;let W=null,x=null;if(K.loadParser&&(x=this._parserHash[K.loadParser],x||a.R(`[Assets] specified load parser "${K.loadParser}" not found while loading ${t}`)),!x){for(let D=0;D<this.parsers.length;D++){const a=this.parsers[D];if(a.load&&(null===(G=a.test)||void 0===G?void 0:G.call(a,t,K,this))){x=a;break}}if(!x)return a.R(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}W=await x.load(t,K,this),D.parser=x;for(let t=0;t<this.parsers.length;t++){const a=this.parsers[t];a.parse&&a.parse&&await(null===(N=a.testParse)||void 0===N?void 0:N.call(a,W,K,this))&&(W=await a.parse(W,K,this)||W,D.parser=a)}return W})(),D}async load(t,K){this._parsersValidated||this._validateParsers();let D=0;const a={},x=W.a(t),b=N.z(t,(t=>({alias:[t],src:t,data:{}}))),n=b.length,e=b.map((async t=>{const N=G.A.toAbsolute(t.src);if(!a[t.src])try{this.promiseCache[N]||(this.promiseCache[N]=this._getLoadPromiseAndParser(N,t)),a[t.src]=await this.promiseCache[N].promise,K&&K(++D/n)}catch(K){throw delete this.promiseCache[N],delete a[t.src],new Error(`[Loader.load] Failed to load ${N}.\n${K}`)}}));return await Promise.all(e),x?a[b[0].src]:a}async unload(t){const K=N.z(t,(t=>({alias:[t],src:t}))).map((async t=>{var K,D;const a=G.A.toAbsolute(t.src),N=this.promiseCache[a];if(N){const G=await N.promise;delete this.promiseCache[a],await(null===(D=null===(K=N.parser)||void 0===K?void 0:K.unload)||void 0===D?void 0:D.call(K,G,t,this))}}));await Promise.all(K)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter((t=>t.name)).reduce(((t,K)=>(K.name?t[K.name]&&a.R(`[Assets] loadParser name conflict "${K.name}"`):a.R(`[Assets] loadParser should have a name`),{...t,[K.name]:K})),{})}}},168786:(t,K,D)=>{D.d(K,{T:()=>a});var a=(t=>(t[t["Low"]=0]="Low",t[t["Normal"]=1]="Normal",t[t["High"]=2]="High",t))(a||{})},968316:(t,K,D)=>{D.d(K,{F:()=>e});var a=D(505777),G=D(992178),N=D(567182),W=D(722006),x=D(168786);const b=".json",n="application/json",e={extension:{type:G.Ag.LoadParser,priority:x.T.Low},name:"loadJson",test:t=>N.s(t,n)||W.W(t,b),async load(t){const K=await a.e.get().fetch(t);return await K.json()}}},90586:(t,K,D)=>{D.d(K,{f:()=>e});var a=D(505777),G=D(992178),N=D(567182),W=D(722006),x=D(168786);const b=".txt",n="text/plain",e={name:"loadTxt",extension:{type:G.Ag.LoadParser,priority:x.T.Low,name:"loadTxt"},test:t=>N.s(t,n)||W.W(t,b),async load(t){const K=await a.e.get().fetch(t);return await K.text()}}},984727:(t,K,D)=>{D.d(K,{e:()=>m});var a=D(505777),G=D(992178),N=D(229995),W=D(58496),x=D(363020),b=D(567182),n=D(722006),e=D(168786);const i=["normal","bold","100","200","300","400","500","600","700","800","900"],z=[".ttf",".otf",".woff",".woff2"],I=["font/ttf","font/otf","font/woff","font/woff2"],Z=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i,w=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/,m={extension:{type:G.Ag.LoadParser,priority:e.T.Low},name:"loadWebFont",test:t=>b.s(t,I)||n.W(t,z),async load(t,K){var D,G,b,n,e,z;const I=a.e.get().getFontFaceSet();if(I){const a=[],N=null!==(G=null===(D=K.data)||void 0===D?void 0:D.family)&&void 0!==G?G:function(t){const K=W.A.extname(t),D=W.A.basename(t,K).replace(/(-|_)/g," ").toLowerCase().split(" ").map((t=>t.charAt(0).toUpperCase()+t.slice(1)));let a=D.length>0;for(const t of D)if(!t.match(Z)){a=!1;break}let G=D.join(" ");return a||(G=`"${G.replace(/[\\"]/g,"\\$&")}"`),G}(t),u=null!==(e=null===(n=null===(b=K.data)||void 0===b?void 0:b.weights)||void 0===n?void 0:n.filter((t=>i.includes(t))))&&void 0!==e?e:["normal"],d=null!==(z=K.data)&&void 0!==z?z:{};for(let K=0;K<u.length;K++){const D=u[K],G=new FontFace(N,`url(${m=t,w.test(m)?m:encodeURI(m)})`,{...d,weight:D});await G.load(),I.add(G),a.push(G)}return x.l.set(`${N}-and-url`,{url:t,fontFaces:a}),1===a.length?a[0]:a}var m;return N.R("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach((t=>{x.l.remove(t.family),a.e.get().getFontFaceSet().delete(t)}))}}},464193:(t,K,D)=>{D.d(K,{Z:()=>Z});var a=D(505777),G=D(992178),N=D(408078),W=D(572464),x=D(206348),b=D(567182),n=D(722006),e=D(168786),i=D(729768);const z=".svg",I="image/svg+xml",Z={extension:{type:G.Ag.LoadParser,priority:e.T.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test:t=>b.s(t,I)||n.W(t,z),async load(t,K,D){var G;return(null!==(G=K.data.parseAsGraphicsContext)&&void 0!==G?G:this.config.parseAsGraphicsContext)?async function(t){const K=await a.e.get().fetch(t),D=await K.text(),G=new W.T;return G.svg(D),G}(t):async function(t,K,D,G){var W,b,n,e,z;const I=await a.e.get().fetch(t),Z=await I.blob(),w=URL.createObjectURL(Z),m=new Image;m.src=w,m.crossOrigin=G,await m.decode(),URL.revokeObjectURL(w);const u=document.createElement("canvas"),d=u.getContext("2d"),E=(null===(W=K.data)||void 0===W?void 0:W.resolution)||x.v(t),l=null!==(n=null===(b=K.data)||void 0===b?void 0:b.width)&&void 0!==n?n:m.width,Q=null!==(z=null===(e=K.data)||void 0===e?void 0:e.height)&&void 0!==z?z:m.height;u.width=l*E,u.height=Q*E,d.drawImage(m,0,0,l*E,Q*E);const{parseAsGraphicsContext:P,...y}=K.data,q=new N.b({resource:u,alphaMode:"premultiply-alpha-on-upload",resolution:E,...y});return i.s(q,D,t)}(t,K,D,this.config.crossOrigin)},unload(t){t.destroy(!0)}}},175661:(t,K,D)=>{D.d(K,{P:()=>Z});var a=D(505777),G=D(992178),N=D(408078),W=D(206348),x=D(567182),b=D(722006),n=D(874708),e=D(168786),i=D(729768);const z=[".jpeg",".jpg",".png",".webp",".avif"],I=["image/jpeg","image/png","image/webp","image/avif"],Z={name:"loadTextures",extension:{type:G.Ag.LoadParser,priority:e.T.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:t=>x.s(t,I)||b.W(t,z),async load(t,K,D){var G;let x=null;x=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await n.O.isImageBitmapSupported()?await n.O.loadImageBitmap(t,K):await async function(t,K){var D;const G=await a.e.get().fetch(t);if(!G.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${G.status} ${G.statusText}`);const N=await G.blob();return"premultiplied-alpha"===(null===(D=null==K?void 0:K.data)||void 0===D?void 0:D.alphaMode)?createImageBitmap(N,{premultiplyAlpha:"none"}):createImageBitmap(N)}(t,K):await new Promise((K=>{x=new Image,x.crossOrigin=this.config.crossOrigin,x.src=t,x.complete?K(x):x.onload=()=>{K(x)}}));const b=new N.b({resource:x,alphaMode:"premultiply-alpha-on-upload",resolution:(null===(G=K.data)||void 0===G?void 0:G.resolution)||W.v(t),...K.data});return i.s(b,D,t)},unload(t){t.destroy(!0)}}},428230:(t,K,D)=>{D.d(K,{Qj:()=>z});var a=D(992178),G=D(902124),N=D(997089),W=D(206348),x=D(567182),b=D(722006),n=D(729768);const e=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],i=e.map((t=>`video/${t.substring(1)}`));const z={name:"loadVideo",extension:{type:a.Ag.LoadParser,name:"loadVideo"},test(t){const K=x.s(t,i),D=b.W(t,e);return K||D},async load(t,K,D){var a,x;const b={...G.$.defaultOptions,resolution:(null===(a=K.data)||void 0===a?void 0:a.resolution)||W.v(t),alphaMode:(null===(x=K.data)||void 0===x?void 0:x.alphaMode)||await N.C(),...K.data},e=document.createElement("video"),i={preload:!1!==b.autoLoad?"auto":void 0,"webkit-playsinline":!1!==b.playsinline?"":void 0,playsinline:!1!==b.playsinline?"":void 0,muted:!0===b.muted?"":void 0,loop:!0===b.loop?"":void 0,autoplay:!1!==b.autoPlay?"":void 0};Object.keys(i).forEach((t=>{const K=i[t];void 0!==K&&e.setAttribute(t,K)})),!0===b.muted&&(e.muted=!0),function(t,K,D){void 0!==D||K.startsWith("data:")?!1!==D&&(t.crossOrigin="string"==typeof D?D:"anonymous"):t.crossOrigin=function(t,K=globalThis.location){if(t.startsWith("data:"))return"";K=K||globalThis.location;const D=new URL(t,document.baseURI);return D.hostname!==K.hostname||D.port!==K.port||D.protocol!==K.protocol?"anonymous":""}(K)}(e,t,b.crossorigin);const z=document.createElement("source");let I;if(t.startsWith("data:"))I=t.slice(5,t.indexOf(";"));else if(!t.startsWith("blob:")){const K=t.split("?")[0].slice(t.lastIndexOf(".")+1).toLowerCase();I=G.$.MIME_TYPES[K]||`video/${K}`}return z.src=t,I&&(z.type=I),new Promise((a=>{const N=async()=>{const W=new G.$({...b,resource:e});var x;e.removeEventListener("canplay",N),K.data.preload&&await(x=e,new Promise(((t,K)=>{function D(){G(),t()}function a(t){G(),K(t)}function G(){x.removeEventListener("canplaythrough",D),x.removeEventListener("error",a)}x.addEventListener("canplaythrough",D),x.addEventListener("error",a),x.load()}))),a(n.s(W,D,t))};e.addEventListener("canplay",N),e.appendChild(z)}))},unload(t){t.destroy(!0)}}},729768:(t,K,D)=>{D.d(K,{s:()=>W});var a=D(177487),G=D(229995),N=D(363020);function W(t,K,D){t.label=D,t._sourceOrigin=D;const W=new a.g({source:t,label:D}),x=()=>{delete K.promiseCache[D],N.l.has(D)&&N.l.remove(D)};return W.source.once("destroy",(()=>{K.promiseCache[D]&&(G.R("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),x())})),W.once("destroy",(()=>{t.destroyed||(G.R("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),x())})),W}},874708:(t,K,D)=>{D.d(K,{O:()=>x});var a=D(164596),G=D(981656);let N,W=0;const x=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise((t=>{const{worker:K}=new a.A;K.addEventListener("message",(D=>{K.terminate(),a.A.revokeObjectURL(),t(D.data)}))}))),this._isImageBitmapSupported}loadImageBitmap(t,K){var D;return this._run("loadImageBitmap",[t,null===(D=null==K?void 0:K.data)||void 0===D?void 0:D.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){void 0===N&&(N=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<N&&(this._createdWorkers++,t=(new G.A).worker,t.addEventListener("message",(t=>{this._complete(t.data),this._returnWorker(t.target),this._next()}))),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){void 0!==t.error?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),this._resolveHash[t.uuid]=null}async _run(t,K){await this._initWorkers();const D=new Promise(((D,a)=>{this._queue.push({id:t,arguments:K,resolve:D,reject:a})}));return this._next(),D}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const K=this._queue.pop(),D=K.id;this._resolveHash[W]={resolve:K.resolve,reject:K.reject},t.postMessage({data:K.arguments,uuid:W++,id:D})}}},282637:(t,K,D)=>{D.d(K,{x:()=>n});var a=D(229995),G=D(58496),N=D(309313);function W(t,K,D,a,G){const N=K[D];for(let x=0;x<N.length;x++){const b=N[x];D<K.length-1?W(t.replace(a[D],b),K,D+1,a,G):G.push(t.replace(a[D],b))}}function x(t){const K=t.match(/\{(.*?)\}/g),D=[];if(K){const a=[];K.forEach((t=>{const K=t.substring(1,t.length-1).split(",");a.push(K)})),W(t,a,0,K,D)}else D.push(t);return D}var b=D(509384);class n{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,K)=>`${t}${this._bundleIdConnector}${K}`,extractAssetIdFromBundle:(t,K)=>K.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){var K,D,a;if(this._bundleIdConnector=null!==(K=t.connector)&&void 0!==K?K:this._bundleIdConnector,this._createBundleAssetId=null!==(D=t.createBundleAssetId)&&void 0!==D?D:this._createBundleAssetId,this._extractAssetIdFromBundle=null!==(a=t.extractAssetIdFromBundle)&&void 0!==a?a:this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach((t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))})),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if("string"==typeof t)this._defaultSearchParams=t;else{const K=t;this._defaultSearchParams=Object.keys(K).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(K[t])}`)).join("&")}}getAlias(t){const{alias:K,src:D}=t;return N.z(K||D,(t=>"string"==typeof t?t:Array.isArray(t)?t.map((t=>{var K;return null!==(K=null==t?void 0:t.src)&&void 0!==K?K:t})):(null==t?void 0:t.src)?t.src:t),!0)}addManifest(t){this._manifest&&a.R("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach((t=>{this.addBundle(t.name,t.assets)}))}addBundle(t,K){const D=[];let a=K;Array.isArray(K)||(a=Object.entries(K).map((([t,K])=>"string"==typeof K||Array.isArray(K)?{alias:t,src:K}:{alias:t,...K}))),a.forEach((K=>{const a=K.src,G=K.alias;let N;if("string"==typeof G){const K=this._createBundleAssetId(t,G);D.push(K),N=[G,K]}else{const K=G.map((K=>this._createBundleAssetId(t,K)));D.push(...K),N=[...G,...K]}this.add({...K,alias:N,src:a})})),this._bundles[t]=D}add(t){const K=[];let D;Array.isArray(t)?K.push(...t):K.push(t),D=t=>{this.hasKey(t)&&a.R(`[Resolver] already has key: ${t} overwriting`)},N.z(K).forEach((t=>{const{src:K}=t;let{data:a,format:G,loadParser:W}=t;const b=N.z(K).map((t=>"string"==typeof t?x(t):Array.isArray(t)?t:[t])),n=this.getAlias(t);Array.isArray(n)?n.forEach(D):D(n);const e=[];b.forEach((t=>{t.forEach((t=>{var K,D,N;let x={};if("object"!=typeof t){x.src=t;for(let K=0;K<this._parsers.length;K++){const D=this._parsers[K];if(D.test(t)){x=D.parse(t);break}}}else a=null!==(K=t.data)&&void 0!==K?K:a,G=null!==(D=t.format)&&void 0!==D?D:G,W=null!==(N=t.loadParser)&&void 0!==N?N:W,x={...x,...t};if(!n)throw new Error(`[Resolver] alias is undefined for this asset: ${x.src}`);x=this._buildResolvedAsset(x,{aliases:n,data:a,format:G,loadParser:W}),e.push(x)}))})),n.forEach((t=>{this._assetMap[t]=e}))}))}resolveBundle(t){const K=b.a(t);t=N.z(t);const D={};return t.forEach((t=>{const K=this._bundles[t];if(K){const a=this.resolve(K),G={};for(const K in a){const D=a[K];G[this._extractAssetIdFromBundle(t,K)]=D}D[t]=G}})),K?D[t[0]]:D}resolveUrl(t){const K=this.resolve(t);if("string"!=typeof t){const t={};for(const D in K)t[D]=K[D].src;return t}return K.src}resolve(t){const K=b.a(t);t=N.z(t);const D={};return t.forEach((t=>{if(!this._resolverHash[t])if(this._assetMap[t]){let K=this._assetMap[t];const D=this._getPreferredOrder(K);null==D||D.priority.forEach((t=>{D.params[t].forEach((D=>{const a=K.filter((K=>!!K[t]&&K[t]===D));a.length&&(K=a)}))})),this._resolverHash[t]=K[0]}else this._resolverHash[t]=this._buildResolvedAsset({alias:[t],src:t},{});D[t]=this._resolverHash[t]})),K?D[t[0]]:D}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let K=0;K<t.length;K++){const K=t[0],D=this._preferredOrder.find((t=>t.params.format.includes(K.format)));if(D)return D}return this._preferredOrder[0]}_appendDefaultSearchParams(t){return this._defaultSearchParams?`${t}${/\?/.test(t)?"&":"?"}${this._defaultSearchParams}`:t}_buildResolvedAsset(t,K){var D,a;const{aliases:N,data:W,loadParser:x,format:b}=K;return(this._basePath||this._rootPath)&&(t.src=G.A.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=null!==(D=null!=N?N:t.alias)&&void 0!==D?D:[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...W||{},...t.data},t.loadParser=null!=x?x:t.loadParser,t.format=null!==(a=null!=b?b:t.format)&&void 0!==a?a:t.src.split(".").pop().split("?").shift().split("#").shift(),t}}n.RETINA_PREFIX=/@([0-9\.]+)x/},149814:(t,K,D)=>{D.d(K,{u:()=>W});var a=D(992178),G=D(282637),N=D(358149);const W={extension:{type:a.Ag.ResolveParser,priority:-2,name:"resolveJson"},test:t=>G.x.RETINA_PREFIX.test(t)&&t.endsWith(".json"),parse:N.j.parse}},358149:(t,K,D)=>{D.d(K,{j:()=>W});var a=D(992178),G=D(175661),N=D(282637);const W={extension:{type:a.Ag.ResolveParser,name:"resolveTexture"},test:G.P.test,parse:t=>{var K,D;return{resolution:parseFloat(null!==(D=null===(K=N.x.RETINA_PREFIX.exec(t))||void 0===K?void 0:K[1])&&void 0!==D?D:"1"),format:t.split(".").pop(),src:t}}}},567182:(t,K,D)=>{function a(t,K){if(Array.isArray(K)){for(const D of K)if(t.startsWith(`data:${D}`))return!0;return!1}return t.startsWith(`data:${K}`)}D.d(K,{s:()=>a})},722006:(t,K,D)=>{D.d(K,{W:()=>G});var a=D(58496);function G(t,K){const D=t.split("?")[0],G=a.A.extname(D).toLowerCase();return Array.isArray(K)?K.includes(G):G===K}},309313:(t,K,D)=>{D.d(K,{z:()=>a});const a=(t,K,D=!1)=>(Array.isArray(t)||(t=[t]),K?t.map((t=>"string"==typeof t||D?K(t):t)):t)},714252:(t,K,D)=>{D.d(K,{Y:()=>a});const a=(t,K)=>{const D=K.split("?")[1];return D&&(t+=`?${D}`),t}},509384:(t,K,D)=>{D.d(K,{a:()=>a});const a=t=>!Array.isArray(t)},534661:(t,K,D)=>{D.d(K,{Q:()=>H});var a={grad:.9,turn:360,rad:360/(2*Math.PI)},G=function(t){return"string"==typeof t?t.length>0:"number"==typeof t},N=function(t,K,D){return void 0===K&&(K=0),void 0===D&&(D=Math.pow(10,K)),Math.round(D*t)/D+0},W=function(t,K,D){return void 0===K&&(K=0),void 0===D&&(D=1),t>D?D:t>K?t:K},x=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},b=function(t){return{r:W(t.r,0,255),g:W(t.g,0,255),b:W(t.b,0,255),a:W(t.a)}},n=function(t){return{r:N(t.r),g:N(t.g),b:N(t.b),a:N(t.a,3)}},e=/^#([0-9a-f]{3,8})$/i,i=function(t){var K=t.toString(16);return K.length<2?"0"+K:K},z=function(t){var K=t.r,D=t.g,a=t.b,G=t.a,N=Math.max(K,D,a),W=N-Math.min(K,D,a),x=W?N===K?(D-a)/W:N===D?2+(a-K)/W:4+(K-D)/W:0;return{h:60*(x<0?x+6:x),s:N?W/N*100:0,v:N/255*100,a:G}},I=function(t){var K=t.h,D=t.s,a=t.v,G=t.a;K=K/360*6,D/=100,a/=100;var N=Math.floor(K),W=a*(1-D),x=a*(1-(K-N)*D),b=a*(1-(1-K+N)*D),n=N%6;return{r:255*[a,x,W,W,b,a][n],g:255*[b,a,a,x,W,W][n],b:255*[W,W,b,a,a,x][n],a:G}},Z=function(t){return{h:x(t.h),s:W(t.s,0,100),l:W(t.l,0,100),a:W(t.a)}},w=function(t){return{h:N(t.h),s:N(t.s),l:N(t.l),a:N(t.a,3)}},m=function(t){return I((D=(K=t).s,{h:K.h,s:(D*=((a=K.l)<50?a:100-a)/100)>0?2*D/(a+D)*100:0,v:a+D,a:K.a}));var K,D,a},u=function(t){return{h:(K=z(t)).h,s:(G=(200-(D=K.s))*(a=K.v)/100)>0&&G<200?D*a/100/(G<=100?G:200-G)*100:0,l:G/2,a:K.a};var K,D,a,G},d=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,E=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,l=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Q=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,P={string:[[function(t){var K=e.exec(t);return K?(t=K[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:4===t.length?N(parseInt(t[3]+t[3],16)/255,2):1}:6===t.length||8===t.length?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:8===t.length?N(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var K=l.exec(t)||Q.exec(t);return K?K[2]!==K[4]||K[4]!==K[6]?null:b({r:Number(K[1])/(K[2]?100/255:1),g:Number(K[3])/(K[4]?100/255:1),b:Number(K[5])/(K[6]?100/255:1),a:void 0===K[7]?1:Number(K[7])/(K[8]?100:1)}):null},"rgb"],[function(t){var K=d.exec(t)||E.exec(t);if(!K)return null;var D,G,N=Z({h:(D=K[1],G=K[2],void 0===G&&(G="deg"),Number(D)*(a[G]||1)),s:Number(K[3]),l:Number(K[4]),a:void 0===K[5]?1:Number(K[5])/(K[6]?100:1)});return m(N)},"hsl"]],object:[[function(t){var K=t.r,D=t.g,a=t.b,N=t.a,W=void 0===N?1:N;return G(K)&&G(D)&&G(a)?b({r:Number(K),g:Number(D),b:Number(a),a:Number(W)}):null},"rgb"],[function(t){var K=t.h,D=t.s,a=t.l,N=t.a,W=void 0===N?1:N;if(!G(K)||!G(D)||!G(a))return null;var x=Z({h:Number(K),s:Number(D),l:Number(a),a:Number(W)});return m(x)},"hsl"],[function(t){var K=t.h,D=t.s,a=t.v,N=t.a,b=void 0===N?1:N;if(!G(K)||!G(D)||!G(a))return null;var n=function(t){return{h:x(t.h),s:W(t.s,0,100),v:W(t.v,0,100),a:W(t.a)}}({h:Number(K),s:Number(D),v:Number(a),a:Number(b)});return I(n)},"hsv"]]},y=function(t,K){for(var D=0;D<K.length;D++){var a=K[D][0](t);if(a)return[a,K[D][1]]}return[null,void 0]},q=function(t,K){var D=u(t);return{h:D.h,s:W(D.s+100*K,0,100),l:D.l,a:D.a}},X=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},h=function(t,K){var D=u(t);return{h:D.h,s:D.s,l:W(D.l+100*K,0,100),a:D.a}},J=function(){function t(t){this.parsed=function(t){return"string"==typeof t?y(t.trim(),P.string):"object"==typeof t&&null!==t?y(t,P.object):[null,void 0]}(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return null!==this.parsed},t.prototype.brightness=function(){return N(X(this.rgba),2)},t.prototype.isDark=function(){return X(this.rgba)<.5},t.prototype.isLight=function(){return X(this.rgba)>=.5},t.prototype.toHex=function(){return K=(t=n(this.rgba)).r,D=t.g,a=t.b,W=(G=t.a)<1?i(N(255*G)):"","#"+i(K)+i(D)+i(a)+W;var t,K,D,a,G,W},t.prototype.toRgb=function(){return n(this.rgba)},t.prototype.toRgbString=function(){return K=(t=n(this.rgba)).r,D=t.g,a=t.b,(G=t.a)<1?"rgba("+K+", "+D+", "+a+", "+G+")":"rgb("+K+", "+D+", "+a+")";var t,K,D,a,G},t.prototype.toHsl=function(){return w(u(this.rgba))},t.prototype.toHslString=function(){return K=(t=w(u(this.rgba))).h,D=t.s,a=t.l,(G=t.a)<1?"hsla("+K+", "+D+"%, "+a+"%, "+G+")":"hsl("+K+", "+D+"%, "+a+"%)";var t,K,D,a,G},t.prototype.toHsv=function(){return t=z(this.rgba),{h:N(t.h),s:N(t.s),v:N(t.v),a:N(t.a,3)};var t},t.prototype.invert=function(){return T({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},t.prototype.saturate=function(t){return void 0===t&&(t=.1),T(q(this.rgba,t))},t.prototype.desaturate=function(t){return void 0===t&&(t=.1),T(q(this.rgba,-t))},t.prototype.grayscale=function(){return T(q(this.rgba,-1))},t.prototype.lighten=function(t){return void 0===t&&(t=.1),T(h(this.rgba,t))},t.prototype.darken=function(t){return void 0===t&&(t=.1),T(h(this.rgba,-t))},t.prototype.rotate=function(t){return void 0===t&&(t=15),this.hue(this.hue()+t)},t.prototype.alpha=function(t){return"number"==typeof t?T({r:(K=this.rgba).r,g:K.g,b:K.b,a:t}):N(this.rgba.a,3);var K},t.prototype.hue=function(t){var K=u(this.rgba);return"number"==typeof t?T({h:t,s:K.s,l:K.l,a:K.a}):N(K.h)},t.prototype.isEqual=function(t){return this.toHex()===T(t).toHex()},t}(),T=function(t){return t instanceof J?t:new J(t)},_=[];(function(t){t.forEach((function(t){_.indexOf(t)<0&&(t(J,P),_.push(t))}))})([function(t,K){var D={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},a={};for(var G in D)a[D[G]]=G;var N={};t.prototype.toName=function(K){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var G,W,x=a[this.toHex()];if(x)return x;if(null==K?void 0:K.closest){var b=this.toRgb(),n=1/0,e="black";if(!N.length)for(var i in D)N[i]=new t(D[i]).toRgb();for(var z in D){var I=(G=b,W=N[z],Math.pow(G.r-W.r,2)+Math.pow(G.g-W.g,2)+Math.pow(G.b-W.b,2));I<n&&(n=I,e=z)}return e}},K.string.push([function(K){var a=K.toLowerCase(),G="transparent"===a?"#0000":D[a];return G?new t(G).toRgb():null},"name"])}]);const C=class t{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(K){if(K instanceof t)this._value=this._cloneSource(K._value),this._int=K._int,this._components.set(K._components);else{if(null===K)throw new Error("Cannot set Color#value to null");null!==this._value&&this._isSourceEqual(this._value,K)||(this._value=this._cloneSource(K),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return"string"==typeof t||"number"==typeof t||t instanceof Number||null===t?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):"object"==typeof t&&null!==t?{...t}:t}_isSourceEqual(t,K){const D=typeof t;if(D!==typeof K)return!1;if("number"===D||"string"===D||t instanceof Number)return t===K;if(Array.isArray(t)&&Array.isArray(K)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(K))return t.length===K.length&&t.every(((t,D)=>t===K[D]));if(null!==t&&null!==K){const D=Object.keys(t),a=Object.keys(K);return D.length===a.length&&D.every((D=>t[D]===K[D]))}return t===K}toRgba(){const[t,K,D,a]=this._components;return{r:t,g:K,b:D,a}}toRgb(){const[t,K,D]=this._components;return{r:t,g:K,b:D}}toRgbaString(){const[t,K,D]=this.toUint8RgbArray();return`rgba(${t},${K},${D},${this.alpha})`}toUint8RgbArray(t){const[K,D,a]=this._components;return this._arrayRgb||(this._arrayRgb=[]),(t=t||this._arrayRgb)[0]=Math.round(255*K),t[1]=Math.round(255*D),t[2]=Math.round(255*a),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t=t||this._arrayRgba;const[K,D,a,G]=this._components;return t[0]=K,t[1]=D,t[2]=a,t[3]=G,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t=t||this._arrayRgb;const[K,D,a]=this._components;return t[0]=K,t[1]=D,t[2]=a,t}toNumber(){return this._int}toBgrNumber(){const[t,K,D]=this.toUint8RgbArray();return(D<<16)+(K<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(65280&t)+((255&t)<<16)}multiply(K){const[D,a,G,N]=t._temp.setValue(K)._components;return this._components[0]*=D,this._components[1]*=a,this._components[2]*=G,this._components[3]*=N,this._refreshInt(),this._value=null,this}premultiply(t,K=!0){return K&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,K=!0){if(1===t)return(255<<24)+this._int;if(0===t)return K?0:this._int;let D=this._int>>16&255,a=this._int>>8&255,G=255&this._int;return K&&(D=D*t+.5|0,a=a*t+.5|0,G=G*t+.5|0),(255*t<<24)+(D<<16)+(a<<8)+G}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(K){let D,a,G,N;if(("number"==typeof K||K instanceof Number)&&K>=0&&K<=16777215)D=(K>>16&255)/255,a=(K>>8&255)/255,G=(255&K)/255,N=1;else if((Array.isArray(K)||K instanceof Float32Array)&&K.length>=3&&K.length<=4)K=this._clamp(K),[D,a,G,N=1]=K;else if((K instanceof Uint8Array||K instanceof Uint8ClampedArray)&&K.length>=3&&K.length<=4)K=this._clamp(K,0,255),[D,a,G,N=255]=K,D/=255,a/=255,G/=255,N/=255;else if("string"==typeof K||"object"==typeof K){if("string"==typeof K){const D=t.HEX_PATTERN.exec(K);D&&(K=`#${D[2]}`)}const W=T(K);W.isValid()&&(({r:D,g:a,b:G,a:N}=W.rgba),D/=255,a/=255,G/=255)}if(void 0===D)throw new Error(`Unable to convert color ${K}`);this._components[0]=D,this._components[1]=a,this._components[2]=G,this._components[3]=N,this._refreshInt()}_refreshInt(){this._clamp(this._components);const[t,K,D]=this._components;this._int=(255*t<<16)+(255*K<<8)+(255*D|0)}_clamp(t,K=0,D=1){return"number"==typeof t?Math.min(Math.max(t,K),D):(t.forEach(((a,G)=>{t[G]=Math.min(Math.max(a,K),D)})),t)}static isColorLike(K){return"number"==typeof K||"string"==typeof K||K instanceof Number||K instanceof t||Array.isArray(K)||K instanceof Uint8Array||K instanceof Uint8ClampedArray||K instanceof Float32Array||void 0!==K.r&&void 0!==K.g&&void 0!==K.b||void 0!==K.r&&void 0!==K.g&&void 0!==K.b&&void 0!==K.a||void 0!==K.h&&void 0!==K.s&&void 0!==K.l||void 0!==K.h&&void 0!==K.s&&void 0!==K.l&&void 0!==K.a||void 0!==K.h&&void 0!==K.s&&void 0!==K.v||void 0!==K.h&&void 0!==K.s&&void 0!==K.v&&void 0!==K.a}};C.shared=new C,C._temp=new C,C.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let H=C},963153:(t,K,D)=>{D.d(K,{I:()=>a});const a={extension:{type:D(992178).Ag.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await D.e(86341).then(D.bind(D,986341))}}},456685:(t,K,D)=>{D.d(K,{S:()=>a});const a={extension:{type:D(992178).Ag.Environment,name:"webworker",priority:0},test:()=>"undefined"!=typeof self&&void 0!==self.WorkerGlobalScope,load:async()=>{await D.e(23197).then(D.bind(D,223197))}}},505777:(t,K,D)=>{D.d(K,{e:()=>G});let a={createCanvas:(t,K)=>{const D=document.createElement("canvas");return D.width=t,D.height=K,D},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>{var t;return null!==(t=document.baseURI)&&void 0!==t?t:window.location.href},getFontFaceSet:()=>document.fonts,fetch:(t,K)=>fetch(t,K),parseXML:t=>(new DOMParser).parseFromString(t,"text/xml")};const G={get:()=>a,set(t){a=t}}},992178:(t,K,D)=>{D.d(K,{Ag:()=>a,XO:()=>W});var a=(t=>(t["Application"]="application",t["WebGLPipes"]="webgl-pipes",t["WebGLPipesAdaptor"]="webgl-pipes-adaptor",t["WebGLSystem"]="webgl-system",t["WebGPUPipes"]="webgpu-pipes",t["WebGPUPipesAdaptor"]="webgpu-pipes-adaptor",t["WebGPUSystem"]="webgpu-system",t["CanvasSystem"]="canvas-system",t["CanvasPipesAdaptor"]="canvas-pipes-adaptor",t["CanvasPipes"]="canvas-pipes",t["Asset"]="asset",t["LoadParser"]="load-parser",t["ResolveParser"]="resolve-parser",t["CacheParser"]="cache-parser",t["DetectionParser"]="detection-parser",t["MaskEffect"]="mask-effect",t["BlendMode"]="blend-mode",t["TextureSource"]="texture-source",t["Environment"]="environment",t["ShapeBuilder"]="shape-builder",t["Batcher"]="batcher",t))(a||{});const G=t=>{if("function"==typeof t||"object"==typeof t&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={..."object"!=typeof t.extension?{type:t.extension}:t.extension,ref:t}}if("object"!=typeof t)throw new Error("Invalid extension type");return"string"==typeof(t={...t}).type&&(t.type=[t.type]),t},N=(t,K)=>{var D;return null!==(D=G(t).priority)&&void 0!==D?D:K},W={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(G).forEach((t=>{t.type.forEach((K=>{var D,a;return null===(a=(D=this._removeHandlers)[K])||void 0===a?void 0:a.call(D,t)}))})),this},add(...t){return t.map(G).forEach((t=>{t.type.forEach((K=>{var D,a;const G=this._addHandlers,N=this._queue;G[K]?null===(a=G[K])||void 0===a||a.call(G,t):(N[K]=N[K]||[],null===(D=N[K])||void 0===D||D.push(t))}))})),this},handle(t,K,D){var a;const G=this._addHandlers,N=this._removeHandlers;if(G[t]||N[t])throw new Error(`Extension type ${t} already has a handler`);G[t]=K,N[t]=D;const W=this._queue;return W[t]&&(null===(a=W[t])||void 0===a||a.forEach((t=>K(t))),delete W[t]),this},handleByMap(t,K){return this.handle(t,(t=>{t.name&&(K[t.name]=t.ref)}),(t=>{t.name&&delete K[t.name]}))},handleByNamedList(t,K,D=-1){return this.handle(t,(t=>{K.findIndex((K=>K.name===t.name))>=0||(K.push({name:t.name,value:t.ref}),K.sort(((t,K)=>N(K.value,D)-N(t.value,D))))}),(t=>{const D=K.findIndex((K=>K.name===t.name));-1!==D&&K.splice(D,1)}))},handleByList(t,K,D=-1){return this.handle(t,(t=>{K.includes(t.ref)||(K.push(t.ref),K.sort(((t,K)=>N(K,D)-N(t,D))))}),(t=>{const D=K.indexOf(t.ref);-1!==D&&K.splice(D,1)}))}}},472157:(t,K,D)=>{D.d(K,{d:()=>b});var a=D(523700),G=D(562920),N=D(92840),W=D(904020);const x=class t extends N.M{constructor(K){super(K={...t.defaultOptions,...K}),this.enabled=!0,this._state=W.U.for2d(),this.blendMode=K.blendMode,this.padding=K.padding,"boolean"==typeof K.antialias?this.antialias=K.antialias?"on":"off":this.antialias=K.antialias,this.resolution=K.resolution,this.blendRequired=K.blendRequired,this.clipToViewport=K.clipToViewport,this.addResource("uTexture",0,1)}apply(t,K,D,a){t.applyFilter(this,K,D,a)}get blendMode(){return this._state.blendMode}set blendMode(t){this._state.blendMode=t}static from(K){const{gpu:D,gl:N,...W}=K;let x,b;return D&&(x=G.B.from(D)),N&&(b=a.M.from(N)),new t({gpuProgram:x,glProgram:b,...W})}};x.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let b=x},323470:(t,K,D)=>{D.d(K,{a:()=>a});class a{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}},238733:(t,K,D)=>{D.d(K,{A1g:()=>w.A,Dl5:()=>m.D,M2g:()=>z.M,Ppp:()=>b.P,QL7:()=>u.Q,T7$:()=>E.T,_2:()=>Z._,bRX:()=>i.b,dJT:()=>n.d,kxk:()=>d.k,lgM:()=>W.l,mcf:()=>I.mc,oA$:()=>e.o,sP:()=>x.s,zo6:()=>l.z});var a=D(963153),G=D(456685),N=D(992178),W=(D(799857),D(208929),D(176959)),x=D(192828),b=D(175661),n=D(472157),e=D(553417),i=D(521212),z=D(523700),I=(D(744710),D(748459)),Z=D(387473),w=D(283863),m=D(247470),u=D(954949),d=D(20401),E=D(473526),l=D(336384);D(610162),D(114712),N.XO.add(a.I,G.S)},823040:(t,K,D)=>{D.d(K,{u:()=>N});var a=D(100403),G=D(521212);class N{constructor(t=1,K=0,D=0,a=1,G=0,N=0){this.array=null,this.a=t,this.b=K,this.c=D,this.d=a,this.tx=G,this.ty=N}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,K,D,a,G,N){return this.a=t,this.b=K,this.c=D,this.d=a,this.tx=G,this.ty=N,this}toArray(t,K){this.array||(this.array=new Float32Array(9));const D=K||this.array;return t?(D[0]=this.a,D[1]=this.b,D[2]=0,D[3]=this.c,D[4]=this.d,D[5]=0,D[6]=this.tx,D[7]=this.ty,D[8]=1):(D[0]=this.a,D[1]=this.c,D[2]=this.tx,D[3]=this.b,D[4]=this.d,D[5]=this.ty,D[6]=0,D[7]=0,D[8]=1),D}apply(t,K){K=K||new G.b;const D=t.x,a=t.y;return K.x=this.a*D+this.c*a+this.tx,K.y=this.b*D+this.d*a+this.ty,K}applyInverse(t,K){K=K||new G.b;const D=this.a,a=this.b,N=this.c,W=this.d,x=this.tx,b=this.ty,n=1/(D*W+N*-a),e=t.x,i=t.y;return K.x=W*n*e+-N*n*i+(b*N-x*W)*n,K.y=D*n*i+-a*n*e+(-b*D+x*a)*n,K}translate(t,K){return this.tx+=t,this.ty+=K,this}scale(t,K){return this.a*=t,this.d*=K,this.c*=t,this.b*=K,this.tx*=t,this.ty*=K,this}rotate(t){const K=Math.cos(t),D=Math.sin(t),a=this.a,G=this.c,N=this.tx;return this.a=a*K-this.b*D,this.b=a*D+this.b*K,this.c=G*K-this.d*D,this.d=G*D+this.d*K,this.tx=N*K-this.ty*D,this.ty=N*D+this.ty*K,this}append(t){const K=this.a,D=this.b,a=this.c,G=this.d;return this.a=t.a*K+t.b*a,this.b=t.a*D+t.b*G,this.c=t.c*K+t.d*a,this.d=t.c*D+t.d*G,this.tx=t.tx*K+t.ty*a+this.tx,this.ty=t.tx*D+t.ty*G+this.ty,this}appendFrom(t,K){const D=t.a,a=t.b,G=t.c,N=t.d,W=t.tx,x=t.ty,b=K.a,n=K.b,e=K.c,i=K.d;return this.a=D*b+a*e,this.b=D*n+a*i,this.c=G*b+N*e,this.d=G*n+N*i,this.tx=W*b+x*e+K.tx,this.ty=W*n+x*i+K.ty,this}setTransform(t,K,D,a,G,N,W,x,b){return this.a=Math.cos(W+b)*G,this.b=Math.sin(W+b)*G,this.c=-Math.sin(W-x)*N,this.d=Math.cos(W-x)*N,this.tx=t-(D*this.a+a*this.c),this.ty=K-(D*this.b+a*this.d),this}prepend(t){const K=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){const K=this.a,D=this.c;this.a=K*t.a+this.b*t.c,this.b=K*t.b+this.b*t.d,this.c=D*t.a+this.d*t.c,this.d=D*t.b+this.d*t.d}return this.tx=K*t.a+this.ty*t.c+t.tx,this.ty=K*t.b+this.ty*t.d+t.ty,this}decompose(t){const K=this.a,D=this.b,G=this.c,N=this.d,W=t.pivot,x=-Math.atan2(-G,N),b=Math.atan2(D,K),n=Math.abs(x+b);return n<1e-5||Math.abs(a.TO-n)<1e-5?(t.rotation=b,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=x,t.skew.y=b),t.scale.x=Math.sqrt(K*K+D*D),t.scale.y=Math.sqrt(G*G+N*N),t.position.x=this.tx+(W.x*K+W.y*G),t.position.y=this.ty+(W.x*D+W.y*N),t}invert(){const t=this.a,K=this.b,D=this.c,a=this.d,G=this.tx,N=t*a-K*D;return this.a=a/N,this.b=-K/N,this.c=-D/N,this.d=t/N,this.tx=(D*this.ty-a*G)/N,this.ty=-(t*this.ty-K*G)/N,this}isIdentity(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.tx&&0===this.ty}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new N;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return x.identity()}static get shared(){return W.identity()}}const W=new N,x=new N},100403:(t,K,D)=>{D.d(K,{TO:()=>a,Td:()=>N,bO:()=>G});const a=2*Math.PI,G=180/Math.PI,N=Math.PI/180},444230:(t,K,D)=>{function a(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function G(t){return!(t&t-1||!t)}D.d(K,{U5:()=>a,f3:()=>G})},553417:(t,K,D)=>{D.d(K,{o:()=>a});class a{constructor(t,K,D){this._x=K||0,this._y=D||0,this._observer=t}clone(t){return new a(null!=t?t:this._observer,this._x,this._y)}set(t=0,K=t){return this._x===t&&this._y===K||(this._x=t,this._y=K,this._observer._onUpdate(this)),this}copyFrom(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${0} y=${0} scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}},521212:(t,K,D)=>{D.d(K,{b:()=>a});class a{constructor(t=0,K=0){this.x=0,this.y=0,this.x=t,this.y=K}clone(){return new a(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,K=t){return this.x=t,this.y=K,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return G.x=0,G.y=0,G}}const G=new a},377223:(t,K,D)=>{D.d(K,{M:()=>N});var a=D(521212);const G=[new a.b,new a.b,new a.b,new a.b];class N{constructor(t=0,K=0,D=0,a=0){this.type="rectangle",this.x=Number(t),this.y=Number(K),this.width=Number(D),this.height=Number(a)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new N(0,0,0,0)}clone(){return new N(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,K){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&K>=this.y&&K<this.y+this.height}strokeContains(t,K,D){const{width:a,height:G}=this;if(a<=0||G<=0)return!1;const N=this.x,W=this.y;return t>=N-D/2&&t<=N+a+D/2&&K>=W-D/2&&K<=W+G+D/2&&!(t>N+D/2&&t<N+a-D/2&&K>W+D/2&&K<W+G-D/2)}intersects(t,K){if(!K){const K=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=K)return!1;const D=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>D}const D=this.left,a=this.right,N=this.top,W=this.bottom;if(a<=D||W<=N)return!1;const x=G[0].set(t.left,t.top),b=G[1].set(t.left,t.bottom),n=G[2].set(t.right,t.top),e=G[3].set(t.right,t.bottom);if(n.x<=x.x||b.y<=x.y)return!1;const i=Math.sign(K.a*K.d-K.b*K.c);if(0===i)return!1;if(K.apply(x,x),K.apply(b,b),K.apply(n,n),K.apply(e,e),Math.max(x.x,b.x,n.x,e.x)<=D||Math.min(x.x,b.x,n.x,e.x)>=a||Math.max(x.y,b.y,n.y,e.y)<=N||Math.min(x.y,b.y,n.y,e.y)>=W)return!1;const z=i*(b.y-x.y),I=i*(x.x-b.x),Z=z*D+I*N,w=z*a+I*N,m=z*D+I*W,u=z*a+I*W;if(Math.max(Z,w,m,u)<=z*x.x+I*x.y||Math.min(Z,w,m,u)>=z*e.x+I*e.y)return!1;const d=i*(x.y-n.y),E=i*(n.x-x.x),l=d*D+E*N,Q=d*a+E*N,P=d*D+E*W,y=d*a+E*W;return!(Math.max(l,Q,P,y)<=d*x.x+E*x.y||Math.min(l,Q,P,y)>=d*e.x+E*e.y)}pad(t=0,K=t){return this.x-=t,this.y-=K,this.width+=2*t,this.height+=2*K,this}fit(t){const K=Math.max(this.x,t.x),D=Math.min(this.x+this.width,t.x+t.width),a=Math.max(this.y,t.y),G=Math.min(this.y+this.height,t.y+t.height);return this.x=K,this.width=Math.max(D-K,0),this.y=a,this.height=Math.max(G-a,0),this}ceil(t=1,K=.001){const D=Math.ceil((this.x+this.width-K)*t)/t,a=Math.ceil((this.y+this.height-K)*t)/t;return this.x=Math.floor((this.x+K)*t)/t,this.y=Math.floor((this.y+K)*t)/t,this.width=D-this.x,this.height=a-this.y,this}enlarge(t){const K=Math.min(this.x,t.x),D=Math.max(this.x+this.width,t.x+t.width),a=Math.min(this.y,t.y),G=Math.max(this.y+this.height,t.y+t.height);return this.x=K,this.width=D-K,this.y=a,this.height=G-a,this}getBounds(t){return(t=t||new N).copyFrom(this),t}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}},338643:(t,K,D)=>{D.d(K,{a:()=>x});var a=D(163619);const G=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function N(t){let K="";for(let D=0;D<t;++D)D>0&&(K+="\nelse "),D<t-1&&(K+=`if(test == ${D}.0){}`);return K}let W=null;function x(){var t;if(W)return W;const K=a.W();return W=K.getParameter(K.MAX_TEXTURE_IMAGE_UNITS),W=function(t,K){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const D=K.createShader(K.FRAGMENT_SHADER);try{for(;1;){const a=G.replace(/%forloop%/gi,N(t));if(K.shaderSource(D,a),K.compileShader(D),K.getShaderParameter(D,K.COMPILE_STATUS))break;t=t/2|0}}finally{K.deleteShader(D)}return t}(W,K),null===(t=K.getExtension("WEBGL_lose_context"))||void 0===t||t.loseContext(),W}},271502:(t,K,D)=>{D.d(K,{w:()=>x});var a=D(632202),G=D(177487),N=D(338643);const W={};function x(t,K){let D=2166136261;for(let a=0;a<K;a++)D^=t[a].uid,D=Math.imul(D,16777619),D>>>=0;return W[D]||function(t,K,D){const x={};let n=0;b||(b=N.a());for(let D=0;D<b;D++){const a=D<K?t[D]:G.g.EMPTY.source;x[n++]=a.source,x[n++]=a.style}const e=new a.T(x);return W[D]=e,e}(t,K,D)}let b=0},524505:(t,K,D)=>{D.d(K,{i:()=>m});var a=D(60158),G=D(354857),N=D(674403),W=D(992284),x=D(338643);class b{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const K=this.textures[t];this.textures[t]=null,this.ids[K.uid]=null}this.count=0}}class n{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new b,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const e=[];let i=0;function z(){return i>0?e[--i]:new n}function I(t){e[i++]=t}let Z=0;const w=class t{constructor(K={}){var D;this.uid=a.L("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],t.defaultOptions.maxTextures=null!==(D=t.defaultOptions.maxTextures)&&void 0!==D?D:x.a(),K={...t.defaultOptions,...K};const{maxTextures:N,attributesInitialSize:W,indicesInitialSize:b}=K;this.attributeBuffer=new G.u(4*W),this.indexBuffer=new Uint16Array(b),this.maxTextures=N}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)I(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,K){const D=t._batch.textures.ids[K._source.uid];return!(!D&&0!==D||(t._textureId=D,t.texture=K,0))}updateElement(t){this.dirty=!0;const K=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,K.float32View,K.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,K.float32View,K.uint32View,t._attributeStart,t._textureId)}break(t){const K=this._elements;if(!K[this.elementStart])return;let D=z(),a=D.textures;a.clear();const G=K[this.elementStart];let N=W.i(G.blendMode,G.texture._source),x=G.topology;4*this.attributeSize>this.attributeBuffer.size&&this._resizeAttributeBuffer(4*this.attributeSize),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const b=this.attributeBuffer.float32View,n=this.attributeBuffer.uint32View,e=this.indexBuffer;let i=this._batchIndexSize,I=this._batchIndexStart,w="startBatch";const m=this.maxTextures;for(let G=this.elementStart;G<this.elementSize;++G){const u=K[G];K[G]=null;const d=u.texture._source,E=W.i(u.blendMode,d),l=N!==E||x!==u.topology;d._batchTick!==Z||l?(d._batchTick=Z,(a.count>=m||l)&&(this._finishBatch(D,I,i-I,a,N,x,t,w),w="renderBatch",I=i,N=E,x=u.topology,D=z(),a=D.textures,a.clear(),++Z),u._textureId=d._textureBindLocation=a.count,a.ids[d.uid]=a.count,a.textures[a.count++]=d,u._batch=D,i+=u.indexSize,u.packAsQuad?(this.packQuadAttributes(u,b,n,u._attributeStart,u._textureId),this.packQuadIndex(e,u._indexStart,u._attributeStart/this.vertexSize)):(this.packAttributes(u,b,n,u._attributeStart,u._textureId),this.packIndex(u,e,u._indexStart,u._attributeStart/this.vertexSize))):(u._textureId=d._textureBindLocation,i+=u.indexSize,u.packAsQuad?(this.packQuadAttributes(u,b,n,u._attributeStart,u._textureId),this.packQuadIndex(e,u._indexStart,u._attributeStart/this.vertexSize)):(this.packAttributes(u,b,n,u._attributeStart,u._textureId),this.packIndex(u,e,u._indexStart,u._attributeStart/this.vertexSize)),u._batch=D)}a.count>0&&(this._finishBatch(D,I,i-I,a,N,x,t,w),I=i,++Z),this.elementStart=this.elementSize,this._batchIndexStart=I,this._batchIndexSize=i}_finishBatch(t,K,D,a,G,N,W,x){t.gpuBindGroup=null,t.bindGroup=null,t.action=x,t.batcher=this,t.textures=a,t.blendMode=G,t.topology=N,t.start=K,t.size=D,++Z,this.batches[this.batchIndex++]=t,W.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){4*t<=this.attributeBuffer.size||this._resizeAttributeBuffer(4*t)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const K=Math.max(t,2*this.attributeBuffer.size),D=new G.u(K);N.W(this.attributeBuffer.rawBinaryData,D.rawBinaryData),this.attributeBuffer=D}_resizeIndexBuffer(t){const K=this.indexBuffer;let D=Math.max(t,1.5*K.length);D+=D%2;const a=D>65535?new Uint32Array(D):new Uint16Array(D);if(a.BYTES_PER_ELEMENT!==K.BYTES_PER_ELEMENT)for(let t=0;t<K.length;t++)a[t]=K[t];else N.W(K.buffer,a.buffer);this.indexBuffer=a}packQuadIndex(t,K,D){t[K]=D+0,t[K+1]=D+1,t[K+2]=D+2,t[K+3]=D+0,t[K+4]=D+2,t[K+5]=D+3}packIndex(t,K,D,a){const G=t.indices,N=t.indexSize,W=t.indexOffset,x=t.attributeOffset;for(let t=0;t<N;t++)K[D++]=a+G[t+W]-x}destroy(){for(let t=0;t<this.batches.length;t++)I(this.batches[t]);this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};w.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let m=w},519401:(t,K,D)=>{D.d(K,{J:()=>l});var a=D(992178),G=D(524505),N=D(518518),W=D(851537),x=D(618773);const b=new Float32Array(1),n=new Uint32Array(1);class e extends x.V{constructor(){const t=new N.h({data:b,label:"attribute-batch-buffer",usage:W.S.VERTEX|W.S.COPY_DST,shrinkToFit:!1}),K=6*4;super({attributes:{aPosition:{buffer:t,format:"float32x2",stride:K,offset:0},aUV:{buffer:t,format:"float32x2",stride:K,offset:2*4},aColor:{buffer:t,format:"unorm8x4",stride:K,offset:4*4},aTextureIdAndRound:{buffer:t,format:"uint16x2",stride:K,offset:5*4}},indexBuffer:new N.h({data:n,label:"index-batch-buffer",usage:W.S.INDEX|W.S.COPY_DST,shrinkToFit:!1})})}}var i=D(270679),z=D(149660),I=D(32365),Z=D(138590),w=D(720711),m=D(92840);class u extends m.M{constructor(t){super({glProgram:i.I({name:"batch",bits:[z.a,I.P(t),Z.m]}),gpuProgram:i.v({name:"batch",bits:[z.F,I._(t),Z.b]}),resources:{batchSamplers:w.n(t)}})}}let d=null;const E=class t extends G.i{constructor(){super(...arguments),this.geometry=new e,this.shader=d||(d=new u(this.maxTextures)),this.name=t.extension.name,this.vertexSize=6}packAttributes(t,K,D,a,G){const N=G<<16|65535&t.roundPixels,W=t.transform,x=W.a,b=W.b,n=W.c,e=W.d,i=W.tx,z=W.ty,{positions:I,uvs:Z}=t,w=t.color,m=t.attributeOffset,u=m+t.attributeSize;for(let t=m;t<u;t++){const G=2*t,W=I[G],m=I[G+1];K[a++]=x*W+n*m+i,K[a++]=e*m+b*W+z,K[a++]=Z[G],K[a++]=Z[G+1],D[a++]=w,D[a++]=N}}packQuadAttributes(t,K,D,a,G){const N=t.texture,W=t.transform,x=W.a,b=W.b,n=W.c,e=W.d,i=W.tx,z=W.ty,I=t.bounds,Z=I.maxX,w=I.minX,m=I.maxY,u=I.minY,d=N.uvs,E=t.color,l=G<<16|65535&t.roundPixels;K[a+0]=x*w+n*u+i,K[a+1]=e*u+b*w+z,K[a+2]=d.x0,K[a+3]=d.y0,D[a+4]=E,D[a+5]=l,K[a+6]=x*Z+n*u+i,K[a+7]=e*u+b*Z+z,K[a+8]=d.x1,K[a+9]=d.y1,D[a+10]=E,D[a+11]=l,K[a+12]=x*Z+n*m+i,K[a+13]=e*m+b*Z+z,K[a+14]=d.x2,K[a+15]=d.y2,D[a+16]=E,D[a+17]=l,K[a+18]=x*w+n*m+i,K[a+19]=e*m+b*w+z,K[a+20]=d.x3,K[a+21]=d.y3,D[a+22]=E,D[a+23]=l}};E.extension={type:[a.Ag.Batcher],name:"default"};let l=E},270679:(t,K,D)=>{D.d(K,{I:()=>h,v:()=>X});var a=D(523700),G=D(562920),N=D(229995);function W(t,K,D){if(t)for(const a in t){const G=K[a.toLocaleLowerCase()];if(G){let K=t[a];"header"===a&&(K=K.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),D&&G.push(`//----${D}----//`),G.push(K)}else N.R(`${a} placement hook does not exist in shader`)}}const x=/\{\{(.*?)\}\}/g;function b(t){var K,D;const a={};return(null!==(D=null===(K=t.match(x))||void 0===K?void 0:K.map((t=>t.replace(/[{()}]/g,""))))&&void 0!==D?D:[]).forEach((t=>{a[t]=[]})),a}function n(t,K){let D;const a=/@in\s+([^;]+);/g;for(;null!==(D=a.exec(t));)K.push(D[1])}function e(t,K,D=!1){const a=[];n(K,a),t.forEach((t=>{t.header&&n(t.header,a)}));const G=a;D&&G.sort();const N=G.map(((t,K)=>`       @location(${K}) ${t},`)).join("\n");let W=K.replace(/@in\s+[^;]+;\s*/g,"");return W=W.replace("{{in}}",`\n${N}\n`),W}function i(t,K){let D;const a=/@out\s+([^;]+);/g;for(;null!==(D=a.exec(t));)K.push(D[1])}function z(t,K){let D=t;for(const t in K){const a=K[t];D=a.join("\n").length?D.replace(`{{${t}}}`,`//-----${t} START-----//\n${a.join("\n")}\n//----${t} FINISH----//`):D.replace(`{{${t}}}`,"")}return D}const I=Object.create(null),Z=new Map;let w=0;function m({template:t,bits:K}){const D=u(t,K);return I[D]||(I[D]=d(t.vertex,t.fragment,K)),I[D]}function u(t,K){return K.map((t=>(Z.has(t)||Z.set(t,w++),Z.get(t)))).sort(((t,K)=>t-K)).join("-")+t.vertex+t.fragment}function d(t,K,D){const a=b(t),G=b(K);return D.forEach((t=>{W(t.vertex,a,t.name),W(t.fragment,G,t.name)})),{vertex:z(t,a),fragment:z(K,G)}}const E=`\n    @in aPosition: vec2<f32>;\n    @in aUV: vec2<f32>;\n\n    @out @builtin(position) vPosition: vec4<f32>;\n    @out vUV : vec2<f32>;\n    @out vColor : vec4<f32>;\n\n    {{header}}\n\n    struct VSOutput {\n        {{struct}}\n    };\n\n    @vertex\n    fn main( {{in}} ) -> VSOutput {\n\n        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;\n        var modelMatrix = mat3x3<f32>(\n            1.0, 0.0, 0.0,\n            0.0, 1.0, 0.0,\n            0.0, 0.0, 1.0\n          );\n        var position = aPosition;\n        var uv = aUV;\n\n        {{start}}\n        \n        vColor = vec4<f32>(1., 1., 1., 1.);\n\n        {{main}}\n\n        vUV = uv;\n\n        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;\n\n        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);\n       \n        vColor *= globalUniforms.uWorldColorAlpha;\n\n        {{end}}\n\n        {{return}}\n    };\n`,l=`\n    @in vUV : vec2<f32>;\n    @in vColor : vec4<f32>;\n   \n    {{header}}\n\n    @fragment\n    fn main(\n        {{in}}\n      ) -> @location(0) vec4<f32> {\n        \n        {{start}}\n\n        var outColor:vec4<f32>;\n      \n        {{main}}\n        \n        var finalColor:vec4<f32> = outColor * vColor;\n\n        {{end}}\n\n        return finalColor;\n      };\n`,Q=`\n    in vec2 aPosition;\n    in vec2 aUV;\n\n    out vec4 vColor;\n    out vec2 vUV;\n\n    {{header}}\n\n    void main(void){\n\n        mat3 worldTransformMatrix = uWorldTransformMatrix;\n        mat3 modelMatrix = mat3(\n            1.0, 0.0, 0.0,\n            0.0, 1.0, 0.0,\n            0.0, 0.0, 1.0\n          );\n        vec2 position = aPosition;\n        vec2 uv = aUV;\n        \n        {{start}}\n        \n        vColor = vec4(1.);\n        \n        {{main}}\n        \n        vUV = uv;\n        \n        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;\n\n        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n\n        vColor *= uWorldColorAlpha;\n\n        {{end}}\n    }\n`,P=`\n   \n    in vec4 vColor;\n    in vec2 vUV;\n\n    out vec4 finalColor;\n\n    {{header}}\n\n    void main(void) {\n        \n        {{start}}\n\n        vec4 outColor;\n      \n        {{main}}\n        \n        finalColor = outColor * vColor;\n        \n        {{end}}\n    }\n`,y={name:"global-uniforms-bit",vertex:{header:`\n        struct GlobalUniforms {\n            uProjectionMatrix:mat3x3<f32>,\n            uWorldTransformMatrix:mat3x3<f32>,\n            uWorldColorAlpha: vec4<f32>,\n            uResolution: vec2<f32>,\n        }\n\n        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;\n        `}},q={name:"global-uniforms-bit",vertex:{header:`\n          uniform mat3 uProjectionMatrix;\n          uniform mat3 uWorldTransformMatrix;\n          uniform vec4 uWorldColorAlpha;\n          uniform vec2 uResolution;\n        `}};function X({bits:t,name:K}){const D=function({template:t,bits:K}){const D=u(t,K);if(I[D])return I[D];const{vertex:a,fragment:G}=function(t,K){const D=K.map((t=>t.vertex)).filter((t=>!!t)),a=K.map((t=>t.fragment)).filter((t=>!!t));let G=e(D,t.vertex,!0);return G=function(t,K){const D=[];i(K,D),t.forEach((t=>{t.header&&i(t.header,D)}));let a=0;const G=D.sort().map((t=>t.indexOf("builtin")>-1?t:`@location(${a++}) ${t}`)).join(",\n"),N=D.sort().map((t=>{return`       var ${K=t,K.replace(/@.*?\s+/g,"")};`;var K})).join("\n"),W=`return VSOutput(\n                ${D.sort().map((t=>` ${function(t){const K=/\b(\w+)\s*:/g.exec(t);return K?K[1]:""}(t)}`)).join(",\n")});`;let x=K.replace(/@out\s+[^;]+;\s*/g,"");return x=x.replace("{{struct}}",`\n${G}\n`),x=x.replace("{{start}}",`\n${N}\n`),x=x.replace("{{return}}",`\n${W}\n`),x}(D,G),{vertex:G,fragment:e(a,t.fragment,!0)}}(t,K);return I[D]=d(a,G,K),I[D]}({template:{fragment:l,vertex:E},bits:[y,...t]});return G.B.from({name:K,vertex:{source:D.vertex,entryPoint:"main"},fragment:{source:D.fragment,entryPoint:"main"}})}function h({bits:t,name:K}){return new a.M({name:K,...m({template:{vertex:Q,fragment:P},bits:[q,...t]})})}},149660:(t,K,D)=>{D.d(K,{F:()=>a,a:()=>G});const a={name:"color-bit",vertex:{header:`\n            @in aColor: vec4<f32>;\n        `,main:`\n            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);\n        `}},G={name:"color-bit",vertex:{header:`\n            in vec4 aColor;\n        `,main:`\n            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);\n        `}}},32365:(t,K,D)=>{D.d(K,{P:()=>n,_:()=>W});const a={};function G(t){const K=[];if(1===t)K.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),K.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let D=0;for(let a=0;a<t;a++)K.push(`@group(1) @binding(${D++}) var textureSource${a+1}: texture_2d<f32>;`),K.push(`@group(1) @binding(${D++}) var textureSampler${a+1}: sampler;`)}return K.join("\n")}function N(t){const K=[];if(1===t)K.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{K.push("switch vTextureId {");for(let D=0;D<t;D++)D===t-1?K.push(`  default:{`):K.push(`  case ${D}:{`),K.push(`      outColor = textureSampleGrad(textureSource${D+1}, textureSampler${D+1}, vUV, uvDx, uvDy);`),K.push(`      break;}`);K.push(`}`)}return K.join("\n")}function W(t){return a[t]||(a[t]={name:"texture-batch-bit",vertex:{header:`\n                @in aTextureIdAndRound: vec2<u32>;\n                @out @interpolate(flat) vTextureId : u32;\n            `,main:`\n                vTextureId = aTextureIdAndRound.y;\n            `,end:`\n                if(aTextureIdAndRound.x == 1)\n                {\n                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n                }\n            `},fragment:{header:`\n                @in @interpolate(flat) vTextureId: u32;\n\n                ${G(t)}\n            `,main:`\n                var uvDx = dpdx(vUV);\n                var uvDy = dpdy(vUV);\n\n                ${N(t)}\n            `}}),a[t]}const x={};function b(t){const K=[];for(let D=0;D<t;D++)D>0&&K.push("else"),D<t-1&&K.push(`if(vTextureId < ${D}.5)`),K.push("{"),K.push(`\toutColor = texture(uTextures[${D}], vUV);`),K.push("}");return K.join("\n")}function n(t){return x[t]||(x[t]={name:"texture-batch-bit",vertex:{header:`\n                in vec2 aTextureIdAndRound;\n                out float vTextureId;\n\n            `,main:`\n                vTextureId = aTextureIdAndRound.y;\n            `,end:`\n                if(aTextureIdAndRound.x == 1.)\n                {\n                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n                }\n            `},fragment:{header:`\n                in float vTextureId;\n\n                uniform sampler2D uTextures[${t}];\n\n            `,main:`\n\n                ${b(t)}\n            `}}),x[t]}},138590:(t,K,D)=>{D.d(K,{b:()=>a,m:()=>G});const a={name:"round-pixels-bit",vertex:{header:`\n            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> \n            {\n                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n            }\n        `}},G={name:"round-pixels-bit",vertex:{header:`   \n            vec2 roundPixels(vec2 position, vec2 targetSize)\n            {       \n                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n            }\n        `}}},799857:(t,K,D)=>{var a=D(992178),G=D(20401),N=D(53569),W=D(766816);const x=new N.c;function b(t,K,D){const a=x;t.measurable=!0,W.fB(t,D,a),K.addBoundsMask(a),t.measurable=!1}var n=D(247612),e=D(687651),i=D(229995);function z(t,K,D){const a=e.o.get();t.measurable=!0;const G=e.u.get().identity(),N=I(t,D,G);n.n(t,a,N),t.measurable=!1,K.addBoundsMask(a),e.u.return(G),e.o.return(a)}function I(t,K,D){return t?(t!==K&&(I(t.parent,K,D),t.updateLocalTransform(),D.append(t.localTransform)),D):(i.R("Mask bounds, renderable is not inside the root container"),D)}class Z{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",(null==t?void 0:t.mask)&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof G.k),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,K){this.inverse||b(this.mask,t,K)}addLocalBounds(t,K){z(this.mask,t,K)}containsPoint(t,K){return K(this.mask,t)}destroy(){this.reset()}static test(t){return t instanceof G.k}}Z.extension=a.Ag.MaskEffect;class w{constructor(t){this.priority=0,this.pipe="colorMask",(null==t?void 0:t.mask)&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return"number"==typeof t}}w.extension=a.Ag.MaskEffect;var m=D(748459);class u{constructor(t){this.priority=0,this.pipe="stencilMask",(null==t?void 0:t.mask)&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,K){b(this.mask,t,K)}addLocalBounds(t,K){z(this.mask,t,K)}containsPoint(t,K){return K(this.mask,t)}destroy(){this.reset()}static test(t){return t instanceof m.mc}}u.extension=a.Ag.MaskEffect;var d=D(135608),E=D(383629),l=D(408078),Q=D(902124);D(744710),a.XO.add(Z,w,u,Q.$,l.b,E.q,d.P)},339254:(t,K,D)=>{D.d(K,{q:()=>x});var a=D(71265),G=D(132812),N=D(512322);const W=["webgl","webgpu","canvas"];async function x(t){var K;let x,b=[];t.preference?(b.push(t.preference),W.forEach((K=>{K!==t.preference&&b.push(K)}))):b=W.slice();let n={};for(let W=0;W<b.length;W++){const e=b[W];if("webgpu"===e&&await G.V()){const{WebGPURenderer:K}=await D.e(82933).then(D.bind(D,982933));x=K,n={...t,...t.webgpu};break}if("webgl"===e&&a.M(null!==(K=t.failIfMajorPerformanceCaveat)&&void 0!==K?K:N.k.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:K}=await D.e(84531).then(D.bind(D,284531));x=K,n={...t,...t.webgl};break}if("canvas"===e)throw n={...t},new Error("CanvasRenderer is not yet implemented")}if(delete n.webgpu,delete n.webgl,!x)throw new Error("No available renderer for the current environment");const e=new x;return await e.init(n),e}},155522:(t,K,D)=>{D.d(K,{u:()=>a});var a=(t=>(t[t["NONE"]=0]="NONE",t[t["COLOR"]=16384]="COLOR",t[t["STENCIL"]=1024]="STENCIL",t[t["DEPTH"]=256]="DEPTH",t[t["COLOR_DEPTH"]=16640]="COLOR_DEPTH",t[t["COLOR_STENCIL"]=17408]="COLOR_STENCIL",t[t["DEPTH_STENCIL"]=1280]="DEPTH_STENCIL",t[t["ALL"]=17664]="ALL",t))(a||{})},523700:(t,K,D)=>{D.d(K,{M:()=>z});var a=D(628853),G=D(163619);let N;function W(){if(!N){N="mediump";const t=G.W();if(t&&t.getShaderPrecisionFormat){const K=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);N=K.precision?"highp":"mediump"}}return N}const x={},b={},n={stripVersion:function(t,K){return K?t.replace("#version 300 es",""):t},ensurePrecision:function(t,K,D){const a=D?K.maxSupportedFragmentPrecision:K.maxSupportedVertexPrecision;if("precision"!==t.substring(0,9)){let G=D?K.requestedFragmentPrecision:K.requestedVertexPrecision;return"highp"===G&&"highp"!==a&&(G="mediump"),`precision ${G} float;\n${t}`}return"highp"!==a&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t},addProgramDefines:function(t,K,D){return K?t:D?`\n        \n        #ifdef GL_ES // This checks if it is WebGL1\n        #define in varying\n        #define finalColor gl_FragColor\n        #define texture texture2D\n        #endif\n        ${t=t.replace("out vec4 finalColor;","")}\n        `:`\n        \n        #ifdef GL_ES // This checks if it is WebGL1\n        #define in attribute\n        #define out varying\n        #endif\n        ${t}\n        `},setProgramName:function(t,{name:K=`pixi-program`},D=!0){K=K.replace(/\s+/g,"-");const a=D?x:b;return a[K+=D?"-fragment":"-vertex"]?(a[K]++,K+=`-${a[K]}`):a[K]=1,-1!==t.indexOf("#define SHADER_NAME")?t:`${`#define SHADER_NAME ${K}`}\n${t}`},insertVersion:function(t,K){return K?`#version 300 es\n${t}`:t}},e=Object.create(null),i=class t{constructor(K){const D=-1!==(K={...t.defaultOptions,...K}).fragment.indexOf("#version 300 es"),G={stripVersion:D,ensurePrecision:{requestedFragmentPrecision:K.preferredFragmentPrecision,requestedVertexPrecision:K.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:W()},setProgramName:{name:K.name},addProgramDefines:D,insertVersion:D};let N=K.fragment,x=K.vertex;Object.keys(n).forEach((t=>{const K=G[t];N=n[t](N,K,!0),x=n[t](x,K,!1)})),this.fragment=N,this.vertex=x,this.transformFeedbackVaryings=K.transformFeedbackVaryings,this._key=a.X(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(K){const D=`${K.vertex}:${K.fragment}`;return e[D]||(e[D]=new t(K)),e[D]}};i.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let z=i},720711:(t,K,D)=>{D.d(K,{n:()=>N});var a=D(418055);const G={};function N(t){let K=G[t];if(K)return K;const D=new Int32Array(t);for(let K=0;K<t;K++)D[K]=K;return K=G[t]=new a.k({uTextures:{value:D,type:`i32`,size:t}},{isStatic:!0}),K}},163619:(t,K,D)=>{D.d(K,{W:()=>N});var a=D(505777);let G;function N(){if(!G||(null==G?void 0:G.isContextLost())){const t=a.e.get().createCanvas();G=t.getContext("webgl",{})}return G}},632202:(t,K,D)=>{D.d(K,{T:()=>a});class a{constructor(t){this.resources=Object.create(null),this._dirty=!0;let K=0;for(const D in t){const a=t[D];this.setResource(a,K++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let K=0;for(const D in this.resources)t[K++]=this.resources[D]._resourceId;this._key=t.join("|")}setResource(t,K){var D,a;const G=this.resources[K];t!==G&&(G&&(null===(D=t.off)||void 0===D||D.call(t,"change",this.onResourceChange,this)),null===(a=t.on)||void 0===a||a.call(t,"change",this.onResourceChange,this),this.resources[K]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const K=this.resources;for(const D in K)K[D]._touched=t}destroy(){var t;const K=this.resources;for(const D in K){const a=K[D];null===(t=a.off)||void 0===t||t.call(a,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const K=this.resources;for(const D in K)K[D]===t&&(K[D]=null)}else this._updateKey()}}},562920:(t,K,D)=>{D.d(K,{B:()=>n});var a=D(628853),G=D(93269);const N={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function W(t){var K,D,a;const G=/@group\((\d+)\)/,N=/@binding\((\d+)\)/,W=/var(<[^>]+>)? (\w+)/,x=/:\s*(\w+)/,b=/(\w+)\s*:\s*([\w\<\>]+)/g,n=/struct\s+(\w+)/,e=null===(K=t.match(/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g))||void 0===K?void 0:K.map((t=>({group:parseInt(t.match(G)[1],10),binding:parseInt(t.match(N)[1],10),name:t.match(W)[2],isUniform:"<uniform>"===t.match(W)[1],type:t.match(x)[1]})));if(!e)return{groups:[],structs:[]};const i=null!==(a=null===(D=t.match(/struct\s+(\w+)\s*{([^}]+)}/g))||void 0===D?void 0:D.map((t=>{const K=t.match(n)[1],D=t.match(b).reduce(((t,K)=>{const[D,a]=K.split(":");return t[D.trim()]=a.trim(),t}),{});return D?{name:K,members:D}:null})).filter((({name:t})=>e.some((K=>K.type===t)))))&&void 0!==a?a:[];return{groups:e,structs:i}}var x=(t=>(t[t["VERTEX"]=1]="VERTEX",t[t["FRAGMENT"]=2]="FRAGMENT",t[t["COMPUTE"]=4]="COMPUTE",t))(x||{});const b=Object.create(null);class n{constructor(t){var K,D;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:a,vertex:G,layout:N,gpuLayout:b,name:n}=t;if(this.name=n,this.fragment=a,this.vertex=G,a.source===G.source){const t=W(a.source);this.structsAndGroups=t}else{const t=W(G.source),K=W(a.source);this.structsAndGroups=function(t,K){const D=new Set,a=new Set;return{structs:[...t.structs,...K.structs].filter((t=>!D.has(t.name)&&(D.add(t.name),!0))),groups:[...t.groups,...K.groups].filter((t=>{const K=`${t.name}-${t.binding}`;return!a.has(K)&&(a.add(K),!0)}))}}(t,K)}this.layout=null!=N?N:function({groups:t}){const K=[];for(let D=0;D<t.length;D++){const a=t[D];K[a.group]||(K[a.group]={}),K[a.group][a.name]=a.binding}return K}(this.structsAndGroups),this.gpuLayout=null!=b?b:function({groups:t}){const K=[];for(let D=0;D<t.length;D++){const a=t[D];K[a.group]||(K[a.group]=[]),a.isUniform?K[a.group].push({binding:a.binding,visibility:x.VERTEX|x.FRAGMENT,buffer:{type:"uniform"}}):"sampler"===a.type?K[a.group].push({binding:a.binding,visibility:x.FRAGMENT,sampler:{type:"filtering"}}):"texture_2d"===a.type&&K[a.group].push({binding:a.binding,visibility:x.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return K}(this.structsAndGroups),this.autoAssignGlobalUniforms=!(void 0===(null===(K=this.layout[0])||void 0===K?void 0:K.globalUniforms)),this.autoAssignLocalUniforms=!(void 0===(null===(D=this.layout[1])||void 0===D?void 0:D.localUniforms)),this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:K}=this,D=t.source+K.source+t.entryPoint+K.entryPoint;this._layoutKey=a.X(D,"program")}get attributeData(){var t;return null!==(t=this._attributeData)&&void 0!==t||(this._attributeData=function({source:t,entryPoint:K}){var D;const a={},W=t.indexOf(`fn ${K}`);if(-1!==W){const K=t.indexOf("->",W);if(-1!==K){const x=t.substring(W,K),b=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let n;for(;null!==(n=b.exec(x));){const t=null!==(D=N[n[3]])&&void 0!==D?D:"float32";a[n[2]]={location:parseInt(n[1],10),format:t,stride:G.m(t).stride,offset:0,instance:!1,start:0}}}}return a}(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(t){const K=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return b[K]||(b[K]=new n(t)),b[K]}}},518518:(t,K,D)=>{D.d(K,{h:()=>W});var a=D(610162),G=D(60158),N=D(851537);class W extends a.A{constructor(t){let{data:K,size:D}=t;const{usage:a,label:N,shrinkToFit:W}=t;super(),this.uid=G.L("buffer"),this._resourceType="buffer",this._resourceId=G.L("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,K instanceof Array&&(K=new Float32Array(K)),this._data=K,D=null!=D?D:null==K?void 0:K.byteLength;const x=!!K;this.descriptor={size:D,usage:a,mappedAtCreation:x,label:N},this.shrinkToFit=null==W||W}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&N.S.STATIC)}set static(t){t?this.descriptor.usage|=N.S.STATIC:this.descriptor.usage&=~N.S.STATIC}setDataWithSize(t,K,D){if(this._updateID++,this._updateSize=K*t.BYTES_PER_ELEMENT,this._data===t)return void(D&&this.emit("update",this));const a=this._data;this._data=t,this._dataInt32=null,a&&a.length===t.length||!this.shrinkToFit&&a&&t.byteLength<a.byteLength?D&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=G.L("resource"),this.emit("change",this))}update(t){this._updateSize=null!=t?t:this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}},851537:(t,K,D)=>{D.d(K,{S:()=>a});var a=(t=>(t[t["MAP_READ"]=1]="MAP_READ",t[t["MAP_WRITE"]=2]="MAP_WRITE",t[t["COPY_SRC"]=4]="COPY_SRC",t[t["COPY_DST"]=8]="COPY_DST",t[t["INDEX"]=16]="INDEX",t[t["VERTEX"]=32]="VERTEX",t[t["UNIFORM"]=64]="UNIFORM",t[t["STORAGE"]=128]="STORAGE",t[t["INDIRECT"]=256]="INDIRECT",t[t["QUERY_RESOLVE"]=512]="QUERY_RESOLVE",t[t["STATIC"]=1024]="STATIC",t))(a||{})},674403:(t,K,D)=>{function a(t,K){const D=t.byteLength/8|0,a=new Float64Array(t,0,D);new Float64Array(K,0,D).set(a);const G=t.byteLength-8*D;if(G>0){const a=new Uint8Array(t,8*D,G);new Uint8Array(K,8*D,G).set(a)}}D.d(K,{W:()=>a})},618773:(t,K,D)=>{D.d(K,{V:()=>n});var a=D(610162),G=D(53569),N=D(60158),W=D(518518),x=D(851537);function b(t,K){if(!(t instanceof W.h)){let D=K?x.S.INDEX:x.S.VERTEX;t instanceof Array&&(K?(t=new Uint32Array(t),D=x.S.INDEX|x.S.COPY_DST):(t=new Float32Array(t),D=x.S.VERTEX|x.S.COPY_DST)),t=new W.h({data:t,label:K?"index-mesh-buffer":"vertex-mesh-buffer",usage:D})}return t}class n extends a.A{constructor(t={}){var K;super(),this.uid=N.L("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new G.c,this._boundsDirty=!0;const{attributes:D,indexBuffer:a,topology:W}=t;if(this.buffers=[],this.attributes={},D)for(const t in D)this.addAttribute(t,D[t]);this.instanceCount=null!==(K=t.instanceCount)&&void 0!==K?K:1,a&&this.addIndex(a),this.topology=W||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const K=this.attributes[t];return K.buffer.data.length/(K.stride/4||K.size)}return 0}addAttribute(t,K){const D=function(t){return(t instanceof W.h||Array.isArray(t)||t.BYTES_PER_ELEMENT)&&(t={buffer:t}),t.buffer=b(t.buffer,!1),t}(K);-1===this.buffers.indexOf(D.buffer)&&(this.buffers.push(D.buffer),D.buffer.on("update",this.onBufferUpdate,this),D.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=D}addIndex(t){this.indexBuffer=b(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,function(t,K,D){const a=t.getAttribute("aPosition");if(!a)return D.minX=0,D.minY=0,D.maxX=0,D.maxY=0,D;const G=a.buffer.data;let N=1/0,W=1/0,x=-1/0,b=-1/0;const n=G.BYTES_PER_ELEMENT,e=(a.offset||0)/n,i=(a.stride||2*4)/n;for(let t=e;t<G.length;t+=i){const K=G[t],D=G[t+1];K>x&&(x=K),D>b&&(b=D),K<N&&(N=K),D<W&&(W=D)}return D.minX=N,D.minY=W,D.maxX=x,D.maxY=b,D}(this,0,this._bounds)):this._bounds}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach((t=>t.destroy())),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}},93269:(t,K,D)=>{D.d(K,{m:()=>G});const a={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function G(t){var K;return null!==(K=a[t])&&void 0!==K?K:a.float32}},807039:(t,K,D)=>{D.d(K,{L:()=>N});var a=D(60158);let G=0;class N{constructor(){this.uid=a.L("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.tick=0}reset(){this.instructionSize=0,this.tick=G++}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}},92840:(t,K,D)=>{D.d(K,{M:()=>n});var a=D(610162),G=D(523700),N=D(632202),W=D(562920),x=D(445382),b=D(418055);class n extends a.A{constructor(t){super(),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:K,glProgram:D,groups:a,resources:G,compatibleRenderers:W,groupMap:n}=t;this.gpuProgram=K,this.glProgram=D,void 0===W&&(W=0,K&&(W|=x.W.WEBGPU),D&&(W|=x.W.WEBGL)),this.compatibleRenderers=W;const e={};if(G||a||(G={}),G&&a)throw new Error("[Shader] Cannot have both resources and groups");if(!K&&a&&!n)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!K&&a&&n)for(const t in n)for(const K in n[t]){const D=n[t][K];e[D]={group:t,binding:K,name:D}}else if(K&&a&&!n){const t=K.structsAndGroups.groups;n={},t.forEach((t=>{n[t.group]=n[t.group]||{},n[t.group][t.binding]=t.name,e[t.name]=t}))}else if(G){a={},n={},K&&K.structsAndGroups.groups.forEach((t=>{n[t.group]=n[t.group]||{},n[t.group][t.binding]=t.name,e[t.name]=t}));let t=0;for(const K in G)e[K]||(a[99]||(a[99]=new N.T,this._ownedBindGroups.push(a[99])),e[K]={group:99,binding:t,name:K},n[99]=n[99]||{},n[99][t]=K,t++);for(const t in G){const K=t;let D=G[t];D.source||D._resourceType||(D=new b.k(D));const W=e[K];W&&(a[W.group]||(a[W.group]=new N.T,this._ownedBindGroups.push(a[W.group])),a[W.group].setResource(D,W.binding))}}this.groups=a,this._uniformBindMap=n,this.resources=this._buildResourceAccessor(a,e)}addResource(t,K,D){var a,G;(a=this._uniformBindMap)[K]||(a[K]={}),(G=this._uniformBindMap[K])[D]||(G[D]=t),this.groups[K]||(this.groups[K]=new N.T,this._ownedBindGroups.push(this.groups[K]))}_buildResourceAccessor(t,K){const D={};for(const a in K){const G=K[a];Object.defineProperty(D,G.name,{get:()=>t[G.group].getResource(G.binding),set(K){t[G.group].setResource(K,G.binding)}})}return D}destroy(t=!1){var K,D;this.emit("destroy",this),t&&(null===(K=this.gpuProgram)||void 0===K||K.destroy(),null===(D=this.glProgram)||void 0===D||D.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach((t=>{t.destroy()})),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(t){const{gpu:K,gl:D,...a}=t;let N,x;return K&&(N=W.B.from(K)),D&&(x=G.M.from(D)),new n({gpuProgram:N,glProgram:x,...a})}}},418055:(t,K,D)=>{D.d(K,{k:()=>n});var a=D(60158),G=D(628853);const N=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],W=N.reduce(((t,K)=>(t[K]=!0,t)),{});function x(t,K){switch(t){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*K);case"vec3<f32>":return new Float32Array(3*K);case"vec4<f32>":return new Float32Array(4*K);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const b=class t{constructor(K,D){var b,n;this._touched=0,this.uid=a.L("uniform"),this._resourceType="uniformGroup",this._resourceId=a.L("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,D={...t.defaultOptions,...D},this.uniformStructures=K;const e={};for(const t in K){const D=K[t];if(D.name=t,D.size=null!==(b=D.size)&&void 0!==b?b:1,!W[D.type])throw new Error(`Uniform type ${D.type} is not supported. Supported uniform types are: ${N.join(", ")}`);null!==(n=D.value)&&void 0!==n||(D.value=x(D.type,D.size)),e[t]=D.value}this.uniforms=e,this._dirtyId=1,this.ubo=D.ubo,this.isStatic=D.isStatic,this._signature=G.X(Object.keys(e).map((t=>`${t}-${K[t].type}`)).join("-"),"uniform-group")}update(){this._dirtyId++}};b.defaultOptions={ubo:!1,isStatic:!1};let n=b},904020:(t,K,D)=>{D.d(K,{U:()=>i});const a={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},G=0,N=1,W=2,x=3,b=4,n=5,e=class t{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<G)}set blend(t){!!(this.data&1<<G)!==t&&(this.data^=1<<G)}get offsets(){return!!(this.data&1<<N)}set offsets(t){!!(this.data&1<<N)!==t&&(this.data^=1<<N)}set cullMode(t){"none"!==t?(this.culling=!0,this.clockwiseFrontFace="front"===t):this.culling=!1}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<W)}set culling(t){!!(this.data&1<<W)!==t&&(this.data^=1<<W)}get depthTest(){return!!(this.data&1<<x)}set depthTest(t){!!(this.data&1<<x)!==t&&(this.data^=1<<x)}get depthMask(){return!!(this.data&1<<n)}set depthMask(t){!!(this.data&1<<n)!==t&&(this.data^=1<<n)}get clockwiseFrontFace(){return!!(this.data&1<<b)}set clockwiseFrontFace(t){!!(this.data&1<<b)!==t&&(this.data^=1<<b)}get blendMode(){return this._blendMode}set blendMode(t){this.blend="none"!==t,this._blendMode=t,this._blendModeId=a[t]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const K=new t;return K.depthTest=!1,K.blend=!0,K}};e.default2d=e.for2d();let i=e},295746:(t,K,D)=>{D.d(K,{K:()=>G,Q:()=>a});const a={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var G=(t=>(t[t["DISABLED"]=0]="DISABLED",t[t["RENDERING_MASK_ADD"]=1]="RENDERING_MASK_ADD",t[t["MASK_ACTIVE"]=2]="MASK_ACTIVE",t[t["INVERSE_MASK_ACTIVE"]=3]="INVERSE_MASK_ACTIVE",t[t["RENDERING_MASK_REMOVE"]=4]="RENDERING_MASK_REMOVE",t[t["NONE"]=5]="NONE",t))(G||{})},992284:(t,K,D)=>{D.d(K,{i:()=>G});var a=D(295746);function G(t,K){return"no-premultiply-alpha"===K.alphaMode&&a.Q[t]||t}},512322:(t,K,D)=>{D.d(K,{k:()=>Z});var a=D(534661),G=D(992178);const N=[];G.XO.handleByNamedList(G.Ag.Environment,N);var W=D(748459),x=D(815648),b=D(5319),n=D(155522),e=D(397514),i=D(610162);const z=["init","destroy","contextChange","resolutionChange","reset","renderEnd","renderStart","render","update","postrender","prerender"],I=class t extends i.A{constructor(t){var K;super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const D=[...z,...null!==(K=this.config.runners)&&void 0!==K?K:[]];this._addRunners(...D),this._unsafeEvalCheck()}async init(K={}){const D=!0===K.skipExtensionImports||!1===K.manageImports;await async function(t){if(!t)for(let t=0;t<N.length;t++){const K=N[t];if(K.value.test())return void await K.value.load()}}(D),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const t in this._systemsHash)K={...this._systemsHash[t].constructor.defaultOptions,...K};K={...t.defaultOptions,...K},this._roundPixels=K.roundPixels?1:0;for(let t=0;t<this.runners.init.items.length;t++)await this.runners.init.items[t].init(K);this._initOptions=K}render(t,K){let D=t;if(D instanceof W.mc&&(D={container:D},K&&(b.t6(b.lj,"passing a second argument is deprecated, please use render options instead"),D.target=K.renderTexture)),D.target||(D.target=this.view.renderTarget),D.target===this.view.renderTarget&&(this._lastObjectRendered=D.container,D.clearColor=this.background.colorRgba),D.clearColor){const t=Array.isArray(D.clearColor)&&4===D.clearColor.length;D.clearColor=t?D.clearColor:a.Q.shared.setValue(D.clearColor).toArray()}D.transform||(D.container.updateLocalTransform(),D.transform=D.container.localTransform),D.container.enableRenderGroup(),this.runners.prerender.emit(D),this.runners.renderStart.emit(D),this.runners.render.emit(D),this.runners.renderEnd.emit(D),this.runners.postrender.emit(D)}resize(t,K,D){const a=this.view.resolution;this.view.resize(t,K,D),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),void 0!==D&&D!==a&&this.runners.resolutionChange.emit(D)}clear(t={}){var K;t.target||(t.target=this.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),null!==(K=t.clear)&&void 0!==K||(t.clear=n.u.ALL);const{clear:D,clearColor:G,target:N}=t;a.Q.shared.setValue(null!=G?G:this.background.colorRgba),this.renderTarget.clear(N,D,a.Q.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach((t=>{this.runners[t]=new e.C(t)}))}_addSystems(t){let K;for(K in t){const D=t[K];this._addSystem(D.value,D.name)}}_addSystem(t,K){const D=new t(this);if(this[K])throw new Error(`Whoops! The name "${K}" is already in use`);this[K]=D,this._systemsHash[K]=D;for(const t in this.runners)this.runners[t].add(D);return this}_addPipes(t,K){const D=K.reduce(((t,K)=>(t[K.name]=K.value,t)),{});t.forEach((t=>{const K=t.value,a=t.name,G=D[a];this.renderPipes[a]=new K(this,G?new G:null)}))}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach((t=>{t.destroy()})),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!x.f())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}};I.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let Z=I},397514:(t,K,D)=>{D.d(K,{C:()=>a});class a{constructor(t){this.items=[],this._name=t}emit(t,K,D,a,G,N,W,x){const{name:b,items:n}=this;for(let e=0,i=n.length;e<i;e++)n[e][b](t,K,D,a,G,N,W,x);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const K=this.items.indexOf(t);return-1!==K&&this.items.splice(K,1),this}contains(t){return-1!==this.items.indexOf(t)}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return 0===this.items.length}get name(){return this._name}}},768273:(t,K,D)=>{D.d(K,{N:()=>N});var a=D(505777),G=D(444230);const N=new class{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,K){const D=a.e.get().createCanvas();D.width=t,D.height=K;const G=D.getContext("2d");return{canvas:D,context:G}}getOptimalCanvasAndContext(t,K,D=1){t=Math.ceil(t*D-1e-6),K=Math.ceil(K*D-1e-6);const a=((t=G.U5(t))<<17)+((K=G.U5(K))<<1);this._canvasPool[a]||(this._canvasPool[a]=[]);let N=this._canvasPool[a].pop();return N||(N=this._createCanvasAndContext(t,K)),N}returnCanvasAndContext(t){const K=t.canvas,{width:D,height:a}=K,G=(D<<17)+(a<<1);t.context.clearRect(0,0,D,a),this._canvasPool[G].push(t)}clear(){this._canvasPool={}}}},177487:(t,K,D)=>{D.d(K,{g:()=>l});var a=D(610162),G=D(823040);const N=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],W=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],x=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],b=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],n=[],e=[],i=Math.sign;(function(){for(let t=0;t<16;t++){const K=[];n.push(K);for(let D=0;D<16;D++){const a=i(N[t]*N[D]+x[t]*W[D]),G=i(W[t]*N[D]+b[t]*W[D]),n=i(N[t]*x[D]+x[t]*b[D]),e=i(W[t]*x[D]+b[t]*b[D]);for(let t=0;t<16;t++)if(N[t]===a&&W[t]===G&&x[t]===n&&b[t]===e){K.push(t);break}}}for(let t=0;t<16;t++){const K=new G.u;K.set(N[t],W[t],x[t],b[t],0,0),e.push(K)}})();const z={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>N[t],uY:t=>W[t],vX:t=>x[t],vY:t=>b[t],inv:t=>8&t?15&t:7&-t,add:(t,K)=>n[t][K],sub:(t,K)=>n[t][z.inv(K)],rotate180:t=>4^t,isVertical:t=>2==(3&t),byDirection:(t,K)=>2*Math.abs(t)<=Math.abs(K)?K>=0?z.S:z.N:2*Math.abs(K)<=Math.abs(t)?t>0?z.E:z.W:K>0?t>0?z.SE:z.SW:t>0?z.NE:z.NW,matrixAppendRotationInv:(t,K,D=0,a=0)=>{const G=e[z.inv(K)];G.tx=D,G.ty=a,t.append(G)}};var I=D(377223),Z=D(60158),w=D(5319);const m=()=>{};var u=D(135608),d=D(100419),E=D(590795);class l extends a.A{constructor({source:t,label:K,frame:D,orig:a,trim:G,defaultAnchor:N,defaultBorders:W,rotate:x,dynamic:b}={}){var n;if(super(),this.uid=Z.L("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new I.M,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=K,this.source=null!==(n=null==t?void 0:t.source)&&void 0!==n?n:new d.v,this.noFrame=!D,D)this.frame.copyFrom(D);else{const{width:t,height:K}=this._source;this.frame.width=t,this.frame.height=K}this.orig=a||this.frame,this.trim=G,this.rotate=null!=x?x:0,this.defaultAnchor=N,this.defaultBorders=W,this.destroyed=!1,this.dynamic=b||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new E.N(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:K}=this,{width:D,height:a}=this._source,G=K.x/D,N=K.y/a,W=K.width/D,x=K.height/a;let b=this.rotate;if(b){const K=W/2,D=x/2,a=G+K,n=N+D;b=z.add(b,z.NW),t.x0=a+K*z.uX(b),t.y0=n+D*z.uY(b),b=z.add(b,2),t.x1=a+K*z.uX(b),t.y1=n+D*z.uY(b),b=z.add(b,2),t.x2=a+K*z.uX(b),t.y2=n+D*z.uY(b),b=z.add(b,2),t.x3=a+K*z.uX(b),t.y3=n+D*z.uY(b)}else t.x0=G,t.y0=N,t.x1=G+W,t.y1=N,t.x2=G+W,t.y2=N+x,t.x3=G,t.y3=N+x}destroy(t=!1){this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return w.t6(w.lj,"Texture.baseTexture is now Texture.source"),this._source}}l.EMPTY=new l({label:"EMPTY",source:new d.v({label:"EMPTY"})}),l.EMPTY.destroy=m,l.WHITE=new l({source:new u.P({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"}),l.WHITE.destroy=m},590795:(t,K,D)=>{D.d(K,{N:()=>N});var a=D(823040);const G=new a.u;class N{constructor(t,K){this.mapCoord=new a.u,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===K?t.width<10?0:.5:K,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var K;this.texture!==t&&(null===(K=this._texture)||void 0===K||K.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,K){void 0===K&&(K=t);const D=this.mapCoord;for(let a=0;a<t.length;a+=2){const G=t[a],N=t[a+1];K[a]=G*D.a+N*D.c+D.tx,K[a+1]=G*D.b+N*D.d+D.ty}return K}update(){const t=this._texture;this._updateID++;const K=t.uvs;this.mapCoord.set(K.x1-K.x0,K.y1-K.y0,K.x3-K.x0,K.y3-K.y0,K.x0,K.y0);const D=t.orig,a=t.trim;a&&(G.set(D.width/a.width,0,0,D.height/a.height,-a.x/a.width,-a.y/a.height),this.mapCoord.append(G));const N=t.source,W=this.uClampFrame,x=this.clampMargin/N._resolution,b=this.clampOffset/N._resolution;return W[0]=(t.frame.x+x+b)/N.width,W[1]=(t.frame.y+x+b)/N.height,W[2]=(t.frame.x+t.frame.width-x+b)/N.width,W[3]=(t.frame.y+t.frame.height-x+b)/N.height,this.uClampOffset[0]=this.clampOffset/N.pixelWidth,this.uClampOffset[1]=this.clampOffset/N.pixelHeight,this.isSimple=t.frame.width===N.width&&t.frame.height===N.height&&0===t.rotate,!0}}},625374:(t,K,D)=>{D.d(K,{W:()=>x});var a=D(444230),G=D(100419),N=D(177487);let W=0;const x=new class{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1}createTexture(t,K,D){const a=new G.v({...this.textureOptions,width:t,height:K,resolution:1,antialias:D,autoGarbageCollect:!0});return new N.g({source:a,label:`texturePool_${W++}`})}getOptimalTexture(t,K,D=1,G){let N=Math.ceil(t*D-1e-6),W=Math.ceil(K*D-1e-6);N=a.U5(N),W=a.U5(W);const x=(N<<17)+(W<<1)+(G?1:0);this._texturePool[x]||(this._texturePool[x]=[]);let b=this._texturePool[x].pop();return b||(b=this.createTexture(N,W,G)),b.source._resolution=D,b.source.width=N/D,b.source.height=W/D,b.source.pixelWidth=N,b.source.pixelHeight=W,b.frame.x=0,b.frame.y=0,b.frame.width=t,b.frame.height=K,b.updateUvs(),this._poolKeyHash[b.uid]=x,b}getSameSizeTexture(t,K=!1){const D=t.source;return this.getOptimalTexture(t.width,t.height,D._resolution,K)}returnTexture(t){const K=this._poolKeyHash[t.uid];this._texturePool[K].push(t)}clear(t){if(t=!1!==t)for(const t in this._texturePool){const K=this._texturePool[t];if(K)for(let t=0;t<K.length;t++)K[t].destroy(!0)}this._texturePool={}}}},400387:(t,K,D)=>{D.d(K,{n:()=>b});var a=D(610162),G=D(60158),N=D(5319);const W=Object.create(null),x=class t extends a.A{constructor(K={}){var D,a,G,N,W,x,b;super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,K={...t.defaultOptions,...K},this.addressMode=K.addressMode,this.addressModeU=null!==(D=K.addressModeU)&&void 0!==D?D:this.addressModeU,this.addressModeV=null!==(a=K.addressModeV)&&void 0!==a?a:this.addressModeV,this.addressModeW=null!==(G=K.addressModeW)&&void 0!==G?G:this.addressModeW,this.scaleMode=K.scaleMode,this.magFilter=null!==(N=K.magFilter)&&void 0!==N?N:this.magFilter,this.minFilter=null!==(W=K.minFilter)&&void 0!==W?W:this.minFilter,this.mipmapFilter=null!==(x=K.mipmapFilter)&&void 0!==x?x:this.mipmapFilter,this.lodMinClamp=K.lodMinClamp,this.lodMaxClamp=K.lodMaxClamp,this.compare=K.compare,this.maxAnisotropy=null!==(b=K.maxAnisotropy)&&void 0!==b?b:1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){N.t6(N.lj,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=function(t){const K=W[t];return void 0===K&&(W[t]=G.L("resource")),K}(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};x.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let b=x},135608:(t,K,D)=>{D.d(K,{P:()=>N});var a=D(992178),G=D(100419);class N extends G.v{constructor(t){const K=t.resource||new Float32Array(t.width*t.height*4);let D=t.format;D||(D=K instanceof Float32Array?"rgba32float":K instanceof Int32Array||K instanceof Uint32Array?"rgba32uint":K instanceof Int16Array||K instanceof Uint16Array?"rgba16uint":(Int8Array,"bgra8unorm")),super({...t,resource:K,format:D}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}N.extension=a.Ag.TextureSource},383629:(t,K,D)=>{D.d(K,{q:()=>W});var a=D(505777),G=D(992178),N=D(100419);class W extends N.v{constructor(t){t.resource||(t.resource=a.e.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),this.resource.width===this.pixelWidth&&this.resource.height===this.pixelHeight||(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,K=this.height,D=this._resolution){const a=super.resize(t,K,D);return a&&this.resizeCanvas(),a}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}W.extension=G.Ag.TextureSource},408078:(t,K,D)=>{D.d(K,{b:()=>x});var a=D(505777),G=D(992178),N=D(229995),W=D(100419);class x extends W.v{constructor(t){if(t.resource&&globalThis.HTMLImageElement&&t.resource instanceof HTMLImageElement){const K=a.e.get().createCanvas(t.resource.width,t.resource.height);K.getContext("2d").drawImage(t.resource,0,0,t.resource.width,t.resource.height),t.resource=K,N.R("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}x.extension=G.Ag.TextureSource},100419:(t,K,D)=>{D.d(K,{v:()=>b});var a=D(610162),G=D(444230),N=D(60158),W=D(400387);const x=class t extends a.A{constructor(K={}){var D,a,G;super(),this.options=K,this.uid=N.L("textureSource"),this._resourceType="textureSource",this._resourceId=N.L("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,K={...t.defaultOptions,...K},this.label=null!==(D=K.label)&&void 0!==D?D:"",this.resource=K.resource,this.autoGarbageCollect=K.autoGarbageCollect,this._resolution=K.resolution,K.width?this.pixelWidth=K.width*this._resolution:this.pixelWidth=this.resource&&null!==(a=this.resourceWidth)&&void 0!==a?a:1,K.height?this.pixelHeight=K.height*this._resolution:this.pixelHeight=this.resource&&null!==(G=this.resourceHeight)&&void 0!==G?G:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=K.format,this.dimension=K.dimensions,this.mipLevelCount=K.mipLevelCount,this.autoGenerateMipmaps=K.autoGenerateMipmaps,this.sampleCount=K.sampleCount,this.antialias=K.antialias,this.alphaMode=K.alphaMode,this.style=new W.n(function(t){const K={};for(const D in t)void 0!==t[D]&&(K[D]=t[D]);return K}(K)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){var K,D;this.style!==t&&(null===(K=this._style)||void 0===K||K.off("change",this._onStyleChange,this),this._style=t,null===(D=this._style)||void 0===D||D.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=N.L("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,K,D){D=D||this._resolution,t=t||this.width,K=K||this.height;const a=Math.round(t*D),G=Math.round(K*D);return this.width=a/D,this.height=G/D,this._resolution=D,(this.pixelWidth!==a||this.pixelHeight!==G)&&(this._refreshPOT(),this.pixelWidth=a,this.pixelHeight=G,this.emit("resize",this),this._resourceId=N.L("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=G.f3(this.pixelWidth)&&G.f3(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};x.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let b=x},902124:(t,K,D)=>{D.d(K,{$:()=>b});var a=D(992178),G=D(463996),N=D(997089),W=D(100419);const x=class t extends W.v{constructor(K){var D;super(K),this.isReady=!1,this.uploadMethodId="video",K={...t.defaultOptions,...K},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=K.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==K.autoPlay,this.alphaMode=null!==(D=K.alphaMode)&&void 0!==D?D:"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),!1!==K.autoLoad&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=G.R.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,K=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(K.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await N.C(),this._load=new Promise(((D,a)=>{this.isValid?D(this):(this._resolve=D,this._reject=a,void 0!==K.preloadTimeoutMs&&(this._preloadTimeout=setTimeout((()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${K.preloadTimeoutMs}ms`))}))),t.load())})),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(G.R.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(G.R.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(G.R.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};x.extension=a.Ag.TextureSource,x.defaultOptions={...W.v.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1},x.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let b=x},744710:(t,K,D)=>{var a=D(363020),G=D(992178),N=D(100419),W=D(177487);const x=[];function b(t={}){const K=t&&t.resource,D=K?t.resource:t,a=K?t:{resource:t};for(let t=0;t<x.length;t++){const K=x[t];if(K.test(D))return new K(a)}throw new Error(`Could not find a source type for resource: ${a.resource}`)}G.XO.handleByList(G.Ag.TextureSource,x),W.g.from=function(t,K=!1){return"string"==typeof t?a.l.get(t):t instanceof N.v?new W.g({source:t}):function(t={},K=!1){const D=t&&t.resource,G=D?t.resource:t,N=D?t:{resource:t};if(!K&&a.l.has(G))return a.l.get(G);const x=new W.g({source:b(N)});return x.on("destroy",(()=>{a.l.has(G)&&a.l.remove(G)})),K||a.l.set(G,x),x}(t,K)},N.v.from=b},628853:(t,K,D)=>{D.d(K,{X:()=>N});const a=Object.create(null),G=Object.create(null);function N(t,K){let D=G[t];return void 0===D&&(void 0===a[K]&&(a[K]=1),G[t]=D=a[K]++),D}},445382:(t,K,D)=>{D.d(K,{W:()=>a});var a=(t=>(t[t["WEBGL"]=1]="WEBGL",t[t["WEBGPU"]=2]="WEBGPU",t[t["BOTH"]=3]="BOTH",t))(a||{})},748459:(t,K,D)=>{D.d(K,{mc:()=>L,u:()=>A,ig:()=>R,fR:()=>Y});var a=D(610162),G=D(534661),N=D(823040),W=D(100403),x=D(553417),b=D(60158),n=D(5319),e=D(721013);const i={get isCachedAsTexture(){var t;return!!(null===(t=this.renderGroup)||void 0===t?void 0:t.isCachedAsTexture)},cacheAsTexture(t){"boolean"==typeof t&&!1===t?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(!0===t?{}:t))},updateCacheTexture(){var t;null===(t=this.renderGroup)||void 0===t||t.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(t){n.t6("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(t)}};var z=D(935440);const I={allowChildren:!0,removeChildren(t=0,K){const D=null!=K?K:this.children.length,a=D-t,G=[];if(a>0&&a<=D){for(let K=D-1;K>=t;K--){const t=this.children[K];t&&(G.push(t),t.parent=null)}z.d(this.children,t,D);const K=this.renderGroup||this.parentRenderGroup;K&&K.removeChildren(G);for(let t=0;t<G.length;++t)this.emit("childRemoved",G[t],this,t),G[t].emit("removed",this);return G}if(0===a&&0===this.children.length)return G;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(t){const K=this.getChildAt(t);return this.removeChild(K)},getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]},setChildIndex(t,K){if(K<0||K>=this.children.length)throw new Error(`The index ${K} supplied is out of bounds ${this.children.length}`);this.getChildIndex(t),this.addChildAt(t,K)},getChildIndex(t){const K=this.children.indexOf(t);if(-1===K)throw new Error("The supplied Container must be a child of the caller");return K},addChildAt(t,K){this.allowChildren||n.t6(n.lj,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:D}=this;if(K<0||K>D.length)throw new Error(`${t}addChildAt: The index ${K} supplied is out of bounds ${D.length}`);if(t.parent){const D=t.parent.children.indexOf(t);if(t.parent===this&&D===K)return t;-1!==D&&t.parent.children.splice(D,1)}K===D.length?D.push(t):D.splice(K,0,t),t.parent=this,t.didChange=!0,t._updateFlags=15;const a=this.renderGroup||this.parentRenderGroup;return a&&a.addChild(t),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",t,this,K),t.emit("added",this),t},swapChildren(t,K){if(t===K)return;const D=this.getChildIndex(t),a=this.getChildIndex(K);this.children[D]=K,this.children[a]=t;const G=this.renderGroup||this.parentRenderGroup;G&&(G.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var t;null===(t=this.parent)||void 0===t||t.removeChild(this)},reparentChild(...t){return 1===t.length?this.reparentChildAt(t[0],this.children.length):(t.forEach((t=>this.reparentChildAt(t,this.children.length))),t[0])},reparentChildAt(t,K){if(t.parent===this)return this.setChildIndex(t,K),t;const D=t.worldTransform.clone();t.removeFromParent(),this.addChildAt(t,K);const a=this.worldTransform.clone();return a.invert(),D.prepend(a),t.setFromMatrix(D),t}};var Z=D(323470),w=D(992178);const m=new class{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach((t=>{this.add({test:t.test,maskClass:t})})))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let K=0;K<this._tests.length;K++){const D=this._tests[K];if(D.test(t))return e.Z.get(D.maskClass,t)}return t}returnMaskEffect(t){e.Z.return(t)}};w.XO.handleByList(w.Ag.MaskEffect,m._effectClasses);const u={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const t=this.renderGroup||this.parentRenderGroup;t&&(t.structureDidChange=!0)},addEffect(t){-1===this.effects.indexOf(t)&&(this.effects.push(t),this.effects.sort(((t,K)=>t.priority-K.priority)),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(t){const K=this.effects.indexOf(t);-1!==K&&(this.effects.splice(K,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(t){const K=this._maskEffect;(null==K?void 0:K.mask)!==t&&(K&&(this.removeEffect(K),m.returnMaskEffect(K),this._maskEffect=null),null!=t&&(this._maskEffect=m.getMaskEffect(t),this.addEffect(this._maskEffect)))},setMask(t){this._maskOptions={...this._maskOptions,...t},t.mask&&(this.mask=t.mask),this._markStructureAsChanged()},get mask(){var t;return null===(t=this._maskEffect)||void 0===t?void 0:t.mask},set filters(t){var K;!Array.isArray(t)&&t&&(t=[t]);const D=this._filterEffect||(this._filterEffect=new Z.a),a=(null==t?void 0:t.length)>0,G=a!==(null===(K=D.filters)||void 0===K?void 0:K.length)>0;t=Array.isArray(t)?t.slice(0):t,D.filters=Object.freeze(t),G&&(a?this.addEffect(D):(this.removeEffect(D),D.filters=null!=t?t:null))},get filters(){var t;return null===(t=this._filterEffect)||void 0===t?void 0:t.filters},set filterArea(t){this._filterEffect||(this._filterEffect=new Z.a),this._filterEffect.filterArea=t},get filterArea(){var t;return null===(t=this._filterEffect)||void 0===t?void 0:t.filterArea}},d={label:null,get name(){return n.t6(n.lj,"Container.name property has been removed, use Container.label instead"),this.label},set name(t){n.t6(n.lj,"Container.name property has been removed, use Container.label instead"),this.label=t},getChildByName(t,K=!1){return this.getChildByLabel(t,K)},getChildByLabel(t,K=!1){const D=this.children;for(let K=0;K<D.length;K++){const a=D[K];if(a.label===t||t instanceof RegExp&&t.test(a.label))return a}if(K)for(let K=0;K<D.length;K++){const a=D[K].getChildByLabel(t,!0);if(a)return a}return null},getChildrenByLabel(t,K=!1,D=[]){const a=this.children;for(let K=0;K<a.length;K++){const G=a[K];(G.label===t||t instanceof RegExp&&t.test(G.label))&&D.push(G)}if(K)for(let K=0;K<a.length;K++)a[K].getChildrenByLabel(t,!0,D);return D}};var E=D(201903),l=D(53569),Q=D(766816),P=D(247612);function y(t,K){const D=t.children;for(let t=0;t<D.length;t++){const a=D[t],G=a.uid,N=(65535&a._didViewChangeTick)<<16|65535&a._didContainerChangeTick,W=K.index;K.data[W]===G&&K.data[W+1]===N||(K.data[K.index]=G,K.data[K.index+1]=N,K.didChange=!0),K.index=W+2,a.children.length&&y(a,K)}return K.didChange}const q=new N.u,X={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(t,K){const D=Math.sign(this.scale.x)||1;this.scale.x=0!==K?t/K*D:D},_setHeight(t,K){const D=Math.sign(this.scale.y)||1;this.scale.y=0!==K?t/K*D:D},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new l.c});const t=this._localBoundsCacheData;return t.index=1,t.didChange=!1,t.data[0]!==this._didViewChangeTick&&(t.didChange=!0,t.data[0]=this._didViewChangeTick),y(this,t),t.didChange&&P.n(this,t.localBounds,q),t.localBounds},getBounds(t,K){return Q.fB(this,t,K||new l.c)}},h={_onRender:null,set onRender(t){const K=this.renderGroup||this.parentRenderGroup;if(!t)return this._onRender&&(null==K||K.removeOnRender(this)),void(this._onRender=null);this._onRender||null==K||K.addOnRender(this),this._onRender=t},get onRender(){return this._onRender}},J={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(T))}};function T(t,K){return t._zIndex-K._zIndex}var _=D(521212),C=D(687651);const H={getGlobalPosition(t=new _.b,K=!1){return this.parent?this.parent.toGlobal(this._position,t,K):(t.x=this._position.x,t.y=this._position.y),t},toGlobal(t,K,D=!1){const a=this.getGlobalTransform(C.u.get(),D);return K=a.apply(t,K),C.u.return(a),K},toLocal(t,K,D,a){K&&(t=K.toGlobal(t,D,a));const G=this.getGlobalTransform(C.u.get(),a);return D=G.applyInverse(t,D),C.u.return(G),D}};var o=D(807039),U=D(625374);class V{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new N.u,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new o.L,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const K=t.children;for(let t=0;t<K.length;t++)this.addChild(K[t])}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(U.W.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const K=this.childrenToUpdate[t];K.list.fill(null),K.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const K=this.renderGroupChildren.indexOf(t);K>-1&&this.renderGroupChildren.splice(K,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup)return void this.addRenderGroupChild(t.renderGroup);t._onRender&&this.addOnRender(t);const K=t.children;for(let t=0;t<K.length;t++)this.addChild(K[t])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup)return void this._removeRenderGroupChild(t.renderGroup);const K=t.children;for(let t=0;t<K.length;t++)this.removeChild(K[t])}removeChildren(t){for(let K=0;K<t.length;K++)this.removeChild(t[K])}onChildUpdate(t){let K=this.childrenToUpdate[t.relativeRenderGroupDepth];K||(K=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),K.list[K.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return 7===this.root.localDisplayStatus&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(){for(let t=0;t<this._onRenderContainers.length;t++)this._onRenderContainers[t]._onRender()}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const K=this.root.children;for(let D=0;D<K.length;D++)this._getChildren(K[D],t);return t}_getChildren(t,K=[]){if(K.push(t),t.renderGroup)return K;const D=t.children;for(let t=0;t<D.length;t++)this._getChildren(D[t],K);return K}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return 1&this._matrixDirty?(this._matrixDirty&=~1,this._inverseWorldTransform||(this._inverseWorldTransform=new N.u),this._inverseWorldTransform.copyFrom(this.worldTransform).invert()):this._inverseWorldTransform}get textureOffsetInverseTransform(){return 2&this._matrixDirty?(this._matrixDirty&=~2,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new N.u),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y)):this._textureOffsetInverseTransform}get inverseParentTextureTransform(){if(!(4&this._matrixDirty))return this._inverseParentTextureTransform;this._matrixDirty&=~4;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new N.u),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}var s=D(120295);const F=new x.o(null),c=new x.o(null),g=new x.o(null,1,1),R=1,A=2,Y=4;class L extends a.A{constructor(t={}){var K,D;super(),this.uid=b.L("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new N.u,this.relativeGroupTransform=new N.u,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new x.o(this,0,0),this._scale=g,this._pivot=c,this._skew=F,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],s.s(this,t,{children:!0,parent:!0,effects:!0}),null===(K=t.children)||void 0===K||K.forEach((t=>this.addChild(t))),null===(D=t.parent)||void 0===D||D.addChild(this)}static mixin(t){Object.defineProperties(L.prototype,Object.getOwnPropertyDescriptors(t))}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=4095&t}get _didChangeId(){return 4095&this._didContainerChangeTick|(4095&this._didViewChangeTick)<<12}addChild(...t){if(this.allowChildren||n.t6(n.lj,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let K=0;K<t.length;K++)this.addChild(t[K]);return t[0]}const K=t[0],D=this.renderGroup||this.parentRenderGroup;return K.parent===this?(this.children.splice(this.children.indexOf(K),1),this.children.push(K),D&&(D.structureDidChange=!0),K):(K.parent&&K.parent.removeChild(K),this.children.push(K),this.sortableChildren&&(this.sortDirty=!0),K.parent=this,K.didChange=!0,K._updateFlags=15,D&&D.addChild(K),this.emit("childAdded",K,this,this.children.length-1),K.emit("added",this),this._didViewChangeTick++,0!==K._zIndex&&K.depthOfChildModified(),K)}removeChild(...t){if(t.length>1){for(let K=0;K<t.length;K++)this.removeChild(t[K]);return t[0]}const K=t[0],D=this.children.indexOf(K);return D>-1&&(this._didViewChangeTick++,this.children.splice(D,1),this.renderGroup?this.renderGroup.removeChild(K):this.parentRenderGroup&&this.parentRenderGroup.removeChild(K),K.parent=null,this.emit("childRemoved",K,this,D),K.emit("removed",this)),K}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,this.didChange||(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;null==t||t.removeChild(this),this.renderGroup=e.Z.get(V,this),this.groupTransform=N.u.IDENTITY,null==t||t.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;null==t||t.removeChild(this),e.Z.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,null==t||t.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&0===this.effects.length}get worldTransform(){return this._worldTransform||(this._worldTransform=new N.u),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*W.bO}set angle(t){this.rotation=t*W.Td}get pivot(){return this._pivot===c&&(this._pivot=new x.o(this,0,0)),this._pivot}set pivot(t){this._pivot===c&&(this._pivot=new x.o(this,0,0)),"number"==typeof t?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===F&&(this._skew=new x.o(this,0,0)),this._skew}set skew(t){this._skew===F&&(this._skew=new x.o(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===g&&(this._scale=new x.o(this,1,1)),this._scale}set scale(t){this._scale===g&&(this._scale=new x.o(this,0,0)),"number"==typeof t?this._scale.set(t):this._scale.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const K=this.getLocalBounds().width;this._setWidth(t,K)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const K=this.getLocalBounds().height;this._setHeight(t,K)}getSize(t){t||(t={});const K=this.getLocalBounds();return t.width=Math.abs(this.scale.x*K.width),t.height=Math.abs(this.scale.y*K.height),t}setSize(t,K){var D;const a=this.getLocalBounds();"object"==typeof t?(K=null!==(D=t.height)&&void 0!==D?D:t.width,t=t.width):null!=K||(K=t),void 0!==t&&this._setWidth(t,a.width),void 0!==K&&this._setHeight(K,a.height)}_updateSkew(){const t=this._rotation,K=this._skew;this._cx=Math.cos(t+K._y),this._sx=Math.sin(t+K._y),this._cy=-Math.sin(t-K._x),this._sy=Math.cos(t-K._x)}updateTransform(t){return this.position.set("number"==typeof t.x?t.x:this.position.x,"number"==typeof t.y?t.y:this.position.y),this.scale.set("number"==typeof t.scaleX?t.scaleX||1:this.scale.x,"number"==typeof t.scaleY?t.scaleY||1:this.scale.y),this.rotation="number"==typeof t.rotation?t.rotation:this.rotation,this.skew.set("number"==typeof t.skewX?t.skewX:this.skew.x,"number"==typeof t.skewY?t.skewY:this.skew.y),this.pivot.set("number"==typeof t.pivotX?t.pivotX:this.pivot.x,"number"==typeof t.pivotY?t.pivotY:this.pivot.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const K=this.localTransform,D=this._scale,a=this._pivot,G=this._position,N=D._x,W=D._y,x=a._x,b=a._y;K.a=this._cx*N,K.b=this._sx*N,K.c=this._cy*W,K.d=this._sy*W,K.tx=G._x-(x*K.a+b*K.c),K.ty=G._y-(x*K.b+b*K.d)}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=R,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const K=G.Q.shared.setValue(null!=t?t:16777215).toBgrNumber();K!==this.localColor&&(this.localColor=K,this._updateFlags|=R,this._onUpdate())}get tint(){return E.D(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=A,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(2&this.localDisplayStatus)}set visible(t){const K=t?2:0;(2&this.localDisplayStatus)!==K&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Y,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(4&this.localDisplayStatus)}set culled(t){const K=t?0:4;(4&this.localDisplayStatus)!==K&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Y,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(1&this.localDisplayStatus)}set renderable(t){const K=t?1:0;(1&this.localDisplayStatus)!==K&&(this._updateFlags|=Y,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return 7===this.localDisplayStatus&&this.groupAlpha>0}destroy(t=!1){var K;if(this.destroyed)return;let D;if(this.destroyed=!0,this.children.length&&(D=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),("boolean"==typeof t?t:null==t?void 0:t.children)&&D)for(let K=0;K<D.length;++K)D[K].destroy(t);null===(K=this.renderGroup)||void 0===K||K.destroy(),this.renderGroup=null}}L.mixin(I),L.mixin(H),L.mixin(h),L.mixin(X),L.mixin(u),L.mixin(d),L.mixin(J),L.mixin({cullArea:null,cullable:!1,cullableChildren:!0}),L.mixin(i),L.mixin(E.R)},53569:(t,K,D)=>{D.d(K,{c:()=>W});var a=D(823040),G=D(377223);const N=new a.u;class W{constructor(t=1/0,K=1/0,D=-1/0,a=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=N,this.minX=t,this.minY=K,this.maxX=D,this.maxY=a}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new G.M);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=N,this}set(t,K,D,a){this.minX=t,this.minY=K,this.maxX=D,this.maxY=a}addFrame(t,K,D,a,G){G||(G=this.matrix);const N=G.a,W=G.b,x=G.c,b=G.d,n=G.tx,e=G.ty;let i=this.minX,z=this.minY,I=this.maxX,Z=this.maxY,w=N*t+x*K+n,m=W*t+b*K+e;w<i&&(i=w),m<z&&(z=m),w>I&&(I=w),m>Z&&(Z=m),w=N*D+x*K+n,m=W*D+b*K+e,w<i&&(i=w),m<z&&(z=m),w>I&&(I=w),m>Z&&(Z=m),w=N*t+x*a+n,m=W*t+b*a+e,w<i&&(i=w),m<z&&(z=m),w>I&&(I=w),m>Z&&(Z=m),w=N*D+x*a+n,m=W*D+b*a+e,w<i&&(i=w),m<z&&(z=m),w>I&&(I=w),m>Z&&(Z=m),this.minX=i,this.minY=z,this.maxX=I,this.maxY=Z}addRect(t,K){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,K)}addBounds(t,K){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,K)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const K=this.minX,D=this.minY,a=this.maxX,G=this.maxY,{a:N,b:W,c:x,d:b,tx:n,ty:e}=t;let i=N*K+x*D+n,z=W*K+b*D+e;this.minX=i,this.minY=z,this.maxX=i,this.maxY=z,i=N*a+x*D+n,z=W*a+b*D+e,this.minX=i<this.minX?i:this.minX,this.minY=z<this.minY?z:this.minY,this.maxX=i>this.maxX?i:this.maxX,this.maxY=z>this.maxY?z:this.maxY,i=N*K+x*G+n,z=W*K+b*G+e,this.minX=i<this.minX?i:this.minX,this.minY=z<this.minY?z:this.minY,this.maxX=i>this.maxX?i:this.maxX,this.maxY=z>this.maxY?z:this.maxY,i=N*a+x*G+n,z=W*a+b*G+e,this.minX=i<this.minX?i:this.minX,this.minY=z<this.minY?z:this.minY,this.maxX=i>this.maxX?i:this.maxX,this.maxY=z>this.maxY?z:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,K,D,a){return this.minX<t&&(this.minX=t),this.maxX>K&&(this.maxX=K),this.minY<D&&(this.minY=D),this.maxY>a&&(this.maxY=a),this}pad(t,K=t){return this.minX-=t,this.maxX+=t,this.minY-=K,this.maxY+=K,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new W(this.minX,this.minY,this.maxX,this.maxY)}scale(t,K=t){return this.minX*=t,this.minY*=K,this.maxX*=t,this.maxY*=K,this}get x(){return this.minX}set x(t){const K=this.maxX-this.minX;this.minX=t,this.maxX=t+K}get y(){return this.minY}set y(t){const K=this.maxY-this.minY;this.minY=t,this.maxY=t+K}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,K,D,a){let G=this.minX,N=this.minY,W=this.maxX,x=this.maxY;a||(a=this.matrix);const b=a.a,n=a.b,e=a.c,i=a.d,z=a.tx,I=a.ty;for(let a=K;a<D;a+=2){const K=t[a],D=t[a+1],Z=b*K+e*D+z,w=n*K+i*D+I;G=Z<G?Z:G,N=w<N?w:N,W=Z>W?Z:W,x=w>x?w:x}this.minX=G,this.minY=N,this.maxX=W,this.maxY=x}containsPoint(t,K){return this.minX<=t&&this.minY<=K&&this.maxX>=t&&this.maxY>=K}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}},766816:(t,K,D)=>{D.d(K,{Ek:()=>x,fB:()=>N});var a=D(823040),G=D(687651);function N(t,K,D){let N,b;return D.clear(),t.parent?K?N=t.parent.worldTransform:(b=G.u.get().identity(),N=x(t,b)):N=a.u.IDENTITY,W(t,D,N,K),b&&G.u.return(b),D.isValid||D.set(0,0,0,0),D}function W(t,K,D,N){var x,b;if(!t.visible||!t.measurable)return;let n;N?n=t.worldTransform:(t.updateLocalTransform(),n=G.u.get(),n.appendFrom(t.localTransform,D));const e=K,i=!!t.effects.length;if(i&&(K=G.o.get().clear()),t.boundsArea)K.addRect(t.boundsArea,n);else{t.bounds&&(K.matrix=n,K.addBounds(t.bounds));for(let D=0;D<t.children.length;D++)W(t.children[D],K,n,N)}if(i){for(let D=0;D<t.effects.length;D++)null===(b=(x=t.effects[D]).addBounds)||void 0===b||b.call(x,K);e.addBounds(K,a.u.IDENTITY),G.o.return(K)}N||G.u.return(n)}function x(t,K){const D=t.parent;return D&&(x(D,K),D.updateLocalTransform(),K.append(D.localTransform)),K}},247612:(t,K,D)=>{D.d(K,{n:()=>N});var a=D(823040),G=(D(229995),D(687651));function N(t,K,D){return K.clear(),D||(D=a.u.IDENTITY),W(t,K,D,t,!0),K.isValid||K.set(0,0,0,0),K}function W(t,K,D,N,x){var b,n;let e;if(x)e=G.u.get(),e=D.copyTo(e);else{if(!t.visible||!t.measurable)return;t.updateLocalTransform();const K=t.localTransform;e=G.u.get(),e.appendFrom(K,D)}const i=K,z=!!t.effects.length;if(z&&(K=G.o.get().clear()),t.boundsArea)K.addRect(t.boundsArea,e);else{t.renderPipeId&&(K.matrix=e,K.addBounds(t.bounds));const D=t.children;for(let t=0;t<D.length;t++)W(D[t],K,e,N,!1)}if(z){for(let D=0;D<t.effects.length;D++)null===(n=(b=t.effects[D]).addLocalBounds)||void 0===n||n.call(b,K,N);i.addBounds(K,a.u.IDENTITY),G.o.return(K)}G.u.return(e)}},687651:(t,K,D)=>{D.d(K,{o:()=>x,u:()=>W});var a=D(823040),G=D(413508),N=D(53569);const W=new G.b(a.u),x=new G.b(N.c)},201903:(t,K,D)=>{D.d(K,{D:()=>W,R:()=>x});var a=D(766816),G=D(687651),N=D(542946);function W(t){return((255&t)<<16)+(65280&t)+(t>>16&255)}const x={getGlobalAlpha(t){if(t)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let K=this.alpha,D=this.parent;for(;D;)K*=D.alpha,D=D.parent;return K},getGlobalTransform(t,K){if(K)return t.copyFrom(this.worldTransform);this.updateLocalTransform();const D=a.Ek(this,G.u.get().identity());return t.appendFrom(this.localTransform,D),G.u.return(D),t},getGlobalTint(t){if(t)return this.renderGroup?W(this.renderGroup.worldColor):this.parentRenderGroup?W(N.j(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let K=this.localColor,D=this.parent;for(;D;)K=N.j(K,D.localColor),D=D.parent;return W(K)}}},120295:(t,K,D)=>{function a(t,K,D={}){for(const a in K)D[a]||void 0===K[a]||(t[a]=K[a])}D.d(K,{s:()=>a})},542946:(t,K,D)=>{D.d(K,{j:()=>N});var a=D(748621);const G=16777215;function N(t,K){return t===G?K:K===G?t:a.u(t,K)}},748621:(t,K,D)=>{function a(t,K){return 16777215!==t&&K?16777215!==K&&t?(((t>>16&255)*(K>>16&255)/255|0)<<16)+(((t>>8&255)*(K>>8&255)/255|0)<<8)+((255&t)*(255&K)/255|0):t:K}D.d(K,{u:()=>a})},625015:(t,K,D)=>{D.d(K,{G:()=>W});var a=D(823040),G=D(748621);const N=new a.u;class W{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,K=t>>16|65280&t|(255&t)<<16,D=this.renderable;return D?G.u(K,D.groupColor)+(this.alpha*D.groupAlpha*255<<24):K+(255*this.alpha<<24)}get transform(){var t;return(null===(t=this.renderable)||void 0===t?void 0:t.groupTransform)||N}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}},283863:(t,K,D)=>{D.d(K,{A:()=>W});var a=D(5319),G=D(979822),N=D(572464);class W extends G.l{constructor(t){t instanceof N.T&&(t={context:t});const{context:K,roundPixels:D,...a}=t||{};super({label:"Graphics",...a}),this.renderPipeId="graphics",this._context=K||(this._ownedContext=new N.T),this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=null!=D&&D}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):!0!==t&&!0!==(null==t?void 0:t.context)||this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,K){return this.context[t](...K),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new W(this._context.clone()):(this._ownedContext=null,new W(this._context))}lineStyle(t,K,D){a.t6(a.lj,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const G={};return t&&(G.width=t),K&&(G.color=K),D&&(G.alpha=D),this.context.strokeStyle=G,this}beginFill(t,K){a.t6(a.lj,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const D={};return t&&(D.color=t),K&&(D.alpha=K),this.context.fillStyle=D,this}endFill(){a.t6(a.lj,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return t.width===N.T.defaultStrokeStyle.width&&t.color===N.T.defaultStrokeStyle.color&&t.alpha===N.T.defaultStrokeStyle.alpha||this.context.stroke(),this}drawCircle(...t){return a.t6(a.lj,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return a.t6(a.lj,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return a.t6(a.lj,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return a.t6(a.lj,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return a.t6(a.lj,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return a.t6(a.lj,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}},572464:(t,K,D)=>{D.d(K,{T:()=>E});var a=D(610162),G=D(534661),N=D(823040),W=D(521212),x=D(177487),b=D(60158),n=D(5319),e=D(53569),i=D(943513);function z(t,K){if("string"==typeof t){const K=document.createElement("div");K.innerHTML=t.trim(),t=K.querySelector("svg")}return I(t,{context:K,path:new i.n},null,null),K}function I(t,K,D,a){const N=t.children,{fillStyle:W,strokeStyle:x}=function(t){const K=t.getAttribute("style"),D={},a={};let N=!1,W=!1;if(K){const t=K.split(";");for(let K=0;K<t.length;K++){const x=t[K],[b,n]=x.split(":");switch(b){case"stroke":"none"!==n&&(D.color=G.Q.shared.setValue(n).toNumber(),W=!0);break;case"stroke-width":D.width=Number(n);break;case"fill":"none"!==n&&(N=!0,a.color=G.Q.shared.setValue(n).toNumber());break;case"fill-opacity":a.alpha=Number(n);break;case"stroke-opacity":D.alpha=Number(n);break;case"opacity":a.alpha=Number(n),D.alpha=Number(n)}}}else{const K=t.getAttribute("stroke");K&&"none"!==K&&(W=!0,D.color=G.Q.shared.setValue(K).toNumber(),D.width=Z(t,"stroke-width",1));const x=t.getAttribute("fill");x&&"none"!==x&&(N=!0,a.color=G.Q.shared.setValue(x).toNumber())}return{strokeStyle:W?D:null,fillStyle:N?a:null}}(t);let b,n,e,z,w,m,u,d,E,l,Q,P,y,q,X,h,J;switch(W&&D?D={...D,...W}:W&&(D=W),x&&a?a={...a,...x}:x&&(a=x),K.context.fillStyle=D,K.context.strokeStyle=a,t.nodeName.toLowerCase()){case"path":q=t.getAttribute("d"),X=new i.n(q),K.context.path(X),D&&K.context.fill(),a&&K.context.stroke();break;case"circle":u=Z(t,"cx",0),d=Z(t,"cy",0),E=Z(t,"r",0),K.context.ellipse(u,d,E,E),D&&K.context.fill(),a&&K.context.stroke();break;case"rect":b=Z(t,"x",0),n=Z(t,"y",0),h=Z(t,"width",0),J=Z(t,"height",0),l=Z(t,"rx",0),Q=Z(t,"ry",0),l||Q?K.context.roundRect(b,n,h,J,l||Q):K.context.rect(b,n,h,J),D&&K.context.fill(),a&&K.context.stroke();break;case"ellipse":u=Z(t,"cx",0),d=Z(t,"cy",0),l=Z(t,"rx",0),Q=Z(t,"ry",0),K.context.beginPath(),K.context.ellipse(u,d,l,Q),D&&K.context.fill(),a&&K.context.stroke();break;case"line":e=Z(t,"x1",0),z=Z(t,"y1",0),w=Z(t,"x2",0),m=Z(t,"y2",0),K.context.beginPath(),K.context.moveTo(e,z),K.context.lineTo(w,m),a&&K.context.stroke();break;case"polygon":y=t.getAttribute("points"),P=y.match(/\d+/g).map((t=>parseInt(t,10))),K.context.poly(P,!0),D&&K.context.fill(),a&&K.context.stroke();break;case"polyline":y=t.getAttribute("points"),P=y.match(/\d+/g).map((t=>parseInt(t,10))),K.context.poly(P,!1),a&&K.context.stroke();break;case"g":case"svg":break;default:console.info(`[SVG parser] <${t.nodeName}> elements unsupported`)}for(let t=0;t<N.length;t++)I(N[t],K,D,a)}function Z(t,K,D){const a=t.getAttribute(K);return a?Number(a):D}var w=D(867659);const m=new W.b,u=new N.u,d=class t extends a.A{constructor(){super(...arguments),this.uid=b.L("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new i.n,this._transform=new N.u,this._fillStyle={...t.defaultFillStyle},this._strokeStyle={...t.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new e.c,this._boundsDirty=!0}clone(){const K=new t;return K.batchMode=this.batchMode,K.instructions=this.instructions.slice(),K._activePath=this._activePath.clone(),K._transform=this._transform.clone(),K._fillStyle={...this._fillStyle},K._strokeStyle={...this._strokeStyle},K._stateStack=this._stateStack.slice(),K._bounds=this._bounds.clone(),K._boundsDirty=!0,K}get fillStyle(){return this._fillStyle}set fillStyle(K){this._fillStyle=w.w(K,t.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(K){this._strokeStyle=w.T(K,t.defaultStrokeStyle)}setFillStyle(K){return this._fillStyle=w.w(K,t.defaultFillStyle),this}setStrokeStyle(K){return this._strokeStyle=w.w(K,t.defaultStrokeStyle),this}texture(t,K,D,a,N,W){return this.instructions.push({action:"texture",data:{image:t,dx:D||0,dy:a||0,dw:N||t.frame.width,dh:W||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:K?G.Q.shared.setValue(K).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new i.n,this}fill(K,D){let a;const G=this.instructions[this.instructions.length-1];return a=0===this._tick&&G&&"stroke"===G.action?G.data.path:this._activePath.clone(),a?(null!=K&&(void 0!==D&&"number"==typeof K&&(n.t6(n.lj,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),K={color:K,alpha:D}),this._fillStyle=w.w(K,t.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:a}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:K}=this._activePath.getLastPoint(W.b.shared);this._activePath.clear(),this._activePath.moveTo(t,K)}stroke(K){let D;const a=this.instructions[this.instructions.length-1];return D=0===this._tick&&a&&"fill"===a.action?a.data.path:this._activePath.clone(),D?(null!=K&&(this._strokeStyle=w.T(K,t.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:D}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const K=this.instructions[this.instructions.length-1-t],D=this._activePath.clone();if(K&&("stroke"===K.action||"fill"===K.action)){if(!K.data.hole){K.data.hole=D;break}K.data.hole.addPath(D)}}return this._initNextPathLocation(),this}arc(t,K,D,a,G,N){this._tick++;const W=this._transform;return this._activePath.arc(W.a*t+W.c*K+W.tx,W.b*t+W.d*K+W.ty,D,a,G,N),this}arcTo(t,K,D,a,G){this._tick++;const N=this._transform;return this._activePath.arcTo(N.a*t+N.c*K+N.tx,N.b*t+N.d*K+N.ty,N.a*D+N.c*a+N.tx,N.b*D+N.d*a+N.ty,G),this}arcToSvg(t,K,D,a,G,N,W){this._tick++;const x=this._transform;return this._activePath.arcToSvg(t,K,D,a,G,x.a*N+x.c*W+x.tx,x.b*N+x.d*W+x.ty),this}bezierCurveTo(t,K,D,a,G,N,W){this._tick++;const x=this._transform;return this._activePath.bezierCurveTo(x.a*t+x.c*K+x.tx,x.b*t+x.d*K+x.ty,x.a*D+x.c*a+x.tx,x.b*D+x.d*a+x.ty,x.a*G+x.c*N+x.tx,x.b*G+x.d*N+x.ty,W),this}closePath(){var t;return this._tick++,null===(t=this._activePath)||void 0===t||t.closePath(),this}ellipse(t,K,D,a){return this._tick++,this._activePath.ellipse(t,K,D,a,this._transform.clone()),this}circle(t,K,D){return this._tick++,this._activePath.circle(t,K,D,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,K){this._tick++;const D=this._transform;return this._activePath.lineTo(D.a*t+D.c*K+D.tx,D.b*t+D.d*K+D.ty),this}moveTo(t,K){this._tick++;const D=this._transform,a=this._activePath.instructions,G=D.a*t+D.c*K+D.tx,N=D.b*t+D.d*K+D.ty;return 1===a.length&&"moveTo"===a[0].action?(a[0].data[0]=G,a[0].data[1]=N,this):(this._activePath.moveTo(G,N),this)}quadraticCurveTo(t,K,D,a,G){this._tick++;const N=this._transform;return this._activePath.quadraticCurveTo(N.a*t+N.c*K+N.tx,N.b*t+N.d*K+N.ty,N.a*D+N.c*a+N.tx,N.b*D+N.d*a+N.ty,G),this}rect(t,K,D,a){return this._tick++,this._activePath.rect(t,K,D,a,this._transform.clone()),this}roundRect(t,K,D,a,G){return this._tick++,this._activePath.roundRect(t,K,D,a,G,this._transform.clone()),this}poly(t,K){return this._tick++,this._activePath.poly(t,K,this._transform.clone()),this}regularPoly(t,K,D,a,G=0,N){return this._tick++,this._activePath.regularPoly(t,K,D,a,G,N),this}roundPoly(t,K,D,a,G,N){return this._tick++,this._activePath.roundPoly(t,K,D,a,G,N),this}roundShape(t,K,D,a){return this._tick++,this._activePath.roundShape(t,K,D,a),this}filletRect(t,K,D,a,G){return this._tick++,this._activePath.filletRect(t,K,D,a,G),this}chamferRect(t,K,D,a,G,N){return this._tick++,this._activePath.chamferRect(t,K,D,a,G,N),this}star(t,K,D,a,G=0,N=0){return this._tick++,this._activePath.star(t,K,D,a,G,N,this._transform.clone()),this}svg(t){return this._tick++,z(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,K=t){return this._transform.scale(t,K),this}setTransform(t,K,D,a,G,W){return t instanceof N.u?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,K,D,a,G,W),this)}transform(t,K,D,a,G,W){return t instanceof N.u?(this._transform.append(t),this):(u.set(t,K,D,a,G,W),this._transform.append(u),this)}translate(t,K=t){return this._transform.translate(t,K),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let K=0;K<this.instructions.length;K++){const D=this.instructions[K],a=D.action;if("fill"===a){const K=D.data;t.addBounds(K.path.bounds)}else if("texture"===a){const K=D.data;t.addFrame(K.dx,K.dy,K.dx+K.dw,K.dy+K.dh,K.transform)}if("stroke"===a){const K=D.data,a=K.style.alignment,G=K.style.width*(1-a),N=K.path.bounds;t.addFrame(N.minX-G,N.minY-G,N.maxX+G,N.maxY+G)}}return t}containsPoint(t){var K;if(!this.bounds.containsPoint(t.x,t.y))return!1;const D=this.instructions;let a=!1;for(let G=0;G<D.length;G++){const N=D[G],W=N.data,x=W.path;if(!N.action||!x)continue;const b=W.style,n=x.shapePath.shapePrimitives;for(let D=0;D<n.length;D++){const G=n[D].shape;if(!b||!G)continue;const x=n[D].transform,e=x?x.applyInverse(t,m):t;a="fill"===N.action?G.contains(e.x,e.y):G.strokeContains(e.x,e.y,b.width);const i=W.hole;if(i){const t=null===(K=i.shapePath)||void 0===K?void 0:K.shapePrimitives;if(t)for(let K=0;K<t.length;K++)t[K].shape.contains(e.x,e.y)&&(a=!1)}if(a)return!0}}return a}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),"boolean"==typeof t?t:null==t?void 0:t.texture){const K="boolean"==typeof t?t:null==t?void 0:t.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(K),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(K)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};d.defaultFillStyle={color:16777215,alpha:1,texture:x.g.WHITE,matrix:null,fill:null},d.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:x.g.WHITE,matrix:null,fill:null,pixelLine:!1};let E=d},72318:(t,K,D)=>{D.d(K,{GH:()=>V});var a=D(992178),G=D(271502),N=D(519401),W=D(807039),x=D(5319),b=D(721013),n=D(377223);function e(t,K,D,a,G){const N=K.a,W=K.b,x=K.c,b=K.d,n=K.tx,e=K.ty;D=D||0,a=a||2,G=G||t.length/a-D;let i=D*a;for(let K=0;K<G;K++){const K=t[i],D=t[i+1];t[i]=N*K+x*D+n,t[i+1]=W*K+b*D+e,i+=a}}var i=D(177487),z=D(625015);const I={extension:{type:a.Ag.ShapeBuilder,name:"circle"},build(t,K){let D,a,G,N,W,x;if("circle"===t.type){const K=t;D=K.x,a=K.y,W=x=K.radius,G=N=0}else if("ellipse"===t.type){const K=t;D=K.x,a=K.y,W=K.halfWidth,x=K.halfHeight,G=N=0}else{const K=t,b=K.width/2,n=K.height/2;D=K.x+b,a=K.y+n,W=x=Math.max(0,Math.min(K.radius,Math.min(b,n))),G=b-W,N=n-x}if(!(W>=0&&x>=0&&G>=0&&N>=0))return K;const b=Math.ceil(2.3*Math.sqrt(W+x)),n=8*b+(G?4:0)+(N?4:0);if(0===n)return K;if(0===b)return K[0]=K[6]=D+G,K[1]=K[3]=a+N,K[2]=K[4]=D-G,K[5]=K[7]=a-N,K;let e=0,i=4*b+(G?2:0)+2,z=i,I=n,Z=G+W,w=N,m=D+Z,u=D-Z,d=a+w;if(K[e++]=m,K[e++]=d,K[--i]=d,K[--i]=u,N){const t=a-w;K[z++]=u,K[z++]=t,K[--I]=t,K[--I]=m}for(let t=1;t<b;t++){const n=Math.PI/2*(t/b),Z=G+Math.cos(n)*W,w=N+Math.sin(n)*x,m=D+Z,u=D-Z,d=a+w,E=a-w;K[e++]=m,K[e++]=d,K[--i]=d,K[--i]=u,K[z++]=u,K[z++]=E,K[--I]=E,K[--I]=m}Z=G,w=N+x,m=D+Z,u=D-Z,d=a+w;const E=a-w;return K[e++]=m,K[e++]=d,K[--I]=E,K[--I]=m,G&&(K[e++]=u,K[e++]=d,K[--I]=E,K[--I]=u),K},triangulate(t,K,D,a,G,N){if(0===t.length)return;let W=0,x=0;for(let K=0;K<t.length;K+=2)W+=t[K],x+=t[K+1];W/=t.length/2,x/=t.length/2;let b=a;K[b*D]=W,K[b*D+1]=x;const n=b++;for(let a=0;a<t.length;a+=2)K[b*D]=t[a],K[b*D+1]=t[a+1],a>0&&(G[N++]=b,G[N++]=n,G[N++]=b-1),b++;G[N++]=n+1,G[N++]=n,G[N++]=b-1}},Z={...I,extension:{...I.extension,name:"ellipse"}},w={...I,extension:{...I.extension,name:"roundedRectangle"}};var m=D(521212);const u=1e-4,d=1e-4;function E(t,K,D,a,G,N,W,x){let b,n;W?(b=a,n=-D):(b=-a,n=D);const e=t-D*G+b,i=K-a*G+n,z=t+D*N+b,I=K+a*N+n;return x.push(e,i),x.push(z,I),2}function l(t,K,D,a,G,N,W,x){const b=D-t,n=a-K;let e=Math.atan2(b,n),i=Math.atan2(G-t,N-K);x&&e<i?e+=2*Math.PI:!x&&e>i&&(i+=2*Math.PI);let z=e;const I=i-e,Z=Math.abs(I),w=Math.sqrt(b*b+n*n),m=(15*Z*Math.sqrt(w)/Math.PI>>0)+1,u=I/m;if(z+=u,x){W.push(t,K),W.push(D,a);for(let D=1,a=z;D<m;D++,a+=u)W.push(t,K),W.push(t+Math.sin(a)*w,K+Math.cos(a)*w);W.push(t,K),W.push(G,N)}else{W.push(D,a),W.push(t,K);for(let D=1,a=z;D<m;D++,a+=u)W.push(t+Math.sin(a)*w,K+Math.cos(a)*w),W.push(t,K);W.push(G,N),W.push(t,K)}return 2*m}var Q=D(114712);function P(t,K,D,a,G,N,W){const x=Q(t,K,2);if(!x)return;for(let t=0;t<x.length;t+=3)N[W++]=x[t]+G,N[W++]=x[t+1]+G,N[W++]=x[t+2]+G;let b=G*a;for(let K=0;K<t.length;K+=2)D[b]=t[K],D[b+1]=t[K+1],b+=a}const y=[],q={extension:{type:a.Ag.ShapeBuilder,name:"polygon"},build(t,K){for(let D=0;D<t.points.length;D++)K[D]=t.points[D];return K},triangulate(t,K,D,a,G,N){P(t,y,K,D,a,G,N)}},X={extension:{type:a.Ag.ShapeBuilder,name:"rectangle"},build(t,K){const D=t,a=D.x,G=D.y,N=D.width,W=D.height;return N>=0&&W>=0?(K[0]=a,K[1]=G,K[2]=a+N,K[3]=G,K[4]=a+N,K[5]=G+W,K[6]=a,K[7]=G+W,K):K},triangulate(t,K,D,a,G,N){let W=0;K[(a*=D)+W]=t[0],K[a+W+1]=t[1],W+=D,K[a+W]=t[2],K[a+W+1]=t[3],W+=D,K[a+W]=t[6],K[a+W+1]=t[7],W+=D,K[a+W]=t[4],K[a+W+1]=t[5],W+=D;const x=a/D;G[N++]=x,G[N++]=x+1,G[N++]=x+2,G[N++]=x+1,G[N++]=x+3,G[N++]=x+2}},h={extension:{type:a.Ag.ShapeBuilder,name:"triangle"},build:(t,K)=>(K[0]=t.x,K[1]=t.y,K[2]=t.x2,K[3]=t.y2,K[4]=t.x3,K[5]=t.y3,K),triangulate(t,K,D,a,G,N){let W=0;K[(a*=D)+W]=t[0],K[a+W+1]=t[1],W+=D,K[a+W]=t[2],K[a+W+1]=t[3],W+=D,K[a+W]=t[4],K[a+W+1]=t[5];const x=a/D;G[N++]=x,G[N++]=x+1,G[N++]=x+2}},J={};a.XO.handleByMap(a.Ag.ShapeBuilder,J),a.XO.add(X,q,h,I,Z,w);const T=new n.M;function _(t,K,D){const{vertices:a,uvs:G,indices:N}=D,W=N.length,x=a.length/2,n=[],i=J.rectangle,I=T,Z=t.image;I.x=t.dx,I.y=t.dy,I.width=t.dw,I.height=t.dh;const w=t.transform;i.build(I,n),w&&e(n,w),i.triangulate(n,a,2,x,N,W);const m=Z.uvs;G.push(m.x0,m.y0,m.x1,m.y1,m.x3,m.y3,m.x2,m.y2);const u=b.Z.get(z.G);u.indexOffset=W,u.indexSize=N.length-W,u.attributeOffset=x,u.attributeSize=a.length/2-x,u.baseColor=t.style,u.alpha=t.alpha,u.texture=Z,u.geometryData=D,K.push(u)}function C(t,K,D,a,G,N){const{vertices:W,uvs:x,indices:n}=N,I=t.shapePrimitives.length-1;t.shapePrimitives.forEach((({shape:t,transform:Z},w)=>{var Q;const y=n.length,q=W.length/2,X=[],h=J[t.type];let T="triangle-list";if(h.build(t,X),Z&&e(X,Z),a){const D=null===(Q=t.closePath)||void 0===Q||Q,a=K;a.pixelLine?(function(t,K,D,a){const G=u;if(0===t.length)return;const N=t[0],W=t[1],x=t[t.length-2],b=t[t.length-1],n=K||Math.abs(N-x)<G&&Math.abs(W-b)<G,e=D,i=t.length/2,z=e.length/2;for(let K=0;K<i;K++)e.push(t[2*K]),e.push(t[2*K+1]);for(let t=0;t<i-1;t++)a.push(z+t,z+t+1);n&&a.push(z+i-1,z)}(X,D,W,n),T="line-list"):function(t,K,D,a,G,N){const W=u;if(0===t.length)return;const x=K;let b=x.alignment;if(.5!==K.alignment){let K=function(t){const K=t.length;if(K<6)return 1;let D=0;for(let a=0,G=t[K-2],N=t[K-1];a<K;a+=2){const K=t[a],W=t[a+1];D+=(K-G)*(W+N),G=K,N=W}return D<0?-1:1}(t);!1&&(K*=-1),b=(b-.5)*K+.5}const n=new m.b(t[0],t[1]),e=new m.b(t[t.length-2],t[t.length-1]),i=a,z=Math.abs(n.x-e.x)<W&&Math.abs(n.y-e.y)<W;if(i){t=t.slice(),z&&(t.pop(),t.pop(),e.set(t[t.length-2],t[t.length-1]));const K=.5*(n.x+e.x),D=.5*(e.y+n.y);t.unshift(K,D),t.push(K,D)}const I=G,Z=t.length/2;let w=t.length;const Q=I.length/2,P=x.width/2,y=P*P,q=x.miterLimit*x.miterLimit;let X=t[0],h=t[1],J=t[2],T=t[3],_=0,C=0,H=-(h-T),o=X-J,U=0,V=0,s=Math.sqrt(H*H+o*o);H/=s,o/=s,H*=P,o*=P;const F=2*(1-b),c=2*b;i||("round"===x.cap?w+=l(X-H*(F-c)*.5,h-o*(F-c)*.5,X-H*F,h-o*F,X+H*c,h+o*c,I,!0)+2:"square"===x.cap&&(w+=E(X,h,H,o,F,c,!0,I))),I.push(X-H*F,h-o*F),I.push(X+H*c,h+o*c);for(let K=1;K<Z-1;++K){X=t[2*(K-1)],h=t[2*(K-1)+1],J=t[2*K],T=t[2*K+1],_=t[2*(K+1)],C=t[2*(K+1)+1],H=-(h-T),o=X-J,s=Math.sqrt(H*H+o*o),H/=s,o/=s,H*=P,o*=P,U=-(T-C),V=J-_,s=Math.sqrt(U*U+V*V),U/=s,V/=s,U*=P,V*=P;const D=J-X,a=h-T,G=J-_,N=C-T,W=D*G+a*N,b=a*G-N*D,n=b<0;if(Math.abs(b)<.001*Math.abs(W)){I.push(J-H*F,T-o*F),I.push(J+H*c,T+o*c),W>=0&&("round"===x.join?w+=l(J,T,J-H*F,T-o*F,J-U*F,T-V*F,I,!1)+4:w+=2,I.push(J-U*c,T-V*c),I.push(J+U*F,T+V*F));continue}const e=(-H+X)*(-o+T)-(-H+J)*(-o+h),i=(-U+_)*(-V+T)-(-U+J)*(-V+C),z=(D*i-G*e)/b,Z=(N*e-a*i)/b,m=(z-J)*(z-J)+(Z-T)*(Z-T),u=J+(z-J)*F,d=T+(Z-T)*F,E=J-(z-J)*c,Q=T-(Z-T)*c,g=n?F:c;m<=Math.min(D*D+a*a,G*G+N*N)+g*g*y?"bevel"===x.join||m/y>q?(n?(I.push(u,d),I.push(J+H*c,T+o*c),I.push(u,d),I.push(J+U*c,T+V*c)):(I.push(J-H*F,T-o*F),I.push(E,Q),I.push(J-U*F,T-V*F),I.push(E,Q)),w+=2):"round"===x.join?n?(I.push(u,d),I.push(J+H*c,T+o*c),w+=l(J,T,J+H*c,T+o*c,J+U*c,T+V*c,I,!0)+4,I.push(u,d),I.push(J+U*c,T+V*c)):(I.push(J-H*F,T-o*F),I.push(E,Q),w+=l(J,T,J-H*F,T-o*F,J-U*F,T-V*F,I,!1)+4,I.push(J-U*F,T-V*F),I.push(E,Q)):(I.push(u,d),I.push(E,Q)):(I.push(J-H*F,T-o*F),I.push(J+H*c,T+o*c),"round"===x.join?w+=n?l(J,T,J+H*c,T+o*c,J+U*c,T+V*c,I,!0)+2:l(J,T,J-H*F,T-o*F,J-U*F,T-V*F,I,!1)+2:"miter"===x.join&&m/y<=q&&(n?(I.push(E,Q),I.push(E,Q)):(I.push(u,d),I.push(u,d)),w+=2),I.push(J-U*F,T-V*F),I.push(J+U*c,T+V*c),w+=2)}X=t[2*(Z-2)],h=t[2*(Z-2)+1],J=t[2*(Z-1)],T=t[2*(Z-1)+1],H=-(h-T),o=X-J,s=Math.sqrt(H*H+o*o),H/=s,o/=s,H*=P,o*=P,I.push(J-H*F,T-o*F),I.push(J+H*c,T+o*c),i||("round"===x.cap?w+=l(J-H*(F-c)*.5,T-o*(F-c)*.5,J-H*F,T-o*F,J+H*c,T+o*c,I,!1)+2:"square"===x.cap&&(w+=E(J,T,H,o,F,c,!1,I)));const g=d*d;for(let t=Q;t<w+Q-2;++t)X=I[2*t],h=I[2*t+1],J=I[2*(t+1)],T=I[2*(t+1)+1],_=I[2*(t+2)],C=I[2*(t+2)+1],Math.abs(X*(T-C)+J*(C-h)+_*(h-T))<g||N.push(t,t+1,t+2)}(X,a,0,D,W,n)}else if(D&&I===w){0!==I&&console.warn("[Pixi Graphics] only the last shape have be cut out");const t=[],K=X.slice(),a=function(t){if(!t)return[];const K=t.shapePrimitives,D=[];for(let t=0;t<K.length;t++){const a=K[t].shape,G=[];J[a.type].build(a,G),D.push(G)}return D}(D.shapePath);a.forEach((D=>{t.push(K.length/2),K.push(...D)})),P(K,t,W,2,q,n,y)}else h.triangulate(X,W,2,q,n,y);const _=x.length/2,C=K.texture;if(C!==i.g.WHITE){const t=K.matrix;t&&(Z&&t.append(Z.clone().invert()),function(t,K,D,a,G,N,W,x=null){let b=0;D*=K,G*=N;const n=x.a,e=x.b,i=x.c,z=x.d,I=x.tx,Z=x.ty;for(;b<W;){const W=t[D],x=t[D+1];a[G]=n*W+i*x+I,a[G+1]=e*W+z*x+Z,G+=N,D+=K,b++}}(W,2,q,x,_,2,W.length/2-q,t))}else(function(t,K,D,a){let G=0;for(K*=D;G<a;)t[K]=0,t[K+1]=0,K+=D,G++})(x,_,2,W.length/2-q);const H=b.Z.get(z.G);H.indexOffset=y,H.indexSize=n.length-y,H.attributeOffset=q,H.attributeSize=W.length/2-q,H.baseColor=K.color,H.alpha=K.alpha,H.texture=C,H.geometryData=N,H.topology=T,G.push(H)}))}class H{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class o{constructor(){this.batcher=new N.J,this.instructions=new W.L}init(){this.instructions.reset()}get geometry(){return x.t6(x.Ek,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const U=class t{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(K){var D;t.defaultOptions.bezierSmoothness=null!==(D=null==K?void 0:K.bezierSmoothness)&&void 0!==D?D:t.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let K=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){K?this._cleanGraphicsContextData(t):K=this._initContext(t),function(t,K){const{geometryData:D,batches:a}=K;a.length=0,D.indices.length=0,D.vertices.length=0,D.uvs.length=0;for(let K=0;K<t.instructions.length;K++){const G=t.instructions[K];if("texture"===G.action)_(G.data,a,D);else if("fill"===G.action||"stroke"===G.action){const t="stroke"===G.action,K=G.data.path.shapePath,N=G.data.style,W=G.data.hole;t&&W&&C(W.shapePath,N,null,!0,a,D),C(K,N,W,t,a,D)}}}(t,K);const D=t.batchMode;t.customShader||"no-batch"===D?K.isBatchable=!1:"auto"===D&&(K.isBatchable=K.geometryData.vertices.length<400),t.dirty=!1}return K}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const K=b.Z.get(o),{batches:D,geometryData:a}=this._gpuContextHash[t.uid],N=a.vertices.length,W=a.indices.length;for(let t=0;t<D.length;t++)D[t].applyTransform=!1;const x=K.batcher;x.ensureAttributeBuffer(N),x.ensureIndexBuffer(W),x.begin();for(let t=0;t<D.length;t++){const K=D[t];x.add(K)}x.finish(K.instructions);const n=x.geometry;n.indexBuffer.setDataWithSize(x.indexBuffer,x.indexSize,!0),n.buffers[0].setDataWithSize(x.attributeBuffer.float32View,x.attributeSize,!0);const e=x.batches;for(let t=0;t<e.length;t++){const K=e[t];K.bindGroup=G.w(K.textures.textures,K.textures.count)}return this._graphicsDataContextHash[t.uid]=K,K}_initContext(t){const K=new H;return K.context=t,this._gpuContextHash[t.uid]=K,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const K=this._gpuContextHash[t.uid];K.isBatchable||this._graphicsDataContextHash[t.uid]&&(b.Z.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),K.batches&&K.batches.forEach((t=>{b.Z.return(t)}))}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};U.extension={type:[a.Ag.WebGLSystem,a.Ag.WebGPUSystem,a.Ag.CanvasSystem],name:"graphicsContext"},U.defaultOptions={bezierSmoothness:.5};let V=U},387473:(t,K,D)=>{D.d(K,{_:()=>e});var a=D(534661),G=D(505777),N=D(823040),W=D(408078),x=D(177487),b=D(60158);const n=class t{constructor(t,K,D,a){this.uid=b.L("fillGradient"),this.type="linear",this.gradientStops=[],this._styleKey=null,this.x0=t,this.y0=K,this.x1=D,this.y1=a}addColorStop(t,K){return this.gradientStops.push({offset:t,color:a.Q.shared.setValue(K).toRgbaString()}),this._styleKey=null,this}buildLinearGradient(){if(this.texture)return;const K=t.defaultTextureSize,{gradientStops:D}=this,a=G.e.get().createCanvas();a.width=K,a.height=K;const b=a.getContext("2d"),n=b.createLinearGradient(0,0,t.defaultTextureSize,1);for(let t=0;t<D.length;t++){const K=D[t];n.addColorStop(K.offset,K.color)}b.fillStyle=n,b.fillRect(0,0,K,K),this.texture=new x.g({source:new W.b({resource:a,addressModeU:"clamp-to-edge",addressModeV:"repeat"})});const{x0:e,y0:i,x1:z,y1:I}=this,Z=new N.u,w=z-e,m=I-i,u=Math.sqrt(w*w+m*m),d=Math.atan2(m,w);Z.translate(-e,-i),Z.scale(1/K,1/K),Z.rotate(-d),Z.scale(256/u,1),this.transform=Z,this._styleKey=null}get styleKey(){if(this._styleKey)return this._styleKey;const t=this.gradientStops.map((t=>`${t.offset}-${t.color}`)).join("-"),K=this.texture.uid,D=this.transform.toArray().join("-");return`fill-gradient-${this.uid}-${t}-${K}-${D}-${this.x0}-${this.y0}-${this.x1}-${this.y1}`}};n.defaultTextureSize=256;let e=n},315725:(t,K,D)=>{D.d(K,{m:()=>W});var a=D(823040),G=D(60158);const N={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class W{constructor(t,K){this.uid=G.L("fillPattern"),this.transform=new a.u,this._styleKey=null,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),K&&(t.source.style.addressModeU=N[K].addressModeU,t.source.style.addressModeV=N[K].addressModeV)}setTransform(t){const K=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/K.frame.width,1/K.frame.height),this._styleKey=null}get styleKey(){return this._styleKey||(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`),this._styleKey}}},943513:(t,K,D)=>{D.d(K,{n:()=>R});var a=D(521212),G=D(60158),N=D(229995),W=D(379303),x=D(377223);class b{constructor(t=0,K=0,D=0){this.type="circle",this.x=t,this.y=K,this.radius=D}clone(){return new b(this.x,this.y,this.radius)}contains(t,K){if(this.radius<=0)return!1;const D=this.radius*this.radius;let a=this.x-t,G=this.y-K;return a*=a,G*=G,a+G<=D}strokeContains(t,K,D){if(0===this.radius)return!1;const a=this.x-t,G=this.y-K,N=this.radius,W=D/2,x=Math.sqrt(a*a+G*G);return x<N+W&&x>N-W}getBounds(t){return(t=t||new x.M).x=this.x-this.radius,t.y=this.y-this.radius,t.width=2*this.radius,t.height=2*this.radius,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class n{constructor(t=0,K=0,D=0,a=0){this.type="ellipse",this.x=t,this.y=K,this.halfWidth=D,this.halfHeight=a}clone(){return new n(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,K){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let D=(t-this.x)/this.halfWidth,a=(K-this.y)/this.halfHeight;return D*=D,a*=a,D+a<=1}strokeContains(t,K,D){const{halfWidth:a,halfHeight:G}=this;if(a<=0||G<=0)return!1;const N=D/2,W=a-N,x=G-N,b=a+N,n=G+N,e=t-this.x,i=K-this.y;return e*e/(W*W)+i*i/(x*x)>1&&e*e/(b*b)+i*i/(n*n)<=1}getBounds(t){return(t=t||new x.M).x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=2*this.halfWidth,t.height=2*this.halfHeight,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function e(t,K,D,a,G,N){const W=G-D,x=N-a,b=W*W+x*x;let n,e,i=-1;0!==b&&(i=((t-D)*W+(K-a)*x)/b),i<0?(n=D,e=a):i>1?(n=G,e=N):(n=D+i*W,e=a+i*x);const z=t-n,I=K-e;return z*z+I*I}class i{constructor(...t){this.type="polygon";let K=Array.isArray(t[0])?t[0]:t;if("number"!=typeof K[0]){const t=[];for(let D=0,a=K.length;D<a;D++)t.push(K[D].x,K[D].y);K=t}this.points=K,this.closePath=!0}clone(){const t=this.points.slice(),K=new i(t);return K.closePath=this.closePath,K}contains(t,K){let D=!1;const a=this.points.length/2;for(let G=0,N=a-1;G<a;N=G++){const a=this.points[2*G],W=this.points[2*G+1],x=this.points[2*N],b=this.points[2*N+1];W>K!=b>K&&t<(x-a)*((K-W)/(b-W))+a&&(D=!D)}return D}strokeContains(t,K,D){const a=D/2,G=a*a,{points:N}=this,W=N.length-(this.closePath?0:2);for(let D=0;D<W;D+=2)if(e(t,K,N[D],N[D+1],N[(D+2)%N.length],N[(D+3)%N.length])<=G)return!0;return!1}getBounds(t){t=t||new x.M;const K=this.points;let D=1/0,a=-1/0,G=1/0,N=-1/0;for(let t=0,W=K.length;t<W;t+=2){const W=K[t],x=K[t+1];D=W<D?W:D,a=W>a?W:a,G=x<G?x:G,N=x>N?x:N}return t.x=D,t.width=a-D,t.y=G,t.height=N-G,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce(((t,K)=>`${t}, ${K}`),"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const z=(t,K,D,a,G,N)=>{const W=t-D,x=K-a,b=Math.sqrt(W*W+x*x);return b>=G-N&&b<=G+N};class I{constructor(t=0,K=0,D=0,a=0,G=20){this.type="roundedRectangle",this.x=t,this.y=K,this.width=D,this.height=a,this.radius=G}getBounds(t){return(t=t||new x.M).x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new I(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,K){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&K>=this.y&&K<=this.y+this.height){const D=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(K>=this.y+D&&K<=this.y+this.height-D||t>=this.x+D&&t<=this.x+this.width-D)return!0;let a=t-(this.x+D),G=K-(this.y+D);const N=D*D;if(a*a+G*G<=N)return!0;if(a=t-(this.x+this.width-D),a*a+G*G<=N)return!0;if(G=K-(this.y+this.height-D),a*a+G*G<=N)return!0;if(a=t-(this.x+D),a*a+G*G<=N)return!0}return!1}strokeContains(t,K,D){const{x:a,y:G,width:N,height:W,radius:x}=this,b=D/2,n=a+x,e=G+x,i=a+N,I=G+W;return(t>=a-b&&t<=a+b||t>=i-b&&t<=i+b)&&K>=e&&K<=e+(W-2*x)||(K>=G-b&&K<=G+b||K>=I-b&&K<=I+b)&&t>=n&&t<=n+(N-2*x)||t<n&&K<e&&z(t,K,n,e,x,b)||t>i-x&&K<e&&z(t,K,i-x,e,x,b)||t>i-x&&K>I-x&&z(t,K,i-x,I-x,x,b)||t<n&&K>I-x&&z(t,K,n,I-x,x,b)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}var Z=D(53569),w=D(72318);const m=8,u=1.1920929e-7,d=1,E=.01,l=0,Q=0;function P(t,K,D,a,G,N,W,x,b,n){const e=Math.min(.99,Math.max(0,null!=n?n:w.GH.defaultOptions.bezierSmoothness));let i=(d-e)/1;return i*=i,function(t,K,D,a,G,N,W,x,b,n){y(t,K,D,a,G,N,W,x,b,n,0),b.push(W,x)}(K,D,a,G,N,W,x,b,t,i),t}function y(t,K,D,a,G,N,W,x,b,n,e){if(e>m)return;const i=Math.PI,z=(t+D)/2,I=(K+a)/2,Z=(D+G)/2,w=(a+N)/2,d=(G+W)/2,P=(N+x)/2,q=(z+Z)/2,X=(I+w)/2,h=(Z+d)/2,J=(w+P)/2,T=(q+h)/2,_=(X+J)/2;if(e>0){let e=W-t,z=x-K;const I=Math.abs((D-W)*z-(a-x)*e),Z=Math.abs((G-W)*z-(N-x)*e);let w,m;if(I>u&&Z>u){if((I+Z)*(I+Z)<=n*(e*e+z*z)){if(l<E)return void b.push(T,_);const n=Math.atan2(N-a,G-D);if(w=Math.abs(n-Math.atan2(a-K,D-t)),m=Math.abs(Math.atan2(x-N,W-G)-n),w>=i&&(w=2*i-w),m>=i&&(m=2*i-m),w+m<l)return void b.push(T,_);if(0!==Q){if(w>Q)return void b.push(D,a);if(m>Q)return void b.push(G,N)}}}else if(I>u){if(I*I<=n*(e*e+z*z)){if(l<E)return void b.push(T,_);if(w=Math.abs(Math.atan2(N-a,G-D)-Math.atan2(a-K,D-t)),w>=i&&(w=2*i-w),w<l)return b.push(D,a),void b.push(G,N);if(0!==Q&&w>Q)return void b.push(D,a)}}else if(Z>u){if(Z*Z<=n*(e*e+z*z)){if(l<E)return void b.push(T,_);if(w=Math.abs(Math.atan2(x-N,W-G)-Math.atan2(N-a,G-D)),w>=i&&(w=2*i-w),w<l)return b.push(D,a),void b.push(G,N);if(0!==Q&&w>Q)return void b.push(G,N)}}else if(e=T-(t+W)/2,z=_-(K+x)/2,e*e+z*z<=n)return void b.push(T,_)}y(t,K,z,I,q,X,T,_,b,n,e+1),y(T,_,h,J,d,P,W,x,b,n,e+1)}const q=8,X=1.1920929e-7,h=1,J=.01,T=0;function _(t,K,D,a,G,N,W,x){const b=Math.min(.99,Math.max(0,null!=x?x:w.GH.defaultOptions.bezierSmoothness));let n=(h-b)/1;return n*=n,function(t,K,D,a,G,N,W,x){C(W,t,K,D,a,G,N,x,0),W.push(G,N)}(K,D,a,G,N,W,t,n),t}function C(t,K,D,a,G,N,W,x,b){if(b>q)return;const n=Math.PI,e=(K+a)/2,i=(D+G)/2,z=(a+N)/2,I=(G+W)/2,Z=(e+z)/2,w=(i+I)/2;let m=N-K,u=W-D;const d=Math.abs((a-N)*u-(G-W)*m);if(d>X){if(d*d<=x*(m*m+u*u)){if(T<J)return void t.push(Z,w);let x=Math.abs(Math.atan2(W-G,N-a)-Math.atan2(G-D,a-K));if(x>=n&&(x=2*n-x),x<T)return void t.push(Z,w)}}else if(m=Z-(K+N)/2,u=w-(D+W)/2,m*m+u*u<=x)return void t.push(Z,w);C(t,K,D,e,i,Z,w,x,b+1),C(t,Z,w,z,I,N,W,x,b+1)}function H(t,K,D,a,G,N,W,x){let b=Math.abs(G-N);(!W&&G>N||W&&N>G)&&(b=2*Math.PI-b),x=x||Math.max(6,Math.floor(6*Math.pow(a,1/3)*(b/Math.PI)));let n=b/(x=Math.max(x,3)),e=G;n*=W?-1:1;for(let G=0;G<x+1;G++){const G=K+Math.cos(e)*a,N=D+Math.sin(e)*a;t.push(G,N),e+=n}}const o=2*Math.PI,U={centerX:0,centerY:0,ang1:0,ang2:0},V=({x:t,y:K},D,a,G,N,W,x,b)=>{const n=G*(t*=D)-N*(K*=a),e=N*t+G*K;return b.x=n+W,b.y=e+x,b};function s(t,K){const D=-1.5707963267948966===K?-.551915024494:4/3*Math.tan(K/4),a=1.5707963267948966===K?.551915024494:D,G=Math.cos(t),N=Math.sin(t),W=Math.cos(t+K),x=Math.sin(t+K);return[{x:G-N*a,y:N+G*a},{x:W+x*a,y:x-W*a},{x:W,y:x}]}const F=(t,K,D,a)=>{let G=t*D+K*a;return G>1&&(G=1),G<-1&&(G=-1),(t*a-K*D<0?-1:1)*Math.acos(G)};const c=new x.M;class g{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Z.c,this._graphicsPath2D=t}moveTo(t,K){return this.startPoly(t,K),this}lineTo(t,K){this._ensurePoly();const D=this._currentPoly.points,a=D[D.length-2],G=D[D.length-1];return a===t&&G===K||D.push(t,K),this}arc(t,K,D,a,G,N){return this._ensurePoly(!1),H(this._currentPoly.points,t,K,D,a,G,N),this}arcTo(t,K,D,a,G){return this._ensurePoly(),function(t,K,D,a,G,N){const W=t[t.length-2],x=t[t.length-1]-D,b=W-K,n=G-D,e=a-K,i=Math.abs(x*e-b*n);if(i<1e-8||0===N)return void(t[t.length-2]===K&&t[t.length-1]===D||t.push(K,D));const z=x*x+b*b,I=n*n+e*e,Z=x*n+b*e,w=N*Math.sqrt(z)/i,m=N*Math.sqrt(I)/i,u=w*Z/z,d=m*Z/I,E=w*e+m*b,l=w*n+m*x,Q=b*(m+u),P=x*(m+u),y=e*(w+d),q=n*(w+d);H(t,E+K,l+D,N,Math.atan2(P-l,Q-E),Math.atan2(q-l,y-E),b*n>e*x)}(this._currentPoly.points,t,K,D,a,G),this}arcToSvg(t,K,D,a,G,N,W){return function(t,K,D,a,G,N,W,x=0,b=0,n=0){if(0===N||0===W)return;const e=Math.sin(x*o/360),i=Math.cos(x*o/360),z=i*(K-a)/2+e*(D-G)/2,I=-e*(K-a)/2+i*(D-G)/2;if(0===z&&0===I)return;N=Math.abs(N),W=Math.abs(W);const Z=Math.pow(z,2)/Math.pow(N,2)+Math.pow(I,2)/Math.pow(W,2);Z>1&&(N*=Math.sqrt(Z),W*=Math.sqrt(Z)),((t,K,D,a,G,N,W,x,b,n,e,i,z)=>{const I=Math.pow(G,2),Z=Math.pow(N,2),w=Math.pow(e,2),m=Math.pow(i,2);let u=I*Z-I*m-Z*w;u<0&&(u=0),u/=I*m+Z*w,u=Math.sqrt(u)*(W===x?-1:1);const d=u*G/N*i,E=u*-N/G*e,l=n*d-b*E+(t+D)/2,Q=b*d+n*E+(K+a)/2,P=(e-d)/G,y=(i-E)/N,q=(-e-d)/G,X=(-i-E)/N,h=F(1,0,P,y);let J=F(P,y,q,X);0===x&&J>0&&(J-=o),1===x&&J<0&&(J+=o),z.centerX=l,z.centerY=Q,z.ang1=h,z.ang2=J})(K,D,a,G,N,W,b,n,e,i,z,I,U);let{ang1:w,ang2:m}=U;const{centerX:u,centerY:d}=U;let E=Math.abs(m)/(o/4);Math.abs(1-E)<1e-7&&(E=1);const l=Math.max(Math.ceil(E),1);m/=l;let Q=t[t.length-2],y=t[t.length-1];const q={x:0,y:0};for(let K=0;K<l;K++){const K=s(w,m),{x:D,y:a}=V(K[0],N,W,i,e,u,d,q),{x:G,y:x}=V(K[1],N,W,i,e,u,d,q),{x:b,y:n}=V(K[2],N,W,i,e,u,d,q);P(t,Q,y,D,a,G,x,b,n),Q=b,y=n,w+=m}}(this._currentPoly.points,this._currentPoly.lastX,this._currentPoly.lastY,N,W,t,K,D,a,G),this}bezierCurveTo(t,K,D,a,G,N,W){this._ensurePoly();const x=this._currentPoly;return P(this._currentPoly.points,x.lastX,x.lastY,t,K,D,a,G,N,W),this}quadraticCurveTo(t,K,D,a,G){this._ensurePoly();const N=this._currentPoly;return _(this._currentPoly.points,N.lastX,N.lastY,t,K,D,a,G),this}closePath(){return this.endPoly(!0),this}addPath(t,K){this.endPoly(),K&&!K.isIdentity()&&(t=t.clone(!0)).transform(K);for(let K=0;K<t.instructions.length;K++){const D=t.instructions[K];this[D.action](...D.data)}return this}finish(t=!1){this.endPoly(t)}rect(t,K,D,a,G){return this.drawShape(new x.M(t,K,D,a),G),this}circle(t,K,D,a){return this.drawShape(new b(t,K,D),a),this}poly(t,K,D){const a=new i(t);return a.closePath=K,this.drawShape(a,D),this}regularPoly(t,K,D,a,G=0,N){a=Math.max(0|a,3);const W=-1*Math.PI/2+G,x=2*Math.PI/a,b=[];for(let G=0;G<a;G++){const a=G*x+W;b.push(t+D*Math.cos(a),K+D*Math.sin(a))}return this.poly(b,!0,N),this}roundPoly(t,K,D,a,G,N=0,W){if(a=Math.max(0|a,3),G<=0)return this.regularPoly(t,K,D,a,N);const x=D*Math.sin(Math.PI/a)-.001;G=Math.min(G,x);const b=-1*Math.PI/2+N,n=2*Math.PI/a,e=(a-2)*Math.PI/a/2;for(let N=0;N<a;N++){const a=N*n+b,x=t+D*Math.cos(a),i=K+D*Math.sin(a),z=a+Math.PI+e,I=a-Math.PI-e,Z=x+G*Math.cos(z),w=i+G*Math.sin(z),m=x+G*Math.cos(I),u=i+G*Math.sin(I);0===N?this.moveTo(Z,w):this.lineTo(Z,w),this.quadraticCurveTo(x,i,m,u,W)}return this.closePath()}roundShape(t,K,D=!1,a){return t.length<3?this:(D?function(t,K,D,a){var G;const N=(t,K)=>Math.sqrt((t.x-K.x)**2+(t.y-K.y)**2),W=(t,K,D)=>({x:t.x+(K.x-t.x)*D,y:t.y+(K.y-t.y)*D}),x=K.length;for(let b=0;b<x;b++){const n=K[(b+1)%x],e=null!==(G=n.radius)&&void 0!==G?G:D;if(e<=0){0===b?t.moveTo(n.x,n.y):t.lineTo(n.x,n.y);continue}const i=K[b],z=K[(b+2)%x],I=N(i,n);let Z;Z=I<1e-4?n:W(n,i,Math.min(I/2,e)/I);const w=N(z,n);let m;m=w<1e-4?n:W(n,z,Math.min(w/2,e)/w),0===b?t.moveTo(Z.x,Z.y):t.lineTo(Z.x,Z.y),t.quadraticCurveTo(n.x,n.y,m.x,m.y,a)}}(this,t,K,a):function(t,K,D){var a;const G=(t,K)=>{const D=K.x-t.x,a=K.y-t.y,G=Math.sqrt(D*D+a*a);return{len:G,nx:D/G,ny:a/G}},N=(K,D)=>{0===K?t.moveTo(D.x,D.y):t.lineTo(D.x,D.y)};let W=K[K.length-1];for(let x=0;x<K.length;x++){const b=K[x%K.length],n=null!==(a=b.radius)&&void 0!==a?a:D;if(n<=0){N(x,b),W=b;continue}const e=K[(x+1)%K.length],i=G(b,W),z=G(b,e);if(i.len<1e-4||z.len<1e-4){N(x,b),W=b;continue}let I=Math.asin(i.nx*z.ny-i.ny*z.nx),Z=1,w=!1;i.nx*z.nx-i.ny*-z.ny<0?I<0?I=Math.PI+I:(I=Math.PI-I,Z=-1,w=!0):I>0&&(Z=-1,w=!0);const m=I/2;let u,d=Math.abs(Math.cos(m)*n/Math.sin(m));d>Math.min(i.len/2,z.len/2)?(d=Math.min(i.len/2,z.len/2),u=Math.abs(d*Math.sin(m)/Math.cos(m))):u=n;const E=b.x+z.nx*d+-z.ny*u*Z,l=b.y+z.ny*d+z.nx*u*Z,Q=Math.atan2(i.ny,i.nx)+Math.PI/2*Z,P=Math.atan2(z.ny,z.nx)-Math.PI/2*Z;0===x&&t.moveTo(E+Math.cos(Q)*u,l+Math.sin(Q)*u),t.arc(E,l,u,Q,P,w),W=b}}(this,t,K),this.closePath())}filletRect(t,K,D,a,G){if(0===G)return this.rect(t,K,D,a);const N=Math.min(D,a)/2,W=Math.min(N,Math.max(-N,G)),x=t+D,b=K+a,n=W<0?-W:0,e=Math.abs(W);return this.moveTo(t,K+e).arcTo(t+n,K+n,t+e,K,e).lineTo(x-e,K).arcTo(x-n,K+n,x,K+e,e).lineTo(x,b-e).arcTo(x-n,b-n,t+D-e,b,e).lineTo(t+e,b).arcTo(t+n,b-n,t,b-e,e).closePath()}chamferRect(t,K,D,a,G,N){if(G<=0)return this.rect(t,K,D,a);const W=Math.min(G,Math.min(D,a)/2),x=t+D,b=K+a,n=[t+W,K,x-W,K,x,K+W,x,b-W,x-W,b,t+W,b,t,b-W,t,K+W];for(let t=n.length-1;t>=2;t-=2)n[t]===n[t-2]&&n[t-1]===n[t-3]&&n.splice(t-1,2);return this.poly(n,!0,N)}ellipse(t,K,D,a,G){return this.drawShape(new n(t,K,D,a),G),this}roundRect(t,K,D,a,G,N){return this.drawShape(new I(t,K,D,a,G),N),this}drawShape(t,K){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:K}),this}startPoly(t,K){let D=this._currentPoly;return D&&this.endPoly(),D=new i,D.points.push(t,K),this._currentPoly=D,this}endPoly(t=!1){const K=this._currentPoly;return K&&K.points.length>2&&(K.closePath=t,this.shapePrimitives.push({shape:K})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new i,t)){const t=this.shapePrimitives[this.shapePrimitives.length-1];if(t){let K=t.shape.x,D=t.shape.y;if(t.transform&&!t.transform.isIdentity()){const a=t.transform,G=K;K=a.a*K+a.c*D+a.tx,D=a.b*G+a.d*D+a.ty}this._currentPoly.points.push(K,D)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let K=0;K<t.instructions.length;K++){const D=t.instructions[K];this[D.action](...D.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const K=this.shapePrimitives;for(let D=0;D<K.length;D++){const a=K[D],G=a.shape.getBounds(c);a.transform?t.addRect(G,a.transform):t.addRect(G)}return t}}class R{constructor(t){var K;this.instructions=[],this.uid=G.L("graphicsPath"),this._dirty=!0,"string"==typeof t?function(t,K){const D=W(t),a=[];let G=null,x=0,b=0;for(let t=0;t<D.length;t++){const W=D[t],n=W[0],e=W;switch(n){case"M":x=e[1],b=e[2],K.moveTo(x,b);break;case"m":x+=e[1],b+=e[2],K.moveTo(x,b);break;case"H":x=e[1],K.lineTo(x,b);break;case"h":x+=e[1],K.lineTo(x,b);break;case"V":b=e[1],K.lineTo(x,b);break;case"v":b+=e[1],K.lineTo(x,b);break;case"L":x=e[1],b=e[2],K.lineTo(x,b);break;case"l":x+=e[1],b+=e[2],K.lineTo(x,b);break;case"C":x=e[5],b=e[6],K.bezierCurveTo(e[1],e[2],e[3],e[4],x,b);break;case"c":K.bezierCurveTo(x+e[1],b+e[2],x+e[3],b+e[4],x+e[5],b+e[6]),x+=e[5],b+=e[6];break;case"S":x=e[3],b=e[4],K.bezierCurveToShort(e[1],e[2],x,b);break;case"s":K.bezierCurveToShort(x+e[1],b+e[2],x+e[3],b+e[4]),x+=e[3],b+=e[4];break;case"Q":x=e[3],b=e[4],K.quadraticCurveTo(e[1],e[2],x,b);break;case"q":K.quadraticCurveTo(x+e[1],b+e[2],x+e[3],b+e[4]),x+=e[3],b+=e[4];break;case"T":x=e[1],b=e[2],K.quadraticCurveToShort(x,b);break;case"t":x+=e[1],b+=e[2],K.quadraticCurveToShort(x,b);break;case"A":x=e[6],b=e[7],K.arcToSvg(e[1],e[2],e[3],e[4],e[5],x,b);break;case"a":x+=e[6],b+=e[7],K.arcToSvg(e[1],e[2],e[3],e[4],e[5],x,b);break;case"Z":case"z":K.closePath(),a.length>0&&(G=a.pop(),G?(x=G.startX,b=G.startY):(x=0,b=0)),G=null;break;default:N.R(`Unknown SVG path command: ${n}`)}"Z"!==n&&"z"!==n&&null===G&&(G={startX:x,startY:b},a.push(G))}}(t,this):this.instructions=null!==(K=null==t?void 0:t.slice())&&void 0!==K?K:[]}get shapePath(){return this._shapePath||(this._shapePath=new g(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,K){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,K]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,K,D,G,N){const W=this.instructions[this.instructions.length-1],x=this.getLastPoint(a.b.shared);let b=0,n=0;if(W&&"bezierCurveTo"===W.action){b=W.data[2],n=W.data[3];const t=x.x,K=x.y;b=t+(t-b),n=K+(K-n)}else b=x.x,n=x.y;return this.instructions.push({action:"bezierCurveTo",data:[b,n,t,K,D,G,N]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,K,D){const G=this.instructions[this.instructions.length-1],N=this.getLastPoint(a.b.shared);let W=0,x=0;if(G&&"quadraticCurveTo"===G.action){W=G.data[0],x=G.data[1];const t=N.x,K=N.y;W=t+(t-W),x=K+(K-x)}else W=N.x,x=N.y;return this.instructions.push({action:"quadraticCurveTo",data:[W,x,t,K,D]}),this._dirty=!0,this}rect(t,K,D,a,G){return this.instructions.push({action:"rect",data:[t,K,D,a,G]}),this._dirty=!0,this}circle(t,K,D,a){return this.instructions.push({action:"circle",data:[t,K,D,a]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,K,D,a,G,N,W){G=G||a/2;const x=-1*Math.PI/2+N,b=2*D,n=2*Math.PI/b,e=[];for(let D=0;D<b;D++){const N=D%2?G:a,W=D*n+x;e.push(t+N*Math.cos(W),K+N*Math.sin(W))}return this.poly(e,!0,W),this}clone(t=!1){const K=new R;if(t)for(let t=0;t<this.instructions.length;t++){const D=this.instructions[t];K.instructions.push({action:D.action,data:D.data.slice()})}else K.instructions=this.instructions.slice();return K}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const K=t.a,D=t.b,a=t.c,G=t.d,W=t.tx,x=t.ty;let b=0,n=0,e=0,i=0,z=0,I=0,Z=0,w=0;for(let m=0;m<this.instructions.length;m++){const u=this.instructions[m],d=u.data;switch(u.action){case"moveTo":case"lineTo":b=d[0],n=d[1],d[0]=K*b+a*n+W,d[1]=D*b+G*n+x;break;case"bezierCurveTo":e=d[0],i=d[1],z=d[2],I=d[3],b=d[4],n=d[5],d[0]=K*e+a*i+W,d[1]=D*e+G*i+x,d[2]=K*z+a*I+W,d[3]=D*z+G*I+x,d[4]=K*b+a*n+W,d[5]=D*b+G*n+x;break;case"quadraticCurveTo":e=d[0],i=d[1],b=d[2],n=d[3],d[0]=K*e+a*i+W,d[1]=D*e+G*i+x,d[2]=K*b+a*n+W,d[3]=D*b+G*n+x;break;case"arcToSvg":b=d[5],n=d[6],Z=d[0],w=d[1],d[0]=K*Z+a*w,d[1]=D*Z+G*w,d[5]=K*b+a*n+W,d[6]=D*b+G*n+x;break;case"circle":d[4]=A(d[3],t);break;case"rect":d[4]=A(d[4],t);break;case"ellipse":d[8]=A(d[8],t);break;case"roundRect":d[5]=A(d[5],t);break;case"addPath":d[0].transform(t);break;case"poly":d[2]=A(d[2],t);break;default:N.R("unknown transform action",u.action)}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let K=this.instructions.length-1,D=this.instructions[K];if(!D)return t.x=0,t.y=0,t;for(;"closePath"===D.action;){if(K--,K<0)return t.x=0,t.y=0,t;D=this.instructions[K]}switch(D.action){case"moveTo":case"lineTo":t.x=D.data[0],t.y=D.data[1];break;case"quadraticCurveTo":t.x=D.data[2],t.y=D.data[3];break;case"bezierCurveTo":t.x=D.data[4],t.y=D.data[5];break;case"arc":case"arcToSvg":t.x=D.data[5],t.y=D.data[6];break;case"addPath":D.data[0].getLastPoint(t)}return t}}function A(t,K){return t?t.prepend(K):K.clone()}},867659:(t,K,D)=>{D.d(K,{T:()=>I,w:()=>z});var a=D(534661),G=D(823040),N=D(177487),W=D(387473),x=D(315725);function b(t){return t instanceof x.m}function n(t){return t instanceof W._}function e(t,K,D){return t.fill=K,t.color=16777215,t.texture=K.texture,t.matrix=K.transform,{...D,...t}}function i(t,K,D){return K.buildLinearGradient(),t.fill=K,t.color=16777215,t.texture=K.texture,t.matrix=K.transform,{...D,...t}}function z(t,K){if(null==t)return null;const D={},W=t;return function(t){return a.Q.isColorLike(t)}(t)?function(t,K,D){const G=a.Q.shared.setValue(null!=K?K:0);return t.color=G.toNumber(),t.alpha=1===G.alpha?D.alpha:G.alpha,t.texture=N.g.WHITE,{...D,...t}}(D,t,K):b(t)?e(D,t,K):n(t)?i(D,t,K):W.fill&&b(W.fill)?e(W,W.fill,K):W.fill&&n(W.fill)?i(W,W.fill,K):function(t,K){var D;const W={...K,...t};if(W.texture){if(W.texture!==N.g.WHITE){const t=(null===(D=W.matrix)||void 0===D?void 0:D.clone().invert())||new G.u;t.translate(W.texture.frame.x,W.texture.frame.y),t.scale(1/W.texture.source.width,1/W.texture.source.height),W.matrix=t}const t=W.texture.source.style;"clamp-to-edge"===t.addressMode&&(t.addressMode="repeat",t.update())}const x=a.Q.shared.setValue(W.color);return W.alpha*=x.alpha,W.color=x.toNumber(),W.matrix=W.matrix?W.matrix.clone():null,W}(W,K)}function I(t,K){const{width:D,alignment:a,miterLimit:G,cap:N,join:W,pixelLine:x,...b}=K,n=z(t,b);return n?{width:D,alignment:a,miterLimit:G,cap:N,join:W,pixelLine:x,...n}:null}},694607:(t,K,D)=>{D.d(K,{u:()=>b});var a=D(518518),G=D(851537),N=D(618773),W=D(5319);const x=class t extends N.V{constructor(...K){var D;let N=null!==(D=K[0])&&void 0!==D?D:{};N instanceof Float32Array&&(W.t6(W.lj,"use new MeshGeometry({ positions, uvs, indices }) instead"),N={positions:N,uvs:K[1],indices:K[2]}),N={...t.defaultOptions,...N};const x=N.positions||new Float32Array([0,0,1,0,1,1,0,1]),b=N.uvs||new Float32Array([0,0,1,0,1,1,0,1]),n=N.indices||new Uint32Array([0,1,2,0,2,3]),e=N.shrinkBuffersToFit;super({attributes:{aPosition:{buffer:new a.h({data:x,label:"attribute-mesh-positions",shrinkToFit:e,usage:G.S.VERTEX|G.S.COPY_DST}),format:"float32x2",stride:2*4,offset:0},aUV:{buffer:new a.h({data:b,label:"attribute-mesh-uvs",shrinkToFit:e,usage:G.S.VERTEX|G.S.COPY_DST}),format:"float32x2",stride:2*4,offset:0}},indexBuffer:new a.h({data:n,label:"index-mesh-buffer",shrinkToFit:e,usage:G.S.INDEX|G.S.COPY_DST}),topology:N.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(t){this.attributes.aPosition.buffer.data=t}get uvs(){return this.attributes.aUV.buffer.data}set uvs(t){this.attributes.aUV.buffer.data=t}get indices(){return this.indexBuffer.data}set indices(t){this.indexBuffer.data=t}};x.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};let b=x},247470:(t,K,D)=>{D.d(K,{D:()=>x});var a=D(177487),G=D(744201),N=D(463996),W=D(20401);class x extends W.k{constructor(...t){let K=t[0];Array.isArray(t[0])&&(K={textures:t[0],autoUpdate:t[1]});const{textures:D,autoUpdate:G,...N}=K,[W]=D;super({...N,texture:W instanceof a.g?W:W.texture}),this._textures=null,this._durations=null,this._autoUpdate=null==G||G,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=D}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(N.R.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(N.R.shared.add(this.update,this,G.d.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const K=t.deltaTime,D=this.animationSpeed*K,a=this.currentFrame;if(null!==this._durations){let t=this._currentTime%1*this._durations[this.currentFrame];for(t+=D/60*1e3;t<0;)this._currentTime--,t+=this._durations[this.currentFrame];const a=Math.sign(this.animationSpeed*K);for(this._currentTime=Math.floor(this._currentTime);t>=this._durations[this.currentFrame];)t-=this._durations[this.currentFrame]*a,this._currentTime+=a;this._currentTime+=t/this._durations[this.currentFrame]}else this._currentTime+=D;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):a!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<a||this.animationSpeed<0&&this.currentFrame>a)&&this.onLoop(),this._updateTexture())}_updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this.texture=this._textures[t],this.updateAnchor&&this.anchor.copyFrom(this.texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(){this.stop(),super.destroy(),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const K=[];for(let D=0;D<t.length;++D)K.push(a.g.from(t[D]));return new x(K)}static fromImages(t){const K=[];for(let D=0;D<t.length;++D)K.push(a.g.from(t[D]));return new x(K)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof a.g)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let K=0;K<t.length;K++)this._textures.push(t[K].texture),this._durations.push(t[K].time)}this._previousFrame=null,this.gotoAndStop(0),this._updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const K=this.currentFrame;this._currentTime=t,K!==this.currentFrame&&this._updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(N.R.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(N.R.shared.add(this.update,this),this._isConnectedToTicker=!0))}}},61705:(t,K,D)=>{D.d(K,{P:()=>b});var a=D(5319),G=D(694607);const N=class t extends G.u{constructor(...t){var K;super({});let D=null!==(K=t[0])&&void 0!==K?K:{};"number"==typeof D&&(a.t6(a.lj,"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),D={width:D,height:t[1],verticesX:t[2],verticesY:t[3]}),this.build(D)}build(K){var D,a,G,N;K={...t.defaultOptions,...K},this.verticesX=null!==(D=this.verticesX)&&void 0!==D?D:K.verticesX,this.verticesY=null!==(a=this.verticesY)&&void 0!==a?a:K.verticesY,this.width=null!==(G=this.width)&&void 0!==G?G:K.width,this.height=null!==(N=this.height)&&void 0!==N?N:K.height;const W=this.verticesX*this.verticesY,x=[],b=[],n=[],e=this.verticesX-1,i=this.verticesY-1,z=this.width/e,I=this.height/i;for(let t=0;t<W;t++){const K=t%this.verticesX,D=t/this.verticesX|0;x.push(K*z,D*I),b.push(K/e,D/i)}const Z=e*i;for(let t=0;t<Z;t++){const K=t%e,D=t/e|0,a=D*this.verticesX+K,G=D*this.verticesX+K+1,N=(D+1)*this.verticesX+K,W=(D+1)*this.verticesX+K+1;n.push(a,G,N,G,W,N)}this.buffers[0].data=new Float32Array(x),this.buffers[1].data=new Float32Array(b),this.indexBuffer.data=new Uint32Array(n),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};N.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};let W=N;const x=class t extends W{constructor(K={}){super({width:(K={...t.defaultOptions,...K}).width,height:K.height,verticesX:4,verticesY:4}),this.update(K)}update(t){var K,D,a,G,N,W,x,b;this.width=null!==(K=t.width)&&void 0!==K?K:this.width,this.height=null!==(D=t.height)&&void 0!==D?D:this.height,this._originalWidth=null!==(a=t.originalWidth)&&void 0!==a?a:this._originalWidth,this._originalHeight=null!==(G=t.originalHeight)&&void 0!==G?G:this._originalHeight,this._leftWidth=null!==(N=t.leftWidth)&&void 0!==N?N:this._leftWidth,this._rightWidth=null!==(W=t.rightWidth)&&void 0!==W?W:this._rightWidth,this._topHeight=null!==(x=t.topHeight)&&void 0!==x?x:this._topHeight,this._bottomHeight=null!==(b=t.bottomHeight)&&void 0!==b?b:this._bottomHeight,this.updateUvs(),this.updatePositions()}updatePositions(){const t=this.positions,K=this._leftWidth+this._rightWidth,D=this.width>K?1:this.width/K,a=this._topHeight+this._bottomHeight,G=this.height>a?1:this.height/a,N=Math.min(D,G);t[9]=t[11]=t[13]=t[15]=this._topHeight*N,t[17]=t[19]=t[21]=t[23]=this.height-this._bottomHeight*N,t[25]=t[27]=t[29]=t[31]=this.height,t[2]=t[10]=t[18]=t[26]=this._leftWidth*N,t[4]=t[12]=t[20]=t[28]=this.width-this._rightWidth*N,t[6]=t[14]=t[22]=t[30]=this.width,this.getBuffer("aPosition").update()}updateUvs(){const t=this.uvs;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1;const K=1/this._originalWidth,D=1/this._originalHeight;t[2]=t[10]=t[18]=t[26]=K*this._leftWidth,t[9]=t[11]=t[13]=t[15]=D*this._topHeight,t[4]=t[12]=t[20]=t[28]=1-K*this._rightWidth,t[17]=t[19]=t[21]=t[23]=1-D*this._bottomHeight,this.getBuffer("aUV").update()}};x.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};let b=x},954949:(t,K,D)=>{D.d(K,{Q:()=>x});var a=D(177487),G=(D(5319),D(979822)),N=D(61705);const W=class t extends G.l{constructor(K){var D,G,W,x,b,n,e,i,z,I;K instanceof a.g&&(K={texture:K});const{width:Z,height:w,leftWidth:m,rightWidth:u,topHeight:d,bottomHeight:E,texture:l,roundPixels:Q,...P}=K;super({label:"NineSliceSprite",...P}),this.renderPipeId="nineSliceSprite",this.batched=!0,this._leftWidth=null!==(G=null!=m?m:null===(D=null==l?void 0:l.defaultBorders)||void 0===D?void 0:D.left)&&void 0!==G?G:N.P.defaultOptions.leftWidth,this._topHeight=null!==(x=null!=d?d:null===(W=null==l?void 0:l.defaultBorders)||void 0===W?void 0:W.top)&&void 0!==x?x:N.P.defaultOptions.topHeight,this._rightWidth=null!==(n=null!=u?u:null===(b=null==l?void 0:l.defaultBorders)||void 0===b?void 0:b.right)&&void 0!==n?n:N.P.defaultOptions.rightWidth,this._bottomHeight=null!==(i=null!=E?E:null===(e=null==l?void 0:l.defaultBorders)||void 0===e?void 0:e.bottom)&&void 0!==i?i:N.P.defaultOptions.bottomHeight,this.bounds.maxX=this._width=null!==(z=null!=Z?Z:l.width)&&void 0!==z?z:N.P.defaultOptions.width,this.bounds.maxY=this._height=null!==(I=null!=w?w:l.height)&&void 0!==I?I:N.P.defaultOptions.height,this.allowChildren=!1,this.texture=null!=l?l:t.defaultOptions.texture,this.roundPixels=null!=Q&&Q}updateBounds(){}get width(){return this._width}set width(t){this.bounds.maxX=this._width=t,this.onViewUpdate()}get height(){return this._height}set height(t){this.bounds.maxY=this._height=t,this.onViewUpdate()}setSize(t,K){var D;"object"==typeof t&&(K=null!==(D=t.height)&&void 0!==D?D:t.width,t=t.width),this.bounds.maxX=this._width=t,this.bounds.maxY=this._height=null!=K?K:t,this.onViewUpdate()}getSize(t){return t||(t={}),t.width=this._width,t.height=this._height,t}get leftWidth(){return this._leftWidth}set leftWidth(t){this._leftWidth=t,this.onViewUpdate()}get topHeight(){return this._topHeight}set topHeight(t){this._topHeight=t,this.onViewUpdate()}get rightWidth(){return this._rightWidth}set rightWidth(t){this._rightWidth=t,this.onViewUpdate()}get bottomHeight(){return this._bottomHeight}set bottomHeight(t){this._bottomHeight=t,this.onViewUpdate()}get texture(){return this._texture}set texture(t){t||(t=a.g.EMPTY);const K=this._texture;K!==t&&(K&&K.dynamic&&K.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this.onViewUpdate())}get originalWidth(){return this._texture.width}get originalHeight(){return this._texture.height}destroy(t){if(super.destroy(t),"boolean"==typeof t?t:null==t?void 0:t.texture){const K="boolean"==typeof t?t:null==t?void 0:t.textureSource;this._texture.destroy(K)}this._texture=null}};W.defaultOptions={texture:a.g.EMPTY};let x=W},20401:(t,K,D)=>{D.d(K,{k:()=>x});var a=D(553417),G=D(177487),N=D(971817),W=D(979822);class x extends W.l{constructor(t=G.g.EMPTY){t instanceof G.g&&(t={texture:t});const{texture:K=G.g.EMPTY,anchor:D,roundPixels:N,width:W,height:x,...b}=t;super({label:"Sprite",...b}),this.renderPipeId="sprite",this.batched=!0,this._sourceBounds={minX:0,maxX:1,minY:0,maxY:0},this._sourceBoundsDirty=!0,this._anchor=new a.o({_onUpdate:()=>{this.onViewUpdate()}}),D?this.anchor=D:K.defaultAnchor&&(this.anchor=K.defaultAnchor),this.texture=K,this.allowChildren=!1,this.roundPixels=null!=N&&N,void 0!==W&&(this.width=W),void 0!==x&&(this.height=x)}static from(t,K=!1){return t instanceof G.g?new x(t):new x(G.g.from(t,K))}set texture(t){t||(t=G.g.EMPTY);const K=this._texture;K!==t&&(K&&K.dynamic&&K.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get sourceBounds(){return this._sourceBoundsDirty&&(this._updateSourceBounds(),this._sourceBoundsDirty=!1),this._sourceBounds}containsPoint(t){const K=this.sourceBounds;return t.x>=K.maxX&&t.x<=K.minX&&t.y>=K.maxY&&t.y<=K.minY}onViewUpdate(){this._sourceBoundsDirty=this._boundsDirty=!0,super.onViewUpdate()}updateBounds(){N.y(this._bounds,this._anchor,this._texture,0)}_updateSourceBounds(){const t=this._anchor,K=this._texture,D=this._sourceBounds,{width:a,height:G}=K.orig;D.maxX=-t._x*a,D.minX=D.maxX+a,D.maxY=-t._y*G,D.minY=D.maxY+G}destroy(t=!1){if(super.destroy(t),"boolean"==typeof t?t:null==t?void 0:t.texture){const K="boolean"==typeof t?t:null==t?void 0:t.textureSource;this._texture.destroy(K)}this._texture=null,this._bounds=null,this._sourceBounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,K){var D;"object"==typeof t?(K=null!==(D=t.height)&&void 0!==D?D:t.width,t=t.width):null!=K||(K=t),void 0!==t&&this._setWidth(t,this._texture.orig.width),void 0!==K&&this._setHeight(K,this._texture.orig.height)}}},29494:(t,K,D)=>{D.d(K,{v:()=>N});var a=D(610162),G=D(5319);class N extends a.A{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return G.t6(G.lj,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return G.t6(G.lj,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return G.t6(G.lj,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return G.t6(G.lj,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return G.t6(G.lj,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){var K;this.emit("destroy",this),this.removeAllListeners();for(const t in this.chars)null===(K=this.chars[t].texture)||void 0===K||K.destroy();this.chars=null,t&&(this.pages.forEach((t=>t.texture.destroy(!0))),this.pages=null)}}},28912:(t,K,D)=>{D.d(K,{B:()=>x});var a=D(377223),G=D(177487),N=D(29494),W=D(201812);class x extends N.v{constructor(t,K){var D;super();const{textures:N,data:W}=t;Object.keys(W.pages).forEach((t=>{const K=W.pages[parseInt(t,10)],D=N[K.id];this.pages.push({texture:D})})),Object.keys(W.chars).forEach((t=>{var K;const D=W.chars[t],{frame:x,source:b}=N[D.page],n=new a.M(D.x+x.x,D.y+x.y,D.width,D.height),e=new G.g({source:b,frame:n});this.chars[t]={id:t.codePointAt(0),xOffset:D.xOffset,yOffset:D.yOffset,xAdvance:D.xAdvance,kerning:null!==(K=D.kerning)&&void 0!==K?K:{},texture:e}})),this.baseRenderedFontSize=W.fontSize,this.baseMeasurementFontSize=W.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:W.fontSize},this.baseLineOffset=W.baseLineOffset,this.lineHeight=W.lineHeight,this.fontFamily=W.fontFamily,this.distanceField=null!==(D=W.distanceField)&&void 0!==D?D:{type:"none",range:0},this.url=K}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:K}=this.pages[t];K.destroy(!0)}this.pages=null}static install(t){W.c.install(t)}static uninstall(t){W.c.uninstall(t)}}},201812:(t,K,D)=>{D.d(K,{c:()=>Q});var a=D(363020),G=D(5319),N=D(229995),W=D(453712),x=D(534661),b=D(377223),n=D(768273),e=D(408078),i=D(177487),z=D(593865),I=D(706215),Z=D(914759),w=D(29494);function m(t){if(""===t)return[];"string"==typeof t&&(t=[t]);const K=[];for(let D=0,a=t.length;D<a;D++){const a=t[D];if(Array.isArray(a)){if(2!==a.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${a.length}.`);if(0===a[0].length||0===a[1].length)throw new Error("[BitmapFont]: Invalid character delimiter.");const t=a[0].charCodeAt(0),D=a[1].charCodeAt(0);if(D<t)throw new Error("[BitmapFont]: Invalid character range.");for(let a=t,G=D;a<=G;a++)K.push(String.fromCharCode(a))}else K.push(...Array.from(a))}if(0===K.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return K}const u=class t extends w.v{constructor(K){var D,a,G;super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const N={...t.defaultOptions,...K};this._textureSize=N.textureSize,this._mipmap=N.mipmap;const W=N.style.clone();N.overrideFill&&(W._fill.color=16777215,W._fill.alpha=1,W._fill.texture=i.g.WHITE,W._fill.fill=null),this.applyFillAsTint=N.overrideFill;const x=W.fontSize;W.fontSize=this.baseMeasurementFontSize;const b=I.Z(W);N.overrideSize?W._stroke&&(W._stroke.width*=this.baseRenderedFontSize/x):W.fontSize=this.baseRenderedFontSize=x,this._style=W,this._skipKerning=null!==(D=N.skipKerning)&&void 0!==D&&D,this.resolution=null!==(a=N.resolution)&&void 0!==a?a:1,this._padding=null!==(G=N.padding)&&void 0!==G?G:4,this.fontMetrics=z.P.measureFont(b),this.lineHeight=W.lineHeight||this.fontMetrics.fontSize||W.fontSize}ensureCharacters(t){var K,D,a,G;const N=m(t).filter((t=>!this._currentChars.includes(t))).filter(((t,K,D)=>D.indexOf(t)===K));if(!N.length)return;let W;this._currentChars=[...this._currentChars,...N],W=-1===this._currentPageIndex?this._nextPage():this.pages[this._currentPageIndex];let{canvas:x,context:n}=W.canvasAndContext,e=W.texture.source;const I=this._style;let Z=this._currentX,w=this._currentY;const u=this.baseRenderedFontSize/this.baseMeasurementFontSize,d=this._padding*u;let E=0,l=!1;const Q=x.width/this.resolution,P=x.height/this.resolution;for(let t=0;t<N.length;t++){const W=N[t],m=z.P.measureText(W,I,x,!1);m.lineHeight=m.height;const y=m.width*u,q=Math.ceil(("italic"===I.fontStyle?2:1)*y)+2*d,X=m.height*u+2*d;if(l=!1,"\n"!==W&&"\r"!==W&&"\t"!==W&&" "!==W&&(l=!0,E=Math.ceil(Math.max(X,E))),Z+q>Q&&(w+=E,E=X,Z=0,w+E>P)){e.update();const t=this._nextPage();x=t.canvasAndContext.canvas,n=t.canvasAndContext.context,e=t.texture.source,w=0}const h=y/u-(null!==(D=null===(K=I.dropShadow)||void 0===K?void 0:K.distance)&&void 0!==D?D:0)-(null!==(G=null===(a=I._stroke)||void 0===a?void 0:a.width)&&void 0!==G?G:0);if(this.chars[W]={id:W.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:h,kerning:{}},l){this._drawGlyph(n,m,Z+d,w+d,u,I);const t=e.width*u,K=e.height*u,D=new b.M(Z/t*e.width,w/K*e.height,q/t*e.width,X/K*e.height);this.chars[W].texture=new i.g({source:e,frame:D}),Z+=Math.ceil(q)}}e.update(),this._currentX=Z,this._currentY=w,this._skipKerning&&this._applyKerning(N,n)}get pageTextures(){return G.t6(G.lj,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,K){const D=this._measureCache;for(let a=0;a<t.length;a++){const G=t[a];for(let t=0;t<this._currentChars.length;t++){const a=this._currentChars[t];let N=D[G];N||(N=D[G]=K.measureText(G).width);let W=D[a];W||(W=D[a]=K.measureText(a).width);let x=K.measureText(G+a).width,b=x-(N+W);b&&(this.chars[G].kerning[a]=b),x=K.measureText(G+a).width,b=x-(N+W),b&&(this.chars[a].kerning[G]=b)}}}_nextPage(){this._currentPageIndex++;const t=this.resolution,K=n.N.getOptimalCanvasAndContext(this._textureSize,this._textureSize,t);this._setupContext(K.context,this._style,t);const D=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),a={canvasAndContext:K,texture:new i.g({source:new e.b({resource:K.canvas,resolution:D,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})})};return this.pages[this._currentPageIndex]=a,a}_setupContext(t,K,D){var a;K.fontSize=this.baseRenderedFontSize,t.scale(D,D),t.font=I.Z(K),K.fontSize=this.baseMeasurementFontSize,t.textBaseline=K.textBaseline;const G=K._stroke,N=null!==(a=null==G?void 0:G.width)&&void 0!==a?a:0;if(G&&(t.lineWidth=N,t.lineJoin=G.join,t.miterLimit=G.miterLimit,t.strokeStyle=Z.r(G,t)),K._fill&&(t.fillStyle=Z.r(K._fill,t)),K.dropShadow){const a=K.dropShadow,G=x.Q.shared.setValue(a.color).toArray(),N=a.blur*D,W=a.distance*D;t.shadowColor=`rgba(${255*G[0]},${255*G[1]},${255*G[2]},${a.alpha})`,t.shadowBlur=N,t.shadowOffsetX=Math.cos(a.angle)*W,t.shadowOffsetY=Math.sin(a.angle)*W}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,K,D,a,G,N){var W;const x=K.text,b=K.fontProperties,n=N._stroke,e=(null!==(W=null==n?void 0:n.width)&&void 0!==W?W:0)*G,i=D+e/2,z=a-e/2,I=b.descent*G,Z=K.lineHeight*G;N.stroke&&e&&t.strokeText(x,i,z+Z-I),N._fill&&t.fillText(x,i,z+Z-I)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:K,texture:D}=this.pages[t];n.N.returnCanvasAndContext(K),D.destroy(!0)}this.pages=null}};u.defaultOptions={textureSize:512,style:new W.x,mipmap:!0};let d=u;var E=D(222746);let l=0;const Q=new class{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(t,K){var D;let G=`${K.fontFamily}-bitmap`,W=!0;if(K._fill.fill&&!K._stroke)G+=K._fill.fill.styleKey,W=!1;else if(K._stroke||K.dropShadow){let t=K.styleKey;t=t.substring(0,t.lastIndexOf("-")),G=`${t}-bitmap`,W=!1}if(!a.l.has(G)){const t=new d({style:K,overrideFill:W,overrideSize:!0,...this.defaultOptions});l++,l>50&&N.R("BitmapText",`You have dynamically created ${l} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),t.once("destroy",(()=>{l--,a.l.remove(G)})),a.l.set(G,t)}const x=a.l.get(G);return null===(D=x.ensureCharacters)||void 0===D||D.call(x,t),x}getLayout(t,K,D=!0){const a=this.getFont(t,K);return E.Z([...t],K,a,D)}measureText(t,K,D=!0){return this.getLayout(t,K,D)}install(...t){var K,D,N,x;let b=t[0];"string"==typeof b&&(b={name:b,style:t[1],chars:null===(K=t[2])||void 0===K?void 0:K.chars,resolution:null===(D=t[2])||void 0===D?void 0:D.resolution,padding:null===(N=t[2])||void 0===N?void 0:N.padding,skipKerning:null===(x=t[2])||void 0===x?void 0:x.skipKerning},G.t6(G.lj,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const n=null==b?void 0:b.name;if(!n)throw new Error("[BitmapFontManager] Property `name` is required.");b={...this.defaultOptions,...b};const e=b.style,i=e instanceof W.x?e:new W.x(e),z=null!==i._fill.fill&&void 0!==i._fill.fill,I=new d({style:i,overrideFill:z,skipKerning:b.skipKerning,padding:b.padding,resolution:b.resolution,overrideSize:!1}),Z=m(b.chars);return I.ensureCharacters(Z.join("")),a.l.set(`${n}-bitmap`,I),I.once("destroy",(()=>a.l.remove(`${n}-bitmap`))),I}uninstall(t){const K=`${t}-bitmap`,D=a.l.get(K);D&&D.destroy()}}},473526:(t,K,D)=>{D.d(K,{T:()=>e});var a=D(229995),G=D(553417),N=D(5319),W=D(979822);class x extends W.l{constructor(t,K){const{text:D,resolution:a,style:N,anchor:W,width:x,height:b,roundPixels:n,...e}=t;super({...e}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=K,this.text=null!=D?D:"",this.style=N,this.resolution=null!=a?a:null,this.allowChildren=!1,this._anchor=new G.o({_onUpdate:()=>{this.onViewUpdate()}}),W&&(this.anchor=W),this.roundPixels=null!=n&&n,void 0!==x&&(this.width=x),void 0!==b&&(this.height=b)}get anchor(){return this._anchor}set anchor(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onViewUpdate())}get text(){return this._text}set resolution(t){this._autoResolution=null===t,this._resolution=t,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(t){var K;t=t||{},null===(K=this._style)||void 0===K||K.off("update",this.onViewUpdate,this),t instanceof this._styleClass?this._style=t:this._style=new this._styleClass(t),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this._setWidth(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this._setHeight(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,K){var D;"object"==typeof t?(K=null!==(D=t.height)&&void 0!==D?D:t.width,t=t.width):null!=K||(K=t),void 0!==t&&this._setWidth(t,this.bounds.width),void 0!==K&&this._setHeight(K,this.bounds.height)}containsPoint(t){const K=this.bounds.width,D=this.bounds.height,a=-K*this.anchor.x;let G=0;return t.x>=a&&t.x<=a+K&&(G=-D*this.anchor.y,t.y>=G&&t.y<=G+D)}onViewUpdate(){this._boundsDirty=!0,this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}_getKey(){return`${this.text}:${this._style.styleKey}:${this._resolution}`}destroy(t=!1){super.destroy(t),this.owner=null,this._bounds=null,this._anchor=null,("boolean"==typeof t?t:null==t?void 0:t.style)&&this._style.destroy(t),this._style=null,this._text=null}}var b=D(453712),n=D(201812);class e extends x{constructor(...t){var K,D,a;const G=function(t){var K;let D=null!==(K=t[0])&&void 0!==K?K:{};return("string"==typeof D||t[1])&&(N.t6(N.lj,`use new ${"BitmapText"}({ text: "hi!", style }) instead`),D={text:D,style:t[1]}),D}(t);null!==(K=G.style)&&void 0!==K||(G.style=G.style||{}),null!==(D=(a=G.style).fill)&&void 0!==D||(a.fill=16777215),super(G,b.x),this.renderPipeId="bitmapText"}updateBounds(){const t=this._bounds,K=this._anchor,D=n.c.measureText(this.text,this._style),a=D.scale,G=D.offsetY*a;let N=D.width*a,W=D.height*a;const x=this._style._stroke;x&&(N+=x.width,W+=x.width),t.minX=-K._x*N,t.maxX=t.minX+N,t.minY=-K._y*(W+G),t.maxY=t.minY+W}set resolution(t){null!==t&&a.R("[BitmapText] dynamically updating the resolution is not supported. Resolution should be managed by the BitmapFont.")}get resolution(){return this._resolution}}},860955:(t,K,D)=>{D.d(K,{D:()=>a});const a={test:t=>"string"==typeof t&&t.startsWith("info face="),parse(t){var K,D,a;const G=t.match(/^[a-z]+\s+.+$/gm),N={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const t in G){const K=G[t].match(/^[a-z]+/gm)[0],D=G[t].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(const t in D){const K=D[t].split("="),G=K[0],N=K[1].replace(/"/gm,""),W=parseFloat(N),x=isNaN(W)?N:W;a[G]=x}N[K].push(a)}const W={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[x]=N.info,[b]=N.common,[n]=null!==(K=N.distanceField)&&void 0!==K?K:[];n&&(W.distanceField={range:parseInt(n.distanceRange,10),type:n.fieldType}),W.fontSize=parseInt(x.size,10),W.fontFamily=x.face,W.lineHeight=parseInt(b.lineHeight,10);const e=N.page;for(let t=0;t<e.length;t++)W.pages.push({id:parseInt(e[t].id,10)||0,file:e[t].file});const i={};W.baseLineOffset=W.lineHeight-parseInt(b.base,10);const z=N.char;for(let t=0;t<z.length;t++){const K=z[t],G=parseInt(K.id,10);let N=null!==(a=null!==(D=K.letter)&&void 0!==D?D:K.char)&&void 0!==a?a:String.fromCharCode(G);"space"===N&&(N=" "),i[G]=N,W.chars[N]={id:G,page:parseInt(K.page,10)||0,x:parseInt(K.x,10),y:parseInt(K.y,10),width:parseInt(K.width,10),height:parseInt(K.height,10),xOffset:parseInt(K.xoffset,10),yOffset:parseInt(K.yoffset,10),xAdvance:parseInt(K.xadvance,10),kerning:{}}}const I=N.kerning||[];for(let t=0;t<I.length;t++){const K=parseInt(I[t].first,10),D=parseInt(I[t].second,10),a=parseInt(I[t].amount,10);W.chars[i[D]].kerning[i[K]]=a}return W}}},454639:(t,K,D)=>{D.d(K,{f:()=>a});const a={test(t){const K=t;return"string"!=typeof K&&"getElementsByTagName"in K&&K.getElementsByTagName("page").length&&null!==K.getElementsByTagName("info")[0].getAttribute("face")},parse(t){var K,D;const a={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},G=t.getElementsByTagName("info")[0],N=t.getElementsByTagName("common")[0],W=t.getElementsByTagName("distanceField")[0];W&&(a.distanceField={type:W.getAttribute("fieldType"),range:parseInt(W.getAttribute("distanceRange"),10)});const x=t.getElementsByTagName("page"),b=t.getElementsByTagName("char"),n=t.getElementsByTagName("kerning");a.fontSize=parseInt(G.getAttribute("size"),10),a.fontFamily=G.getAttribute("face"),a.lineHeight=parseInt(N.getAttribute("lineHeight"),10);for(let t=0;t<x.length;t++)a.pages.push({id:parseInt(x[t].getAttribute("id"),10)||0,file:x[t].getAttribute("file")});const e={};a.baseLineOffset=a.lineHeight-parseInt(N.getAttribute("base"),10);for(let t=0;t<b.length;t++){const G=b[t],N=parseInt(G.getAttribute("id"),10);let W=null!==(D=null!==(K=G.getAttribute("letter"))&&void 0!==K?K:G.getAttribute("char"))&&void 0!==D?D:String.fromCharCode(N);"space"===W&&(W=" "),e[N]=W,a.chars[W]={id:N,page:parseInt(G.getAttribute("page"),10)||0,x:parseInt(G.getAttribute("x"),10),y:parseInt(G.getAttribute("y"),10),width:parseInt(G.getAttribute("width"),10),height:parseInt(G.getAttribute("height"),10),xOffset:parseInt(G.getAttribute("xoffset"),10),yOffset:parseInt(G.getAttribute("yoffset"),10),xAdvance:parseInt(G.getAttribute("xadvance"),10),kerning:{}}}for(let t=0;t<n.length;t++){const K=parseInt(n[t].getAttribute("first"),10),D=parseInt(n[t].getAttribute("second"),10),G=parseInt(n[t].getAttribute("amount"),10);a.chars[e[D]].kerning[e[K]]=G}return a}}},556208:(t,K,D)=>{D.d(K,{s:()=>N});var a=D(505777),G=D(454639);const N={test:t=>!("string"!=typeof t||!t.includes("<font>"))&&G.f.test(a.e.get().parseXML(t)),parse:t=>G.f.parse(a.e.get().parseXML(t))}},794583:(t,K,D)=>{D.d(K,{R:()=>I,w:()=>z});var a=D(168786),G=D(714252),N=D(505777),W=D(992178),x=D(58496),b=D(28912),n=D(860955),e=D(556208);const i=[".xml",".fnt"],z={extension:{type:W.Ag.CacheParser,name:"cacheBitmapFont"},test:t=>t instanceof b.B,getCacheableAssets(t,K){const D={};return t.forEach((t=>{D[t]=K,D[`${t}-bitmap`]=K})),D[`${K.fontFamily}-bitmap`]=K,D}},I={extension:{type:W.Ag.LoadParser,priority:a.T.Normal},name:"loadBitmapFont",test:t=>i.includes(x.A.extname(t).toLowerCase()),testParse:async t=>n.D.test(t)||e.s.test(t),async parse(t,K,D){const a=n.D.test(t)?n.D.parse(t):e.s.parse(t),{src:N}=K,{pages:W}=a,x=[],i=a.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let t=0;t<W.length;++t){let K=W[t].file;K=G.Y(K,N),x.push({src:K,data:i})}const z=await D.load(x),I=x.map((t=>z[t.src]));return new b.B({data:a,textures:I},N)},async load(t,K){const D=await N.e.get().fetch(t);return await D.text()},async unload(t,K,D){await Promise.all(t.pages.map((t=>D.unload(t.texture.source._sourceOrigin)))),t.destroy()}}},123036:(t,K,D)=>{var a=D(992178),G=D(363020),N=D(721013),W=D(283863),x=D(823040),b=D(338643),n=D(270679),e=D(149660),i=D(32365),z=D(138590),I=D(720711),Z=D(92840),w=D(418055);const m={name:"local-uniform-msdf-bit",vertex:{header:`\n            struct LocalUniforms {\n                uColor:vec4<f32>,\n                uTransformMatrix:mat3x3<f32>,\n                uDistance: f32,\n                uRound:f32,\n            }\n\n            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;\n        `,main:`\n            vColor *= localUniforms.uColor;\n            modelMatrix *= localUniforms.uTransformMatrix;\n        `,end:`\n            if(localUniforms.uRound == 1)\n            {\n                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n            }\n        `},fragment:{header:`\n            struct LocalUniforms {\n                uColor:vec4<f32>,\n                uTransformMatrix:mat3x3<f32>,\n                uDistance: f32\n            }\n\n            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;\n         `,main:` \n            outColor = vec4<f32>(calculateMSDFAlpha(outColor, localUniforms.uColor, localUniforms.uDistance));\n        `}},u={name:"local-uniform-msdf-bit",vertex:{header:`\n            uniform mat3 uTransformMatrix;\n            uniform vec4 uColor;\n            uniform float uRound;\n        `,main:`\n            vColor *= uColor;\n            modelMatrix *= uTransformMatrix;\n        `,end:`\n            if(uRound == 1.)\n            {\n                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n            }\n        `},fragment:{header:`\n            uniform float uDistance;\n         `,main:` \n            outColor = vec4(calculateMSDFAlpha(outColor, vColor, uDistance));\n        `}},d={name:"msdf-bit",fragment:{header:`\n            fn calculateMSDFAlpha(msdfColor:vec4<f32>, shapeColor:vec4<f32>, distance:f32) -> f32 {\n                \n                // MSDF\n                var median = msdfColor.r + msdfColor.g + msdfColor.b -\n                    min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -\n                    max(msdfColor.r, max(msdfColor.g, msdfColor.b));\n            \n                // SDF\n                median = min(median, msdfColor.a);\n\n                var screenPxDistance = distance * (median - 0.5);\n                var alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n                if (median < 0.01) {\n                    alpha = 0.0;\n                } else if (median > 0.99) {\n                    alpha = 1.0;\n                }\n\n                // Gamma correction for coverage-like alpha\n                var luma: f32 = dot(shapeColor.rgb, vec3<f32>(0.299, 0.587, 0.114));\n                var gamma: f32 = mix(1.0, 1.0 / 2.2, luma);\n                var coverage: f32 = pow(shapeColor.a * alpha, gamma);\n\n                return coverage;\n             \n            }\n        `}},E={name:"msdf-bit",fragment:{header:`\n            float calculateMSDFAlpha(vec4 msdfColor, vec4 shapeColor, float distance) {\n                \n                // MSDF\n                float median = msdfColor.r + msdfColor.g + msdfColor.b -\n                                min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -\n                                max(msdfColor.r, max(msdfColor.g, msdfColor.b));\n               \n                // SDF\n                median = min(median, msdfColor.a);\n            \n                float screenPxDistance = distance * (median - 0.5);\n                float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n           \n                if (median < 0.01) {\n                    alpha = 0.0;\n                } else if (median > 0.99) {\n                    alpha = 1.0;\n                }\n\n                // Gamma correction for coverage-like alpha\n                float luma = dot(shapeColor.rgb, vec3(0.299, 0.587, 0.114));\n                float gamma = mix(1.0, 1.0 / 2.2, luma);\n                float coverage = pow(shapeColor.a * alpha, gamma);  \n              \n                return coverage;\n            }\n        `}};let l,Q;class P extends Z.M{constructor(){const t=new w.k({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new x.u,type:"mat3x3<f32>"},uDistance:{value:4,type:"f32"},uRound:{value:0,type:"f32"}}),K=b.a();null!=l||(l=n.v({name:"sdf-shader",bits:[e.F,i._(K),m,d,z.b]})),null!=Q||(Q=n.I({name:"sdf-shader",bits:[e.a,i.P(K),u,E,z.m]})),super({glProgram:Q,gpuProgram:l,resources:{localUniforms:t,batchSamplers:I.n(K)}})}}var y=D(201812),q=D(222746);class X{constructor(t){this._gpuBitmapText={},this._destroyRenderableBound=this.destroyRenderable.bind(this),this._renderer=t,this._renderer.renderableGC.addManagedHash(this,"_gpuBitmapText")}validateRenderable(t){const K=this._getGpuBitmapText(t);return t._didTextUpdate&&(t._didTextUpdate=!1,this._updateContext(t,K)),this._renderer.renderPipes.graphics.validateRenderable(K)}addRenderable(t,K){const D=this._getGpuBitmapText(t);h(t,D),t._didTextUpdate&&(t._didTextUpdate=!1,this._updateContext(t,D)),this._renderer.renderPipes.graphics.addRenderable(D,K),D.context.customShader&&this._updateDistanceField(t)}destroyRenderable(t){t.off("destroyed",this._destroyRenderableBound),this._destroyRenderableByUid(t.uid)}_destroyRenderableByUid(t){const K=this._gpuBitmapText[t].context;K.customShader&&(N.Z.return(K.customShader),K.customShader=null),N.Z.return(this._gpuBitmapText[t]),this._gpuBitmapText[t]=null}updateRenderable(t){const K=this._getGpuBitmapText(t);h(t,K),this._renderer.renderPipes.graphics.updateRenderable(K),K.context.customShader&&this._updateDistanceField(t)}_updateContext(t,K){const{context:D}=K,a=y.c.getFont(t.text,t._style);D.clear(),"none"!==a.distanceField.type&&(D.customShader||(D.customShader=N.Z.get(P)));const G=Array.from(t.text),W=t._style;let x=a.baseLineOffset;const b=q.Z(G,W,a,!0);let n=0;const e=W.padding,i=b.scale;let z=b.width,I=b.height+b.offsetY;W._stroke&&(z+=W._stroke.width/i,I+=W._stroke.width/i),D.translate(-t._anchor._x*z-e,-t._anchor._y*I-e).scale(i,i);const Z=a.applyFillAsTint?W._fill.color:16777215;for(let t=0;t<b.lines.length;t++){const K=b.lines[t];for(let t=0;t<K.charPositions.length;t++){const N=G[n++],W=a.chars[N];(null==W?void 0:W.texture)&&D.texture(W.texture,Z||"black",Math.round(K.charPositions[t]+W.xOffset),Math.round(x+W.yOffset))}x+=a.lineHeight}}_getGpuBitmapText(t){return this._gpuBitmapText[t.uid]||this.initGpuText(t)}initGpuText(t){const K=N.Z.get(W.A);return this._gpuBitmapText[t.uid]=K,this._updateContext(t,K),t.on("destroyed",this._destroyRenderableBound),this._gpuBitmapText[t.uid]}_updateDistanceField(t){const K=this._getGpuBitmapText(t).context,D=t._style.fontFamily,a=G.l.get(`${D}-bitmap`),{a:N,b:W,c:x,d:b}=t.groupTransform,n=Math.sqrt(N*N+W*W),e=Math.sqrt(x*x+b*b),i=(Math.abs(n)+Math.abs(e))/2,z=a.baseRenderedFontSize/t._style.fontSize,I=i*a.distanceField.range*(1/z);K.customShader.resources.localUniforms.uniforms.uDistance=I}destroy(){for(const t in this._gpuBitmapText)this._destroyRenderableByUid(t);this._gpuBitmapText=null,this._renderer=null}}function h(t,K){K.groupTransform=t.groupTransform,K.groupColorAlpha=t.groupColorAlpha,K.groupColor=t.groupColor,K.groupBlendMode=t.groupBlendMode,K.globalDisplayStatus=t.globalDisplayStatus,K.groupTransform=t.groupTransform,K.localDisplayStatus=t.localDisplayStatus,K.groupAlpha=t.groupAlpha,K._roundPixels=t._roundPixels}X.extension={type:[a.Ag.WebGLPipes,a.Ag.WebGPUPipes,a.Ag.CanvasPipes],name:"bitmapText"},a.XO.add(X)},222746:(t,K,D)=>{function a(t,K,D,a){const G={width:0,height:0,offsetY:0,scale:K.fontSize/D.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};G.offsetY=D.baseLineOffset;let N=G.lines[0],W=null,x=!0;const b={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},n=t=>{const K=N.width;for(let D=0;D<b.index;D++){const a=t.positions[D];N.chars.push(t.chars[D]),N.charPositions.push(a+K)}N.width+=t.width,x=!1,b.width=0,b.index=0,b.chars.length=0},e=()=>{let t=N.chars.length-1;if(a){let K=N.chars[t];for(;" "===K;)N.width-=D.chars[K].xAdvance,K=N.chars[--t]}G.width=Math.max(G.width,N.width),N={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},x=!0,G.lines.push(N),G.height+=D.lineHeight},i=D.baseMeasurementFontSize/K.fontSize,z=K.letterSpacing*i,I=K.wordWrapWidth*i;for(let a=0;a<t.length+1;a++){let G;const i=a===t.length;i||(G=t[a]);const Z=D.chars[G]||D.chars[" "];if(/(?:\s)/.test(G)||"\r"===G||"\n"===G||i){if(!x&&K.wordWrap&&N.width+b.width-z>I?(e(),n(b),i||N.charPositions.push(0)):(b.start=N.width,n(b),i||N.charPositions.push(0)),"\r"===G||"\n"===G)0!==N.width&&e();else if(!i){const t=Z.xAdvance+(Z.kerning[W]||0)+z;N.width+=t,N.spaceWidth=t,N.spacesIndex.push(N.charPositions.length),N.chars.push(G)}}else{const t=Z.kerning[W]||0,K=Z.xAdvance+t+z;b.positions[b.index++]=b.width+t,b.chars.push(G),b.width+=K}W=G}return e(),"center"===K.align?function(t){for(let K=0;K<t.lines.length;K++){const D=t.lines[K],a=t.width/2-D.width/2;for(let t=0;t<D.charPositions.length;t++)D.charPositions[t]+=a}}(G):"right"===K.align?function(t){for(let K=0;K<t.lines.length;K++){const D=t.lines[K],a=t.width-D.width;for(let t=0;t<D.charPositions.length;t++)D.charPositions[t]+=a}}(G):"justify"===K.align&&function(t){const K=t.width;for(let D=0;D<t.lines.length;D++){const a=t.lines[D];let G=0,N=a.spacesIndex[G++],W=0;const x=a.spacesIndex.length,b=(K-a.width)/x;for(let t=0;t<a.charPositions.length;t++)t===N&&(N=a.spacesIndex[G++],W+=b),a.charPositions[t]+=W}}(G),G}D.d(K,{Z:()=>a})},453712:(t,K,D)=>{D.d(K,{x:()=>z});var a=D(610162),G=D(534661),N=D(5319),W=D(387473),x=D(315725),b=D(572464),n=D(867659),e=D(389330);const i=class t extends a.A{constructor(K={}){super(),function(t){var K,D,a,b,n;const e=t;if("boolean"==typeof e.dropShadow&&e.dropShadow){const G=z.defaultDropShadow;t.dropShadow={alpha:null!==(K=e.dropShadowAlpha)&&void 0!==K?K:G.alpha,angle:null!==(D=e.dropShadowAngle)&&void 0!==D?D:G.angle,blur:null!==(a=e.dropShadowBlur)&&void 0!==a?a:G.blur,color:null!==(b=e.dropShadowColor)&&void 0!==b?b:G.color,distance:null!==(n=e.dropShadowDistance)&&void 0!==n?n:G.distance}}if(void 0!==e.strokeThickness){N.t6(N.lj,"strokeThickness is now a part of stroke");const K=e.stroke;let D={};if(G.Q.isColorLike(K))D.color=K;else if(K instanceof W._||K instanceof x.m)D.fill=K;else{if(!Object.hasOwnProperty.call(K,"color")&&!Object.hasOwnProperty.call(K,"fill"))throw new Error("Invalid stroke value.");D=K}t.stroke={...D,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){let K;N.t6(N.lj,"gradient fill is now a fill pattern: `new FillGradient(...)`"),null==t.fontSize?t.fontSize=z.defaultTextStyle.fontSize:K="string"==typeof t.fontSize?parseInt(t.fontSize,10):t.fontSize;const D=new W._(0,0,0,1.7*K),a=e.fillGradientStops.map((t=>G.Q.shared.setValue(t).toNumber()));a.forEach(((t,K)=>{const G=K/(a.length-1);D.addColorStop(G,t)})),t.fill={fill:D}}}(K);const D={...t.defaultTextStyle,...K};for(const t in D)this[t]=D[t];this.update()}get align(){return this._align}set align(t){this._align=t,this.update()}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords=t,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(K){this._dropShadow=null!==K&&"object"==typeof K?this._createProxy({...t.defaultDropShadow,...K}):K?this._createProxy({...t.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t,this.update()}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize="string"==typeof t?parseInt(t,10):t,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t,this.update()}get leading(){return this._leading}set leading(t){this._leading=t,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t,this.update()}get padding(){return this._padding}set padding(t){this._padding=t,this.update()}get trim(){return this._trim}set trim(t){this._trim=t,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace=t,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap=t,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth=t,this.update()}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...b.T.defaultFillStyle,...t},(()=>{this._fill=n.w({...this._originalFill},b.T.defaultFillStyle)}))),this._fill=n.w(0===t?"black":t,b.T.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...b.T.defaultStrokeStyle,...t},(()=>{this._stroke=n.T({...this._originalStroke},b.T.defaultStrokeStyle)}))),this._stroke=n.T(t,b.T.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=e.V(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const K=t.defaultTextStyle;for(const t in K)this[t]=K[t]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new t({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(t=!1){var K,D,a,G;if(this.removeAllListeners(),"boolean"==typeof t?t:null==t?void 0:t.texture){const N="boolean"==typeof t?t:null==t?void 0:t.textureSource;(null===(K=this._fill)||void 0===K?void 0:K.texture)&&this._fill.texture.destroy(N),(null===(D=this._originalFill)||void 0===D?void 0:D.texture)&&this._originalFill.texture.destroy(N),(null===(a=this._stroke)||void 0===a?void 0:a.texture)&&this._stroke.texture.destroy(N),(null===(G=this._originalStroke)||void 0===G?void 0:G.texture)&&this._originalStroke.texture.destroy(N)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,K){return new Proxy(t,{set:(t,D,a)=>(t[D]=a,null==K||K(D,a),this.update(),!0)})}_isFillStyle(t){return null!==(null!=t?t:null)&&!(G.Q.isColorLike(t)||t instanceof W._||t instanceof x.m)}};i.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5},i.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let z=i},593865:(t,K,D)=>{D.d(K,{P:()=>x});var a=D(505777),G=D(706215);const N={willReadFrequently:!0},W=class t{static get experimentalLetterSpacingSupported(){let K=t._experimentalLetterSpacingSupported;if(void 0!==K){const D=a.e.get().getCanvasRenderingContext2D().prototype;K=t._experimentalLetterSpacingSupported="letterSpacing"in D||"textLetterSpacing"in D}return K}constructor(t,K,D,a,G,N,W,x,b){this.text=t,this.style=K,this.width=D,this.height=a,this.lines=G,this.lineWidths=N,this.lineHeight=W,this.maxLineWidth=x,this.fontProperties=b}static measureText(K=" ",D,a=t._canvas,N=D.wordWrap){var W;const x=`${K}:${D.styleKey}`;if(t._measurementCache[x])return t._measurementCache[x];const b=G.Z(D),n=t.measureFont(b);0===n.fontSize&&(n.fontSize=D.fontSize,n.ascent=D.fontSize);const e=t.__context;e.font=b;const i=(N?t._wordWrap(K,D,a):K).split(/(?:\r\n|\r|\n)/),z=new Array(i.length);let I=0;for(let K=0;K<i.length;K++){const a=t._measureText(i[K],D.letterSpacing,e);z[K]=a,I=Math.max(I,a)}const Z=(null===(W=D._stroke)||void 0===W?void 0:W.width)||0;let w=I+Z;D.dropShadow&&(w+=D.dropShadow.distance);const m=D.lineHeight||n.fontSize;let u=Math.max(m,n.fontSize+Z)+(i.length-1)*(m+D.leading);return D.dropShadow&&(u+=D.dropShadow.distance),new t(K,D,w,u,i,z,m+D.leading,I,n)}static _measureText(K,D,a){let G=!1;t.experimentalLetterSpacingSupported&&(t.experimentalLetterSpacing?(a.letterSpacing=`${D}px`,a.textLetterSpacing=`${D}px`,G=!0):(a.letterSpacing="0px",a.textLetterSpacing="0px"));const N=a.measureText(K);let W=N.width;const x=-N.actualBoundingBoxLeft;let b=N.actualBoundingBoxRight-x;if(W>0)if(G)W-=D,b-=D;else{const a=(t.graphemeSegmenter(K).length-1)*D;W+=a,b+=a}return Math.max(W,b)}static _wordWrap(K,D,a=t._canvas){const G=a.getContext("2d",N);let W=0,x="",b="";const n=Object.create(null),{letterSpacing:e,whiteSpace:i}=D,z=t._collapseSpaces(i),I=t._collapseNewlines(i);let Z=!z;const w=D.wordWrapWidth+e,m=t._tokenize(K);for(let K=0;K<m.length;K++){let a=m[K];if(t._isNewline(a)){if(!I){b+=t._addLine(x),Z=!z,x="",W=0;continue}a=" "}if(z){const K=t.isBreakingSpace(a),D=t.isBreakingSpace(x[x.length-1]);if(K&&D)continue}const N=t._getFromCache(a,e,n,G);if(N>w)if(""!==x&&(b+=t._addLine(x),x="",W=0),t.canBreakWords(a,D.breakWords)){const K=t.wordWrapSplit(a);for(let N=0;N<K.length;N++){let i=K[N],z=i,I=1;for(;K[N+I];){const G=K[N+I];if(t.canBreakChars(z,G,a,N,D.breakWords))break;i+=G,z=G,I++}N+=I-1;const m=t._getFromCache(i,e,n,G);m+W>w&&(b+=t._addLine(x),Z=!1,x="",W=0),x+=i,W+=m}}else{x.length>0&&(b+=t._addLine(x),x="",W=0);const D=K===m.length-1;b+=t._addLine(a,!D),Z=!1,x="",W=0}else N+W>w&&(Z=!1,b+=t._addLine(x),x="",W=0),(x.length>0||!t.isBreakingSpace(a)||Z)&&(x+=a,W+=N)}return b+=t._addLine(x,!1),b}static _addLine(K,D=!0){return K=t._trimRight(K),D?`${K}\n`:K}static _getFromCache(K,D,a,G){let N=a[K];return"number"!=typeof N&&(N=t._measureText(K,D,G)+D,a[K]=N),N}static _collapseSpaces(t){return"normal"===t||"pre-line"===t}static _collapseNewlines(t){return"normal"===t}static _trimRight(K){if("string"!=typeof K)return"";for(let D=K.length-1;D>=0;D--){const a=K[D];if(!t.isBreakingSpace(a))break;K=K.slice(0,-1)}return K}static _isNewline(K){return"string"==typeof K&&t._newlines.includes(K.charCodeAt(0))}static isBreakingSpace(K,D){return"string"==typeof K&&t._breakingSpaces.includes(K.charCodeAt(0))}static _tokenize(K){const D=[];let a="";if("string"!=typeof K)return D;for(let G=0;G<K.length;G++){const N=K[G],W=K[G+1];t.isBreakingSpace(N,W)||t._isNewline(N)?(""!==a&&(D.push(a),a=""),D.push(N)):a+=N}return""!==a&&D.push(a),D}static canBreakWords(t,K){return K}static canBreakChars(t,K,D,a,G){return!0}static wordWrapSplit(K){return t.graphemeSegmenter(K)}static measureFont(K){if(t._fonts[K])return t._fonts[K];const D=t._context;D.font=K;const a=D.measureText(t.METRICS_STRING+t.BASELINE_SYMBOL),G={ascent:a.actualBoundingBoxAscent,descent:a.actualBoundingBoxDescent,fontSize:a.actualBoundingBoxAscent+a.actualBoundingBoxDescent};return t._fonts[K]=G,G}static clearMetrics(K=""){K?delete t._fonts[K]:t._fonts={}}static get _canvas(){if(!t.__canvas){let K;try{const D=new OffscreenCanvas(0,0),G=D.getContext("2d",N);if(null==G?void 0:G.measureText)return t.__canvas=D,D;K=a.e.get().createCanvas()}catch(t){K=a.e.get().createCanvas()}K.width=K.height=10,t.__canvas=K}return t.__canvas}static get _context(){return t.__context||(t.__context=t._canvas.getContext("2d",N)),t.__context}};W.METRICS_STRING="|ÉqÅ",W.BASELINE_SYMBOL="M",W.BASELINE_MULTIPLIER=1.4,W.HEIGHT_MULTIPLIER=2,W.graphemeSegmenter=(()=>{if("function"==typeof(null===Intl||void 0===Intl?void 0:Intl.Segmenter)){const t=new Intl.Segmenter;return K=>[...t.segment(K)].map((t=>t.segment))}return t=>[...t]})(),W.experimentalLetterSpacing=!1,W._fonts={},W._newlines=[10,13],W._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],W._measurementCache={};let x=W},706215:(t,K,D)=>{D.d(K,{Z:()=>G});const a=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function G(t){const K="number"==typeof t.fontSize?`${t.fontSize}px`:t.fontSize;let D=t.fontFamily;Array.isArray(t.fontFamily)||(D=t.fontFamily.split(","));for(let t=D.length-1;t>=0;t--){let K=D[t].trim();/([\"\'])[^\'\"]+\1/.test(K)||a.includes(K)||(K=`"${K}"`),D[t]=K}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${K} ${D.join(",")}`}},914759:(t,K,D)=>{D.d(K,{r:()=>n});var a=D(534661),G=D(823040),N=D(177487),W=D(229995),x=D(387473),b=D(315725);function n(t,K){var D;if(t.texture===N.g.WHITE&&!t.fill)return a.Q.shared.setValue(t.color).setAlpha(null!==(D=t.alpha)&&void 0!==D?D:1).toHexa();if(!t.fill){const D=K.createPattern(t.texture.source.resource,"repeat"),a=t.matrix.copyTo(G.u.shared);return a.scale(t.texture.frame.width,t.texture.frame.height),D.setTransform(a),D}if(t.fill instanceof b.m){const D=t.fill,a=K.createPattern(D.texture.source.resource,"repeat"),N=D.transform.copyTo(G.u.shared);return N.scale(D.texture.frame.width,D.texture.frame.height),a.setTransform(N),a}if(t.fill instanceof x._){const D=t.fill;if("linear"===D.type){const t=K.createLinearGradient(D.x0,D.y0,D.x1,D.y1);return D.gradientStops.forEach((K=>{t.addColorStop(K.offset,a.Q.shared.setValue(K.color).toHex())})),t}}return W.R("FillStyle not recognised",t),"red"}},389330:(t,K,D)=>{D.d(K,{V:()=>N});var a=D(534661);const G=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function N(t){const K=[];let D=0;for(let a=0;a<G.length;a++){const N=`_${G[a]}`;K[D++]=t[N]}return D=W(t._fill,K,D),D=function(t,K,D){return t?(D=W(t,K,D),K[D++]=t.width,K[D++]=t.alignment,K[D++]=t.cap,K[D++]=t.join,K[D++]=t.miterLimit,D):D}(t._stroke,K,D),D=function(t,K,D){return t?(K[D++]=t.alpha,K[D++]=t.angle,K[D++]=t.blur,K[D++]=t.distance,K[D++]=a.Q.shared.setValue(t.color).toNumber(),D):D}(t.dropShadow,K,D),K.join("-")}function W(t,K,D){var a;return t?(K[D++]=t.color,K[D++]=t.alpha,K[D++]=null===(a=t.fill)||void 0===a?void 0:a.styleKey,D):D}},979822:(t,K,D)=>{D.d(K,{l:()=>N});var a=D(53569),G=D(748459);class N extends G.mc{constructor(){super(...arguments),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=0,this._lastInstructionTick=-1,this._bounds=new a.c(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const K=this.bounds,{x:D,y:a}=t;return D>=K.minX&&D<=K.maxX&&a>=K.minY&&a<=K.maxY}onViewUpdate(){if(this._didViewChangeTick++,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){super.destroy(t),this._bounds=null}}},336384:(t,K,D)=>{D.d(K,{z:()=>W});var a=D(377223),G=D(177487);const N=class t{constructor(t,K){this.linkedSheets=[],this._texture=t instanceof G.g?t:null,this.textureSource=t.source,this.textures={},this.animations={},this.data=K;const D=parseFloat(K.meta.scale);D?(this.resolution=D,t.source.resolution=this.resolution):this.resolution=t.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise((K=>{this._callback=K,this._batchIndex=0,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()}))}_processFrames(K){let D=K;const N=t.BATCH_SIZE;for(;D-K<N&&D<this._frameKeys.length;){const t=this._frameKeys[D],K=this._frames[t],N=K.frame;if(N){let D=null,W=null;const x=!1!==K.trimmed&&K.sourceSize?K.sourceSize:K.frame,b=new a.M(0,0,Math.floor(x.w)/this.resolution,Math.floor(x.h)/this.resolution);D=K.rotated?new a.M(Math.floor(N.x)/this.resolution,Math.floor(N.y)/this.resolution,Math.floor(N.h)/this.resolution,Math.floor(N.w)/this.resolution):new a.M(Math.floor(N.x)/this.resolution,Math.floor(N.y)/this.resolution,Math.floor(N.w)/this.resolution,Math.floor(N.h)/this.resolution),!1!==K.trimmed&&K.spriteSourceSize&&(W=new a.M(Math.floor(K.spriteSourceSize.x)/this.resolution,Math.floor(K.spriteSourceSize.y)/this.resolution,Math.floor(N.w)/this.resolution,Math.floor(N.h)/this.resolution)),this.textures[t]=new G.g({source:this.textureSource,frame:D,orig:b,trim:W,rotate:K.rotated?2:0,defaultAnchor:K.anchor,defaultBorders:K.borders,label:t.toString()})}D++}}_processAnimations(){const t=this.data.animations||{};for(const K in t){this.animations[K]=[];for(let D=0;D<t[K].length;D++){const a=t[K][D];this.animations[K].push(this.textures[a])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout((()=>{this._batchIndex*t.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())}),0)}destroy(t=!1){var K;for(const t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null===(K=this._texture)||void 0===K||K.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};N.BATCH_SIZE=1e3;let W=N},208929:(t,K,D)=>{var a=D(992178),G=D(168786),N=D(282637),W=D(714252),x=D(177487),b=D(58496),n=D(336384);const e=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function i(t,K,D){const a={};if(t.forEach((t=>{a[t]=K})),Object.keys(K.textures).forEach((t=>{a[t]=K.textures[t]})),!D){const D=b.A.dirname(t[0]);K.linkedSheets.forEach(((t,G)=>{const N=i([`${D}/${K.data.meta.related_multi_packs[G]}`],t,!0);Object.assign(a,N)}))}return a}const z={extension:a.Ag.Asset,cache:{test:t=>t instanceof n.z,getCacheableAssets:(t,K)=>i(t,K,!1)},resolver:{extension:{type:a.Ag.ResolveParser,name:"resolveSpritesheet"},test:t=>{const K=t.split("?")[0].split("."),D=K.pop(),a=K.pop();return"json"===D&&e.includes(a)},parse:t=>{var K,D;const a=t.split(".");return{resolution:parseFloat(null!==(D=null===(K=N.x.RETINA_PREFIX.exec(t))||void 0===K?void 0:K[1])&&void 0!==D?D:"1"),format:a[a.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:a.Ag.LoadParser,priority:G.T.Normal,name:"spritesheetLoader"},testParse:async(t,K)=>".json"===b.A.extname(K.src).toLowerCase()&&!!t.frames,async parse(t,K,D){var a,G,N;const{texture:e,imageFilename:i}=null!==(a=null==K?void 0:K.data)&&void 0!==a?a:{};let z,I=b.A.dirname(K.src);if(I&&I.lastIndexOf("/")!==I.length-1&&(I+="/"),e instanceof x.g)z=e;else{const a=W.Y(I+(null!=i?i:t.meta.image),K.src);z=(await D.load([a]))[a]}const Z=new n.z(z.source,t);await Z.parse();const w=null===(G=null==t?void 0:t.meta)||void 0===G?void 0:G.related_multi_packs;if(Array.isArray(w)){const t=[];for(const a of w){if("string"!=typeof a)continue;let G=I+a;(null===(N=K.data)||void 0===N?void 0:N.ignoreMultiPack)||(G=W.Y(G,K.src),t.push(D.load({src:G,data:{ignoreMultiPack:!0}})))}const a=await Promise.all(t);Z.linkedSheets=a,a.forEach((t=>{t.linkedSheets=[Z].concat(Z.linkedSheets.filter((K=>K!==t)))}))}return Z},async unload(t,K,D){await D.unload(t.textureSource._sourceOrigin),t.destroy(!1)}}};a.XO.add(z)},463996:(t,K,D)=>{D.d(K,{R:()=>W});var a=D(744201);class G{constructor(t,K=null,D=0,a=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=K,this.priority=D,this._once=a}match(t,K=null){return this._fn===t&&this._context===K}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const K=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),K}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const K=this.next;return this.next=t?null:K,this.previous=null,K}}const N=class t{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new G(null,null,1/0),this.deltaMS=1/t.targetFPMS,this.elapsedMS=1/t.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,K,D=a.d.NORMAL){return this._addListener(new G(t,K,D))}addOnce(t,K,D=a.d.NORMAL){return this._addListener(new G(t,K,D,!0))}_addListener(t){let K=this._head.next,D=this._head;if(K){for(;K;){if(t.priority>K.priority){t.connect(D);break}D=K,K=K.next}t.previous||t.connect(D)}else t.connect(D);return this._startIfPossible(),this}remove(t,K){let D=this._head.next;for(;D;)D=D.match(t,K)?D.destroy():D.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,K=this._head;for(;K=K.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(K=performance.now()){let D;if(K>this.lastTime){if(D=this.elapsedMS=K-this.lastTime,D>this._maxElapsedMS&&(D=this._maxElapsedMS),D*=this.speed,this._minElapsedMS){const t=K-this._lastFrame|0;if(t<this._minElapsedMS)return;this._lastFrame=K-t%this._minElapsedMS}this.deltaMS=D,this.deltaTime=this.deltaMS*t.targetFPMS;const a=this._head;let G=a.next;for(;G;)G=G.emit(this);a.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=K}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(K){const D=Math.min(this.maxFPS,K),a=Math.min(Math.max(0,D)/1e3,t.targetFPMS);this._maxElapsedMS=1/a}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(0===t)this._minElapsedMS=0;else{const K=Math.max(this.minFPS,t);this._minElapsedMS=1/(K/1e3)}}static get shared(){if(!t._shared){const K=t._shared=new t;K.autoStart=!0,K._protected=!0}return t._shared}static get system(){if(!t._system){const K=t._system=new t;K.autoStart=!0,K._protected=!0}return t._system}};N.targetFPMS=.06;let W=N},744201:(t,K,D)=>{D.d(K,{d:()=>a});var a=(t=>(t[t["INTERACTION"]=50]="INTERACTION",t[t["HIGH"]=25]="HIGH",t[t["NORMAL"]=0]="NORMAL",t[t["LOW"]=-25]="LOW",t[t["UTILITY"]=-50]="UTILITY",t))(a||{})},997089:(t,K,D)=>{let a;async function G(){return null!=a||(a=(async()=>{var t;const K=document.createElement("canvas").getContext("webgl");if(!K)return"premultiply-alpha-on-upload";const D=await new Promise((t=>{const K=document.createElement("video");K.onloadeddata=()=>t(K),K.onerror=()=>t(null),K.autoplay=!1,K.crossOrigin="anonymous",K.preload="auto",K.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",K.load()}));if(!D)return"premultiply-alpha-on-upload";const a=K.createTexture();K.bindTexture(K.TEXTURE_2D,a);const G=K.createFramebuffer();K.bindFramebuffer(K.FRAMEBUFFER,G),K.framebufferTexture2D(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_2D,a,0),K.pixelStorei(K.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),K.pixelStorei(K.UNPACK_COLORSPACE_CONVERSION_WEBGL,K.NONE),K.texImage2D(K.TEXTURE_2D,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,D);const N=new Uint8Array(4);return K.readPixels(0,0,1,1,K.RGBA,K.UNSIGNED_BYTE,N),K.deleteFramebuffer(G),K.deleteTexture(a),null===(t=K.getExtension("WEBGL_lose_context"))||void 0===t||t.loseContext(),N[0]<=N[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),a}D.d(K,{C:()=>G})},71265:(t,K,D)=>{D.d(K,{M:()=>W});var a=D(505777),G=D(512322);let N;function W(t){return void 0!==N||(N=(()=>{var K;const D={stencil:!0,failIfMajorPerformanceCaveat:null!=t?t:G.k.defaultOptions.failIfMajorPerformanceCaveat};try{if(!a.e.get().getWebGLRenderingContext())return!1;let t=a.e.get().createCanvas().getContext("webgl",D);const G=!!(null===(K=null==t?void 0:t.getContextAttributes())||void 0===K?void 0:K.stencil);if(t){const K=t.getExtension("WEBGL_lose_context");K&&K.loseContext()}return t=null,G}catch(t){return!1}})()),N}},132812:(t,K,D)=>{D.d(K,{V:()=>N});var a=D(505777);let G;async function N(t={}){return void 0!==G||(G=await(async()=>{const K=a.e.get().getNavigator().gpu;if(!K)return!1;try{const D=await K.requestAdapter(t);return await D.requestDevice(),!0}catch(t){return!1}})()),G}},815648:(t,K,D)=>{let a;function G(){if("boolean"==typeof a)return a;try{const t=new Function("param1","param2","param3","return param1[param2] === param3;");a=!0===t({a:"b"},"a","b")}catch(t){a=!1}return a}D.d(K,{f:()=>G})},123574:(t,K,D)=>{D.d(K,{xv:()=>a}),D(610162);const a="8.6.1"},354857:(t,K,D)=>{D.d(K,{u:()=>a});class a{constructor(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}},935440:(t,K,D)=>{function a(t,K,D){const a=t.length;let G;if(K>=a||0===D)return;const N=a-(D=K+D>a?a-K:D);for(G=K;G<N;++G)t[G]=t[G+D];t.length=N}D.d(K,{d:()=>a})},60158:(t,K,D)=>{D.d(K,{L:()=>G});const a={default:-1};function G(t="default"){return void 0===a[t]&&(a[t]=-1),++a[t]}},971817:(t,K,D)=>{function a(t,K,D,a){const{width:G,height:N}=D.orig,W=D.trim;if(W){const D=W.width,x=W.height;t.minX=W.x-K._x*G-a,t.maxX=t.minX+D,t.minY=W.y-K._y*N-a,t.maxY=t.minY+x}else t.minX=-K._x*G-a,t.maxX=t.minX+G,t.minY=-K._y*N-a,t.maxY=t.minY+N}D.d(K,{y:()=>a})},858678:(t,K,D)=>{D.d(K,{M:()=>N,d:()=>W});var a=D(992178),G=D(123574);class N{static init(){var t;null===(t=globalThis.__PIXI_APP_INIT__)||void 0===t||t.call(globalThis,this,G.xv)}static destroy(){}}N.extension=a.Ag.Application;class W{constructor(t){this._renderer=t}init(){var t;null===(t=globalThis.__PIXI_RENDERER_INIT__)||void 0===t||t.call(globalThis,this._renderer,G.xv)}destroy(){this._renderer=null}}W.extension={type:[a.Ag.WebGLSystem,a.Ag.WebGPUSystem],name:"initHook",priority:-10}},5319:(t,K,D)=>{D.d(K,{Ek:()=>N,lj:()=>G,t6:()=>W});const a={},G="8.0.0",N="8.3.4";function W(t,K,D=3){if(a[K])return;let G=(new Error).stack;void 0===G?console.warn("PixiJS Deprecation Warning: ",`${K}\nDeprecated since v${t}`):(G=G.split("\n").splice(D).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${K}\nDeprecated since v${t}`),console.warn(G),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${K}\nDeprecated since v${t}`),console.warn(G))),a[K]=!0}},229995:(t,K,D)=>{D.d(K,{R:()=>N});let a=0;const G=500;function N(...t){a!==G&&(a++,a===G?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...t))}},206348:(t,K,D)=>{D.d(K,{v:()=>G});var a=D(282637);function G(t,K=1){var D;const G=null===(D=a.x.RETINA_PREFIX)||void 0===D?void 0:D.exec(t);return G?parseFloat(G[1]):K}},58496:(t,K,D)=>{D.d(K,{A:()=>W});var a=D(505777);function G(t){if("string"!=typeof t)throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function N(t){return t.split("?")[0].split("#")[0]}const W={toPosix(t){return K="\\",D="/",t.replace(new RegExp(K.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),D);var K,D},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl:t=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t),isBlobUrl:t=>t.startsWith("blob:"),hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){G(t),t=this.toPosix(t);const K=/^file:\/\/\//.exec(t);if(K)return K[0];const D=/^[^/:]+:\/{0,2}/.exec(t);return D?D[0]:""},toAbsolute(t,K,D){if(G(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const x=N(this.toPosix(null!=K?K:a.e.get().getBaseUrl())),b=N(this.toPosix(null!=D?D:this.rootname(x)));return(t=this.toPosix(t)).startsWith("/")?W.join(b,t.slice(1)):this.isAbsolute(t)?t:this.join(x,t)},normalize(t){if(G(t),0===t.length)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;let K="";const D=(t=this.toPosix(t)).startsWith("/");this.hasProtocol(t)&&(K=this.rootname(t),t=t.slice(K.length));const a=t.endsWith("/");return(t=function(t,K){let D="",a=0,G=-1,N=0,W=-1;for(let x=0;x<=t.length;++x){if(x<t.length)W=t.charCodeAt(x);else{if(47===W)break;W=47}if(47===W){if(G===x-1||1===N);else if(G!==x-1&&2===N){if(D.length<2||2!==a||46!==D.charCodeAt(D.length-1)||46!==D.charCodeAt(D.length-2))if(D.length>2){const t=D.lastIndexOf("/");if(t!==D.length-1){-1===t?(D="",a=0):(D=D.slice(0,t),a=D.length-1-D.lastIndexOf("/")),G=x,N=0;continue}}else if(2===D.length||1===D.length){D="",a=0,G=x,N=0;continue}K&&(D.length>0?D+="/..":D="..",a=2)}else D.length>0?D+=`/${t.slice(G+1,x)}`:D=t.slice(G+1,x),a=x-G-1;G=x,N=0}else 46===W&&-1!==N?++N:N=-1}return D}(t,!1)).length>0&&a&&(t+="/"),D?`/${t}`:K+t},isAbsolute(t){return G(t),t=this.toPosix(t),!!this.hasProtocol(t)||t.startsWith("/")},join(...t){var K;if(0===t.length)return".";let D;for(let a=0;a<t.length;++a){const N=t[a];if(G(N),N.length>0)if(void 0===D)D=N;else{const G=null!==(K=t[a-1])&&void 0!==K?K:"";this.joinExtensions.includes(this.extname(G).toLowerCase())?D+=`/../${N}`:D+=`/${N}`}}return void 0===D?".":this.normalize(D)},dirname(t){if(G(t),0===t.length)return".";let K=(t=this.toPosix(t)).charCodeAt(0);const D=47===K;let a=-1,N=!0;const W=this.getProtocol(t),x=t;for(let D=(t=t.slice(W.length)).length-1;D>=1;--D)if(K=t.charCodeAt(D),47===K){if(!N){a=D;break}}else N=!1;return-1===a?D?"/":this.isUrl(x)?W+t:W:D&&1===a?"//":W+t.slice(0,a)},rootname(t){G(t);let K="";if(K=(t=this.toPosix(t)).startsWith("/")?"/":this.getProtocol(t),this.isUrl(t)){const D=t.indexOf("/",K.length);K=-1!==D?t.slice(0,D):t,K.endsWith("/")||(K+="/")}return K},basename(t,K){G(t),K&&G(K),t=N(this.toPosix(t));let D,a=0,W=-1,x=!0;if(void 0!==K&&K.length>0&&K.length<=t.length){if(K.length===t.length&&K===t)return"";let G=K.length-1,N=-1;for(D=t.length-1;D>=0;--D){const b=t.charCodeAt(D);if(47===b){if(!x){a=D+1;break}}else-1===N&&(x=!1,N=D+1),G>=0&&(b===K.charCodeAt(G)?-1==--G&&(W=D):(G=-1,W=N))}return a===W?W=N:-1===W&&(W=t.length),t.slice(a,W)}for(D=t.length-1;D>=0;--D)if(47===t.charCodeAt(D)){if(!x){a=D+1;break}}else-1===W&&(x=!1,W=D+1);return-1===W?"":t.slice(a,W)},extname(t){G(t);let K=-1,D=0,a=-1,W=!0,x=0;for(let G=(t=N(this.toPosix(t))).length-1;G>=0;--G){const N=t.charCodeAt(G);if(47!==N)-1===a&&(W=!1,a=G+1),46===N?-1===K?K=G:1!==x&&(x=1):-1!==K&&(x=-1);else if(!W){D=G+1;break}}return-1===K||-1===a||0===x||1===x&&K===a-1&&K===D+1?"":t.slice(K,a)},parse(t){G(t);const K={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return K;let D=(t=N(this.toPosix(t))).charCodeAt(0);const a=this.isAbsolute(t);let W;const x="";K.root=this.rootname(t),W=a||this.hasProtocol(t)?1:0;let b=-1,n=0,e=-1,i=!0,z=t.length-1,I=0;for(;z>=W;--z)if(D=t.charCodeAt(z),47!==D)-1===e&&(i=!1,e=z+1),46===D?-1===b?b=z:1!==I&&(I=1):-1!==b&&(I=-1);else if(!i){n=z+1;break}return-1===b||-1===e||0===I||1===I&&b===e-1&&b===n+1?-1!==e&&(K.base=K.name=0===n&&a?t.slice(1,e):t.slice(n,e)):(0===n&&a?(K.name=t.slice(1,b),K.base=t.slice(1,e)):(K.name=t.slice(n,b),K.base=t.slice(n,e)),K.ext=t.slice(b,e)),K.dir=this.dirname(t),x&&(K.dir=x+K.dir),K},sep:"/",delimiter:":",joinExtensions:[".html"]}},413508:(t,K,D)=>{D.d(K,{b:()=>a});class a{constructor(t,K){this._pool=[],this._count=0,this._index=0,this._classType=t,K&&this.prepopulate(K)}prepopulate(t){for(let K=0;K<t;K++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){var K;let D;return D=this._index>0?this._pool[--this._index]:new this._classType,null===(K=D.init)||void 0===K||K.call(D,t),D}return(t){var K;null===(K=t.reset)||void 0===K||K.call(t),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}},721013:(t,K,D)=>{D.d(K,{Z:()=>G});var a=D(413508);const G=new class{constructor(){this._poolsByClass=new Map}prepopulate(t,K){this.getPool(t).prepopulate(K)}get(t,K){return this.getPool(t).get(K)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new a.b(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach((K=>{const D=t[K._classType.name]?K._classType.name+K._classType.ID:K._classType.name;t[D]={free:K.totalFree,used:K.totalUsed,size:K.totalSize}})),t}}},557108:(t,K,D)=>{D.d(K,{T9:()=>i,WO:()=>W,Y8:()=>at.Y,sZ:()=>H});var a=D(316197);const G={loader:a.Ag.LoadParser,resolver:a.Ag.ResolveParser,cache:a.Ag.CacheParser,detection:a.Ag.DetectionParser};a.XO.handle(a.Ag.Asset,(t=>{const K=t.ref;Object.entries(G).filter((([t])=>!!K[t])).forEach((([t,D])=>{var G;return a.XO.add(Object.assign(K[t],{extension:null!==(G=K[t].extension)&&void 0!==G?G:D}))}))}),(t=>{const K=t.ref;Object.keys(G).filter((t=>!!K[t])).forEach((t=>a.XO.remove(K[t])))}));class N{constructor(t,K=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=K}add(t){t.forEach((t=>{this._assetList.push(t)})),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],K=Math.min(this._assetList.length,this._maxConcurrent);for(let D=0;D<K;D++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function W(t,K){const D=t.split("?")[0],G=a.Wp.path.extname(D).toLowerCase();return Array.isArray(K)?K.includes(G):G===K}const x=(t,K,D=!1)=>(Array.isArray(t)||(t=[t]),K?t.map((t=>"string"==typeof t||D?K(t):t)):t),b=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const K=this._cache.get(t);return K||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),K}set(t,K){const D=x(t);let G;for(let t=0;t<this.parsers.length;t++){const a=this.parsers[t];if(a.test(K)){G=a.getCacheableAssets(D,K);break}}G||(G={},D.forEach((t=>{G[t]=K})));const N=Object.keys(G),W={cacheKeys:N,keys:D};if(D.forEach((t=>{this._cacheMap.set(t,W)})),N.forEach((t=>{this._cache.has(t)&&this._cache.get(t)!==K&&console.warn("[Cache] already has key:",t),this._cache.set(t,G[t])})),K instanceof a.gP){const t=K;D.forEach((K=>{t.baseTexture!==a.gP.EMPTY.baseTexture&&a.t5.addToCache(t.baseTexture,K),a.gP.addToCache(t,K)}))}}remove(t){if(!this._cacheMap.has(t))return void console.warn(`[Assets] Asset id ${t} was not found in the Cache`);const K=this._cacheMap.get(t);K.cacheKeys.forEach((t=>{this._cache.delete(t)})),K.keys.forEach((t=>{this._cacheMap.delete(t)}))}get parsers(){return this._parsers}},n=t=>!Array.isArray(t);class e{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,K,D)=>(this._parsersValidated=!1,t[K]=D,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,K){const D={promise:null,parser:null};return D.promise=(async()=>{var a,G;let N=null,W=null;if(K.loadParser&&(W=this._parserHash[K.loadParser],W||console.warn(`[Assets] specified load parser "${K.loadParser}" not found while loading ${t}`)),!W){for(let D=0;D<this.parsers.length;D++){const G=this.parsers[D];if(G.load&&(null===(a=G.test)||void 0===a?void 0:a.call(G,t,K,this))){W=G;break}}if(!W)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}N=await W.load(t,K,this),D.parser=W;for(let t=0;t<this.parsers.length;t++){const a=this.parsers[t];a.parse&&a.parse&&await(null===(G=a.testParse)||void 0===G?void 0:G.call(a,N,K,this))&&(N=await a.parse(N,K,this)||N,D.parser=a)}return N})(),D}async load(t,K){this._parsersValidated||this._validateParsers();let D=0;const G={},N=n(t),W=x(t,(t=>({alias:[t],src:t}))),b=W.length,e=W.map((async t=>{const N=a.Wp.path.toAbsolute(t.src);if(!G[t.src])try{this.promiseCache[N]||(this.promiseCache[N]=this._getLoadPromiseAndParser(N,t)),G[t.src]=await this.promiseCache[N].promise,K&&K(++D/b)}catch(K){throw delete this.promiseCache[N],delete G[t.src],new Error(`[Loader.load] Failed to load ${N}.\n${K}`)}}));return await Promise.all(e),N?G[W[0].src]:G}async unload(t){const K=x(t,(t=>({alias:[t],src:t}))).map((async t=>{var K,D;const G=a.Wp.path.toAbsolute(t.src),N=this.promiseCache[G];if(N){const a=await N.promise;delete this.promiseCache[G],null===(D=null===(K=N.parser)||void 0===K?void 0:K.unload)||void 0===D||D.call(K,a,t,this)}}));await Promise.all(K)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter((t=>t.name)).reduce(((t,K)=>(t[K.name]&&console.warn(`[Assets] loadParser name conflict "${K.name}"`),{...t,[K.name]:K})),{})}}var i=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(i||{});function z(t,K){if(Array.isArray(K)){for(const D of K)if(t.startsWith(`data:${D}`))return!0;return!1}return t.startsWith(`data:${K}`)}const I=".json",Z="application/json",w={extension:{type:a.Ag.LoadParser,priority:i.Low},name:"loadJson",test:t=>z(t,Z)||W(t,I),load:async t=>await(await a.W0.ADAPTER.fetch(t)).json()};a.XO.add(w);const m=".txt",u="text/plain",d={name:"loadTxt",extension:{type:a.Ag.LoadParser,priority:i.Low},test:t=>z(t,u)||W(t,m),load:async t=>await(await a.W0.ADAPTER.fetch(t)).text()};a.XO.add(d);const E=["normal","bold","100","200","300","400","500","600","700","800","900"],l=[".ttf",".otf",".woff",".woff2"],Q=["font/ttf","font/otf","font/woff","font/woff2"],P=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i,y=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/,q={extension:{type:a.Ag.LoadParser,priority:i.Low},name:"loadWebFont",test:t=>z(t,Q)||W(t,l),async load(t,K){var D,G,N,W,x,b;const n=a.W0.ADAPTER.getFontFaceSet();if(n){const i=[],z=null!==(G=null===(D=K.data)||void 0===D?void 0:D.family)&&void 0!==G?G:function(t){const K=a.Wp.path.extname(t),D=a.Wp.path.basename(t,K).replace(/(-|_)/g," ").toLowerCase().split(" ").map((t=>t.charAt(0).toUpperCase()+t.slice(1)));let G=D.length>0;for(const t of D)if(!t.match(P)){G=!1;break}let N=D.join(" ");return G||(N=`"${N.replace(/[\\"]/g,"\\$&")}"`),N}(t),I=null!==(x=null===(W=null===(N=K.data)||void 0===N?void 0:N.weights)||void 0===W?void 0:W.filter((t=>E.includes(t))))&&void 0!==x?x:["normal"],Z=null!==(b=K.data)&&void 0!==b?b:{};for(let K=0;K<I.length;K++){const D=I[K],a=new FontFace(z,`url(${e=t,y.test(e)?e:encodeURI(e)})`,{...Z,weight:D});await a.load(),n.add(a),i.push(a)}return 1===i.length?i[0]:i}var e;return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach((t=>a.W0.ADAPTER.getFontFaceSet().delete(t)))}};a.XO.add(q);let X,h=0;const J={id:"checkImageBitmap",code:`\n    async function checkImageBitmap()\n    {\n        try\n        {\n            if (typeof createImageBitmap !== 'function') return false;\n\n            const response = await fetch('${"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII="}');\n            const imageBlob =  await response.blob();\n            const imageBitmap = await createImageBitmap(imageBlob);\n\n            return imageBitmap.width === 1 && imageBitmap.height === 1;\n        }\n        catch (e)\n        {\n            return false;\n        }\n    }\n    checkImageBitmap().then((result) => { self.postMessage(result); });\n    `},T={id:"loadImageBitmap",code:`\n    async function loadImageBitmap(url)\n    {\n        const response = await fetch(url);\n\n        if (!response.ok)\n        {\n            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`\n                + \`\${response.status} \${response.statusText}\`);\n        }\n\n        const imageBlob =  await response.blob();\n        const imageBitmap = await createImageBitmap(imageBlob);\n\n        return imageBitmap;\n    }\n    self.onmessage = async (event) =>\n    {\n        try\n        {\n            const imageBitmap = await loadImageBitmap(event.data.data[0]);\n\n            self.postMessage({\n                data: imageBitmap,\n                uuid: event.data.uuid,\n                id: event.data.id,\n            }, [imageBitmap]);\n        }\n        catch(e)\n        {\n            self.postMessage({\n                error: e,\n                uuid: event.data.uuid,\n                id: event.data.id,\n            });\n        }\n    };`};let _;const C=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise((t=>{const K=URL.createObjectURL(new Blob([J.code],{type:"application/javascript"})),D=new Worker(K);D.addEventListener("message",(a=>{D.terminate(),URL.revokeObjectURL(K),t(a.data)}))}))),this._isImageBitmapSupported}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){void 0===X&&(X=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<X&&(_||(_=URL.createObjectURL(new Blob([T.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(_),t.addEventListener("message",(t=>{this.complete(t.data),this.returnWorker(t.target),this.next()}))),t}returnWorker(t){this.workerPool.push(t)}complete(t){void 0!==t.error?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,K){await this._initWorkers();const D=new Promise(((D,a)=>{this.queue.push({id:t,arguments:K,resolve:D,reject:a})}));return this.next(),D}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const K=this.queue.pop(),D=K.id;this.resolveHash[h]={resolve:K.resolve,reject:K.reject},t.postMessage({data:K.arguments,uuid:h++,id:D})}};function H(t,K,D){t.resource.internal=!0;const G=new a.gP(t),N=()=>{delete K.promiseCache[D],b.has(D)&&b.remove(D)};return G.baseTexture.once("destroyed",(()=>{D in K.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),N())})),G.once("destroyed",(()=>{t.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),N())})),G}const o=[".jpeg",".jpg",".png",".webp",".avif"],U=["image/jpeg","image/png","image/webp","image/avif"],V={name:"loadTextures",extension:{type:a.Ag.LoadParser,priority:i.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:t=>z(t,U)||W(t,o),async load(t,K,D){var G,N;const W=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let x;x=W?this.config.preferWorkers&&await C.isImageBitmapSupported()?await C.loadImageBitmap(t):await async function(t){const K=await a.W0.ADAPTER.fetch(t);if(!K.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${K.status} ${K.statusText}`);const D=await K.blob();return await createImageBitmap(D)}(t):await new Promise(((K,D)=>{const a=new Image;a.crossOrigin=this.config.crossOrigin,a.src=t,a.complete?K(a):(a.onload=()=>K(a),a.onerror=t=>D(t))}));const b={...K.data};null!==(G=b.resolution)&&void 0!==G||(b.resolution=a.Wp.getResolutionOfUrl(t)),W&&void 0===(null===(N=b.resourceOptions)||void 0===N?void 0:N.ownsImageBitmap)&&(b.resourceOptions={...b.resourceOptions},b.resourceOptions.ownsImageBitmap=!0);const n=new a.t5(x,b);return n.resource.src=t,H(n,D,t)},unload(t){t.destroy(!0)}};a.XO.add(V);const s=".svg",F="image/svg+xml",c={extension:{type:a.Ag.LoadParser,priority:i.High},name:"loadSVG",test:t=>z(t,F)||W(t,s),testParse:async t=>a.$f.test(t),async parse(t,K,D){var G;const N=new a.$f(t,null===(G=null==K?void 0:K.data)||void 0===G?void 0:G.resourceOptions);await N.load();const W=new a.t5(N,{resolution:a.Wp.getResolutionOfUrl(t),...null==K?void 0:K.data});return W.resource.src=K.src,H(W,D,K.src)},load:async(t,K)=>(await a.W0.ADAPTER.fetch(t)).text(),unload:V.unload};a.XO.add(c);const g=[".mp4",".m4v",".webm",".ogv"],R=["video/mp4","video/webm","video/ogg"],A={name:"loadVideo",extension:{type:a.Ag.LoadParser,priority:i.High},config:{defaultAutoPlay:!0},test:t=>z(t,R)||W(t,g),async load(t,K,D){var G;let N;const W=await(await a.W0.ADAPTER.fetch(t)).blob(),x=URL.createObjectURL(W);try{const W={autoPlay:this.config.defaultAutoPlay,...null===(G=null==K?void 0:K.data)||void 0===G?void 0:G.resourceOptions},b=new a.A5(x,W);await b.load();const n=new a.t5(b,{alphaMode:await a.Wp.detectVideoAlphaMode(),resolution:a.Wp.getResolutionOfUrl(t),...null==K?void 0:K.data});n.resource.src=t,N=H(n,D,t),N.baseTexture.once("destroyed",(()=>{URL.revokeObjectURL(x)}))}catch(t){throw URL.revokeObjectURL(x),t}return N},unload(t){t.destroy(!0)}};function Y(t,K,D,a,G){const N=K[D];for(let W=0;W<N.length;W++){const x=N[W];D<K.length-1?Y(t.replace(a[D],x),K,D+1,a,G):G.push(t.replace(a[D],x))}}function L(t){const K=t.match(/\{(.*?)\}/g),D=[];if(K){const a=[];K.forEach((t=>{const K=t.substring(1,t.length-1).split(",");a.push(K)})),Y(t,a,0,K,D)}else D.push(t);return D}a.XO.add(A);class S{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,K)=>`${t}${this._bundleIdConnector}${K}`,extractAssetIdFromBundle:(t,K)=>K.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){var K,D,a;if(this._bundleIdConnector=null!==(K=t.connector)&&void 0!==K?K:this._bundleIdConnector,this._createBundleAssetId=null!==(D=t.createBundleAssetId)&&void 0!==D?D:this._createBundleAssetId,this._extractAssetIdFromBundle=null!==(a=t.extractAssetIdFromBundle)&&void 0!==a?a:this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach((t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))})),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if("string"==typeof t)this._defaultSearchParams=t;else{const K=t;this._defaultSearchParams=Object.keys(K).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(K[t])}`)).join("&")}}getAlias(t){const{alias:K,name:D,src:a,srcs:G}=t;return x(K||D||a||G,(t=>{var K;return"string"==typeof t?t:Array.isArray(t)?t.map((t=>{var K,D;return null!==(D=null!==(K=null==t?void 0:t.src)&&void 0!==K?K:null==t?void 0:t.srcs)&&void 0!==D?D:t})):(null==t?void 0:t.src)||(null==t?void 0:t.srcs)?null!==(K=t.src)&&void 0!==K?K:t.srcs:t}),!0)}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach((t=>{this.addBundle(t.name,t.assets)}))}addBundle(t,K){const D=[];Array.isArray(K)?K.forEach((K=>{var a,G;const N=null!==(a=K.src)&&void 0!==a?a:K.srcs,W=null!==(G=K.alias)&&void 0!==G?G:K.name;let x;if("string"==typeof W){const K=this._createBundleAssetId(t,W);D.push(K),x=[W,K]}else{const K=W.map((K=>this._createBundleAssetId(t,K)));D.push(...K),x=[...W,...K]}this.add({...K,alias:x,src:N})})):Object.keys(K).forEach((a=>{var G;const N=[a,this._createBundleAssetId(t,a)];if("string"==typeof K[a])this.add({alias:N,src:K[a]});else if(Array.isArray(K[a]))this.add({alias:N,src:K[a]});else{const t=K[a],D=null!==(G=t.src)&&void 0!==G?G:t.srcs;this.add({...t,alias:N,src:Array.isArray(D)?D:[D]})}D.push(...N)})),this._bundles[t]=D}add(t,K,D,G,N){const W=[];let b;"string"==typeof t||Array.isArray(t)&&"string"==typeof t[0]?(a.Wp.deprecation("7.2.0",`Assets.add now uses an object instead of individual parameters.\nPlease use Assets.add({ alias, src, data, format, loadParser }) instead.`),W.push({alias:t,src:K,data:D,format:G,loadParser:N})):Array.isArray(t)?W.push(...t):W.push(t),b=t=>{this.hasKey(t)&&console.warn(`[Resolver] already has key: ${t} overwriting`)},x(W).forEach((t=>{const{src:K,srcs:D}=t;let{data:a,format:G,loadParser:N}=t;const W=x(K||D).map((t=>"string"==typeof t?L(t):Array.isArray(t)?t:[t])),n=this.getAlias(t);Array.isArray(n)?n.forEach(b):b(n);const e=[];W.forEach((t=>{t.forEach((t=>{var K,D,W;let x={};if("object"!=typeof t){x.src=t;for(let K=0;K<this._parsers.length;K++){const D=this._parsers[K];if(D.test(t)){x=D.parse(t);break}}}else a=null!==(K=t.data)&&void 0!==K?K:a,G=null!==(D=t.format)&&void 0!==D?D:G,N=null!==(W=t.loadParser)&&void 0!==W?W:N,x={...x,...t};if(!n)throw new Error(`[Resolver] alias is undefined for this asset: ${x.src}`);x=this.buildResolvedAsset(x,{aliases:n,data:a,format:G,loadParser:N}),e.push(x)}))})),n.forEach((t=>{this._assetMap[t]=e}))}))}resolveBundle(t){const K=n(t);t=x(t);const D={};return t.forEach((t=>{const K=this._bundles[t];if(K){const a=this.resolve(K),G={};for(const K in a){const D=a[K];G[this._extractAssetIdFromBundle(t,K)]=D}D[t]=G}})),K?D[t[0]]:D}resolveUrl(t){const K=this.resolve(t);if("string"!=typeof t){const t={};for(const D in K)t[D]=K[D].src;return t}return K.src}resolve(t){const K=n(t);t=x(t);const D={};return t.forEach((t=>{var K;if(!this._resolverHash[t])if(this._assetMap[t]){let D=this._assetMap[t];const a=D[0],G=this._getPreferredOrder(D);null==G||G.priority.forEach((t=>{G.params[t].forEach((K=>{const a=D.filter((D=>!!D[t]&&D[t]===K));a.length&&(D=a)}))})),this._resolverHash[t]=null!==(K=D[0])&&void 0!==K?K:a}else this._resolverHash[t]=this.buildResolvedAsset({alias:[t],src:t},{});D[t]=this._resolverHash[t]})),K?D[t[0]]:D}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let K=0;K<t.length;K++){const K=t[0],D=this._preferredOrder.find((t=>t.params.format.includes(K.format)));if(D)return D}return this._preferredOrder[0]}_appendDefaultSearchParams(t){return this._defaultSearchParams?`${t}${/\?/.test(t)?"&":"?"}${this._defaultSearchParams}`:t}buildResolvedAsset(t,K){var D;const{aliases:G,data:N,loadParser:W,format:x}=K;return(this._basePath||this._rootPath)&&(t.src=a.Wp.path.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=null!==(D=null!=G?G:t.alias)&&void 0!==D?D:[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...N||{},...t.data},t.loadParser=null!=W?W:t.loadParser,t.format=null!=x?x:a.Wp.path.extname(t.src).slice(1),t.srcs=t.src,t.name=t.alias,t}}const f=new class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new S,this.loader=new e,this.cache=b,this._backgroundLoader=new N(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var K,D,a;if(this._initialized)return void console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let K=t.manifest;"string"==typeof K&&(K=await this.load(K)),this.resolver.addManifest(K)}const G=null!==(D=null===(K=t.texturePreference)||void 0===K?void 0:K.resolution)&&void 0!==D?D:1,N="number"==typeof G?[G]:G,W=await this._detectFormats({preferredFormats:null===(a=t.texturePreference)||void 0===a?void 0:a.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:W,resolution:N}}),t.preferences&&this.setPreferences(t.preferences)}add(t,K,D,a,G){this.resolver.add(t,K,D,a,G)}async load(t,K){this._initialized||await this.init();const D=n(t),a=x(t).map((t=>{if("string"!=typeof t){const K=this.resolver.getAlias(t);return K.some((t=>!this.resolver.hasKey(t)))&&this.add(t),Array.isArray(K)?K[0]:K}return this.resolver.hasKey(t)||this.add({alias:t,src:t}),t})),G=this.resolver.resolve(a),N=await this._mapLoadToResolve(G,K);return D?N[a[0]]:N}addBundle(t,K){this.resolver.addBundle(t,K)}async loadBundle(t,K){this._initialized||await this.init();let D=!1;"string"==typeof t&&(D=!0,t=[t]);const a=this.resolver.resolveBundle(t),G={},N=Object.keys(a);let W=0,x=0;const b=()=>{null==K||K(++W/x)},n=N.map((t=>{const K=a[t];return x+=Object.keys(K).length,this._mapLoadToResolve(K,b).then((K=>{G[t]=K}))}));return await Promise.all(n),D?G[t[0]]:G}async backgroundLoad(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const K=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(K))}async backgroundLoadBundle(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const K=this.resolver.resolveBundle(t);Object.values(K).forEach((t=>{this._backgroundLoader.add(Object.values(t))}))}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if("string"==typeof t)return b.get(t);const K={};for(let D=0;D<t.length;D++)K[D]=b.get(t[D]);return K}async _mapLoadToResolve(t,K){const D=Object.values(t),a=Object.keys(t);this._backgroundLoader.active=!1;const G=await this.loader.load(D,K);this._backgroundLoader.active=!0;const N={};return D.forEach(((t,K)=>{const D=G[t.src],W=[t.src];t.alias&&W.push(...t.alias),N[a[K]]=D,b.set(W,D)})),N}async unload(t){this._initialized||await this.init();const K=x(t).map((t=>"string"!=typeof t?t.src:t)),D=this.resolver.resolve(K);await this._unloadFromResolved(D)}async unloadBundle(t){this._initialized||await this.init(),t=x(t);const K=this.resolver.resolveBundle(t),D=Object.keys(K).map((t=>this._unloadFromResolved(K[t])));await Promise.all(D)}async _unloadFromResolved(t){const K=Object.values(t);K.forEach((t=>{b.remove(t.src)})),await this.loader.unload(K)}async _detectFormats(t){let K=[];t.preferredFormats&&(K=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const D of t.detections)t.skipDetections||await D.test()?K=await D.add(K):t.skipDetections||(K=await D.remove(K));return K=K.filter(((t,D)=>K.indexOf(t)===D)),K}get detections(){return this._detections}get preferWorkers(){return V.config.preferWorkers}set preferWorkers(t){a.Wp.deprecation("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach((K=>{K.config&&Object.keys(K.config).filter((K=>K in t)).forEach((D=>{K.config[D]=t[D]}))}))}};a.XO.handleByList(a.Ag.LoadParser,f.loader.parsers).handleByList(a.Ag.ResolveParser,f.resolver.parsers).handleByList(a.Ag.CacheParser,f.cache.parsers).handleByList(a.Ag.DetectionParser,f.detections);const $={extension:a.Ag.CacheParser,test:t=>Array.isArray(t)&&t.every((t=>t instanceof a.gP)),getCacheableAssets:(t,K)=>{const D={};return t.forEach((t=>{K.forEach(((K,a)=>{D[t+(0===a?"":a+1)]=K}))})),D}};async function B(t){if("Image"in globalThis)return new Promise((K=>{const D=new Image;D.onload=()=>{K(!0)},D.onerror=()=>{K(!1)},D.src=t}));if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const K=await(await fetch(t)).blob();await createImageBitmap(K)}catch(t){return!1}return!0}return!1}a.XO.add($);const O={extension:{type:a.Ag.DetectionParser,priority:1},test:async()=>B("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter((t=>"avif"!==t))};a.XO.add(O);const v={extension:{type:a.Ag.DetectionParser,priority:0},test:async()=>B("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter((t=>"webp"!==t))};a.XO.add(v);const p=["png","jpg","jpeg"],j={extension:{type:a.Ag.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...p],remove:async t=>t.filter((t=>!p.includes(t)))};a.XO.add(j);const r="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function M(t){return!r&&""!==document.createElement("video").canPlayType(t)}const k={extension:{type:a.Ag.DetectionParser,priority:0},test:async()=>M("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter((t=>"webm"!==t))};a.XO.add(k);const tt={extension:{type:a.Ag.DetectionParser,priority:0},test:async()=>M("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter((t=>"mp4"!==t&&"m4v"!==t))};a.XO.add(tt);const Kt={extension:{type:a.Ag.DetectionParser,priority:0},test:async()=>M("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter((t=>"ogv"!==t))};a.XO.add(Kt);const Dt={extension:a.Ag.ResolveParser,test:V.test,parse:t=>{var K,D;return{resolution:parseFloat(null!==(D=null===(K=a.W0.RETINA_PREFIX.exec(t))||void 0===K?void 0:K[1])&&void 0!==D?D:"1"),format:a.Wp.path.extname(t).slice(1),src:t}}};a.XO.add(Dt);var at=D(116387)},116387:(t,K,D)=>{D.d(K,{Y:()=>a});const a=(t,K)=>{const D=K.split("?")[1];return D&&(t+=`?${D}`),t}},817798:(t,K,D)=>{D.d(K,{Q:()=>H});var a={grad:.9,turn:360,rad:360/(2*Math.PI)},G=function(t){return"string"==typeof t?t.length>0:"number"==typeof t},N=function(t,K,D){return void 0===K&&(K=0),void 0===D&&(D=Math.pow(10,K)),Math.round(D*t)/D+0},W=function(t,K,D){return void 0===K&&(K=0),void 0===D&&(D=1),t>D?D:t>K?t:K},x=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},b=function(t){return{r:W(t.r,0,255),g:W(t.g,0,255),b:W(t.b,0,255),a:W(t.a)}},n=function(t){return{r:N(t.r),g:N(t.g),b:N(t.b),a:N(t.a,3)}},e=/^#([0-9a-f]{3,8})$/i,i=function(t){var K=t.toString(16);return K.length<2?"0"+K:K},z=function(t){var K=t.r,D=t.g,a=t.b,G=t.a,N=Math.max(K,D,a),W=N-Math.min(K,D,a),x=W?N===K?(D-a)/W:N===D?2+(a-K)/W:4+(K-D)/W:0;return{h:60*(x<0?x+6:x),s:N?W/N*100:0,v:N/255*100,a:G}},I=function(t){var K=t.h,D=t.s,a=t.v,G=t.a;K=K/360*6,D/=100,a/=100;var N=Math.floor(K),W=a*(1-D),x=a*(1-(K-N)*D),b=a*(1-(1-K+N)*D),n=N%6;return{r:255*[a,x,W,W,b,a][n],g:255*[b,a,a,x,W,W][n],b:255*[W,W,b,a,a,x][n],a:G}},Z=function(t){return{h:x(t.h),s:W(t.s,0,100),l:W(t.l,0,100),a:W(t.a)}},w=function(t){return{h:N(t.h),s:N(t.s),l:N(t.l),a:N(t.a,3)}},m=function(t){return I((D=(K=t).s,{h:K.h,s:(D*=((a=K.l)<50?a:100-a)/100)>0?2*D/(a+D)*100:0,v:a+D,a:K.a}));var K,D,a},u=function(t){return{h:(K=z(t)).h,s:(G=(200-(D=K.s))*(a=K.v)/100)>0&&G<200?D*a/100/(G<=100?G:200-G)*100:0,l:G/2,a:K.a};var K,D,a,G},d=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,E=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,l=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Q=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,P={string:[[function(t){var K=e.exec(t);return K?(t=K[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:4===t.length?N(parseInt(t[3]+t[3],16)/255,2):1}:6===t.length||8===t.length?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:8===t.length?N(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var K=l.exec(t)||Q.exec(t);return K?K[2]!==K[4]||K[4]!==K[6]?null:b({r:Number(K[1])/(K[2]?100/255:1),g:Number(K[3])/(K[4]?100/255:1),b:Number(K[5])/(K[6]?100/255:1),a:void 0===K[7]?1:Number(K[7])/(K[8]?100:1)}):null},"rgb"],[function(t){var K=d.exec(t)||E.exec(t);if(!K)return null;var D,G,N=Z({h:(D=K[1],G=K[2],void 0===G&&(G="deg"),Number(D)*(a[G]||1)),s:Number(K[3]),l:Number(K[4]),a:void 0===K[5]?1:Number(K[5])/(K[6]?100:1)});return m(N)},"hsl"]],object:[[function(t){var K=t.r,D=t.g,a=t.b,N=t.a,W=void 0===N?1:N;return G(K)&&G(D)&&G(a)?b({r:Number(K),g:Number(D),b:Number(a),a:Number(W)}):null},"rgb"],[function(t){var K=t.h,D=t.s,a=t.l,N=t.a,W=void 0===N?1:N;if(!G(K)||!G(D)||!G(a))return null;var x=Z({h:Number(K),s:Number(D),l:Number(a),a:Number(W)});return m(x)},"hsl"],[function(t){var K=t.h,D=t.s,a=t.v,N=t.a,b=void 0===N?1:N;if(!G(K)||!G(D)||!G(a))return null;var n=function(t){return{h:x(t.h),s:W(t.s,0,100),v:W(t.v,0,100),a:W(t.a)}}({h:Number(K),s:Number(D),v:Number(a),a:Number(b)});return I(n)},"hsv"]]},y=function(t,K){for(var D=0;D<K.length;D++){var a=K[D][0](t);if(a)return[a,K[D][1]]}return[null,void 0]},q=function(t,K){var D=u(t);return{h:D.h,s:W(D.s+100*K,0,100),l:D.l,a:D.a}},X=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},h=function(t,K){var D=u(t);return{h:D.h,s:D.s,l:W(D.l+100*K,0,100),a:D.a}},J=function(){function t(t){this.parsed=function(t){return"string"==typeof t?y(t.trim(),P.string):"object"==typeof t&&null!==t?y(t,P.object):[null,void 0]}(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return null!==this.parsed},t.prototype.brightness=function(){return N(X(this.rgba),2)},t.prototype.isDark=function(){return X(this.rgba)<.5},t.prototype.isLight=function(){return X(this.rgba)>=.5},t.prototype.toHex=function(){return K=(t=n(this.rgba)).r,D=t.g,a=t.b,W=(G=t.a)<1?i(N(255*G)):"","#"+i(K)+i(D)+i(a)+W;var t,K,D,a,G,W},t.prototype.toRgb=function(){return n(this.rgba)},t.prototype.toRgbString=function(){return K=(t=n(this.rgba)).r,D=t.g,a=t.b,(G=t.a)<1?"rgba("+K+", "+D+", "+a+", "+G+")":"rgb("+K+", "+D+", "+a+")";var t,K,D,a,G},t.prototype.toHsl=function(){return w(u(this.rgba))},t.prototype.toHslString=function(){return K=(t=w(u(this.rgba))).h,D=t.s,a=t.l,(G=t.a)<1?"hsla("+K+", "+D+"%, "+a+"%, "+G+")":"hsl("+K+", "+D+"%, "+a+"%)";var t,K,D,a,G},t.prototype.toHsv=function(){return t=z(this.rgba),{h:N(t.h),s:N(t.s),v:N(t.v),a:N(t.a,3)};var t},t.prototype.invert=function(){return T({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},t.prototype.saturate=function(t){return void 0===t&&(t=.1),T(q(this.rgba,t))},t.prototype.desaturate=function(t){return void 0===t&&(t=.1),T(q(this.rgba,-t))},t.prototype.grayscale=function(){return T(q(this.rgba,-1))},t.prototype.lighten=function(t){return void 0===t&&(t=.1),T(h(this.rgba,t))},t.prototype.darken=function(t){return void 0===t&&(t=.1),T(h(this.rgba,-t))},t.prototype.rotate=function(t){return void 0===t&&(t=15),this.hue(this.hue()+t)},t.prototype.alpha=function(t){return"number"==typeof t?T({r:(K=this.rgba).r,g:K.g,b:K.b,a:t}):N(this.rgba.a,3);var K},t.prototype.hue=function(t){var K=u(this.rgba);return"number"==typeof t?T({h:t,s:K.s,l:K.l,a:K.a}):N(K.h)},t.prototype.isEqual=function(t){return this.toHex()===T(t).toHex()},t}(),T=function(t){return t instanceof J?t:new J(t)},_=[];(function(t){t.forEach((function(t){_.indexOf(t)<0&&(t(J,P),_.push(t))}))})([function(t,K){var D={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},a={};for(var G in D)a[D[G]]=G;var N={};t.prototype.toName=function(K){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var G,W,x=a[this.toHex()];if(x)return x;if(null==K?void 0:K.closest){var b=this.toRgb(),n=1/0,e="black";if(!N.length)for(var i in D)N[i]=new t(D[i]).toRgb();for(var z in D){var I=(G=b,W=N[z],Math.pow(G.r-W.r,2)+Math.pow(G.g-W.g,2)+Math.pow(G.b-W.b,2));I<n&&(n=I,e=z)}return e}},K.string.push([function(K){var a=K.toLowerCase(),G="transparent"===a?"#0000":D[a];return G?new t(G).toRgb():null},"name"])}]);const C=class t{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(K){if(K instanceof t)this._value=this.cloneSource(K._value),this._int=K._int,this._components.set(K._components);else{if(null===K)throw new Error("Cannot set PIXI.Color#value to null");(null===this._value||!this.isSourceEqual(this._value,K))&&(this.normalize(K),this._value=this.cloneSource(K))}}get value(){return this._value}cloneSource(t){return"string"==typeof t||"number"==typeof t||t instanceof Number||null===t?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):"object"==typeof t&&null!==t?{...t}:t}isSourceEqual(t,K){const D=typeof t;if(D!==typeof K)return!1;if("number"===D||"string"===D||t instanceof Number)return t===K;if(Array.isArray(t)&&Array.isArray(K)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(K))return t.length===K.length&&t.every(((t,D)=>t===K[D]));if(null!==t&&null!==K){const D=Object.keys(t),a=Object.keys(K);return D.length===a.length&&D.every((D=>t[D]===K[D]))}return t===K}toRgba(){const[t,K,D,a]=this._components;return{r:t,g:K,b:D,a}}toRgb(){const[t,K,D]=this._components;return{r:t,g:K,b:D}}toRgbaString(){const[t,K,D]=this.toUint8RgbArray();return`rgba(${t},${K},${D},${this.alpha})`}toUint8RgbArray(t){const[K,D,a]=this._components;return(t=null!=t?t:[])[0]=Math.round(255*K),t[1]=Math.round(255*D),t[2]=Math.round(255*a),t}toRgbArray(t){t=null!=t?t:[];const[K,D,a]=this._components;return t[0]=K,t[1]=D,t[2]=a,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(65280&t)+((255&t)<<16)}multiply(K){const[D,a,G,N]=t.temp.setValue(K)._components;return this._components[0]*=D,this._components[1]*=a,this._components[2]*=G,this._components[3]*=N,this.refreshInt(),this._value=null,this}premultiply(t,K=!0){return K&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,K=!0){if(1===t)return(255<<24)+this._int;if(0===t)return K?0:this._int;let D=this._int>>16&255,a=this._int>>8&255,G=255&this._int;return K&&(D=D*t+.5|0,a=a*t+.5|0,G=G*t+.5|0),(255*t<<24)+(D<<16)+(a<<8)+G}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[K,D,a]=this._components;return this._components[0]=Math.round(K*t)/t,this._components[1]=Math.round(D*t)/t,this._components[2]=Math.round(a*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=null!=t?t:[];const[K,D,a,G]=this._components;return t[0]=K,t[1]=D,t[2]=a,t[3]=G,t}normalize(K){let D,a,G,N;if(("number"==typeof K||K instanceof Number)&&K>=0&&K<=16777215)D=(K>>16&255)/255,a=(K>>8&255)/255,G=(255&K)/255,N=1;else if((Array.isArray(K)||K instanceof Float32Array)&&K.length>=3&&K.length<=4)K=this._clamp(K),[D,a,G,N=1]=K;else if((K instanceof Uint8Array||K instanceof Uint8ClampedArray)&&K.length>=3&&K.length<=4)K=this._clamp(K,0,255),[D,a,G,N=255]=K,D/=255,a/=255,G/=255,N/=255;else if("string"==typeof K||"object"==typeof K){if("string"==typeof K){const D=t.HEX_PATTERN.exec(K);D&&(K=`#${D[2]}`)}const W=T(K);W.isValid()&&(({r:D,g:a,b:G,a:N}=W.rgba),D/=255,a/=255,G/=255)}if(void 0===D)throw new Error(`Unable to convert color ${K}`);this._components[0]=D,this._components[1]=a,this._components[2]=G,this._components[3]=N,this.refreshInt()}refreshInt(){this._clamp(this._components);const[t,K,D]=this._components;this._int=(255*t<<16)+(255*K<<8)+(255*D|0)}_clamp(t,K=0,D=1){return"number"==typeof t?Math.min(Math.max(t,K),D):(t.forEach(((a,G)=>{t[G]=Math.min(Math.max(a,K),D)})),t)}};C.shared=new C,C.temp=new C,C.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let H=C},424608:(t,K,D)=>{D.d(K,{B9:()=>W,E8:()=>Z,Gk:()=>w,Km:()=>a,M6:()=>z,OS:()=>u,Pk:()=>d,QE:()=>e,XZ:()=>i,_4:()=>x,dW:()=>n,fr:()=>m,h3:()=>G,hR:()=>b,he:()=>l,uR:()=>I,vg:()=>E,wn:()=>N,yw:()=>Q});var a=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(a||{}),G=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(G||{}),N=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(N||{}),W=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(W||{}),x=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(x||{}),b=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(b||{}),n=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(n||{}),e=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(e||{}),i=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(i||{}),z=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(z||{}),I=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(I||{}),Z=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(Z||{}),w=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(w||{}),m=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(m||{}),u=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(u||{}),d=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(d||{}),E=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(E||{}),l=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(l||{}),Q=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(Q||{})},23431:(t,K,D)=>{D.d(K,{L:()=>a});class a{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}},294485:(t,K,D)=>{D.d(K,{P:()=>a});class a{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}},391966:(t,K,D)=>{D.d(K,{E:()=>G,M:()=>a});const a=`attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}`,G=`attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n`},665816:(t,K,D)=>{D.d(K,{u:()=>a});class a{constructor(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}},316197:(t,K,D)=>{D.d(K,{Gk:()=>a.Gk,B9:()=>a.B9,t5:()=>X,hq:()=>h,JH:()=>s,cc:()=>Nt.L,hp:()=>T,dZ:()=>P,fr:()=>a.fr,jl:()=>F.jl,Q1:()=>W.Q,Td:()=>F.Td,_4:()=>a._4,Pp:()=>F.Pp,Ag:()=>x.A,hR:()=>a.hR,dJ:()=>Zt,V2:()=>V,vg:()=>a.vg,E8:()=>a.E8,uq:()=>F.uq,Pt:()=>Wt.P,oA:()=>F.oA,TO:()=>F.TO,bR:()=>F.bR,tS:()=>F.tS,BP:()=>tt,X1:()=>Ct,bO:()=>F.bO,M_:()=>F.M_,Y7:()=>Jt,TE:()=>F.TE,HY:()=>F.HY,$f:()=>jK,Mt:()=>at,Uw:()=>u,QE:()=>a.QE,gP:()=>ht,NW:()=>Yt,Rv:()=>sK.Rv,dL:()=>F.dL,dQ:()=>sK.dQ,k2:()=>Dt,A5:()=>MK,u3:()=>b.u,uR:()=>a.uR,q5:()=>cK,Eo:()=>gK.E,MT:()=>gK.M,XO:()=>x.X,W0:()=>G.W0,Wp:()=>N});var a=D(424608),G=D(968381),N=D(578351),W=D(817798),x=D(738637),b=D(665816);const n=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`\n`);function e(t){let K="";for(let D=0;D<t;++D)D>0&&(K+=`\nelse `),D<t-1&&(K+=`if(test == ${D}.0){}`);return K}const i=0,z=1,I=2,Z=3,w=4,m=5;class u{constructor(){this.data=0,this.blendMode=a.B9.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<i)}set blend(t){!!(this.data&1<<i)!==t&&(this.data^=1<<i)}get offsets(){return!!(this.data&1<<z)}set offsets(t){!!(this.data&1<<z)!==t&&(this.data^=1<<z)}get culling(){return!!(this.data&1<<I)}set culling(t){!!(this.data&1<<I)!==t&&(this.data^=1<<I)}get depthTest(){return!!(this.data&1<<Z)}set depthTest(t){!!(this.data&1<<Z)!==t&&(this.data^=1<<Z)}get depthMask(){return!!(this.data&1<<m)}set depthMask(t){!!(this.data&1<<m)!==t&&(this.data^=1<<m)}get clockwiseFrontFace(){return!!(this.data&1<<w)}set clockwiseFrontFace(t){!!(this.data&1<<w)!==t&&(this.data^=1<<w)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==a.B9.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}static for2d(){const t=new u;return t.depthTest=!1,t.blend=!0,t}}u.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const d=[];function E(t,K){if(!t)return null;let D="";if("string"==typeof t){const K=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);K&&(D=K[1].toLowerCase())}for(let a=d.length-1;a>=0;--a){const G=d[a];if(G.test&&G.test(t,D))return new G(t,K)}throw new Error("Unrecognized source type to auto-detect Resource")}class l{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,K,D,a,G,N,W,x){if(arguments.length>8)throw new Error("max arguments reached");const{name:b,items:n}=this;this._aliasCount++;for(let e=0,i=n.length;e<i;e++)n[e][b](t,K,D,a,G,N,W,x);return n===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const K=this.items.indexOf(t);return-1!==K&&(this.ensureNonAliasedItems(),this.items.splice(K,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return 0===this.items.length}get name(){return this._name}}Object.defineProperties(l.prototype,{dispatch:{value:l.prototype.emit},run:{value:l.prototype.emit}});class Q{constructor(t=0,K=0){this._width=t,this._height=K,this.destroyed=!1,this.internal=!1,this.onResize=new l("setRealSize"),this.onUpdate=new l("update"),this.onError=new l("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,K){(t!==this._width||K!==this._height)&&(this._width=t,this._height=K,this.onResize.emit(t,K))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,K,D){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,K){return!1}}class P extends Q{constructor(t,K){var D;const{width:a,height:G}=K||{};if(!a||!G)throw new Error("BufferResource width or height invalid");super(a,G),this.data=t,this.unpackAlignment=null!==(D=K.unpackAlignment)&&void 0!==D?D:4}upload(t,K,D){const G=t.gl;G.pixelStorei(G.UNPACK_ALIGNMENT,this.unpackAlignment),G.pixelStorei(G.UNPACK_PREMULTIPLY_ALPHA_WEBGL,K.alphaMode===a.Gk.UNPACK);const N=K.realWidth,W=K.realHeight;return D.width===N&&D.height===W?G.texSubImage2D(K.target,0,0,0,N,W,K.format,D.type,this.data):(D.width=N,D.height=W,G.texImage2D(K.target,0,D.internalFormat,N,W,0,K.format,D.type,this.data)),!0}dispose(){this.data=null}static test(t){return null===t||t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}const y={scaleMode:a.M6.NEAREST,alphaMode:a.Gk.NPM},q=class t extends N.EventEmitter{constructor(K=null,D=null){super(),D=Object.assign({},t.defaultOptions,D);const{alphaMode:a,mipmap:W,anisotropicLevel:x,scaleMode:b,width:n,height:e,wrapMode:i,format:z,type:I,target:Z,resolution:w,resourceOptions:m}=D;K&&!(K instanceof Q)&&((K=E(K,m)).internal=!0),this.resolution=w||G.W0.RESOLUTION,this.width=Math.round((n||0)*this.resolution)/this.resolution,this.height=Math.round((e||0)*this.resolution)/this.resolution,this._mipmap=W,this.anisotropicLevel=x,this._wrapMode=i,this._scaleMode=b,this.format=z,this.type=I,this.target=Z,this.alphaMode=a,this.uid=N.uid(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=n>0&&e>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(K)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,K){let D;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,D=!0),void 0!==K&&K!==this.mipmap&&(this.mipmap=K,D=!0),D&&this.dirtyStyleId++,this}setSize(t,K,D){return D=D||this.resolution,this.setRealSize(t*D,K*D,D)}setRealSize(t,K,D){return this.resolution=D||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(K)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=N.isPow2(this.realWidth)&&N.isPow2(this.realHeight)}setResolution(t){const K=this.resolution;return K===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*K)/t,this.height=Math.round(this.height*K)/t,this.emit("update",this)),this._refreshPOT()),this}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete N.BaseTextureCache[this.cacheId],delete N.TextureCache[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(K,D,a=G.W0.STRICT_TEXTURE_CACHE){const W="string"==typeof K;let x=null;if(W)x=K;else{if(!K._pixiId){const t=(null==D?void 0:D.pixiIdPrefix)||"pixiid";K._pixiId=`${t}_${N.uid()}`}x=K._pixiId}let b=N.BaseTextureCache[x];if(W&&a&&!b)throw new Error(`The cacheId "${x}" does not exist in BaseTextureCache.`);return b||(b=new t(K,D),b.cacheId=x,t.addToCache(b,x)),b}static fromBuffer(K,D,G,N){K=K||new Float32Array(D*G*4);const W=new P(K,{width:D,height:G,...null==N?void 0:N.resourceOptions});let x,b;return K instanceof Float32Array?(x=a.hR.RGBA,b=a.QE.FLOAT):K instanceof Int32Array?(x=a.hR.RGBA_INTEGER,b=a.QE.INT):K instanceof Uint32Array?(x=a.hR.RGBA_INTEGER,b=a.QE.UNSIGNED_INT):K instanceof Int16Array?(x=a.hR.RGBA_INTEGER,b=a.QE.SHORT):K instanceof Uint16Array?(x=a.hR.RGBA_INTEGER,b=a.QE.UNSIGNED_SHORT):K instanceof Int8Array?(x=a.hR.RGBA,b=a.QE.BYTE):(x=a.hR.RGBA,b=a.QE.UNSIGNED_BYTE),W.internal=!0,new t(W,Object.assign({},y,{type:b,format:x},N))}static addToCache(t,K){K&&(t.textureCacheIds.includes(K)||t.textureCacheIds.push(K),N.BaseTextureCache[K]&&N.BaseTextureCache[K]!==t&&console.warn(`BaseTexture added to the cache with an id [${K}] that already had an entry`),N.BaseTextureCache[K]=t)}static removeFromCache(t){if("string"==typeof t){const K=N.BaseTextureCache[t];if(K){const D=K.textureCacheIds.indexOf(t);return D>-1&&K.textureCacheIds.splice(D,1),delete N.BaseTextureCache[t],K}}else if(null==t?void 0:t.textureCacheIds){for(let K=0;K<t.textureCacheIds.length;++K)delete N.BaseTextureCache[t.textureCacheIds[K]];return t.textureCacheIds.length=0,t}return null}};q.defaultOptions={mipmap:a.E8.POW2,anisotropicLevel:0,scaleMode:a.M6.LINEAR,wrapMode:a.uR.CLAMP,alphaMode:a.Gk.UNPACK,target:a.dW.TEXTURE_2D,format:a.hR.RGBA,type:a.QE.UNSIGNED_BYTE},q._globalBatch=0;let X=q;class h{constructor(){this.texArray=null,this.blend=0,this.type=a._4.TRIANGLES,this.start=0,this.size=0,this.data=null}}let J=0;class T{constructor(t,K=!0,D=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=D,this.static=K,this.id=J++,this.disposeRunner=new l("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?a.yw.ELEMENT_ARRAY_BUFFER:a.yw.ARRAY_BUFFER}get index(){return this.type===a.yw.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new T(t)}}class _{constructor(t,K=0,D=!1,G=a.QE.FLOAT,N,W,x,b=1){this.buffer=t,this.size=K,this.normalized=D,this.type=G,this.stride=N,this.start=W,this.instance=x,this.divisor=b}destroy(){this.buffer=null}static from(t,K,D,a,G){return new _(t,K,D,a,G)}}const C={Float32Array,Uint32Array,Int32Array,Uint8Array},H={5126:4,5123:2,5121:1};let o=0;const U={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class V{constructor(t=[],K={}){this.buffers=t,this.indexBuffer=null,this.attributes=K,this.glVertexArrayObjects={},this.id=o++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new l("disposeGeometry"),this.refCount=0}addAttribute(t,K,D=0,a=!1,G,N,W,x=!1){if(!K)throw new Error("You must pass a buffer when creating an attribute");K instanceof T||(K instanceof Array&&(K=new Float32Array(K)),K=new T(K));const b=t.split("|");if(b.length>1){for(let t=0;t<b.length;t++)this.addAttribute(b[t],K,D,a,G);return this}let n=this.buffers.indexOf(K);return-1===n&&(this.buffers.push(K),n=this.buffers.length-1),this.attributes[t]=new _(n,D,a,G,N,W,x),this.instanced=this.instanced||x,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof T||(t instanceof Array&&(t=new Uint16Array(t)),t=new T(t)),t.type=a.yw.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;const t=[],K=[],D=new T;let a;for(a in this.attributes){const D=this.attributes[a],G=this.buffers[D.buffer];t.push(G.data),K.push(D.size*H[D.type]/4),D.buffer=0}for(D.data=function(t,K){let D=0,a=0;const G={};for(let G=0;G<t.length;G++)a+=K[G],D+=t[G].length;const W=new ArrayBuffer(4*D);let x=null,b=0;for(let D=0;D<t.length;D++){const n=K[D],e=t[D],i=N.getBufferType(e);G[i]||(G[i]=new C[i](W)),x=G[i];for(let t=0;t<e.length;t++)x[(t/n|0)*a+b+t%n]=e[t];b+=n}return new Float32Array(W)}(t,K),a=0;a<this.buffers.length;a++)this.buffers[a]!==this.indexBuffer&&this.buffers[a].destroy();return this.buffers=[D],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const K=this.attributes[t];return this.buffers[K.buffer].data.length/(K.stride/4||K.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new V;for(let K=0;K<this.buffers.length;K++)t.buffers[K]=new T(this.buffers[K].data.slice(0));for(const K in this.attributes){const D=this.attributes[K];t.attributes[K]=new _(D.buffer,D.size,D.normalized,D.type,D.stride,D.start,D.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=a.yw.ELEMENT_ARRAY_BUFFER),t}static merge(t){const K=new V,D=[],G=[],W=[];let x;for(let K=0;K<t.length;K++){x=t[K];for(let t=0;t<x.buffers.length;t++)G[t]=G[t]||0,G[t]+=x.buffers[t].data.length,W[t]=0}for(let t=0;t<x.buffers.length;t++)D[t]=new(U[N.getBufferType(x.buffers[t].data)])(G[t]),K.buffers[t]=new T(D[t]);for(let K=0;K<t.length;K++){x=t[K];for(let t=0;t<x.buffers.length;t++)D[t].set(x.buffers[t].data,W[t]),W[t]+=x.buffers[t].data.length}if(K.attributes=x.attributes,x.indexBuffer){K.indexBuffer=K.buffers[x.buffers.indexOf(x.indexBuffer)],K.indexBuffer.type=a.yw.ELEMENT_ARRAY_BUFFER;let D=0,G=0,N=0,W=0;for(let t=0;t<x.buffers.length;t++)if(x.buffers[t]!==x.indexBuffer){W=t;break}for(const t in x.attributes){const K=x.attributes[t];(0|K.buffer)===W&&(G+=K.size*H[K.type]/4)}for(let a=0;a<t.length;a++){const x=t[a].indexBuffer.data;for(let t=0;t<x.length;t++)K.indexBuffer.data[t+N]+=D;D+=t[a].buffers[W].data.length/G,N+=x.length}}return K}}class s extends V{constructor(t=!1){super(),this._buffer=new T(null,t,!1),this._indexBuffer=new T(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,a.QE.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,a.QE.FLOAT).addAttribute("aColor",this._buffer,4,!0,a.QE.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,a.QE.FLOAT).addIndex(this._indexBuffer)}}var F=D(514842),c=`varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}`,g=`attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n`;const R=[{test:t=>"float"===t.type&&1===t.size&&!t.isArray,code:t=>`\n            if(uv["${t}"] !== ud["${t}"].value)\n            {\n                ud["${t}"].value = uv["${t}"]\n                gl.uniform1f(ud["${t}"].location, uv["${t}"])\n            }\n            `},{test:(t,K)=>!("sampler2D"!==t.type&&"samplerCube"!==t.type&&"sampler2DArray"!==t.type||1!==t.size||t.isArray||null!=K&&void 0===K.castToBaseTexture),code:t=>`t = syncData.textureCount++;\n\n            renderer.texture.bind(uv["${t}"], t);\n\n            if(ud["${t}"].value !== t)\n            {\n                ud["${t}"].value = t;\n                gl.uniform1i(ud["${t}"].location, t);\n; // eslint-disable-line max-len\n            }`},{test:(t,K)=>"mat3"===t.type&&1===t.size&&!t.isArray&&void 0!==K.a,code:t=>`\n            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));\n            `,codeUbo:t=>`\n                var ${t}_matrix = uv.${t}.toArray(true);\n\n                data[offset] = ${t}_matrix[0];\n                data[offset+1] = ${t}_matrix[1];\n                data[offset+2] = ${t}_matrix[2];\n        \n                data[offset + 4] = ${t}_matrix[3];\n                data[offset + 5] = ${t}_matrix[4];\n                data[offset + 6] = ${t}_matrix[5];\n        \n                data[offset + 8] = ${t}_matrix[6];\n                data[offset + 9] = ${t}_matrix[7];\n                data[offset + 10] = ${t}_matrix[8];\n            `},{test:(t,K)=>"vec2"===t.type&&1===t.size&&!t.isArray&&void 0!==K.x,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["${t}"].location, v.x, v.y);\n                }`,codeUbo:t=>`\n                v = uv.${t};\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            `},{test:t=>"vec2"===t.type&&1===t.size&&!t.isArray,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);\n                }\n            `},{test:(t,K)=>"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==K.width,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                `},{test:(t,K)=>"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==K.red,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n                    cv[3] = v.alpha;\n                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                    data[offset+3] = v.alpha;\n                `},{test:(t,K)=>"vec3"===t.type&&1===t.size&&!t.isArray&&void 0!==K.red,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n    \n                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                `},{test:t=>"vec4"===t.type&&1===t.size&&!t.isArray,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])\n                }`}],A={float:`\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }`,vec2:`\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }`,vec3:`\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }`,vec4:`\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }`,int:`\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }`,ivec2:`\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }`,ivec3:`\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }`,ivec4:`\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }`,uint:`\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }`,uvec2:`\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }`,uvec3:`\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }`,uvec4:`\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }`,bool:`\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }`,bvec2:`\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }`,bvec3:`\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }`,bvec4:`\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }`,samplerCube:`\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }`,sampler2DArray:`\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }`},Y={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},L={};let S,f=L;const $={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function B(t){return $[t]}let O=null;const v={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function p(t,K){if(!O){const K=Object.keys(v);O={};for(let D=0;D<K.length;++D){const a=K[D];O[t[a]]=v[a]}}return O[K]}function j(t,K,D){if("precision"!==t.substring(0,9)){let G=K;return K===a.Pk.HIGH&&D!==a.Pk.HIGH&&(G=a.Pk.MEDIUM),`precision ${G} float;\n${t}`}return D!==a.Pk.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}let r=0;const M={},k=class t{constructor(K,D,N="pixi-shader",W={}){this.extra={},this.id=r++,this.vertexSrc=K||t.defaultVertexSrc,this.fragmentSrc=D||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=W,"#version"!==this.vertexSrc.substring(0,8)&&(N=N.replace(/\s+/g,"-"),M[N]?(M[N]++,N+=`-${M[N]}`):M[N]=1,this.vertexSrc=`#define SHADER_NAME ${N}\n${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${N}\n${this.fragmentSrc}`,this.vertexSrc=j(this.vertexSrc,t.defaultVertexPrecision,a.Pk.HIGH),this.fragmentSrc=j(this.fragmentSrc,t.defaultFragmentPrecision,function(){if(!S){S=a.Pk.MEDIUM;const t=function(){if(f===L||(null==f?void 0:f.isContextLost())){const t=G.W0.ADAPTER.createCanvas();let K;G.W0.PREFER_ENV>=a.Km.WEBGL2&&(K=t.getContext("webgl2",{})),K||(K=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),K?K.getExtension("WEBGL_draw_buffers"):K=null),f=K}return f}();if(t&&t.getShaderPrecisionFormat){const K=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);K&&(S=K.precision?a.Pk.HIGH:a.Pk.MEDIUM)}}return S}())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return g}static get defaultFragmentSrc(){return c}static from(K,D,a){const G=K+D;let W=N.ProgramCache[G];return W||(N.ProgramCache[G]=W=new t(K,D,a)),W}};k.defaultVertexPrecision=a.Pk.HIGH,k.defaultFragmentPrecision=N.isMobile.apple.device?a.Pk.HIGH:a.Pk.MEDIUM;let tt=k,Kt=0;class Dt{constructor(t,K,D){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Kt++,this.static=!!K,this.ubo=!!D,t instanceof T?(this.buffer=t,this.buffer.type=a.yw.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new T(new Float32Array(1)),this.buffer.type=a.yw.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,K,D){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[t]=new Dt(K,D)}static from(t,K,D){return new Dt(t,K,D)}static uboFrom(t,K){return new Dt(t,null==K||K,!0)}}class at{constructor(t,K){this.uniformBindCount=0,this.program=t,this.uniformGroup=K?K instanceof Dt?K:new Dt(K):new Dt({}),this.disposeRunner=new l("disposeShader")}checkUniformExists(t,K){if(K.uniforms[t])return!0;for(const D in K.uniforms){const a=K.uniforms[D];if(!0===a.group&&this.checkUniformExists(t,a))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,K,D){const a=tt.from(t,K);return new at(a,D)}}class Gt{constructor(t,K){if(this.vertexSrc=t,this.fragTemplate=K,this.programCache={},this.defaultGroupCache={},!K.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!K.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const K=new Int32Array(t);for(let D=0;D<t;D++)K[D]=D;this.defaultGroupCache[t]=Dt.from({uSamplers:K},!0);let D=this.fragTemplate;D=D.replace(/%count%/gi,`${t}`),D=D.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new tt(this.vertexSrc,D)}const K={tint:new Float32Array([1,1,1,1]),translationMatrix:new F.uq,default:this.defaultGroupCache[t]};return new at(this.programCache[t],K)}generateSampleSrc(t){let K="";K+=`\n`,K+=`\n`;for(let D=0;D<t;D++)D>0&&(K+=`\nelse `),D<t-1&&(K+=`if(vTextureId < ${D}.5)`),K+=`\n{`,K+=`\n\tcolor = texture2D(uSamplers[${D}], vTextureCoord);`,K+=`\n}`;return K+=`\n`,K+=`\n`,K}}var Nt=D(23431),Wt=D(294485),xt=`varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n`,bt=`precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n`;const nt=class t extends Wt.P{constructor(K){super(K),this.setShaderGenerator(),this.geometryClass=s,this.vertexSize=6,this.state=u.for2d(),this.size=4*t.defaultBatchSize,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),K.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){var t;return this._defaultMaxTextures=null!==(t=this._defaultMaxTextures)&&void 0!==t?t:function(){let t=!0;const K=G.W0.ADAPTER.getNavigator();if(G.Fr.tablet||G.Fr.phone){if(G.Fr.apple.device){const D=K.userAgent.match(/OS (\d+)_(\d+)?/);D&&parseInt(D[1],10)<11&&(t=!1)}if(G.Fr.android.device){const D=K.userAgent.match(/Android\s([0-9.]*)/);D&&parseInt(D[1],10)<7&&(t=!1)}}return t?32:4}(),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){var t;return this._canUploadSameBuffer=null!==(t=this._canUploadSameBuffer)&&void 0!==t?t:!G.Fr.apple.device,this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return N.deprecation("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return bt}static get defaultFragmentTemplate(){return xt}setShaderGenerator({vertex:K=t.defaultVertexSrc,fragment:D=t.defaultFragmentTemplate}={}){this.shaderGenerator=new Gt(K,D)}contextChange(){const K=this.renderer.gl;G.W0.PREFER_ENV===a.Km.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(K.getParameter(K.MAX_TEXTURE_IMAGE_UNITS),t.defaultMaxTextures),this.maxTextures=function(t,K){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const D=K.createShader(K.FRAGMENT_SHADER);for(;;){const a=n.replace(/%forloop%/gi,e(t));if(K.shaderSource(D,a),K.compileShader(D),K.getShaderParameter(D,K.COMPILE_STATUS))break;t=t/2|0}return t}(this.maxTextures,K)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:K,_textureArrayPool:D}=t,a=this.size/4,G=Math.floor(a/this.maxTextures)+1;for(;K.length<a;)K.push(new h);for(;D.length<G;)D.push(new Nt.L);for(let t=0;t<this.maxTextures;t++)this._tempBoundTextures[t]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:K,maxTextures:D}=this,a=t._textureArrayPool,G=this.renderer.batch,N=this._tempBoundTextures,W=this.renderer.textureGC.count;let x=++X._globalBatch,b=0,n=a[0],e=0;G.copyBoundTextures(N,D);for(let t=0;t<this._bufferSize;++t){const i=K[t];K[t]=null,i._batchEnabled!==x&&(n.count>=D&&(G.boundArray(n,N,x,D),this.buildDrawCalls(n,e,t),e=t,n=a[++b],++x),i._batchEnabled=x,i.touched=W,n.elements[n.count++]=i)}n.count>0&&(G.boundArray(n,N,x,D),this.buildDrawCalls(n,e,this._bufferSize),++b,++x);for(let t=0;t<N.length;t++)N[t]=null;X._globalBatch=x}buildDrawCalls(K,D,a){const{_bufferedElements:G,_attributeBuffer:W,_indexBuffer:x,vertexSize:b}=this,n=t._drawCallPool;let e=this._dcIndex,i=this._aIndex,z=this._iIndex,I=n[e];I.start=this._iIndex,I.texArray=K;for(let t=D;t<a;++t){const a=G[t],Z=a._texture.baseTexture,w=N.premultiplyBlendMode[Z.alphaMode?1:0][a.blendMode];G[t]=null,D<t&&I.blend!==w&&(I.size=z-I.start,D=t,I=n[++e],I.texArray=K,I.start=z),this.packInterleavedGeometry(a,W,x,i,z),i+=a.vertexData.length/2*b,z+=a.indices.length,I.blend=w}D<a&&(I.size=z-I.start,++e),this._dcIndex=e,this._aIndex=i,this._iIndex=z}bindAndClearTexArray(t){const K=this.renderer.texture;for(let D=0;D<t.count;D++)K.bind(t.elements[D],t.ids[D]),t.elements[D]=null;t.count=0}updateGeometry(){const{_packedGeometries:K,_attributeBuffer:D,_indexBuffer:a}=this;t.canUploadSameBuffer?(K[this._flushId]._buffer.update(D.rawBinaryData),K[this._flushId]._indexBuffer.update(a),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,K[this._flushId]=new this.geometryClass),K[this._flushId]._buffer.update(D.rawBinaryData),K[this._flushId]._indexBuffer.update(a),this.renderer.geometry.bind(K[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const K=this._dcIndex,{gl:D,state:a}=this.renderer,G=t._drawCallPool;let N=null;for(let t=0;t<K;t++){const{texArray:K,type:W,size:x,start:b,blend:n}=G[t];N!==K&&(N=K,this.bindAndClearTexArray(K)),this.state.blendMode=n,a.set(this.state),D.drawElements(W,x,D.UNSIGNED_SHORT,2*b)}}flush(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),t.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const K=N.nextPow2(Math.ceil(t/8)),D=N.log2(K),a=8*K;this._aBuffers.length<=D&&(this._iBuffers.length=D+1);let G=this._aBuffers[a];return G||(this._aBuffers[a]=G=new b.u(a*this.vertexSize*4)),G}getIndexBuffer(t){const K=N.nextPow2(Math.ceil(t/12)),D=N.log2(K),a=12*K;this._iBuffers.length<=D&&(this._iBuffers.length=D+1);let G=this._iBuffers[D];return G||(this._iBuffers[D]=G=new Uint16Array(a)),G}packInterleavedGeometry(t,K,D,a,G){const{uint32View:N,float32View:x}=K,b=a/this.vertexSize,n=t.uvs,e=t.indices,i=t.vertexData,z=t._texture.baseTexture._batchLocation,I=Math.min(t.worldAlpha,1),Z=W.Q.shared.setValue(t._tintRGB).toPremultiplied(I,t._texture.baseTexture.alphaMode>0);for(let t=0;t<i.length;t+=2)x[a++]=i[t],x[a++]=i[t+1],x[a++]=n[t],x[a++]=n[t+1],N[a++]=Z,x[a++]=z;for(let t=0;t<e.length;t++)D[G++]=b+e[t]}};nt.defaultBatchSize=4096,nt.extension={name:"batch",type:x.A.RendererPlugin},nt._drawCallPool=[],nt._textureArrayPool=[];let et=nt;x.X.add(et);var it=`varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n`,zt=`attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n`;const It=class t extends at{constructor(K,D,a){super(tt.from(K||t.defaultVertexSrc,D||t.defaultFragmentSrc),a),this.padding=0,this.resolution=t.defaultResolution,this.multisample=t.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new u}apply(t,K,D,a,G){t.applyFilter(this,K,D,a)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return zt}static get defaultFragmentSrc(){return it}};It.defaultResolution=1,It.defaultMultisample=a.he.NONE;let Zt=It;class wt{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new W.Q(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:K,background:D,backgroundAlpha:a}=t,G=null!=D?D:K;void 0!==G&&(this.color=G),this.alpha=a}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}wt.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},wt.extension={type:[x.A.RendererSystem,x.A.CanvasRendererSystem],name:"background"},x.X.add(wt);class mt{constructor(t){this.renderer=t,this.emptyRenderer=new Wt.P(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,K){const{boundTextures:D}=this.renderer.texture;for(let a=K-1;a>=0;--a)t[a]=D[a]||null,t[a]&&(t[a]._batchLocation=a)}boundArray(t,K,D,a){const{elements:G,ids:N,count:W}=t;let x=0;for(let t=0;t<W;t++){const W=G[t],b=W._batchLocation;if(b>=0&&b<a&&K[b]===W)N[t]=b;else for(;x<a;){const a=K[x];if(!a||a._batchEnabled!==D||a._batchLocation!==x){N[t]=x,W._batchLocation=x,K[x]=W;break}x++}}}destroy(){this.renderer=null}}mt.extension={type:x.A.RendererSystem,name:"batch"},x.X.add(mt);let ut=0;class dt{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=ut++}init(t){if(t.context)this.initFromContext(t.context);else{const K=this.renderer.background.alpha<1,D=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:K,premultipliedAlpha:D,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=ut++,this.renderer.runners.contextChange.emit(t);const K=this.renderer.view;void 0!==K.addEventListener&&(K.addEventListener("webglcontextlost",this.handleContextLost,!1),K.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const K=this.createContext(this.renderer.view,t);this.initFromContext(K)}createContext(t,K){let D;if(G.W0.PREFER_ENV>=a.Km.WEBGL2&&(D=t.getContext("webgl2",K)),D)this.webGLVersion=2;else if(this.webGLVersion=1,D=t.getContext("webgl",K)||t.getContext("experimental-webgl",K),!D)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=D,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,K={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,K,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,K,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout((()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()}),0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,void 0!==t.removeEventListener&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const K=t.getContextAttributes(),D="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;D&&(this.webGLVersion=2),K&&!K.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const a=D||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=a,a||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}dt.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},dt.extension={type:x.A.RendererSystem,name:"context"},x.X.add(dt);class Et{constructor(t,K){if(this.width=Math.round(t),this.height=Math.round(K),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new l("disposeFramebuffer"),this.multisample=a.he.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,K){return this.colorTextures[t]=K||new X(null,{scaleMode:a.M6.NEAREST,resolution:1,mipmap:a.E8.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new X(null,{scaleMode:a.M6.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:a.E8.OFF,format:a.hR.DEPTH_COMPONENT,type:a.QE.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,K){if(t=Math.round(t),K=Math.round(K),!t||!K)throw new Error("Framebuffer width and height must not be zero");if(t!==this.width||K!==this.height){this.width=t,this.height=K,this.dirtyId++,this.dirtySize++;for(let D=0;D<this.colorTextures.length;D++){const a=this.colorTextures[D],G=a.resolution;a.setSize(t/G,K/G)}if(this.depthTexture){const D=this.depthTexture.resolution;this.depthTexture.setSize(t/D,K/D)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class lt extends X{constructor(t={}){var K,D,G;"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),t.width=null!==(K=t.width)&&void 0!==K?K:100,t.height=null!==(D=t.height)&&void 0!==D?D:100,null!==(G=t.multisample)&&void 0!==G||(t.multisample=a.he.NONE),super(null,t),this.mipmap=a.E8.OFF,this.valid=!0,this._clear=new W.Q([0,0,0,0]),this.framebuffer=new Et(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,K){this.framebuffer.resize(t*this.resolution,K*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Qt extends Q{constructor(t){const K=t;super(K.naturalWidth||K.videoWidth||K.width,K.naturalHeight||K.videoHeight||K.height),this.source=t,this.noSubImage=!1}static crossOrigin(t,K,D){void 0!==D||K.startsWith("data:")?!1!==D&&(t.crossOrigin="string"==typeof D?D:"anonymous"):t.crossOrigin=N.determineCrossOrigin(K)}upload(t,K,D,G){const N=t.gl,W=K.realWidth,x=K.realHeight;if(G=G||this.source,typeof HTMLImageElement<"u"&&G instanceof HTMLImageElement){if(!G.complete||0===G.naturalWidth)return!1}else if(typeof HTMLVideoElement<"u"&&G instanceof HTMLVideoElement&&G.readyState<=1)return!1;return N.pixelStorei(N.UNPACK_PREMULTIPLY_ALPHA_WEBGL,K.alphaMode===a.Gk.UNPACK),this.noSubImage||K.target!==N.TEXTURE_2D||D.width!==W||D.height!==x?(D.width=W,D.height=x,N.texImage2D(K.target,0,D.internalFormat,K.format,D.type,G)):N.texSubImage2D(N.TEXTURE_2D,0,0,0,K.format,D.type,G),!0}update(){if(this.destroyed)return;const t=this.source,K=t.naturalWidth||t.videoWidth||t.width,D=t.naturalHeight||t.videoHeight||t.height;this.resize(K,D),super.update()}dispose(){this.source=null}}class Pt extends Qt{constructor(t,K){var D;if(K=K||{},"string"==typeof t){const D=new Image;Qt.crossOrigin(D,t,K.crossorigin),D.src=t,t=D}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(null!==(D=K.createBitmap)&&void 0!==D?D:G.W0.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode="number"==typeof K.alphaMode?K.alphaMode:null,this.bitmap=null,this._load=null,!1!==K.autoLoad&&this.load()}load(t){return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise(((t,K)=>{const D=this.source;this.url=D.src;const a=()=>{this.destroyed||(D.onload=null,D.onerror=null,this.update(),this._load=null,this.createBitmap?t(this.process()):t(this))};D.complete&&D.src?a():(D.onload=a,D.onerror=t=>{K(t),this.onError.emit(t)})}))),this._load}process(){const t=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);const K=globalThis.createImageBitmap,D=!t.crossOrigin||"anonymous"===t.crossOrigin;return this._process=fetch(t.src,{mode:D?"cors":"no-cors"}).then((t=>t.blob())).then((D=>K(D,0,0,t.width,t.height,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===a.Gk.UNPACK?"premultiply":"none"}))).then((t=>this.destroyed?Promise.reject():(this.bitmap=t,this.update(),this._process=null,Promise.resolve(this)))),this._process}upload(t,K,D){if("number"==typeof this.alphaMode&&(K.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,K,D);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,K,D,this.bitmap),!this.preserveBitmap){let t=!0;const a=K._glTextures;for(const G in a){const N=a[G];if(N!==D&&N.dirtyId!==K.dirtyId){t=!1;break}}t&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&("string"==typeof t||t instanceof HTMLImageElement)}}class yt{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,K,D){const a=K.width,G=K.height;if(D){const K=t.width/2/a,N=t.height/2/G,W=t.x/a+K,x=t.y/G+N;D=F.ER.add(D,F.ER.NW),this.x0=W+K*F.ER.uX(D),this.y0=x+N*F.ER.uY(D),D=F.ER.add(D,2),this.x1=W+K*F.ER.uX(D),this.y1=x+N*F.ER.uY(D),D=F.ER.add(D,2),this.x2=W+K*F.ER.uX(D),this.y2=x+N*F.ER.uY(D),D=F.ER.add(D,2),this.x3=W+K*F.ER.uX(D),this.y3=x+N*F.ER.uY(D)}else this.x0=t.x/a,this.y0=t.y/G,this.x1=(t.x+t.width)/a,this.y1=t.y/G,this.x2=(t.x+t.width)/a,this.y2=(t.y+t.height)/G,this.x3=t.x/a,this.y3=(t.y+t.height)/G;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}yt.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const qt=new yt;function Xt(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class ht extends N.EventEmitter{constructor(t,K,D,a,G,N,W){if(super(),this.noFrame=!1,K||(this.noFrame=!0,K=new F.M_(0,0,1,1)),t instanceof ht&&(t=t.baseTexture),this.baseTexture=t,this._frame=K,this.trim=a,this.valid=!1,this.destroyed=!1,this._uvs=qt,this.uvMatrix=null,this.orig=D||K,this._rotate=Number(G||0),!0===G)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=N?new F.bR(N.x,N.y):new F.bR(0,0),this.defaultBorders=W,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=K:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:t}=this.baseTexture;(null==t?void 0:t.url)&&N.TextureCache[t.url]&&ht.removeFromCache(t.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,ht.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var t;const K=this._frame.clone(),D=this._frame===this.orig?K:this.orig.clone(),a=new ht(this.baseTexture,!this.noFrame&&K,D,null===(t=this.trim)||void 0===t?void 0:t.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(a._frame=K),a}updateUvs(){this._uvs===qt&&(this._uvs=new yt),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,K={},D=G.W0.STRICT_TEXTURE_CACHE){const a="string"==typeof t;let W=null;if(a)W=t;else if(t instanceof X){if(!t.cacheId){const D=(null==K?void 0:K.pixiIdPrefix)||"pixiid";t.cacheId=`${D}-${N.uid()}`,X.addToCache(t,t.cacheId)}W=t.cacheId}else{if(!t._pixiId){const D=(null==K?void 0:K.pixiIdPrefix)||"pixiid";t._pixiId=`${D}_${N.uid()}`}W=t._pixiId}let x=N.TextureCache[W];if(a&&D&&!x)throw new Error(`The cacheId "${W}" does not exist in TextureCache.`);return x||t instanceof X?!x&&t instanceof X&&(x=new ht(t),ht.addToCache(x,W)):(K.resolution||(K.resolution=N.getResolutionOfUrl(t)),x=new ht(new X(t,K)),x.baseTexture.cacheId=W,X.addToCache(x.baseTexture,W),ht.addToCache(x,W)),x}static fromURL(t,K){const D=Object.assign({autoLoad:!1},null==K?void 0:K.resourceOptions),a=ht.from(t,Object.assign({resourceOptions:D},K),!1),G=a.baseTexture.resource;return a.baseTexture.valid?Promise.resolve(a):G.load().then((()=>Promise.resolve(a)))}static fromBuffer(t,K,D,a){return new ht(X.fromBuffer(t,K,D,a))}static fromLoader(t,K,D,a){const G=new X(t,Object.assign({scaleMode:X.defaultOptions.scaleMode,resolution:N.getResolutionOfUrl(K)},a)),{resource:W}=G;W instanceof Pt&&(W.url=K);const x=new ht(G);return D||(D=K),X.addToCache(x.baseTexture,D),ht.addToCache(x,D),D!==K&&(X.addToCache(x.baseTexture,K),ht.addToCache(x,K)),x.baseTexture.valid?Promise.resolve(x):new Promise((t=>{x.baseTexture.once("loaded",(()=>t(x)))}))}static addToCache(t,K){K&&(t.textureCacheIds.includes(K)||t.textureCacheIds.push(K),N.TextureCache[K]&&N.TextureCache[K]!==t&&console.warn(`Texture added to the cache with an id [${K}] that already had an entry`),N.TextureCache[K]=t)}static removeFromCache(t){if("string"==typeof t){const K=N.TextureCache[t];if(K){const D=K.textureCacheIds.indexOf(t);return D>-1&&K.textureCacheIds.splice(D,1),delete N.TextureCache[t],K}}else if(null==t?void 0:t.textureCacheIds){for(let K=0;K<t.textureCacheIds.length;++K)N.TextureCache[t.textureCacheIds[K]]===t&&delete N.TextureCache[t.textureCacheIds[K]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:K,y:D,width:a,height:G}=t,N=K+a>this.baseTexture.width,W=D+G>this.baseTexture.height;if(N||W){const t=N&&W?"and":"or",x=`X: ${K} + ${a} = ${K+a} > ${this.baseTexture.width}`,b=`Y: ${D} + ${G} = ${D+G} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${x} ${t} ${b}`)}this.valid=a&&G&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return ht._EMPTY||(ht._EMPTY=new ht(new X),Xt(ht._EMPTY),Xt(ht._EMPTY.baseTexture)),ht._EMPTY}static get WHITE(){if(!ht._WHITE){const t=G.W0.ADAPTER.createCanvas(16,16),K=t.getContext("2d");t.width=16,t.height=16,K.fillStyle="white",K.fillRect(0,0,16,16),ht._WHITE=new ht(X.from(t)),Xt(ht._WHITE),Xt(ht._WHITE.baseTexture)}return ht._WHITE}}class Jt extends ht{constructor(t,K){super(t,K),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,K,D=!0){const a=this.baseTexture.resolution,G=Math.round(t*a)/a,N=Math.round(K*a)/a;this.valid=G>0&&N>0,this._frame.width=this.orig.width=G,this._frame.height=this.orig.height=N,D&&this.baseTexture.resize(G,N),this.updateUvs()}setResolution(t){const{baseTexture:K}=this;K.resolution!==t&&(K.setResolution(t),this.resize(K.width,K.height,!1))}static create(t){return new Jt(new lt(t))}}class Tt{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,K,D=a.he.NONE){const G=new lt(Object.assign({width:t,height:K,resolution:1,multisample:D},this.textureOptions));return new Jt(G)}getOptimalTexture(t,K,D=1,G=a.he.NONE){let W;t=Math.max(Math.ceil(t*D-1e-6),1),K=Math.max(Math.ceil(K*D-1e-6),1),this.enableFullScreen&&t===this._pixelsWidth&&K===this._pixelsHeight?W=G>1?-G:-1:(W=((65535&(t=N.nextPow2(t)))<<16|65535&(K=N.nextPow2(K)))>>>0,G>1&&(W+=4294967296*G)),this.texturePool[W]||(this.texturePool[W]=[]);let x=this.texturePool[W].pop();return x||(x=this.createTexture(t,K,G)),x.filterPoolKey=W,x.setResolution(D),x}getFilterTexture(t,K,D){const G=this.getOptimalTexture(t.width,t.height,K||t.resolution,D||a.he.NONE);return G.filterFrame=t.filterFrame,G}returnTexture(t){const K=t.filterPoolKey;t.filterFrame=null,this.texturePool[K].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=!1!==t)for(const t in this.texturePool){const K=this.texturePool[t];if(K)for(let t=0;t<K.length;t++)K[t].destroy(!0)}this.texturePool={}}setScreenSize(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){this.enableFullScreen=t.width>0&&t.height>0;for(const t in this.texturePool){if(!(Number(t)<0))continue;const K=this.texturePool[t];if(K)for(let t=0;t<K.length;t++)K[t].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}Tt.SCREEN_KEY=-1;class _t extends V{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Ct extends V{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new T(this.vertices),this.uvBuffer=new T(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,K){let D=0,a=0;return this.uvs[0]=D,this.uvs[1]=a,this.uvs[2]=D+K.width/t.width,this.uvs[3]=a,this.uvs[4]=D+K.width/t.width,this.uvs[5]=a+K.height/t.height,this.uvs[6]=D,this.uvs[7]=a+K.height/t.height,D=K.x,a=K.y,this.vertices[0]=D,this.vertices[1]=a,this.vertices[2]=D+K.width,this.vertices[3]=a,this.vertices[4]=D+K.width,this.vertices[5]=a+K.height,this.vertices[6]=D,this.vertices[7]=a+K.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class Ht{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=a.he.NONE,this.sourceFrame=new F.M_,this.destinationFrame=new F.M_,this.bindingSourceFrame=new F.M_,this.bindingDestinationFrame=new F.M_,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const ot=[new F.bR,new F.bR,new F.bR,new F.bR],Ut=new F.uq;class Vt{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Tt,this.statePool=[],this.quad=new _t,this.quadUv=new Ct,this.tempRect=new F.M_,this.activeState={},this.globalUniforms=new Dt({outputFrame:new F.M_,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,K){var D,a,G,N;const W=this.renderer,x=this.defaultFilterStack,b=this.statePool.pop()||new Ht,n=W.renderTexture;let e,i;if(n.current){const t=n.current;e=t.resolution,i=t.multisample}else e=W.resolution,i=W.multisample;let z=K[0].resolution||e,I=null!==(D=K[0].multisample)&&void 0!==D?D:i,Z=K[0].padding,w=K[0].autoFit,m=null===(a=K[0].legacy)||void 0===a||a;for(let t=1;t<K.length;t++){const D=K[t];z=Math.min(z,D.resolution||e),I=Math.min(I,null!==(G=D.multisample)&&void 0!==G?G:i),Z=this.useMaxPadding?Math.max(Z,D.padding):Z+D.padding,w=w&&D.autoFit,m=m||null===(N=D.legacy)||void 0===N||N}1===x.length&&(this.defaultFilterStack[0].renderTexture=n.current),x.push(b),b.resolution=z,b.multisample=I,b.legacy=m,b.target=t,b.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),b.sourceFrame.pad(Z);const u=this.tempRect.copyFrom(n.sourceFrame);W.projection.transform&&this.transformAABB(Ut.copyFrom(W.projection.transform).invert(),u),w?(b.sourceFrame.fit(u),(b.sourceFrame.width<=0||b.sourceFrame.height<=0)&&(b.sourceFrame.width=0,b.sourceFrame.height=0)):b.sourceFrame.intersects(u)||(b.sourceFrame.width=0,b.sourceFrame.height=0),this.roundFrame(b.sourceFrame,n.current?n.current.resolution:W.resolution,n.sourceFrame,n.destinationFrame,W.projection.transform),b.renderTexture=this.getOptimalFilterTexture(b.sourceFrame.width,b.sourceFrame.height,z,I),b.filters=K,b.destinationFrame.width=b.renderTexture.width,b.destinationFrame.height=b.renderTexture.height;const d=this.tempRect;d.x=0,d.y=0,d.width=b.sourceFrame.width,d.height=b.sourceFrame.height,b.renderTexture.filterFrame=b.sourceFrame,b.bindingSourceFrame.copyFrom(n.sourceFrame),b.bindingDestinationFrame.copyFrom(n.destinationFrame),b.transform=W.projection.transform,W.projection.transform=null,n.bind(b.renderTexture,b.sourceFrame,d),W.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,K=t.pop(),D=K.filters;this.activeState=K;const G=this.globalUniforms.uniforms;G.outputFrame=K.sourceFrame,G.resolution=K.resolution;const N=G.inputSize,W=G.inputPixel,x=G.inputClamp;if(N[0]=K.destinationFrame.width,N[1]=K.destinationFrame.height,N[2]=1/N[0],N[3]=1/N[1],W[0]=Math.round(N[0]*K.resolution),W[1]=Math.round(N[1]*K.resolution),W[2]=1/W[0],W[3]=1/W[1],x[0]=.5*W[2],x[1]=.5*W[3],x[2]=K.sourceFrame.width*N[2]-.5*W[2],x[3]=K.sourceFrame.height*N[3]-.5*W[3],K.legacy){const t=G.filterArea;t[0]=K.destinationFrame.width,t[1]=K.destinationFrame.height,t[2]=K.sourceFrame.x,t[3]=K.sourceFrame.y,G.filterClamp=G.inputClamp}this.globalUniforms.update();const b=t[t.length-1];if(this.renderer.framebuffer.blit(),1===D.length)D[0].apply(this,K.renderTexture,b.renderTexture,a.fr.BLEND,K),this.returnFilterTexture(K.renderTexture);else{let t=K.renderTexture,G=this.getOptimalFilterTexture(t.width,t.height,K.resolution);G.filterFrame=t.filterFrame;let N=0;for(N=0;N<D.length-1;++N){1===N&&K.multisample>1&&(G=this.getOptimalFilterTexture(t.width,t.height,K.resolution),G.filterFrame=t.filterFrame),D[N].apply(this,t,G,a.fr.CLEAR,K);const W=t;t=G,G=W}D[N].apply(this,t,b.renderTexture,a.fr.BLEND,K),N>1&&K.multisample>1&&this.returnFilterTexture(K.renderTexture),this.returnFilterTexture(t),this.returnFilterTexture(G)}K.clear(),this.statePool.push(K)}bindAndClear(t,K=a.fr.CLEAR){const{renderTexture:D,state:G}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,null==t?void 0:t.filterFrame){const K=this.tempRect;K.x=0,K.y=0,K.width=t.filterFrame.width,K.height=t.filterFrame.height,D.bind(t,t.filterFrame,K)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?D.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const N=1&G.stateId||this.forceClear;(K===a.fr.CLEAR||K===a.fr.BLIT&&N)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,K,D,G){const N=this.renderer;N.state.set(t.state),this.bindAndClear(D,G),t.uniforms.uSampler=K,t.uniforms.filterGlobals=this.globalUniforms,N.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(K._frame,K.filterFrame),N.geometry.bind(this.quadUv),N.geometry.draw(a._4.TRIANGLES)):(N.geometry.bind(this.quad),N.geometry.draw(a._4.TRIANGLE_STRIP))}calculateSpriteMatrix(t,K){const{sourceFrame:D,destinationFrame:a}=this.activeState,{orig:G}=K._texture,N=t.set(a.width,0,0,a.height,D.x,D.y),W=K.worldTransform.copyTo(F.uq.TEMP_MATRIX);return W.invert(),N.prepend(W),N.scale(1/G.width,1/G.height),N.translate(K.anchor.x,K.anchor.y),N}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,K,D=1,G=a.he.NONE){return this.texturePool.getOptimalTexture(t,K,D,G)}getFilterTexture(t,K,D){if("number"==typeof t){const D=t;t=K,K=D}t=t||this.activeState.renderTexture;const G=this.texturePool.getOptimalTexture(t.width,t.height,K||t.resolution,D||a.he.NONE);return G.filterFrame=t.filterFrame,G}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,K){const D=ot[0],a=ot[1],G=ot[2],N=ot[3];D.set(K.left,K.top),a.set(K.left,K.bottom),G.set(K.right,K.top),N.set(K.right,K.bottom),t.apply(D,D),t.apply(a,a),t.apply(G,G),t.apply(N,N);const W=Math.min(D.x,a.x,G.x,N.x),x=Math.min(D.y,a.y,G.y,N.y),b=Math.max(D.x,a.x,G.x,N.x),n=Math.max(D.y,a.y,G.y,N.y);K.x=W,K.y=x,K.width=b-W,K.height=n-x}roundFrame(t,K,D,a,G){if(!(t.width<=0||t.height<=0||D.width<=0||D.height<=0)){if(G){const{a:t,b:K,c:D,d:a}=G;if((Math.abs(K)>1e-4||Math.abs(D)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(a)>1e-4))return}(G=G?Ut.copyFrom(G):Ut.identity()).translate(-D.x,-D.y).scale(a.width/D.width,a.height/D.height).translate(a.x,a.y),this.transformAABB(G,t),t.ceil(K),this.transformAABB(G.invert(),t)}}}Vt.extension={type:x.A.RendererSystem,name:"filter"},x.X.add(Vt);class st{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=a.he.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Ft=new F.M_;class ct{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Et(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new F.M_,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){let K=this.renderer.context.extensions.drawBuffers,D=this.renderer.context.extensions.depthTexture;G.W0.PREFER_ENV===a.Km.WEBGL_LEGACY&&(K=null,D=null),K?t.drawBuffers=t=>K.drawBuffersWEBGL(t):(this.hasMRT=!1,t.drawBuffers=()=>{}),D||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,K,D=0){const{gl:a}=this;if(t){const G=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,a.bindFramebuffer(a.FRAMEBUFFER,G.framebuffer)),G.mipLevel!==D&&(t.dirtyId++,t.dirtyFormat++,G.mipLevel=D),G.dirtyId!==t.dirtyId&&(G.dirtyId=t.dirtyId,G.dirtyFormat!==t.dirtyFormat?(G.dirtyFormat=t.dirtyFormat,G.dirtySize=t.dirtySize,this.updateFramebuffer(t,D)):G.dirtySize!==t.dirtySize&&(G.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let K=0;K<t.colorTextures.length;K++){const D=t.colorTextures[K];this.renderer.texture.unbind(D.parentTextureArray||D)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),K){const t=K.width>>D,a=K.height>>D,G=t/K.width;this.setViewport(K.x*G,K.y*G,t,a)}else{const K=t.width>>D,a=t.height>>D;this.setViewport(0,0,K,a)}}else this.current&&(this.current=null,a.bindFramebuffer(a.FRAMEBUFFER,null)),K?this.setViewport(K.x,K.y,K.width,K.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,K,D,a){const G=this.viewport;t=Math.round(t),K=Math.round(K),D=Math.round(D),a=Math.round(a),(G.width!==D||G.height!==a||G.x!==t||G.y!==K)&&(G.x=t,G.y=K,G.width=D,G.height=a,this.gl.viewport(t,K,D,a))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,K,D,G,N=a.wn.COLOR|a.wn.DEPTH){const{gl:W}=this;W.clearColor(t,K,D,G),W.clear(N)}initFramebuffer(t){const{gl:K}=this,D=new st(K.createFramebuffer());return D.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=D,this.managedFramebuffers.push(t),t.disposeRunner.add(this),D}resizeFramebuffer(t){const{gl:K}=this,D=t.glFramebuffers[this.CONTEXT_UID];if(D.stencil){let a;K.bindRenderbuffer(K.RENDERBUFFER,D.stencil),a=1===this.renderer.context.webGLVersion?K.DEPTH_STENCIL:t.depth&&t.stencil?K.DEPTH24_STENCIL8:t.depth?K.DEPTH_COMPONENT24:K.STENCIL_INDEX8,D.msaaBuffer?K.renderbufferStorageMultisample(K.RENDERBUFFER,D.multisample,a,t.width,t.height):K.renderbufferStorage(K.RENDERBUFFER,a,t.width,t.height)}const a=t.colorTextures;let G=a.length;K.drawBuffers||(G=Math.min(G,1));for(let N=0;N<G;N++){const G=a[N],W=G.parentTextureArray||G;this.renderer.texture.bind(W,0),0===N&&D.msaaBuffer&&(K.bindRenderbuffer(K.RENDERBUFFER,D.msaaBuffer),K.renderbufferStorageMultisample(K.RENDERBUFFER,D.multisample,W._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,K){const{gl:D}=this,a=t.glFramebuffers[this.CONTEXT_UID],G=t.colorTextures;let N=G.length;D.drawBuffers||(N=Math.min(N,1)),a.multisample>1&&this.canMultisampleFramebuffer(t)?a.msaaBuffer=a.msaaBuffer||D.createRenderbuffer():a.msaaBuffer&&(D.deleteRenderbuffer(a.msaaBuffer),a.msaaBuffer=null,a.blitFramebuffer&&(a.blitFramebuffer.dispose(),a.blitFramebuffer=null));const W=[];for(let x=0;x<N;x++){const N=G[x],b=N.parentTextureArray||N;this.renderer.texture.bind(b,0),0===x&&a.msaaBuffer?(D.bindRenderbuffer(D.RENDERBUFFER,a.msaaBuffer),D.renderbufferStorageMultisample(D.RENDERBUFFER,a.multisample,b._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),D.framebufferRenderbuffer(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,D.RENDERBUFFER,a.msaaBuffer)):(D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0+x,N.target,b._glTextures[this.CONTEXT_UID].texture,K),W.push(D.COLOR_ATTACHMENT0+x))}if(W.length>1&&D.drawBuffers(W),t.depthTexture&&this.writeDepthTexture){const a=t.depthTexture;this.renderer.texture.bind(a,0),D.framebufferTexture2D(D.FRAMEBUFFER,D.DEPTH_ATTACHMENT,D.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,K)}if(!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture)a.stencil&&(D.deleteRenderbuffer(a.stencil),a.stencil=null);else{let K,G;a.stencil=a.stencil||D.createRenderbuffer(),1===this.renderer.context.webGLVersion?(K=D.DEPTH_STENCIL_ATTACHMENT,G=D.DEPTH_STENCIL):t.depth&&t.stencil?(K=D.DEPTH_STENCIL_ATTACHMENT,G=D.DEPTH24_STENCIL8):t.depth?(K=D.DEPTH_ATTACHMENT,G=D.DEPTH_COMPONENT24):(K=D.STENCIL_ATTACHMENT,G=D.STENCIL_INDEX8),D.bindRenderbuffer(D.RENDERBUFFER,a.stencil),a.msaaBuffer?D.renderbufferStorageMultisample(D.RENDERBUFFER,a.multisample,G,t.width,t.height):D.renderbufferStorage(D.RENDERBUFFER,G,t.width,t.height),D.framebufferRenderbuffer(D.FRAMEBUFFER,K,D.RENDERBUFFER,a.stencil)}}canMultisampleFramebuffer(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:K}=this;let D=a.he.NONE;if(t<=1||null===K)return D;for(let a=0;a<K.length;a++)if(K[a]<=t){D=K[a];break}return 1===D&&(D=a.he.NONE),D}blit(t,K,D){const{current:a,renderer:G,gl:N,CONTEXT_UID:W}=this;if(2!==G.context.webGLVersion||!a)return;const x=a.glFramebuffers[W];if(!x)return;if(!t){if(!x.msaaBuffer)return;const K=a.colorTextures[0];if(!K)return;x.blitFramebuffer||(x.blitFramebuffer=new Et(a.width,a.height),x.blitFramebuffer.addColorTexture(0,K)),(t=x.blitFramebuffer).colorTextures[0]!==K&&(t.colorTextures[0]=K,t.dirtyId++,t.dirtyFormat++),(t.width!==a.width||t.height!==a.height)&&(t.width=a.width,t.height=a.height,t.dirtyId++,t.dirtySize++)}K||((K=Ft).width=a.width,K.height=a.height),D||(D=K);const b=K.width===D.width&&K.height===D.height;this.bind(t),N.bindFramebuffer(N.READ_FRAMEBUFFER,x.framebuffer),N.blitFramebuffer(K.left,K.top,K.right,K.bottom,D.left,D.top,D.right,D.bottom,N.COLOR_BUFFER_BIT,b?N.NEAREST:N.LINEAR),N.bindFramebuffer(N.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,K){const D=t.glFramebuffers[this.CONTEXT_UID],a=this.gl;if(!D)return;delete t.glFramebuffers[this.CONTEXT_UID];const G=this.managedFramebuffers.indexOf(t);G>=0&&this.managedFramebuffers.splice(G,1),t.disposeRunner.remove(this),K||(a.deleteFramebuffer(D.framebuffer),D.msaaBuffer&&a.deleteRenderbuffer(D.msaaBuffer),D.stencil&&a.deleteRenderbuffer(D.stencil)),D.blitFramebuffer&&this.disposeFramebuffer(D.blitFramebuffer,K)}disposeAll(t){const K=this.managedFramebuffers;this.managedFramebuffers=[];for(let D=0;D<K.length;D++)this.disposeFramebuffer(K[D],t)}forceStencil(){const t=this.current;if(!t)return;const K=t.glFramebuffers[this.CONTEXT_UID];if(!K||K.stencil&&t.stencil)return;t.stencil=!0;const D=t.width,a=t.height,G=this.gl,N=K.stencil=G.createRenderbuffer();let W,x;G.bindRenderbuffer(G.RENDERBUFFER,N),1===this.renderer.context.webGLVersion?(W=G.DEPTH_STENCIL_ATTACHMENT,x=G.DEPTH_STENCIL):t.depth?(W=G.DEPTH_STENCIL_ATTACHMENT,x=G.DEPTH24_STENCIL8):(W=G.STENCIL_ATTACHMENT,x=G.STENCIL_INDEX8),K.msaaBuffer?G.renderbufferStorageMultisample(G.RENDERBUFFER,K.multisample,x,D,a):G.renderbufferStorage(G.RENDERBUFFER,x,D,a),G.framebufferRenderbuffer(G.FRAMEBUFFER,W,G.RENDERBUFFER,N)}reset(){this.current=this.unknownFramebuffer,this.viewport=new F.M_}destroy(){this.renderer=null}}ct.extension={type:x.A.RendererSystem,name:"framebuffer"},x.X.add(ct);const gt={5126:4,5123:2,5121:1};class Rt{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,K=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==K.webGLVersion){let K=this.renderer.context.extensions.vertexArrayObject;G.W0.PREFER_ENV===a.Km.WEBGL_LEGACY&&(K=null),K?(t.createVertexArray=()=>K.createVertexArrayOES(),t.bindVertexArray=t=>K.bindVertexArrayOES(t),t.deleteVertexArray=t=>K.deleteVertexArrayOES(t)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(2!==K.webGLVersion){const K=t.getExtension("ANGLE_instanced_arrays");K?(t.vertexAttribDivisor=(t,D)=>K.vertexAttribDivisorANGLE(t,D),t.drawElementsInstanced=(t,D,a,G,N)=>K.drawElementsInstancedANGLE(t,D,a,G,N),t.drawArraysInstanced=(t,D,a,G)=>K.drawArraysInstancedANGLE(t,D,a,G)):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===K.webGLVersion||!!K.extensions.uint32ElementIndex}bind(t,K){K=K||this.renderer.shader.shader;const{gl:D}=this;let a=t.glVertexArrayObjects[this.CONTEXT_UID],G=!1;a||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=a={},G=!0);const N=a[K.program.id]||this.initGeometryVao(t,K,G);this._activeGeometry=t,this._activeVao!==N&&(this._activeVao=N,this.hasVao?D.bindVertexArray(N):this.activateVao(t,K.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,K=this.renderer.buffer;for(let D=0;D<t.buffers.length;D++){const a=t.buffers[D];K.update(a)}}checkCompatibility(t,K){const D=t.attributes,a=K.attributeData;for(const t in a)if(!D[t])throw new Error(`shader and geometry incompatible, geometry missing the "${t}" attribute`)}getSignature(t,K){const D=t.attributes,a=K.attributeData,G=["g",t.id];for(const t in D)a[t]&&G.push(t,a[t].location);return G.join("-")}initGeometryVao(t,K,D=!0){const G=this.gl,N=this.CONTEXT_UID,W=this.renderer.buffer,x=K.program;x.glPrograms[N]||this.renderer.shader.generateProgram(K),this.checkCompatibility(t,x);const b=this.getSignature(t,x),n=t.glVertexArrayObjects[this.CONTEXT_UID];let e=n[b];if(e)return n[x.id]=e,e;const i=t.buffers,z=t.attributes,I={},Z={};for(const t in i)I[t]=0,Z[t]=0;for(const t in z)!z[t].size&&x.attributeData[t]?z[t].size=x.attributeData[t].size:z[t].size||console.warn(`PIXI Geometry attribute '${t}' size cannot be determined (likely the bound shader does not have the attribute)`),I[z[t].buffer]+=z[t].size*gt[z[t].type];for(const t in z){const K=z[t],D=K.size;void 0===K.stride&&(I[K.buffer]===D*gt[K.type]?K.stride=0:K.stride=I[K.buffer]),void 0===K.start&&(K.start=Z[K.buffer],Z[K.buffer]+=D*gt[K.type])}e=G.createVertexArray(),G.bindVertexArray(e);for(let t=0;t<i.length;t++){const K=i[t];W.bind(K),D&&K._glBuffers[N].refCount++}return this.activateVao(t,x),n[x.id]=e,n[b]=e,G.bindVertexArray(null),W.unbind(a.yw.ARRAY_BUFFER),e}disposeGeometry(t,K){var D;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const a=t.glVertexArrayObjects[this.CONTEXT_UID],G=this.gl,N=t.buffers,W=null===(D=this.renderer)||void 0===D?void 0:D.buffer;if(t.disposeRunner.remove(this),a){if(W)for(let t=0;t<N.length;t++){const D=N[t]._glBuffers[this.CONTEXT_UID];D&&(D.refCount--,0===D.refCount&&!K&&W.dispose(N[t],K))}if(!K)for(const t in a)if("g"===t[0]){const K=a[t];this._activeVao===K&&this.unbind(),G.deleteVertexArray(K)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const K=Object.keys(this.managedGeometries);for(let D=0;D<K.length;D++)this.disposeGeometry(this.managedGeometries[K[D]],t)}activateVao(t,K){const D=this.gl,a=this.CONTEXT_UID,G=this.renderer.buffer,N=t.buffers,W=t.attributes;t.indexBuffer&&G.bind(t.indexBuffer);let x=null;for(const t in W){const b=W[t],n=N[b.buffer],e=n._glBuffers[a];if(K.attributeData[t]){x!==e&&(G.bind(n),x=e);const a=K.attributeData[t].location;if(D.enableVertexAttribArray(a),D.vertexAttribPointer(a,b.size,b.type||D.FLOAT,b.normalized,b.stride,b.start),b.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");D.vertexAttribDivisor(a,b.divisor)}}}}draw(t,K,D,a){const{gl:G}=this,N=this._activeGeometry;if(N.indexBuffer){const W=N.indexBuffer.data.BYTES_PER_ELEMENT,x=2===W?G.UNSIGNED_SHORT:G.UNSIGNED_INT;2===W||4===W&&this.canUseUInt32ElementIndex?N.instanced?G.drawElementsInstanced(t,K||N.indexBuffer.data.length,x,(D||0)*W,a||1):G.drawElements(t,K||N.indexBuffer.data.length,x,(D||0)*W):console.warn("unsupported index buffer type: uint32")}else N.instanced?G.drawArraysInstanced(t,D,K||N.getSize(),a||1):G.drawArrays(t,D,K||N.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Rt.extension={type:x.A.RendererSystem,name:"geometry"},x.X.add(Rt);const At=new F.uq;class Yt{constructor(t,K){this._texture=t,this.mapCoord=new F.uq,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof K>"u"?.5:K,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,K){void 0===K&&(K=t);const D=this.mapCoord;for(let a=0;a<t.length;a+=2){const G=t[a],N=t[a+1];K[a]=G*D.a+N*D.c+D.tx,K[a+1]=G*D.b+N*D.d+D.ty}return K}update(t){const K=this._texture;if(!K||!K.valid||!t&&this._textureID===K._updateID)return!1;this._textureID=K._updateID,this._updateID++;const D=K._uvs;this.mapCoord.set(D.x1-D.x0,D.y1-D.y0,D.x3-D.x0,D.y3-D.y0,D.x0,D.y0);const a=K.orig,G=K.trim;G&&(At.set(a.width/G.width,0,0,a.height/G.height,-G.x/G.width,-G.y/G.height),this.mapCoord.append(At));const N=K.baseTexture,W=this.uClampFrame,x=this.clampMargin/N.resolution,b=this.clampOffset;return W[0]=(K._frame.x+x+b)/N.width,W[1]=(K._frame.y+x+b)/N.height,W[2]=(K._frame.x+K._frame.width-x+b)/N.width,W[3]=(K._frame.y+K._frame.height-x+b)/N.height,this.uClampOffset[0]=b/N.realWidth,this.uClampOffset[1]=b/N.realHeight,this.isSimple=K._frame.width===N.width&&K._frame.height===N.height&&0===K.rotate,!0}}var Lt=`varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n`,St=`attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n`;class ft extends Zt{constructor(t,K,D){let a=null;"string"!=typeof t&&void 0===K&&void 0===D&&(a=t,t=void 0,K=void 0,D=void 0),super(t||St,K||Lt,D),this.maskSprite=a,this.maskMatrix=new F.uq}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,K,D,a){const G=this._maskSprite,N=G._texture;N.valid&&(N.uvMatrix||(N.uvMatrix=new Yt(N,0)),N.uvMatrix.update(),this.uniforms.npmAlpha=N.baseTexture.alphaMode?0:1,this.uniforms.mask=N,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,G).prepend(N.uvMatrix.mapCoord),this.uniforms.alpha=G.worldAlpha,this.uniforms.maskClamp=N.uvMatrix.uClampFrame,t.applyFilter(this,K,D,a))}}class $t{constructor(t=null){this.type=a.vg.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Zt.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=a.vg.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Bt{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,K){let D=K;if(!D.isMaskData){const t=this.maskDataPool.pop()||new $t;t.pooled=!0,t.maskObject=K,D=t}const G=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(D.copyCountersOrReset(G),D._colorMask=G?G._colorMask:15,D.autoDetect&&this.detect(D),D._target=t,D.type!==a.vg.SPRITE&&this.maskStack.push(D),D.enabled)switch(D.type){case a.vg.SCISSOR:this.renderer.scissor.push(D);break;case a.vg.STENCIL:this.renderer.stencil.push(D);break;case a.vg.SPRITE:D.copyCountersOrReset(null),this.pushSpriteMask(D);break;case a.vg.COLOR:this.pushColorMask(D)}D.type===a.vg.SPRITE&&this.maskStack.push(D)}pop(t){const K=this.maskStack.pop();if(K&&K._target===t){if(K.enabled)switch(K.type){case a.vg.SCISSOR:this.renderer.scissor.pop(K);break;case a.vg.STENCIL:this.renderer.stencil.pop(K.maskObject);break;case a.vg.SPRITE:this.popSpriteMask(K);break;case a.vg.COLOR:this.popColorMask(K)}if(K.reset(),K.pooled&&this.maskDataPool.push(K),0!==this.maskStack.length){const t=this.maskStack[this.maskStack.length-1];t.type===a.vg.SPRITE&&t._filters&&(t._filters[0].maskSprite=t.maskObject)}}}detect(t){const K=t.maskObject;K?K.isSprite?t.type=a.vg.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=a.vg.SCISSOR:t.type=a.vg.STENCIL:t.type=a.vg.COLOR}pushSpriteMask(t){const{maskObject:K}=t,D=t._target;let a=t._filters;a||(a=this.alphaMaskPool[this.alphaMaskIndex],a||(a=this.alphaMaskPool[this.alphaMaskIndex]=[new ft])),a[0].resolution=t.resolution,a[0].multisample=t.multisample,a[0].maskSprite=K;const G=D.filterArea;D.filterArea=K.getBounds(!0),this.renderer.filter.push(D,a),D.filterArea=G,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const K=t._colorMask,D=t._colorMask=K&t.colorMask;D!==K&&this.renderer.gl.colorMask(!!(1&D),!!(2&D),!!(4&D),!!(8&D))}popColorMask(t){const K=t._colorMask,D=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;D!==K&&this.renderer.gl.colorMask(!!(1&D),!!(2&D),!!(4&D),!!(8&D))}destroy(){this.renderer=null}}Bt.extension={type:x.A.RendererSystem,name:"mask"},x.X.add(Bt);class Ot{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:K}=this.renderer,D=this.getStackLength();this.maskStack=t;const a=this.getStackLength();a!==D&&(0===a?K.disable(this.glConst):(K.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const vt=new F.uq,pt=[],jt=class t extends Ot{constructor(t){super(t),this.glConst=G.W0.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){var K;if(t._scissorRectLocal)return;const D=t._scissorRect,{maskObject:a}=t,{renderer:G}=this,N=G.renderTexture,W=a.getBounds(!0,null!==(K=pt.pop())&&void 0!==K?K:new F.M_);this.roundFrameToPixels(W,N.current?N.current.resolution:G.resolution,N.sourceFrame,N.destinationFrame,G.projection.transform),D&&W.fit(D),t._scissorRectLocal=W}static isMatrixRotated(t){if(!t)return!1;const{a:K,b:D,c:a,d:G}=t;return(Math.abs(D)>1e-4||Math.abs(a)>1e-4)&&(Math.abs(K)>1e-4||Math.abs(G)>1e-4)}testScissor(K){const{maskObject:D}=K;if(!D.isFastRect||!D.isFastRect()||t.isMatrixRotated(D.worldTransform)||t.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(K);const a=K._scissorRectLocal;return a.width>0&&a.height>0}roundFrameToPixels(K,D,a,G,N){t.isMatrixRotated(N)||((N=N?vt.copyFrom(N):vt.identity()).translate(-a.x,-a.y).scale(G.width/a.width,G.height/a.height).translate(G.x,G.y),this.renderer.filter.transformAABB(N,K),K.fit(G),K.x=Math.round(K.x*D),K.y=Math.round(K.y*D),K.width=Math.round(K.width*D),K.height=Math.round(K.height*D))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:K}=this.renderer;t._scissorRect||K.enable(K.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:K}=this.renderer;t&&pt.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():K.disable(K.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let K;K=this.renderer.renderTexture.current?t.y:this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,K,t.width,t.height)}};jt.extension={type:x.A.RendererSystem,name:"scissor"};let rt=jt;x.X.add(rt);class Mt extends Ot{constructor(t){super(t),this.glConst=G.W0.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const K=t.maskObject,{gl:D}=this.renderer,a=t._stencilCounter;0===a&&(this.renderer.framebuffer.forceStencil(),D.clearStencil(0),D.clear(D.STENCIL_BUFFER_BIT),D.enable(D.STENCIL_TEST)),t._stencilCounter++;const G=t._colorMask;0!==G&&(t._colorMask=0,D.colorMask(!1,!1,!1,!1)),D.stencilFunc(D.EQUAL,a,4294967295),D.stencilOp(D.KEEP,D.KEEP,D.INCR),K.renderable=!0,K.render(this.renderer),this.renderer.batch.flush(),K.renderable=!1,0!==G&&(t._colorMask=G,D.colorMask(!!(1&G),!!(2&G),!!(4&G),!!(8&G))),this._useCurrent()}pop(t){const K=this.renderer.gl;if(0===this.getStackLength())K.disable(K.STENCIL_TEST);else{const D=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,a=D?D._colorMask:15;0!==a&&(D._colorMask=0,K.colorMask(!1,!1,!1,!1)),K.stencilOp(K.KEEP,K.KEEP,K.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==a&&(D._colorMask=a,K.colorMask(!!(1&a),!!(2&a),!!(4&a),!!(8&a))),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}Mt.extension={type:x.A.RendererSystem,name:"stencil"},x.X.add(Mt);class kt{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get:()=>(N.deprecation("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract)},prepare:{enumerable:!1,get:()=>(N.deprecation("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare)},interaction:{enumerable:!1,get:()=>(N.deprecation("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events)}})}init(){const t=this.rendererPlugins;for(const K in t)this.plugins[K]=new t[K](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}kt.extension={type:[x.A.RendererSystem,x.A.CanvasRendererSystem],name:"_plugin"},x.X.add(kt);class tK{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new F.uq,this.transform=null}update(t,K,D,a){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=K||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,D,a),this.transform&&this.projectionMatrix.append(this.transform);const G=this.renderer;G.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,G.globalUniforms.update(),G.shader.shader&&G.shader.syncUniformGroup(G.shader.shader.uniforms.globals)}calculateProjection(t,K,D,a){const G=this.projectionMatrix,N=a?-1:1;G.identity(),G.a=1/K.width*2,G.d=N*(1/K.height*2),G.tx=-1-K.x*G.a,G.ty=-N-K.y*G.d}setTransform(t){}destroy(){this.renderer=null}}tK.extension={type:x.A.RendererSystem,name:"projection"},x.X.add(tK);const KK=new F.dL,DK=new F.M_;class aK{constructor(t){this.renderer=t,this._tempMatrix=new F.uq}generateTexture(t,K){var D;const{region:a,...G}=K||{},N=(null==a?void 0:a.copyTo(DK))||t.getLocalBounds(DK,!0),W=G.resolution||this.renderer.resolution;N.width=Math.max(N.width,1/W),N.height=Math.max(N.height,1/W),G.width=N.width,G.height=N.height,G.resolution=W,null!==(D=G.multisample)&&void 0!==D||(G.multisample=this.renderer.multisample);const x=Jt.create(G);this._tempMatrix.tx=-N.x,this._tempMatrix.ty=-N.y;const b=t.transform;return t.transform=KK,this.renderer.render(t,{renderTexture:x,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=b,x}destroy(){}}aK.extension={type:[x.A.RendererSystem,x.A.CanvasRendererSystem],name:"textureGenerator"},x.X.add(aK);const GK=new F.M_,NK=new F.M_;class WK{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new F.M_,this.destinationFrame=new F.M_,this.viewportFrame=new F.M_}contextChange(){var t;const K=null===(t=this.renderer)||void 0===t?void 0:t.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(K&&K.alpha&&K.premultipliedAlpha)}bind(t=null,K,D){const a=this.renderer;let G,N,W;this.current=t,t?(G=t.baseTexture,W=G.resolution,K||(GK.width=t.frame.width,GK.height=t.frame.height,K=GK),D||(NK.x=t.frame.x,NK.y=t.frame.y,NK.width=K.width,NK.height=K.height,D=NK),N=G.framebuffer):(W=a.resolution,K||(GK.width=a._view.screen.width,GK.height=a._view.screen.height,K=GK),D||((D=GK).width=K.width,D.height=K.height));const x=this.viewportFrame;x.x=D.x*W,x.y=D.y*W,x.width=D.width*W,x.height=D.height*W,t||(x.y=a.view.height-(x.y+x.height)),x.ceil(),this.renderer.framebuffer.bind(N,x),this.renderer.projection.update(D,K,W,!N),t?this.renderer.mask.setMaskStack(G.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(K),this.destinationFrame.copyFrom(D)}clear(t,K){const D=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,a=W.Q.shared.setValue(t||D);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&a.premultiply(a.alpha);const G=this.destinationFrame,N=this.current?this.current.baseTexture:this.renderer._view.screen,x=G.width!==N.width||G.height!==N.height;if(x){let{x:t,y:K,width:D,height:a}=this.viewportFrame;t=Math.round(t),K=Math.round(K),D=Math.round(D),a=Math.round(a),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(t,K,D,a)}this.renderer.framebuffer.clear(a.red,a.green,a.blue,a.alpha,K),x&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}WK.extension={type:x.A.RendererSystem,name:"renderTexture"},x.X.add(WK);class xK{constructor(t,K){this.program=t,this.uniformData=K,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function bK(t,K,D){const a=t.createShader(K);return t.shaderSource(a,D),t.compileShader(a),a}function nK(t){const K=new Array(t);for(let t=0;t<K.length;t++)K[t]=!1;return K}function eK(t,K){switch(t){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*K);case"vec3":return new Float32Array(3*K);case"vec4":return new Float32Array(4*K);case"ivec2":return new Int32Array(2*K);case"ivec3":return new Int32Array(3*K);case"ivec4":return new Int32Array(4*K);case"uvec2":return new Uint32Array(2*K);case"uvec3":return new Uint32Array(3*K);case"uvec4":return new Uint32Array(4*K);case"bool":return!1;case"bvec2":return nK(2*K);case"bvec3":return nK(3*K);case"bvec4":return nK(4*K);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function iK(t,K){const D=t.getShaderSource(K).split(`\n`).map(((t,K)=>`${K}: ${t}`)),a=t.getShaderInfoLog(K),G=a.split(`\n`),N={},W=G.map((t=>parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1")))).filter((t=>!(!t||N[t]||(N[t]=!0,0)))),x=[""];W.forEach((t=>{D[t-1]=`%c${D[t-1]}%c`,x.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));const b=D.join(`\n`);x[0]=b,console.error(a),console.groupCollapsed("click to view full shader code"),console.warn(...x),console.groupEnd()}function zK(t,K,D,a,G){D.buffer.update(G)}const IK={float:`\n        data[offset] = v;\n    `,vec2:`\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    `,vec3:`\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    `,vec4:`\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    `,mat2:`\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    `,mat3:`\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    `,mat4:`\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    `},ZK={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};let wK,mK=0;const uK={textureCount:0,uboCount:0};class dK{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=mK++}systemCheck(){if(!function(){if("boolean"==typeof wK)return wK;try{wK=!0===new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")}catch(t){wK=!1}return wK}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,K){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const D=t.program,a=D.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==D&&(this.program=D,this.gl.useProgram(a.program)),K||(uK.textureCount=0,uK.uboCount=0,this.syncUniformGroup(t.uniformGroup,uK)),a}setUniforms(t){const K=this.shader.program,D=K.glPrograms[this.renderer.CONTEXT_UID];K.syncUniforms(D.uniformData,t,this.renderer)}syncUniformGroup(t,K){const D=this.getGlProgram();(!t.static||t.dirtyId!==D.uniformDirtyGroups[t.id])&&(D.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,D,K))}syncUniforms(t,K,D){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(K.uniformData,t.uniforms,this.renderer,D)}createSyncGroups(t){const K=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[K]||(this.cache[K]=function(t,K){var D;const a=[`\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    `];for(const G in t.uniforms){const N=K[G];if(!N){!0===(null===(D=t.uniforms[G])||void 0===D?void 0:D.group)&&(t.uniforms[G].ubo?a.push(`\n                        renderer.shader.syncUniformBufferGroup(uv.${G}, '${G}');\n                    `):a.push(`\n                        renderer.shader.syncUniformGroup(uv.${G}, syncData);\n                    `));continue}const W=t.uniforms[G];let x=!1;for(let t=0;t<R.length;t++)if(R[t].test(N,W)){a.push(R[t].code(G,W)),x=!0;break}if(!x){const t=(1!==N.size||N.isArray?Y:A)[N.type].replace("location",`ud["${G}"].location`);a.push(`\n            cu = ud["${G}"];\n            cv = cu.value;\n            v = uv["${G}"];\n            ${t};`)}}return new Function("ud","uv","renderer","syncData",a.join(`\n`))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[K],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,K){const D=this.getGlProgram();if(!t.static||0!==t.dirtyId||!D.uniformGroups[t.id]){t.dirtyId=0;const a=D.uniformGroups[t.id]||this.createSyncBufferGroup(t,D,K);t.buffer.update(),a(D.uniformData,t.uniforms,this.renderer,uK,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,D.uniformBufferBindings[K])}createSyncBufferGroup(t,K,D){const{gl:a}=this.renderer;this.renderer.buffer.bind(t.buffer);const G=this.gl.getUniformBlockIndex(K.program,D);K.uniformBufferBindings[D]=this.shader.uniformBindCount,a.uniformBlockBinding(K.program,G,this.shader.uniformBindCount),this.shader.uniformBindCount++;const N=this.getSignature(t,this.shader.program.uniformData,"ubo");let W=this._uboCache[N];if(W||(W=this._uboCache[N]=function(t,K){if(!t.autoManage)return{size:0,syncFunc:zK};const D=function(t,K){const D=[];for(const a in t)K[a]&&D.push(K[a]);return D.sort(((t,K)=>t.index-K.index)),D}(t.uniforms,K),{uboElements:a,size:G}=function(t){const K=t.map((t=>({data:t,offset:0,dataLen:0,dirty:0})));let D=0,a=0,G=0;for(let t=0;t<K.length;t++){const N=K[t];if(D=ZK[N.data.type],N.data.size>1&&(D=Math.max(D,16)*N.data.size),N.dataLen=D,a%D!=0&&a<16){const t=a%D%16;a+=t,G+=t}a+D>16?(G=16*Math.ceil(G/16),N.offset=G,G+=D,a=D):(N.offset=G,a+=D,G+=D)}return G=16*Math.ceil(G/16),{uboElements:K,size:G}}(D),N=[`\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    `];for(let K=0;K<a.length;K++){const D=a[K],G=t.uniforms[D.data.name],W=D.data.name;let x=!1;for(let t=0;t<R.length;t++){const K=R[t];if(K.codeUbo&&K.test(D.data,G)){N.push(`offset = ${D.offset/4};`,R[t].codeUbo(D.data.name,G)),x=!0;break}}if(!x)if(D.data.size>1){const t=B(D.data.type),K=Math.max(ZK[D.data.type]/16,1),a=t/K,G=(4-a%4)%4;N.push(`\n                cv = ud.${W}.value;\n                v = uv.${W};\n                offset = ${D.offset/4};\n\n                t = 0;\n\n                for(var i=0; i < ${D.data.size*K}; i++)\n                {\n                    for(var j = 0; j < ${a}; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += ${G};\n                }\n\n                `)}else{const t=IK[D.data.type];N.push(`\n                cv = ud.${W}.value;\n                v = uv.${W};\n                offset = ${D.offset/4};\n                ${t};\n                `)}}return N.push(`\n       renderer.buffer.update(buffer);\n    `),{size:G,syncFunc:new Function("ud","uv","renderer","syncData","buffer",N.join(`\n`))}}(t,this.shader.program.uniformData)),t.autoManage){const K=new Float32Array(W.size/4);t.buffer.update(K)}return K.uniformGroups[t.id]=W.syncFunc,K.uniformGroups[t.id]}getSignature(t,K,D){const a=t.uniforms,G=[`${D}-`];for(const t in a)G.push(t),K[t]&&G.push(K[t].type);return G.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const K=this.gl,D=t.program,a=function(t,K){var D;const a=bK(t,t.VERTEX_SHADER,K.vertexSrc),G=bK(t,t.FRAGMENT_SHADER,K.fragmentSrc),N=t.createProgram();t.attachShader(N,a),t.attachShader(N,G);const W=null===(D=K.extra)||void 0===D?void 0:D.transformFeedbackVaryings;if(W&&("function"!=typeof t.transformFeedbackVaryings?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(N,W.names,"separate"===W.bufferMode?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(N),t.getProgramParameter(N,t.LINK_STATUS)||function(t,K,D,a){t.getProgramParameter(K,t.LINK_STATUS)||(t.getShaderParameter(D,t.COMPILE_STATUS)||iK(t,D),t.getShaderParameter(a,t.COMPILE_STATUS)||iK(t,a),console.error("PixiJS Error: Could not initialize shader."),""!==t.getProgramInfoLog(K)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(K)))}(t,N,a,G),K.attributeData=function(t,K){const D={},a=K.getProgramParameter(t,K.ACTIVE_ATTRIBUTES);for(let G=0;G<a;G++){const a=K.getActiveAttrib(t,G);if(a.name.startsWith("gl_"))continue;const N=p(K,a.type),W={type:N,name:a.name,size:B(N),location:K.getAttribLocation(t,a.name)};D[a.name]=W}return D}(N,t),K.uniformData=function(t,K){const D={},a=K.getProgramParameter(t,K.ACTIVE_UNIFORMS);for(let G=0;G<a;G++){const a=K.getActiveUniform(t,G),N=a.name.replace(/\[.*?\]$/,""),W=!!a.name.match(/\[.*?\]$/),x=p(K,a.type);D[N]={name:N,index:G,type:x,size:a.size,isArray:W,value:eK(x,a.size)}}return D}(N,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(K.vertexSrc)){const D=Object.keys(K.attributeData);D.sort(((t,K)=>t>K?1:-1));for(let a=0;a<D.length;a++)K.attributeData[D[a]].location=a,t.bindAttribLocation(N,a,D[a]);t.linkProgram(N)}t.deleteShader(a),t.deleteShader(G);const x={};for(const D in K.uniformData){const a=K.uniformData[D];x[D]={location:t.getUniformLocation(N,D),value:eK(a.type,a.size)}}return new xK(N,x)}(K,D);return D.glPrograms[this.renderer.CONTEXT_UID]=a,a}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}dK.extension={type:x.A.RendererSystem,name:"shader"},x.X.add(dK);class EK{constructor(t){this.renderer=t}run(t){const{renderer:K}=this;K.runners.init.emit(K.options),t.hello&&console.log(`PixiJS 7.3.2 - ${K.rendererLogId} - https://pixijs.com`),K.resize(K.screen.width,K.screen.height)}destroy(){}}EK.defaultOptions={hello:!1},EK.extension={type:[x.A.RendererSystem,x.A.CanvasRendererSystem],name:"startup"},x.X.add(EK);const lK=0,QK=1,PK=2,yK=3,qK=4,XK=5,hK=class t{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=a.B9.NONE,this._blendEq=!1,this.map=[],this.map[lK]=this.setBlend,this.map[QK]=this.setOffset,this.map[PK]=this.setCullFace,this.map[yK]=this.setDepthTest,this.map[qK]=this.setFrontFace,this.map[XK]=this.setDepthMask,this.checks=[],this.defaultState=new u,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=function(t,K=[]){return K[a.B9.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.ADD]=[t.ONE,t.ONE],K[a.B9.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.NONE]=[0,0],K[a.B9.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],K[a.B9.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],K[a.B9.SRC_IN]=[t.DST_ALPHA,t.ZERO],K[a.B9.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],K[a.B9.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],K[a.B9.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],K[a.B9.DST_IN]=[t.ZERO,t.SRC_ALPHA],K[a.B9.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],K[a.B9.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],K[a.B9.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],K[a.B9.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],K}(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let K=this.stateId^t.data,D=0;for(;K;)1&K&&this.map[D].call(this,!!(t.data&1<<D)),K>>=1,D++;this.stateId=t.data}for(let K=0;K<this.checks.length;K++)this.checks[K](this,t)}forceState(t){t=t||this.defaultState;for(let K=0;K<this.map.length;K++)this.map[K].call(this,!!(t.data&1<<K));for(let K=0;K<this.checks.length;K++)this.checks[K](this,t);this.stateId=t.data}setBlend(K){this.updateCheck(t.checkBlendMode,K),this.gl[K?"enable":"disable"](this.gl.BLEND)}setOffset(K){this.updateCheck(t.checkPolygonOffset,K),this.gl[K?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const K=this.blendModes[t],D=this.gl;2===K.length?D.blendFunc(K[0],K[1]):D.blendFuncSeparate(K[0],K[1],K[2],K[3]),6===K.length?(this._blendEq=!0,D.blendEquationSeparate(K[4],K[5])):this._blendEq&&(this._blendEq=!1,D.blendEquationSeparate(D.FUNC_ADD,D.FUNC_ADD))}setPolygonOffset(t,K){this.gl.polygonOffset(t,K)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,K){const D=this.checks.indexOf(t);K&&-1===D?this.checks.push(t):!K&&-1!==D&&this.checks.splice(D,1)}static checkBlendMode(t,K){t.setBlendMode(K.blendMode)}static checkPolygonOffset(t,K){t.setPolygonOffset(1,K.polygonOffset)}destroy(){this.gl=null}};hK.extension={type:x.A.RendererSystem,name:"state"};let JK=hK;x.X.add(JK);class TK extends N.EventEmitter{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){var K;this.addRunners(...t.runners);const D=(null!==(K=t.priority)&&void 0!==K?K:[]).filter((K=>t.systems[K])),a=[...D,...Object.keys(t.systems).filter((t=>!D.includes(t)))];for(const K of a)this.addSystem(t.systems[K],K)}addRunners(...t){t.forEach((t=>{this.runners[t]=new l(t)}))}addSystem(t,K){const D=new t(this);if(this[K])throw new Error(`Whoops! The name "${K}" is already in use`);this[K]=D,this._systemsHash[K]=D;for(const t in this.runners)this.runners[t].add(D);return this}emitWithCustomOptions(t,K){const D=Object.keys(this._systemsHash);t.items.forEach((a=>{const G=D.find((t=>this._systemsHash[t]===a));a[t.name](K[G])}))}destroy(){Object.values(this.runners).forEach((t=>{t.destroy()})),this._systemsHash={}}}const _K=class t{constructor(K){this.renderer=K,this.count=0,this.checkCount=0,this.maxIdle=t.defaultMaxIdle,this.checkCountMax=t.defaultCheckCountMax,this.mode=t.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==a.OS.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,K=t.managedTextures;let D=!1;for(let a=0;a<K.length;a++){const G=K[a];G.resource&&this.count-G.touched>this.maxIdle&&(t.destroyTexture(G,!0),K[a]=null,D=!0)}if(D){let t=0;for(let D=0;D<K.length;D++)null!==K[D]&&(K[t++]=K[D]);K.length=t}}unload(t){const K=this.renderer.texture,D=t._texture;D&&!D.framebuffer&&K.destroyTexture(D);for(let K=t.children.length-1;K>=0;K--)this.unload(t.children[K])}destroy(){this.renderer=null}};_K.defaultMode=a.OS.AUTO,_K.defaultMaxIdle=60*60,_K.defaultCheckCountMax=60*10,_K.extension={type:x.A.RendererSystem,name:"textureGC"};let CK=_K;x.X.add(CK);class HK{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=a.QE.UNSIGNED_BYTE,this.internalFormat=a.hR.RGBA,this.samplerType=0}}class oK{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new X,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(t){let K;return K="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?{[a.QE.UNSIGNED_BYTE]:{[a.hR.RGBA]:t.RGBA8,[a.hR.RGB]:t.RGB8,[a.hR.RG]:t.RG8,[a.hR.RED]:t.R8,[a.hR.RGBA_INTEGER]:t.RGBA8UI,[a.hR.RGB_INTEGER]:t.RGB8UI,[a.hR.RG_INTEGER]:t.RG8UI,[a.hR.RED_INTEGER]:t.R8UI,[a.hR.ALPHA]:t.ALPHA,[a.hR.LUMINANCE]:t.LUMINANCE,[a.hR.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[a.QE.BYTE]:{[a.hR.RGBA]:t.RGBA8_SNORM,[a.hR.RGB]:t.RGB8_SNORM,[a.hR.RG]:t.RG8_SNORM,[a.hR.RED]:t.R8_SNORM,[a.hR.RGBA_INTEGER]:t.RGBA8I,[a.hR.RGB_INTEGER]:t.RGB8I,[a.hR.RG_INTEGER]:t.RG8I,[a.hR.RED_INTEGER]:t.R8I},[a.QE.UNSIGNED_SHORT]:{[a.hR.RGBA_INTEGER]:t.RGBA16UI,[a.hR.RGB_INTEGER]:t.RGB16UI,[a.hR.RG_INTEGER]:t.RG16UI,[a.hR.RED_INTEGER]:t.R16UI,[a.hR.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[a.QE.SHORT]:{[a.hR.RGBA_INTEGER]:t.RGBA16I,[a.hR.RGB_INTEGER]:t.RGB16I,[a.hR.RG_INTEGER]:t.RG16I,[a.hR.RED_INTEGER]:t.R16I},[a.QE.UNSIGNED_INT]:{[a.hR.RGBA_INTEGER]:t.RGBA32UI,[a.hR.RGB_INTEGER]:t.RGB32UI,[a.hR.RG_INTEGER]:t.RG32UI,[a.hR.RED_INTEGER]:t.R32UI,[a.hR.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[a.QE.INT]:{[a.hR.RGBA_INTEGER]:t.RGBA32I,[a.hR.RGB_INTEGER]:t.RGB32I,[a.hR.RG_INTEGER]:t.RG32I,[a.hR.RED_INTEGER]:t.R32I},[a.QE.FLOAT]:{[a.hR.RGBA]:t.RGBA32F,[a.hR.RGB]:t.RGB32F,[a.hR.RG]:t.RG32F,[a.hR.RED]:t.R32F,[a.hR.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[a.QE.HALF_FLOAT]:{[a.hR.RGBA]:t.RGBA16F,[a.hR.RGB]:t.RGB16F,[a.hR.RG]:t.RG16F,[a.hR.RED]:t.R16F},[a.QE.UNSIGNED_SHORT_5_6_5]:{[a.hR.RGB]:t.RGB565},[a.QE.UNSIGNED_SHORT_4_4_4_4]:{[a.hR.RGBA]:t.RGBA4},[a.QE.UNSIGNED_SHORT_5_5_5_1]:{[a.hR.RGBA]:t.RGB5_A1},[a.QE.UNSIGNED_INT_2_10_10_10_REV]:{[a.hR.RGBA]:t.RGB10_A2,[a.hR.RGBA_INTEGER]:t.RGB10_A2UI},[a.QE.UNSIGNED_INT_10F_11F_11F_REV]:{[a.hR.RGB]:t.R11F_G11F_B10F},[a.QE.UNSIGNED_INT_5_9_9_9_REV]:{[a.hR.RGB]:t.RGB9_E5},[a.QE.UNSIGNED_INT_24_8]:{[a.hR.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[a.QE.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[a.hR.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:{[a.QE.UNSIGNED_BYTE]:{[a.hR.RGBA]:t.RGBA,[a.hR.RGB]:t.RGB,[a.hR.ALPHA]:t.ALPHA,[a.hR.LUMINANCE]:t.LUMINANCE,[a.hR.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[a.QE.UNSIGNED_SHORT_5_6_5]:{[a.hR.RGB]:t.RGB},[a.QE.UNSIGNED_SHORT_4_4_4_4]:{[a.hR.RGBA]:t.RGBA},[a.QE.UNSIGNED_SHORT_5_5_5_1]:{[a.hR.RGBA]:t.RGBA}},K}(t),this.samplerTypes=function(t){let K;return K="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?{[t.RGB]:a.XZ.FLOAT,[t.RGBA]:a.XZ.FLOAT,[t.ALPHA]:a.XZ.FLOAT,[t.LUMINANCE]:a.XZ.FLOAT,[t.LUMINANCE_ALPHA]:a.XZ.FLOAT,[t.R8]:a.XZ.FLOAT,[t.R8_SNORM]:a.XZ.FLOAT,[t.RG8]:a.XZ.FLOAT,[t.RG8_SNORM]:a.XZ.FLOAT,[t.RGB8]:a.XZ.FLOAT,[t.RGB8_SNORM]:a.XZ.FLOAT,[t.RGB565]:a.XZ.FLOAT,[t.RGBA4]:a.XZ.FLOAT,[t.RGB5_A1]:a.XZ.FLOAT,[t.RGBA8]:a.XZ.FLOAT,[t.RGBA8_SNORM]:a.XZ.FLOAT,[t.RGB10_A2]:a.XZ.FLOAT,[t.RGB10_A2UI]:a.XZ.FLOAT,[t.SRGB8]:a.XZ.FLOAT,[t.SRGB8_ALPHA8]:a.XZ.FLOAT,[t.R16F]:a.XZ.FLOAT,[t.RG16F]:a.XZ.FLOAT,[t.RGB16F]:a.XZ.FLOAT,[t.RGBA16F]:a.XZ.FLOAT,[t.R32F]:a.XZ.FLOAT,[t.RG32F]:a.XZ.FLOAT,[t.RGB32F]:a.XZ.FLOAT,[t.RGBA32F]:a.XZ.FLOAT,[t.R11F_G11F_B10F]:a.XZ.FLOAT,[t.RGB9_E5]:a.XZ.FLOAT,[t.R8I]:a.XZ.INT,[t.R8UI]:a.XZ.UINT,[t.R16I]:a.XZ.INT,[t.R16UI]:a.XZ.UINT,[t.R32I]:a.XZ.INT,[t.R32UI]:a.XZ.UINT,[t.RG8I]:a.XZ.INT,[t.RG8UI]:a.XZ.UINT,[t.RG16I]:a.XZ.INT,[t.RG16UI]:a.XZ.UINT,[t.RG32I]:a.XZ.INT,[t.RG32UI]:a.XZ.UINT,[t.RGB8I]:a.XZ.INT,[t.RGB8UI]:a.XZ.UINT,[t.RGB16I]:a.XZ.INT,[t.RGB16UI]:a.XZ.UINT,[t.RGB32I]:a.XZ.INT,[t.RGB32UI]:a.XZ.UINT,[t.RGBA8I]:a.XZ.INT,[t.RGBA8UI]:a.XZ.UINT,[t.RGBA16I]:a.XZ.INT,[t.RGBA16UI]:a.XZ.UINT,[t.RGBA32I]:a.XZ.INT,[t.RGBA32UI]:a.XZ.UINT,[t.DEPTH_COMPONENT16]:a.XZ.FLOAT,[t.DEPTH_COMPONENT24]:a.XZ.FLOAT,[t.DEPTH_COMPONENT32F]:a.XZ.FLOAT,[t.DEPTH_STENCIL]:a.XZ.FLOAT,[t.DEPTH24_STENCIL8]:a.XZ.FLOAT,[t.DEPTH32F_STENCIL8]:a.XZ.FLOAT}:{[t.RGB]:a.XZ.FLOAT,[t.RGBA]:a.XZ.FLOAT,[t.ALPHA]:a.XZ.FLOAT,[t.LUMINANCE]:a.XZ.FLOAT,[t.LUMINANCE_ALPHA]:a.XZ.FLOAT,[t.DEPTH_STENCIL]:a.XZ.FLOAT},K}(t);const K=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=K;for(let t=0;t<K;t++)this.boundTextures[t]=null;this.emptyTextures={};const D=new HK(t.createTexture());t.bindTexture(t.TEXTURE_2D,D.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=D,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new HK(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let K=0;K<6;K++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+K,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let t=0;t<this.boundTextures.length;t++)this.bind(null,t)}bind(t,K=0){const{gl:D}=this;if((null==(t=null==t?void 0:t.castToBaseTexture())?void 0:t.valid)&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const a=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[K]!==t&&(this.currentLocation!==K&&(this.currentLocation=K,D.activeTexture(D.TEXTURE0+K)),D.bindTexture(t.target,a.texture)),a.dirtyId!==t.dirtyId?(this.currentLocation!==K&&(this.currentLocation=K,D.activeTexture(D.TEXTURE0+K)),this.updateTexture(t)):a.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[K]=t}else this.currentLocation!==K&&(this.currentLocation=K,D.activeTexture(D.TEXTURE0+K)),D.bindTexture(D.TEXTURE_2D,this.emptyTextures[D.TEXTURE_2D].texture),this.boundTextures[K]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:K,boundTextures:D}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let t=0;t<D.length;t++)D[t]===this.unknownTexture&&this.bind(null,t)}for(let a=0;a<D.length;a++)D[a]===t&&(this.currentLocation!==a&&(K.activeTexture(K.TEXTURE0+a),this.currentLocation=a),K.bindTexture(t.target,this.emptyTextures[t.target].texture),D[a]=null)}ensureSamplerType(t){const{boundTextures:K,hasIntegerTextures:D,CONTEXT_UID:G}=this;if(D)for(let D=t-1;D>=0;--D){const t=K[D];t&&t._glTextures[G].samplerType!==a.XZ.FLOAT&&this.renderer.texture.unbind(t)}}initTexture(t){const K=new HK(this.gl.createTexture());return K.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=K,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),K}initTextureType(t,K){var D,G,N;K.internalFormat=null!==(G=null===(D=this.internalFormats[t.type])||void 0===D?void 0:D[t.format])&&void 0!==G?G:t.format,K.samplerType=null!==(N=this.samplerTypes[K.internalFormat])&&void 0!==N?N:a.XZ.FLOAT,2===this.webGLVersion&&t.type===a.QE.HALF_FLOAT?K.type=this.gl.HALF_FLOAT:K.type=t.type}updateTexture(t){var K;const D=t._glTextures[this.CONTEXT_UID];if(!D)return;const G=this.renderer;if(this.initTextureType(t,D),null===(K=t.resource)||void 0===K?void 0:K.upload(G,t,D))D.samplerType!==a.XZ.FLOAT&&(this.hasIntegerTextures=!0);else{const K=t.realWidth,a=t.realHeight,N=G.gl;(D.width!==K||D.height!==a||D.dirtyId<0)&&(D.width=K,D.height=a,N.texImage2D(t.target,0,D.internalFormat,K,a,0,t.format,D.type,null))}t.dirtyStyleId!==D.dirtyStyleId&&this.updateTextureStyle(t),D.dirtyId=t.dirtyId}destroyTexture(t,K){const{gl:D}=this;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),D.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!K)){const K=this.managedTextures.indexOf(t);-1!==K&&N.removeItems(this.managedTextures,K,1)}}updateTextureStyle(t){var K;const D=t._glTextures[this.CONTEXT_UID];D&&(t.mipmap!==a.E8.POW2&&2===this.webGLVersion||t.isPowerOfTwo?D.mipmap=t.mipmap>=1:D.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?D.wrapMode=t.wrapMode:D.wrapMode=a.uR.CLAMP,(null===(K=t.resource)||void 0===K?void 0:K.style(this.renderer,t,D))||this.setStyle(t,D),D.dirtyStyleId=t.dirtyStyleId)}setStyle(t,K){const D=this.gl;if(K.mipmap&&t.mipmap!==a.E8.ON_MANUAL&&D.generateMipmap(t.target),D.texParameteri(t.target,D.TEXTURE_WRAP_S,K.wrapMode),D.texParameteri(t.target,D.TEXTURE_WRAP_T,K.wrapMode),K.mipmap){D.texParameteri(t.target,D.TEXTURE_MIN_FILTER,t.scaleMode===a.M6.LINEAR?D.LINEAR_MIPMAP_LINEAR:D.NEAREST_MIPMAP_NEAREST);const K=this.renderer.context.extensions.anisotropicFiltering;if(K&&t.anisotropicLevel>0&&t.scaleMode===a.M6.LINEAR){const a=Math.min(t.anisotropicLevel,D.getParameter(K.MAX_TEXTURE_MAX_ANISOTROPY_EXT));D.texParameterf(t.target,K.TEXTURE_MAX_ANISOTROPY_EXT,a)}}else D.texParameteri(t.target,D.TEXTURE_MIN_FILTER,t.scaleMode===a.M6.LINEAR?D.LINEAR:D.NEAREST);D.texParameteri(t.target,D.TEXTURE_MAG_FILTER,t.scaleMode===a.M6.LINEAR?D.LINEAR:D.NEAREST)}destroy(){this.renderer=null}}oK.extension={type:x.A.RendererSystem,name:"texture"},x.X.add(oK);class UK{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:K,CONTEXT_UID:D}=this,a=t._glTransformFeedbacks[D]||this.createGLTransformFeedback(t);K.bindTransformFeedback(K.TRANSFORM_FEEDBACK,a)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,K){const{gl:D,renderer:a}=this;K&&a.shader.bind(K),D.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:K,renderer:D,CONTEXT_UID:a}=this,G=K.createTransformFeedback();t._glTransformFeedbacks[a]=G,K.bindTransformFeedback(K.TRANSFORM_FEEDBACK,G);for(let G=0;G<t.buffers.length;G++){const N=t.buffers[G];N&&(D.buffer.update(N),N._glBuffers[a].refCount++,K.bindBufferBase(K.TRANSFORM_FEEDBACK_BUFFER,G,N._glBuffers[a].buffer||null))}return K.bindTransformFeedback(K.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),G}disposeTransformFeedback(t,K){const D=t._glTransformFeedbacks[this.CONTEXT_UID],a=this.gl;t.disposeRunner.remove(this);const G=this.renderer.buffer;if(G)for(let D=0;D<t.buffers.length;D++){const a=t.buffers[D];if(!a)continue;const N=a._glBuffers[this.CONTEXT_UID];N&&(N.refCount--,0===N.refCount&&!K&&G.dispose(a,K))}D&&(K||a.deleteTransformFeedback(D),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}UK.extension={type:x.A.RendererSystem,name:"transformFeedback"},x.X.add(UK);class VK{constructor(t){this.renderer=t}init(t){this.screen=new F.M_(0,0,t.width,t.height),this.element=t.view||G.W0.ADAPTER.createCanvas(),this.resolution=t.resolution||G.W0.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,K){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(K*this.resolution);const D=this.element.width/this.resolution,a=this.element.height/this.resolution;this.screen.width=D,this.screen.height=a,this.autoDensity&&(this.element.style.width=`${D}px`,this.element.style.height=`${a}px`),this.renderer.emit("resize",D,a),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var K;t&&(null===(K=this.element.parentNode)||void 0===K||K.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}VK.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},VK.extension={type:[x.A.RendererSystem,x.A.CanvasRendererSystem],name:"_view"},x.X.add(VK),G.W0.PREFER_ENV=a.Km.WEBGL2,G.W0.STRICT_TEXTURE_CACHE=!1,G.W0.RENDER_OPTIONS={...dt.defaultOptions,...wt.defaultOptions,...VK.defaultOptions,...EK.defaultOptions},Object.defineProperties(G.W0,{WRAP_MODE:{get:()=>X.defaultOptions.wrapMode,set(t){N.deprecation("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),X.defaultOptions.wrapMode=t}},SCALE_MODE:{get:()=>X.defaultOptions.scaleMode,set(t){N.deprecation("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),X.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get:()=>X.defaultOptions.mipmap,set(t){N.deprecation("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),X.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get:()=>X.defaultOptions.anisotropicLevel,set(t){N.deprecation("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),X.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get:()=>(N.deprecation("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Zt.defaultResolution),set(t){Zt.defaultResolution=t}},FILTER_MULTISAMPLE:{get:()=>(N.deprecation("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Zt.defaultMultisample),set(t){Zt.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get:()=>et.defaultMaxTextures,set(t){N.deprecation("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),et.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get:()=>et.defaultBatchSize,set(t){N.deprecation("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),et.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get:()=>et.canUploadSameBuffer,set(t){N.deprecation("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),et.canUploadSameBuffer=t}},GC_MODE:{get:()=>CK.defaultMode,set(t){N.deprecation("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),CK.defaultMode=t}},GC_MAX_IDLE:{get:()=>CK.defaultMaxIdle,set(t){N.deprecation("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),CK.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get:()=>CK.defaultCheckCountMax,set(t){N.deprecation("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),CK.defaultCheckCountMax=t}},PRECISION_VERTEX:{get:()=>tt.defaultVertexPrecision,set(t){N.deprecation("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),tt.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get:()=>tt.defaultFragmentPrecision,set(t){N.deprecation("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),tt.defaultFragmentPrecision=t}}});var sK=D(71931);const FK=[];function cK(t){for(const K of FK)if(K.test(t))return new K(t);throw new Error("Unable to auto-detect a suitable renderer.")}x.X.handleByList(x.A.Renderer,FK);var gK=D(391966);class RK{constructor(t){this.renderer=t}contextChange(t){let K;if(1===this.renderer.context.webGLVersion){const D=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),K=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,D)}else{const D=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),K=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,D)}K>=a.he.HIGH?this.multisample=a.he.HIGH:K>=a.he.MEDIUM?this.multisample=a.he.MEDIUM:K>=a.he.LOW?this.multisample=a.he.LOW:this.multisample=a.he.NONE}destroy(){}}RK.extension={type:x.A.RendererSystem,name:"_multisample"},x.X.add(RK);class AK{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class YK{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:K,CONTEXT_UID:D}=this,a=t._glBuffers[D]||this.createGLBuffer(t);K.bindBuffer(t.type,a.buffer)}unbind(t){const{gl:K}=this;K.bindBuffer(t,null)}bindBufferBase(t,K){const{gl:D,CONTEXT_UID:a}=this;if(this.boundBufferBases[K]!==t){const G=t._glBuffers[a]||this.createGLBuffer(t);this.boundBufferBases[K]=t,D.bindBufferBase(D.UNIFORM_BUFFER,K,G.buffer)}}bindBufferRange(t,K,D){const{gl:a,CONTEXT_UID:G}=this;D=D||0;const N=t._glBuffers[G]||this.createGLBuffer(t);a.bindBufferRange(a.UNIFORM_BUFFER,K||0,N.buffer,256*D,256)}update(t){const{gl:K,CONTEXT_UID:D}=this,a=t._glBuffers[D]||this.createGLBuffer(t);if(t._updateID!==a.updateID)if(a.updateID=t._updateID,K.bindBuffer(t.type,a.buffer),a.byteLength>=t.data.byteLength)K.bufferSubData(t.type,0,t.data);else{const D=t.static?K.STATIC_DRAW:K.DYNAMIC_DRAW;a.byteLength=t.data.byteLength,K.bufferData(t.type,t.data,D)}}dispose(t,K){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const D=t._glBuffers[this.CONTEXT_UID],a=this.gl;t.disposeRunner.remove(this),D&&(K||a.deleteBuffer(D.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const K=Object.keys(this.managedBuffers);for(let D=0;D<K.length;D++)this.dispose(this.managedBuffers[K[D]],t)}createGLBuffer(t){const{CONTEXT_UID:K,gl:D}=this;return t._glBuffers[K]=new AK(D.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[K]}}YK.extension={type:x.A.RendererSystem,name:"buffer"},x.X.add(YK);class LK{constructor(t){this.renderer=t}render(t,K){const D=this.renderer;let a,G,N,W;if(K&&(a=K.renderTexture,G=K.clear,N=K.transform,W=K.skipUpdateTransform),this.renderingToScreen=!a,D.runners.prerender.emit(),D.emit("prerender"),D.projection.transform=N,!D.context.isLost){if(a||(this.lastObjectRendered=t),!W){const K=t.enableTempParent();t.updateTransform(),t.disableTempParent(K)}D.renderTexture.bind(a),D.batch.currentRenderer.start(),(null!=G?G:D.background.clearBeforeRender)&&D.renderTexture.clear(),t.render(D),D.batch.currentRenderer.flush(),a&&(K.blit&&D.framebuffer.blit(),a.baseTexture.update()),D.runners.postrender.emit(),D.projection.transform=null,D.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}LK.extension={type:x.A.RendererSystem,name:"objectRenderer"},x.X.add(LK);const SK=class t extends TK{constructor(K){super(),this.type=a.h3.WEBGL,K=Object.assign({},G.W0.RENDER_OPTIONS,K),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Dt({projectionMatrix:new F.uq},!0);const D={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:t.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(D),"useContextAlpha"in K&&(N.deprecation("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),K.premultipliedAlpha=K.useContextAlpha&&"notMultiplied"!==K.useContextAlpha,K.backgroundAlpha=!1===K.useContextAlpha?1:K.backgroundAlpha),this._plugin.rendererPlugins=t.__plugins,this.options=K,this.startup.run(this.options)}static test(t){return!(null==t?void 0:t.forceCanvas)&&N.isWebGLSupported()}render(t,K){this.objectRenderer.render(t,K)}resize(t,K){this._view.resizeView(t,K)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return N.deprecation("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return N.deprecation("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return N.deprecation("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return N.deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){N.deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return N.deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){N.deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return N.deprecation("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,K){return this.textureGenerator.generateTexture(t,K)}};SK.extension={type:x.A.Renderer,priority:1},SK.__plugins={},SK.__systems={};let fK=SK;x.X.handleByMap(x.A.RendererPlugin,fK.__plugins),x.X.handleByMap(x.A.RendererSystem,fK.__systems),x.X.add(fK);class $K extends Q{constructor(t,K){const{width:D,height:a}=K||{};super(D,a),this.items=[],this.itemDirtyIds=[];for(let K=0;K<t;K++){const t=new X;this.items.push(t),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,K){for(let D=0;D<this.length;D++)t[D]&&(t[D].castToBaseTexture?this.addBaseTextureAt(t[D].castToBaseTexture(),D):t[D]instanceof Q?this.addResourceAt(t[D],D):this.addResourceAt(E(t[D],K),D))}dispose(){for(let t=0,K=this.length;t<K;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,K){if(!this.items[K])throw new Error(`Index ${K} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[K].setResource(t),this}bind(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let K=0;K<this.length;K++)this.items[K].parentTextureArray=t,this.items[K].on("update",t.update,t)}unbind(t){super.unbind(t);for(let K=0;K<this.length;K++)this.items[K].parentTextureArray=null,this.items[K].off("update",t.update,t)}load(){if(this._load)return this._load;const t=this.items.map((t=>t.resource)).filter((t=>t)).map((t=>t.load()));return this._load=Promise.all(t).then((()=>{const{realWidth:t,realHeight:K}=this.items[0];return this.resize(t,K),this.update(),Promise.resolve(this)})),this._load}}const BK=class t extends $K{constructor(K,D){const{width:G,height:N,autoLoad:W,linkBaseTexture:x}=D||{};if(K&&K.length!==t.SIDES)throw new Error(`Invalid length. Got ${K.length}, expected 6`);super(6,{width:G,height:N});for(let K=0;K<t.SIDES;K++)this.items[K].target=a.dW.TEXTURE_CUBE_MAP_POSITIVE_X+K;this.linkBaseTexture=!1!==x,K&&this.initFromArray(K,D),!1!==W&&this.load()}bind(t){super.bind(t),t.target=a.dW.TEXTURE_CUBE_MAP}addBaseTextureAt(t,K,D){if(void 0===D&&(D=this.linkBaseTexture),!this.items[K])throw new Error(`Index ${K} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,K)}else t.target=a.dW.TEXTURE_CUBE_MAP_POSITIVE_X+K,t.parentTextureArray=this.baseTexture,this.items[K]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[K]=t,this}upload(K,D,a){const G=this.itemDirtyIds;for(let N=0;N<t.SIDES;N++){const t=this.items[N];(G[N]<t.dirtyId||a.dirtyId<D.dirtyId)&&(t.valid&&t.resource?(t.resource.upload(K,t,a),G[N]=t.dirtyId):G[N]<-1&&(K.gl.texImage2D(t.target,0,a.internalFormat,D.realWidth,D.realHeight,0,D.format,a.type,null),G[N]=-1))}return!0}static test(K){return Array.isArray(K)&&K.length===t.SIDES}};BK.SIDES=6;let OK=BK;class vK extends Qt{constructor(t,K){var D,a;let G,N,W;K=K||{},"string"==typeof t?(G=vK.EMPTY,N=t,W=!0):(G=t,N=null,W=!1),super(G),this.url=N,this.crossOrigin=null===(D=K.crossOrigin)||void 0===D||D,this.alphaMode="number"==typeof K.alphaMode?K.alphaMode:null,this.ownsImageBitmap=null!==(a=K.ownsImageBitmap)&&void 0!==a?a:W,this._load=null,!1!==K.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise((async(t,K)=>{if(null!==this.url)try{const K=await G.W0.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const D=await K.blob();if(this.destroyed)return;const N=await createImageBitmap(D,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===a.Gk.UNPACK?"premultiply":"none"});if(this.destroyed)return void N.close();this.source=N,this.update(),t(this)}catch(t){if(this.destroyed)return;K(t),this.onError.emit(t)}else t(this)}))),this._load}upload(t,K,D){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(K.alphaMode=this.alphaMode),super.upload(t,K,D)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&("string"==typeof t||t instanceof ImageBitmap)}static get EMPTY(){var t;return vK._EMPTY=null!==(t=vK._EMPTY)&&void 0!==t?t:G.W0.ADAPTER.createCanvas(0,0),vK._EMPTY}}const pK=class t extends Qt{constructor(t,K){K=K||{},super(G.W0.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=K.scale||1,this._overrideWidth=K.width,this._overrideHeight=K.height,this._resolve=null,this._crossorigin=K.crossorigin,this._load=null,!1!==K.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise((K=>{if(this._resolve=()=>{this.update(),K(this)},t.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}))),this._load}_loadSvg(){const t=new Image;Qt.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=K=>{this._resolve&&(t.onerror=null,this.onError.emit(K))},t.onload=()=>{if(!this._resolve)return;const K=t.width,D=t.height;if(!K||!D)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let a=K*this.scale,G=D*this.scale;(this._overrideWidth||this._overrideHeight)&&(a=this._overrideWidth||this._overrideHeight/D*K,G=this._overrideHeight||this._overrideWidth/K*D),a=Math.round(a),G=Math.round(G);const W=this.source;W.width=a,W.height=G,W._pixiId=`canvas_${N.uid()}`,W.getContext("2d").drawImage(t,0,0,K,D,0,0,a,G),this._resolve(),this._resolve=null}}static getSize(K){const D=t.SVG_SIZE.exec(K),a={};return D&&(a[D[1]]=Math.round(parseFloat(D[3])),a[D[5]]=Math.round(parseFloat(D[7]))),a}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(K,D){return"svg"===D||"string"==typeof K&&K.startsWith("data:image/svg+xml")||"string"==typeof K&&t.SVG_XML.test(K)}};pK.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,pK.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let jK=pK;const rK=class t extends Qt{constructor(K,D){if(D=D||{},!(K instanceof HTMLVideoElement)){const a=document.createElement("video");!1!==D.autoLoad&&a.setAttribute("preload","auto"),!1!==D.playsinline&&(a.setAttribute("webkit-playsinline",""),a.setAttribute("playsinline","")),!0===D.muted&&(a.setAttribute("muted",""),a.muted=!0),!0===D.loop&&a.setAttribute("loop",""),!1!==D.autoPlay&&a.setAttribute("autoplay",""),"string"==typeof K&&(K=[K]);const G=K[0].src||K[0];Qt.crossOrigin(a,G,D.crossorigin);for(let D=0;D<K.length;++D){const G=document.createElement("source");let{src:N,mime:W}=K[D];if(N=N||K[D],N.startsWith("data:"))W=N.slice(5,N.indexOf(";"));else if(!N.startsWith("blob:")){const K=N.split("?").shift().toLowerCase(),D=K.slice(K.lastIndexOf(".")+1);W=W||t.MIME_TYPES[D]||`video/${D}`}G.src=N,W&&(G.type=W),a.appendChild(G)}K=a}super(K),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=D.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==D.autoPlay,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),!1!==D.autoLoad&&this.load()}update(t=0){if(!this.destroyed){if(this._updateFPS){const t=sK.Rv.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise(((K,D)=>{this.valid?K(this):(this._resolve=K,this._reject=D,t.load())})),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const K=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!K&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._configureAutoUpdate();const t=this.source;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(sK.Rv.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(sK.Rv.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(sK.Rv.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(K,D){return globalThis.HTMLVideoElement&&K instanceof HTMLVideoElement||t.TYPES.includes(D)}};rK.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],rK.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let MK=rK;d.push(vK,Pt,class extends Qt{constructor(t){super(t)}static test(t){const{OffscreenCanvas:K}=globalThis;return!!(K&&t instanceof K)||globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}},MK,jK,P,OK,class extends $K{constructor(t,K){const{width:D,height:a}=K||{};let G,N;Array.isArray(t)?(G=t,N=t.length):N=t,super(N,{width:D,height:a}),G&&this.initFromArray(G,K)}addBaseTextureAt(t,K){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,K),this}bind(t){super.bind(t),t.target=a.dW.TEXTURE_2D_ARRAY}upload(t,K,D){const{length:a,itemDirtyIds:G,items:N}=this,{gl:W}=t;D.dirtyId<0&&W.texImage3D(W.TEXTURE_2D_ARRAY,0,D.internalFormat,this._width,this._height,a,0,K.format,D.type,null);for(let t=0;t<a;t++){const a=N[t];G[t]<a.dirtyId&&(G[t]=a.dirtyId,a.valid&&W.texSubImage3D(W.TEXTURE_2D_ARRAY,0,0,0,t,a.resource.width,a.resource.height,1,K.format,D.type,a.resource.source))}return!0}})},110715:(t,K,D)=>{D.d(K,{cz:()=>G,mc:()=>e,q9:()=>N});var a=D(316197);class G{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?a.M_.EMPTY:((t=t||new a.M_(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,K){const{a:D,b:a,c:G,d:N,tx:W,ty:x}=t,b=D*K.x+G*K.y+W,n=a*K.x+N*K.y+x;this.minX=Math.min(this.minX,b),this.maxX=Math.max(this.maxX,b),this.minY=Math.min(this.minY,n),this.maxY=Math.max(this.maxY,n)}addQuad(t){let K=this.minX,D=this.minY,a=this.maxX,G=this.maxY,N=t[0],W=t[1];K=N<K?N:K,D=W<D?W:D,a=N>a?N:a,G=W>G?W:G,N=t[2],W=t[3],K=N<K?N:K,D=W<D?W:D,a=N>a?N:a,G=W>G?W:G,N=t[4],W=t[5],K=N<K?N:K,D=W<D?W:D,a=N>a?N:a,G=W>G?W:G,N=t[6],W=t[7],K=N<K?N:K,D=W<D?W:D,a=N>a?N:a,G=W>G?W:G,this.minX=K,this.minY=D,this.maxX=a,this.maxY=G}addFrame(t,K,D,a,G){this.addFrameMatrix(t.worldTransform,K,D,a,G)}addFrameMatrix(t,K,D,a,G){const N=t.a,W=t.b,x=t.c,b=t.d,n=t.tx,e=t.ty;let i=this.minX,z=this.minY,I=this.maxX,Z=this.maxY,w=N*K+x*D+n,m=W*K+b*D+e;i=w<i?w:i,z=m<z?m:z,I=w>I?w:I,Z=m>Z?m:Z,w=N*a+x*D+n,m=W*a+b*D+e,i=w<i?w:i,z=m<z?m:z,I=w>I?w:I,Z=m>Z?m:Z,w=N*K+x*G+n,m=W*K+b*G+e,i=w<i?w:i,z=m<z?m:z,I=w>I?w:I,Z=m>Z?m:Z,w=N*a+x*G+n,m=W*a+b*G+e,i=w<i?w:i,z=m<z?m:z,I=w>I?w:I,Z=m>Z?m:Z,this.minX=i,this.minY=z,this.maxX=I,this.maxY=Z}addVertexData(t,K,D){let a=this.minX,G=this.minY,N=this.maxX,W=this.maxY;for(let x=K;x<D;x+=2){const K=t[x],D=t[x+1];a=K<a?K:a,G=D<G?D:G,N=K>N?K:N,W=D>W?D:W}this.minX=a,this.minY=G,this.maxX=N,this.maxY=W}addVertices(t,K,D,a){this.addVerticesMatrix(t.worldTransform,K,D,a)}addVerticesMatrix(t,K,D,a,G=0,N=G){const W=t.a,x=t.b,b=t.c,n=t.d,e=t.tx,i=t.ty;let z=this.minX,I=this.minY,Z=this.maxX,w=this.maxY;for(let t=D;t<a;t+=2){const D=K[t],a=K[t+1],m=W*D+b*a+e,u=n*a+x*D+i;z=Math.min(z,m-G),Z=Math.max(Z,m+G),I=Math.min(I,u-N),w=Math.max(w,u+N)}this.minX=z,this.minY=I,this.maxX=Z,this.maxY=w}addBounds(t){const K=this.minX,D=this.minY,a=this.maxX,G=this.maxY;this.minX=t.minX<K?t.minX:K,this.minY=t.minY<D?t.minY:D,this.maxX=t.maxX>a?t.maxX:a,this.maxY=t.maxY>G?t.maxY:G}addBoundsMask(t,K){const D=t.minX>K.minX?t.minX:K.minX,a=t.minY>K.minY?t.minY:K.minY,G=t.maxX<K.maxX?t.maxX:K.maxX,N=t.maxY<K.maxY?t.maxY:K.maxY;if(D<=G&&a<=N){const t=this.minX,K=this.minY,W=this.maxX,x=this.maxY;this.minX=D<t?D:t,this.minY=a<K?a:K,this.maxX=G>W?G:W,this.maxY=N>x?N:x}}addBoundsMatrix(t,K){this.addFrameMatrix(K,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,K){const D=t.minX>K.x?t.minX:K.x,a=t.minY>K.y?t.minY:K.y,G=t.maxX<K.x+K.width?t.maxX:K.x+K.width,N=t.maxY<K.y+K.height?t.maxY:K.y+K.height;if(D<=G&&a<=N){const t=this.minX,K=this.minY,W=this.maxX,x=this.maxY;this.minX=D<t?D:t,this.minY=a<K?a:K,this.maxX=G>W?G:W,this.maxY=N>x?N:x}}pad(t=0,K=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=K,this.maxY+=K)}addFramePad(t,K,D,a,G,N){t-=G,K-=N,D+=G,a+=N,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>D?this.maxX:D,this.minY=this.minY<K?this.minY:K,this.maxY=this.maxY>a?this.maxY:a}}class N extends a.Wp.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new a.dL,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new G,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const K=Object.keys(t);for(let D=0;D<K.length;++D){const a=K[D];Object.defineProperty(N.prototype,a,Object.getOwnPropertyDescriptor(t,a))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,K){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),K||(this._boundsRect||(this._boundsRect=new a.M_),K=this._boundsRect),this._bounds.getRectangle(K)}getLocalBounds(t){var K;t||(this._localBoundsRect||(this._localBoundsRect=new a.M_),t=this._localBoundsRect),this._localBounds||(this._localBounds=new G);const D=this.transform,N=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=null!==(K=null==N?void 0:N.worldAlpha)&&void 0!==K?K:1,this.transform=this._tempDisplayObjectParent.transform;const W=this._bounds,x=this._boundsID;this._bounds=this._localBounds;const b=this.getBounds(!1,t);return this.parent=N,this.transform=D,this._bounds=W,this._bounds.updateID+=this._boundsID-x,b}toGlobal(t,K,D=!1){return D||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,K)}toLocal(t,K,D,a){return K&&(t=K.toGlobal(t,D,a)),a||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,D)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;null===(t=this.parent)||void 0===t||t.removeChild(this)}setTransform(t=0,K=0,D=1,a=1,G=0,N=0,W=0,x=0,b=0){return this.position.x=t,this.position.y=K,this.scale.x=D||1,this.scale.y=a||1,this.rotation=G,this.skew.x=N,this.skew.y=W,this.pivot.x=x,this.pivot.y=b,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new W),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*a.bO}set angle(t){this.transform.rotation=t*a.Td}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount--,0===t._maskRefCount&&(t.renderable=!0,t.isMask=!1))}if(this._mask=t,this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(0===t._maskRefCount&&(t.renderable=!1,t.isMask=!0),t._maskRefCount++)}}}}class W extends N{constructor(){super(...arguments),this.sortDirty=null}}N.prototype.displayObjectUpdateTransform=N.prototype.updateTransform;const x=new a.uq;function b(t,K){return t.zIndex===K.zIndex?t._lastSortedIndex-K._lastSortedIndex:t.zIndex-K.zIndex}const n=class t extends N{constructor(){super(),this.children=[],this.sortableChildren=t.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let K=0;K<t.length;K++)this.addChild(t[K]);else{const K=t[0];K.parent&&K.parent.removeChild(K),K.parent=this,this.sortDirty=!0,K.transform._parentID=-1,this.children.push(K),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",K,this,this.children.length-1),K.emit("added",this)}return t[0]}addChildAt(t,K){if(K<0||K>this.children.length)throw new Error(`${t}addChildAt: The index ${K} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(K,0,t),this._boundsID++,this.onChildrenChange(K),t.emit("added",this),this.emit("childAdded",t,this,K),t}swapChildren(t,K){if(t===K)return;const D=this.getChildIndex(t),a=this.getChildIndex(K);this.children[D]=K,this.children[a]=t,this.onChildrenChange(D<a?D:a)}getChildIndex(t){const K=this.children.indexOf(t);if(-1===K)throw new Error("The supplied DisplayObject must be a child of the caller");return K}setChildIndex(t,K){if(K<0||K>=this.children.length)throw new Error(`The index ${K} supplied is out of bounds ${this.children.length}`);const D=this.getChildIndex(t);a.Wp.removeItems(this.children,D,1),this.children.splice(K,0,t),this.onChildrenChange(K)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let K=0;K<t.length;K++)this.removeChild(t[K]);else{const K=t[0],D=this.children.indexOf(K);if(-1===D)return null;K.parent=null,K.transform._parentID=-1,a.Wp.removeItems(this.children,D,1),this._boundsID++,this.onChildrenChange(D),K.emit("removed",this),this.emit("childRemoved",K,this,D)}return t[0]}removeChildAt(t){const K=this.getChildAt(t);return K.parent=null,K.transform._parentID=-1,a.Wp.removeItems(this.children,t,1),this._boundsID++,this.onChildrenChange(t),K.emit("removed",this),this.emit("childRemoved",K,this,t),K}removeChildren(t=0,K=this.children.length){const D=t,a=K-D;let G;if(a>0&&a<=K){G=this.children.splice(D,a);for(let t=0;t<G.length;++t)G[t].parent=null,G[t].transform&&(G[t].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let t=0;t<G.length;++t)G[t].emit("removed",this),this.emit("childRemoved",G[t],this,t);return G}if(0===a&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let K=0,D=this.children.length;K<D;++K){const D=this.children[K];D._lastSortedIndex=K,!t&&0!==D.zIndex&&(t=!0)}t&&this.children.length>1&&this.children.sort(b),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,K=this.children.length;t<K;++t){const K=this.children[t];K.visible&&K.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const K=this.children[t];if(K.visible&&K.renderable)if(K.calculateBounds(),K._mask){const t=K._mask.isMaskData?K._mask.maskObject:K._mask;t?(t.calculateBounds(),this._bounds.addBoundsMask(K._bounds,t._bounds)):this._bounds.addBounds(K._bounds)}else K.filterArea?this._bounds.addBoundsArea(K._bounds,K.filterArea):this._bounds.addBounds(K._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,K=!1){const D=super.getLocalBounds(t);if(!K)for(let t=0,K=this.children.length;t<K;++t){const K=this.children[t];K.visible&&K.updateTransform()}return D}_calculateBounds(){}_renderWithCulling(K){const D=K.renderTexture.sourceFrame;if(!(D.width>0&&D.height>0))return;let a,G;this.cullArea?(a=this.cullArea,G=this.worldTransform):this._render!==t.prototype._render&&(a=this.getBounds(!0));const N=K.projection.transform;if(N&&(G?(G=x.copyFrom(G),G.prepend(N)):G=N),a&&D.intersects(a,G))this._render(K);else if(this.cullArea)return;for(let t=0,D=this.children.length;t<D;++t){const D=this.children[t],a=D.cullable;D.cullable=a||!this.cullArea,D.render(K),D.cullable=a}}render(t){var K;if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||(null===(K=this.filters)||void 0===K?void 0:K.length))this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let K=0,D=this.children.length;K<D;++K)this.children[K].render(t)}}renderAdvanced(t){var K,D,G;const N=this.filters,W=this._mask;if(N){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let t=0;t<N.length;t++)N[t].enabled&&this._enabledFilters.push(N[t])}const x=N&&(null===(K=this._enabledFilters)||void 0===K?void 0:K.length)||W&&(!W.isMaskData||W.enabled&&(W.autoDetect||W.type!==a.vg.NONE));if(x&&t.batch.flush(),N&&(null===(D=this._enabledFilters)||void 0===D?void 0:D.length)&&t.filter.push(this,this._enabledFilters),W&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let K=0,D=this.children.length;K<D;++K)this.children[K].render(t)}x&&t.batch.flush(),W&&t.mask.pop(this),N&&(null===(G=this._enabledFilters)||void 0===G?void 0:G.length)&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const K="boolean"==typeof t?t:null==t?void 0:t.children,D=this.removeChildren(0,this.children.length);if(K)for(let K=0;K<D.length;++K)D[K].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const K=this.getLocalBounds().width;this.scale.x=0!==K?t/K:1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const K=this.getLocalBounds().height;this.scale.y=0!==K?t/K:1,this._height=t}};n.defaultSortableChildren=!1;let e=n;e.prototype.containerUpdateTransform=e.prototype.updateTransform,Object.defineProperties(a.W0,{SORTABLE_CHILDREN:{get:()=>e.defaultSortableChildren,set(t){a.Wp.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),e.defaultSortableChildren=t}}})},738637:(t,K,D)=>{D.d(K,{A:()=>a,X:()=>W});var a=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(a||{});const G=t=>{if("function"==typeof t||"object"==typeof t&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={..."object"!=typeof t.extension?{type:t.extension}:t.extension,ref:t}}if("object"!=typeof t)throw new Error("Invalid extension type");return"string"==typeof(t={...t}).type&&(t.type=[t.type]),t},N=(t,K)=>{var D;return null!==(D=G(t).priority)&&void 0!==D?D:K},W={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(G).forEach((t=>{t.type.forEach((K=>{var D,a;return null===(a=(D=this._removeHandlers)[K])||void 0===a?void 0:a.call(D,t)}))})),this},add(...t){return t.map(G).forEach((t=>{t.type.forEach((K=>{const D=this._addHandlers,a=this._queue;D[K]?D[K](t):(a[K]=a[K]||[],a[K].push(t))}))})),this},handle(t,K,D){const a=this._addHandlers,G=this._removeHandlers;if(a[t]||G[t])throw new Error(`Extension type ${t} already has a handler`);a[t]=K,G[t]=D;const N=this._queue;return N[t]&&(N[t].forEach((t=>K(t))),delete N[t]),this},handleByMap(t,K){return this.handle(t,(t=>{K[t.name]=t.ref}),(t=>{delete K[t.name]}))},handleByList(t,K,D=-1){return this.handle(t,(t=>{K.includes(t.ref)||(K.push(t.ref),K.sort(((t,K)=>N(K,D)-N(t,D))))}),(t=>{const D=K.indexOf(t.ref);-1!==D&&K.splice(D,1)}))}}},246638:(t,K,D)=>{D.d(K,{Z:()=>N});var a=D(316197),G=`varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n`;class N extends a.dJ{constructor(t=1){super(a.MT,G,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}},528176:(t,K,D)=>{D.d(K,{e:()=>b,H:()=>x});var a=D(316197);const G={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},N=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`\n`),W=`\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }`;class x extends a.dJ{constructor(t,K=8,D=4,x=a.dJ.defaultResolution,b=5){const n=function(t,K){const D=Math.ceil(t/2);let a,G=W,N="";a=K?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let K=0;K<t;K++){let t=a.replace("%index%",K.toString());t=t.replace("%sampleIndex%",`${K-(D-1)}.0`),N+=t,N+=`\n`}return G=G.replace("%blur%",N),G=G.replace("%size%",t.toString()),G}(b,t),e=function(t){const K=G[t],D=K.length;let a=N,W="";const x="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let b;for(let a=0;a<t;a++){let G=x.replace("%index%",a.toString());b=a,a>=D&&(b=t-a-1),G=G.replace("%value%",K[b].toString()),W+=G,W+=`\n`}return a=a.replace("%blur%",W),a=a.replace("%size%",t.toString()),a}(b);super(n,e),this.horizontal=t,this.resolution=x,this._quality=0,this.quality=D,this.blur=K}apply(t,K,D,G){if(D?this.horizontal?this.uniforms.strength=1/D.width*(D.width/K.width):this.uniforms.strength=1/D.height*(D.height/K.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/K.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/K.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,K,D,G);else{const N=t.getFilterTexture(),W=t.renderer;let x=K,b=N;this.state.blend=!1,t.applyFilter(this,x,b,a.fr.CLEAR);for(let K=1;K<this.passes-1;K++){t.bindAndClear(x,a.fr.BLIT),this.uniforms.uSampler=b;const K=b;b=x,x=K,W.shader.bind(this),W.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,b,D,G),t.returnFilterTexture(N)}}get blur(){return this.strength}set blur(t){this.padding=1+2*Math.abs(t),this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class b extends a.dJ{constructor(t=8,K=4,D=a.dJ.defaultResolution,G=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new x(!0,t,K,D,G),this.blurYFilter=new x(!1,t,K,D,G),this.resolution=D,this.quality=K,this.blur=t,this.repeatEdgePixels=!1}apply(t,K,D,G){const N=Math.abs(this.blurXFilter.strength),W=Math.abs(this.blurYFilter.strength);if(N&&W){const N=t.getFilterTexture();this.blurXFilter.apply(t,K,N,a.fr.CLEAR),this.blurYFilter.apply(t,N,D,G),t.returnFilterTexture(N)}else W?this.blurYFilter.apply(t,K,D,G):this.blurXFilter.apply(t,K,D,G)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}},698539:(t,K,D)=>{D.d(K,{N:()=>N});var a=D(316197),G=`varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n`;class N extends a.dJ{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(a.Eo,G,t),this.alpha=1}_loadMatrix(t,K=!1){let D=t;K&&(this._multiply(D,this.uniforms.m,t),D=this._colorMatrix(D)),this.uniforms.m=D}_multiply(t,K,D){return t[0]=K[0]*D[0]+K[1]*D[5]+K[2]*D[10]+K[3]*D[15],t[1]=K[0]*D[1]+K[1]*D[6]+K[2]*D[11]+K[3]*D[16],t[2]=K[0]*D[2]+K[1]*D[7]+K[2]*D[12]+K[3]*D[17],t[3]=K[0]*D[3]+K[1]*D[8]+K[2]*D[13]+K[3]*D[18],t[4]=K[0]*D[4]+K[1]*D[9]+K[2]*D[14]+K[3]*D[19]+K[4],t[5]=K[5]*D[0]+K[6]*D[5]+K[7]*D[10]+K[8]*D[15],t[6]=K[5]*D[1]+K[6]*D[6]+K[7]*D[11]+K[8]*D[16],t[7]=K[5]*D[2]+K[6]*D[7]+K[7]*D[12]+K[8]*D[17],t[8]=K[5]*D[3]+K[6]*D[8]+K[7]*D[13]+K[8]*D[18],t[9]=K[5]*D[4]+K[6]*D[9]+K[7]*D[14]+K[8]*D[19]+K[9],t[10]=K[10]*D[0]+K[11]*D[5]+K[12]*D[10]+K[13]*D[15],t[11]=K[10]*D[1]+K[11]*D[6]+K[12]*D[11]+K[13]*D[16],t[12]=K[10]*D[2]+K[11]*D[7]+K[12]*D[12]+K[13]*D[17],t[13]=K[10]*D[3]+K[11]*D[8]+K[12]*D[13]+K[13]*D[18],t[14]=K[10]*D[4]+K[11]*D[9]+K[12]*D[14]+K[13]*D[19]+K[14],t[15]=K[15]*D[0]+K[16]*D[5]+K[17]*D[10]+K[18]*D[15],t[16]=K[15]*D[1]+K[16]*D[6]+K[17]*D[11]+K[18]*D[16],t[17]=K[15]*D[2]+K[16]*D[7]+K[17]*D[12]+K[18]*D[17],t[18]=K[15]*D[3]+K[16]*D[8]+K[17]*D[13]+K[18]*D[18],t[19]=K[15]*D[4]+K[16]*D[9]+K[17]*D[14]+K[18]*D[19]+K[19],t}_colorMatrix(t){const K=new Float32Array(t);return K[4]/=255,K[9]/=255,K[14]/=255,K[19]/=255,K}brightness(t,K){const D=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(D,K)}tint(t,K){const[D,G,N]=a.Q1.shared.setValue(t).toArray(),W=[D,0,0,0,0,0,G,0,0,0,0,0,N,0,0,0,0,0,1,0];this._loadMatrix(W,K)}greyscale(t,K){const D=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(D,K)}blackAndWhite(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)}hue(t,K){t=(t||0)/180*Math.PI;const D=Math.cos(t),a=Math.sin(t),G=1/3,N=(0,Math.sqrt)(G),W=[D+(1-D)*G,G*(1-D)-N*a,G*(1-D)+N*a,0,0,G*(1-D)+N*a,D+G*(1-D),G*(1-D)-N*a,0,0,G*(1-D)-N*a,G*(1-D)+N*a,D+G*(1-D),0,0,0,0,0,1,0];this._loadMatrix(W,K)}contrast(t,K){const D=(t||0)+1,a=-.5*(D-1),G=[D,0,0,0,a,0,D,0,0,a,0,0,D,0,a,0,0,0,1,0];this._loadMatrix(G,K)}saturate(t=0,K){const D=2*t/3+1,a=-.5*(D-1),G=[D,a,a,0,0,a,D,a,0,0,a,a,D,0,0,0,0,0,1,0];this._loadMatrix(G,K)}desaturate(){this.saturate(-1)}negative(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)}sepia(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)}technicolor(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)}polaroid(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)}toBGR(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)}kodachrome(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)}browni(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)}vintage(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)}colorTone(t,K,D,G,N){t=t||.2,K=K||.15,D=D||16770432,G=G||3375104;const W=a.Q1.shared,[x,b,n]=W.setValue(D).toArray(),[e,i,z]=W.setValue(G).toArray(),I=[.3,.59,.11,0,0,x,b,n,t,0,e,i,z,K,0,x-e,b-i,n-z,0,0];this._loadMatrix(I,N)}night(t,K){const D=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(D,K)}predator(t,K){const D=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(D,K)}lsd(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)}reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}N.prototype.grayscale=N.prototype.greyscale},132565:(t,K,D)=>{D.d(K,{U:()=>W});var a=D(316197),G=`varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n`,N=`attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n`;class W extends a.dJ{constructor(t,K){const D=new a.uq;t.renderable=!1,super(N,G,{mapSampler:t._texture,filterMatrix:D,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=D,null==K&&(K=20),this.scale=new a.bR(K,K)}apply(t,K,D,a){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const G=this.maskSprite.worldTransform,N=Math.sqrt(G.a*G.a+G.b*G.b),W=Math.sqrt(G.c*G.c+G.d*G.d);0!==N&&0!==W&&(this.uniforms.rotation[0]=G.a/N,this.uniforms.rotation[1]=G.b/N,this.uniforms.rotation[2]=G.c/W,this.uniforms.rotation[3]=G.d/W),t.applyFilter(this,K,D,a)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}},366628:(t,K,D)=>{D.d(K,{A1:()=>H});var a=D(316197);const G={build(t){const K=t.points;let D,G,N,W,x,b;if(t.type===a.HY.CIRC){const K=t.shape;D=K.x,G=K.y,x=b=K.radius,N=W=0}else if(t.type===a.HY.ELIP){const K=t.shape;D=K.x,G=K.y,x=K.width,b=K.height,N=W=0}else{const K=t.shape,a=K.width/2,n=K.height/2;D=K.x+a,G=K.y+n,x=b=Math.max(0,Math.min(K.radius,Math.min(a,n))),N=a-x,W=n-b}if(!(x>=0&&b>=0&&N>=0&&W>=0))return void(K.length=0);const n=Math.ceil(2.3*Math.sqrt(x+b)),e=8*n+(N?4:0)+(W?4:0);if(K.length=e,0===e)return;if(0===n)return K.length=8,K[0]=K[6]=D+N,K[1]=K[3]=G+W,K[2]=K[4]=D-N,void(K[5]=K[7]=G-W);let i=0,z=4*n+(N?2:0)+2,I=z,Z=e;{const t=N+x,a=W,b=D+t,n=D-t,e=G+a;if(K[i++]=b,K[i++]=e,K[--z]=e,K[--z]=n,W){const t=G-a;K[I++]=n,K[I++]=t,K[--Z]=t,K[--Z]=b}}for(let t=1;t<n;t++){const a=Math.PI/2*(t/n),e=N+Math.cos(a)*x,w=W+Math.sin(a)*b,m=D+e,u=D-e,d=G+w,E=G-w;K[i++]=m,K[i++]=d,K[--z]=d,K[--z]=u,K[I++]=u,K[I++]=E,K[--Z]=E,K[--Z]=m}{const t=W+b,a=D+N,x=D-N,n=G+t,e=G-t;K[i++]=a,K[i++]=n,K[--Z]=e,K[--Z]=a,N&&(K[i++]=x,K[i++]=n,K[--Z]=e,K[--Z]=x)}},triangulate(t,K){const D=t.points,G=K.points,N=K.indices;if(0===D.length)return;let W=G.length/2;const x=W;let b,n;if(t.type!==a.HY.RREC){const K=t.shape;b=K.x,n=K.y}else{const K=t.shape;b=K.x+K.width/2,n=K.y+K.height/2}const e=t.matrix;G.push(t.matrix?e.a*b+e.c*n+e.tx:b,t.matrix?e.b*b+e.d*n+e.ty:n),W++,G.push(D[0],D[1]);for(let t=2;t<D.length;t+=2)G.push(D[t],D[t+1]),N.push(W++,x,W);N.push(x+1,x,W)}};function N(t,K=!1){const D=t.length;if(D<6)return;let a=0;for(let K=0,G=t[D-2],N=t[D-1];K<D;K+=2){const D=t[K],W=t[K+1];a+=(D-G)*(W+N),G=D,N=W}if(!K&&a>0||K&&a<=0){const K=D/2;for(let a=K+K%2;a<D;a+=2){const K=D-a-2,G=D-a-1,N=a,W=a+1;[t[K],t[N]]=[t[N],t[K]],[t[G],t[W]]=[t[W],t[G]]}}}const W={build(t){t.points=t.shape.points.slice()},triangulate(t,K){let D=t.points;const G=t.holes,W=K.points,x=K.indices;if(D.length>=6){N(D,!1);const t=[];for(let K=0;K<G.length;K++){const a=G[K];N(a.points,!0),t.push(D.length/2),D=D.concat(a.points)}const K=a.Wp.earcut(D,t,2);if(!K)return;const b=W.length/2;for(let t=0;t<K.length;t+=3)x.push(K[t]+b),x.push(K[t+1]+b),x.push(K[t+2]+b);for(let t=0;t<D.length;t++)W.push(D[t])}}},x={build(t){const K=t.shape,D=K.x,a=K.y,G=K.width,N=K.height,W=t.points;W.length=0,G>=0&&N>=0&&W.push(D,a,D+G,a,D+G,a+N,D,a+N)},triangulate(t,K){const D=t.points,a=K.points;if(0===D.length)return;const G=a.length/2;a.push(D[0],D[1],D[2],D[3],D[6],D[7],D[4],D[5]),K.indices.push(G,G+1,G+2,G+1,G+2,G+3)}},b={build(t){G.build(t)},triangulate(t,K){G.triangulate(t,K)}};var n=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(n||{}),e=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(e||{});const i={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,K=20){if(!this.adaptive||!t||isNaN(t))return K;let D=Math.ceil(t/this.maxLength);return D<this.minSegments?D=this.minSegments:D>this.maxSegments&&(D=this.maxSegments),D}};class z{static curveTo(t,K,D,a,G,N){const W=N[N.length-2],x=N[N.length-1]-K,b=W-t,n=a-K,e=D-t,i=Math.abs(x*e-b*n);if(i<1e-8||0===G)return(N[N.length-2]!==t||N[N.length-1]!==K)&&N.push(t,K),null;const z=x*x+b*b,I=n*n+e*e,Z=x*n+b*e,w=G*Math.sqrt(z)/i,m=G*Math.sqrt(I)/i,u=w*Z/z,d=m*Z/I,E=w*e+m*b,l=w*n+m*x,Q=b*(m+u),P=x*(m+u),y=e*(w+d),q=n*(w+d);return{cx:E+t,cy:l+K,radius:G,startAngle:Math.atan2(P-l,Q-E),endAngle:Math.atan2(q-l,y-E),anticlockwise:b*n>e*x}}static arc(t,K,D,G,N,W,x,b,n){const e=x-W,z=i._segmentsCount(Math.abs(e)*N,40*Math.ceil(Math.abs(e)/a.TO)),I=e/(2*z),Z=2*I,w=Math.cos(I),m=Math.sin(I),u=z-1,d=u%1/u;for(let t=0;t<=u;++t){const K=I+W+Z*(t+d*t),a=Math.cos(K),x=-Math.sin(K);n.push((w*a+m*x)*N+D,(w*-x+m*a)*N+G)}}}class I{static curveLength(t,K,D,a,G,N,W,x){let b=0,n=0,e=0,i=0,z=0,I=0,Z=0,w=0,m=0,u=0,d=0,E=t,l=K;for(let Q=1;Q<=10;++Q)n=Q/10,e=n*n,i=e*n,z=1-n,I=z*z,Z=I*z,w=Z*t+3*I*n*D+3*z*e*G+i*W,m=Z*K+3*I*n*a+3*z*e*N+i*x,u=E-w,d=l-m,E=w,l=m,b+=Math.sqrt(u*u+d*d);return b}static curveTo(t,K,D,a,G,N,W){const x=W[W.length-2],b=W[W.length-1];W.length-=2;const n=i._segmentsCount(I.curveLength(x,b,t,K,D,a,G,N));let e=0,z=0,Z=0,w=0,m=0;W.push(x,b);for(let i=1,I=0;i<=n;++i)I=i/n,e=1-I,z=e*e,Z=z*e,w=I*I,m=w*I,W.push(Z*x+3*z*I*t+3*e*w*D+m*G,Z*b+3*z*I*K+3*e*w*a+m*N)}}function Z(t,K,D,a,G,N,W,x){let b,n;W?(b=a,n=-D):(b=-a,n=D);const e=t-D*G+b,i=K-a*G+n,z=t+D*N+b,I=K+a*N+n;return x.push(e,i,z,I),2}function w(t,K,D,a,G,N,W,x){const b=D-t,n=a-K;let e=Math.atan2(b,n),i=Math.atan2(G-t,N-K);x&&e<i?e+=2*Math.PI:!x&&e>i&&(i+=2*Math.PI);let z=e;const I=i-e,Z=Math.abs(I),w=Math.sqrt(b*b+n*n),m=(15*Z*Math.sqrt(w)/Math.PI>>0)+1,u=I/m;if(z+=u,x){W.push(t,K,D,a);for(let D=1,a=z;D<m;D++,a+=u)W.push(t,K,t+Math.sin(a)*w,K+Math.cos(a)*w);W.push(t,K,G,N)}else{W.push(D,a,t,K);for(let D=1,a=z;D<m;D++,a+=u)W.push(t+Math.sin(a)*w,K+Math.cos(a)*w,t,K);W.push(G,N,t,K)}return 2*m}function m(t,K){t.lineStyle.native?function(t,K){let D=0;const G=t.shape,N=t.points||G.points,W=G.type!==a.HY.POLY||G.closeStroke;if(0===N.length)return;const x=K.points,b=K.indices,n=N.length/2,e=x.length/2;let i=e;for(x.push(N[0],N[1]),D=1;D<n;D++)x.push(N[2*D],N[2*D+1]),b.push(i,i+1),i++;W&&b.push(i,e)}(t,K):function(t,K){const D=t.shape;let G=t.points||D.points.slice();const N=K.closePointEps;if(0===G.length)return;const W=t.lineStyle,x=new a.bR(G[0],G[1]),b=new a.bR(G[G.length-2],G[G.length-1]),z=D.type!==a.HY.POLY||D.closeStroke,I=Math.abs(x.x-b.x)<N&&Math.abs(x.y-b.y)<N;if(z){G=G.slice(),I&&(G.pop(),G.pop(),b.set(G[G.length-2],G[G.length-1]));const t=.5*(x.x+b.x),K=.5*(b.y+x.y);G.unshift(t,K),G.push(t,K)}const m=K.points,u=G.length/2;let d=G.length;const E=m.length/2,l=W.width/2,Q=l*l,P=W.miterLimit*W.miterLimit;let y=G[0],q=G[1],X=G[2],h=G[3],J=0,T=0,_=-(q-h),C=y-X,H=0,o=0,U=Math.sqrt(_*_+C*C);_/=U,C/=U,_*=l,C*=l;const V=W.alignment,s=2*(1-V),F=2*V;z||(W.cap===e.ROUND?d+=w(y-_*(s-F)*.5,q-C*(s-F)*.5,y-_*s,q-C*s,y+_*F,q+C*F,m,!0)+2:W.cap===e.SQUARE&&(d+=Z(y,q,_,C,s,F,!0,m))),m.push(y-_*s,q-C*s,y+_*F,q+C*F);for(let t=1;t<u-1;++t){y=G[2*(t-1)],q=G[2*(t-1)+1],X=G[2*t],h=G[2*t+1],J=G[2*(t+1)],T=G[2*(t+1)+1],_=-(q-h),C=y-X,U=Math.sqrt(_*_+C*C),_/=U,C/=U,_*=l,C*=l,H=-(h-T),o=X-J,U=Math.sqrt(H*H+o*o),H/=U,o/=U,H*=l,o*=l;const K=X-y,D=q-h,a=X-J,N=T-h,x=K*a+D*N,b=D*a-N*K,e=b<0;if(Math.abs(b)<.001*Math.abs(x)){m.push(X-_*s,h-C*s,X+_*F,h+C*F),x>=0&&(W.join===n.ROUND?d+=w(X,h,X-_*s,h-C*s,X-H*s,h-o*s,m,!1)+4:d+=2,m.push(X-H*F,h-o*F,X+H*s,h+o*s));continue}const i=(-_+y)*(-C+h)-(-_+X)*(-C+q),z=(-H+J)*(-o+h)-(-H+X)*(-o+T),I=(K*z-a*i)/b,Z=(N*i-D*z)/b,u=(I-X)*(I-X)+(Z-h)*(Z-h),E=X+(I-X)*s,V=h+(Z-h)*s,c=X-(I-X)*F,g=h-(Z-h)*F,R=e?s:F,A=u<=Math.min(K*K+D*D,a*a+N*N)+R*R*Q;let Y=W.join;if(Y===n.MITER&&u/Q>P&&(Y=n.BEVEL),A)switch(Y){case n.MITER:m.push(E,V,c,g);break;case n.BEVEL:e?m.push(E,V,X+_*F,h+C*F,E,V,X+H*F,h+o*F):m.push(X-_*s,h-C*s,c,g,X-H*s,h-o*s,c,g),d+=2;break;case n.ROUND:e?(m.push(E,V,X+_*F,h+C*F),d+=w(X,h,X+_*F,h+C*F,X+H*F,h+o*F,m,!0)+4,m.push(E,V,X+H*F,h+o*F)):(m.push(X-_*s,h-C*s,c,g),d+=w(X,h,X-_*s,h-C*s,X-H*s,h-o*s,m,!1)+4,m.push(X-H*s,h-o*s,c,g))}else{switch(m.push(X-_*s,h-C*s,X+_*F,h+C*F),Y){case n.MITER:e?m.push(c,g,c,g):m.push(E,V,E,V),d+=2;break;case n.ROUND:d+=e?w(X,h,X+_*F,h+C*F,X+H*F,h+o*F,m,!0)+2:w(X,h,X-_*s,h-C*s,X-H*s,h-o*s,m,!1)+2}m.push(X-H*s,h-o*s,X+H*F,h+o*F),d+=2}}y=G[2*(u-2)],q=G[2*(u-2)+1],X=G[2*(u-1)],h=G[2*(u-1)+1],_=-(q-h),C=y-X,U=Math.sqrt(_*_+C*C),_/=U,C/=U,_*=l,C*=l,m.push(X-_*s,h-C*s,X+_*F,h+C*F),z||(W.cap===e.ROUND?d+=w(X-_*(s-F)*.5,h-C*(s-F)*.5,X-_*s,h-C*s,X+_*F,h+C*F,m,!1)+2:W.cap===e.SQUARE&&(d+=Z(X,h,_,C,s,F,!1,m)));const c=K.indices,g=i.epsilon*i.epsilon;for(let t=E;t<d+E-2;++t)y=m[2*t],q=m[2*t+1],X=m[2*(t+1)],h=m[2*(t+1)+1],J=m[2*(t+2)],T=m[2*(t+2)+1],!(Math.abs(y*(h-T)+X*(T-q)+J*(q-h))<g)&&c.push(t,t+1,t+2)}(t,K)}class u{static curveLength(t,K,D,a,G,N){const W=t-2*D+G,x=K-2*a+N,b=2*D-2*t,n=2*a-2*K,e=4*(W*W+x*x),i=4*(W*b+x*n),z=b*b+n*n,I=2*Math.sqrt(e+i+z),Z=Math.sqrt(e),w=2*e*Z,m=2*Math.sqrt(z),u=i/Z;return(w*I+Z*i*(I-m)+(4*z*e-i*i)*Math.log((2*Z+u+I)/(u+m)))/(4*w)}static curveTo(t,K,D,a,G){const N=G[G.length-2],W=G[G.length-1],x=i._segmentsCount(u.curveLength(N,W,t,K,D,a));let b=0,n=0;for(let e=1;e<=x;++e){const i=e/x;b=N+(t-N)*i,n=W+(K-W)*i,G.push(b+(t+(D-t)*i-b)*i,n+(K+(a-K)*i-n)*i)}}}const d={[a.HY.POLY]:W,[a.HY.CIRC]:G,[a.HY.ELIP]:G,[a.HY.RECT]:x,[a.HY.RREC]:b},E=[],l=[];var Q=D(110715);class P{constructor(t,K=null,D=null,a=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=D,this.fillStyle=K,this.matrix=a,this.type=t.type}clone(){return new P(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}class y{constructor(){this.reset()}begin(t,K,D){this.reset(),this.style=t,this.start=K,this.attribStart=D}end(t,K){this.attribSize=K-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}const q=new a.bR,X=class t extends a.JH{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Q.cz,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),l.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const K=this.batches[t];K.reset(),E.push(K)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,K=null,D=null,a=null){const G=new P(t,K,D,a);return this.graphicsData.push(G),this.dirty++,this}drawHole(t,K=null){if(!this.graphicsData.length)return null;const D=new P(t,null,null,K),a=this.graphicsData[this.graphicsData.length-1];return D.lineStyle=a.lineStyle,a.holes.push(D),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const K=this.graphicsData;for(let D=0;D<K.length;++D){const a=K[D];if(a.fillStyle.visible&&a.shape&&(a.matrix?a.matrix.applyInverse(t,q):q.copyFrom(t),a.shape.contains(q.x,q.y))){let t=!1;if(a.holes)for(let K=0;K<a.holes.length;K++)if(a.holes[K].shape.contains(q.x,q.y)){t=!0;break}if(!t)return!0}}return!1}updateBatches(){if(!this.graphicsData.length)return void(this.batchable=!0);if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,K=this.graphicsData;let D=null,G=null;this.batches.length>0&&(D=this.batches[this.batches.length-1],G=D.style);for(let N=this.shapeIndex;N<K.length;N++){this.shapeIndex++;const W=K[N],x=W.fillStyle,b=W.lineStyle;d[W.type].build(W),W.matrix&&this.transformPoints(W.points,W.matrix),(x.visible||b.visible)&&this.processHoles(W.holes);for(let K=0;K<2;K++){const N=0===K?x:b;if(!N.visible)continue;const n=N.texture.baseTexture,e=this.indices.length,i=this.points.length/2;n.wrapMode=a.uR.REPEAT,0===K?this.processFill(W):this.processLine(W);const z=this.points.length/2-i;0!==z&&(D&&!this._compareStyles(G,N)&&(D.end(e,i),D=null),D||(D=E.pop()||new y,D.begin(N,e,i),this.batches.push(D),G=N),this.addUvs(this.points,t,N.texture,i,z,N.matrix))}}const N=this.indices.length,W=this.points.length/2;if(D&&D.end(N,W),0===this.batches.length)return void(this.batchable=!0);const x=W>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&x===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=x?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,K){return!(!t||!K||t.texture.baseTexture!==K.texture.baseTexture||t.color+t.alpha!==K.color+K.alpha||!!t.native!=!!K.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,K=this.graphicsData.length;t<K;t++){const K=this.graphicsData[t],D=K.fillStyle,a=K.lineStyle;if(D&&!D.texture.baseTexture.valid||a&&!a.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let K=0,D=t.length;K<D;K++){const D=t[K];for(let t=0;t<D.size;t++){const K=D.start+t;this.indicesUint16[K]=this.indicesUint16[K]-D.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const K=this.batches;for(let t=0;t<K.length;t++)if(K[t].style.native)return!1;return this.points.length<2*t.BATCHABLE_SIZE}buildDrawCalls(){let t=++a.t5._globalBatch;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),l.push(this.drawCalls[t]);this.drawCalls.length=0;const K=this.colors,D=this.textureIds;let G=l.pop();G||(G=new a.hq,G.texArray=new a.cc),G.texArray.count=0,G.start=0,G.size=0,G.type=a._4.TRIANGLES;let N=0,W=null,x=0,b=!1,n=a._4.TRIANGLES,e=0;this.drawCalls.push(G);for(let i=0;i<this.batches.length;i++){const z=this.batches[i],I=8,Z=z.style,w=Z.texture.baseTexture;b!==!!Z.native&&(b=!!Z.native,n=b?a._4.LINES:a._4.TRIANGLES,W=null,N=I,t++),W!==w&&(W=w,w._batchEnabled!==t&&(N===I&&(t++,N=0,G.size>0&&(G=l.pop(),G||(G=new a.hq,G.texArray=new a.cc),this.drawCalls.push(G)),G.start=e,G.size=0,G.texArray.count=0,G.type=n),w.touched=1,w._batchEnabled=t,w._batchLocation=N,w.wrapMode=a.uR.REPEAT,G.texArray.elements[G.texArray.count++]=w,N++)),G.size+=z.size,e+=z.size,x=w._batchLocation,this.addColors(K,Z.color,Z.alpha,z.attribSize,z.attribStart),this.addTextureIds(D,x,z.attribSize,z.attribStart)}a.t5._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,K=this.uvs,D=this.colors,a=this.textureIds,G=new ArrayBuffer(3*t.length*4),N=new Float32Array(G),W=new Uint32Array(G);let x=0;for(let G=0;G<t.length/2;G++)N[x++]=t[2*G],N[x++]=t[2*G+1],N[x++]=K[2*G],N[x++]=K[2*G+1],W[x++]=D[G],N[x++]=a[G];this._buffer.update(G),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?W.triangulate(t,this):d[t.type].triangulate(t,this)}processLine(t){m(t,this);for(let K=0;K<t.holes.length;K++)m(t.holes[K],this)}processHoles(t){for(let K=0;K<t.length;K++){const D=t[K];d[D.type].build(D),D.matrix&&this.transformPoints(D.points,D.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,K){for(let D=0;D<t.length/2;D++){const a=t[2*D],G=t[2*D+1];t[2*D]=K.a*a+K.c*G+K.tx,t[2*D+1]=K.b*a+K.d*G+K.ty}}addColors(t,K,D,G,N=0){const W=a.Q1.shared.setValue(K).toLittleEndianNumber(),x=a.Q1.shared.setValue(W).toPremultiplied(D);t.length=Math.max(t.length,N+G);for(let K=0;K<G;K++)t[N+K]=x}addTextureIds(t,K,D,a=0){t.length=Math.max(t.length,a+D);for(let G=0;G<D;G++)t[a+G]=K}addUvs(t,K,D,a,G,N=null){let W=0;const x=K.length,b=D.frame;for(;W<G;){let D=t[2*(a+W)],G=t[2*(a+W)+1];if(N){const t=N.a*D+N.c*G+N.tx;G=N.b*D+N.d*G+N.ty,D=t}W++,K.push(D/b.width,G/b.height)}const n=D.baseTexture;(b.width<n.width||b.height<n.height)&&this.adjustUvs(K,D,x,G)}adjustUvs(t,K,D,a){const G=K.baseTexture,N=1e-6,W=D+2*a,x=K.frame,b=x.width/G.width,n=x.height/G.height;let e=x.x/x.width,i=x.y/x.height,z=Math.floor(t[D]+N),I=Math.floor(t[D+1]+N);for(let K=D+2;K<W;K+=2)z=Math.min(z,Math.floor(t[K]+N)),I=Math.min(I,Math.floor(t[K+1]+N));e-=z,i-=I;for(let K=D;K<W;K+=2)t[K]=(t[K]+e)*b,t[K+1]=(t[K+1]+i)*n}};X.BATCHABLE_SIZE=100;let h=X;class J{constructor(){this.color=16777215,this.alpha=1,this.texture=a.gP.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new J;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=a.gP.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class T extends J{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=e.BUTT,this.join=n.MITER,this.miterLimit=10}clone(){const t=new T;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=e.BUTT,this.join=n.MITER,this.miterLimit=10}}const _={},C=class t extends Q.mc{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new J,this._lineStyle=new T,this._matrix=null,this._holeMode=!1,this.state=a.Uw.for2d(),this._geometry=t||new h,this._geometry.refCount++,this._transformID=-1,this._tintColor=new a.Q1(16777215),this.blendMode=a.B9.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new t(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,K=0,D,a=.5,G=!1){return"number"==typeof t&&(t={width:t,color:K,alpha:D,alignment:a,native:G}),this.lineTextureStyle(t)}lineTextureStyle(t){const K={width:0,texture:a.gP.WHITE,color:(null==t?void 0:t.texture)?16777215:0,matrix:null,alignment:.5,native:!1,cap:e.BUTT,join:n.MITER,miterLimit:10};t=Object.assign(K,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const D=t.width>0&&t.alpha>0;return D?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:D},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,K=this.currentPath.points.length;K>2&&(this.drawShape(this.currentPath),this.currentPath=new a.tS,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[K-2],t[K-1]))}else this.currentPath=new a.tS,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,K){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=K,this}lineTo(t,K){this.currentPath||this.moveTo(0,0);const D=this.currentPath.points,a=D[D.length-2],G=D[D.length-1];return(a!==t||G!==K)&&D.push(t,K),this}_initCurve(t=0,K=0){this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,K]):this.moveTo(t,K)}quadraticCurveTo(t,K,D,a){this._initCurve();const G=this.currentPath.points;return 0===G.length&&this.moveTo(0,0),u.curveTo(t,K,D,a,G),this}bezierCurveTo(t,K,D,a,G,N){return this._initCurve(),I.curveTo(t,K,D,a,G,N,this.currentPath.points),this}arcTo(t,K,D,a,G){this._initCurve(t,K);const N=this.currentPath.points,W=z.curveTo(t,K,D,a,G,N);if(W){const{cx:t,cy:K,radius:D,startAngle:a,endAngle:G,anticlockwise:N}=W;this.arc(t,K,D,a,G,N)}return this}arc(t,K,D,G,N,W=!1){if(G===N)return this;if(!W&&N<=G?N+=a.TO:W&&G<=N&&(G+=a.TO),N-G==0)return this;const x=t+Math.cos(G)*D,b=K+Math.sin(G)*D,n=this._geometry.closePointEps;let e=this.currentPath?this.currentPath.points:null;if(e){const t=Math.abs(e[e.length-2]-x),K=Math.abs(e[e.length-1]-b);t<n&&K<n||e.push(x,b)}else this.moveTo(x,b),e=this.currentPath.points;return z.arc(x,b,t,K,D,G,N,W,e),this}beginFill(t=0,K){return this.beginTextureFill({texture:a.gP.WHITE,color:t,alpha:K})}normalizeColor(t){var K,D;const G=a.Q1.shared.setValue(null!==(K=t.color)&&void 0!==K?K:0);t.color=G.toNumber(),null!==(D=t.alpha)&&void 0!==D||(t.alpha=G.alpha)}beginTextureFill(t){const K={texture:a.gP.WHITE,color:16777215,matrix:null};t=Object.assign(K,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const D=t.alpha>0;return D?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:D},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,K,D,G){return this.drawShape(new a.M_(t,K,D,G))}drawRoundedRect(t,K,D,G,N){return this.drawShape(new a.TE(t,K,D,G,N))}drawCircle(t,K,D){return this.drawShape(new a.jl(t,K,D))}drawEllipse(t,K,D,G){return this.drawShape(new a.Pp(t,K,D,G))}drawPolygon(...t){let K,D=!0;const G=t[0];G.points?(D=G.closeStroke,K=G.points):K=Array.isArray(t[0])?t[0]:t;const N=new a.tS(K);return N.closeStroke=D,this.drawShape(N),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==a.HY.RECT||t[0].matrix||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const K=this._geometry;K.updateBatches(),K.batchable?(this.batchDirty!==K.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,K=this.blendMode,D=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=D,this.vertexData=new Float32Array(t.points);for(let G=0;G<D;G++){const D=t.batches[G],N=D.style.color,W=new Float32Array(this.vertexData.buffer,4*D.attribStart*2,2*D.attribSize),x=new Float32Array(t.uvsFloat32.buffer,4*D.attribStart*2,2*D.attribSize),b={vertexData:W,blendMode:K,indices:new Uint16Array(t.indicesUint16.buffer,2*D.start,D.size),uvs:x,_batchRGB:a.Q1.shared.setValue(N).toRgbArray(),_tintRGB:N,_texture:D.style.texture,alpha:D.style.alpha,worldAlpha:1};this.batches[G]=b}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let K=0,D=this.batches.length;K<D;K++){const D=this.batches[K];D.worldAlpha=this.worldAlpha*D.alpha,t.plugins[this.pluginName].render(D)}}}_renderDirect(t){const K=this._resolveDirectShader(t),D=this._geometry,G=this.worldAlpha,N=K.uniforms,W=D.drawCalls;N.translationMatrix=this.transform.worldTransform,a.Q1.shared.setValue(this._tintColor).premultiply(G).toArray(N.tint),t.shader.bind(K),t.geometry.bind(D,K),t.state.set(this.state);for(let K=0,a=W.length;K<a;K++)this._renderDrawCallDirect(t,D.drawCalls[K])}_renderDrawCallDirect(t,K){const{texArray:D,type:a,size:G,start:N}=K,W=D.count;for(let K=0;K<W;K++)t.texture.bind(D.elements[K],K);t.geometry.draw(a,G,N)}_resolveDirectShader(t){let K=this.shader;const D=this.pluginName;if(!K){if(!_[D]){const{maxTextures:K}=t.plugins[D],G=new Int32Array(K);for(let t=0;t<K;t++)G[t]=t;const N={tint:new Float32Array([1,1,1,1]),translationMatrix:new a.uq,default:a.k2.from({uSamplers:G},!0)},W=t.plugins[D]._shader.program;_[D]=new a.Mt(W,N)}K=_[D]}return K}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:K,minY:D,maxX:a,maxY:G}=t.bounds;this._bounds.addFrame(this.transform,K,D,a,G)}containsPoint(K){return this.worldTransform.applyInverse(K,t._TEMP_POINT),this._geometry.containsPoint(t._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const K=this.batches[t];K._tintRGB=a.Q1.shared.setValue(this._tintColor).multiply(K._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const K=this.transform.worldTransform,D=K.a,a=K.b,G=K.c,N=K.d,W=K.tx,x=K.ty,b=this._geometry.points,n=this.vertexData;let e=0;for(let t=0;t<b.length;t+=2){const K=b[t],i=b[t+1];n[e++]=D*K+G*i+W,n[e++]=N*i+a*K+x}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};C.curves=i,C._TEMP_POINT=new a.bR;let H=C},514842:(t,K,D)=>{D.d(K,{jl:()=>e,Td:()=>N,Pp:()=>i,uq:()=>Z,oA:()=>y,TO:()=>a,bR:()=>x,tS:()=>z,bO:()=>G,M_:()=>n,TE:()=>I,HY:()=>W,dL:()=>X,ER:()=>P});const a=2*Math.PI,G=180/Math.PI,N=Math.PI/180;var W=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(W||{});class x{constructor(t=0,K=0){this.x=0,this.y=0,this.x=t,this.y=K}clone(){return new x(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,K=t){return this.x=t,this.y=K,this}}x.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const b=[new x,new x,new x,new x];class n{constructor(t=0,K=0,D=0,a=0){this.x=Number(t),this.y=Number(K),this.width=Number(D),this.height=Number(a),this.type=W.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new n(0,0,0,0)}clone(){return new n(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,K){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&K>=this.y&&K<this.y+this.height}intersects(t,K){if(!K){const K=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=K)return!1;const D=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>D}const D=this.left,a=this.right,G=this.top,N=this.bottom;if(a<=D||N<=G)return!1;const W=b[0].set(t.left,t.top),x=b[1].set(t.left,t.bottom),n=b[2].set(t.right,t.top),e=b[3].set(t.right,t.bottom);if(n.x<=W.x||x.y<=W.y)return!1;const i=Math.sign(K.a*K.d-K.b*K.c);if(0===i||(K.apply(W,W),K.apply(x,x),K.apply(n,n),K.apply(e,e),Math.max(W.x,x.x,n.x,e.x)<=D||Math.min(W.x,x.x,n.x,e.x)>=a||Math.max(W.y,x.y,n.y,e.y)<=G||Math.min(W.y,x.y,n.y,e.y)>=N))return!1;const z=i*(x.y-W.y),I=i*(W.x-x.x),Z=z*D+I*G,w=z*a+I*G,m=z*D+I*N,u=z*a+I*N;if(Math.max(Z,w,m,u)<=z*W.x+I*W.y||Math.min(Z,w,m,u)>=z*e.x+I*e.y)return!1;const d=i*(W.y-n.y),E=i*(n.x-W.x),l=d*D+E*G,Q=d*a+E*G,P=d*D+E*N,y=d*a+E*N;return!(Math.max(l,Q,P,y)<=d*W.x+E*W.y||Math.min(l,Q,P,y)>=d*e.x+E*e.y)}pad(t=0,K=t){return this.x-=t,this.y-=K,this.width+=2*t,this.height+=2*K,this}fit(t){const K=Math.max(this.x,t.x),D=Math.min(this.x+this.width,t.x+t.width),a=Math.max(this.y,t.y),G=Math.min(this.y+this.height,t.y+t.height);return this.x=K,this.width=Math.max(D-K,0),this.y=a,this.height=Math.max(G-a,0),this}ceil(t=1,K=.001){const D=Math.ceil((this.x+this.width-K)*t)/t,a=Math.ceil((this.y+this.height-K)*t)/t;return this.x=Math.floor((this.x+K)*t)/t,this.y=Math.floor((this.y+K)*t)/t,this.width=D-this.x,this.height=a-this.y,this}enlarge(t){const K=Math.min(this.x,t.x),D=Math.max(this.x+this.width,t.x+t.width),a=Math.min(this.y,t.y),G=Math.max(this.y+this.height,t.y+t.height);return this.x=K,this.width=D-K,this.y=a,this.height=G-a,this}}n.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class e{constructor(t=0,K=0,D=0){this.x=t,this.y=K,this.radius=D,this.type=W.CIRC}clone(){return new e(this.x,this.y,this.radius)}contains(t,K){if(this.radius<=0)return!1;const D=this.radius*this.radius;let a=this.x-t,G=this.y-K;return a*=a,G*=G,a+G<=D}getBounds(){return new n(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}e.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class i{constructor(t=0,K=0,D=0,a=0){this.x=t,this.y=K,this.width=D,this.height=a,this.type=W.ELIP}clone(){return new i(this.x,this.y,this.width,this.height)}contains(t,K){if(this.width<=0||this.height<=0)return!1;let D=(t-this.x)/this.width,a=(K-this.y)/this.height;return D*=D,a*=a,D+a<=1}getBounds(){return new n(this.x-this.width,this.y-this.height,this.width,this.height)}}i.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class z{constructor(...t){let K=Array.isArray(t[0])?t[0]:t;if("number"!=typeof K[0]){const t=[];for(let D=0,a=K.length;D<a;D++)t.push(K[D].x,K[D].y);K=t}this.points=K,this.type=W.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),K=new z(t);return K.closeStroke=this.closeStroke,K}contains(t,K){let D=!1;const a=this.points.length/2;for(let G=0,N=a-1;G<a;N=G++){const a=this.points[2*G],W=this.points[2*G+1],x=this.points[2*N],b=this.points[2*N+1];W>K!=b>K&&t<(x-a)*((K-W)/(b-W))+a&&(D=!D)}return D}}z.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce(((t,K)=>`${t}, ${K}`),"")}]`};class I{constructor(t=0,K=0,D=0,a=0,G=20){this.x=t,this.y=K,this.width=D,this.height=a,this.radius=G,this.type=W.RREC}clone(){return new I(this.x,this.y,this.width,this.height,this.radius)}contains(t,K){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&K>=this.y&&K<=this.y+this.height){const D=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(K>=this.y+D&&K<=this.y+this.height-D||t>=this.x+D&&t<=this.x+this.width-D)return!0;let a=t-(this.x+D),G=K-(this.y+D);const N=D*D;if(a*a+G*G<=N||(a=t-(this.x+this.width-D),a*a+G*G<=N)||(G=K-(this.y+this.height-D),a*a+G*G<=N)||(a=t-(this.x+D),a*a+G*G<=N))return!0}return!1}}I.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Z{constructor(t=1,K=0,D=0,a=1,G=0,N=0){this.array=null,this.a=t,this.b=K,this.c=D,this.d=a,this.tx=G,this.ty=N}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,K,D,a,G,N){return this.a=t,this.b=K,this.c=D,this.d=a,this.tx=G,this.ty=N,this}toArray(t,K){this.array||(this.array=new Float32Array(9));const D=K||this.array;return t?(D[0]=this.a,D[1]=this.b,D[2]=0,D[3]=this.c,D[4]=this.d,D[5]=0,D[6]=this.tx,D[7]=this.ty,D[8]=1):(D[0]=this.a,D[1]=this.c,D[2]=this.tx,D[3]=this.b,D[4]=this.d,D[5]=this.ty,D[6]=0,D[7]=0,D[8]=1),D}apply(t,K){K=K||new x;const D=t.x,a=t.y;return K.x=this.a*D+this.c*a+this.tx,K.y=this.b*D+this.d*a+this.ty,K}applyInverse(t,K){K=K||new x;const D=1/(this.a*this.d+this.c*-this.b),a=t.x,G=t.y;return K.x=this.d*D*a+-this.c*D*G+(this.ty*this.c-this.tx*this.d)*D,K.y=this.a*D*G+-this.b*D*a+(-this.ty*this.a+this.tx*this.b)*D,K}translate(t,K){return this.tx+=t,this.ty+=K,this}scale(t,K){return this.a*=t,this.d*=K,this.c*=t,this.b*=K,this.tx*=t,this.ty*=K,this}rotate(t){const K=Math.cos(t),D=Math.sin(t),a=this.a,G=this.c,N=this.tx;return this.a=a*K-this.b*D,this.b=a*D+this.b*K,this.c=G*K-this.d*D,this.d=G*D+this.d*K,this.tx=N*K-this.ty*D,this.ty=N*D+this.ty*K,this}append(t){const K=this.a,D=this.b,a=this.c,G=this.d;return this.a=t.a*K+t.b*a,this.b=t.a*D+t.b*G,this.c=t.c*K+t.d*a,this.d=t.c*D+t.d*G,this.tx=t.tx*K+t.ty*a+this.tx,this.ty=t.tx*D+t.ty*G+this.ty,this}setTransform(t,K,D,a,G,N,W,x,b){return this.a=Math.cos(W+b)*G,this.b=Math.sin(W+b)*G,this.c=-Math.sin(W-x)*N,this.d=Math.cos(W-x)*N,this.tx=t-(D*this.a+a*this.c),this.ty=K-(D*this.b+a*this.d),this}prepend(t){const K=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){const K=this.a,D=this.c;this.a=K*t.a+this.b*t.c,this.b=K*t.b+this.b*t.d,this.c=D*t.a+this.d*t.c,this.d=D*t.b+this.d*t.d}return this.tx=K*t.a+this.ty*t.c+t.tx,this.ty=K*t.b+this.ty*t.d+t.ty,this}decompose(t){const K=this.a,D=this.b,G=this.c,N=this.d,W=t.pivot,x=-Math.atan2(-G,N),b=Math.atan2(D,K),n=Math.abs(x+b);return n<1e-5||Math.abs(a-n)<1e-5?(t.rotation=b,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=x,t.skew.y=b),t.scale.x=Math.sqrt(K*K+D*D),t.scale.y=Math.sqrt(G*G+N*N),t.position.x=this.tx+(W.x*K+W.y*G),t.position.y=this.ty+(W.x*D+W.y*N),t}invert(){const t=this.a,K=this.b,D=this.c,a=this.d,G=this.tx,N=t*a-K*D;return this.a=a/N,this.b=-K/N,this.c=-D/N,this.d=t/N,this.tx=(D*this.ty-a*G)/N,this.ty=-(t*this.ty-K*G)/N,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Z;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}static get IDENTITY(){return new Z}static get TEMP_MATRIX(){return new Z}}Z.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const w=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],m=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],u=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],d=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],E=[],l=[],Q=Math.sign;(function(){for(let t=0;t<16;t++){const K=[];E.push(K);for(let D=0;D<16;D++){const a=Q(w[t]*w[D]+u[t]*m[D]),G=Q(m[t]*w[D]+d[t]*m[D]),N=Q(w[t]*u[D]+u[t]*d[D]),W=Q(m[t]*u[D]+d[t]*d[D]);for(let t=0;t<16;t++)if(w[t]===a&&m[t]===G&&u[t]===N&&d[t]===W){K.push(t);break}}}for(let t=0;t<16;t++){const K=new Z;K.set(w[t],m[t],u[t],d[t],0,0),l.push(K)}})();const P={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>w[t],uY:t=>m[t],vX:t=>u[t],vY:t=>d[t],inv:t=>8&t?15&t:7&-t,add:(t,K)=>E[t][K],sub:(t,K)=>E[t][P.inv(K)],rotate180:t=>4^t,isVertical:t=>2==(3&t),byDirection:(t,K)=>2*Math.abs(t)<=Math.abs(K)?K>=0?P.S:P.N:2*Math.abs(K)<=Math.abs(t)?t>0?P.E:P.W:K>0?t>0?P.SE:P.SW:t>0?P.NE:P.NW,matrixAppendRotationInv:(t,K,D=0,a=0)=>{const G=l[P.inv(K)];G.tx=D,G.ty=a,t.append(G)}};class y{constructor(t,K,D=0,a=0){this._x=D,this._y=a,this.cb=t,this.scope=K}clone(t=this.cb,K=this.scope){return new y(t,K,this._x,this._y)}set(t=0,K=t){return(this._x!==t||this._y!==K)&&(this._x=t,this._y=K,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}y.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const q=class{constructor(){this.worldTransform=new Z,this.localTransform=new Z,this.position=new y(this.onChange,this,0,0),this.scale=new y(this.onChange,this,1,1),this.pivot=new y(this.onChange,this,0,0),this.skew=new y(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const K=this.localTransform;if(this._localID!==this._currentLocalID&&(K.a=this._cx*this.scale.x,K.b=this._sx*this.scale.x,K.c=this._cy*this.scale.y,K.d=this._sy*this.scale.y,K.tx=this.position.x-(this.pivot.x*K.a+this.pivot.y*K.c),K.ty=this.position.y-(this.pivot.x*K.b+this.pivot.y*K.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const D=t.worldTransform,a=this.worldTransform;a.a=K.a*D.a+K.b*D.c,a.b=K.a*D.b+K.b*D.d,a.c=K.c*D.a+K.d*D.c,a.d=K.c*D.b+K.d*D.d,a.tx=K.tx*D.a+K.ty*D.c+D.tx,a.ty=K.tx*D.b+K.ty*D.d+D.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};q.IDENTITY=new q;let X=q;X.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}},209218:(t,K,D)=>{var a=D(401947);a.u,a.u,D(316197),a.e,a.e,a.e},401947:(t,K,D)=>{D.d(K,{e:()=>n,u:()=>e,PX:()=>I});var a=D(316197),G=D(110715);class N{constructor(t,K){this.uvBuffer=t,this.uvMatrix=K,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const K=this.uvBuffer.data;(!this.data||this.data.length!==K.length)&&(this.data=new Float32Array(K.length)),this.uvMatrix.multiplyUvs(K,this.data),this._updateID++}}const W=new a.bR,x=new a.tS,b=class t extends G.mc{constructor(t,K,D,G=a._4.TRIANGLES){super(),this.geometry=t,this.shader=K,this.state=D||a.Uw.for2d(),this.drawMode=G,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=a.W0.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(K){const D=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===a._4.TRIANGLES&&D.length<2*t.BATCHABLE_SIZE?this._renderToBatch(K):this._renderDefault(K)}_renderDefault(t){const K=this.shader;K.alpha=this.worldAlpha,K.update&&K.update(),t.batch.flush(),K.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(K),t.state.set(this.state),t.geometry.bind(this.geometry,K),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const K=this.geometry,D=this.shader;D.uvMatrix&&(D.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=K.indexBuffer.data,this._tintRGB=D._tintRGB,this._texture=D.texture;const a=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[a]),t.plugins[a].render(this)}calculateVertices(){const t=this.geometry.buffers[0],K=t.data,D=t._updateID;if(D===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==K.length&&(this.vertexData=new Float32Array(K.length));const G=this.transform.worldTransform,N=G.a,W=G.b,x=G.c,b=G.d,n=G.tx,e=G.ty,i=this.vertexData;for(let t=0;t<i.length/2;t++){const D=K[2*t],a=K[2*t+1];i[2*t]=N*D+x*a+n,i[2*t+1]=W*D+b*a+e}if(this._roundPixels){const t=a.W0.RESOLUTION;for(let K=0;K<i.length;++K)i[K]=Math.round(i[K]*t)/t}this.vertexDirty=D}calculateUvs(){const t=this.geometry.buffers[1],K=this.shader;K.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new N(t,K.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,W);const K=this.geometry.getBuffer("aVertexPosition").data,D=x.points,a=this.geometry.getIndex().data,G=a.length,N=4===this.drawMode?3:1;for(let t=0;t+2<G;t+=N){const G=2*a[t],N=2*a[t+1],b=2*a[t+2];if(D[0]=K[G],D[1]=K[G+1],D[2]=K[N],D[3]=K[N+1],D[4]=K[b],D[5]=K[b+1],x.contains(W.x,W.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};b.BATCHABLE_SIZE=100;let n=b;class e extends a.V2{constructor(t,K,D){super();const G=new a.hp(t),N=new a.hp(K,!0),W=new a.hp(D,!0,!0);this.addAttribute("aVertexPosition",G,2,!1,a.QE.FLOAT).addAttribute("aTextureCoord",N,2,!1,a.QE.FLOAT).addIndex(W),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var i=`varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n`,z=`attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n`;class I extends a.Mt{constructor(t,K){const D={uSampler:t,alpha:1,uTextureMatrix:a.uq.IDENTITY,uColor:new Float32Array([1,1,1,1])};(K=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},K)).uniforms&&Object.assign(D,K.uniforms),super(K.program||a.BP.from(z,i),D),this._colorDirty=!1,this.uvMatrix=new a.NW(t),this.batchable=void 0===K.program,this.pluginName=K.pluginName,this._tintColor=new a.Q1(K.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=K.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture.alphaMode;a.Q1.shared.setValue(this._tintColor).premultiply(this._alpha,t).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}},344944:(t,K,D)=>{var a=D(316197),G=D(110715),N=D(722711);class W{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function x(t,K){var D;let G=!1;if(null===(D=null==t?void 0:t._textures)||void 0===D?void 0:D.length)for(let D=0;D<t._textures.length;D++)if(t._textures[D]instanceof a.gP){const a=t._textures[D].baseTexture;K.includes(a)||(K.push(a),G=!0)}return G}function b(t,K){if(t.baseTexture instanceof a.t5){const D=t.baseTexture;return K.includes(D)||K.push(D),!0}return!1}function n(t,K){if(t._texture&&t._texture instanceof a.gP){const D=t._texture.baseTexture;return K.includes(D)||K.push(D),!0}return!1}function e(t,K){return K instanceof N.EY&&(K.updateText(!0),!0)}function i(t,K){if(K instanceof N.xJ){const t=K.toFontString();return N.Z1.measureFont(t),!0}return!1}function z(t,K){if(t instanceof N.EY){K.includes(t.style)||K.push(t.style),K.includes(t)||K.push(t);const D=t._texture.baseTexture;return K.includes(D)||K.push(D),!0}return!1}function I(t,K){return t instanceof N.xJ&&(K.includes(t)||K.push(t),!0)}const Z=class t{constructor(K){this.limiter=new W(t.uploadsPerFrame),this.renderer=K,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(z),this.registerFindHook(I),this.registerFindHook(x),this.registerFindHook(b),this.registerFindHook(n),this.registerUploadHook(e),this.registerUploadHook(i)}upload(t){return new Promise((K=>{t&&this.add(t),this.queue.length?(this.completes.push(K),this.ticking||(this.ticking=!0,a.Rv.system.addOnce(this.tick,this,a.dQ.UTILITY))):K()}))}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let K=!1;if(t&&!t._destroyed)for(let D=0,a=this.uploadHooks.length;D<a;D++)if(this.uploadHooks[D](this.uploadHookHelper,t)){this.queue.shift(),K=!0;break}K||this.queue.shift()}if(this.queue.length)a.Rv.system.addOnce(this.tick,this,a.dQ.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let K=0,D=t.length;K<D;K++)t[K]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let K=0,D=this.addHooks.length;K<D&&!this.addHooks[K](t,this.queue);K++);if(t instanceof G.mc)for(let K=t.children.length-1;K>=0;K--)this.add(t.children[K]);return this}destroy(){this.ticking&&a.Rv.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};Z.uploadsPerFrame=4;let w=Z;Object.defineProperties(a.W0,{UPLOADS_PER_FRAME:{get:()=>w.uploadsPerFrame,set(t){a.Wp.deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),w.uploadsPerFrame=t}}});var m=D(366628);function u(t,K){return K instanceof a.t5&&(K._glTextures[t.CONTEXT_UID]||t.texture.bind(K),!0)}function d(t,K){if(!(K instanceof m.A1))return!1;const{geometry:D}=K;K.finishPoly(),D.updateBatches();const{batches:a}=D;for(let K=0;K<a.length;K++){const{texture:D}=a[K].style;D&&u(t,D.baseTexture)}return D.batchable||t.geometry.bind(D,K._resolveDirectShader(t)),!0}function E(t,K){return t instanceof m.A1&&(K.push(t),!0)}class l extends w{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(E),this.registerUploadHook(u),this.registerUploadHook(d)}}l.extension={name:"prepare",type:a.Ag.RendererSystem},a.XO.add(l)},968381:(t,K,D)=>{D.d(K,{Fr:()=>y,W0:()=>G});const a={createCanvas:(t,K)=>{const D=document.createElement("canvas");return D.width=t,D.height=K,D},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>{var t;return null!==(t=document.baseURI)&&void 0!==t?t:window.location.href},getFontFaceSet:()=>document.fonts,fetch:(t,K)=>fetch(t,K),parseXML:t=>(new DOMParser).parseFromString(t,"text/xml")},G={ADAPTER:a,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var N,W=/iPhone/i,x=/iPod/i,b=/iPad/i,n=/\biOS-universal(?:.+)Mac\b/i,e=/\bAndroid(?:.+)Mobile\b/i,i=/Android/i,z=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,I=/Silk/i,Z=/Windows Phone/i,w=/\bWindows(?:.+)ARM\b/i,m=/BlackBerry/i,u=/BB10/i,d=/Opera Mini/i,E=/\b(CriOS|Chrome)(?:.+)Mobile/i,l=/Mobile(?:.+)Firefox\b/i,Q=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};function P(t){var K={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?K.userAgent=t:t&&t.userAgent&&(K={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):K={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var D=K.userAgent,a=D.split("[FBAN");void 0!==a[1]&&(D=a[0]),void 0!==(a=D.split("Twitter"))[1]&&(D=a[0]);var G=function(t){return function(K){return K.test(t)}}(D),N={apple:{phone:G(W)&&!G(Z),ipod:G(x),tablet:!G(W)&&(G(b)||Q(K))&&!G(Z),universal:G(n),device:(G(W)||G(x)||G(b)||G(n)||Q(K))&&!G(Z)},amazon:{phone:G(z),tablet:!G(z)&&G(I),device:G(z)||G(I)},android:{phone:!G(Z)&&G(z)||!G(Z)&&G(e),tablet:!G(Z)&&!G(z)&&!G(e)&&(G(I)||G(i)),device:!G(Z)&&(G(z)||G(I)||G(e)||G(i))||G(/\bokhttp\b/i)},windows:{phone:G(Z),tablet:G(w),device:G(Z)||G(w)},other:{blackberry:G(m),blackberry10:G(u),opera:G(d),firefox:G(l),chrome:G(E),device:G(m)||G(u)||G(d)||G(l)||G(E)},any:!1,phone:!1,tablet:!1};return N.any=N.apple.device||N.android.device||N.windows.device||N.other.device,N.phone=N.apple.phone||N.android.phone||N.windows.phone,N.tablet=N.apple.tablet||N.android.tablet||N.windows.tablet,N}const y=(null!==(N=P["default"])&&void 0!==N?N:P)(globalThis.navigator)},672076:(t,K,D)=>{D.d(K,{k:()=>x});var a=D(316197),G=D(110715);const N=new a.bR,W=new Uint16Array([0,1,2,0,2,3]);class x extends G.mc{constructor(t){super(),this._anchor=new a.oA(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new a.Q1(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=a.B9.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||a.gP.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=W,this.pluginName="batch",this.isSprite=!0,this._roundPixels=a.W0.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=a.Wp.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=a.Wp.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const K=this.transform.worldTransform,D=K.a,G=K.b,N=K.c,W=K.d,x=K.tx,b=K.ty,n=this.vertexData,e=t.trim,i=t.orig,z=this._anchor;let I=0,Z=0,w=0,m=0;if(e?(Z=e.x-z._x*i.width,I=Z+e.width,m=e.y-z._y*i.height,w=m+e.height):(Z=-z._x*i.width,I=Z+i.width,m=-z._y*i.height,w=m+i.height),n[0]=D*Z+N*m+x,n[1]=W*m+G*Z+b,n[2]=D*I+N*m+x,n[3]=W*m+G*I+b,n[4]=D*I+N*w+x,n[5]=W*w+G*I+b,n[6]=D*Z+N*w+x,n[7]=W*w+G*Z+b,this._roundPixels){const t=a.W0.RESOLUTION;for(let K=0;K<n.length;++K)n[K]=Math.round(n[K]*t)/t}}calculateTrimmedVertices(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,K=this.vertexTrimmedData,D=t.orig,G=this._anchor,N=this.transform.worldTransform,W=N.a,x=N.b,b=N.c,n=N.d,e=N.tx,i=N.ty,z=-G._x*D.width,I=z+D.width,Z=-G._y*D.height,w=Z+D.height;if(K[0]=W*z+b*Z+e,K[1]=n*Z+x*z+i,K[2]=W*I+b*Z+e,K[3]=n*Z+x*I+i,K[4]=W*I+b*w+e,K[5]=n*w+x*I+i,K[6]=W*z+b*w+e,K[7]=n*w+x*z+i,this._roundPixels){const t=a.W0.RESOLUTION;for(let D=0;D<K.length;++D)K[D]=Math.round(K[D]*t)/t}}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,K=this._texture.orig;!t||t.width===K.width&&t.height===K.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return 0===this.children.length?(this._localBounds||(this._localBounds=new G.cz),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new a.M_),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,N);const K=this._texture.orig.width,D=this._texture.orig.height,a=-K*this.anchor.x;let G=0;return N.x>=a&&N.x<a+K&&(G=-D*this.anchor.y,N.y>=G&&N.y<G+D)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof t?t:null==t?void 0:t.texture){const K="boolean"==typeof t?t:null==t?void 0:t.baseTexture;this._texture.destroy(!!K)}this._texture=null}static from(t,K){const D=t instanceof a.gP?t:a.gP.from(t,K);return new x(D)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const K=a.Wp.sign(this.scale.x)||1;this.scale.x=K*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const K=a.Wp.sign(this.scale.y)||1;this.scale.y=K*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||a.gP.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}},722711:(t,K,D)=>{D.d(K,{T:()=>a,EY:()=>m,Z1:()=>b,xJ:()=>i});var a=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(a||{}),G=D(316197),N=D(672076);const W={willReadFrequently:!0},x=class t{static get experimentalLetterSpacingSupported(){let K=t._experimentalLetterSpacingSupported;if(void 0!==K){const D=G.W0.ADAPTER.getCanvasRenderingContext2D().prototype;K=t._experimentalLetterSpacingSupported="letterSpacing"in D||"textLetterSpacing"in D}return K}constructor(t,K,D,a,G,N,W,x,b){this.text=t,this.style=K,this.width=D,this.height=a,this.lines=G,this.lineWidths=N,this.lineHeight=W,this.maxLineWidth=x,this.fontProperties=b}static measureText(K,D,a,G=t._canvas){a=null!=a?a:D.wordWrap;const N=D.toFontString(),x=t.measureFont(N);0===x.fontSize&&(x.fontSize=D.fontSize,x.ascent=D.fontSize);const b=G.getContext("2d",W);b.font=N;const n=(a?t.wordWrap(K,D,G):K).split(/(?:\r\n|\r|\n)/),e=new Array(n.length);let i=0;for(let K=0;K<n.length;K++){const a=t._measureText(n[K],D.letterSpacing,b);e[K]=a,i=Math.max(i,a)}let z=i+D.strokeThickness;D.dropShadow&&(z+=D.dropShadowDistance);const I=D.lineHeight||x.fontSize+D.strokeThickness;let Z=Math.max(I,x.fontSize+2*D.strokeThickness)+D.leading+(n.length-1)*(I+D.leading);return D.dropShadow&&(Z+=D.dropShadowDistance),new t(K,D,z,Z,n,e,I+D.leading,i,x)}static _measureText(K,D,a){let G=!1;t.experimentalLetterSpacingSupported&&(t.experimentalLetterSpacing?(a.letterSpacing=`${D}px`,a.textLetterSpacing=`${D}px`,G=!0):(a.letterSpacing="0px",a.textLetterSpacing="0px"));let N=a.measureText(K).width;return N>0&&(G?N-=D:N+=(t.graphemeSegmenter(K).length-1)*D),N}static wordWrap(K,D,a=t._canvas){const G=a.getContext("2d",W);let N=0,x="",b="";const n=Object.create(null),{letterSpacing:e,whiteSpace:i}=D,z=t.collapseSpaces(i),I=t.collapseNewlines(i);let Z=!z;const w=D.wordWrapWidth+e,m=t.tokenize(K);for(let K=0;K<m.length;K++){let a=m[K];if(t.isNewline(a)){if(!I){b+=t.addLine(x),Z=!z,x="",N=0;continue}a=" "}if(z){const K=t.isBreakingSpace(a),D=t.isBreakingSpace(x[x.length-1]);if(K&&D)continue}const W=t.getFromCache(a,e,n,G);if(W>w)if(""!==x&&(b+=t.addLine(x),x="",N=0),t.canBreakWords(a,D.breakWords)){const K=t.wordWrapSplit(a);for(let W=0;W<K.length;W++){let i=K[W],z=i,I=1;for(;K[W+I];){const G=K[W+I];if(t.canBreakChars(z,G,a,W,D.breakWords))break;i+=G,z=G,I++}W+=I-1;const m=t.getFromCache(i,e,n,G);m+N>w&&(b+=t.addLine(x),Z=!1,x="",N=0),x+=i,N+=m}}else{x.length>0&&(b+=t.addLine(x),x="",N=0);const D=K===m.length-1;b+=t.addLine(a,!D),Z=!1,x="",N=0}else W+N>w&&(Z=!1,b+=t.addLine(x),x="",N=0),(x.length>0||!t.isBreakingSpace(a)||Z)&&(x+=a,N+=W)}return b+=t.addLine(x,!1),b}static addLine(K,D=!0){return K=t.trimRight(K),D?`${K}\n`:K}static getFromCache(K,D,a,G){let N=a[K];return"number"!=typeof N&&(N=t._measureText(K,D,G)+D,a[K]=N),N}static collapseSpaces(t){return"normal"===t||"pre-line"===t}static collapseNewlines(t){return"normal"===t}static trimRight(K){if("string"!=typeof K)return"";for(let D=K.length-1;D>=0;D--){const a=K[D];if(!t.isBreakingSpace(a))break;K=K.slice(0,-1)}return K}static isNewline(K){return"string"==typeof K&&t._newlines.includes(K.charCodeAt(0))}static isBreakingSpace(K,D){return"string"==typeof K&&t._breakingSpaces.includes(K.charCodeAt(0))}static tokenize(K){const D=[];let a="";if("string"!=typeof K)return D;for(let G=0;G<K.length;G++){const N=K[G],W=K[G+1];t.isBreakingSpace(N,W)||t.isNewline(N)?(""!==a&&(D.push(a),a=""),D.push(N)):a+=N}return""!==a&&D.push(a),D}static canBreakWords(t,K){return K}static canBreakChars(t,K,D,a,G){return!0}static wordWrapSplit(K){return t.graphemeSegmenter(K)}static measureFont(K){if(t._fonts[K])return t._fonts[K];const D={ascent:0,descent:0,fontSize:0},a=t._canvas,G=t._context;G.font=K;const N=t.METRICS_STRING+t.BASELINE_SYMBOL,W=Math.ceil(G.measureText(N).width);let x=Math.ceil(G.measureText(t.BASELINE_SYMBOL).width);const b=Math.ceil(t.HEIGHT_MULTIPLIER*x);if(x=x*t.BASELINE_MULTIPLIER|0,0===W||0===b)return t._fonts[K]=D,D;a.width=W,a.height=b,G.fillStyle="#f00",G.fillRect(0,0,W,b),G.font=K,G.textBaseline="alphabetic",G.fillStyle="#000",G.fillText(N,0,x);const n=G.getImageData(0,0,W,b).data,e=n.length,i=4*W;let z=0,I=0,Z=!1;for(z=0;z<x;++z){for(let t=0;t<i;t+=4)if(255!==n[I+t]){Z=!0;break}if(Z)break;I+=i}for(D.ascent=x-z,I=e-i,Z=!1,z=b;z>x;--z){for(let t=0;t<i;t+=4)if(255!==n[I+t]){Z=!0;break}if(Z)break;I-=i}return D.descent=z-x,D.fontSize=D.ascent+D.descent,t._fonts[K]=D,D}static clearMetrics(K=""){K?delete t._fonts[K]:t._fonts={}}static get _canvas(){var K;if(!t.__canvas){let D;try{const a=new OffscreenCanvas(0,0);if(null===(K=a.getContext("2d",W))||void 0===K?void 0:K.measureText)return t.__canvas=a,a;D=G.W0.ADAPTER.createCanvas()}catch(t){D=G.W0.ADAPTER.createCanvas()}D.width=D.height=10,t.__canvas=D}return t.__canvas}static get _context(){return t.__context||(t.__context=t._canvas.getContext("2d",W)),t.__context}};x.METRICS_STRING="|ÉqÅ",x.BASELINE_SYMBOL="M",x.BASELINE_MULTIPLIER=1.4,x.HEIGHT_MULTIPLIER=2,x.graphemeSegmenter=(()=>{if("function"==typeof(null===Intl||void 0===Intl?void 0:Intl.Segmenter)){const t=new Intl.Segmenter;return K=>[...t.segment(K)].map((t=>t.segment))}return t=>[...t]})(),x.experimentalLetterSpacing=!1,x._fonts={},x._newlines=[10,13],x._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let b=x;const n=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],e=class t{constructor(t){this.styleID=0,this.reset(),I(this,t,t)}clone(){const K={};return I(K,this,t.defaultStyle),new t(K)}reset(){I(this,t.defaultStyle,t.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const K=z(t);this._dropShadowColor!==K&&(this._dropShadowColor=K,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const K=z(t);this._fill!==K&&(this._fill=K,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){(function(t,K){if(!Array.isArray(t)||!Array.isArray(K)||t.length!==K.length)return!1;for(let D=0;D<t.length;++D)if(t[D]!==K[D])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const K=z(t);this._stroke!==K&&(this._stroke=K,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t="number"==typeof this.fontSize?`${this.fontSize}px`:this.fontSize;let K=this.fontFamily;Array.isArray(this.fontFamily)||(K=this.fontFamily.split(","));for(let t=K.length-1;t>=0;t--){let D=K[t].trim();!/([\"\'])[^\'\"]+\1/.test(D)&&!n.includes(D)&&(D=`"${D}"`),K[t]=D}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${K.join(",")}`}};e.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:a.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let i=e;function z(t){const K=G.Q1.shared,D=t=>{const D=K.setValue(t);return 1===D.alpha?D.toHex():D.toRgbaString()};return Array.isArray(t)?t.map(D):D(t)}function I(t,K,D){for(const a in D)Array.isArray(K[a])?t[a]=K[a].slice():t[a]=K[a]}const Z={texture:!0,children:!1,baseTexture:!0},w=class t extends N.k{constructor(K,D,a){var N;let W=!1;a||(a=G.W0.ADAPTER.createCanvas(),W=!0),a.width=3,a.height=3;const x=G.gP.from(a);x.orig=new G.M_,x.trim=new G.M_,super(x),this._ownCanvas=W,this.canvas=a,this.context=a.getContext("2d",{willReadFrequently:!0}),this._resolution=null!==(N=t.defaultResolution)&&void 0!==N?N:G.W0.RESOLUTION,this._autoResolution=t.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=K,this.style=D,this.localStyleID=-1}static get experimentalLetterSpacing(){return b.experimentalLetterSpacing}static set experimentalLetterSpacing(t){G.Wp.deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),b.experimentalLetterSpacing=t}updateText(t){const K=this._style;if(this.localStyleID!==K.styleID&&(this.dirty=!0,this.localStyleID=K.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const D=this.context,a=b.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),N=a.width,W=a.height,x=a.lines,n=a.lineHeight,e=a.lineWidths,i=a.maxLineWidth,z=a.fontProperties;let I,Z;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,N)+2*K.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,W)+2*K.padding)*this._resolution),D.scale(this._resolution,this._resolution),D.clearRect(0,0,this.canvas.width,this.canvas.height),D.font=this._font,D.lineWidth=K.strokeThickness,D.textBaseline=K.textBaseline,D.lineJoin=K.lineJoin,D.miterLimit=K.miterLimit;const w=K.dropShadow?2:1;for(let t=0;t<w;++t){const N=K.dropShadow&&0===t,b=N?Math.ceil(Math.max(1,W)+2*K.padding):0,w=b*this._resolution;if(N){D.fillStyle="black",D.strokeStyle="black";const t=K.dropShadowColor,a=K.dropShadowBlur*this._resolution,N=K.dropShadowDistance*this._resolution;D.shadowColor=G.Q1.shared.setValue(t).setAlpha(K.dropShadowAlpha).toRgbaString(),D.shadowBlur=a,D.shadowOffsetX=Math.cos(K.dropShadowAngle)*N,D.shadowOffsetY=Math.sin(K.dropShadowAngle)*N+w}else D.fillStyle=this._generateFillStyle(K,x,a),D.strokeStyle=K.stroke,D.shadowColor="black",D.shadowBlur=0,D.shadowOffsetX=0,D.shadowOffsetY=0;let m=(n-z.fontSize)/2;n-z.fontSize<0&&(m=0);for(let t=0;t<x.length;t++)I=K.strokeThickness/2,Z=K.strokeThickness/2+t*n+z.ascent+m,"right"===K.align?I+=i-e[t]:"center"===K.align&&(I+=(i-e[t])/2),K.stroke&&K.strokeThickness&&this.drawLetterSpacing(x[t],I+K.padding,Z+K.padding-b,!0),K.fill&&this.drawLetterSpacing(x[t],I+K.padding,Z+K.padding-b)}this.updateTexture()}drawLetterSpacing(t,K,D,a=!1){const G=this._style.letterSpacing;let N=!1;if(b.experimentalLetterSpacingSupported&&(b.experimentalLetterSpacing?(this.context.letterSpacing=`${G}px`,this.context.textLetterSpacing=`${G}px`,N=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),0===G||N)return void(a?this.context.strokeText(t,K,D):this.context.fillText(t,K,D));let W=K;const x=b.graphemeSegmenter(t);let n=this.context.measureText(t).width,e=0;for(let t=0;t<x.length;++t){const K=x[t];a?this.context.strokeText(K,W,D):this.context.fillText(K,W,D);let N="";for(let K=t+1;K<x.length;++K)N+=x[K];e=this.context.measureText(N).width,W+=n-e+G,n=e}}updateTexture(){const t=this.canvas;if(this._style.trim){const K=G.Wp.trimCanvas(t);K.data&&(t.width=K.width,t.height=K.height,this.context.putImageData(K.data,0,0))}const K=this._texture,D=this._style,a=D.trim?0:D.padding,N=K.baseTexture;K.trim.width=K._frame.width=t.width/this._resolution,K.trim.height=K._frame.height=t.height/this._resolution,K.trim.x=-a,K.trim.y=-a,K.orig.width=K._frame.width-2*a,K.orig.height=K._frame.height-2*a,this._onTextureUpdate(),N.setRealSize(t.width,t.height,this._resolution),K.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,K){return this.updateText(!0),-1===this._textureID&&(t=!1),super.getBounds(t,K)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,K,D){const G=t.fill;if(!Array.isArray(G))return G;if(1===G.length)return G[0];let N;const W=t.dropShadow?t.dropShadowDistance:0,x=t.padding||0,b=this.canvas.width/this._resolution-W-2*x,n=this.canvas.height/this._resolution-W-2*x,e=G.slice(),i=t.fillGradientStops.slice();if(!i.length){const t=e.length+1;for(let K=1;K<t;++K)i.push(K/t)}if(e.unshift(G[0]),i.unshift(0),e.push(G[G.length-1]),i.push(1),t.fillGradientType===a.LINEAR_VERTICAL){N=this.context.createLinearGradient(b/2,x,b/2,n+x);const a=D.fontProperties.fontSize+t.strokeThickness;for(let t=0;t<K.length;t++){const G=D.lineHeight*(t-1)+a,W=D.lineHeight*t;let x=W;t>0&&G>W&&(x=(W+G)/2);const b=W+a,z=D.lineHeight*(t+1);let I=b;t+1<K.length&&z<b&&(I=(b+z)/2);const Z=(I-x)/n;for(let t=0;t<e.length;t++){let K=0;K="number"==typeof i[t]?i[t]:t/e.length;let D=Math.min(1,Math.max(0,x/n+K*Z));D=Number(D.toFixed(5)),N.addColorStop(D,e[t])}}}else{N=this.context.createLinearGradient(x,n/2,b+x,n/2);const t=e.length+1;let K=1;for(let D=0;D<e.length;D++){let a;a="number"==typeof i[D]?i[D]:K/t,N.addColorStop(a,e[D]),K++}}return N}destroy(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},Z,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const K=G.Wp.sign(this.scale.x)||1;this.scale.x=K*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const K=G.Wp.sign(this.scale.y)||1;this.scale.y=K*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},this._style=t instanceof i?t:new i(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(null!=t?t:""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};w.defaultAutoResolution=!0;let m=w},71931:(t,K,D)=>{D.d(K,{Rv:()=>b,dQ:()=>N});var a=D(968381),G=D(578351),N=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(N||{});class W{constructor(t,K=null,D=0,a=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=K,this.priority=D,this.once=a}match(t,K=null){return this.fn===t&&this.context===K}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const K=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),K}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const K=this.next;return this.next=t?null:K,this.previous=null,K}}const x=class t{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new W(null,null,1/0),this.deltaMS=1/t.targetFPMS,this.elapsedMS=1/t.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,K,D=N.NORMAL){return this._addListener(new W(t,K,D))}addOnce(t,K,D=N.NORMAL){return this._addListener(new W(t,K,D,!0))}_addListener(t){let K=this._head.next,D=this._head;if(K){for(;K;){if(t.priority>K.priority){t.connect(D);break}D=K,K=K.next}t.previous||t.connect(D)}else t.connect(D);return this._startIfPossible(),this}remove(t,K){let D=this._head.next;for(;D;)D=D.match(t,K)?D.destroy():D.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,K=this._head;for(;K=K.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(K=performance.now()){let D;if(K>this.lastTime){if(D=this.elapsedMS=K-this.lastTime,D>this._maxElapsedMS&&(D=this._maxElapsedMS),D*=this.speed,this._minElapsedMS){const t=K-this._lastFrame|0;if(t<this._minElapsedMS)return;this._lastFrame=K-t%this._minElapsedMS}this.deltaMS=D,this.deltaTime=this.deltaMS*t.targetFPMS;const a=this._head;let G=a.next;for(;G;)G=G.emit(this.deltaTime);a.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=K}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(K){const D=Math.min(this.maxFPS,K),a=Math.min(Math.max(0,D)/1e3,t.targetFPMS);this._maxElapsedMS=1/a}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(0===t)this._minElapsedMS=0;else{const K=Math.max(this.minFPS,t);this._minElapsedMS=1/(K/1e3)}}static get shared(){if(!t._shared){const K=t._shared=new t;K.autoStart=!0,K._protected=!0}return t._shared}static get system(){if(!t._system){const K=t._system=new t;K.autoStart=!0,K._protected=!0}return t._system}};x.targetFPMS=.06;let b=x;Object.defineProperties(a.W0,{TARGET_FPMS:{get:()=>b.targetFPMS,set(t){G.deprecation("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),b.targetFPMS=t}}});var n=D(738637);class e{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,N.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?b.shared:new b,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}e.extension=n.A.Application,n.X.add(e)},96457:(t,K,D)=>{D.d(K,{U:()=>a});const a=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i},413781:(t,K,D)=>{function a(t,K=null){const D=6*t;if((K=K||new Uint16Array(D)).length!==D)throw new Error(`Out buffer length is incorrect, got ${K.length} and expected ${D}`);for(let t=0,a=0;t<D;t+=6,a+=4)K[t+0]=a+0,K[t+1]=a+1,K[t+2]=a+2,K[t+3]=a+0,K[t+4]=a+2,K[t+5]=a+3;return K}D.d(K,{L:()=>a})},321671:(t,K,D)=>{function a(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}D.d(K,{L:()=>a})},307627:(t,K,D)=>{function a(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function G(t){return!(t&t-1||!t)}function N(t){let K=(t>65535?1:0)<<4,D=((t>>>=K)>255?1:0)<<3;return K|=D,D=((t>>>=D)>15?1:0)<<2,K|=D,D=((t>>>=D)>3?1:0)<<1,K|=D,K|(t>>>=D)>>1}D.d(K,{U5:()=>a,f3:()=>G,p6:()=>N})},892653:(t,K,D)=>{function a(t,K,D){const a=t.length;let G;if(K>=a||0===D)return;const N=a-(D=K+D>a?a-K:D);for(G=K;G<N;++G)t[G]=t[G+D];t.length=N}D.d(K,{d:()=>a})},61036:(t,K,D)=>{function a(t){return 0===t?0:t<0?-1:1}D.d(K,{_:()=>a})},429619:(t,K,D)=>{D.d(K,{L:()=>G});let a=0;function G(){return++a}},578351:(t,K,D)=>{D.r(K),D.d(K,{BaseTextureCache:()=>S,BoundingBox:()=>A,CanvasRenderTarget:()=>B,DATA_URI:()=>C.U,EventEmitter:()=>G,ProgramCache:()=>Y,TextureCache:()=>L,clearTextureCache:()=>$,correctBlendMode:()=>h,createIndicesForQuads:()=>H.L,decomposeDataUri:()=>r.Q,deprecation:()=>b,destroyTextureCache:()=>f,detectVideoAlphaMode:()=>m,determineCrossOrigin:()=>M.I,earcut:()=>N,getBufferType:()=>o.L,getCanvasBoundingBox:()=>p,getResolutionOfUrl:()=>k,hex2rgb:()=>Q,hex2string:()=>P,interleaveTypedArrays:()=>V,isMobile:()=>a.Fr,isPow2:()=>s.f3,isWebGLSupported:()=>E,log2:()=>s.p6,nextPow2:()=>s.U5,path:()=>z,premultiplyBlendMode:()=>X,premultiplyRgba:()=>J,premultiplyTint:()=>T,premultiplyTintToRgba:()=>_,removeItems:()=>F.d,rgb2hex:()=>q,sayHello:()=>d,sign:()=>c._,skipHello:()=>u,string2hex:()=>y,trimCanvas:()=>j,uid:()=>g.L,url:()=>n});var a=D(968381);a.W0.RETINA_PREFIX=/@([0-9\.]+)x/,a.W0.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var G=D(258055),N=D(827700),W=D(517116);const x={};function b(t,K,D=3){if(x[K])return;let a=(new Error).stack;typeof a>"u"?console.warn("PixiJS Deprecation Warning: ",`${K}\nDeprecated since v${t}`):(a=a.split(`\n`).splice(D).join(`\n`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${K}\nDeprecated since v${t}`),console.warn(a),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${K}\nDeprecated since v${t}`),console.warn(a))),x[K]=!0}const n={get parse(){return b("7.3.0","utils.url.parse is deprecated, use native URL API instead."),W.qg},get format(){return b("7.3.0","utils.url.format is deprecated, use native URL API instead."),W.GP},get resolve(){return b("7.3.0","utils.url.resolve is deprecated, use native URL API instead."),W.hd}};function e(t){if("string"!=typeof t)throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function i(t){return t.split("?")[0].split("#")[0]}const z={toPosix(t){return K="\\",D="/",t.replace(new RegExp(K.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),D);var K,D},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl:t=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t),isBlobUrl:t=>t.startsWith("blob:"),hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){e(t),t=this.toPosix(t);const K=/^file:\/\/\//.exec(t);if(K)return K[0];const D=/^[^/:]+:\/{0,2}/.exec(t);return D?D[0]:""},toAbsolute(t,K,D){if(e(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const G=i(this.toPosix(null!=K?K:a.W0.ADAPTER.getBaseUrl())),N=i(this.toPosix(null!=D?D:this.rootname(G)));return(t=this.toPosix(t)).startsWith("/")?z.join(N,t.slice(1)):this.isAbsolute(t)?t:this.join(G,t)},normalize(t){if(e(t),0===t.length)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;let K="";const D=(t=this.toPosix(t)).startsWith("/");this.hasProtocol(t)&&(K=this.rootname(t),t=t.slice(K.length));const a=t.endsWith("/");return(t=function(t,K){let D="",a=0,G=-1,N=0,W=-1;for(let x=0;x<=t.length;++x){if(x<t.length)W=t.charCodeAt(x);else{if(47===W)break;W=47}if(47===W){if(G!==x-1&&1!==N)if(G!==x-1&&2===N){if(D.length<2||2!==a||46!==D.charCodeAt(D.length-1)||46!==D.charCodeAt(D.length-2))if(D.length>2){const t=D.lastIndexOf("/");if(t!==D.length-1){-1===t?(D="",a=0):(D=D.slice(0,t),a=D.length-1-D.lastIndexOf("/")),G=x,N=0;continue}}else if(2===D.length||1===D.length){D="",a=0,G=x,N=0;continue}K&&(D.length>0?D+="/..":D="..",a=2)}else D.length>0?D+=`/${t.slice(G+1,x)}`:D=t.slice(G+1,x),a=x-G-1;G=x,N=0}else 46===W&&-1!==N?++N:N=-1}return D}(t,!1)).length>0&&a&&(t+="/"),D?`/${t}`:K+t},isAbsolute(t){return e(t),t=this.toPosix(t),!!this.hasProtocol(t)||t.startsWith("/")},join(...t){var K;if(0===t.length)return".";let D;for(let a=0;a<t.length;++a){const G=t[a];if(e(G),G.length>0)if(void 0===D)D=G;else{const N=null!==(K=t[a-1])&&void 0!==K?K:"";this.extname(N)?D+=`/../${G}`:D+=`/${G}`}}return void 0===D?".":this.normalize(D)},dirname(t){if(e(t),0===t.length)return".";let K=(t=this.toPosix(t)).charCodeAt(0);const D=47===K;let a=-1,G=!0;const N=this.getProtocol(t),W=t;for(let D=(t=t.slice(N.length)).length-1;D>=1;--D)if(K=t.charCodeAt(D),47===K){if(!G){a=D;break}}else G=!1;return-1===a?D?"/":this.isUrl(W)?N+t:N:D&&1===a?"//":N+t.slice(0,a)},rootname(t){e(t);let K="";if(K=(t=this.toPosix(t)).startsWith("/")?"/":this.getProtocol(t),this.isUrl(t)){const D=t.indexOf("/",K.length);K=-1!==D?t.slice(0,D):t,K.endsWith("/")||(K+="/")}return K},basename(t,K){e(t),K&&e(K),t=i(this.toPosix(t));let D,a=0,G=-1,N=!0;if(void 0!==K&&K.length>0&&K.length<=t.length){if(K.length===t.length&&K===t)return"";let W=K.length-1,x=-1;for(D=t.length-1;D>=0;--D){const b=t.charCodeAt(D);if(47===b){if(!N){a=D+1;break}}else-1===x&&(N=!1,x=D+1),W>=0&&(b===K.charCodeAt(W)?-1==--W&&(G=D):(W=-1,G=x))}return a===G?G=x:-1===G&&(G=t.length),t.slice(a,G)}for(D=t.length-1;D>=0;--D)if(47===t.charCodeAt(D)){if(!N){a=D+1;break}}else-1===G&&(N=!1,G=D+1);return-1===G?"":t.slice(a,G)},extname(t){e(t);let K=-1,D=0,a=-1,G=!0,N=0;for(let W=(t=i(this.toPosix(t))).length-1;W>=0;--W){const x=t.charCodeAt(W);if(47!==x)-1===a&&(G=!1,a=W+1),46===x?-1===K?K=W:1!==N&&(N=1):-1!==K&&(N=-1);else if(!G){D=W+1;break}}return-1===K||-1===a||0===N||1===N&&K===a-1&&K===D+1?"":t.slice(K,a)},parse(t){e(t);const K={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return K;let D=(t=i(this.toPosix(t))).charCodeAt(0);const a=this.isAbsolute(t);let G;const N="";K.root=this.rootname(t),G=a||this.hasProtocol(t)?1:0;let W=-1,x=0,b=-1,n=!0,z=t.length-1,I=0;for(;z>=G;--z)if(D=t.charCodeAt(z),47!==D)-1===b&&(n=!1,b=z+1),46===D?-1===W?W=z:1!==I&&(I=1):-1!==W&&(I=-1);else if(!n){x=z+1;break}return-1===W||-1===b||0===I||1===I&&W===b-1&&W===x+1?-1!==b&&(K.base=K.name=0===x&&a?t.slice(1,b):t.slice(x,b)):(0===x&&a?(K.name=t.slice(1,W),K.base=t.slice(1,b)):(K.name=t.slice(x,W),K.base=t.slice(x,b)),K.ext=t.slice(W,b)),K.dir=this.dirname(t),N&&(K.dir=N+K.dir),K},sep:"/",delimiter:":"};var I=D(424608);let Z,w;async function m(){return null!=Z||(Z=(async()=>{var t;const K=document.createElement("canvas").getContext("webgl");if(!K)return I.Gk.UNPACK;const D=await new Promise((t=>{const K=document.createElement("video");K.onloadeddata=()=>t(K),K.onerror=()=>t(null),K.autoplay=!1,K.crossOrigin="anonymous",K.preload="auto",K.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",K.load()}));if(!D)return I.Gk.UNPACK;const a=K.createTexture();K.bindTexture(K.TEXTURE_2D,a);const G=K.createFramebuffer();K.bindFramebuffer(K.FRAMEBUFFER,G),K.framebufferTexture2D(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_2D,a,0),K.pixelStorei(K.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),K.pixelStorei(K.UNPACK_COLORSPACE_CONVERSION_WEBGL,K.NONE),K.texImage2D(K.TEXTURE_2D,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,D);const N=new Uint8Array(4);return K.readPixels(0,0,1,1,K.RGBA,K.UNSIGNED_BYTE,N),K.deleteFramebuffer(G),K.deleteTexture(a),null===(t=K.getExtension("WEBGL_lose_context"))||void 0===t||t.loseContext(),N[0]<=N[3]?I.Gk.PMA:I.Gk.UNPACK})()),Z}function u(){b("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function d(){b("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)}function E(){return typeof w>"u"&&(w=function(){var t;const K={stencil:!0,failIfMajorPerformanceCaveat:a.W0.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!a.W0.ADAPTER.getWebGLRenderingContext())return!1;const D=a.W0.ADAPTER.createCanvas();let G=D.getContext("webgl",K)||D.getContext("experimental-webgl",K);const N=!!(null===(t=null==G?void 0:G.getContextAttributes())||void 0===t?void 0:t.stencil);if(G){const t=G.getExtension("WEBGL_lose_context");t&&t.loseContext()}return G=null,N}catch(t){return!1}}()),w}var l=D(817798);function Q(t,K=[]){return b("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),l.Q.shared.setValue(t).toRgbArray(K)}function P(t){return b("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),l.Q.shared.setValue(t).toHex()}function y(t){return b("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),l.Q.shared.setValue(t).toNumber()}function q(t){return b("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),l.Q.shared.setValue(t).toNumber()}const X=function(){const t=[],K=[];for(let D=0;D<32;D++)t[D]=D,K[D]=D;t[I.B9.NORMAL_NPM]=I.B9.NORMAL,t[I.B9.ADD_NPM]=I.B9.ADD,t[I.B9.SCREEN_NPM]=I.B9.SCREEN,K[I.B9.NORMAL]=I.B9.NORMAL_NPM,K[I.B9.ADD]=I.B9.ADD_NPM,K[I.B9.SCREEN]=I.B9.SCREEN_NPM;const D=[];return D.push(K),D.push(t),D}();function h(t,K){return X[K?1:0][t]}function J(t,K,D,a=!0){return b("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),l.Q.shared.setValue(t).premultiply(K,a).toArray(null!=D?D:new Float32Array(4))}function T(t,K){return b("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),l.Q.shared.setValue(t).toPremultiplied(K)}function _(t,K,D,a=!0){return b("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),l.Q.shared.setValue(t).premultiply(K,a).toArray(null!=D?D:new Float32Array(4))}var C=D(96457),H=D(413781),o=D(321671);const U={Float32Array,Uint32Array,Int32Array,Uint8Array};function V(t,K){let D=0,a=0;const G={};for(let G=0;G<t.length;G++)a+=K[G],D+=t[G].length;const N=new ArrayBuffer(4*D);let W=null,x=0;for(let D=0;D<t.length;D++){const b=K[D],n=t[D],e=o.L(n);G[e]||(G[e]=new U[e](N)),W=G[e];for(let t=0;t<n.length;t++)W[(t/b|0)*a+x+t%b]=n[t];x+=b}return new Float32Array(N)}var s=D(307627),F=D(892653),c=D(61036),g=D(429619);const R=class{constructor(t,K,D,a){this.left=t,this.top=K,this.right=D,this.bottom=a}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};R.EMPTY=new R(0,0,0,0);let A=R;const Y={},L=Object.create(null),S=Object.create(null);function f(){let t;for(t in L)L[t].destroy();for(t in S)S[t].destroy()}function $(){let t;for(t in L)delete L[t];for(t in S)delete S[t]}class B{constructor(t,K,D){this._canvas=a.W0.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=D||a.W0.RESOLUTION,this.resize(t,K)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,K){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(K*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(null===this._canvas)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function O(t,K,D){for(let a=0,G=4*D*K;a<K;++a,G+=4)if(0!==t[G+3])return!1;return!0}function v(t,K,D,a,G){const N=4*K;for(let K=a,W=a*N+4*D;K<=G;++K,W+=N)if(0!==t[W+3])return!1;return!0}function p(t){const{width:K,height:D}=t,a=t.getContext("2d",{willReadFrequently:!0});if(null===a)throw new TypeError("Failed to get canvas 2D context");const G=a.getImageData(0,0,K,D).data;let N=0,W=0,x=K-1,b=D-1;for(;W<D&&O(G,K,W);)++W;if(W===D)return A.EMPTY;for(;O(G,K,b);)--b;for(;v(G,K,N,W,b);)++N;for(;v(G,K,x,W,b);)--x;return++x,++b,new A(N,W,x,b)}function j(t){const K=p(t),{width:D,height:a}=K;let G=null;if(!K.isEmpty()){const N=t.getContext("2d");if(null===N)throw new TypeError("Failed to get canvas 2D context");G=N.getImageData(K.left,K.top,D,a)}return{width:D,height:a,data:G}}var r=D(296606),M=D(605786);function k(t,K=1){var D;const G=null===(D=a.W0.RETINA_PREFIX)||void 0===D?void 0:D.exec(t);return G?parseFloat(G[1]):K}},296606:(t,K,D)=>{D.d(K,{Q:()=>G});var a=D(96457);function G(t){const K=a.U.exec(t);if(K)return{mediaType:K[1]?K[1].toLowerCase():void 0,subType:K[2]?K[2].toLowerCase():void 0,charset:K[3]?K[3].toLowerCase():void 0,encoding:K[4]?K[4].toLowerCase():void 0,data:K[5]}}},605786:(t,K,D)=>{function a(t,K=globalThis.location){if(t.startsWith("data:"))return"";K=K||globalThis.location;const D=new URL(t,document.baseURI);return D.hostname!==K.hostname||D.port!==K.port||D.protocol!==K.protocol?"anonymous":""}D.d(K,{I:()=>a})},478128:(t,K,D)=>{D.d(K,{RvI:()=>a.Rv});var a=D(316197),G=D(110715),N=D(672076);const W=new a.uq;G.q9.prototype._cacheAsBitmap=!1,G.q9.prototype._cacheData=null,G.q9.prototype._cacheAsBitmapResolution=null,G.q9.prototype._cacheAsBitmapMultisample=null;class x{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(G.q9.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;let K;this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new x),K=this._cacheData,K.originalRender=this.render,K.originalRenderCanvas=this.renderCanvas,K.originalUpdateTransform=this.updateTransform,K.originalCalculateBounds=this.calculateBounds,K.originalGetLocalBounds=this.getLocalBounds,K.originalDestroy=this.destroy,K.originalContainsPoint=this.containsPoint,K.originalMask=this._mask,K.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(K=this._cacheData,K.sprite&&this._destroyCachedDisplayObject(),this.render=K.originalRender,this.renderCanvas=K.originalRenderCanvas,this.calculateBounds=K.originalCalculateBounds,this.getLocalBounds=K.originalGetLocalBounds,this.destroy=K.originalDestroy,this.updateTransform=K.originalUpdateTransform,this.containsPoint=K.originalContainsPoint,this._mask=K.originalMask,this.filterArea=K.originalFilterArea)}}}),G.q9.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},G.q9.prototype._initCachedDisplayObject=function(t){var K,D,G;if(null===(K=this._cacheData)||void 0===K?void 0:K.sprite)return;const x=this.alpha;this.alpha=1,t.batch.flush();const b=this.getLocalBounds(new a.M_,!0);if(null===(D=this.filters)||void 0===D?void 0:D.length){const t=this.filters[0].padding;b.pad(t)}const n=this.cacheAsBitmapResolution||t.resolution;b.ceil(n),b.width=Math.max(b.width,1/n),b.height=Math.max(b.height,1/n);const e=t.renderTexture.current,i=t.renderTexture.sourceFrame.clone(),z=t.renderTexture.destinationFrame.clone(),I=t.projection.transform,Z=a.Y7.create({width:b.width,height:b.height,resolution:n,multisample:null!==(G=this.cacheAsBitmapMultisample)&&void 0!==G?G:t.multisample}),w=`cacheAsBitmap_${a.Wp.uid()}`;this._cacheData.textureCacheId=w,a.t5.addToCache(Z.baseTexture,w),a.gP.addToCache(Z,w);const m=this.transform.localTransform.copyTo(W).invert().translate(-b.x,-b.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:Z,clear:!0,transform:m,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=I,t.renderTexture.bind(e,i,z),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=x;const u=new N.k(Z);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-b.x/b.width,u.anchor.y=-b.y/b.height,u.alpha=x,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=u.containsPoint.bind(u)},G.q9.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},G.q9.prototype._initCachedDisplayObjectCanvas=function(t){var K;if(null===(K=this._cacheData)||void 0===K?void 0:K.sprite)return;const D=this.getLocalBounds(new a.M_,!0),G=this.alpha;this.alpha=1;const x=t.canvasContext.activeContext,b=t._projTransform,n=this.cacheAsBitmapResolution||t.resolution;D.ceil(n),D.width=Math.max(D.width,1/n),D.height=Math.max(D.height,1/n);const e=a.Y7.create({width:D.width,height:D.height,resolution:n}),i=`cacheAsBitmap_${a.Wp.uid()}`;this._cacheData.textureCacheId=i,a.t5.addToCache(e.baseTexture,i),a.gP.addToCache(e,i);const z=W;this.transform.localTransform.copyTo(z),z.invert(),z.tx-=D.x,z.ty-=D.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:e,clear:!0,transform:z,skipUpdateTransform:!1}),t.canvasContext.activeContext=x,t._projTransform=b,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=G;const I=new N.k(e);I.transform.worldTransform=this.transform.worldTransform,I.anchor.x=-D.x/D.width,I.anchor.y=-D.y/D.height,I.alpha=G,I._bounds=this._bounds,this._cacheData.sprite=I,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=I.containsPoint.bind(I)},G.q9.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},G.q9.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},G.q9.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,a.t5.removeFromCache(this._cacheData.textureCacheId),a.gP.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},G.q9.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},G.q9.prototype.name=null,G.mc.prototype.getChildByName=function(t,K){for(let K=0,D=this.children.length;K<D;K++)if(this.children[K].name===t)return this.children[K];if(K)for(let K=0,D=this.children.length;K<D;K++){const D=this.children[K];if(!D.getChildByName)continue;const a=D.getChildByName(t,!0);if(a)return a}return null},G.q9.prototype.getGlobalPosition=function(t=new a.bR,K=!1){return this.parent?this.parent.toGlobal(this.position,t,K):(t.x=this.position.x,t.y=this.position.y),t};var b=D(246638),n=D(528176),e=D(698539),i=D(132565),z=`varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it's\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n`,I=`\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n`;class Z extends a.dJ{constructor(){super(I,z)}}var w=`precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n`;class m extends a.dJ{constructor(t=.5,K=Math.random()){super(a.Eo,w,{uNoise:0,uSeed:0}),this.noise=t,this.seed=K}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const u={AlphaFilter:b.Z,BlurFilter:n.e,BlurFilterPass:n.H,ColorMatrixFilter:e.N,DisplacementFilter:i.U,FXAAFilter:Z,NoiseFilter:m};Object.entries(u).forEach((([t,K])=>{Object.defineProperty(u,t,{get:()=>(a.Wp.deprecation("7.1.0",`filters.${t} has moved to ${t}`),K)})}));const d=new class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(a.Rv.system.add(this.tickerUpdate,this,a.dQ.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(a.Rv.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove)return void(this._didMove=!1);const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&"touch"===t.pointerType||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}};class E{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=E.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new a.bR,this.page=new a.bR,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,K,D){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,K,D,a,G){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class l extends E{constructor(){super(...arguments),this.client=new a.bR,this.movement=new a.bR,this.offset=new a.bR,this.global=new a.bR,this.screen=new a.bR}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,K,D){return t.worldTransform.applyInverse(D||this.global,K)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,K,D,a,G,N,W,x,b,n,e,i,z,I,Z){throw new Error("Method not implemented.")}}class Q extends l{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class P extends l{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}P.DOM_DELTA_PIXEL=0,P.DOM_DELTA_LINE=1,P.DOM_DELTA_PAGE=2;const y=2048,q=new a.bR,X=new a.bR;class h{constructor(t){this.dispatch=new a.Wp.EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,K){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:K,priority:0}),this.mappingTable[t].sort(((t,K)=>t.priority-K.priority))}dispatchEvent(t,K){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,K),this.dispatch.emit(K||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const K=this.mappingTable[t.type];if(K)for(let D=0,a=K.length;D<a;D++)K[D].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,K){d.pauseUpdate=!0;const D=this[this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,q.set(t,K),this.hitTestFn,this.hitPruneFn);return D&&D[0]}propagate(t,K){if(!t.target)return;const D=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let a=0,G=D.length-1;a<G;a++)if(t.currentTarget=D[a],this.notifyTarget(t,K),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,K),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(let a=D.length-2;a>=0;a--)if(t.currentTarget=D[a],this.notifyTarget(t,K),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,K,D=this._allInteractiveElements){if(0===D.length)return;t.eventPhase=t.BUBBLING_PHASE;const a=Array.isArray(K)?K:[K];for(let K=D.length-1;K>=0;K--)a.forEach((a=>{t.currentTarget=D[K],this.notifyTarget(t,a)}))}propagationPath(t){const K=[t];for(let D=0;D<y&&t!==this.rootTarget;D++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");K.push(t.parent),t=t.parent}return K.reverse(),K}hitTestMoveRecursive(t,K,D,a,G,N=!1){let W=!1;if(this._interactivePrune(t))return null;if(("dynamic"===t.eventMode||"dynamic"===K)&&(d.pauseUpdate=!1),t.interactiveChildren&&t.children){const x=t.children;for(let b=x.length-1;b>=0;b--){const n=x[b],e=this.hitTestMoveRecursive(n,this._isInteractive(K)?K:n.eventMode,D,a,G,N||G(t,D));if(e){if(e.length>0&&!e[e.length-1].parent)continue;const K=t.isInteractive();(e.length>0||K)&&(K&&this._allInteractiveElements.push(t),e.push(t)),0===this._hitElements.length&&(this._hitElements=e),W=!0}}}const x=this._isInteractive(K),b=t.isInteractive();return x&&b&&this._allInteractiveElements.push(t),N||this._hitElements.length>0?null:W?this._hitElements:x&&!G(t,D)&&a(t,D)?b?[t]:[]:null}hitTestRecursive(t,K,D,a,G){if(this._interactivePrune(t)||G(t,D))return null;if(("dynamic"===t.eventMode||"dynamic"===K)&&(d.pauseUpdate=!1),t.interactiveChildren&&t.children){const N=t.children;for(let W=N.length-1;W>=0;W--){const x=N[W],b=this.hitTestRecursive(x,this._isInteractive(K)?K:x.eventMode,D,a,G);if(b){if(b.length>0&&!b[b.length-1].parent)continue;const K=t.isInteractive();return(b.length>0||K)&&b.push(t),b}}}const N=this._isInteractive(K),W=t.isInteractive();return N&&a(t,D)?W?[t]:[]:null}_isInteractive(t){return"static"===t||"dynamic"===t}_interactivePrune(t){return!(t&&!t.isMask&&t.visible&&t.renderable&&"none"!==t.eventMode&&("passive"!==t.eventMode||t.interactiveChildren)&&!t.isMask)}hitPruneFn(t,K){var D;if(t.hitArea&&(t.worldTransform.applyInverse(K,X),!t.hitArea.contains(X.x,X.y)))return!0;if(t._mask){const a=t._mask.isMaskData?t._mask.maskObject:t._mask;if(a&&!(null===(D=a.containsPoint)||void 0===D?void 0:D.call(a,K)))return!0}return!1}hitTestFn(t,K){return"passive"!==t.eventMode&&(!!t.hitArea||!!t.containsPoint&&t.containsPoint(K))}notifyTarget(t,K){var D,a;const G=`on${K=null!=K?K:t.type}`;null===(a=(D=t.currentTarget)[G])||void 0===a||a.call(D,t);const N=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${K}capture`:K;this.notifyListeners(t,N),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,K)}mapPointerDown(t){if(!(t instanceof Q))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const K=this.createPointerEvent(t);if(this.dispatchEvent(K,"pointerdown"),"touch"===K.pointerType)this.dispatchEvent(K,"touchstart");else if("mouse"===K.pointerType||"pen"===K.pointerType){const t=2===K.button;this.dispatchEvent(K,t?"rightdown":"mousedown")}this.trackingData(t.pointerId).pressTargetsByButton[t.button]=K.composedPath(),this.freeEvent(K)}mapPointerMove(t){var K,D,a;if(!(t instanceof Q))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const G=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const N="mouse"===G.pointerType||"pen"===G.pointerType,W=this.trackingData(t.pointerId),x=this.findMountedTarget(W.overTargets);if((null===(K=W.overTargets)||void 0===K?void 0:K.length)>0&&x!==G.target){const K="mousemove"===t.type?"mouseout":"pointerout",D=this.createPointerEvent(t,K,x);if(this.dispatchEvent(D,"pointerout"),N&&this.dispatchEvent(D,"mouseout"),!G.composedPath().includes(x)){const K=this.createPointerEvent(t,"pointerleave",x);for(K.eventPhase=K.AT_TARGET;K.target&&!G.composedPath().includes(K.target);)K.currentTarget=K.target,this.notifyTarget(K),N&&this.notifyTarget(K,"mouseleave"),K.target=K.target.parent;this.freeEvent(K)}this.freeEvent(D)}if(x!==G.target){const K="mousemove"===t.type?"mouseover":"pointerover",D=this.clonePointerEvent(G,K);this.dispatchEvent(D,"pointerover"),N&&this.dispatchEvent(D,"mouseover");let a=null==x?void 0:x.parent;for(;a&&a!==this.rootTarget.parent&&a!==G.target;)a=a.parent;if(!a||a===this.rootTarget.parent){const t=this.clonePointerEvent(G,"pointerenter");for(t.eventPhase=t.AT_TARGET;t.target&&t.target!==x&&t.target!==this.rootTarget.parent;)t.currentTarget=t.target,this.notifyTarget(t),N&&this.notifyTarget(t,"mouseenter"),t.target=t.target.parent;this.freeEvent(t)}this.freeEvent(D)}const b=[],n=null===(D=this.enableGlobalMoveEvents)||void 0===D||D;this.moveOnAll?b.push("pointermove"):this.dispatchEvent(G,"pointermove"),n&&b.push("globalpointermove"),"touch"===G.pointerType&&(this.moveOnAll?b.splice(1,0,"touchmove"):this.dispatchEvent(G,"touchmove"),n&&b.push("globaltouchmove")),N&&(this.moveOnAll?b.splice(1,0,"mousemove"):this.dispatchEvent(G,"mousemove"),n&&b.push("globalmousemove"),this.cursor=null===(a=G.target)||void 0===a?void 0:a.cursor),b.length>0&&this.all(G,b),this._allInteractiveElements.length=0,this._hitElements.length=0,W.overTargets=G.composedPath(),this.freeEvent(G)}mapPointerOver(t){var K;if(!(t instanceof Q))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const D=this.trackingData(t.pointerId),a=this.createPointerEvent(t),G="mouse"===a.pointerType||"pen"===a.pointerType;this.dispatchEvent(a,"pointerover"),G&&this.dispatchEvent(a,"mouseover"),"mouse"===a.pointerType&&(this.cursor=null===(K=a.target)||void 0===K?void 0:K.cursor);const N=this.clonePointerEvent(a,"pointerenter");for(N.eventPhase=N.AT_TARGET;N.target&&N.target!==this.rootTarget.parent;)N.currentTarget=N.target,this.notifyTarget(N),G&&this.notifyTarget(N,"mouseenter"),N.target=N.target.parent;D.overTargets=a.composedPath(),this.freeEvent(a),this.freeEvent(N)}mapPointerOut(t){if(!(t instanceof Q))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const K=this.trackingData(t.pointerId);if(K.overTargets){const D="mouse"===t.pointerType||"pen"===t.pointerType,a=this.findMountedTarget(K.overTargets),G=this.createPointerEvent(t,"pointerout",a);this.dispatchEvent(G),D&&this.dispatchEvent(G,"mouseout");const N=this.createPointerEvent(t,"pointerleave",a);for(N.eventPhase=N.AT_TARGET;N.target&&N.target!==this.rootTarget.parent;)N.currentTarget=N.target,this.notifyTarget(N),D&&this.notifyTarget(N,"mouseleave"),N.target=N.target.parent;K.overTargets=null,this.freeEvent(G),this.freeEvent(N)}this.cursor=null}mapPointerUp(t){if(!(t instanceof Q))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const K=performance.now(),D=this.createPointerEvent(t);if(this.dispatchEvent(D,"pointerup"),"touch"===D.pointerType)this.dispatchEvent(D,"touchend");else if("mouse"===D.pointerType||"pen"===D.pointerType){const t=2===D.button;this.dispatchEvent(D,t?"rightup":"mouseup")}const a=this.trackingData(t.pointerId),G=this.findMountedTarget(a.pressTargetsByButton[t.button]);let N=G;if(G&&!D.composedPath().includes(G)){let K=G;for(;K&&!D.composedPath().includes(K);){if(D.currentTarget=K,this.notifyTarget(D,"pointerupoutside"),"touch"===D.pointerType)this.notifyTarget(D,"touchendoutside");else if("mouse"===D.pointerType||"pen"===D.pointerType){const t=2===D.button;this.notifyTarget(D,t?"rightupoutside":"mouseupoutside")}K=K.parent}delete a.pressTargetsByButton[t.button],N=K}if(N){const G=this.clonePointerEvent(D,"click");G.target=N,G.path=null,a.clicksByButton[t.button]||(a.clicksByButton[t.button]={clickCount:0,target:G.target,timeStamp:K});const W=a.clicksByButton[t.button];if(W.target===G.target&&K-W.timeStamp<200?++W.clickCount:W.clickCount=1,W.target=G.target,W.timeStamp=K,G.detail=W.clickCount,"mouse"===G.pointerType){const t=2===G.button;this.dispatchEvent(G,t?"rightclick":"click")}else"touch"===G.pointerType&&this.dispatchEvent(G,"tap");this.dispatchEvent(G,"pointertap"),this.freeEvent(G)}this.freeEvent(D)}mapPointerUpOutside(t){if(!(t instanceof Q))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const K=this.trackingData(t.pointerId),D=this.findMountedTarget(K.pressTargetsByButton[t.button]),a=this.createPointerEvent(t);if(D){let G=D;for(;G;)a.currentTarget=G,this.notifyTarget(a,"pointerupoutside"),"touch"===a.pointerType?this.notifyTarget(a,"touchendoutside"):("mouse"===a.pointerType||"pen"===a.pointerType)&&this.notifyTarget(a,2===a.button?"rightupoutside":"mouseupoutside"),G=G.parent;delete K.pressTargetsByButton[t.button]}this.freeEvent(a)}mapWheel(t){if(!(t instanceof P))return void console.warn("EventBoundary cannot map a non-wheel event as a wheel event");const K=this.createWheelEvent(t);this.dispatchEvent(K),this.freeEvent(K)}findMountedTarget(t){if(!t)return null;let K=t[0];for(let D=1;D<t.length&&t[D].parent===K;D++)K=t[D];return K}createPointerEvent(t,K,D){var a;const G=this.allocateEvent(Q);return this.copyPointerData(t,G),this.copyMouseData(t,G),this.copyData(t,G),G.nativeEvent=t.nativeEvent,G.originalEvent=t,G.target=null!==(a=null!=D?D:this.hitTest(G.global.x,G.global.y))&&void 0!==a?a:this._hitElements[0],"string"==typeof K&&(G.type=K),G}createWheelEvent(t){const K=this.allocateEvent(P);return this.copyWheelData(t,K),this.copyMouseData(t,K),this.copyData(t,K),K.nativeEvent=t.nativeEvent,K.originalEvent=t,K.target=this.hitTest(K.global.x,K.global.y),K}clonePointerEvent(t,K){const D=this.allocateEvent(Q);return D.nativeEvent=t.nativeEvent,D.originalEvent=t.originalEvent,this.copyPointerData(t,D),this.copyMouseData(t,D),this.copyData(t,D),D.target=t.target,D.path=t.composedPath().slice(),D.type=null!=K?K:D.type,D}copyWheelData(t,K){K.deltaMode=t.deltaMode,K.deltaX=t.deltaX,K.deltaY=t.deltaY,K.deltaZ=t.deltaZ}copyPointerData(t,K){t instanceof Q&&K instanceof Q&&(K.pointerId=t.pointerId,K.width=t.width,K.height=t.height,K.isPrimary=t.isPrimary,K.pointerType=t.pointerType,K.pressure=t.pressure,K.tangentialPressure=t.tangentialPressure,K.tiltX=t.tiltX,K.tiltY=t.tiltY,K.twist=t.twist)}copyMouseData(t,K){t instanceof l&&K instanceof l&&(K.altKey=t.altKey,K.button=t.button,K.buttons=t.buttons,K.client.copyFrom(t.client),K.ctrlKey=t.ctrlKey,K.metaKey=t.metaKey,K.movement.copyFrom(t.movement),K.screen.copyFrom(t.screen),K.shiftKey=t.shiftKey,K.global.copyFrom(t.global))}copyData(t,K){K.isTrusted=t.isTrusted,K.srcElement=t.srcElement,K.timeStamp=performance.now(),K.type=t.type,K.detail=t.detail,K.view=t.view,K.which=t.which,K.layer.copyFrom(t.layer),K.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const K=this.eventPool.get(t).pop()||new t(this);return K.eventPhase=K.NONE,K.currentTarget=null,K.path=null,K.target=null,K}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const K=t.constructor;this.eventPool.has(K)||this.eventPool.set(K,[]),this.eventPool.get(K).push(t)}notifyListeners(t,K){const D=t.currentTarget._events[K];if(D&&t.currentTarget.isInteractive())if("fn"in D)D.once&&t.currentTarget.removeListener(K,D.fn,void 0,!0),D.fn.call(D.context,t);else for(let a=0,G=D.length;a<G&&!t.propagationImmediatelyStopped;a++)D[a].once&&t.currentTarget.removeListener(K,D[a].fn,void 0,!0),D[a].fn.call(D[a].context,t)}}const J=1,T={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},_=class t{constructor(K){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=K,this.rootBoundary=new h(null),d.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Q(null),this.rootWheelEvent=new P(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...t.defaultEventFeatures},{set:(t,K,D)=>("globalMove"===K&&(this.rootBoundary.enableGlobalMoveEvents=D),t[K]=D,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(K){var D,a;const{view:G,resolution:N}=this.renderer;this.setTargetElement(G),this.resolution=N,t._defaultEventMode=null!==(D=K.eventMode)&&void 0!==D?D:"auto",Object.assign(this.features,null!==(a=K.eventFeatures)&&void 0!==a?a:{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let K=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(K=!1),this.currentCursor===t)return;this.currentCursor=t;const D=this.cursorStyles[t];if(D)switch(typeof D){case"string":K&&(this.domElement.style.cursor=D);break;case"function":D(t);break;case"object":K&&Object.assign(this.domElement.style,D)}else K&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const K=this.normalizeToPointerData(t);this.autoPreventDefault&&K[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let t=0,D=K.length;t<D;t++){const D=K[t],a=this.bootstrapEvent(this.rootPointerEvent,D);this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,d.pointerMoved();const K=this.normalizeToPointerData(t);for(let t=0,D=K.length;t<D;t++){const D=this.bootstrapEvent(this.rootPointerEvent,K[t]);this.rootBoundary.mapEvent(D)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let K=t.target;t.composedPath&&t.composedPath().length>0&&(K=t.composedPath()[0]);const D=K!==this.domElement?"outside":"",a=this.normalizeToPointerData(t);for(let t=0,K=a.length;t<K;t++){const K=this.bootstrapEvent(this.rootPointerEvent,a[t]);K.type+=D,this.rootBoundary.mapEvent(K)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const K=this.normalizeToPointerData(t);for(let t=0,D=K.length;t<D;t++){const D=this.bootstrapEvent(this.rootPointerEvent,K[t]);this.rootBoundary.mapEvent(D)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const K=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(K)}setTargetElement(t){this.removeEvents(),this.domElement=t,d.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;d.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;d.removeTickerListener();const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,K,D){const a=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},G=1/this.resolution;t.x=(K-a.left)*(this.domElement.width/a.width)*G,t.y=(D-a.top)*(this.domElement.height/a.height)*G}normalizeToPointerData(t){const K=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let D=0,a=t.changedTouches.length;D<a;D++){const a=t.changedTouches[D];typeof a.button>"u"&&(a.button=0),typeof a.buttons>"u"&&(a.buttons=1),typeof a.isPrimary>"u"&&(a.isPrimary=1===t.touches.length&&"touchstart"===t.type),typeof a.width>"u"&&(a.width=a.radiusX||1),typeof a.height>"u"&&(a.height=a.radiusY||1),typeof a.tiltX>"u"&&(a.tiltX=0),typeof a.tiltY>"u"&&(a.tiltY=0),typeof a.pointerType>"u"&&(a.pointerType="touch"),typeof a.pointerId>"u"&&(a.pointerId=a.identifier||0),typeof a.pressure>"u"&&(a.pressure=a.force||.5),typeof a.twist>"u"&&(a.twist=0),typeof a.tangentialPressure>"u"&&(a.tangentialPressure=0),typeof a.layerX>"u"&&(a.layerX=a.offsetX=a.clientX),typeof a.layerY>"u"&&(a.layerY=a.offsetY=a.clientY),a.isNormalized=!0,a.type=t.type,K.push(a)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&!(this.supportsPointerEvents&&t instanceof globalThis.PointerEvent)){const D=t;typeof D.isPrimary>"u"&&(D.isPrimary=!0),typeof D.width>"u"&&(D.width=1),typeof D.height>"u"&&(D.height=1),typeof D.tiltX>"u"&&(D.tiltX=0),typeof D.tiltY>"u"&&(D.tiltY=0),typeof D.pointerType>"u"&&(D.pointerType="mouse"),typeof D.pointerId>"u"&&(D.pointerId=J),typeof D.pressure>"u"&&(D.pressure=.5),typeof D.twist>"u"&&(D.twist=0),typeof D.tangentialPressure>"u"&&(D.tangentialPressure=0),D.isNormalized=!0,K.push(D)}else K.push(t);return K}normalizeWheelEvent(t){const K=this.rootWheelEvent;return this.transferMouseData(K,t),K.deltaX=t.deltaX,K.deltaY=t.deltaY,K.deltaZ=t.deltaZ,K.deltaMode=t.deltaMode,this.mapPositionToPoint(K.screen,t.clientX,t.clientY),K.global.copyFrom(K.screen),K.offset.copyFrom(K.screen),K.nativeEvent=t,K.type=t.type,K}bootstrapEvent(t,K){return t.originalEvent=null,t.nativeEvent=K,t.pointerId=K.pointerId,t.width=K.width,t.height=K.height,t.isPrimary=K.isPrimary,t.pointerType=K.pointerType,t.pressure=K.pressure,t.tangentialPressure=K.tangentialPressure,t.tiltX=K.tiltX,t.tiltY=K.tiltY,t.twist=K.twist,this.transferMouseData(t,K),this.mapPositionToPoint(t.screen,K.clientX,K.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=K.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=T[t.type]||t.type),t}transferMouseData(t,K){t.isTrusted=K.isTrusted,t.srcElement=K.srcElement,t.timeStamp=performance.now(),t.type=K.type,t.altKey=K.altKey,t.button=K.button,t.buttons=K.buttons,t.client.x=K.clientX,t.client.y=K.clientY,t.ctrlKey=K.ctrlKey,t.metaKey=K.metaKey,t.movement.x=K.movementX,t.movement.y=K.movementY,t.page.x=K.pageX,t.page.y=K.pageY,t.relatedTarget=null,t.shiftKey=K.shiftKey}};_.extension={name:"events",type:[a.Ag.RendererSystem,a.Ag.CanvasRendererSystem]},_.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let C=_;function H(t){return"dynamic"===t||"static"===t}a.XO.add(C);const o={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){var t;return null!==(t=this._internalInteractive)&&void 0!==t?t:H(C.defaultEventMode)},set interactive(t){a.Wp.deprecation("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){var t;return null!==(t=this._internalEventMode)&&void 0!==t?t:C.defaultEventMode},set eventMode(t){this._internalInteractive=H(t),this._internalEventMode=t},isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener(t,K,D){const a="function"==typeof K?void 0:K;t="boolean"==typeof D&&D||"object"==typeof D&&D.capture?`${t}capture`:t,K="function"==typeof K?K:K.handleEvent,this.on(t,K,a)},removeEventListener(t,K,D){const a="function"==typeof K?void 0:K;t="boolean"==typeof D&&D||"object"==typeof D&&D.capture?`${t}capture`:t,K="function"==typeof K?K:K.handleEvent,this.off(t,K,a)},dispatchEvent(t){if(!(t instanceof E))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};G.q9.mixin(o),G.q9.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});const U=9,V=100,s=0,F=0,c=2,g=1,R=-1e3,A=-1e3,Y=2;class L{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(a.Wp.isMobile.tablet||a.Wp.isMobile.phone)&&this.createTouchHook();const K=document.createElement("div");K.style.width=`${V}px`,K.style.height=`${V}px`,K.style.position="absolute",K.style.top=`${s}px`,K.style.left=`${F}px`,K.style.zIndex=c.toString(),this.div=K,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${g}px`,t.style.height=`${g}px`,t.style.position="absolute",t.style.top=`${R}px`,t.style.left=`${A}px`,t.style.zIndex=Y.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",(()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()})),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),null===(t=this.renderer.view.parentNode)||void 0===t||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),null===(t=this.div.parentNode)||void 0===t||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const K=t.children;if(K)for(let t=0;t<K.length;t++)this.updateAccessibleObjects(K[t])}update(){const t=performance.now();if(a.Wp.isMobile.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:K,y:D,width:G,height:N}=this.renderer.view.getBoundingClientRect(),{width:W,height:x,resolution:b}=this.renderer,n=G/W*b,e=N/x*b;let i=this.div;i.style.left=`${K}px`,i.style.top=`${D}px`,i.style.width=`${W}px`,i.style.height=`${x}px`;for(let t=0;t<this.children.length;t++){const K=this.children[t];if(K.renderId!==this.renderId)K._accessibleActive=!1,a.Wp.removeItems(this.children,t,1),this.div.removeChild(K._accessibleDiv),this.pool.push(K._accessibleDiv),K._accessibleDiv=null,t--;else{i=K._accessibleDiv;let t=K.hitArea;const D=K.worldTransform;K.hitArea?(i.style.left=`${(D.tx+t.x*D.a)*n}px`,i.style.top=`${(D.ty+t.y*D.d)*e}px`,i.style.width=`${t.width*D.a*n}px`,i.style.height=`${t.height*D.d*e}px`):(t=K.getBounds(),this.capHitArea(t),i.style.left=`${t.x*n}px`,i.style.top=`${t.y*e}px`,i.style.width=`${t.width*n}px`,i.style.height=`${t.height*e}px`,i.title!==K.accessibleTitle&&null!==K.accessibleTitle&&(i.title=K.accessibleTitle),i.getAttribute("aria-label")!==K.accessibleHint&&null!==K.accessibleHint&&i.setAttribute("aria-label",K.accessibleHint)),(K.accessibleTitle!==i.title||K.tabIndex!==i.tabIndex)&&(i.title=K.accessibleTitle,i.tabIndex=K.tabIndex,this.debug&&this.updateDebugHTML(i))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:K,height:D}=this.renderer;t.x+t.width>K&&(t.width=K-t.x),t.y+t.height>D&&(t.height=D-t.y)}addChild(t){let K=this.pool.pop();K||(K=document.createElement("button"),K.style.width=`${V}px`,K.style.height=`${V}px`,K.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",K.style.position="absolute",K.style.zIndex=c.toString(),K.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?K.setAttribute("aria-live","off"):K.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?K.setAttribute("aria-relevant","additions"):K.setAttribute("aria-relevant","text"),K.addEventListener("click",this._onClick.bind(this)),K.addEventListener("focus",this._onFocus.bind(this)),K.addEventListener("focusout",this._onFocusOut.bind(this))),K.style.pointerEvents=t.accessiblePointerEvents,K.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?K.title=t.accessibleTitle:(!t.accessibleHint||null===t.accessibleHint)&&(K.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&null!==t.accessibleHint&&K.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(K),t._accessibleActive=!0,t._accessibleDiv=K,K.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,K){const{displayObject:D}=t.target,a=this.renderer.events.rootBoundary,G=Object.assign(new E(a),{target:D});a.rootTarget=this.renderer.lastObjectRendered,K.forEach((t=>a.dispatchEvent(G,t)))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===U&&this.activate()}_onMouseMove(t){0===t.movementX&&0===t.movementY||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}L.extension={name:"accessibility",type:[a.Ag.RendererPlugin,a.Ag.CanvasRendererPlugin]},a.XO.add(L);const S=class t{constructor(K){this.stage=new G.mc,K=Object.assign({forceCanvas:!1},K),this.renderer=a.q5(K),t._plugins.forEach((t=>{t.init.call(this,K)}))}render(){this.renderer.render(this.stage)}get view(){var t;return null===(t=this.renderer)||void 0===t?void 0:t.view}get screen(){var t;return null===(t=this.renderer)||void 0===t?void 0:t.screen}destroy(K,D){const a=t._plugins.slice(0);a.reverse(),a.forEach((t=>{t.destroy.call(this)})),this.stage.destroy(D),this.stage=null,this.renderer.destroy(K),this.renderer=null}};S._plugins=[];let f=S;a.XO.handleByList(a.Ag.Application,f._plugins);class ${static init(t){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame((()=>this.resize())))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;let t,K;if(this.cancelResize(),this._resizeTo===globalThis.window)t=globalThis.innerWidth,K=globalThis.innerHeight;else{const{clientWidth:D,clientHeight:a}=this._resizeTo;t=D,K=a}this.renderer.resize(t,K),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}$.extension=a.Ag.Application,a.XO.add($);var B=D(557108),O=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t))(O||{});const v={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let p,j;function r(){j={s3tc:p.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:p.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:p.getExtension("WEBGL_compressed_texture_etc"),etc1:p.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:p.getExtension("WEBGL_compressed_texture_pvrtc")||p.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:p.getExtension("WEBGL_compressed_texture_atc"),astc:p.getExtension("WEBGL_compressed_texture_astc")}}const M={extension:{type:a.Ag.DetectionParser,priority:2},test:async()=>{const t=a.W0.ADAPTER.createCanvas().getContext("webgl");return t?(p=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async t=>{j||r();const K=[];for(const t in j)j[t]&&K.push(t);return[...K,...t]},remove:async t=>(j||r(),t.filter((t=>!(t in j))))};a.XO.add(M);class k extends a.dZ{constructor(t,K={width:1,height:1,autoLoad:!0}){let D,G;"string"==typeof t?(D=t,G=new Uint8Array):(D=null,G=t),super(G,K),this.origin=D,this.buffer=G?new a.u3(G):null,this._load=null,this.loaded=!1,null!==this.origin&&!1!==K.autoLoad&&this.load(),null===this.origin&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load||(this._load=fetch(this.origin).then((t=>t.blob())).then((t=>t.arrayBuffer())).then((t=>(this.data=new Uint32Array(t),this.buffer=new a.u3(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)))),this._load}}class tt extends k{constructor(t,K){super(t,K),this.format=K.format,this.levels=K.levels||1,this._width=K.width,this._height=K.height,this._extension=tt._formatToExtension(this.format),(K.levelBuffers||this.buffer)&&(this._levelBuffers=K.levelBuffers||tt._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,K,D){const a=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;a.pixelStorei(a.UNPACK_ALIGNMENT,4);for(let t=0,K=this.levels;t<K;t++){const{levelID:K,levelWidth:D,levelHeight:G,levelBuffer:N}=this._levelBuffers[t];a.compressedTexImage2D(a.TEXTURE_2D,K,this.format,D,G,0,N)}return!0}onBlobLoaded(){this._levelBuffers=tt._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,K,D,a,G,N,W){const x=new Array(D);let b=t.byteOffset,n=N,e=W,i=n+a-1&~(a-1),z=e+G-1&~(G-1),I=i*z*v[K];for(let N=0;N<D;N++)x[N]={levelID:N,levelWidth:D>1?n:i,levelHeight:D>1?e:z,levelBuffer:new Uint8Array(t.buffer,b,I)},b+=I,n=n>>1||1,e=e>>1||1,i=n+a-1&~(a-1),z=e+G-1&~(G-1),I=i*z*v[K];return x}}const Kt=4,Dt=124,at=32,Gt=20,Nt=542327876,Wt=3,xt=4,bt=7,nt=19,et=2,it=0,zt=1,It=2,Zt=3,wt=1,mt=2,ut=4,dt=64,Et=512,lt=131072,Qt=808540228,Pt=4,yt={827611204:O.COMPRESSED_RGBA_S3TC_DXT1_EXT,861165636:O.COMPRESSED_RGBA_S3TC_DXT3_EXT,894720068:O.COMPRESSED_RGBA_S3TC_DXT5_EXT},qt={70:O.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:O.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:O.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:O.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:O.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:O.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:O.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:O.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:O.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT},Xt=[171,75,84,88,32,49,49,187,13,10,26,10],ht=67305985,Jt=12,Tt=16,_t=24,Ct=28,Ht=36,ot=40,Ut=44,Vt=48,st=52,Ft=56,ct=60,gt=64,Rt={[a.QE.UNSIGNED_BYTE]:1,[a.QE.UNSIGNED_SHORT]:2,[a.QE.INT]:4,[a.QE.UNSIGNED_INT]:4,[a.QE.FLOAT]:4,[a.QE.HALF_FLOAT]:8},At={[a.hR.RGBA]:4,[a.hR.RGB]:3,[a.hR.RG]:2,[a.hR.RED]:1,[a.hR.LUMINANCE]:1,[a.hR.LUMINANCE_ALPHA]:2,[a.hR.ALPHA]:1},Yt={[a.QE.UNSIGNED_SHORT_4_4_4_4]:2,[a.QE.UNSIGNED_SHORT_5_5_5_1]:2,[a.QE.UNSIGNED_SHORT_5_6_5]:2};function Lt(t){switch(t){case a.hR.RGBA:return a.hR.RGBA_INTEGER;case a.hR.RGB:return a.hR.RGB_INTEGER;case a.hR.RG:return a.hR.RG_INTEGER;case a.hR.RED:return a.hR.RED_INTEGER;default:return t}}const St={extension:{type:a.Ag.LoadParser,priority:B.T9.High},name:"loadDDS",test:t=>B.WO(t,".dds"),async load(t,K,D){const G=function(t){const K=new Uint32Array(t);if(K[0]!==Nt)throw new Error("Invalid DDS file magic word");const D=new Uint32Array(t,0,Dt/Uint32Array.BYTES_PER_ELEMENT),a=D[Wt],G=D[xt],N=D[bt],W=new Uint32Array(t,nt*Uint32Array.BYTES_PER_ELEMENT,at/Uint32Array.BYTES_PER_ELEMENT),x=W[wt];if(x&ut){const D=W[et];if(D!==Qt){const K=yt[D],W=new Uint8Array(t,Kt+Dt);return[new tt(W,{format:K,width:G,height:a,levels:N})]}const x=Kt+Dt,b=new Uint32Array(K.buffer,x,Gt/Uint32Array.BYTES_PER_ELEMENT),n=b[it],e=b[zt],i=b[It],z=b[Zt],I=qt[n];if(void 0===I)throw new Error(`DDSParser cannot parse texture data with DXGI format ${n}`);if(i===Pt)throw new Error("DDSParser does not support cubemap textures");if(6===e)throw new Error("DDSParser does not supported 3D texture data");const Z=new Array,w=Kt+Dt+Gt;if(1===z)Z.push(new Uint8Array(t,w));else{const K=v[I];let D=0,W=G,x=a;for(let t=0;t<N;t++)D+=Math.max(1,W+3&-4)*Math.max(1,x+3&-4)*K,W>>>=1,x>>>=1;let b=w;for(let K=0;K<z;K++)Z.push(new Uint8Array(t,b,D)),b+=D}return Z.map((t=>new tt(t,{format:I,width:G,height:a,levels:N})))}throw x&dt?new Error("DDSParser does not support uncompressed texture data."):x&Et?new Error("DDSParser does not supported YUV uncompressed texture data."):x&lt?new Error("DDSParser does not support single-channel (lumninance) texture data!"):x&mt?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}(await(await a.W0.ADAPTER.fetch(t)).arrayBuffer()).map((G=>{const N=new a.t5(G,{mipmap:a.E8.OFF,alphaMode:a.Gk.NO_PREMULTIPLIED_ALPHA,resolution:a.Wp.getResolutionOfUrl(t),...K.data});return B.sZ(N,D,t)}));return 1===G.length?G[0]:G},unload(t){Array.isArray(t)?t.forEach((t=>t.destroy(!0))):t.destroy(!0)}};a.XO.add(St);const ft={extension:{type:a.Ag.LoadParser,priority:B.T9.High},name:"loadKTX",test:t=>B.WO(t,".ktx"),async load(t,K,D){const G=await(await a.W0.ADAPTER.fetch(t)).arrayBuffer(),{compressed:N,uncompressed:W,kvData:x}=function(t,K,D=!1){const G=new DataView(K);if(!function(t,K){for(let D=0;D<Xt.length;D++)if(K.getUint8(D)!==Xt[D])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}(t,G))return null;const N=G.getUint32(Jt,!0)===ht,W=G.getUint32(Tt,N),x=G.getUint32(_t,N),b=G.getUint32(Ct,N),n=G.getUint32(Ht,N),e=G.getUint32(ot,N)||1,i=G.getUint32(Ut,N)||1,z=G.getUint32(Vt,N)||1,I=G.getUint32(st,N),Z=G.getUint32(Ft,N),w=G.getUint32(ct,N);if(0===e||1!==i)throw new Error("Only 2D textures are supported");if(1!==I)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==z)throw new Error("WebGL does not support array textures");const m=4,u=4,d=n+3&-4,E=e+3&-4,l=new Array(z);let Q,P=n*e;if(0===W&&(P=d*E),Q=0!==W?Rt[W]?Rt[W]*At[x]:Yt[W]:v[b],void 0===Q)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const y=D?function(t,K,D){const a=new Map;let G=0;for(;G<K;){const N=t.getUint32(gt+G,D),W=gt+G+4,x=3-(N+3)%4;if(0===N||N>K-G){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let b=0;for(;b<N&&0!==t.getUint8(W+b);b++);if(-1===b){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const n=(new TextDecoder).decode(new Uint8Array(t.buffer,W,b)),e=new DataView(t.buffer,W+b+1,N-b-1);a.set(n,e),G+=4+N+x}return a}(G,w,N):null;let q=P*Q,X=n,h=e,J=d,T=E,_=gt+w;for(let t=0;t<Z;t++){const D=G.getUint32(_,N);let a=_+4;for(let D=0;D<z;D++){let G=l[D];G||(G=l[D]=new Array(Z)),G[t]={levelID:t,levelWidth:Z>1||0!==W?X:J,levelHeight:Z>1||0!==W?h:T,levelBuffer:new Uint8Array(K,a,q)},a+=q}_+=D+4,_=_%4!=0?_+4-_%4:_,X=X>>1||1,h=h>>1||1,J=X+m-1&~(m-1),T=h+u-1&~(u-1),q=J*T*Q}return 0!==W?{uncompressed:l.map((t=>{let K=t[0].levelBuffer,D=!1;return W===a.QE.FLOAT?K=new Float32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4):W===a.QE.UNSIGNED_INT?(D=!0,K=new Uint32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)):W===a.QE.INT&&(D=!0,K=new Int32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)),{resource:new a.dZ(K,{width:t[0].levelWidth,height:t[0].levelHeight}),type:W,format:D?Lt(x):x}})),kvData:y}:{compressed:l.map((t=>new tt(null,{format:b,width:n,height:e,levels:Z,levelBuffers:t}))),kvData:y}}(t,G),b=null!=N?N:W,n={mipmap:a.E8.OFF,alphaMode:a.Gk.NO_PREMULTIPLIED_ALPHA,resolution:a.Wp.getResolutionOfUrl(t),...K.data},e=b.map((K=>{var G;b===W&&Object.assign(n,{type:K.type,format:K.format});const N=null!==(G=K.resource)&&void 0!==G?G:K,e=new a.t5(N,n);return e.ktxKeyValueData=x,B.sZ(e,D,t)}));return 1===e.length?e[0]:e},unload(t){Array.isArray(t)?t.forEach((t=>t.destroy(!0))):t.destroy(!0)}};a.XO.add(ft);const $t={extension:a.Ag.ResolveParser,test:t=>{const K=a.Wp.path.extname(t).slice(1);return["basis","ktx","dds"].includes(K)},parse:t=>{var K,D,G,N;const W=a.Wp.path.extname(t).slice(1);if("ktx"===W){const G=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(G.some((K=>t.endsWith(K))))return{resolution:parseFloat(null!==(D=null===(K=a.W0.RETINA_PREFIX.exec(t))||void 0===K?void 0:K[1])&&void 0!==D?D:"1"),format:G.find((K=>t.endsWith(K))),src:t}}return{resolution:parseFloat(null!==(N=null===(G=a.W0.RETINA_PREFIX.exec(t))||void 0===G?void 0:G[1])&&void 0!==N?N:"1"),format:W,src:t}}};a.XO.add($t);const Bt=new a.M_,Ot=4,vt=class t{constructor(t){this.renderer=t,this._rendererPremultipliedAlpha=!1}contextChange(){var t;const K=null===(t=this.renderer)||void 0===t?void 0:t.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(K&&K.alpha&&K.premultipliedAlpha)}async image(t,K,D,a){const G=new Image;return G.src=await this.base64(t,K,D,a),G}async base64(t,K,D,a){const G=this.canvas(t,a);if(void 0!==G.toBlob)return new Promise(((t,a)=>{G.toBlob((K=>{if(!K)return void a(new Error("ICanvas.toBlob failed!"));const D=new FileReader;D.onload=()=>t(D.result),D.onerror=a,D.readAsDataURL(K)}),K,D)}));if(void 0!==G.toDataURL)return G.toDataURL(K,D);if(void 0!==G.convertToBlob){const t=await G.convertToBlob({type:K,quality:D});return new Promise(((K,D)=>{const a=new FileReader;a.onload=()=>K(a.result),a.onerror=D,a.readAsDataURL(t)}))}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(K,D){const{pixels:G,width:N,height:W,flipY:x,premultipliedAlpha:b}=this._rawPixels(K,D);x&&t._flipY(G,N,W),b&&t._unpremultiplyAlpha(G);const n=new a.Wp.CanvasRenderTarget(N,W,1),e=new ImageData(new Uint8ClampedArray(G.buffer),N,W);return n.context.putImageData(e,0,0),n.canvas}pixels(K,D){const{pixels:a,width:G,height:N,flipY:W,premultipliedAlpha:x}=this._rawPixels(K,D);return W&&t._flipY(a,G,N),x&&t._unpremultiplyAlpha(a),a}_rawPixels(t,K){const D=this.renderer;if(!D)throw new Error("The Extract has already been destroyed");let G,N,W=!1,x=!1,b=!1;t&&(t instanceof a.Y7?N=t:(N=D.generateTexture(t,{region:K,resolution:D.resolution,multisample:D.multisample}),b=!0,K&&(Bt.width=K.width,Bt.height=K.height,K=Bt)));const n=D.gl;if(N){if(G=N.baseTexture.resolution,K=null!=K?K:N.frame,W=!1,x=N.baseTexture.alphaMode>0&&N.baseTexture.format===a.hR.RGBA,!b){D.renderTexture.bind(N);const t=N.framebuffer.glFramebuffers[D.CONTEXT_UID];t.blitFramebuffer&&D.framebuffer.bind(t.blitFramebuffer)}}else G=D.resolution,K||((K=Bt).width=D.width/G,K.height=D.height/G),W=!0,x=this._rendererPremultipliedAlpha,D.renderTexture.bind();const e=Math.max(Math.round(K.width*G),1),i=Math.max(Math.round(K.height*G),1),z=new Uint8Array(Ot*e*i);return n.readPixels(Math.round(K.x*G),Math.round(K.y*G),e,i,n.RGBA,n.UNSIGNED_BYTE,z),b&&(null==N||N.destroy(!0)),{pixels:z,width:e,height:i,flipY:W,premultipliedAlpha:x}}destroy(){this.renderer=null}static _flipY(t,K,D){const a=K<<2,G=D>>1,N=new Uint8Array(a);for(let K=0;K<G;K++){const G=K*a,W=(D-K-1)*a;N.set(t.subarray(G,G+a)),t.copyWithin(G,W,W+a),t.set(N,W)}}static _unpremultiplyAlpha(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));const K=t.length;for(let D=0;D<K;D+=4){const K=t[D+3];if(0!==K){const a=255.001/K;t[D]=t[D]*a+.5,t[D+1]=t[D+1]*a+.5,t[D+2]=t[D+2]*a+.5}}}};vt.extension={name:"extract",type:a.Ag.RendererSystem};let pt=vt;a.XO.add(pt),D(366628);var jt=D(401947);D(209218),G.mc;class rt{constructor(t,K,D){this.geometry=new a.V2,this.indexBuffer=null,this.size=D,this.dynamicProperties=[],this.staticProperties=[];for(let D=0;D<t.length;++D){let G=t[D];G={attributeName:G.attributeName,size:G.size,uploadFunction:G.uploadFunction,type:G.type||a.QE.FLOAT,offset:G.offset},K[D]?this.dynamicProperties.push(G):this.staticProperties.push(G)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let K=0;this.indexBuffer=new a.hp(a.Wp.createIndicesForQuads(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let t=0;t<this.dynamicProperties.length;++t){const D=this.dynamicProperties[t];D.offset=K,K+=D.size,this.dynamicStride+=D.size}const D=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(D),this.dynamicDataUint32=new Uint32Array(D),this.dynamicBuffer=new a.hp(this.dynamicData,!1,!1);let G=0;this.staticStride=0;for(let t=0;t<this.staticProperties.length;++t){const K=this.staticProperties[t];K.offset=G,G+=K.size,this.staticStride+=K.size}const N=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(N),this.staticDataUint32=new Uint32Array(N),this.staticBuffer=new a.hp(this.staticData,!0,!1);for(let K=0;K<this.dynamicProperties.length;++K){const D=this.dynamicProperties[K];t.addAttribute(D.attributeName,this.dynamicBuffer,0,D.type===a.QE.UNSIGNED_BYTE,D.type,4*this.dynamicStride,4*D.offset)}for(let K=0;K<this.staticProperties.length;++K){const D=this.staticProperties[K];t.addAttribute(D.attributeName,this.staticBuffer,0,D.type===a.QE.UNSIGNED_BYTE,D.type,4*this.staticStride,4*D.offset)}}uploadDynamic(t,K,D){for(let G=0;G<this.dynamicProperties.length;G++){const N=this.dynamicProperties[G];N.uploadFunction(t,K,D,N.type===a.QE.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,N.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,K,D){for(let G=0;G<this.staticProperties.length;G++){const N=this.staticProperties[G];N.uploadFunction(t,K,D,N.type===a.QE.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,N.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var Mt=`varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}`,kt=`attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n`;class tK extends a.Pt{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new a.uq,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:a.QE.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=a.Mt.from(kt,Mt,{}),this.state=a.Uw.for2d()}render(t){const K=t.children,D=t._maxSize,G=t._batchSize,N=this.renderer;let W=K.length;if(0===W)return;W>D&&!t.autoResize&&(W=D);let x=t._buffers;x||(x=t._buffers=this.generateBuffers(t));const b=K[0]._texture.baseTexture,n=b.alphaMode>0;this.state.blendMode=a.Wp.correctBlendMode(t.blendMode,n),N.state.set(this.state);const e=N.gl,i=t.worldTransform.copyTo(this.tempMatrix);i.prepend(N.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=i.toArray(!0),this.shader.uniforms.uColor=a.Q1.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,n).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=b,this.renderer.shader.bind(this.shader);let z=!1;for(let D=0,a=0;D<W;D+=G,a+=1){let b=W-D;b>G&&(b=G),a>=x.length&&x.push(this._generateOneMoreBuffer(t));const n=x[a];n.uploadDynamic(K,D,b);const i=t._bufferUpdateIDs[a]||0;z=z||n._updateID<i,z&&(n._updateID=t._updateID,n.uploadStatic(K,D,b)),N.geometry.bind(n.geometry),e.drawElements(e.TRIANGLES,6*b,e.UNSIGNED_SHORT,0)}}generateBuffers(t){const K=[],D=t._maxSize,a=t._batchSize,G=t._properties;for(let t=0;t<D;t+=a)K.push(new rt(this.properties,G,a));return K}_generateOneMoreBuffer(t){const K=t._batchSize,D=t._properties;return new rt(this.properties,D,K)}uploadVertices(t,K,D,a,G,N){let W=0,x=0,b=0,n=0;for(let e=0;e<D;++e){const D=t[K+e],i=D._texture,z=D.scale.x,I=D.scale.y,Z=i.trim,w=i.orig;Z?(x=Z.x-D.anchor.x*w.width,W=x+Z.width,n=Z.y-D.anchor.y*w.height,b=n+Z.height):(W=w.width*(1-D.anchor.x),x=w.width*-D.anchor.x,b=w.height*(1-D.anchor.y),n=w.height*-D.anchor.y),a[N]=x*z,a[N+1]=n*I,a[N+G]=W*z,a[N+G+1]=n*I,a[N+2*G]=W*z,a[N+2*G+1]=b*I,a[N+3*G]=x*z,a[N+3*G+1]=b*I,N+=4*G}}uploadPosition(t,K,D,a,G,N){for(let W=0;W<D;W++){const D=t[K+W].position;a[N]=D.x,a[N+1]=D.y,a[N+G]=D.x,a[N+G+1]=D.y,a[N+2*G]=D.x,a[N+2*G+1]=D.y,a[N+3*G]=D.x,a[N+3*G+1]=D.y,N+=4*G}}uploadRotation(t,K,D,a,G,N){for(let W=0;W<D;W++){const D=t[K+W].rotation;a[N]=D,a[N+G]=D,a[N+2*G]=D,a[N+3*G]=D,N+=4*G}}uploadUvs(t,K,D,a,G,N){for(let W=0;W<D;++W){const D=t[K+W]._texture._uvs;D?(a[N]=D.x0,a[N+1]=D.y0,a[N+G]=D.x1,a[N+G+1]=D.y1,a[N+2*G]=D.x2,a[N+2*G+1]=D.y2,a[N+3*G]=D.x3,a[N+3*G+1]=D.y3,N+=4*G):(a[N]=0,a[N+1]=0,a[N+G]=0,a[N+G+1]=0,a[N+2*G]=0,a[N+2*G+1]=0,a[N+3*G]=0,a[N+3*G+1]=0,N+=4*G)}}uploadTint(t,K,D,G,N,W){for(let x=0;x<D;++x){const D=t[K+x],b=a.Q1.shared.setValue(D._tintRGB).toPremultiplied(D.alpha,D.texture.baseTexture.alphaMode>0);G[W]=b,G[W+N]=b,G[W+2*N]=b,G[W+3*N]=b,W+=4*N}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}tK.extension={name:"particle",type:a.Ag.RendererPlugin},a.XO.add(tK),D(344944),N.k,new a.bR,N.k;var KK=`#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n`,DK=`#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n`,aK=`#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n`,GK=`#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n`,NK=`#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n`;const WK=new a.uq;class xK extends a.Pt{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new a.X1,this.state=a.Uw.for2d()}contextChange(){const t=this.renderer,K={globals:t.globalUniforms};this.simpleShader=a.Mt.from(GK,NK,K),this.shader=t.context.webGLVersion>1?a.Mt.from(DK,KK,K):a.Mt.from(GK,aK,K)}render(t){const K=this.renderer,D=this.quad;let G=D.vertices;G[0]=G[6]=t._width*-t.anchor.x,G[1]=G[3]=t._height*-t.anchor.y,G[2]=G[4]=t._width*(1-t.anchor.x),G[5]=G[7]=t._height*(1-t.anchor.y);const N=t.uvRespectAnchor?t.anchor.x:0,W=t.uvRespectAnchor?t.anchor.y:0;G=D.uvs,G[0]=G[6]=-N,G[1]=G[3]=-W,G[2]=G[4]=1-N,G[5]=G[7]=1-W,D.invalidate();const x=t._texture,b=x.baseTexture,n=b.alphaMode>0,e=t.tileTransform.localTransform,i=t.uvMatrix;let z=b.isPowerOfTwo&&x.frame.width===b.width&&x.frame.height===b.height;z&&(b._glTextures[K.CONTEXT_UID]?z=b.wrapMode!==a.uR.CLAMP:b.wrapMode===a.uR.CLAMP&&(b.wrapMode=a.uR.REPEAT));const I=z?this.simpleShader:this.shader,Z=x.width,w=x.height,m=t._width,u=t._height;WK.set(e.a*Z/m,e.b*Z/u,e.c*w/m,e.d*w/u,e.tx/m,e.ty/u),WK.invert(),z?WK.prepend(i.mapCoord):(I.uniforms.uMapCoord=i.mapCoord.toArray(!0),I.uniforms.uClampFrame=i.uClampFrame,I.uniforms.uClampOffset=i.uClampOffset),I.uniforms.uTransform=WK.toArray(!0),I.uniforms.uColor=a.Q1.shared.setValue(t.tint).premultiply(t.worldAlpha,n).toArray(I.uniforms.uColor),I.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),I.uniforms.uSampler=x,K.shader.bind(I),K.geometry.bind(D),this.state.blendMode=a.Wp.correctBlendMode(t.blendMode,n),K.state.set(this.state),K.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}xK.extension={name:"tilingSprite",type:a.Ag.RendererPlugin},a.XO.add(xK);const bK=class t{constructor(t,K,D=null){this.linkedSheets=[],this._texture=t instanceof a.gP?t:null,this.baseTexture=t instanceof a.t5?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=K;const G=this.baseTexture.resource;this.resolution=this._updateResolution(D||(G?G.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:K}=this.data.meta;let D=a.Wp.getResolutionOfUrl(t,null);return null===D&&(D=parseFloat(null!=K?K:"1")),1!==D&&this.baseTexture.setResolution(D),D}parse(){return new Promise((K=>{this._callback=K,this._batchIndex=0,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()}))}_processFrames(K){let D=K;const G=t.BATCH_SIZE;for(;D-K<G&&D<this._frameKeys.length;){const t=this._frameKeys[D],K=this._frames[t],G=K.frame;if(G){let D=null,N=null;const W=!1!==K.trimmed&&K.sourceSize?K.sourceSize:K.frame,x=new a.M_(0,0,Math.floor(W.w)/this.resolution,Math.floor(W.h)/this.resolution);D=K.rotated?new a.M_(Math.floor(G.x)/this.resolution,Math.floor(G.y)/this.resolution,Math.floor(G.h)/this.resolution,Math.floor(G.w)/this.resolution):new a.M_(Math.floor(G.x)/this.resolution,Math.floor(G.y)/this.resolution,Math.floor(G.w)/this.resolution,Math.floor(G.h)/this.resolution),!1!==K.trimmed&&K.spriteSourceSize&&(N=new a.M_(Math.floor(K.spriteSourceSize.x)/this.resolution,Math.floor(K.spriteSourceSize.y)/this.resolution,Math.floor(G.w)/this.resolution,Math.floor(G.h)/this.resolution)),this.textures[t]=new a.gP(this.baseTexture,D,x,N,K.rotated?2:0,K.anchor,K.borders),a.gP.addToCache(this.textures[t],t.toString())}D++}}_processAnimations(){const t=this.data.animations||{};for(const K in t){this.animations[K]=[];for(let D=0;D<t[K].length;D++){const a=t[K][D];this.animations[K].push(this.textures[a])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout((()=>{this._batchIndex*t.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())}),0)}destroy(t=!1){var K;for(const t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null===(K=this._texture)||void 0===K||K.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};bK.BATCH_SIZE=1e3;let nK=bK;const eK=["jpg","png","jpeg","avif","webp"];function iK(t,K,D){const G={};if(t.forEach((t=>{G[t]=K})),Object.keys(K.textures).forEach((t=>{G[t]=K.textures[t]})),!D){const D=a.Wp.path.dirname(t[0]);K.linkedSheets.forEach(((t,a)=>{const N=iK([`${D}/${K.data.meta.related_multi_packs[a]}`],t,!0);Object.assign(G,N)}))}return G}const zK={extension:a.Ag.Asset,cache:{test:t=>t instanceof nK,getCacheableAssets:(t,K)=>iK(t,K,!1)},resolver:{test:t=>{const K=t.split("?")[0].split("."),D=K.pop(),a=K.pop();return"json"===D&&eK.includes(a)},parse:t=>{var K,D;const G=t.split(".");return{resolution:parseFloat(null!==(D=null===(K=a.W0.RETINA_PREFIX.exec(t))||void 0===K?void 0:K[1])&&void 0!==D?D:"1"),format:G[G.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:a.Ag.LoadParser,priority:B.T9.Normal},testParse:async(t,K)=>".json"===a.Wp.path.extname(K.src).toLowerCase()&&!!t.frames,async parse(t,K,D){var G,N;let W=a.Wp.path.dirname(K.src);W&&W.lastIndexOf("/")!==W.length-1&&(W+="/");let x=W+t.meta.image;x=B.Y8(x,K.src);const b=(await D.load([x]))[x],n=new nK(b.baseTexture,t,K.src);await n.parse();const e=null===(G=null==t?void 0:t.meta)||void 0===G?void 0:G.related_multi_packs;if(Array.isArray(e)){const t=[];for(const a of e){if("string"!=typeof a)continue;let G=W+a;(null===(N=K.data)||void 0===N?void 0:N.ignoreMultiPack)||(G=B.Y8(G,K.src),t.push(D.load({src:G,data:{ignoreMultiPack:!0}})))}const a=await Promise.all(t);n.linkedSheets=a,a.forEach((t=>{t.linkedSheets=[n].concat(n.linkedSheets.filter((K=>K!==t)))}))}return n},unload(t){t.destroy(!0)}}};a.XO.add(zK);var IK=D(722711);class ZK{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class wK{static test(t){return"string"==typeof t&&t.startsWith("info face=")}static parse(t){const K=t.match(/^[a-z]+\s+.+$/gm),D={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const t in K){const a=K[t].match(/^[a-z]+/gm)[0],G=K[t].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),N={};for(const t in G){const K=G[t].split("="),D=K[0],a=K[1].replace(/"/gm,""),W=parseFloat(a),x=isNaN(W)?a:W;N[D]=x}D[a].push(N)}const a=new ZK;return D.info.forEach((t=>a.info.push({face:t.face,size:parseInt(t.size,10)}))),D.common.forEach((t=>a.common.push({lineHeight:parseInt(t.lineHeight,10)}))),D.page.forEach((t=>a.page.push({id:parseInt(t.id,10),file:t.file}))),D.char.forEach((t=>a.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)}))),D.kerning.forEach((t=>a.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)}))),D.distanceField.forEach((t=>a.distanceField.push({distanceRange:parseInt(t.distanceRange,10),fieldType:t.fieldType}))),a}}class mK{static test(t){const K=t;return"string"!=typeof t&&"getElementsByTagName"in t&&K.getElementsByTagName("page").length&&null!==K.getElementsByTagName("info")[0].getAttribute("face")}static parse(t){const K=new ZK,D=t.getElementsByTagName("info"),a=t.getElementsByTagName("common"),G=t.getElementsByTagName("page"),N=t.getElementsByTagName("char"),W=t.getElementsByTagName("kerning"),x=t.getElementsByTagName("distanceField");for(let t=0;t<D.length;t++)K.info.push({face:D[t].getAttribute("face"),size:parseInt(D[t].getAttribute("size"),10)});for(let t=0;t<a.length;t++)K.common.push({lineHeight:parseInt(a[t].getAttribute("lineHeight"),10)});for(let t=0;t<G.length;t++)K.page.push({id:parseInt(G[t].getAttribute("id"),10)||0,file:G[t].getAttribute("file")});for(let t=0;t<N.length;t++){const D=N[t];K.char.push({id:parseInt(D.getAttribute("id"),10),page:parseInt(D.getAttribute("page"),10)||0,x:parseInt(D.getAttribute("x"),10),y:parseInt(D.getAttribute("y"),10),width:parseInt(D.getAttribute("width"),10),height:parseInt(D.getAttribute("height"),10),xoffset:parseInt(D.getAttribute("xoffset"),10),yoffset:parseInt(D.getAttribute("yoffset"),10),xadvance:parseInt(D.getAttribute("xadvance"),10)})}for(let t=0;t<W.length;t++)K.kerning.push({first:parseInt(W[t].getAttribute("first"),10),second:parseInt(W[t].getAttribute("second"),10),amount:parseInt(W[t].getAttribute("amount"),10)});for(let t=0;t<x.length;t++)K.distanceField.push({fieldType:x[t].getAttribute("fieldType"),distanceRange:parseInt(x[t].getAttribute("distanceRange"),10)});return K}}class uK{static test(t){return!("string"!=typeof t||!t.includes("<font>"))&&mK.test(a.W0.ADAPTER.parseXML(t))}static parse(t){return mK.parse(a.W0.ADAPTER.parseXML(t))}}const dK=[wK,mK,uK];function EK(t,K,D,G,N,W,x){const b=D.text,n=D.fontProperties;K.translate(G,N),K.scale(W,W);const e=x.strokeThickness/2,i=-x.strokeThickness/2;if(K.font=x.toFontString(),K.lineWidth=x.strokeThickness,K.textBaseline=x.textBaseline,K.lineJoin=x.lineJoin,K.miterLimit=x.miterLimit,K.fillStyle=function(t,K,D,a,G,N){const W=D.fill;if(!Array.isArray(W))return W;if(1===W.length)return W[0];let x;const b=D.dropShadow?D.dropShadowDistance:0,n=D.padding||0,e=t.width/a-b-2*n,i=t.height/a-b-2*n,z=W.slice(),I=D.fillGradientStops.slice();if(!I.length){const t=z.length+1;for(let K=1;K<t;++K)I.push(K/t)}if(z.unshift(W[0]),I.unshift(0),z.push(W[W.length-1]),I.push(1),D.fillGradientType===IK.T.LINEAR_VERTICAL){x=K.createLinearGradient(e/2,n,e/2,i+n);let t=0;const a=(N.fontProperties.fontSize+D.strokeThickness)/i;for(let K=0;K<G.length;K++){const D=N.lineHeight*K;for(let K=0;K<z.length;K++){let G=0;G="number"==typeof I[K]?I[K]:K/z.length;const N=D/i+G*a;let W=Math.max(t,N);W=Math.min(W,1),x.addColorStop(W,z[K]),t=W}}}else{x=K.createLinearGradient(n,i/2,e+n,i/2);const t=z.length+1;let D=1;for(let K=0;K<z.length;K++){let a;a="number"==typeof I[K]?I[K]:D/t,x.addColorStop(a,z[K]),D++}}return x}(t,K,x,W,[b],D),K.strokeStyle=x.stroke,x.dropShadow){const t=x.dropShadowColor,D=x.dropShadowBlur*W,G=x.dropShadowDistance*W;K.shadowColor=a.Q1.shared.setValue(t).setAlpha(x.dropShadowAlpha).toRgbaString(),K.shadowBlur=D,K.shadowOffsetX=Math.cos(x.dropShadowAngle)*G,K.shadowOffsetY=Math.sin(x.dropShadowAngle)*G}else K.shadowColor="black",K.shadowBlur=0,K.shadowOffsetX=0,K.shadowOffsetY=0;x.stroke&&x.strokeThickness&&K.strokeText(b,e,i+D.lineHeight-n.descent),x.fill&&K.fillText(b,e,i+D.lineHeight-n.descent),K.setTransform(1,0,0,1,0,0),K.fillStyle="rgba(0, 0, 0, 0)"}function lK(t){return Array.from?Array.from(t):t.split("")}function QK(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}const PK=class t{constructor(t,K,D){var G,N;const[W]=t.info,[x]=t.common,[b]=t.page,[n]=t.distanceField,e=a.Wp.getResolutionOfUrl(b.file),i={};this._ownsTextures=D,this.font=W.face,this.size=W.size,this.lineHeight=x.lineHeight/e,this.chars={},this.pageTextures=i;for(let D=0;D<t.page.length;D++){const{id:G,file:N}=t.page[D];i[G]=K instanceof Array?K[D]:K[N],(null==n?void 0:n.fieldType)&&"none"!==n.fieldType&&(i[G].baseTexture.alphaMode=a.Gk.NO_PREMULTIPLIED_ALPHA,i[G].baseTexture.mipmap=a.E8.OFF)}for(let K=0;K<t.char.length;K++){const{id:D,page:G}=t.char[K];let{x:N,y:W,width:x,height:b,xoffset:n,yoffset:z,xadvance:I}=t.char[K];N/=e,W/=e,x/=e,b/=e,n/=e,z/=e,I/=e;const Z=new a.M_(N+i[G].frame.x/e,W+i[G].frame.y/e,x,b);this.chars[D]={xOffset:n,yOffset:z,xAdvance:I,kerning:{},texture:new a.gP(i[G].baseTexture,Z),page:G}}for(let K=0;K<t.kerning.length;K++){let{first:D,second:a,amount:G}=t.kerning[K];D/=e,a/=e,G/=e,this.chars[a]&&(this.chars[a].kerning[D]=G)}this.distanceFieldRange=null==n?void 0:n.distanceRange,this.distanceFieldType=null!==(N=null===(G=null==n?void 0:n.fieldType)||void 0===G?void 0:G.toLowerCase())&&void 0!==N?N:"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(K,D,G){let N;if(K instanceof ZK)N=K;else{const t=function(t){for(let K=0;K<dK.length;K++)if(dK[K].test(t))return dK[K];return null}(K);if(!t)throw new Error("Unrecognized data format for font.");N=t.parse(K)}D instanceof a.gP&&(D=[D]);const W=new t(N,D,G);return t.available[W.font]=W,W}static uninstall(K){const D=t.available[K];if(!D)throw new Error(`No font found named '${K}'`);D.destroy(),delete t.available[K]}static from(K,D,G){if(!K)throw new Error("[BitmapFont] Property `name` is required.");const{chars:N,padding:W,resolution:x,textureWidth:b,textureHeight:n,...e}=Object.assign({},t.defaultOptions,G),i=function(t){"string"==typeof t&&(t=[t]);const K=[];for(let D=0,a=t.length;D<a;D++){const a=t[D];if(Array.isArray(a)){if(2!==a.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${a.length}.`);const t=a[0].charCodeAt(0),D=a[1].charCodeAt(0);if(D<t)throw new Error("[BitmapFont]: Invalid character range.");for(let a=t,G=D;a<=G;a++)K.push(String.fromCharCode(a))}else K.push(...lK(a))}if(0===K.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return K}(N),z=D instanceof IK.xJ?D:new IK.xJ(D),I=b,Z=new ZK;Z.info[0]={face:z.fontFamily,size:z.fontSize},Z.common[0]={lineHeight:z.fontSize};let w,m,u,d=0,E=0,l=0;const Q=[],P=[];for(let t=0;t<i.length;t++){w||(w=a.W0.ADAPTER.createCanvas(),w.width=b,w.height=n,m=w.getContext("2d"),u=new a.t5(w,{resolution:x,...e}),Q.push(u),P.push(new a.gP(u)),Z.page.push({id:P.length-1,file:""}));const K=i[t],D=IK.Z1.measureText(K,z,!1,w),G=D.width,N=Math.ceil(D.height),y=Math.ceil(("italic"===z.fontStyle?2:1)*G);if(E>=n-N*x){if(0===E)throw new Error(`[BitmapFont] textureHeight ${n}px is too small (fontFamily: '${z.fontFamily}', fontSize: ${z.fontSize}px, char: '${K}')`);--t,w=null,m=null,u=null,E=0,d=0,l=0;continue}if(l=Math.max(N+D.fontProperties.descent,l),y*x+d>=I){if(0===d)throw new Error(`[BitmapFont] textureWidth ${b}px is too small (fontFamily: '${z.fontFamily}', fontSize: ${z.fontSize}px, char: '${K}')`);--t,E+=l*x,E=Math.ceil(E),d=0,l=0;continue}EK(w,m,D,d,E,x,z);const q=QK(D.text);Z.char.push({id:q,page:P.length-1,x:d/x,y:E/x,width:y,height:N,xoffset:0,yoffset:0,xadvance:G-(z.dropShadow?z.dropShadowDistance:0)-(z.stroke?z.strokeThickness:0)}),d+=(y+2*W)*x,d=Math.ceil(d)}if(!(null==G?void 0:G.skipKerning))for(let t=0,K=i.length;t<K;t++){const D=i[t];for(let t=0;t<K;t++){const K=i[t],a=m.measureText(D).width,G=m.measureText(K).width,N=m.measureText(D+K).width-(a+G);N&&Z.kerning.push({first:QK(D),second:QK(K),amount:N})}}const y=new t(Z,P,!0);return void 0!==t.available[K]&&t.uninstall(K),t.available[K]=y,y}};PK.ALPHA=[["a","z"],["A","Z"]," "],PK.NUMERIC=[["0","9"]],PK.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],PK.ASCII=[[" ","~"]],PK.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:PK.ALPHANUMERIC},PK.available={};let yK=PK;var qK=`// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // Gamma correction for coverage-like alpha\r\n  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r\n  float gamma = mix(1.0, 1.0 / 2.2, luma);\r\n  float coverage = pow(uColor.a * alpha, gamma);  \r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, coverage);\r\n}\r\n`,XK=`// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n`;const hK=[],JK=[],TK=[];(class t extends G.mc{constructor(K,D={}){super();const{align:G,tint:N,maxWidth:W,letterSpacing:x,fontName:b,fontSize:n}=Object.assign({},t.styleDefaults,D);if(!yK.available[b])throw new Error(`Missing BitmapFont "${b}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=G,this._tintColor=new a.Q1(N),this._font=void 0,this._fontName=b,this._fontSize=n,this.text=K,this._maxWidth=W,this._maxLineHeight=0,this._letterSpacing=x,this._anchor=new a.oA((()=>{this.dirty=!0}),this,0,0),this._roundPixels=a.W0.ROUND_PIXELS,this.dirty=!0,this._resolution=a.W0.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var t;const K=yK.available[this._fontName],D=this.fontSize,G=D/K.size,N=new a.bR,W=[],x=[],b=[],n=lK(this._text.replace(/(?:\r\n|\r)/g,`\n`)||" "),e=this._maxWidth*K.size/D,i="none"===K.distanceFieldType?hK:JK;let z=null,I=0,Z=0,w=0,m=-1,u=0,d=0,E=0,l=0;for(let t=0;t<n.length;t++){const D=n[t],G=QK(D);if(/(?:\s)/.test(D)&&(m=t,u=I,l++),"\r"===D||D===`\n`){x.push(I),b.push(-1),Z=Math.max(Z,I),++w,++d,N.x=0,N.y+=K.lineHeight,z=null,l=0;continue}const i=K.chars[G];if(!i)continue;z&&i.kerning[z]&&(N.x+=i.kerning[z]);const Q=TK.pop()||{texture:a.gP.EMPTY,line:0,charCode:0,prevSpaces:0,position:new a.bR};Q.texture=i.texture,Q.line=w,Q.charCode=G,Q.position.x=Math.round(N.x+i.xOffset+this._letterSpacing/2),Q.position.y=Math.round(N.y+i.yOffset),Q.prevSpaces=l,W.push(Q),I=Q.position.x+Math.max(i.xAdvance-i.xOffset,i.texture.orig.width),N.x+=i.xAdvance+this._letterSpacing,E=Math.max(E,i.yOffset+i.texture.height),z=G,-1!==m&&e>0&&N.x>e&&(++d,a.Wp.removeItems(W,1+m-d,1+t-m),t=m,m=-1,x.push(u),b.push(W.length>0?W[W.length-1].prevSpaces:0),Z=Math.max(Z,u),w++,N.x=0,N.y+=K.lineHeight,z=null,l=0)}const Q=n[n.length-1];"\r"!==Q&&Q!==`\n`&&(/(?:\s)/.test(Q)&&(I=u),x.push(I),Z=Math.max(Z,I),b.push(-1));const P=[];for(let t=0;t<=w;t++){let K=0;"right"===this._align?K=Z-x[t]:"center"===this._align?K=(Z-x[t])/2:"justify"===this._align&&(K=b[t]<0?0:(Z-x[t])/b[t]),P.push(K)}const y=W.length,q={},X=[],h=this._activePagesMeshData;i.push(...h);for(let t=0;t<y;t++){const D=W[t].texture,G=D.baseTexture.uid;if(!q[G]){let t=i.pop();if(!t){const D=new jt.u;let G,N;"none"===K.distanceFieldType?(G=new jt.PX(a.gP.EMPTY),N=a.B9.NORMAL):(G=new jt.PX(a.gP.EMPTY,{program:a.BP.from(XK,qK),uniforms:{uFWidth:0}}),N=a.B9.NORMAL_NPM);const W=new jt.e(D,G);W.blendMode=N,t={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:W,vertices:null,uvs:null,indices:null}}t.index=0,t.indexCount=0,t.vertexCount=0,t.uvsCount=0,t.total=0;const{_textureCache:N}=this;N[G]=N[G]||new a.gP(D.baseTexture),t.mesh.texture=N[G],t.mesh.tint=this._tintColor.value,X.push(t),q[G]=t}q[G].total++}for(let t=0;t<h.length;t++)X.includes(h[t])||this.removeChild(h[t].mesh);for(let t=0;t<X.length;t++)X[t].mesh.parent!==this&&this.addChild(X[t].mesh);this._activePagesMeshData=X;for(const K in q){const D=q[K],a=D.total;if(!((null===(t=D.indices)||void 0===t?void 0:t.length)>6*a)||D.vertices.length<2*jt.e.BATCHABLE_SIZE)D.vertices=new Float32Array(4*2*a),D.uvs=new Float32Array(4*2*a),D.indices=new Uint16Array(6*a);else{const t=D.total,K=D.vertices;for(let D=4*t*2;D<K.length;D++)K[D]=0}D.mesh.size=6*a}for(let t=0;t<y;t++){const K=W[t];let D=K.position.x+P[K.line]*("justify"===this._align?K.prevSpaces:1);this._roundPixels&&(D=Math.round(D));const a=D*G,N=K.position.y*G,x=K.texture,b=q[x.baseTexture.uid],n=x.frame,e=x._uvs,i=b.index++;b.indices[6*i+0]=0+4*i,b.indices[6*i+1]=1+4*i,b.indices[6*i+2]=2+4*i,b.indices[6*i+3]=0+4*i,b.indices[6*i+4]=2+4*i,b.indices[6*i+5]=3+4*i,b.vertices[8*i+0]=a,b.vertices[8*i+1]=N,b.vertices[8*i+2]=a+n.width*G,b.vertices[8*i+3]=N,b.vertices[8*i+4]=a+n.width*G,b.vertices[8*i+5]=N+n.height*G,b.vertices[8*i+6]=a,b.vertices[8*i+7]=N+n.height*G,b.uvs[8*i+0]=e.x0,b.uvs[8*i+1]=e.y0,b.uvs[8*i+2]=e.x1,b.uvs[8*i+3]=e.y1,b.uvs[8*i+4]=e.x2,b.uvs[8*i+5]=e.y2,b.uvs[8*i+6]=e.x3,b.uvs[8*i+7]=e.y3}this._textWidth=Z*G,this._textHeight=(N.y+K.lineHeight)*G;for(const t in q){const K=q[t];if(0!==this.anchor.x||0!==this.anchor.y){let t=0;const D=this._textWidth*this.anchor.x,a=this._textHeight*this.anchor.y;for(let G=0;G<K.total;G++)K.vertices[t++]-=D,K.vertices[t++]-=a,K.vertices[t++]-=D,K.vertices[t++]-=a,K.vertices[t++]-=D,K.vertices[t++]-=a,K.vertices[t++]-=D,K.vertices[t++]-=a}this._maxLineHeight=E*G;const D=K.mesh.geometry.getBuffer("aVertexPosition"),a=K.mesh.geometry.getBuffer("aTextureCoord"),N=K.mesh.geometry.getIndex();D.data=K.vertices,a.data=K.uvs,N.data=K.indices,D.update(),a.update(),N.update()}for(let t=0;t<W.length;t++)TK.push(W[t]);this._font=K,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:K,distanceFieldType:D,size:a}=yK.available[this._fontName];if("none"!==D){const{a:D,b:G,c:N,d:W}=this.worldTransform,x=Math.sqrt(D*D+G*G),b=Math.sqrt(N*N+W*W),n=(Math.abs(x)+Math.abs(b))/2,e=this.fontSize/a,i=t._view.resolution;for(const t of this._activePagesMeshData)t.mesh.shader.uniforms.uFWidth=n*K*e*i}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=yK.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let K=0;K<this._activePagesMeshData.length;K++)this._activePagesMeshData[K].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!yK.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){var t;return null!==(t=this._fontSize)&&void 0!==t?t:yK.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(null!=t?t:""),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:K}=this,D="none"===yK.available[this._fontName].distanceFieldType?hK:JK;D.push(...this._activePagesMeshData);for(const t of this._activePagesMeshData)this.removeChild(t.mesh);this._activePagesMeshData=[],D.filter((t=>K[t.mesh.texture.baseTexture.uid])).forEach((t=>{t.mesh.texture=a.gP.EMPTY}));for(const t in K)K[t].destroy(),delete K[t];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}}).styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const _K=[".xml",".fnt"],CK={extension:{type:a.Ag.LoadParser,priority:B.T9.Normal},name:"loadBitmapFont",test:t=>_K.includes(a.Wp.path.extname(t).toLowerCase()),testParse:async t=>wK.test(t)||uK.test(t),async parse(t,K,D){const a=wK.test(t)?wK.parse(t):uK.parse(t),{src:G}=K,{page:N}=a,W=[];for(let t=0;t<N.length;++t){let K=N[t].file;K=B.Y8(K,G),W.push(K)}const x=await D.load(W),b=W.map((t=>x[t]));return yK.install(a,b,!0)},load:async(t,K)=>(await a.W0.ADAPTER.fetch(t)).text(),unload(t){t.destroy()}};a.XO.add(CK);const HK=class t extends IK.xJ{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(K){return new t(Object.keys(t.defaultOptions).reduce(((t,D)=>({...t,[D]:K[D]})),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach((K=>{URL.revokeObjectURL(K.src),K.refs--,0===K.refs&&(K.fontFace&&document.fonts.delete(K.fontFace),delete t.availableFonts[K.originalUrl])})),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(K,D={}){const{availableFonts:G}=t;if(G[K]){const t=G[K];return this._fonts.push(t),t.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return a.W0.ADAPTER.fetch(K).then((t=>t.blob())).then((async t=>new Promise(((K,D)=>{const a=URL.createObjectURL(t),G=new FileReader;G.onload=()=>K([a,G.result]),G.onerror=D,G.readAsDataURL(t)})))).then((async([t,N])=>{const W=Object.assign({family:a.Wp.path.basename(K,a.Wp.path.extname(K)),weight:"normal",style:"normal",display:"auto",src:t,dataSrc:N,refs:1,originalUrl:K,fontFace:null},D);G[K]=W,this._fonts.push(W),this.styleID++;const x=new FontFace(W.family,`url(${W.src})`,{weight:W.weight,style:W.style,display:W.display});W.fontFace=x,await x.load(),document.fonts.add(x),await document.fonts.ready,this.styleID++,this.fontsDirty=!0}))}addOverride(...t){const K=t.filter((t=>!this._overrides.includes(t)));K.length>0&&(this._overrides.push(...K),this.styleID++)}removeOverride(...t){const K=t.filter((t=>this._overrides.includes(t)));K.length>0&&(this._overrides=this._overrides.filter((t=>!K.includes(t))),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce(((t,K)=>`${t}\n            @font-face {\n                font-family: "${K.family}";\n                src: url('${K.dataSrc}');\n                font-weight: ${K.weight};\n                font-style: ${K.style};\n                font-display: ${K.display};\n            }`),this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=a.Wp.rgb2hex(t)),"number"==typeof t?a.Wp.hex2string(t):t}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor);const K=this.dropShadowAlpha,D=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),a=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&K<1&&(t+=(255*K|0).toString(16).padStart(2,"0"));const G=`${D}px ${a}px`;return this.dropShadowBlur>0?`text-shadow: ${G} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${G} ${t}`}reset(){Object.assign(this,t.defaultOptions)}onBeforeDraw(){const{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise((t=>setTimeout(t,100))):Promise.resolve()}get isSafari(){const{userAgent:t}=a.W0.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};HK.availableFonts={},HK.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let oK=HK;const UK=class t extends N.k{constructor(K="",D={}){var G;super(a.gP.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const N=new Image,W=a.gP.from(N,{scaleMode:a.W0.SCALE_MODE,resourceOptions:{autoLoad:!1}});W.orig=new a.M_,W.trim=new a.M_,this.texture=W;const x="http://www.w3.org/2000/svg",b="http://www.w3.org/1999/xhtml",n=document.createElementNS(x,"svg"),e=document.createElementNS(x,"foreignObject"),i=document.createElementNS(b,"div"),z=document.createElementNS(b,"style");e.setAttribute("width","10000"),e.setAttribute("height","10000"),e.style.overflow="hidden",n.appendChild(e),this.maxWidth=t.defaultMaxWidth,this.maxHeight=t.defaultMaxHeight,this._domElement=i,this._styleElement=z,this._svgRoot=n,this._foreignObject=e,this._foreignObject.appendChild(z),this._foreignObject.appendChild(i),this._image=N,this._loadImage=new Image,this._autoResolution=t.defaultAutoResolution,this._resolution=null!==(G=t.defaultResolution)&&void 0!==G?G:a.W0.RESOLUTION,this.text=K,this.style=D}measureText(t){var K,D;const{text:a,style:G,resolution:N}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:a,style:G.toCSS(N)}),this._styleElement.textContent=G.toGlobalCSS(),document.body.appendChild(this._svgRoot);const W=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:x,height:b}=W;(x>this.maxWidth||b>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const n=Math.min(this.maxWidth,Math.ceil(x)),e=Math.min(this.maxHeight,Math.ceil(b));return this._svgRoot.setAttribute("width",n.toString()),this._svgRoot.setAttribute("height",e.toString()),a!==this._text&&(this._domElement.innerHTML=this._text),G!==this._style&&(Object.assign(this._domElement,{style:null===(K=this._style)||void 0===K?void 0:K.toCSS(N)}),this._styleElement.textContent=null===(D=this._style)||void 0===D?void 0:D.toGlobalCSS()),{width:n+2*G.padding,height:e+2*G.padding}}async updateText(t=!0){const{style:K,_image:D,_loadImage:a}=this;if(this.localStyleID!==K.styleID&&(this.dirty=!0,this.localStyleID=K.styleID),!this.dirty&&t)return;const{width:G,height:N}=this.measureText();D.width=a.width=Math.ceil(Math.max(1,G)),D.height=a.height=Math.ceil(Math.max(1,N)),this._updateID++;const W=this._updateID;await new Promise((t=>{a.onload=async()=>{W<this._updateID||(await K.onBeforeDraw(),D.src=a.src,a.onload=null,a.src="",this.updateTexture()),t()};const G=(new XMLSerializer).serializeToString(this._svgRoot);a.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(G)}`}))}get source(){return this._image}updateTexture(){const{style:t,texture:K,_image:D,resolution:a}=this,{padding:G}=t,{baseTexture:N}=K;K.trim.width=K._frame.width=D.width/a,K.trim.height=K._frame.height=D.height/a,K.trim.x=-G,K.trim.y=-G,K.orig.width=K._frame.width-2*G,K.orig.height=K._frame.height-2*G,this._onTextureUpdate(),N.setRealSize(D.width,D.height,a),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(K){var D,a,G,N,W;"boolean"==typeof K&&(K={children:K}),K=Object.assign({},t.defaultDestroyOptions,K),super.destroy(K);const x=null;this.ownsStyle&&(null===(D=this._style)||void 0===D||D.cleanFonts()),this._style=x,null===(a=this._svgRoot)||void 0===a||a.remove(),this._svgRoot=x,null===(G=this._domElement)||void 0===G||G.remove(),this._domElement=x,null===(N=this._foreignObject)||void 0===N||N.remove(),this._foreignObject=x,null===(W=this._styleElement)||void 0===W||W.remove(),this._styleElement=x,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=x,this._image.src="",this._image=x}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);const K=a.Wp.sign(this.scale.x)||1;this.scale.x=K*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);const K=a.Wp.sign(this.scale.y)||1;this.scale.y=K*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&((t=t||{})instanceof oK?(this.ownsStyle=!1,this._style=t):t instanceof IK.xJ?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=oK.from(t)):(this.ownsStyle=!0,this._style=new oK(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(""===t||null==t?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};UK.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},UK.defaultMaxWidth=2024,UK.defaultMaxHeight=2024,UK.defaultAutoResolution=!0},806630:(t,K,D)=>{D.d(K,{G:()=>a});class a{constructor(){this.hoverCursor="",this.actions=[],this.isRecursive=!1,this.disposeWhenUnowned=!0}static get HasTriggers(){for(const t in a.Triggers)if(Object.prototype.hasOwnProperty.call(a.Triggers,t))return!0;return!1}static get HasPickTriggers(){for(const t in a.Triggers)if(Object.prototype.hasOwnProperty.call(a.Triggers,t)){const K=parseInt(t);if(K>=1&&K<=7)return!0}return!1}static HasSpecificTrigger(t){for(const K in a.Triggers)if(Object.prototype.hasOwnProperty.call(a.Triggers,K)&&parseInt(K)===t)return!0;return!1}}a.Triggers={}},35259:(t,K,D)=>{D.d(K,{X:()=>a});class a{constructor(t,K,D,a,G,N){this.source=t,this.pointerX=K,this.pointerY=D,this.meshUnderPointer=a,this.sourceEvent=G,this.additionalData=N}static CreateNew(t,K,D){const G=t.getScene();return new a(t,G.pointerX,G.pointerY,G.meshUnderPointer||t,K,D)}static CreateNewFromSprite(t,K,D,G){return new a(t,K.pointerX,K.pointerY,K.meshUnderPointer,D,G)}static CreateNewFromScene(t,K){return new a(null,t.pointerX,t.pointerY,t.meshUnderPointer,K)}static CreateNewFromPrimitive(t,K,D,G){return new a(t,K.x,K.y,null,D,G)}}},240124:(t,K,D)=>{var a=D(638113),G=D(706400),N=D(33321),W=D(394501);N.$.AudioEngineFactory=(t,K,D)=>new x(t,K,D);class x{get audioContext(){return this._audioContextInitialized||this._initializeAudioContext(),this._audioContext}constructor(t=null,K=null,D=null){if(this._audioContext=null,this._audioContextInitialized=!1,this._muteButton=null,this._audioDestination=null,this.canUseWebAudio=!1,this.WarnedWebAudioUnsupported=!1,this.isMP3supported=!1,this.isOGGsupported=!1,this.unlocked=!1,this.useCustomUnlockedButton=!1,this.onAudioUnlockedObservable=new a.cP,this.onAudioLockedObservable=new a.cP,this._tryToRun=!1,this._onResize=()=>{this._moveButtonToTopLeft()},!W.BA())return;void 0!==window.AudioContext&&(this.canUseWebAudio=!0);const G=document.createElement("audio");this._hostElement=t,this._audioContext=K,this._audioDestination=D;try{G&&G.canPlayType&&(G.canPlayType('audio/mpeg; codecs="mp3"').replace(/^no$/,"")||G.canPlayType("audio/mp3").replace(/^no$/,""))&&(this.isMP3supported=!0)}catch(t){}try{G&&G.canPlayType&&G.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(this.isOGGsupported=!0)}catch(t){}}lock(){this._triggerSuspendedState()}unlock(){var t,K;if("running"===(null===(t=this._audioContext)||void 0===t?void 0:t.state))return this._hideMuteButton(),void(this.unlocked||(this.unlocked=!0,this.onAudioUnlockedObservable.notifyObservers(this)));this._tryToRun?null===(K=this._audioContext)||void 0===K||K.suspend().then((()=>{this._tryToRun=!1,this._triggerRunningState()})):this._triggerRunningState()}_resumeAudioContextOnStateChange(){var t;null===(t=this._audioContext)||void 0===t||t.addEventListener("statechange",(()=>{var t;this.unlocked&&"running"!==(null===(t=this._audioContext)||void 0===t?void 0:t.state)&&this._resumeAudioContext()}),{once:!0,passive:!0,signal:AbortSignal.timeout(3e3)})}_resumeAudioContext(){var t;return(null===(t=this._audioContext)||void 0===t?void 0:t.resume)?this._audioContext.resume():Promise.resolve()}_initializeAudioContext(){try{this.canUseWebAudio&&(this._audioContext||(this._audioContext=new AudioContext),this.masterGain=this._audioContext.createGain(),this.masterGain.gain.value=1,this._audioDestination||(this._audioDestination=this._audioContext.destination),this.masterGain.connect(this._audioDestination),this._audioContextInitialized=!0,"running"===this._audioContext.state&&this._triggerRunningState())}catch(t){this.canUseWebAudio=!1,G.V.Error("Web Audio: "+t.message)}}_triggerRunningState(){this._tryToRun||(this._tryToRun=!0,this._resumeAudioContext().then((()=>{this._tryToRun=!1,this._muteButton&&this._hideMuteButton(),this.unlocked=!0,this.onAudioUnlockedObservable.notifyObservers(this)})).catch((()=>{this._tryToRun=!1,this.unlocked=!1})))}_triggerSuspendedState(){this.unlocked=!1,this.onAudioLockedObservable.notifyObservers(this),this._displayMuteButton()}_displayMuteButton(){if(this.useCustomUnlockedButton||this._muteButton)return;this._muteButton=document.createElement("BUTTON"),this._muteButton.className="babylonUnmuteIcon",this._muteButton.id="babylonUnmuteIconBtn",this._muteButton.title="Unmute";const t=".babylonUnmuteIcon { position: absolute; left: 20px; top: 20px; height: 40px; width: 60px; background-color: rgba(51,51,51,0.7); background-image: url("+(window.SVGSVGElement?"data:image/svg+xml;charset=UTF-8,%3Csvg%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2239%22%20height%3D%2232%22%20viewBox%3D%220%200%2039%2032%22%3E%3Cpath%20fill%3D%22white%22%20d%3D%22M9.625%2018.938l-0.031%200.016h-4.953q-0.016%200-0.031-0.016v-12.453q0-0.016%200.031-0.016h4.953q0.031%200%200.031%200.016v12.453zM12.125%207.688l8.719-8.703v27.453l-8.719-8.719-0.016-0.047v-9.938zM23.359%207.875l1.406-1.406%204.219%204.203%204.203-4.203%201.422%201.406-4.219%204.219%204.219%204.203-1.484%201.359-4.141-4.156-4.219%204.219-1.406-1.422%204.219-4.203z%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E":"https://cdn.babylonjs.com/Assets/audio.png")+");  background-size: 80%; background-repeat:no-repeat; background-position: center; background-position-y: 4px; border: none; outline: none; transition: transform 0.125s ease-out; cursor: pointer; z-index: 9999; } .babylonUnmuteIcon:hover { transform: scale(1.05) } .babylonUnmuteIcon:active { background-color: rgba(51,51,51,1) }",K=document.createElement("style");K.appendChild(document.createTextNode(t)),document.getElementsByTagName("head")[0].appendChild(K),document.body.appendChild(this._muteButton),this._moveButtonToTopLeft(),this._muteButton.addEventListener("touchend",(()=>{this._triggerRunningState()}),!0),this._muteButton.addEventListener("click",(()=>{this.unlock()}),!0),window.addEventListener("resize",this._onResize)}_moveButtonToTopLeft(){this._hostElement&&this._muteButton&&(this._muteButton.style.top=this._hostElement.offsetTop+20+"px",this._muteButton.style.left=this._hostElement.offsetLeft+20+"px")}_hideMuteButton(){this._muteButton&&(document.body.removeChild(this._muteButton),this._muteButton=null)}dispose(){this.canUseWebAudio&&this._audioContextInitialized&&(this._connectedAnalyser&&this._audioContext&&(this._connectedAnalyser.stopDebugCanvas(),this._connectedAnalyser.dispose(),this.masterGain.disconnect(),this.masterGain.connect(this._audioContext.destination),this._connectedAnalyser=null),this.masterGain.gain.value=1),this.WarnedWebAudioUnsupported=!1,this._hideMuteButton(),window.removeEventListener("resize",this._onResize),this.onAudioUnlockedObservable.clear(),this.onAudioLockedObservable.clear()}getGlobalVolume(){return this.canUseWebAudio&&this._audioContextInitialized?this.masterGain.gain.value:-1}setGlobalVolume(t){this.canUseWebAudio&&this._audioContextInitialized&&(this.masterGain.gain.value=t)}connectToAnalyser(t){this._connectedAnalyser&&this._connectedAnalyser.stopDebugCanvas(),this.canUseWebAudio&&this._audioContextInitialized&&this._audioContext&&(this._connectedAnalyser=t,this.masterGain.disconnect(),this._connectedAnalyser.connectAudioNodes(this.masterGain,this._audioContext.destination))}}},23987:(t,K,D)=>{D.d(K,{R:()=>W,h:()=>N});var a=D(389011),G=D(706400);class N{get isDisposed(){return this._isDisposed}constructor(t,K,D,G=0,N=!1,W=!1,x=!1,b,n){this._isAlreadyOwned=!1,this._isDisposed=!1,t&&t.getScene?this._engine=t.getScene().getEngine():this._engine=t,this._updatable=D,this._instanced=W,this._divisor=b||1,this._label=n,K instanceof a.n?(this._data=null,this._buffer=K):(this._data=K,this._buffer=null),this.byteStride=x?G:G*Float32Array.BYTES_PER_ELEMENT,N||this.create()}createVertexBuffer(t,K,D,a,G,N=!1,x){const b=N?K:K*Float32Array.BYTES_PER_ELEMENT,n=a?N?a:a*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new W(this._engine,this,t,this._updatable,!0,n,void 0===G?this._instanced:G,b,D,void 0,void 0,!0,this._divisor||x)}isUpdatable(){return this._updatable}getData(){return this._data}getBuffer(){return this._buffer}getStrideSize(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT}create(t=null){!t&&this._buffer||(t=t||this._data)&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,t),this._data=t):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(t,this._label),this._data=t):this._buffer=this._engine.createVertexBuffer(t,void 0,this._label))}_rebuild(){if(this._data)this._buffer=null,this.create(this._data);else{if(!this._buffer)return;if(this._buffer.capacity>0)return void(this._updatable?this._buffer=this._engine.createDynamicVertexBuffer(this._buffer.capacity,this._label):this._buffer=this._engine.createVertexBuffer(this._buffer.capacity,void 0,this._label));G.V.Warn(`Missing data for buffer "${this._label}" ${this._buffer?"(uniqueId: "+this._buffer.uniqueId+")":""}. Buffer reconstruction failed.`),this._buffer=null}}update(t){this.create(t)}updateDirectly(t,K,D,a=!1){this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,t,a?K:K*Float32Array.BYTES_PER_ELEMENT,D?D*this.byteStride:void 0),this._data=0===K&&void 0===D?t:null)}_increaseReferences(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=!0)}dispose(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._isDisposed=!0,this._data=null,this._buffer=null)}}class W{get isDisposed(){return this._isDisposed}get instanceDivisor(){return this._instanceDivisor}set instanceDivisor(t){const K=0!=t;this._instanceDivisor=t,K!==this._instanced&&(this._instanced=K,this._computeHashCode())}get _maxVerticesCount(){const t=this.getData();return t?Array.isArray(t)?t.length/(this.byteStride/4)-this.byteOffset/4:(t.byteLength-this.byteOffset)/this.byteStride:0}constructor(t,K,D,a,G,x,b,n,e,i,z=!1,I=!1,Z=1,w=!1){var m,u,d,E,l;this._isDisposed=!1;let Q=!1;if(this.engine=t,"object"==typeof a&&null!==a?(Q=null!==(m=a.updatable)&&void 0!==m&&m,G=a.postponeInternalCreation,x=a.stride,b=a.instanced,n=a.offset,e=a.size,i=a.type,z=null!==(u=a.normalized)&&void 0!==u&&u,I=null!==(d=a.useBytes)&&void 0!==d&&d,Z=null!==(E=a.divisor)&&void 0!==E?E:1,w=null!==(l=a.takeBufferOwnership)&&void 0!==l&&l,this._label=a.label):Q=!!a,K instanceof N?(this._buffer=K,this._ownsBuffer=w):(this._buffer=new N(t,K,Q,x,G,b,I,Z,this._label),this._ownsBuffer=!0),this.uniqueId=W._Counter++,this._kind=D,void 0===i){const t=this.getData();this.type=t?W.GetDataType(t):W.FLOAT}else this.type=i;const P=W.GetTypeByteLength(this.type);I?(this._size=e||(x?x/P:W.DeduceStride(D)),this.byteStride=x||this._buffer.byteStride||this._size*P,this.byteOffset=n||0):(this._size=e||x||W.DeduceStride(D),this.byteStride=x?x*P:this._buffer.byteStride||this._size*P,this.byteOffset=(n||0)*P),this.normalized=z,this._instanced=void 0!==b&&b,this._instanceDivisor=b?Z:0,this._alignBuffer(),this._computeHashCode()}_computeHashCode(){this.hashCode=(this.type-5120<<0)+((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)}_rebuild(){var t;null===(t=this._buffer)||void 0===t||t._rebuild()}getKind(){return this._kind}isUpdatable(){return this._buffer.isUpdatable()}getData(){return this._buffer.getData()}getFloatData(t,K){const D=this.getData();return D?W.GetFloatData(D,this._size,this.type,this.byteOffset,this.byteStride,this.normalized,t,K):null}getBuffer(){return this._buffer.getBuffer()}getWrapperBuffer(){return this._buffer}getStrideSize(){return this.byteStride/W.GetTypeByteLength(this.type)}getOffset(){return this.byteOffset/W.GetTypeByteLength(this.type)}getSize(t=!1){return t?this._size*W.GetTypeByteLength(this.type):this._size}getIsInstanced(){return this._instanced}getInstanceDivisor(){return this._instanceDivisor}create(t){this._buffer.create(t),this._alignBuffer()}update(t){this._buffer.update(t),this._alignBuffer()}updateDirectly(t,K,D=!1){this._buffer.updateDirectly(t,K,void 0,D),this._alignBuffer()}dispose(){this._ownsBuffer&&this._buffer.dispose(),this._isDisposed=!0}forEach(t,K){W.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,t,this.normalized,K)}_alignBuffer(){}static DeduceStride(t){switch(t){case W.UVKind:case W.UV2Kind:case W.UV3Kind:case W.UV4Kind:case W.UV5Kind:case W.UV6Kind:return 2;case W.NormalKind:case W.PositionKind:return 3;case W.ColorKind:case W.ColorInstanceKind:case W.MatricesIndicesKind:case W.MatricesIndicesExtraKind:case W.MatricesWeightsKind:case W.MatricesWeightsExtraKind:case W.TangentKind:return 4;default:throw new Error("Invalid kind '"+t+"'")}}static GetDataType(t){return t instanceof Int8Array?W.BYTE:t instanceof Uint8Array?W.UNSIGNED_BYTE:t instanceof Int16Array?W.SHORT:t instanceof Uint16Array?W.UNSIGNED_SHORT:t instanceof Int32Array?W.INT:t instanceof Uint32Array?W.UNSIGNED_INT:W.FLOAT}static GetTypeByteLength(t){switch(t){case W.BYTE:case W.UNSIGNED_BYTE:return 1;case W.SHORT:case W.UNSIGNED_SHORT:return 2;case W.INT:case W.UNSIGNED_INT:case W.FLOAT:return 4;default:throw new Error(`Invalid type '${t}'`)}}static ForEach(t,K,D,a,G,N,x,b){if(t instanceof Array){let G=K/4;const W=D/4;for(let K=0;K<N;K+=a){for(let D=0;D<a;D++)b(t[G+D],K+D);G+=W}}else{const n=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),e=W.GetTypeByteLength(G);for(let t=0;t<N;t+=a){let N=K;for(let K=0;K<a;K++)b(W._GetFloatValue(n,G,N,x),t+K),N+=e;K+=D}}}static _GetFloatValue(t,K,D,a){switch(K){case W.BYTE:{let K=t.getInt8(D);return a&&(K=Math.max(K/127,-1)),K}case W.UNSIGNED_BYTE:{let K=t.getUint8(D);return a&&(K/=255),K}case W.SHORT:{let K=t.getInt16(D,!0);return a&&(K=Math.max(K/32767,-1)),K}case W.UNSIGNED_SHORT:{let K=t.getUint16(D,!0);return a&&(K/=65535),K}case W.INT:return t.getInt32(D,!0);case W.UNSIGNED_INT:return t.getUint32(D,!0);case W.FLOAT:return t.getFloat32(D,!0);default:throw new Error(`Invalid component type ${K}`)}}static GetFloatData(t,K,D,a,N,x,b,n){const e=K*W.GetTypeByteLength(D),i=b*K;if(D!==W.FLOAT||N!==e){const G=new Float32Array(i);return W.ForEach(t,a,N,K,D,i,x,((t,K)=>G[K]=t)),G}if(!(t instanceof Array||t instanceof Float32Array)||0!==a||t.length!==i){if(t instanceof Array){const K=a/4;return t.slice(K,K+i)}if(t instanceof ArrayBuffer)return new Float32Array(t,a,i);{const K=t.byteOffset+a;if(3&K&&(G.V.Warn("Float array must be aligned to 4-bytes border"),n=!0),n){const D=new Uint8Array(i*Float32Array.BYTES_PER_ELEMENT),a=new Uint8Array(t.buffer,K,D.length);return D.set(a),new Float32Array(D.buffer)}return new Float32Array(t.buffer,K,i)}}return n?t.slice():t}}W._Counter=0,W.BYTE=5120,W.UNSIGNED_BYTE=5121,W.SHORT=5122,W.UNSIGNED_SHORT=5123,W.INT=5124,W.UNSIGNED_INT=5125,W.FLOAT=5126,W.PositionKind=`position`,W.NormalKind=`normal`,W.TangentKind=`tangent`,W.UVKind=`uv`,W.UV2Kind=`uv2`,W.UV3Kind=`uv3`,W.UV4Kind=`uv4`,W.UV5Kind=`uv5`,W.UV6Kind=`uv6`,W.ColorKind=`color`,W.ColorInstanceKind=`instanceColor`,W.MatricesIndicesKind=`matricesIndices`,W.MatricesWeightsKind=`matricesWeights`,W.MatricesIndicesExtraKind=`matricesIndicesExtra`,W.MatricesWeightsExtraKind=`matricesWeightsExtra`},389011:(t,K,D)=>{D.d(K,{n:()=>a});class a{get underlyingResource(){return null}constructor(){this.references=0,this.capacity=0,this.is32Bits=!1,this.uniqueId=a._Counter++}}a._Counter=0},564135:(t,K,D)=>{D.d(K,{i:()=>m});var a=D(297809),G=D(760998),N=D(293506),W=D(898973),x=D(638113),b=D(604910),n=D(869581),e=D(706400),i=D(310035),z=D(554014),I=D(60071),Z=D(993739),w=D(337776);class m extends n.b{get position(){return this._position}set position(t){this._position=t}set upVector(t){this._upVector=t}get upVector(){return this._upVector}get screenArea(){var t,K,D,a;let G=0,N=0;if(this.mode===m.PERSPECTIVE_CAMERA)this.fovMode===m.FOVMODE_VERTICAL_FIXED?(N=2*this.minZ*Math.tan(this.fov/2),G=this.getEngine().getAspectRatio(this)*N):(G=2*this.minZ*Math.tan(this.fov/2),N=G/this.getEngine().getAspectRatio(this));else{const W=this.getEngine().getRenderWidth()/2,x=this.getEngine().getRenderHeight()/2;G=(null!==(t=this.orthoRight)&&void 0!==t?t:W)-(null!==(K=this.orthoLeft)&&void 0!==K?K:-W),N=(null!==(D=this.orthoTop)&&void 0!==D?D:x)-(null!==(a=this.orthoBottom)&&void 0!==a?a:-x)}return G*N}set orthoLeft(t){this._orthoLeft=t;for(const K of this._rigCameras)K.orthoLeft=t}get orthoLeft(){return this._orthoLeft}set orthoRight(t){this._orthoRight=t;for(const K of this._rigCameras)K.orthoRight=t}get orthoRight(){return this._orthoRight}set orthoBottom(t){this._orthoBottom=t;for(const K of this._rigCameras)K.orthoBottom=t}get orthoBottom(){return this._orthoBottom}set orthoTop(t){this._orthoTop=t;for(const K of this._rigCameras)K.orthoTop=t}get orthoTop(){return this._orthoTop}set mode(t){this._mode=t;for(const K of this._rigCameras)K.mode=t}get mode(){return this._mode}get hasMoved(){return this._hasMoved}constructor(t,K,D,a=!0){super(t,D,!1),this._position=b.Pq.Zero(),this._upVector=b.Pq.Up(),this.oblique=null,this._orthoLeft=null,this._orthoRight=null,this._orthoBottom=null,this._orthoTop=null,this.fov=.8,this.projectionPlaneTilt=0,this.minZ=1,this.maxZ=1e4,this.inertia=.9,this._mode=m.PERSPECTIVE_CAMERA,this.isIntermediate=!1,this.viewport=new I.L(0,0,1,1),this.layerMask=268435455,this.fovMode=m.FOVMODE_VERTICAL_FIXED,this.cameraRigMode=m.RIG_MODE_NONE,this.customRenderTargets=[],this.outputRenderTarget=null,this.onViewMatrixChangedObservable=new x.cP,this.onProjectionMatrixChangedObservable=new x.cP,this.onAfterCheckInputsObservable=new x.cP,this.onRestoreStateObservable=new x.cP,this.isRigCamera=!1,this._hasMoved=!1,this._rigCameras=new Array,this._skipRendering=!1,this._projectionMatrix=new b.uq,this._postProcesses=new Array,this._activeMeshes=new N.L(256),this._globalPosition=b.Pq.Zero(),this._computedViewMatrix=b.uq.Identity(),this._doNotComputeProjectionMatrix=!1,this._transformMatrix=b.uq.Zero(),this._refreshFrustumPlanes=!0,this._absoluteRotation=b.PT.Identity(),this._isCamera=!0,this._isLeftCamera=!1,this._isRightCamera=!1,this.getScene().addCamera(this),a&&!this.getScene().activeCamera&&(this.getScene().activeCamera=this),this.position=K,this.renderPassId=this.getScene().getEngine().createRenderPassId(`Camera ${t}`)}storeState(){return this._stateStored=!0,this._storedFov=this.fov,this}hasStateStored(){return!!this._stateStored}_restoreStateValues(){return!!this._stateStored&&(this.fov=this._storedFov,!0)}restoreState(){return!!this._restoreStateValues()&&(this.onRestoreStateObservable.notifyObservers(this),!0)}getClassName(){return"Camera"}toString(t){let K="Name: "+this.name;if(K+=", type: "+this.getClassName(),this.animations)for(let D=0;D<this.animations.length;D++)K+=", animation[0]: "+this.animations[D].toString(t);return K}applyVerticalCorrection(){const t=this.absoluteRotation.toEulerAngles();this.projectionPlaneTilt=this._scene.useRightHandedSystem?-t.x:t.x}get globalPosition(){return this._globalPosition}getActiveMeshes(){return this._activeMeshes}isActiveMesh(t){return-1!==this._activeMeshes.indexOf(t)}isReady(t=!1){if(t)for(const t of this._postProcesses)if(t&&!t.isReady())return!1;return super.isReady(t)}_initCache(){super._initCache(),this._cache.position=new b.Pq(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.upVector=new b.Pq(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.mode=void 0,this._cache.minZ=void 0,this._cache.maxZ=void 0,this._cache.fov=void 0,this._cache.fovMode=void 0,this._cache.aspectRatio=void 0,this._cache.orthoLeft=void 0,this._cache.orthoRight=void 0,this._cache.orthoBottom=void 0,this._cache.orthoTop=void 0,this._cache.obliqueAngle=void 0,this._cache.obliqueLength=void 0,this._cache.obliqueOffset=void 0,this._cache.renderWidth=void 0,this._cache.renderHeight=void 0}_updateCache(t){t||super._updateCache(),this._cache.position.copyFrom(this.position),this._cache.upVector.copyFrom(this.upVector)}_isSynchronized(){return this._isSynchronizedViewMatrix()&&this._isSynchronizedProjectionMatrix()}_isSynchronizedViewMatrix(){return!!super._isSynchronized()&&this._cache.position.equals(this.position)&&this._cache.upVector.equals(this.upVector)&&this.isSynchronizedWithParent()}_isSynchronizedProjectionMatrix(){let t=this._cache.mode===this.mode&&this._cache.minZ===this.minZ&&this._cache.maxZ===this.maxZ;if(!t)return!1;const K=this.getEngine();return this.mode===m.PERSPECTIVE_CAMERA?t=this._cache.fov===this.fov&&this._cache.fovMode===this.fovMode&&this._cache.aspectRatio===K.getAspectRatio(this)&&this._cache.projectionPlaneTilt===this.projectionPlaneTilt:(t=this._cache.orthoLeft===this.orthoLeft&&this._cache.orthoRight===this.orthoRight&&this._cache.orthoBottom===this.orthoBottom&&this._cache.orthoTop===this.orthoTop&&this._cache.renderWidth===K.getRenderWidth()&&this._cache.renderHeight===K.getRenderHeight(),this.oblique&&(t=t&&this._cache.obliqueAngle===this.oblique.angle&&this._cache.obliqueLength===this.oblique.length&&this._cache.obliqueOffset===this.oblique.offset)),t}attachControl(t,K){}detachControl(t){}update(){this._hasMoved=!1,this._checkInputs(),this.cameraRigMode!==m.RIG_MODE_NONE&&this._updateRigCameras(),this.getViewMatrix(),this.getProjectionMatrix()}_checkInputs(){this.onAfterCheckInputsObservable.notifyObservers(this)}get rigCameras(){return this._rigCameras}get rigPostProcess(){return this._rigPostProcess}_getFirstPostProcess(){for(let t=0;t<this._postProcesses.length;t++)if(null!==this._postProcesses[t])return this._postProcesses[t];return null}_cascadePostProcessesToRigCams(){const t=this._getFirstPostProcess();t&&t.markTextureDirty();for(let t=0,K=this._rigCameras.length;t<K;t++){const K=this._rigCameras[t],D=K._rigPostProcess;D?("pass"===D.getEffectName()&&(K.isIntermediate=0===this._postProcesses.length),K._postProcesses=this._postProcesses.slice(0).concat(D),D.markTextureDirty()):K._postProcesses=this._postProcesses.slice(0)}}attachPostProcess(t,K=null){return!t.isReusable()&&this._postProcesses.indexOf(t)>-1?(e.V.Error("You're trying to reuse a post process not defined as reusable."),0):(null==K||K<0?this._postProcesses.push(t):null===this._postProcesses[K]?this._postProcesses[K]=t:this._postProcesses.splice(K,0,t),this._cascadePostProcessesToRigCams(),this._scene.prePassRenderer&&this._scene.prePassRenderer.markAsDirty(),this._postProcesses.indexOf(t))}detachPostProcess(t){const K=this._postProcesses.indexOf(t);-1!==K&&(this._postProcesses[K]=null),this._scene.prePassRenderer&&this._scene.prePassRenderer.markAsDirty(),this._cascadePostProcessesToRigCams()}getWorldMatrix(){return this._isSynchronizedViewMatrix()||this.getViewMatrix(),this._worldMatrix}_getViewMatrix(){return b.uq.Identity()}getViewMatrix(t){return!t&&this._isSynchronizedViewMatrix()||(this._hasMoved=!0,this.updateCache(),this._computedViewMatrix=this._getViewMatrix(),this._currentRenderId=this.getScene().getRenderId(),this._childUpdateId++,this._refreshFrustumPlanes=!0,this._cameraRigParams&&this._cameraRigParams.vrPreViewMatrix&&this._computedViewMatrix.multiplyToRef(this._cameraRigParams.vrPreViewMatrix,this._computedViewMatrix),this.parent&&this.parent.onViewMatrixChangedObservable&&this.parent.onViewMatrixChangedObservable.notifyObservers(this.parent),this.onViewMatrixChangedObservable.notifyObservers(this),this._computedViewMatrix.invertToRef(this._worldMatrix)),this._computedViewMatrix}freezeProjectionMatrix(t){this._doNotComputeProjectionMatrix=!0,void 0!==t&&(this._projectionMatrix=t)}unfreezeProjectionMatrix(){this._doNotComputeProjectionMatrix=!1}getProjectionMatrix(t){var K,D,a,G,N,W,x,n,e,i,z,I,Z,w,u,d,E,l,Q;if(this._doNotComputeProjectionMatrix||!t&&this._isSynchronizedProjectionMatrix())return this._projectionMatrix;this._cache.mode=this.mode,this._cache.minZ=this.minZ,this._cache.maxZ=this.maxZ,this._refreshFrustumPlanes=!0;const P=this.getEngine(),y=this.getScene(),q=P.useReverseDepthBuffer;if(this.mode===m.PERSPECTIVE_CAMERA){let t;this._cache.fov=this.fov,this._cache.fovMode=this.fovMode,this._cache.aspectRatio=P.getAspectRatio(this),this._cache.projectionPlaneTilt=this.projectionPlaneTilt,this.minZ<=0&&(this.minZ=.1),t=y.useRightHandedSystem?b.uq.PerspectiveFovRHToRef:b.uq.PerspectiveFovLHToRef,t(this.fov,P.getAspectRatio(this),q?this.maxZ:this.minZ,q?this.minZ:this.maxZ,this._projectionMatrix,this.fovMode===m.FOVMODE_VERTICAL_FIXED,P.isNDCHalfZRange,this.projectionPlaneTilt,q)}else{const t=P.getRenderWidth()/2,m=P.getRenderHeight()/2;y.useRightHandedSystem?this.oblique?b.uq.ObliqueOffCenterRHToRef(null!==(K=this.orthoLeft)&&void 0!==K?K:-t,null!==(D=this.orthoRight)&&void 0!==D?D:t,null!==(a=this.orthoBottom)&&void 0!==a?a:-m,null!==(G=this.orthoTop)&&void 0!==G?G:m,q?this.maxZ:this.minZ,q?this.minZ:this.maxZ,this.oblique.length,this.oblique.angle,this._computeObliqueDistance(this.oblique.offset),this._projectionMatrix,P.isNDCHalfZRange):b.uq.OrthoOffCenterRHToRef(null!==(N=this.orthoLeft)&&void 0!==N?N:-t,null!==(W=this.orthoRight)&&void 0!==W?W:t,null!==(x=this.orthoBottom)&&void 0!==x?x:-m,null!==(n=this.orthoTop)&&void 0!==n?n:m,q?this.maxZ:this.minZ,q?this.minZ:this.maxZ,this._projectionMatrix,P.isNDCHalfZRange):this.oblique?b.uq.ObliqueOffCenterLHToRef(null!==(e=this.orthoLeft)&&void 0!==e?e:-t,null!==(i=this.orthoRight)&&void 0!==i?i:t,null!==(z=this.orthoBottom)&&void 0!==z?z:-m,null!==(I=this.orthoTop)&&void 0!==I?I:m,q?this.maxZ:this.minZ,q?this.minZ:this.maxZ,this.oblique.length,this.oblique.angle,this._computeObliqueDistance(this.oblique.offset),this._projectionMatrix,P.isNDCHalfZRange):b.uq.OrthoOffCenterLHToRef(null!==(Z=this.orthoLeft)&&void 0!==Z?Z:-t,null!==(w=this.orthoRight)&&void 0!==w?w:t,null!==(u=this.orthoBottom)&&void 0!==u?u:-m,null!==(d=this.orthoTop)&&void 0!==d?d:m,q?this.maxZ:this.minZ,q?this.minZ:this.maxZ,this._projectionMatrix,P.isNDCHalfZRange),this._cache.orthoLeft=this.orthoLeft,this._cache.orthoRight=this.orthoRight,this._cache.orthoBottom=this.orthoBottom,this._cache.orthoTop=this.orthoTop,this._cache.obliqueAngle=null===(E=this.oblique)||void 0===E?void 0:E.angle,this._cache.obliqueLength=null===(l=this.oblique)||void 0===l?void 0:l.length,this._cache.obliqueOffset=null===(Q=this.oblique)||void 0===Q?void 0:Q.offset,this._cache.renderWidth=P.getRenderWidth(),this._cache.renderHeight=P.getRenderHeight()}return this.onProjectionMatrixChangedObservable.notifyObservers(this),this._projectionMatrix}getTransformationMatrix(){return this._computedViewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix),this._transformMatrix}_computeObliqueDistance(t){return(this.radius||(this.target?b.Pq.Distance(this.position,this.target):this.position.length()))+t}_updateFrustumPlanes(){this._refreshFrustumPlanes&&(this.getTransformationMatrix(),this._frustumPlanes?Z.P.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=Z.P.GetPlanes(this._transformMatrix),this._refreshFrustumPlanes=!1)}isInFrustum(t,K=!1){if(this._updateFrustumPlanes(),K&&this.rigCameras.length>0){let K=!1;return this.rigCameras.forEach((D=>{D._updateFrustumPlanes(),K=K||t.isInFrustum(D._frustumPlanes)})),K}return t.isInFrustum(this._frustumPlanes)}isCompletelyInFrustum(t){return this._updateFrustumPlanes(),t.isCompletelyInFrustum(this._frustumPlanes)}getForwardRay(t=100,K,D){throw z.n("Ray")}getForwardRayToRef(t,K=100,D,a){throw z.n("Ray")}dispose(t,K=!1){for(this.onViewMatrixChangedObservable.clear(),this.onProjectionMatrixChangedObservable.clear(),this.onAfterCheckInputsObservable.clear(),this.onRestoreStateObservable.clear(),this.inputs&&this.inputs.clear(),this.getScene().stopAnimation(this),this.getScene().removeCamera(this);this._rigCameras.length>0;){const t=this._rigCameras.pop();t&&t.dispose()}if(this._parentContainer){const t=this._parentContainer.cameras.indexOf(this);t>-1&&this._parentContainer.cameras.splice(t,1),this._parentContainer=null}if(this._rigPostProcess)this._rigPostProcess.dispose(this),this._rigPostProcess=null,this._postProcesses.length=0;else if(this.cameraRigMode!==m.RIG_MODE_NONE)this._rigPostProcess=null,this._postProcesses.length=0;else{let t=this._postProcesses.length;for(;--t>=0;){const K=this._postProcesses[t];K&&K.dispose(this)}}let D=this.customRenderTargets.length;for(;--D>=0;)this.customRenderTargets[D].dispose();this.customRenderTargets.length=0,this._activeMeshes.dispose(),this.getScene().getEngine().releaseRenderPassId(this.renderPassId),super.dispose(t,K)}get isLeftCamera(){return this._isLeftCamera}get isRightCamera(){return this._isRightCamera}get leftCamera(){return this._rigCameras.length<1?null:this._rigCameras[0]}get rightCamera(){return this._rigCameras.length<2?null:this._rigCameras[1]}getLeftTarget(){return this._rigCameras.length<1?null:this._rigCameras[0].getTarget()}getRightTarget(){return this._rigCameras.length<2?null:this._rigCameras[1].getTarget()}setCameraRigMode(t,K){if(this.cameraRigMode!==t){for(;this._rigCameras.length>0;){const t=this._rigCameras.pop();t&&t.dispose()}if(this.cameraRigMode=t,this._cameraRigParams={},this._cameraRigParams.interaxialDistance=K.interaxialDistance||.0637,this._cameraRigParams.stereoHalfAngle=W.S0.ToRadians(this._cameraRigParams.interaxialDistance/.0637),this.cameraRigMode!==m.RIG_MODE_NONE){const t=this.createRigCamera(this.name+"_L",0);t&&(t._isLeftCamera=!0);const K=this.createRigCamera(this.name+"_R",1);K&&(K._isRightCamera=!0),t&&K&&(this._rigCameras.push(t),this._rigCameras.push(K))}this._setRigMode(K),this._cascadePostProcessesToRigCams(),this.update()}}_setRigMode(t){}_getVRProjectionMatrix(){return b.uq.PerspectiveFovLHToRef(this._cameraRigParams.vrMetrics.aspectRatioFov,this._cameraRigParams.vrMetrics.aspectRatio,this.minZ,this.maxZ,this._cameraRigParams.vrWorkMatrix,!0,this.getEngine().isNDCHalfZRange),this._cameraRigParams.vrWorkMatrix.multiplyToRef(this._cameraRigParams.vrHMatrix,this._projectionMatrix),this._projectionMatrix}setCameraRigParameter(t,K){this._cameraRigParams||(this._cameraRigParams={}),this._cameraRigParams[t]=K,"interaxialDistance"===t&&(this._cameraRigParams.stereoHalfAngle=W.S0.ToRadians(K/.0637))}createRigCamera(t,K){return null}_updateRigCameras(){for(let t=0;t<this._rigCameras.length;t++)this._rigCameras[t].minZ=this.minZ,this._rigCameras[t].maxZ=this.maxZ,this._rigCameras[t].fov=this.fov,this._rigCameras[t].upVector.copyFrom(this.upVector);this.cameraRigMode===m.RIG_MODE_STEREOSCOPIC_ANAGLYPH&&(this._rigCameras[0].viewport=this._rigCameras[1].viewport=this.viewport)}_setupInputs(){}serialize(){const t=w.p.Serialize(this);return t.uniqueId=this.uniqueId,t.type=this.getClassName(),this.parent&&this.parent._serializeAsParent(t),this.inputs&&this.inputs.serialize(t),w.p.AppendSerializedAnimations(this,t),t.ranges=this.serializeAnimationRanges(),t.isEnabled=this.isEnabled(),t}clone(t,K=null){const D=w.p.Clone(m.GetConstructorFromName(this.getClassName(),t,this.getScene(),this.interaxialDistance,this.isStereoscopicSideBySide),this);return D.name=t,D.parent=K,this.onClonedObservable.notifyObservers(D),D}getDirection(t){const K=b.Pq.Zero();return this.getDirectionToRef(t,K),K}get absoluteRotation(){return this.getWorldMatrix().decompose(void 0,this._absoluteRotation),this._absoluteRotation}getDirectionToRef(t,K){b.Pq.TransformNormalToRef(t,this.getWorldMatrix(),K)}static GetConstructorFromName(t,K,D,a=0,G=!0){return n.b.Construct(t,K,D,{interaxial_distance:a,isStereoscopicSideBySide:G})||(()=>m._CreateDefaultParsedCamera(K,D))}computeWorldMatrix(){return this.getWorldMatrix()}static Parse(t,K){const D=t.type,a=m.GetConstructorFromName(D,t.name,K,t.interaxial_distance,t.isStereoscopicSideBySide),G=w.p.Parse(a,t,K);if(void 0!==t.parentId&&(G._waitingParentId=t.parentId),void 0!==t.parentInstanceIndex&&(G._waitingParentInstanceIndex=t.parentInstanceIndex),G.inputs&&(G.inputs.parse(t),G._setupInputs()),t.upVector&&(G.upVector=b.Pq.FromArray(t.upVector)),G.setPosition&&(G.position.copyFromFloats(0,0,0),G.setPosition(b.Pq.FromArray(t.position))),t.target&&G.setTarget&&G.setTarget(b.Pq.FromArray(t.target)),t.cameraRigMode){const K=t.interaxial_distance?{interaxialDistance:t.interaxial_distance}:{};G.setCameraRigMode(t.cameraRigMode,K)}if(t.animations){for(let K=0;K<t.animations.length;K++){const D=t.animations[K],a=i.n9("BABYLON.Animation");a&&G.animations.push(a.Parse(D))}n.b.ParseAnimationRanges(G,t,K)}return t.autoAnimate&&K.beginAnimation(G,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,t.autoAnimateSpeed||1),void 0!==t.isEnabled&&G.setEnabled(t.isEnabled),G}_calculateHandednessMultiplier(){let t=this.getScene().useRightHandedSystem?-1:1;return this.parent&&this.parent._getWorldMatrixDeterminant()<0&&(t*=-1),t}}m._CreateDefaultParsedCamera=(t,K)=>{throw z.n("UniversalCamera")},m.PERSPECTIVE_CAMERA=0,m.ORTHOGRAPHIC_CAMERA=1,m.FOVMODE_VERTICAL_FIXED=0,m.FOVMODE_HORIZONTAL_FIXED=1,m.RIG_MODE_NONE=0,m.RIG_MODE_STEREOSCOPIC_ANAGLYPH=10,m.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11,m.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12,m.RIG_MODE_STEREOSCOPIC_OVERUNDER=13,m.RIG_MODE_STEREOSCOPIC_INTERLACED=14,m.RIG_MODE_VR=20,m.RIG_MODE_CUSTOM=22,m.ForceAttachControlToAlwaysPreventDefault=!1,a.Cg([G.P_("position")],m.prototype,"_position",void 0),a.Cg([G.P_("upVector")],m.prototype,"_upVector",void 0),a.Cg([G.lK()],m.prototype,"orthoLeft",null),a.Cg([G.lK()],m.prototype,"orthoRight",null),a.Cg([G.lK()],m.prototype,"orthoBottom",null),a.Cg([G.lK()],m.prototype,"orthoTop",null),a.Cg([G.lK()],m.prototype,"fov",void 0),a.Cg([G.lK()],m.prototype,"projectionPlaneTilt",void 0),a.Cg([G.lK()],m.prototype,"minZ",void 0),a.Cg([G.lK()],m.prototype,"maxZ",void 0),a.Cg([G.lK()],m.prototype,"inertia",void 0),a.Cg([G.lK()],m.prototype,"mode",null),a.Cg([G.lK()],m.prototype,"layerMask",void 0),a.Cg([G.lK()],m.prototype,"fovMode",void 0),a.Cg([G.lK()],m.prototype,"cameraRigMode",void 0),a.Cg([G.lK()],m.prototype,"interaxialDistance",void 0),a.Cg([G.lK()],m.prototype,"isStereoscopicSideBySide",void 0)},7686:(t,K,D)=>{D.d(K,{w:()=>a});class a{constructor(t,K,D){this.bu=t,this.bv=K,this.distance=D,this.faceId=0,this.subMeshId=0}}},775316:(t,K,D)=>{D.d(K,{j:()=>G});var a=D(604910);class G{constructor(){this._checkCollisions=!1,this._collisionMask=-1,this._collisionGroup=-1,this._surroundingMeshes=null,this._collider=null,this._oldPositionForCollisions=new a.Pq(0,0,0),this._diffPositionForCollisions=new a.Pq(0,0,0),this._collisionResponse=!0}}},79160:(t,K,D)=>{D.d(K,{G:()=>N});var a=D(604910),G=D(23987);class N{constructor(){this.hit=!1,this.distance=0,this.pickedPoint=null,this.pickedMesh=null,this.bu=0,this.bv=0,this.faceId=-1,this.subMeshFaceId=-1,this.subMeshId=0,this.pickedSprite=null,this.thinInstanceIndex=-1,this.ray=null,this.originMesh=null,this.aimTransform=null,this.gripTransform=null}getNormal(t=!1,K=!0){if(!this.pickedMesh||K&&!this.pickedMesh.isVerticesDataPresent(G.R.NormalKind))return null;let D,N=this.pickedMesh.getIndices();0===(null==N?void 0:N.length)&&(N=null);const W=a.AA.Vector3[0],x=a.AA.Vector3[1],b=a.AA.Vector3[2];if(K){const t=this.pickedMesh.getVerticesData(G.R.NormalKind);let K=N?a.Pq.FromArrayToRef(t,3*N[3*this.faceId],W):W.copyFromFloats(t[3*this.faceId*3],t[3*this.faceId*3+1],t[3*this.faceId*3+2]),n=N?a.Pq.FromArrayToRef(t,3*N[3*this.faceId+1],x):x.copyFromFloats(t[3*(3*this.faceId+1)],t[3*(3*this.faceId+1)+1],t[3*(3*this.faceId+1)+2]),e=N?a.Pq.FromArrayToRef(t,3*N[3*this.faceId+2],b):b.copyFromFloats(t[3*(3*this.faceId+2)],t[3*(3*this.faceId+2)+1],t[3*(3*this.faceId+2)+2]);K=K.scale(this.bu),n=n.scale(this.bv),e=e.scale(1-this.bu-this.bv),D=new a.Pq(K.x+n.x+e.x,K.y+n.y+e.y,K.z+n.z+e.z)}else{const t=this.pickedMesh.getVerticesData(G.R.PositionKind),K=N?a.Pq.FromArrayToRef(t,3*N[3*this.faceId],W):W.copyFromFloats(t[3*this.faceId*3],t[3*this.faceId*3+1],t[3*this.faceId*3+2]),n=N?a.Pq.FromArrayToRef(t,3*N[3*this.faceId+1],x):x.copyFromFloats(t[3*(3*this.faceId+1)],t[3*(3*this.faceId+1)+1],t[3*(3*this.faceId+1)+2]),e=N?a.Pq.FromArrayToRef(t,3*N[3*this.faceId+2],b):b.copyFromFloats(t[3*(3*this.faceId+2)],t[3*(3*this.faceId+2)+1],t[3*(3*this.faceId+2)+2]),i=K.subtract(n),z=e.subtract(n);D=a.Pq.Cross(i,z)}const n=(t,K)=>{let D=t.getWorldMatrix();t.nonUniformScaling&&(a.AA.Matrix[0].copyFrom(D),D=a.AA.Matrix[0],D.setTranslationFromFloats(0,0,0),D.invert(),D.transposeToRef(a.AA.Matrix[1]),D=a.AA.Matrix[1]),a.Pq.TransformNormalToRef(K,D,K)};if(t&&n(this.pickedMesh,D),this.ray){const K=a.AA.Vector3[0].copyFrom(D);t||n(this.pickedMesh,K),a.Pq.Dot(K,this.ray.direction)>0&&D.negateInPlace()}return D.normalize(),D}getTextureCoordinates(t=G.R.UVKind){if(!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(t))return null;const K=this.pickedMesh.getIndices();if(!K)return null;const D=this.pickedMesh.getVerticesData(t);if(!D)return null;let N=a.I9.FromArray(D,2*K[3*this.faceId]),W=a.I9.FromArray(D,2*K[3*this.faceId+1]),x=a.I9.FromArray(D,2*K[3*this.faceId+2]);return N=N.scale(this.bu),W=W.scale(this.bv),x=x.scale(1-this.bu-this.bv),new a.I9(N.x+W.x+x.x,N.y+W.y+x.y)}}},158548:(t,K,D)=>{D.d(K,{rX:()=>a});let a=!1},747979:(t,K,D)=>{D.d(K,{I:()=>W});var a=D(967872),G=D(604910),N=D(779908);class W{constructor(t,K,D){this.vectors=a.mI(8,G.Pq.Zero),this.center=G.Pq.Zero(),this.centerWorld=G.Pq.Zero(),this.extendSize=G.Pq.Zero(),this.extendSizeWorld=G.Pq.Zero(),this.directions=a.mI(3,G.Pq.Zero),this.vectorsWorld=a.mI(8,G.Pq.Zero),this.minimumWorld=G.Pq.Zero(),this.maximumWorld=G.Pq.Zero(),this.minimum=G.Pq.Zero(),this.maximum=G.Pq.Zero(),this._drawWrapperFront=null,this._drawWrapperBack=null,this.reConstruct(t,K,D)}reConstruct(t,K,D){const a=t.x,N=t.y,W=t.z,x=K.x,b=K.y,n=K.z,e=this.vectors;this.minimum.copyFromFloats(a,N,W),this.maximum.copyFromFloats(x,b,n),e[0].copyFromFloats(a,N,W),e[1].copyFromFloats(x,b,n),e[2].copyFromFloats(x,N,W),e[3].copyFromFloats(a,b,W),e[4].copyFromFloats(a,N,n),e[5].copyFromFloats(x,b,W),e[6].copyFromFloats(a,b,n),e[7].copyFromFloats(x,N,n),K.addToRef(t,this.center).scaleInPlace(.5),K.subtractToRef(t,this.extendSize).scaleInPlace(.5),this._worldMatrix=D||G.uq.IdentityReadOnly,this._update(this._worldMatrix)}scale(t){const K=W._TmpVector3,D=this.maximum.subtractToRef(this.minimum,K[0]),a=D.length();D.normalizeFromLength(a);const G=a*t,N=D.scaleInPlace(.5*G),x=this.center.subtractToRef(N,K[1]),b=this.center.addToRef(N,K[2]);return this.reConstruct(x,b,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(t){const K=this.minimumWorld,D=this.maximumWorld,a=this.directions,N=this.vectorsWorld,W=this.vectors;if(t.isIdentity()){K.copyFrom(this.minimum),D.copyFrom(this.maximum);for(let t=0;t<8;++t)N[t].copyFrom(W[t]);this.extendSizeWorld.copyFrom(this.extendSize),this.centerWorld.copyFrom(this.center)}else{K.setAll(Number.MAX_VALUE),D.setAll(-Number.MAX_VALUE);for(let a=0;a<8;++a){const x=N[a];G.Pq.TransformCoordinatesToRef(W[a],t,x),K.minimizeInPlace(x),D.maximizeInPlace(x)}D.subtractToRef(K,this.extendSizeWorld).scaleInPlace(.5),D.addToRef(K,this.centerWorld).scaleInPlace(.5)}G.Pq.FromArrayToRef(t.m,0,a[0]),G.Pq.FromArrayToRef(t.m,4,a[1]),G.Pq.FromArrayToRef(t.m,8,a[2]),this._worldMatrix=t}isInFrustum(t){return W.IsInFrustum(this.vectorsWorld,t)}isCompletelyInFrustum(t){return W.IsCompletelyInFrustum(this.vectorsWorld,t)}intersectsPoint(t){const K=this.minimumWorld,D=this.maximumWorld,a=K.x,G=K.y,W=K.z,x=D.x,b=D.y,n=D.z,e=t.x,i=t.y,z=t.z,I=-N.bH;return!(x-e<I||I>e-a||b-i<I||I>i-G||n-z<I||I>z-W)}intersectsSphere(t){return W.IntersectsSphere(this.minimumWorld,this.maximumWorld,t.centerWorld,t.radiusWorld)}intersectsMinMax(t,K){const D=this.minimumWorld,a=this.maximumWorld,G=D.x,N=D.y,W=D.z,x=a.x,b=a.y,n=a.z,e=t.x,i=t.y,z=t.z,I=K.x,Z=K.y,w=K.z;return!(x<e||G>I||b<i||N>Z||n<z||W>w)}dispose(){var t,K;null===(t=this._drawWrapperFront)||void 0===t||t.dispose(),null===(K=this._drawWrapperBack)||void 0===K||K.dispose()}static Intersects(t,K){return t.intersectsMinMax(K.minimumWorld,K.maximumWorld)}static IntersectsSphere(t,K,D,a){const N=W._TmpVector3[0];return G.Pq.ClampToRef(D,t,K,N),G.Pq.DistanceSquared(D,N)<=a*a}static IsCompletelyInFrustum(t,K){for(let D=0;D<6;++D){const a=K[D];for(let K=0;K<8;++K)if(a.dotCoordinate(t[K])<0)return!1}return!0}static IsInFrustum(t,K){for(let D=0;D<6;++D){let a=!0;const G=K[D];for(let K=0;K<8;++K)if(G.dotCoordinate(t[K])>=0){a=!1;break}if(a)return!1}return!0}}W._TmpVector3=a.mI(3,G.Pq.Zero)},59036:(t,K,D)=>{D.d(K,{j:()=>i});var a=D(967872),G=D(604910),N=D(747979),W=D(214601);const x={min:0,max:0},b={min:0,max:0},n=(t,K,D)=>{const a=G.Pq.Dot(K.centerWorld,t),N=Math.abs(G.Pq.Dot(K.directions[0],t))*K.extendSize.x+Math.abs(G.Pq.Dot(K.directions[1],t))*K.extendSize.y+Math.abs(G.Pq.Dot(K.directions[2],t))*K.extendSize.z;D.min=a-N,D.max=a+N},e=(t,K,D)=>(n(t,K,x),n(t,D,b),!(x.min>b.max||b.min>x.max));class i{constructor(t,K,D){this._isLocked=!1,this.boundingBox=new N.I(t,K,D),this.boundingSphere=new W.i(t,K,D)}reConstruct(t,K,D){this.boundingBox.reConstruct(t,K,D),this.boundingSphere.reConstruct(t,K,D)}get minimum(){return this.boundingBox.minimum}get maximum(){return this.boundingBox.maximum}get isLocked(){return this._isLocked}set isLocked(t){this._isLocked=t}update(t){this._isLocked||(this.boundingBox._update(t),this.boundingSphere._update(t))}centerOn(t,K){const D=i._TmpVector3[0].copyFrom(t).subtractInPlace(K),a=i._TmpVector3[1].copyFrom(t).addInPlace(K);return this.boundingBox.reConstruct(D,a,this.boundingBox.getWorldMatrix()),this.boundingSphere.reConstruct(D,a,this.boundingBox.getWorldMatrix()),this}encapsulate(t){const K=G.Pq.Minimize(this.minimum,t),D=G.Pq.Maximize(this.maximum,t);return this.reConstruct(K,D,this.boundingBox.getWorldMatrix()),this}encapsulateBoundingInfo(t){const K=G.AA.Matrix[0];this.boundingBox.getWorldMatrix().invertToRef(K);const D=G.AA.Vector3[0];return G.Pq.TransformCoordinatesToRef(t.boundingBox.minimumWorld,K,D),this.encapsulate(D),G.Pq.TransformCoordinatesToRef(t.boundingBox.maximumWorld,K,D),this.encapsulate(D),this}scale(t){return this.boundingBox.scale(t),this.boundingSphere.scale(t),this}isInFrustum(t,K=0){return!(2!==K&&3!==K||!this.boundingSphere.isCenterInFrustum(t))||!!this.boundingSphere.isInFrustum(t)&&(!(1!==K&&3!==K)||this.boundingBox.isInFrustum(t))}get diagonalLength(){const t=this.boundingBox;return t.maximumWorld.subtractToRef(t.minimumWorld,i._TmpVector3[0]).length()}isCompletelyInFrustum(t){return this.boundingBox.isCompletelyInFrustum(t)}_checkCollision(t){return t._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)}intersectsPoint(t){return!!this.boundingSphere.centerWorld&&!!this.boundingSphere.intersectsPoint(t)&&!!this.boundingBox.intersectsPoint(t)}intersects(t,K){if(!W.i.Intersects(this.boundingSphere,t.boundingSphere))return!1;if(!N.I.Intersects(this.boundingBox,t.boundingBox))return!1;if(!K)return!0;const D=this.boundingBox,a=t.boundingBox;return!!(e(D.directions[0],D,a)&&e(D.directions[1],D,a)&&e(D.directions[2],D,a)&&e(a.directions[0],D,a)&&e(a.directions[1],D,a)&&e(a.directions[2],D,a)&&e(G.Pq.Cross(D.directions[0],a.directions[0]),D,a)&&e(G.Pq.Cross(D.directions[0],a.directions[1]),D,a)&&e(G.Pq.Cross(D.directions[0],a.directions[2]),D,a)&&e(G.Pq.Cross(D.directions[1],a.directions[0]),D,a)&&e(G.Pq.Cross(D.directions[1],a.directions[1]),D,a)&&e(G.Pq.Cross(D.directions[1],a.directions[2]),D,a)&&e(G.Pq.Cross(D.directions[2],a.directions[0]),D,a)&&e(G.Pq.Cross(D.directions[2],a.directions[1]),D,a)&&e(G.Pq.Cross(D.directions[2],a.directions[2]),D,a))}}i._TmpVector3=a.mI(2,G.Pq.Zero)},214601:(t,K,D)=>{D.d(K,{i:()=>N});var a=D(967872),G=D(604910);class N{constructor(t,K,D){this.center=G.Pq.Zero(),this.centerWorld=G.Pq.Zero(),this.minimum=G.Pq.Zero(),this.maximum=G.Pq.Zero(),this.reConstruct(t,K,D)}reConstruct(t,K,D){this.minimum.copyFrom(t),this.maximum.copyFrom(K);const a=G.Pq.Distance(t,K);K.addToRef(t,this.center).scaleInPlace(.5),this.radius=.5*a,this._update(D||G.uq.IdentityReadOnly)}scale(t){const K=this.radius*t,D=N._TmpVector3,a=D[0].setAll(K),G=this.center.subtractToRef(a,D[1]),W=this.center.addToRef(a,D[2]);return this.reConstruct(G,W,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(t){if(t.isIdentity())this.centerWorld.copyFrom(this.center),this.radiusWorld=this.radius;else{G.Pq.TransformCoordinatesToRef(this.center,t,this.centerWorld);const K=N._TmpVector3[0];G.Pq.TransformNormalFromFloatsToRef(1,1,1,t,K),this.radiusWorld=Math.max(Math.abs(K.x),Math.abs(K.y),Math.abs(K.z))*this.radius}}isInFrustum(t){const K=this.centerWorld,D=this.radiusWorld;for(let a=0;a<6;a++)if(t[a].dotCoordinate(K)<=-D)return!1;return!0}isCenterInFrustum(t){const K=this.centerWorld;for(let D=0;D<6;D++)if(t[D].dotCoordinate(K)<0)return!1;return!0}intersectsPoint(t){const K=G.Pq.DistanceSquared(this.centerWorld,t);return!(this.radiusWorld*this.radiusWorld<K)}static Intersects(t,K){const D=G.Pq.DistanceSquared(t.centerWorld,K.centerWorld),a=t.radiusWorld+K.radiusWorld;return!(a*a<D)}static CreateFromCenterAndRadius(t,K,D){this._TmpVector3[0].copyFrom(t),this._TmpVector3[1].copyFromFloats(0,0,K),this._TmpVector3[2].copyFrom(t),this._TmpVector3[0].addInPlace(this._TmpVector3[1]),this._TmpVector3[2].subtractInPlace(this._TmpVector3[1]);const a=new N(this._TmpVector3[0],this._TmpVector3[2]);return a._worldMatrix=D||G.uq.Identity(),a}}N._TmpVector3=a.mI(3,G.Pq.Zero)},725378:(t,K,D)=>{var a,G,N,W,x,b,n;D.d(K,{ST:()=>G,bq:()=>a}),function(t){t[t["Generic"]=0]="Generic",t[t["Keyboard"]=1]="Keyboard",t[t["Mouse"]=2]="Mouse",t[t["Touch"]=3]="Touch",t[t["DualShock"]=4]="DualShock",t[t["Xbox"]=5]="Xbox",t[t["Switch"]=6]="Switch",t[t["DualSense"]=7]="DualSense"}(a||(a={})),function(t){t[t["Horizontal"]=0]="Horizontal",t[t["Vertical"]=1]="Vertical",t[t["LeftClick"]=2]="LeftClick",t[t["MiddleClick"]=3]="MiddleClick",t[t["RightClick"]=4]="RightClick",t[t["BrowserBack"]=5]="BrowserBack",t[t["BrowserForward"]=6]="BrowserForward",t[t["MouseWheelX"]=7]="MouseWheelX",t[t["MouseWheelY"]=8]="MouseWheelY",t[t["MouseWheelZ"]=9]="MouseWheelZ",t[t["Move"]=12]="Move"}(G||(G={})),function(t){t[t["Horizontal"]=0]="Horizontal",t[t["Vertical"]=1]="Vertical",t[t["LeftClick"]=2]="LeftClick",t[t["MiddleClick"]=3]="MiddleClick",t[t["RightClick"]=4]="RightClick",t[t["BrowserBack"]=5]="BrowserBack",t[t["BrowserForward"]=6]="BrowserForward",t[t["MouseWheelX"]=7]="MouseWheelX",t[t["MouseWheelY"]=8]="MouseWheelY",t[t["MouseWheelZ"]=9]="MouseWheelZ",t[t["DeltaHorizontal"]=10]="DeltaHorizontal",t[t["DeltaVertical"]=11]="DeltaVertical"}(N||(N={})),function(t){t[t["Cross"]=0]="Cross",t[t["Circle"]=1]="Circle",t[t["Square"]=2]="Square",t[t["Triangle"]=3]="Triangle",t[t["L1"]=4]="L1",t[t["R1"]=5]="R1",t[t["L2"]=6]="L2",t[t["R2"]=7]="R2",t[t["Share"]=8]="Share",t[t["Options"]=9]="Options",t[t["L3"]=10]="L3",t[t["R3"]=11]="R3",t[t["DPadUp"]=12]="DPadUp",t[t["DPadDown"]=13]="DPadDown",t[t["DPadLeft"]=14]="DPadLeft",t[t["DPadRight"]=15]="DPadRight",t[t["Home"]=16]="Home",t[t["TouchPad"]=17]="TouchPad",t[t["LStickXAxis"]=18]="LStickXAxis",t[t["LStickYAxis"]=19]="LStickYAxis",t[t["RStickXAxis"]=20]="RStickXAxis",t[t["RStickYAxis"]=21]="RStickYAxis"}(W||(W={})),function(t){t[t["Cross"]=0]="Cross",t[t["Circle"]=1]="Circle",t[t["Square"]=2]="Square",t[t["Triangle"]=3]="Triangle",t[t["L1"]=4]="L1",t[t["R1"]=5]="R1",t[t["L2"]=6]="L2",t[t["R2"]=7]="R2",t[t["Create"]=8]="Create",t[t["Options"]=9]="Options",t[t["L3"]=10]="L3",t[t["R3"]=11]="R3",t[t["DPadUp"]=12]="DPadUp",t[t["DPadDown"]=13]="DPadDown",t[t["DPadLeft"]=14]="DPadLeft",t[t["DPadRight"]=15]="DPadRight",t[t["Home"]=16]="Home",t[t["TouchPad"]=17]="TouchPad",t[t["LStickXAxis"]=18]="LStickXAxis",t[t["LStickYAxis"]=19]="LStickYAxis",t[t["RStickXAxis"]=20]="RStickXAxis",t[t["RStickYAxis"]=21]="RStickYAxis"}(x||(x={})),function(t){t[t["A"]=0]="A",t[t["B"]=1]="B",t[t["X"]=2]="X",t[t["Y"]=3]="Y",t[t["LB"]=4]="LB",t[t["RB"]=5]="RB",t[t["LT"]=6]="LT",t[t["RT"]=7]="RT",t[t["Back"]=8]="Back",t[t["Start"]=9]="Start",t[t["LS"]=10]="LS",t[t["RS"]=11]="RS",t[t["DPadUp"]=12]="DPadUp",t[t["DPadDown"]=13]="DPadDown",t[t["DPadLeft"]=14]="DPadLeft",t[t["DPadRight"]=15]="DPadRight",t[t["Home"]=16]="Home",t[t["LStickXAxis"]=17]="LStickXAxis",t[t["LStickYAxis"]=18]="LStickYAxis",t[t["RStickXAxis"]=19]="RStickXAxis",t[t["RStickYAxis"]=20]="RStickYAxis"}(b||(b={})),function(t){t[t["B"]=0]="B",t[t["A"]=1]="A",t[t["Y"]=2]="Y",t[t["X"]=3]="X",t[t["L"]=4]="L",t[t["R"]=5]="R",t[t["ZL"]=6]="ZL",t[t["ZR"]=7]="ZR",t[t["Minus"]=8]="Minus",t[t["Plus"]=9]="Plus",t[t["LS"]=10]="LS",t[t["RS"]=11]="RS",t[t["DPadUp"]=12]="DPadUp",t[t["DPadDown"]=13]="DPadDown",t[t["DPadLeft"]=14]="DPadLeft",t[t["DPadRight"]=15]="DPadRight",t[t["Home"]=16]="Home",t[t["Capture"]=17]="Capture",t[t["LStickXAxis"]=18]="LStickXAxis",t[t["LStickYAxis"]=19]="LStickYAxis",t[t["RStickXAxis"]=20]="RStickXAxis",t[t["RStickYAxis"]=21]="RStickYAxis"}(n||(n={}))},154711:(t,K,D)=>{D.d(K,{c:()=>G});var a=D(638113);class G{constructor(t,K,D=0){this.deviceType=K,this.deviceSlot=D,this.onInputChangedObservable=new a.cP,this._deviceInputSystem=t}getInput(t){return this._deviceInputSystem.pollInput(this.deviceType,this.deviceSlot,t)}}},276759:(t,K,D)=>{D.d(K,{Z:()=>w});var a=D(725378),G=D(638113),N=D(332108);class W{static CreateDeviceEvent(t,K,D,G,N,W,x){switch(t){case a.bq.Keyboard:return this._CreateKeyboardEvent(D,G,N,W);case a.bq.Mouse:if(D===a.ST.MouseWheelX||D===a.ST.MouseWheelY||D===a.ST.MouseWheelZ)return this._CreateWheelEvent(t,K,D,G,N,W);case a.bq.Touch:return this._CreatePointerEvent(t,K,D,G,N,W,x);default:throw`Unable to generate event for device ${a.bq[t]}`}}static _CreatePointerEvent(t,K,D,G,N,W,x){const b=this._CreateMouseEvent(t,K,D,G,N,W);t===a.bq.Mouse?(b.deviceType=a.bq.Mouse,b.pointerId=1,b.pointerType="mouse"):(b.deviceType=a.bq.Touch,b.pointerId=null!=x?x:K,b.pointerType="touch");let n=0;return n+=N.pollInput(t,K,a.ST.LeftClick),n+=2*N.pollInput(t,K,a.ST.RightClick),n+=4*N.pollInput(t,K,a.ST.MiddleClick),b.buttons=n,D===a.ST.Move?b.type="pointermove":D>=a.ST.LeftClick&&D<=a.ST.RightClick&&(b.type=1===G?"pointerdown":"pointerup",b.button=D-2),b}static _CreateWheelEvent(t,K,D,G,W,x){const b=this._CreateMouseEvent(t,K,D,G,W,x);switch(b.pointerId=1,b.type="wheel",b.deltaMode=N.s.DOM_DELTA_PIXEL,b.deltaX=0,b.deltaY=0,b.deltaZ=0,D){case a.ST.MouseWheelX:b.deltaX=G;break;case a.ST.MouseWheelY:b.deltaY=G;break;case a.ST.MouseWheelZ:b.deltaZ=G}return b}static _CreateMouseEvent(t,K,D,G,N,W){const x=this._CreateEvent(W),b=N.pollInput(t,K,a.ST.Horizontal),n=N.pollInput(t,K,a.ST.Vertical);return W?(x.movementX=0,x.movementY=0,x.offsetX=x.movementX-W.getBoundingClientRect().x,x.offsetY=x.movementY-W.getBoundingClientRect().y):(x.movementX=N.pollInput(t,K,10),x.movementY=N.pollInput(t,K,11),x.offsetX=0,x.offsetY=0),this._CheckNonCharacterKeys(x,N),x.clientX=b,x.clientY=n,x.x=b,x.y=n,x.deviceType=t,x.deviceSlot=K,x.inputIndex=D,x}static _CreateKeyboardEvent(t,K,D,G){const N=this._CreateEvent(G);return this._CheckNonCharacterKeys(N,D),N.deviceType=a.bq.Keyboard,N.deviceSlot=0,N.inputIndex=t,N.type=1===K?"keydown":"keyup",N.key=String.fromCharCode(t),N.keyCode=t,N}static _CheckNonCharacterKeys(t,K){const D=K.isDeviceAvailable(a.bq.Keyboard),G=D&&1===K.pollInput(a.bq.Keyboard,0,18),N=D&&1===K.pollInput(a.bq.Keyboard,0,17),W=D&&(1===K.pollInput(a.bq.Keyboard,0,91)||1===K.pollInput(a.bq.Keyboard,0,92)||1===K.pollInput(a.bq.Keyboard,0,93)),x=D&&1===K.pollInput(a.bq.Keyboard,0,16);t.altKey=G,t.ctrlKey=N,t.metaKey=W,t.shiftKey=x}static _CreateEvent(t){const K={preventDefault:()=>{}};return K.target=t,K}}class x{constructor(t,K,D){this._nativeInput=_native.DeviceInputSystem?new _native.DeviceInputSystem(t,K,((t,K,a,G)=>{const N=W.CreateDeviceEvent(t,K,a,G,this);D(t,K,N)})):this._createDummyNativeInput()}pollInput(t,K,D){return this._nativeInput.pollInput(t,K,D)}isDeviceAvailable(t){return t===a.bq.Mouse||t===a.bq.Touch}dispose(){this._nativeInput.dispose()}_createDummyNativeInput(){return{pollInput:()=>0,isDeviceAvailable:()=>!1,dispose:()=>{}}}}var b=D(394501),n=D(898973);const e=255,i=Object.keys(a.ST).length/2;class z{constructor(t,K,D,a){this._inputs=[],this._keyboardActive=!1,this._pointerActive=!1,this._usingSafari=n.S0.IsSafari(),this._usingMacOS=b.XD()&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),this._keyboardDownEvent=t=>{},this._keyboardUpEvent=t=>{},this._keyboardBlurEvent=t=>{},this._pointerMoveEvent=t=>{},this._pointerDownEvent=t=>{},this._pointerUpEvent=t=>{},this._pointerCancelEvent=t=>{},this._pointerWheelEvent=t=>{},this._pointerBlurEvent=t=>{},this._pointerMacOSChromeOutEvent=t=>{},this._eventsAttached=!1,this._mouseId=-1,this._isUsingFirefox=b.XD()&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Firefox"),this._isUsingChromium=b.XD()&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Chrome"),this._maxTouchPoints=0,this._pointerInputClearObserver=null,this._gamepadConnectedEvent=t=>{},this._gamepadDisconnectedEvent=t=>{},this._eventPrefix=n.S0.GetPointerPrefix(t),this._engine=t,this._onDeviceConnected=K,this._onDeviceDisconnected=D,this._onInputChanged=a,this._mouseId=this._isUsingFirefox?0:1,this._enableEvents(),this._usingMacOS&&(this._metaKeys=[]),this._engine._onEngineViewChanged||(this._engine._onEngineViewChanged=()=>{this._enableEvents()})}pollInput(t,K,D){const G=this._inputs[t][K];if(!G)throw`Unable to find device ${a.bq[t]}`;t>=a.bq.DualShock&&t<=a.bq.DualSense&&this._updateDevice(t,K,D);const N=G[D];if(void 0===N)throw`Unable to find input ${D} for device ${a.bq[t]} in slot ${K}`;return D===a.ST.Move&&n.S0.Warn(`Unable to provide information for PointerInput.Move.  Try using PointerInput.Horizontal or PointerInput.Vertical for move data.`),N}isDeviceAvailable(t){return void 0!==this._inputs[t]}dispose(){this._onDeviceConnected=()=>{},this._onDeviceDisconnected=()=>{},this._onInputChanged=()=>{},delete this._engine._onEngineViewChanged,this._elementToAttachTo&&this._disableEvents()}_enableEvents(){const t=null==this?void 0:this._engine.getInputElement();if(t&&(!this._eventsAttached||this._elementToAttachTo!==t)){if(this._disableEvents(),this._inputs)for(const t of this._inputs)if(t)for(const K in t){const D=t[+K];if(D)for(let t=0;t<D.length;t++)D[t]=0}this._elementToAttachTo=t,this._elementToAttachTo.tabIndex=-1!==this._elementToAttachTo.tabIndex?this._elementToAttachTo.tabIndex:this._engine.canvasTabIndex,this._handleKeyActions(),this._handlePointerActions(),this._handleGamepadActions(),this._eventsAttached=!0,this._checkForConnectedDevices()}}_disableEvents(){this._elementToAttachTo&&(this._elementToAttachTo.removeEventListener("blur",this._keyboardBlurEvent),this._elementToAttachTo.removeEventListener("blur",this._pointerBlurEvent),this._elementToAttachTo.removeEventListener("keydown",this._keyboardDownEvent),this._elementToAttachTo.removeEventListener("keyup",this._keyboardUpEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"move",this._pointerMoveEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"down",this._pointerDownEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"up",this._pointerUpEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"cancel",this._pointerCancelEvent),this._elementToAttachTo.removeEventListener(this._wheelEventName,this._pointerWheelEvent),this._usingMacOS&&this._isUsingChromium&&this._elementToAttachTo.removeEventListener("lostpointercapture",this._pointerMacOSChromeOutEvent),window.removeEventListener("gamepadconnected",this._gamepadConnectedEvent),window.removeEventListener("gamepaddisconnected",this._gamepadDisconnectedEvent)),this._pointerInputClearObserver&&this._engine.onEndFrameObservable.remove(this._pointerInputClearObserver),this._eventsAttached=!1}_checkForConnectedDevices(){if(navigator.getGamepads){const t=navigator.getGamepads();for(const K of t)K&&this._addGamePad(K)}"function"==typeof matchMedia&&matchMedia("(pointer:fine)").matches&&this._addPointerDevice(a.bq.Mouse,0,0,0)}_addGamePad(t){const K=this._getGamepadDeviceType(t.id),D=t.index;this._gamepads=this._gamepads||new Array(t.index+1),this._registerDevice(K,D,t.buttons.length+t.axes.length),this._gamepads[D]=K}_addPointerDevice(t,K,D,a){this._pointerActive||(this._pointerActive=!0),this._registerDevice(t,K,i);const G=this._inputs[t][K];G[0]=D,G[1]=a}_registerDevice(t,K,D){if(void 0===K)throw`Unable to register device ${a.bq[t]} to undefined slot.`;if(this._inputs[t]||(this._inputs[t]={}),!this._inputs[t][K]){const a=new Array(D);a.fill(0),this._inputs[t][K]=a,this._onDeviceConnected(t,K)}}_unregisterDevice(t,K){this._inputs[t][K]&&(delete this._inputs[t][K],this._onDeviceDisconnected(t,K))}_handleKeyActions(){this._keyboardDownEvent=t=>{this._keyboardActive||(this._keyboardActive=!0,this._registerDevice(a.bq.Keyboard,0,e));const K=this._inputs[a.bq.Keyboard][0];if(K){K[t.keyCode]=1;const D=t;D.inputIndex=t.keyCode,this._usingMacOS&&t.metaKey&&"Meta"!==t.key&&(this._metaKeys.includes(t.keyCode)||this._metaKeys.push(t.keyCode)),this._onInputChanged(a.bq.Keyboard,0,D)}},this._keyboardUpEvent=t=>{this._keyboardActive||(this._keyboardActive=!0,this._registerDevice(a.bq.Keyboard,0,e));const K=this._inputs[a.bq.Keyboard][0];if(K){K[t.keyCode]=0;const D=t;if(D.inputIndex=t.keyCode,this._usingMacOS&&"Meta"===t.key&&this._metaKeys.length>0){for(const t of this._metaKeys){const D=W.CreateDeviceEvent(a.bq.Keyboard,0,t,0,this,this._elementToAttachTo);K[t]=0,this._onInputChanged(a.bq.Keyboard,0,D)}this._metaKeys.splice(0,this._metaKeys.length)}this._onInputChanged(a.bq.Keyboard,0,D)}},this._keyboardBlurEvent=()=>{if(this._keyboardActive){const t=this._inputs[a.bq.Keyboard][0];for(let K=0;K<t.length;K++)if(0!==t[K]){t[K]=0;const D=W.CreateDeviceEvent(a.bq.Keyboard,0,K,0,this,this._elementToAttachTo);this._onInputChanged(a.bq.Keyboard,0,D)}this._usingMacOS&&this._metaKeys.splice(0,this._metaKeys.length)}},this._elementToAttachTo.addEventListener("keydown",this._keyboardDownEvent),this._elementToAttachTo.addEventListener("keyup",this._keyboardUpEvent),this._elementToAttachTo.addEventListener("blur",this._keyboardBlurEvent)}_handlePointerActions(){this._maxTouchPoints=b.XD()&&navigator.maxTouchPoints||2,this._activeTouchIds||(this._activeTouchIds=new Array(this._maxTouchPoints));for(let t=0;t<this._maxTouchPoints;t++)this._activeTouchIds[t]=-1;this._pointerMoveEvent=t=>{const K=this._getPointerType(t);let D=K===a.bq.Mouse?0:this._activeTouchIds.indexOf(t.pointerId);if(K===a.bq.Touch&&-1===D){const a=this._activeTouchIds.indexOf(-1);if(!(a>=0))return void n.S0.Warn(`Max number of touches exceeded.  Ignoring touches in excess of ${this._maxTouchPoints}`);D=a,this._activeTouchIds[a]=t.pointerId,this._onDeviceConnected(K,D)}this._inputs[K]||(this._inputs[K]={}),this._inputs[K][D]||this._addPointerDevice(K,D,t.clientX,t.clientY);const G=this._inputs[K][D];if(G){const N=t;N.inputIndex=a.ST.Move,G[a.ST.Horizontal]=t.clientX,G[a.ST.Vertical]=t.clientY,K===a.bq.Touch&&0===G[a.ST.LeftClick]&&(G[a.ST.LeftClick]=1),void 0===t.pointerId&&(t.pointerId=this._mouseId),this._onInputChanged(K,D,N),this._usingSafari||-1===t.button||(N.inputIndex=t.button+2,G[t.button+2]=G[t.button+2]?0:1,this._onInputChanged(K,D,N))}},this._pointerDownEvent=t=>{const K=this._getPointerType(t);let D=K===a.bq.Mouse?0:t.pointerId;if(K===a.bq.Touch){let K=this._activeTouchIds.indexOf(t.pointerId);if(-1===K&&(K=this._activeTouchIds.indexOf(-1)),!(K>=0))return void n.S0.Warn(`Max number of touches exceeded.  Ignoring touches in excess of ${this._maxTouchPoints}`);D=K,this._activeTouchIds[K]=t.pointerId}this._inputs[K]||(this._inputs[K]={}),this._inputs[K][D]?K===a.bq.Touch&&this._onDeviceConnected(K,D):this._addPointerDevice(K,D,t.clientX,t.clientY);const G=this._inputs[K][D];if(G){const N=G[a.ST.Horizontal],W=G[a.ST.Vertical];if(K===a.bq.Mouse){if(void 0===t.pointerId&&(t.pointerId=this._mouseId),!document.pointerLockElement)try{this._elementToAttachTo.setPointerCapture(this._mouseId)}catch(t){}}else if(t.pointerId&&!document.pointerLockElement)try{this._elementToAttachTo.setPointerCapture(t.pointerId)}catch(t){}G[a.ST.Horizontal]=t.clientX,G[a.ST.Vertical]=t.clientY,G[t.button+2]=1;const x=t;x.inputIndex=t.button+2,this._onInputChanged(K,D,x),N===t.clientX&&W===t.clientY||(x.inputIndex=a.ST.Move,this._onInputChanged(K,D,x))}},this._pointerUpEvent=t=>{var K,D,G,N,W;const x=this._getPointerType(t),b=x===a.bq.Mouse?0:this._activeTouchIds.indexOf(t.pointerId);if(x===a.bq.Touch){if(-1===b)return;this._activeTouchIds[b]=-1}const n=null===(K=this._inputs[x])||void 0===K?void 0:K[b];if(n&&0!==n[t.button+2]){const K=n[a.ST.Horizontal],e=n[a.ST.Vertical];n[a.ST.Horizontal]=t.clientX,n[a.ST.Vertical]=t.clientY,n[t.button+2]=0;const i=t;void 0===t.pointerId&&(t.pointerId=this._mouseId),K===t.clientX&&e===t.clientY||(i.inputIndex=a.ST.Move,this._onInputChanged(x,b,i)),i.inputIndex=t.button+2,x===a.bq.Mouse&&this._mouseId>=0&&(null===(G=(D=this._elementToAttachTo).hasPointerCapture)||void 0===G?void 0:G.call(D,this._mouseId))?this._elementToAttachTo.releasePointerCapture(this._mouseId):t.pointerId&&(null===(W=(N=this._elementToAttachTo).hasPointerCapture)||void 0===W?void 0:W.call(N,t.pointerId))&&this._elementToAttachTo.releasePointerCapture(t.pointerId),this._onInputChanged(x,b,i),x===a.bq.Touch&&this._onDeviceDisconnected(x,b)}},this._pointerCancelEvent=t=>{var K,D,G,N;if("mouse"===t.pointerType){const t=this._inputs[a.bq.Mouse][0];this._mouseId>=0&&(null===(D=(K=this._elementToAttachTo).hasPointerCapture)||void 0===D?void 0:D.call(K,this._mouseId))&&this._elementToAttachTo.releasePointerCapture(this._mouseId);for(let K=a.ST.LeftClick;K<=a.ST.BrowserForward;K++)if(1===t[K]){t[K]=0;const D=W.CreateDeviceEvent(a.bq.Mouse,0,K,0,this,this._elementToAttachTo);this._onInputChanged(a.bq.Mouse,0,D)}}else{const K=this._activeTouchIds.indexOf(t.pointerId);if(-1===K)return;(null===(N=(G=this._elementToAttachTo).hasPointerCapture)||void 0===N?void 0:N.call(G,t.pointerId))&&this._elementToAttachTo.releasePointerCapture(t.pointerId),this._inputs[a.bq.Touch][K][a.ST.LeftClick]=0;const D=W.CreateDeviceEvent(a.bq.Touch,K,a.ST.LeftClick,0,this,this._elementToAttachTo,t.pointerId);this._onInputChanged(a.bq.Touch,K,D),this._activeTouchIds[K]=-1,this._onDeviceDisconnected(a.bq.Touch,K)}},this._wheelEventName="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";let t=!1;const K=function(){};try{const D=Object.defineProperty({},"passive",{get:function(){t=!0}});this._elementToAttachTo.addEventListener("test",K,D),this._elementToAttachTo.removeEventListener("test",K,D)}catch(t){}this._pointerBlurEvent=()=>{var t,K,D,G,N;if(this.isDeviceAvailable(a.bq.Mouse)){const D=this._inputs[a.bq.Mouse][0];this._mouseId>=0&&(null===(K=(t=this._elementToAttachTo).hasPointerCapture)||void 0===K?void 0:K.call(t,this._mouseId))&&this._elementToAttachTo.releasePointerCapture(this._mouseId);for(let t=a.ST.LeftClick;t<=a.ST.BrowserForward;t++)if(1===D[t]){D[t]=0;const K=W.CreateDeviceEvent(a.bq.Mouse,0,t,0,this,this._elementToAttachTo);this._onInputChanged(a.bq.Mouse,0,K)}}if(this.isDeviceAvailable(a.bq.Touch)){const t=this._inputs[a.bq.Touch];for(let K=0;K<this._activeTouchIds.length;K++){const x=this._activeTouchIds[K];if((null===(G=(D=this._elementToAttachTo).hasPointerCapture)||void 0===G?void 0:G.call(D,x))&&this._elementToAttachTo.releasePointerCapture(x),-1!==x&&1===(null===(N=t[K])||void 0===N?void 0:N[a.ST.LeftClick])){t[K][a.ST.LeftClick]=0;const D=W.CreateDeviceEvent(a.bq.Touch,K,a.ST.LeftClick,0,this,this._elementToAttachTo,x);this._onInputChanged(a.bq.Touch,K,D),this._activeTouchIds[K]=-1,this._onDeviceDisconnected(a.bq.Touch,K)}}}},this._pointerWheelEvent=t=>{const K=a.bq.Mouse,D=0;this._inputs[K]||(this._inputs[K]=[]),this._inputs[K][D]||(this._pointerActive=!0,this._registerDevice(K,D,i));const G=this._inputs[K][D];if(G){G[a.ST.MouseWheelX]=t.deltaX||0,G[a.ST.MouseWheelY]=t.deltaY||t.wheelDelta||0,G[a.ST.MouseWheelZ]=t.deltaZ||0;const N=t;void 0===t.pointerId&&(t.pointerId=this._mouseId),0!==G[a.ST.MouseWheelX]&&(N.inputIndex=a.ST.MouseWheelX,this._onInputChanged(K,D,N)),0!==G[a.ST.MouseWheelY]&&(N.inputIndex=a.ST.MouseWheelY,this._onInputChanged(K,D,N)),0!==G[a.ST.MouseWheelZ]&&(N.inputIndex=a.ST.MouseWheelZ,this._onInputChanged(K,D,N))}},this._usingMacOS&&this._isUsingChromium&&(this._pointerMacOSChromeOutEvent=t=>{t.buttons>1&&this._pointerCancelEvent(t)},this._elementToAttachTo.addEventListener("lostpointercapture",this._pointerMacOSChromeOutEvent)),this._elementToAttachTo.addEventListener(this._eventPrefix+"move",this._pointerMoveEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+"down",this._pointerDownEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+"up",this._pointerUpEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+"cancel",this._pointerCancelEvent),this._elementToAttachTo.addEventListener("blur",this._pointerBlurEvent),this._elementToAttachTo.addEventListener(this._wheelEventName,this._pointerWheelEvent,!!t&&{passive:!1}),this._pointerInputClearObserver=this._engine.onEndFrameObservable.add((()=>{if(this.isDeviceAvailable(a.bq.Mouse)){const t=this._inputs[a.bq.Mouse][0];t[a.ST.MouseWheelX]=0,t[a.ST.MouseWheelY]=0,t[a.ST.MouseWheelZ]=0}}))}_handleGamepadActions(){this._gamepadConnectedEvent=t=>{this._addGamePad(t.gamepad)},this._gamepadDisconnectedEvent=t=>{if(this._gamepads){const K=this._getGamepadDeviceType(t.gamepad.id),D=t.gamepad.index;this._unregisterDevice(K,D),delete this._gamepads[D]}},window.addEventListener("gamepadconnected",this._gamepadConnectedEvent),window.addEventListener("gamepaddisconnected",this._gamepadDisconnectedEvent)}_updateDevice(t,K,D){const a=navigator.getGamepads()[K];if(a&&t===this._gamepads[K]){const G=this._inputs[t][K];D>=a.buttons.length?G[D]=a.axes[D-a.buttons.length].valueOf():G[D]=a.buttons[D].value}}_getGamepadDeviceType(t){return-1!==t.indexOf("054c")?-1!==t.indexOf("0ce6")?a.bq.DualSense:a.bq.DualShock:-1!==t.indexOf("Xbox One")||-1!==t.search("Xbox 360")||-1!==t.search("xinput")?a.bq.Xbox:-1!==t.indexOf("057e")?a.bq.Switch:a.bq.Generic}_getPointerType(t){let K=a.bq.Mouse;return("touch"===t.pointerType||"pen"===t.pointerType||t.touches)&&(K=a.bq.Touch),K}}var I=D(154711);class Z{constructor(t){this._registeredManagers=new Array,this._refCount=0,this.registerManager=t=>{for(let K=0;K<this._devices.length;K++){const D=this._devices[K];for(const a in D){const D=+a;t._addDevice(new I.c(this._deviceInputSystem,K,D))}}this._registeredManagers.push(t)},this.unregisterManager=t=>{const K=this._registeredManagers.indexOf(t);K>-1&&this._registeredManagers.splice(K,1)};const K=Object.keys(a.bq).length/2;this._devices=new Array(K);const D=(t,K)=>{this._devices[t]||(this._devices[t]=new Array),this._devices[t][K]||(this._devices[t][K]=K);for(const D of this._registeredManagers){const a=new I.c(this._deviceInputSystem,t,K);D._addDevice(a)}},G=(t,K)=>{var D;(null===(D=this._devices[t])||void 0===D?void 0:D[K])&&delete this._devices[t][K];for(const D of this._registeredManagers)D._removeDevice(t,K)},N=(t,K,D)=>{if(D)for(const a of this._registeredManagers)a._onInputChanged(t,K,D)};"undefined"!=typeof _native?this._deviceInputSystem=new x(D,G,N):this._deviceInputSystem=new z(t,D,G,N)}dispose(){this._deviceInputSystem.dispose()}}class w{getDeviceSource(t,K){if(void 0===K){if(void 0===this._firstDevice[t])return null;K=this._firstDevice[t]}return this._devices[t]&&void 0!==this._devices[t][K]?this._devices[t][K]:null}getDeviceSources(t){return this._devices[t]?this._devices[t].filter((t=>!!t)):[]}constructor(t){const K=Object.keys(a.bq).length/2;this._devices=new Array(K),this._firstDevice=new Array(K),this._engine=t,this._engine._deviceSourceManager||(this._engine._deviceSourceManager=new Z(t)),this._engine._deviceSourceManager._refCount++,this.onDeviceConnectedObservable=new G.cP((t=>{for(const K of this._devices)if(K)for(const D of K)D&&this.onDeviceConnectedObservable.notifyObserver(t,D)})),this.onDeviceDisconnectedObservable=new G.cP,this._engine._deviceSourceManager.registerManager(this),this._onDisposeObserver=t.onDisposeObservable.add((()=>{this.dispose()}))}dispose(){this.onDeviceConnectedObservable.clear(),this.onDeviceDisconnectedObservable.clear(),this._engine._deviceSourceManager&&(this._engine._deviceSourceManager.unregisterManager(this),--this._engine._deviceSourceManager._refCount<1&&(this._engine._deviceSourceManager.dispose(),delete this._engine._deviceSourceManager)),this._engine.onDisposeObservable.remove(this._onDisposeObserver)}_addDevice(t){this._devices[t.deviceType]||(this._devices[t.deviceType]=new Array),this._devices[t.deviceType][t.deviceSlot]||(this._devices[t.deviceType][t.deviceSlot]=t,this._updateFirstDevices(t.deviceType)),this.onDeviceConnectedObservable.notifyObservers(t)}_removeDevice(t,K){var D,a;const G=null===(D=this._devices[t])||void 0===D?void 0:D[K];this.onDeviceDisconnectedObservable.notifyObservers(G),(null===(a=this._devices[t])||void 0===a?void 0:a[K])&&delete this._devices[t][K],this._updateFirstDevices(t)}_onInputChanged(t,K,D){var a,G;null===(G=null===(a=this._devices[t])||void 0===a?void 0:a[K])||void 0===G||G.onInputChangedObservable.notifyObservers(D)}_updateFirstDevices(t){switch(t){case a.bq.Keyboard:case a.bq.Mouse:this._firstDevice[t]=0;break;case a.bq.Touch:case a.bq.DualSense:case a.bq.DualShock:case a.bq.Xbox:case a.bq.Switch:case a.bq.Generic:{delete this._firstDevice[t];const K=this._devices[t];if(K)for(let D=0;D<K.length;D++)if(K[D]){this._firstDevice[t]=D;break}break}}}}},724982:(t,K,D)=>{D(33321).$.prototype.setAlphaEquation=function(t){if(this._alphaEquation!==t){switch(t){case 0:this._alphaState.setAlphaEquationParameters(32774,32774);break;case 1:this._alphaState.setAlphaEquationParameters(32778,32778);break;case 2:this._alphaState.setAlphaEquationParameters(32779,32779);break;case 3:this._alphaState.setAlphaEquationParameters(32776,32776);break;case 4:this._alphaState.setAlphaEquationParameters(32775,32775);break;case 5:this._alphaState.setAlphaEquationParameters(32775,32774)}this._alphaEquation=t}}},757634:(t,K,D)=>{var a=D(182453),G=D(706400),N=D(435683),W=D(977041),x=D(33321),b=D(892643);x.$.prototype._partialLoadFile=function(t,K,D,a,G=null){this._loadFile(t,(t=>{D[K]=t,D._internalCount++,6===D._internalCount&&a(D)}),void 0,void 0,!0,((t,K)=>{G&&t&&G(t.status+" "+t.statusText,K)}))},x.$.prototype._cascadeLoadFiles=function(t,K,D,a=null){const G=[];G._internalCount=0;for(let t=0;t<6;t++)this._partialLoadFile(D[t],t,G,K,a)},x.$.prototype._cascadeLoadImgs=function(t,K,D,a,G=null,N){const W=[];W._internalCount=0;for(let x=0;x<6;x++)this._partialLoadImg(a[x],x,W,t,K,D,G,N)},x.$.prototype._partialLoadImg=function(t,K,D,a,G,x,b=null,n){const e=W.z();N.W$(t,(t=>{D[K]=t,D._internalCount++,a&&a.removePendingData(e),6===D._internalCount&&x&&x(G,D)}),((t,K)=>{a&&a.removePendingData(e),b&&b(t,K)}),a?a.offlineProvider:null,n),a&&a.addPendingData(e)},x.$.prototype.createCubeTextureBase=function(t,K,D,N,W=null,x=null,n,e=null,i=!1,z=0,I=0,Z=null,w=null,m=null,u=!1,d=null){const E=Z||new a.h(this,7);E.isCube=!0,E.url=t,E.generateMipMaps=!N,E._lodGenerationScale=z,E._lodGenerationOffset=I,E._useSRGBBuffer=!!u&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!N),E!==Z&&(E.label=t.substring(0,60)),this._doNotHandleContextLost||(E._extension=e,E._files=D,E._buffer=d);const l=t;this._transformTextureUrl&&!Z&&(t=this._transformTextureUrl(t));const Q=t.split("?")[0],P=Q.lastIndexOf("."),y=e||(P>-1?Q.substring(P).toLowerCase():""),q=b.g(y),X=(a,b)=>{t===l?x&&a&&x(a.status+" "+a.statusText,b):(G.V.Warn(`Failed to load ${t}, falling back to the ${l}`),this.createCubeTextureBase(l,K,D,!!N,W,x,n,e,i,z,I,E,w,m,u,d))};if(q)q.then((a=>{const N=t=>{w&&w(E,t),a.loadCubeData(t,E,i,W,x)};d?N(d):D&&6===D.length?a.supportCascades?this._cascadeLoadFiles(K,(t=>N(t.map((t=>new Uint8Array(t))))),D,x):x?x("Textures type does not support cascades."):G.V.Warn("Texture loader does not support cascades."):this._loadFile(t,(t=>N(new Uint8Array(t))),void 0,void 0,!0,X)}));else{if(!D||0===D.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(K,E,((t,K)=>{m&&m(t,K)}),D,x)}return this._internalTexturesCache.push(E),E}},779010:(t,K,D)=>{var a=D(33321);a.$.prototype.getInputElement=function(){return this._renderingCanvas},a.$.prototype.getRenderingCanvasClientRect=function(){return this._renderingCanvas?this._renderingCanvas.getBoundingClientRect():null},a.$.prototype.getInputElementClientRect=function(){return this._renderingCanvas?this.getInputElement().getBoundingClientRect():null},a.$.prototype.getAspectRatio=function(t,K=!1){const D=t.viewport;return this.getRenderWidth(K)*D.width/(this.getRenderHeight(K)*D.height)},a.$.prototype.getScreenAspectRatio=function(){return this.getRenderWidth(!0)/this.getRenderHeight(!0)},a.$.prototype._verifyPointerLock=function(){var t;null===(t=this._onPointerLockChange)||void 0===t||t.call(this)}},129970:(t,K,D)=>{var a=D(394501),G=D(33321);G.$.prototype.displayLoadingUI=function(){if(!a.BA())return;const t=this.loadingScreen;t&&t.displayLoadingUI()},G.$.prototype.hideLoadingUI=function(){if(!a.BA())return;const t=this._loadingScreen;t&&t.hideLoadingUI()},Object.defineProperty(G.$.prototype,"loadingScreen",{get:function(){return!this._loadingScreen&&this._renderingCanvas&&(this._loadingScreen=G.$.DefaultLoadingScreenFactory(this._renderingCanvas)),this._loadingScreen},set:function(t){this._loadingScreen=t},enumerable:!0,configurable:!0}),Object.defineProperty(G.$.prototype,"loadingUIText",{set:function(t){this.loadingScreen.loadingUIText=t},enumerable:!0,configurable:!0}),Object.defineProperty(G.$.prototype,"loadingUIBackgroundColor",{set:function(t){this.loadingScreen.loadingUIBackgroundColor=t},enumerable:!0,configurable:!0})},299741:(t,K,D)=>{var a=D(33321);a.$.prototype.getRenderPassNames=function(){return this._renderPassNames},a.$.prototype.getCurrentRenderPassName=function(){return this._renderPassNames[this.currentRenderPassId]},a.$.prototype.createRenderPassId=function(t){const K=++a.$._RenderPassIdCounter;return this._renderPassNames[K]=null!=t?t:"NONAME",K},a.$.prototype.releaseRenderPassId=function(t){this._renderPassNames[t]=void 0;for(let K=0;K<this.scenes.length;++K){const D=this.scenes[K];for(let K=0;K<D.meshes.length;++K){const a=D.meshes[K];if(a.subMeshes)for(let K=0;K<a.subMeshes.length;++K)a.subMeshes[K]._removeDrawWrapper(t)}}}},649646:(t,K,D)=>{var a=D(33321);D(724982),a.$.prototype.getInputElement=function(){return this._renderingCanvas},a.$.prototype.getDepthFunction=function(){return this._depthCullingState.depthFunc},a.$.prototype.setDepthFunction=function(t){this._depthCullingState.depthFunc=t},a.$.prototype.setDepthFunctionToGreater=function(){this.setDepthFunction(516)},a.$.prototype.setDepthFunctionToGreaterOrEqual=function(){this.setDepthFunction(518)},a.$.prototype.setDepthFunctionToLess=function(){this.setDepthFunction(513)},a.$.prototype.setDepthFunctionToLessOrEqual=function(){this.setDepthFunction(515)},a.$.prototype.getDepthWrite=function(){return this._depthCullingState.depthMask},a.$.prototype.setDepthWrite=function(t){this._depthCullingState.depthMask=t},a.$.prototype.getStencilBuffer=function(){return this._stencilState.stencilTest},a.$.prototype.setStencilBuffer=function(t){this._stencilState.stencilTest=t},a.$.prototype.getStencilMask=function(){return this._stencilState.stencilMask},a.$.prototype.setStencilMask=function(t){this._stencilState.stencilMask=t},a.$.prototype.getStencilFunction=function(){return this._stencilState.stencilFunc},a.$.prototype.getStencilFunctionReference=function(){return this._stencilState.stencilFuncRef},a.$.prototype.getStencilFunctionMask=function(){return this._stencilState.stencilFuncMask},a.$.prototype.setStencilFunction=function(t){this._stencilState.stencilFunc=t},a.$.prototype.setStencilFunctionReference=function(t){this._stencilState.stencilFuncRef=t},a.$.prototype.setStencilFunctionMask=function(t){this._stencilState.stencilFuncMask=t},a.$.prototype.getStencilOperationFail=function(){return this._stencilState.stencilOpStencilFail},a.$.prototype.getStencilOperationDepthFail=function(){return this._stencilState.stencilOpDepthFail},a.$.prototype.getStencilOperationPass=function(){return this._stencilState.stencilOpStencilDepthPass},a.$.prototype.setStencilOperationFail=function(t){this._stencilState.stencilOpStencilFail=t},a.$.prototype.setStencilOperationDepthFail=function(t){this._stencilState.stencilOpDepthFail=t},a.$.prototype.setStencilOperationPass=function(t){this._stencilState.stencilOpStencilDepthPass=t},a.$.prototype.cacheStencilState=function(){this._cachedStencilBuffer=this.getStencilBuffer(),this._cachedStencilFunction=this.getStencilFunction(),this._cachedStencilMask=this.getStencilMask(),this._cachedStencilOperationPass=this.getStencilOperationPass(),this._cachedStencilOperationFail=this.getStencilOperationFail(),this._cachedStencilOperationDepthFail=this.getStencilOperationDepthFail(),this._cachedStencilReference=this.getStencilFunctionReference()},a.$.prototype.restoreStencilState=function(){this.setStencilFunction(this._cachedStencilFunction),this.setStencilMask(this._cachedStencilMask),this.setStencilBuffer(this._cachedStencilBuffer),this.setStencilOperationPass(this._cachedStencilOperationPass),this.setStencilOperationFail(this._cachedStencilOperationFail),this.setStencilOperationDepthFail(this._cachedStencilOperationDepthFail),this.setStencilFunctionReference(this._cachedStencilReference)},a.$.prototype.setAlphaConstants=function(t,K,D,a){this._alphaState.setAlphaBlendConstants(t,K,D,a)},a.$.prototype.getAlphaMode=function(){return this._alphaMode},a.$.prototype.getAlphaEquation=function(){return this._alphaEquation}},834405:(t,K,D)=>{D(33321).$.prototype.createDepthStencilTexture=function(t,K,D){if(K.isCube){const D=t.width||t;return this._createDepthStencilCubeTexture(D,K)}return this._createDepthStencilTexture(t,K,D)}},889630:(t,K,D)=>{D(499251).w.prototype.setAlphaMode=function(t,K=!1){if(this._alphaMode!==t){switch(t){case 0:this._alphaState.alphaBlend=!1;break;case 7:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 8:case 14:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 2:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 6:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 1:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 3:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ZERO,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 4:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_COLOR,this._gl.ZERO,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 5:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 9:this._alphaState.setAlphaBlendFunctionParameters(this._gl.CONSTANT_COLOR,this._gl.ONE_MINUS_CONSTANT_COLOR,this._gl.CONSTANT_ALPHA,this._gl.ONE_MINUS_CONSTANT_ALPHA),this._alphaState.alphaBlend=!0;break;case 10:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 11:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 12:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 13:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE_MINUS_DST_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 15:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 16:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 17:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0}K||(this.depthCullingState.depthMask=0===t),this._alphaMode=t}else if(!K){const K=0===t;this.depthCullingState.depthMask!==K&&(this.depthCullingState.depthMask=K)}}},109050:(t,K,D)=>{var a=D(499251),G=D(182453),N=D(706400),W=D(104270);a.w.prototype._createDepthStencilCubeTexture=function(t,K){const D=new G.h(this,12);if(D.isCube=!0,1===this.webGLVersion)return N.V.Error("Depth cube texture is not supported by WebGL 1."),D;const a={bilinearFiltering:!1,comparisonFunction:0,generateStencil:!1,...K},W=this._gl;this._bindTextureDirectly(W.TEXTURE_CUBE_MAP,D,!0),this._setupDepthStencilTexture(D,t,a.bilinearFiltering,a.comparisonFunction);for(let K=0;K<6;K++)a.generateStencil?W.texImage2D(W.TEXTURE_CUBE_MAP_POSITIVE_X+K,0,W.DEPTH24_STENCIL8,t,t,0,W.DEPTH_STENCIL,W.UNSIGNED_INT_24_8,null):W.texImage2D(W.TEXTURE_CUBE_MAP_POSITIVE_X+K,0,W.DEPTH_COMPONENT24,t,t,0,W.DEPTH_COMPONENT,W.UNSIGNED_INT,null);return this._bindTextureDirectly(W.TEXTURE_CUBE_MAP,null),this._internalTexturesCache.push(D),D},a.w.prototype._setCubeMapTextureParams=function(t,K,D){const a=this._gl;a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,K?a.LINEAR_MIPMAP_LINEAR:a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),t.samplingMode=K?3:2,K&&this.getCaps().textureMaxLevel&&void 0!==D&&D>0&&(a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAX_LEVEL,D),t._maxLodLevel=D),this._bindTextureDirectly(a.TEXTURE_CUBE_MAP,null)},a.w.prototype.createCubeTexture=function(t,K,D,a,G=null,x=null,b,n=null,e=!1,i=0,z=0,I=null,Z,w=!1,m=null){const u=this._gl;return this.createCubeTextureBase(t,K,D,!!a,G,x,b,n,e,i,z,I,(t=>this._bindTextureDirectly(u.TEXTURE_CUBE_MAP,t,!0)),((t,K)=>{const D=this.needPOTTextures?W.R(K[0].width,this._caps.maxCubemapTextureSize):K[0].width,x=D,n=[u.TEXTURE_CUBE_MAP_POSITIVE_X,u.TEXTURE_CUBE_MAP_POSITIVE_Y,u.TEXTURE_CUBE_MAP_POSITIVE_Z,u.TEXTURE_CUBE_MAP_NEGATIVE_X,u.TEXTURE_CUBE_MAP_NEGATIVE_Y,u.TEXTURE_CUBE_MAP_NEGATIVE_Z];this._bindTextureDirectly(u.TEXTURE_CUBE_MAP,t,!0),this._unpackFlipY(!1);const e=b?this._getInternalFormat(b,t._useSRGBBuffer):t._useSRGBBuffer?this._glSRGBExtensionValues.SRGB8_ALPHA8:u.RGBA;let i=b?this._getInternalFormat(b):u.RGBA;t._useSRGBBuffer&&1===this.webGLVersion&&(i=e);for(let t=0;t<n.length;t++)if(K[t].width!==D||K[t].height!==x){if(this._prepareWorkingCanvas(),!this._workingCanvas||!this._workingContext)return void N.V.Warn("Cannot create canvas to resize texture.");this._workingCanvas.width=D,this._workingCanvas.height=x,this._workingContext.drawImage(K[t],0,0,K[t].width,K[t].height,0,0,D,x),u.texImage2D(n[t],0,e,i,u.UNSIGNED_BYTE,this._workingCanvas)}else u.texImage2D(n[t],0,e,i,u.UNSIGNED_BYTE,K[t]);a||u.generateMipmap(u.TEXTURE_CUBE_MAP),this._setCubeMapTextureParams(t,!a),t.width=D,t.height=x,t.isReady=!0,b&&(t.format=b),t.onLoadedObservable.notifyObservers(t),t.onLoadedObservable.clear(),G&&G()}),!!w,m)},a.w.prototype.generateMipMapsForCubemap=function(t,K=!0){if(t.generateMipMaps){const D=this._gl;this._bindTextureDirectly(D.TEXTURE_CUBE_MAP,t,!0),D.generateMipmap(D.TEXTURE_CUBE_MAP),K&&this._bindTextureDirectly(D.TEXTURE_CUBE_MAP,null)}}},80157:(t,K,D)=>{var a=D(499251);a.w.prototype.updateDynamicIndexBuffer=function(t,K,D=0){let a;this._currentBoundBuffer[this._gl.ELEMENT_ARRAY_BUFFER]=null,this.bindIndexBuffer(t),a=t.is32Bits?K instanceof Uint32Array?K:new Uint32Array(K):K instanceof Uint16Array?K:new Uint16Array(K),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,a,this._gl.DYNAMIC_DRAW),this._resetIndexBufferBinding()},a.w.prototype.updateDynamicVertexBuffer=function(t,K,D,a){this.bindArrayBuffer(t),void 0===D&&(D=0);const G=K.byteLength||K.length;void 0===a||a>=G&&0===D?K instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,D,new Float32Array(K)):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,D,K):K instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,new Float32Array(K).subarray(D,D+a)):(K=K instanceof ArrayBuffer?new Uint8Array(K,D,a):new Uint8Array(K.buffer,K.byteOffset+D,a),this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,K)),this._resetVertexBufferBinding()}},269673:(t,K,D)=>{var a=D(499251);a.w.prototype._readTexturePixelsSync=function(t,K,D,a=-1,G=0,N=null,W=!0,x=!1,b=0,n=0){var e,i;const z=this._gl;if(!z)throw new Error("Engine does not have gl rendering context.");if(!this._dummyFramebuffer){const t=z.createFramebuffer();if(!t)throw new Error("Unable to create dummy framebuffer");this._dummyFramebuffer=t}z.bindFramebuffer(z.FRAMEBUFFER,this._dummyFramebuffer),a>-1?z.framebufferTexture2D(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,z.TEXTURE_CUBE_MAP_POSITIVE_X+a,null===(e=t._hardwareTexture)||void 0===e?void 0:e.underlyingResource,G):z.framebufferTexture2D(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,z.TEXTURE_2D,null===(i=t._hardwareTexture)||void 0===i?void 0:i.underlyingResource,G);let I=void 0!==t.type?this._getWebGLTextureType(t.type):z.UNSIGNED_BYTE;return x?N||(N=function(t,K,D=!1,a){switch(t){case 3:{const t=(ArrayBuffer,new Int8Array(K));return a&&t.set(new Int8Array(a)),t}case 0:{const t=(ArrayBuffer,new Uint8Array(K));return a&&t.set(new Uint8Array(a)),t}case 4:{const t=K instanceof ArrayBuffer?new Int16Array(K):new Int16Array(D?K/2:K);return a&&t.set(new Int16Array(a)),t}case 5:case 8:case 9:case 10:case 2:{const t=K instanceof ArrayBuffer?new Uint16Array(K):new Uint16Array(D?K/2:K);return a&&t.set(new Uint16Array(a)),t}case 6:{const t=K instanceof ArrayBuffer?new Int32Array(K):new Int32Array(D?K/4:K);return a&&t.set(new Int32Array(a)),t}case 7:case 11:case 12:case 13:case 14:case 15:{const t=K instanceof ArrayBuffer?new Uint32Array(K):new Uint32Array(D?K/4:K);return a&&t.set(new Uint32Array(a)),t}case 1:{const t=K instanceof ArrayBuffer?new Float32Array(K):new Float32Array(D?K/4:K);return a&&t.set(new Float32Array(a)),t}}const G=(ArrayBuffer,new Uint8Array(K));return a&&G.set(new Uint8Array(a)),G}(t.type,4*K*D)):I===z.UNSIGNED_BYTE?(N||(N=new Uint8Array(4*K*D)),I=z.UNSIGNED_BYTE):(N||(N=new Float32Array(4*K*D)),I=z.FLOAT),W&&this.flushFramebuffer(),z.readPixels(b,n,K,D,z.RGBA,I,N),z.bindFramebuffer(z.FRAMEBUFFER,this._currentFramebuffer),N},a.w.prototype._readTexturePixels=function(t,K,D,a=-1,G=0,N=null,W=!0,x=!1,b=0,n=0){return Promise.resolve(this._readTexturePixelsSync(t,K,D,a,G,N,W,x,b,n))}},68561:(t,K,D)=>{var a=D(182453),G=D(706400),N=D(499251),W=D(380245);class x extends W.v{constructor(t,K,D,a,G){super(t,K,D,a),this._framebuffer=null,this._depthStencilBuffer=null,this._MSAAFramebuffer=null,this._colorTextureArray=null,this._depthStencilTextureArray=null,this._disposeOnlyFramebuffers=!1,this._currentLOD=0,this._context=G}_cloneRenderTargetWrapper(){let t=null;return this._colorTextureArray&&this._depthStencilTextureArray?(t=this._engine.createMultiviewRenderTargetTexture(this.width,this.height),t.texture.isReady=!0):t=super._cloneRenderTargetWrapper(),t}_swapRenderTargetWrapper(t){super._swapRenderTargetWrapper(t),t._framebuffer=this._framebuffer,t._depthStencilBuffer=this._depthStencilBuffer,t._MSAAFramebuffer=this._MSAAFramebuffer,t._colorTextureArray=this._colorTextureArray,t._depthStencilTextureArray=this._depthStencilTextureArray,this._framebuffer=this._depthStencilBuffer=this._MSAAFramebuffer=this._colorTextureArray=this._depthStencilTextureArray=null}createDepthStencilTexture(t=0,K=!0,D=!1,a=1,G=14,N){if(this._depthStencilBuffer){const t=this._engine,K=t._currentFramebuffer,D=this._context;t._bindUnboundFramebuffer(this._framebuffer),D.framebufferRenderbuffer(D.FRAMEBUFFER,D.DEPTH_STENCIL_ATTACHMENT,D.RENDERBUFFER,null),D.framebufferRenderbuffer(D.FRAMEBUFFER,D.DEPTH_ATTACHMENT,D.RENDERBUFFER,null),D.framebufferRenderbuffer(D.FRAMEBUFFER,D.STENCIL_ATTACHMENT,D.RENDERBUFFER,null),t._bindUnboundFramebuffer(K),D.deleteRenderbuffer(this._depthStencilBuffer),this._depthStencilBuffer=null}return super.createDepthStencilTexture(t,K,D,a,G,N)}shareDepth(t){super.shareDepth(t);const K=this._context,D=this._depthStencilBuffer,a=t._MSAAFramebuffer||t._framebuffer,G=this._engine;t._depthStencilBuffer&&t._depthStencilBuffer!==D&&K.deleteRenderbuffer(t._depthStencilBuffer),t._depthStencilBuffer=D;const N=t._generateStencilBuffer?K.DEPTH_STENCIL_ATTACHMENT:K.DEPTH_ATTACHMENT;G._bindUnboundFramebuffer(a),K.framebufferRenderbuffer(K.FRAMEBUFFER,N,K.RENDERBUFFER,D),G._bindUnboundFramebuffer(null)}_bindTextureRenderTarget(t,K=0,D,a=0){var G,N,W,x;if(!t._hardwareTexture)return;const b=this._framebuffer,n=this._engine,e=n._currentFramebuffer;if(n._bindUnboundFramebuffer(b),n.webGLVersion>1){const b=this._context,n=b["COLOR_ATTACHMENT"+K];t.is2DArray||t.is3D?(D=null!==(N=null!=D?D:null===(G=this.layerIndices)||void 0===G?void 0:G[K])&&void 0!==N?N:0,b.framebufferTextureLayer(b.FRAMEBUFFER,n,t._hardwareTexture.underlyingResource,a,D)):t.isCube?(D=null!==(x=null!=D?D:null===(W=this.faceIndices)||void 0===W?void 0:W[K])&&void 0!==x?x:0,b.framebufferTexture2D(b.FRAMEBUFFER,n,b.TEXTURE_CUBE_MAP_POSITIVE_X+D,t._hardwareTexture.underlyingResource,a)):b.framebufferTexture2D(b.FRAMEBUFFER,n,b.TEXTURE_2D,t._hardwareTexture.underlyingResource,a)}else{const G=this._context,N=G["COLOR_ATTACHMENT"+K+"_WEBGL"],W=void 0!==D?G.TEXTURE_CUBE_MAP_POSITIVE_X+D:G.TEXTURE_2D;G.framebufferTexture2D(G.FRAMEBUFFER,N,W,t._hardwareTexture.underlyingResource,a)}n._bindUnboundFramebuffer(e)}setTexture(t,K=0,D=!0){super.setTexture(t,K,D),this._bindTextureRenderTarget(t,K)}setLayerAndFaceIndices(t,K){var D,a;if(super.setLayerAndFaceIndices(t,K),!this.textures||!this.layerIndices||!this.faceIndices)return;const G=null!==(a=null===(D=this._attachments)||void 0===D?void 0:D.length)&&void 0!==a?a:this.textures.length;for(let t=0;t<G;t++){const K=this.textures[t];K&&(K.is2DArray||K.is3D?this._bindTextureRenderTarget(K,t,this.layerIndices[t]):K.isCube?this._bindTextureRenderTarget(K,t,this.faceIndices[t]):this._bindTextureRenderTarget(K,t))}}setLayerAndFaceIndex(t=0,K,D){if(super.setLayerAndFaceIndex(t,K,D),!this.textures||!this.layerIndices||!this.faceIndices)return;const a=this.textures[t];a.is2DArray||a.is3D?this._bindTextureRenderTarget(this.textures[t],t,this.layerIndices[t]):a.isCube&&this._bindTextureRenderTarget(this.textures[t],t,this.faceIndices[t])}dispose(t=this._disposeOnlyFramebuffers){const K=this._context;t||(this._colorTextureArray&&(this._context.deleteTexture(this._colorTextureArray),this._colorTextureArray=null),this._depthStencilTextureArray&&(this._context.deleteTexture(this._depthStencilTextureArray),this._depthStencilTextureArray=null)),this._framebuffer&&(K.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._depthStencilBuffer&&(K.deleteRenderbuffer(this._depthStencilBuffer),this._depthStencilBuffer=null),this._MSAAFramebuffer&&(K.deleteFramebuffer(this._MSAAFramebuffer),this._MSAAFramebuffer=null),super.dispose(t)}}D(834405),N.w.prototype._createHardwareRenderTargetWrapper=function(t,K,D){const a=new x(t,K,D,this,this._gl);return this._renderTargetWrapperCache.push(a),a},N.w.prototype.createRenderTargetTexture=function(t,K){var D,a;const G=this._createHardwareRenderTargetWrapper(!1,!1,t);let N,W,x=!0,b=!1,n=!1,e=1;void 0!==K&&"object"==typeof K&&(x=null===(D=K.generateDepthBuffer)||void 0===D||D,b=!!K.generateStencilBuffer,n=!!K.noColorAttachment,N=K.colorAttachment,e=null!==(a=K.samples)&&void 0!==a?a:1,W=K.label);const i=N||(n?null:this._createInternalTexture(t,K,!0,5)),z=t.width||t,I=t.height||t,Z=this._currentFramebuffer,w=this._gl,m=w.createFramebuffer();return this._bindUnboundFramebuffer(m),G._depthStencilBuffer=this._setupFramebufferDepthAttachments(b,x,z,I),!i||i.is2DArray||i.is3D||w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_2D,i._hardwareTexture.underlyingResource,0),this._bindUnboundFramebuffer(Z),G.label=null!=W?W:"RenderTargetWrapper",G._framebuffer=m,G._generateDepthBuffer=x,G._generateStencilBuffer=b,G.setTextures(i),this.updateRenderTargetTextureSampleCount(G,e),G},N.w.prototype._createDepthStencilTexture=function(t,K,D){var N;const W=this._gl,x=t.layers||0,b=t.depth||0;let n=W.TEXTURE_2D;0!==x?n=W.TEXTURE_2D_ARRAY:0!==b&&(n=W.TEXTURE_3D);const e=new a.h(this,12);if(e.label=K.label,!this._caps.depthTextureExtension)return G.V.Error("Depth texture is not supported by your browser or hardware."),e;const i={bilinearFiltering:!1,comparisonFunction:0,generateStencil:!1,...K};if(this._bindTextureDirectly(n,e,!0),this._setupDepthStencilTexture(e,t,0!==i.comparisonFunction&&i.bilinearFiltering,i.comparisonFunction,i.samples),void 0!==i.depthTextureFormat){if(15!==i.depthTextureFormat&&16!==i.depthTextureFormat&&17!==i.depthTextureFormat&&13!==i.depthTextureFormat&&14!==i.depthTextureFormat&&18!==i.depthTextureFormat)return G.V.Error(`Depth texture ${i.depthTextureFormat} format is not supported.`),e;e.format=i.depthTextureFormat}else e.format=i.generateStencil?13:16;const z=17===e.format||13===e.format||18===e.format;let I=W.UNSIGNED_INT;15===e.format?I=W.UNSIGNED_SHORT:17===e.format||13===e.format?I=W.UNSIGNED_INT_24_8:14===e.format?I=W.FLOAT:18===e.format&&(I=W.FLOAT_32_UNSIGNED_INT_24_8_REV);const Z=z?W.DEPTH_STENCIL:W.DEPTH_COMPONENT,w=this._getInternalFormatFromDepthTextureFormat(e.format,!0,z);return e.is2DArray?W.texImage3D(n,0,w,e.width,e.height,x,0,Z,I,null):e.is3D?W.texImage3D(n,0,w,e.width,e.height,b,0,Z,I,null):W.texImage2D(n,0,w,e.width,e.height,0,Z,I,null),this._bindTextureDirectly(n,null),this._internalTexturesCache.push(e),D._depthStencilBuffer&&(W.deleteRenderbuffer(D._depthStencilBuffer),D._depthStencilBuffer=null),this._bindUnboundFramebuffer(null!==(N=D._MSAAFramebuffer)&&void 0!==N?N:D._framebuffer),D._generateStencilBuffer=z,D._depthStencilTextureWithStencil=z,D._depthStencilBuffer=this._setupFramebufferDepthAttachments(D._generateStencilBuffer,D._generateDepthBuffer,D.width,D.height,D.samples,e.format),this._bindUnboundFramebuffer(null),e},N.w.prototype.updateRenderTargetTextureSampleCount=function(t,K){var D,a;if(this.webGLVersion<2||!t)return 1;if(t.samples===K)return K;const G=this._gl;K=Math.min(K,this.getCaps().maxMSAASamples),t._depthStencilBuffer&&(G.deleteRenderbuffer(t._depthStencilBuffer),t._depthStencilBuffer=null),t._MSAAFramebuffer&&(G.deleteFramebuffer(t._MSAAFramebuffer),t._MSAAFramebuffer=null);const N=null===(D=t.texture)||void 0===D?void 0:D._hardwareTexture;null==N||N.releaseMSAARenderBuffers();const W=G.createFramebuffer();if(!W)throw new Error("Unable to create multi sampled framebuffer");if(t._MSAAFramebuffer=W,t.texture&&K>1&&"function"==typeof G.renderbufferStorageMultisample){this._bindUnboundFramebuffer(t._MSAAFramebuffer);const D=this._createRenderBuffer(t.texture.width,t.texture.height,K,-1,this._getRGBABufferInternalSizedFormat(t.texture.type,t.texture.format,t.texture._useSRGBBuffer),G.COLOR_ATTACHMENT0,!1);if(!D)throw new Error("Unable to create multi sampled framebuffer");null==N||N.addMSAARenderBuffer(D)}this._bindUnboundFramebuffer(null!==(a=t._MSAAFramebuffer)&&void 0!==a?a:t._framebuffer),t.texture&&(t.texture.samples=K),t._samples=K;const x=t._depthStencilTexture?t._depthStencilTexture.format:void 0;return t._depthStencilBuffer=this._setupFramebufferDepthAttachments(t._generateStencilBuffer,t._generateDepthBuffer,t.width,t.height,K,x),this._bindUnboundFramebuffer(null),K},N.w.prototype._setupDepthStencilTexture=function(t,K,D,a,G=1){const N=K.width||K,W=K.height||K,x=K.layers||0,b=K.depth||0;t.baseWidth=N,t.baseHeight=W,t.width=N,t.height=W,t.is2DArray=x>0,t.depth=x||b,t.isReady=!0,t.samples=G,t.generateMipMaps=!1,t.samplingMode=D?2:1,t.type=0,t._comparisonFunction=a;const n=this._gl,e=this._getTextureTarget(t),i=this._getSamplingParameters(t.samplingMode,!1);n.texParameteri(e,n.TEXTURE_MAG_FILTER,i.mag),n.texParameteri(e,n.TEXTURE_MIN_FILTER,i.min),n.texParameteri(e,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(e,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),this.webGLVersion>1&&(0===a?(n.texParameteri(e,n.TEXTURE_COMPARE_FUNC,515),n.texParameteri(e,n.TEXTURE_COMPARE_MODE,n.NONE)):(n.texParameteri(e,n.TEXTURE_COMPARE_FUNC,a),n.texParameteri(e,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE)))}},240396:(t,K,D)=>{var a=D(182453),G=D(706400);D(499251).w.prototype.createRenderTargetCubeTexture=function(t,K){const D=this._createHardwareRenderTargetWrapper(!1,!0,t),N={generateMipMaps:!0,generateDepthBuffer:!0,generateStencilBuffer:!1,type:0,samplingMode:3,format:5,...K};N.generateStencilBuffer=N.generateDepthBuffer&&N.generateStencilBuffer,(1!==N.type||this._caps.textureFloatLinearFiltering)&&(2!==N.type||this._caps.textureHalfFloatLinearFiltering)||(N.samplingMode=1);const W=this._gl,x=new a.h(this,5);this._bindTextureDirectly(W.TEXTURE_CUBE_MAP,x,!0);const b=this._getSamplingParameters(N.samplingMode,N.generateMipMaps);1!==N.type||this._caps.textureFloat||(N.type=0,G.V.Warn("Float textures are not supported. Cube render target forced to TEXTURETYPE_UNESIGNED_BYTE type")),W.texParameteri(W.TEXTURE_CUBE_MAP,W.TEXTURE_MAG_FILTER,b.mag),W.texParameteri(W.TEXTURE_CUBE_MAP,W.TEXTURE_MIN_FILTER,b.min),W.texParameteri(W.TEXTURE_CUBE_MAP,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_CUBE_MAP,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE);for(let K=0;K<6;K++)W.texImage2D(W.TEXTURE_CUBE_MAP_POSITIVE_X+K,0,this._getRGBABufferInternalSizedFormat(N.type,N.format),t,t,0,this._getInternalFormat(N.format),this._getWebGLTextureType(N.type),null);const n=W.createFramebuffer();return this._bindUnboundFramebuffer(n),D._depthStencilBuffer=this._setupFramebufferDepthAttachments(N.generateStencilBuffer,N.generateDepthBuffer,t,t),N.generateMipMaps&&W.generateMipmap(W.TEXTURE_CUBE_MAP),this._bindTextureDirectly(W.TEXTURE_CUBE_MAP,null),this._bindUnboundFramebuffer(null),D._framebuffer=n,D._generateDepthBuffer=N.generateDepthBuffer,D._generateStencilBuffer=N.generateStencilBuffer,x.width=t,x.height=t,x.isReady=!0,x.isCube=!0,x.samples=1,x.generateMipMaps=N.generateMipMaps,x.samplingMode=N.samplingMode,x.type=N.type,x.format=N.format,this._internalTexturesCache.push(x),D.setTextures(x),D}},650646:(t,K,D)=>{D(499251).w.prototype.setDepthStencilTexture=function(t,K,D,a){void 0!==t&&(K&&(this._boundUniforms[t]=K),D&&D.depthStencilTexture?this._setTexture(t,D,!1,!0,a):this._setTexture(t,null,void 0,void 0,a))}},617024:(t,K,D)=>{var a=D(499251),G=D(672506);a.w.prototype.createUniformBuffer=function(t,K){const D=this._gl.createBuffer();if(!D)throw new Error("Unable to create uniform buffer");const a=new G.A(D);return this.bindUniformBuffer(a),t instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,t,this._gl.STATIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(t),this._gl.STATIC_DRAW),this.bindUniformBuffer(null),a.references=1,a},a.w.prototype.createDynamicUniformBuffer=function(t,K){const D=this._gl.createBuffer();if(!D)throw new Error("Unable to create dynamic uniform buffer");const a=new G.A(D);return this.bindUniformBuffer(a),t instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,t,this._gl.DYNAMIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(t),this._gl.DYNAMIC_DRAW),this.bindUniformBuffer(null),a.references=1,a},a.w.prototype.updateUniformBuffer=function(t,K,D,a){this.bindUniformBuffer(t),void 0===D&&(D=0),void 0===a?K instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,D,K):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,D,new Float32Array(K)):K instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,K.subarray(D,D+a)):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,new Float32Array(K).subarray(D,D+a)),this.bindUniformBuffer(null)},a.w.prototype.bindUniformBuffer=function(t){this._gl.bindBuffer(this._gl.UNIFORM_BUFFER,t?t.underlyingResource:null)},a.w.prototype.bindUniformBufferBase=function(t,K,D){this._gl.bindBufferBase(this._gl.UNIFORM_BUFFER,K,t?t.underlyingResource:null)},a.w.prototype.bindUniformBlock=function(t,K,D){const a=t.program,G=this._gl.getUniformBlockIndex(a,K);4294967295!==G&&this._gl.uniformBlockBinding(a,G,D)}},867967:(t,K,D)=>{D.d(K,{nO:()=>h,pB:()=>q,M0:()=>X,Iq:()=>H,J:()=>o});const a="attribute",G="varying";class N{constructor(){this.children=[]}isValid(t){return!0}process(t,K){var D,N,W,x,b,n,e;let i="";if(this.line){let z=this.line;const I=K.processor;if(I){I.lineProcessor&&(z=I.lineProcessor(z,K.isFragment,K.processingContext));const i=null!==(N=null===(D=K.processor)||void 0===D?void 0:D.attributeKeywordName)&&void 0!==N?N:a,Z=K.isFragment&&(null===(W=K.processor)||void 0===W?void 0:W.varyingFragmentKeywordName)?null===(x=K.processor)||void 0===x?void 0:x.varyingFragmentKeywordName:!K.isFragment&&(null===(b=K.processor)||void 0===b?void 0:b.varyingVertexKeywordName)?null===(n=K.processor)||void 0===n?void 0:n.varyingVertexKeywordName:G;!K.isFragment&&I.attributeProcessor&&this.line.startsWith(i)?z=I.attributeProcessor(this.line,t,K.processingContext):I.varyingProcessor&&((null===(e=I.varyingCheck)||void 0===e?void 0:e.call(I,this.line,K.isFragment))||!I.varyingCheck&&this.line.startsWith(Z))?z=I.varyingProcessor(this.line,K.isFragment,t,K.processingContext):I.uniformProcessor&&I.uniformRegexp&&I.uniformRegexp.test(this.line)?K.lookForClosingBracketForUniformBuffer||(z=I.uniformProcessor(this.line,K.isFragment,t,K.processingContext)):I.uniformBufferProcessor&&I.uniformBufferRegexp&&I.uniformBufferRegexp.test(this.line)?K.lookForClosingBracketForUniformBuffer||(z=I.uniformBufferProcessor(this.line,K.isFragment,K.processingContext),K.lookForClosingBracketForUniformBuffer=!0):I.textureProcessor&&I.textureRegexp&&I.textureRegexp.test(this.line)?z=I.textureProcessor(this.line,K.isFragment,t,K.processingContext):(I.uniformProcessor||I.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!K.lookForClosingBracketForUniformBuffer&&(/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?I.uniformProcessor&&(z=I.uniformProcessor(this.line,K.isFragment,t,K.processingContext)):I.uniformBufferProcessor&&(z=I.uniformBufferProcessor(this.line,K.isFragment,K.processingContext),K.lookForClosingBracketForUniformBuffer=!0)),K.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(K.lookForClosingBracketForUniformBuffer=!1,I.endOfUniformBufferProcessor&&(z=I.endOfUniformBufferProcessor(this.line,K.isFragment,K.processingContext)))}i+=z+"\n"}return this.children.forEach((D=>{i+=D.process(t,K)})),this.additionalDefineKey&&(t[this.additionalDefineKey]=this.additionalDefineValue||"true"),i}}class W{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(t){this._lines.length=0;for(const K of t){if(!K||"\r"===K)continue;if("#"===K[0]){this._lines.push(K);continue}const t=K.trim();if(!t)continue;if(t.startsWith("//")){this._lines.push(K);continue}const D=t.indexOf(";");if(-1===D)this._lines.push(t);else if(D===t.length-1)t.length>1&&this._lines.push(t);else{const t=K.split(";");for(let K=0;K<t.length;K++){let D=t[K];D&&(D=D.trim(),D&&this._lines.push(D+(K!==t.length-1?";":"")))}}}}}class x extends N{process(t,K){for(let D=0;D<this.children.length;D++){const a=this.children[D];if(a.isValid(t))return a.process(t,K)}return""}}class b extends N{isValid(t){return this.testExpression.isTrue(t)}}class n{isTrue(t){return!0}static postfixToInfix(t){const K=[];for(const D of t)if(void 0===n._OperatorPriority[D])K.push(D);else{const t=K[K.length-1],a=K[K.length-2];K.length-=2,K.push(`(${a}${D}${t})`)}return K[K.length-1]}static infixToPostfix(t){const K=n._InfixToPostfixCache.get(t);if(K)return K.accessTime=Date.now(),K.result;if(!(t.includes("&&")||t.includes("||")||t.includes(")")||t.includes("(")))return[t];const D=[];let a=-1;const G=()=>{e=e.trim(),""!==e&&(D.push(e),e="")},N=t=>{a<n._Stack.length-1&&(n._Stack[++a]=t)},W=()=>n._Stack[a],x=()=>-1===a?"!!INVALID EXPRESSION!!":n._Stack[a--];let b=0,e="";for(;b<t.length;){const K=t.charAt(b),i=b<t.length-1?t.substr(b,2):"";if("("===K)e="",N(K);else if(")"===K){for(G();-1!==a&&"("!==W();)D.push(x());x()}else if(n._OperatorPriority[i]>1){for(G();-1!==a&&n._OperatorPriority[W()]>=n._OperatorPriority[i];)D.push(x());N(i),b++}else e+=K;b++}for(G();-1!==a;)"("===W()?x():D.push(x());return n._InfixToPostfixCache.size>=n.InfixToPostfixCacheLimitSize&&n.ClearCache(),n._InfixToPostfixCache.set(t,{result:D,accessTime:Date.now()}),D}static ClearCache(){const t=Array.from(n._InfixToPostfixCache.entries()).sort(((t,K)=>t[1].accessTime-K[1].accessTime));for(let K=0;K<n.InfixToPostfixCacheCleanupSize;K++)n._InfixToPostfixCache.delete(t[K][0])}}n.InfixToPostfixCacheLimitSize=5e4,n.InfixToPostfixCacheCleanupSize=25e3,n._InfixToPostfixCache=new Map,n._OperatorPriority={")":0,"(":1,"||":2,"&&":3},n._Stack=["","","","","","","","","","","","","","","","","","","",""];class e extends n{constructor(t,K=!1){super(),this.define=t,this.not=K}isTrue(t){let K=void 0!==t[this.define];return this.not&&(K=!K),K}}class i extends n{isTrue(t){return this.leftOperand.isTrue(t)||this.rightOperand.isTrue(t)}}class z extends n{isTrue(t){return this.leftOperand.isTrue(t)&&this.rightOperand.isTrue(t)}}class I extends n{constructor(t,K,D){super(),this.define=t,this.operand=K,this.testValue=D}isTrue(t){let K=t[this.define];void 0===K&&(K=this.define);let D=!1;const a=parseInt(K),G=parseInt(this.testValue);switch(this.operand){case">":D=a>G;break;case"<":D=a<G;break;case"<=":D=a<=G;break;case">=":D=a>=G;break;case"==":D=a===G;break;case"!=":D=a!==G}return D}}var Z=D(554014),w=D(45410);const m=/defined\s*?\((.+?)\)/g,u=/defined\s*?\[(.+?)\]/g,d=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,E=/__decl__/,l=/light\{X\}.(\w*)/g,Q=/\{X\}/g,P=[],y=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function q(t){t.processor&&t.processor.initializeShaders&&t.processor.initializeShaders(t.processingContext)}function X(t,K,D,a){var G;(null===(G=K.processor)||void 0===G?void 0:G.preProcessShaderCode)&&(t=K.processor.preProcessShaderCode(t,K.isFragment)),H(t,K,(t=>{K.processCodeAfterIncludes&&(t=K.processCodeAfterIncludes(K.isFragment?"fragment":"vertex",t,K.defines));const G=function(t,K,D){let a=function(t,K){var D;if(null===(D=K.processor)||void 0===D?void 0:D.noPrecision)return t;const a=K.shouldUseHighPrecisionShader;return-1===t.indexOf("precision highp float")?t=a?"precision highp float;\n"+t:"precision mediump float;\n"+t:a||(t=t.replace("precision highp float","precision mediump float")),t}(t,K);if(!K.processor)return a;if(0===K.processor.shaderLanguage&&-1!==a.indexOf("#version 3")&&(a=a.replace("#version 300 es",""),!K.processor.parseGLES3))return a;const G=K.defines,x=function(t,K){var D;const a=t.defines,G={};for(const t of a){const K=t.replace("#define","").replace(";","").trim().split(" ");G[K[0]]=K.length>1?K[1]:""}return 0===(null===(D=t.processor)||void 0===D?void 0:D.shaderLanguage)&&(G["GL_ES"]="true"),G["__VERSION__"]=t.version,G[t.platformName]="true",w.xt(G,null==K?void 0:K.isNDCHalfZRange,null==K?void 0:K.useReverseDepthBuffer,null==K?void 0:K.useExactSrgbConversions),G}(K,D);return K.processor.preProcessor&&(a=K.processor.preProcessor(a,G,x,K.isFragment,K.processingContext)),a=function(t,K,D){const a=new N,G=new W;return G.lineIndex=-1,G.lines=t.split("\n"),C(G,a),a.process(K,D)}(a,x,K),K.processor.postProcessor&&(a=K.processor.postProcessor(a,G,K.isFragment,K.processingContext,D?{drawBuffersExtensionDisabled:!D.getCaps().drawBuffersExtension}:{})),(null==D?void 0:D._features.needShaderCodeInlining)&&(a=D.inlineShaderCode(a)),a}(t,K,a);D(G,t)}))}function h(t,K,D){return D.processor&&D.processor.finalizeShaders?D.processor.finalizeShaders(t,K,D.processingContext):{vertexCode:t,fragmentCode:K}}function J(t){const K=/defined\((.+)\)/.exec(t);if(K&&K.length)return new e(K[1].trim(),"!"===t[0]);const D=["==","!=",">=","<=","<",">"];let a="",G=0;for(a of D)if(G=t.indexOf(a),G>-1)break;if(-1===G)return new e(t);const N=t.substring(0,G).trim(),W=t.substring(G+a.length).trim();return new I(N,a,W)}function T(t,K){const D=new b,a=t.substring(0,K);let G=t.substring(K);return G=G.substring(0,(G.indexOf("//")+1||G.length+1)-1).trim(),D.testExpression="#ifdef"===a?new e(G):"#ifndef"===a?new e(G,!0):function(t){t=t.replace(m,"defined[$1]");const K=n.infixToPostfix(t),D=[];for(const t of K)if("||"!==t&&"&&"!==t)D.push(t);else if(D.length>=2){let K=D[D.length-1],a=D[D.length-2];D.length-=2;const G="&&"==t?new z:new i;"string"==typeof K&&(K=K.replace(u,"defined($1)")),"string"==typeof a&&(a=a.replace(u,"defined($1)")),G.leftOperand="string"==typeof a?J(a):a,G.rightOperand="string"==typeof K?J(K):K,D.push(G)}let a=D[D.length-1];return"string"==typeof a&&(a=a.replace(u,"defined($1)")),"string"==typeof a?J(a):a}(G),D}function _(t,K,D){let a=t.currentLine;for(;C(t,D);){a=t.currentLine;const G=a.substring(0,5).toLowerCase();if("#else"===G){const D=new N;return K.children.push(D),void C(t,D)}if("#elif"===G){const t=T(a,5);K.children.push(t),D=t}}}function C(t,K){for(;t.canRead;){t.lineIndex++;const D=t.currentLine;if(D.indexOf("#")>=0){const a=y.exec(D);if(a&&a.length){switch(a[0]){case"#ifdef":{const a=new x;K.children.push(a);const G=T(D,6);a.children.push(G),_(t,a,G);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const a=new x;K.children.push(a);const G=T(D,7);a.children.push(G),_(t,a,G);break}case"#if":{const a=new x,G=T(D,3);K.children.push(a),a.children.push(G),_(t,a,G);break}}continue}}const a=new N;if(a.line=D,K.children.push(a),"#"===D[0]&&"d"===D[1]){const t=D.replace(";","").split(" ");a.additionalDefineKey=t[1],3===t.length&&(a.additionalDefineValue=t[2])}}return!1}function H(t,K,D){let a;for(P.length=0;null!==(a=d.exec(t));)P.push(a);let G=String(t),N=[t],W=!1;for(const t of P){let a=t[1];if(-1!==a.indexOf("__decl__")&&(a=a.replace(E,""),K.supportsUniformBuffers&&(a=a.replace("Vertex","Ubo").replace("Fragment","Ubo")),a+="Declaration"),!K.includesShadersStore[a]){const t=K.shadersRepository+"ShadersInclude/"+a+".fx";return void o.loadFile(t,(t=>{K.includesShadersStore[a]=t,H(N.join(""),K,D)}))}{let D=K.includesShadersStore[a];if(t[2]){const K=t[3].split(",");for(let t=0;t<K.length;t+=2){const a=new RegExp(K[t],"g"),G=K[t+1];D=D.replace(a,G)}}if(t[4]){const a=t[5];if(-1!==a.indexOf("..")){const t=a.split(".."),G=parseInt(t[0]);let N=parseInt(t[1]),W=D.slice(0);D="",isNaN(N)&&(N=K.indexParameters[t[1]]);for(let t=G;t<N;t++)K.supportsUniformBuffers||(W=W.replace(l,((t,K)=>K+"{X}"))),D+=W.replace(Q,t.toString())+"\n"}else K.supportsUniformBuffers||(D=D.replace(l,((t,K)=>K+"{X}"))),D=D.replace(Q,a)}const G=[];for(const K of N){const a=K.split(t[0]);for(let t=0;t<a.length-1;t++)G.push(a[t]),G.push(D);G.push(a[a.length-1])}N=G,W=W||D.indexOf("#include<")>=0||D.indexOf("#include <")>=0}}P.length=0,G=N.join(""),W?H(G.toString(),K,D):D(G)}const o={loadFile:(t,K,D,a,G,N)=>{throw Z.n("FileTools")}}},874858:(t,K,D)=>{D.d(K,{B:()=>G});const a=/(flat\s)?\s*varying\s*.*/;class G{constructor(){this.shaderLanguage=0}attributeProcessor(t){return t.replace("attribute","in")}varyingCheck(t,K){return a.test(t)}varyingProcessor(t,K){return t.replace("varying",K?"in":"out")}postProcessor(t,K,D){const a=-1!==t.search(/#extension.+GL_EXT_draw_buffers.+require/);if(t=(t=t.replace(/#extension.+(GL_OVR_multiview2|GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g,"")).replace(/texture2D\s*\(/g,"texture("),D){const K=-1!==t.search(/layout *\(location *= *0\) *out/g);t=(t=(t=(t=(t=(t=(t=t.replace(/texture2DLodEXT\s*\(/g,"textureLod(")).replace(/textureCubeLodEXT\s*\(/g,"textureLod(")).replace(/textureCube\s*\(/g,"texture(")).replace(/gl_FragDepthEXT/g,"gl_FragDepth")).replace(/gl_FragColor/g,"glFragColor")).replace(/gl_FragData/g,"glFragData")).replace(/void\s+?main\s*\(/g,(a||K?"":"layout(location = 0) out vec4 glFragColor;\n")+"void main(")}else if(-1!==K.indexOf("#define MULTIVIEW"))return"#extension GL_OVR_multiview2 : require\nlayout (num_views = 2) in;\n"+t;return t}}},380811:(t,K,D)=>{D.d(K,{d:()=>a});class a{get underlyingResource(){return this._webGLTexture}constructor(t=null,K){if(this._MSAARenderBuffers=null,this._context=K,!t&&!(t=K.createTexture()))throw new Error("Unable to create webGL texture");this.set(t)}setUsage(){}set(t){this._webGLTexture=t}reset(){this._webGLTexture=null,this._MSAARenderBuffers=null}addMSAARenderBuffer(t){this._MSAARenderBuffers||(this._MSAARenderBuffers=[]),this._MSAARenderBuffers.push(t)}releaseMSAARenderBuffers(){if(this._MSAARenderBuffers){for(const t of this._MSAARenderBuffers)this._context.deleteRenderbuffer(t);this._MSAARenderBuffers=null}}getMSAARenderBuffer(t=0){var K,D;return null!==(D=null===(K=this._MSAARenderBuffers)||void 0===K?void 0:K[t])&&void 0!==D?D:null}release(){this.releaseMSAARenderBuffers(),this._webGLTexture&&this._context.deleteTexture(this._webGLTexture),this.reset()}}},640785:(t,K,D)=>{D.d(K,{x:()=>a});class a{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.engine._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(t){t&&this.program&&t(this.program)}setEngine(t){this.engine=t}_fillEffectInformation(t,K,D,a,G,N,W,x){const b=this.engine;if(b.supportsUniformBuffers)for(const D in K)t.bindUniformBlock(D,K[D]);let n;for(this.engine.getUniforms(this,D).forEach(((t,K)=>{a[D[K]]=t})),this._uniforms=a,n=0;n<G.length;n++)null==t.getUniform(G[n])&&(G.splice(n,1),n--);G.forEach(((t,K)=>{N[t]=K}));for(const t of b.getAttributes(this,W))x.push(t)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(t,K){const D=this._valueCache[t],a=K.updateFlag;return(void 0===D||D!==a)&&(this._valueCache[t]=a,!0)}_cacheFloat2(t,K,D){let a=this._valueCache[t];if(!a||2!==a.length)return a=[K,D],this._valueCache[t]=a,!0;let G=!1;return a[0]!==K&&(a[0]=K,G=!0),a[1]!==D&&(a[1]=D,G=!0),G}_cacheFloat3(t,K,D,a){let G=this._valueCache[t];if(!G||3!==G.length)return G=[K,D,a],this._valueCache[t]=G,!0;let N=!1;return G[0]!==K&&(G[0]=K,N=!0),G[1]!==D&&(G[1]=D,N=!0),G[2]!==a&&(G[2]=a,N=!0),N}_cacheFloat4(t,K,D,a,G){let N=this._valueCache[t];if(!N||4!==N.length)return N=[K,D,a,G],this._valueCache[t]=N,!0;let W=!1;return N[0]!==K&&(N[0]=K,W=!0),N[1]!==D&&(N[1]=D,W=!0),N[2]!==a&&(N[2]=a,W=!0),N[3]!==G&&(N[3]=G,W=!0),W}setInt(t,K){const D=this._valueCache[t];void 0!==D&&D===K||this.engine.setInt(this._uniforms[t],K)&&(this._valueCache[t]=K)}setInt2(t,K,D){this._cacheFloat2(t,K,D)&&(this.engine.setInt2(this._uniforms[t],K,D)||(this._valueCache[t]=null))}setInt3(t,K,D,a){this._cacheFloat3(t,K,D,a)&&(this.engine.setInt3(this._uniforms[t],K,D,a)||(this._valueCache[t]=null))}setInt4(t,K,D,a,G){this._cacheFloat4(t,K,D,a,G)&&(this.engine.setInt4(this._uniforms[t],K,D,a,G)||(this._valueCache[t]=null))}setIntArray(t,K){this._valueCache[t]=null,this.engine.setIntArray(this._uniforms[t],K)}setIntArray2(t,K){this._valueCache[t]=null,this.engine.setIntArray2(this._uniforms[t],K)}setIntArray3(t,K){this._valueCache[t]=null,this.engine.setIntArray3(this._uniforms[t],K)}setIntArray4(t,K){this._valueCache[t]=null,this.engine.setIntArray4(this._uniforms[t],K)}setUInt(t,K){const D=this._valueCache[t];void 0!==D&&D===K||this.engine.setUInt(this._uniforms[t],K)&&(this._valueCache[t]=K)}setUInt2(t,K,D){this._cacheFloat2(t,K,D)&&(this.engine.setUInt2(this._uniforms[t],K,D)||(this._valueCache[t]=null))}setUInt3(t,K,D,a){this._cacheFloat3(t,K,D,a)&&(this.engine.setUInt3(this._uniforms[t],K,D,a)||(this._valueCache[t]=null))}setUInt4(t,K,D,a,G){this._cacheFloat4(t,K,D,a,G)&&(this.engine.setUInt4(this._uniforms[t],K,D,a,G)||(this._valueCache[t]=null))}setUIntArray(t,K){this._valueCache[t]=null,this.engine.setUIntArray(this._uniforms[t],K)}setUIntArray2(t,K){this._valueCache[t]=null,this.engine.setUIntArray2(this._uniforms[t],K)}setUIntArray3(t,K){this._valueCache[t]=null,this.engine.setUIntArray3(this._uniforms[t],K)}setUIntArray4(t,K){this._valueCache[t]=null,this.engine.setUIntArray4(this._uniforms[t],K)}setArray(t,K){this._valueCache[t]=null,this.engine.setArray(this._uniforms[t],K)}setArray2(t,K){this._valueCache[t]=null,this.engine.setArray2(this._uniforms[t],K)}setArray3(t,K){this._valueCache[t]=null,this.engine.setArray3(this._uniforms[t],K)}setArray4(t,K){this._valueCache[t]=null,this.engine.setArray4(this._uniforms[t],K)}setMatrices(t,K){K&&(this._valueCache[t]=null,this.engine.setMatrices(this._uniforms[t],K))}setMatrix(t,K){this._cacheMatrix(t,K)&&(this.engine.setMatrices(this._uniforms[t],K.asArray())||(this._valueCache[t]=null))}setMatrix3x3(t,K){this._valueCache[t]=null,this.engine.setMatrix3x3(this._uniforms[t],K)}setMatrix2x2(t,K){this._valueCache[t]=null,this.engine.setMatrix2x2(this._uniforms[t],K)}setFloat(t,K){const D=this._valueCache[t];void 0!==D&&D===K||this.engine.setFloat(this._uniforms[t],K)&&(this._valueCache[t]=K)}setVector2(t,K){this._cacheFloat2(t,K.x,K.y)&&(this.engine.setFloat2(this._uniforms[t],K.x,K.y)||(this._valueCache[t]=null))}setFloat2(t,K,D){this._cacheFloat2(t,K,D)&&(this.engine.setFloat2(this._uniforms[t],K,D)||(this._valueCache[t]=null))}setVector3(t,K){this._cacheFloat3(t,K.x,K.y,K.z)&&(this.engine.setFloat3(this._uniforms[t],K.x,K.y,K.z)||(this._valueCache[t]=null))}setFloat3(t,K,D,a){this._cacheFloat3(t,K,D,a)&&(this.engine.setFloat3(this._uniforms[t],K,D,a)||(this._valueCache[t]=null))}setVector4(t,K){this._cacheFloat4(t,K.x,K.y,K.z,K.w)&&(this.engine.setFloat4(this._uniforms[t],K.x,K.y,K.z,K.w)||(this._valueCache[t]=null))}setQuaternion(t,K){this._cacheFloat4(t,K.x,K.y,K.z,K.w)&&(this.engine.setFloat4(this._uniforms[t],K.x,K.y,K.z,K.w)||(this._valueCache[t]=null))}setFloat4(t,K,D,a,G){this._cacheFloat4(t,K,D,a,G)&&(this.engine.setFloat4(this._uniforms[t],K,D,a,G)||(this._valueCache[t]=null))}setColor3(t,K){this._cacheFloat3(t,K.r,K.g,K.b)&&(this.engine.setFloat3(this._uniforms[t],K.r,K.g,K.b)||(this._valueCache[t]=null))}setColor4(t,K,D){this._cacheFloat4(t,K.r,K.g,K.b,D)&&(this.engine.setFloat4(this._uniforms[t],K.r,K.g,K.b,D)||(this._valueCache[t]=null))}setDirectColor4(t,K){this._cacheFloat4(t,K.r,K.g,K.b,K.a)&&(this.engine.setFloat4(this._uniforms[t],K.r,K.g,K.b,K.a)||(this._valueCache[t]=null))}_getVertexShaderCode(){return this.vertexShader?this.engine._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.engine._getShaderSource(this.fragmentShader):null}}},45410:(t,K,D)=>{D.d(K,{W0:()=>W,iL:()=>N,sg:()=>G,xt:()=>x});var a=D(554014);D(394501);const G={};function N(t,K,D=""){return D+(K?K+"\n":"")+t}function W(t,K,D,N,W,x,b){const n=b||G.loadFile;if(n)return n(t,K,D,N,W,x);throw a.n("FileTools")}function x(t,K,D,a){if(t)return K?t["IS_NDC_HALF_ZRANGE"]="":delete t["IS_NDC_HALF_ZRANGE"],D?t["USE_REVERSE_DEPTHBUFFER"]="":delete t["USE_REVERSE_DEPTHBUFFER"],void(a?t["USE_EXACT_SRGB_CONVERSIONS"]="":delete t["USE_EXACT_SRGB_CONVERSIONS"]);{let t="";return K&&(t+="#define IS_NDC_HALF_ZRANGE"),D&&(t&&(t+="\n"),t+="#define USE_REVERSE_DEPTHBUFFER"),a&&(t&&(t+="\n"),t+="#define USE_EXACT_SRGB_CONVERSIONS"),t}}},33321:(t,K,D)=>{D.d(K,{$:()=>E});var a=D(395726),G=D(706400),N=D(498083),W=D(155429),x=D(488354),b=D(460976),n=D(762945),e=D(56291),i=D(822133),z=D(554014),I=D(182453),Z=D(394501),w=D(638113),m=D(45410),u=D(892643);function d(t,K){if(Z.BA()){const{requestAnimationFrame:D}=K||window;if("function"==typeof D)return D(t)}else if("function"==typeof requestAnimationFrame)return requestAnimationFrame(t);return setTimeout(t,16)}class E{get frameId(){return this._frameId}get isWebGPU(){return this._isWebGPU}_getShaderProcessor(t){return this._shaderProcessor}get shaderPlatformName(){return this._shaderPlatformName}_clearEmptyResources(){this._emptyTexture=null,this._emptyCubeTexture=null,this._emptyTexture3D=null,this._emptyTexture2DArray=null}get useReverseDepthBuffer(){return this._useReverseDepthBuffer}set useReverseDepthBuffer(t){t!==this._useReverseDepthBuffer&&(this._useReverseDepthBuffer=t,this._depthCullingState.depthFunc=t?518:515)}setColorWrite(t){t!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=t)}getColorWrite(){return this._colorWrite}get depthCullingState(){return this._depthCullingState}get alphaState(){return this._alphaState}get stencilState(){return this._stencilState}get stencilStateComposer(){return this._stencilStateComposer}_getGlobalDefines(t){if(t)return this.isNDCHalfZRange?t["IS_NDC_HALF_ZRANGE"]="":delete t["IS_NDC_HALF_ZRANGE"],this.useReverseDepthBuffer?t["USE_REVERSE_DEPTHBUFFER"]="":delete t["USE_REVERSE_DEPTHBUFFER"],void(this.useExactSrgbConversions?t["USE_EXACT_SRGB_CONVERSIONS"]="":delete t["USE_EXACT_SRGB_CONVERSIONS"]);{let t="";return this.isNDCHalfZRange&&(t+="#define IS_NDC_HALF_ZRANGE"),this.useReverseDepthBuffer&&(t&&(t+="\n"),t+="#define USE_REVERSE_DEPTHBUFFER"),this.useExactSrgbConversions&&(t&&(t+="\n"),t+="#define USE_EXACT_SRGB_CONVERSIONS"),t}}_rebuildInternalTextures(){const t=this._internalTexturesCache.slice();for(const K of t)K._rebuild()}_rebuildRenderTargetWrappers(){const t=this._renderTargetWrapperCache.slice();for(const K of t)K._rebuild()}_rebuildEffects(){for(const t in this._compiledEffects){const K=this._compiledEffects[t];K._pipelineContext=null,K._prepareEffect()}N.M.ResetCache()}_rebuildGraphicsResources(){var t;this.wipeCaches(!0),this._rebuildEffects(),null===(t=this._rebuildComputeEffects)||void 0===t||t.call(this),this._rebuildBuffers(),this._rebuildInternalTextures(),this._rebuildTextures(),this._rebuildRenderTargetWrappers(),this.wipeCaches(!0)}_flagContextRestored(){G.V.Warn(this.name+" context successfully restored."),this.onContextRestoredObservable.notifyObservers(this),this._contextWasLost=!1}_restoreEngineAfterContextLost(t){setTimeout((async()=>{this._clearEmptyResources();const K=this._depthCullingState.depthTest,D=this._depthCullingState.depthFunc,a=this._depthCullingState.depthMask,G=this._stencilState.stencilTest;await t(),this._rebuildGraphicsResources(),this._depthCullingState.depthTest=K,this._depthCullingState.depthFunc=D,this._depthCullingState.depthMask=a,this._stencilState.stencilTest=G,this._flagContextRestored()}),0)}get isDisposed(){return this._isDisposed}get snapshotRendering(){return!1}set snapshotRendering(t){}get snapshotRenderingMode(){return 0}set snapshotRenderingMode(t){}getClassName(){return"AbstractEngine"}get emptyTexture(){return this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1)),this._emptyTexture}get emptyTexture3D(){return this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture3D}get emptyTexture2DArray(){return this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture2DArray}get emptyCubeTexture(){if(!this._emptyCubeTexture){const t=new Uint8Array(4),K=[t,t,t,t,t,t];this._emptyCubeTexture=this.createRawCubeTexture(K,1,5,0,!1,!1,1)}return this._emptyCubeTexture}get activeRenderLoops(){return this._activeRenderLoops}stopRenderLoop(t){if(!t)return this._activeRenderLoops.length=0,void this._cancelFrame();const K=this._activeRenderLoops.indexOf(t);K>=0&&(this._activeRenderLoops.splice(K,1),0==this._activeRenderLoops.length&&this._cancelFrame())}_cancelFrame(){if(0!==this._frameHandler){const t=this._frameHandler;if(this._frameHandler=0,Z.BA()){const{cancelAnimationFrame:K}=this.getHostWindow()||window;if("function"==typeof K)return K(t)}else if("function"==typeof cancelAnimationFrame)return cancelAnimationFrame(t);return clearTimeout(t)}}beginFrame(){this.onBeginFrameObservable.notifyObservers(this)}endFrame(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}_renderLoop(){if(this._frameHandler=0,!this._contextWasLost){let t=!0;(this._isDisposed||!this.renderEvenInBackground&&this._windowIsBackground)&&(t=!1),t&&(this.beginFrame(),this._renderViews()||this._renderFrame(),this.endFrame())}this._activeRenderLoops.length>0&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()))}_renderFrame(){for(let t=0;t<this._activeRenderLoops.length;t++)(0,this._activeRenderLoops[t])()}_renderViews(){return!1}_queueNewFrame(t,K){return d(t,K)}runRenderLoop(t){-1===this._activeRenderLoops.indexOf(t)&&(this._activeRenderLoops.push(t),1===this._activeRenderLoops.length&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))}getDepthBuffer(){return this._depthCullingState.depthTest}setDepthBuffer(t){this._depthCullingState.depthTest=t}setZOffset(t){this._depthCullingState.zOffset=this.useReverseDepthBuffer?-t:t}getZOffset(){const t=this._depthCullingState.zOffset;return this.useReverseDepthBuffer?-t:t}setZOffsetUnits(t){this._depthCullingState.zOffsetUnits=this.useReverseDepthBuffer?-t:t}getZOffsetUnits(){const t=this._depthCullingState.zOffsetUnits;return this.useReverseDepthBuffer?-t:t}getHostWindow(){return Z.BA()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null}get compatibilityMode(){return this._compatibilityMode}set compatibilityMode(t){this._compatibilityMode=!0}_rebuildTextures(){for(const t of this.scenes)t._rebuildTextures();for(const t of this._virtualScenes)t._rebuildTextures()}_releaseRenderTargetWrapper(t){const K=this._renderTargetWrapperCache.indexOf(t);-1!==K&&this._renderTargetWrapperCache.splice(K,1)}get currentViewport(){return this._cachedViewport}setViewport(t,K,D){const a=K||this.getRenderWidth(),G=D||this.getRenderHeight(),N=t.x||0,W=t.y||0;this._cachedViewport=t,this._viewport(N*a,W*G,a*t.width,G*t.height)}createCanvasImage(){return document.createElement("img")}get description(){let t=this.name+this.version;return this._caps.parallelShaderCompile&&(t+=" - Parallel shader compilation"),t}_createTextureBase(t,K,D,N,W=3,x=null,b=null,n,e,i=null,z=null,Z=null,w=null,m,d,l){const Q="data:"===(t=t||"").substr(0,5),P="blob:"===t.substr(0,5),y=Q&&-1!==t.indexOf(";base64,"),q=z||new I.h(this,1);q!==z&&(q.label=t.substring(0,60));const X=t;!this._transformTextureUrl||y||z||i||(t=this._transformTextureUrl(t)),X!==t&&(q._originalUrl=X);const h=t.lastIndexOf(".");let J=w||(h>-1?t.substring(h).toLowerCase():"");J.indexOf("?")>-1&&(J=J.split("?")[0]);const T=u.g(J,m);N&&N.addPendingData(q),q.url=t,q.generateMipMaps=!K,q.samplingMode=W,q.invertY=D,q._useSRGBBuffer=this._getUseSRGBBuffer(!!l,K),this._doNotHandleContextLost||(q._buffer=i);let _=null;x&&!z&&(_=q.onLoadedObservable.add(x)),z||this._internalTexturesCache.push(q);const C=(D,z)=>{N&&N.removePendingData(q),t===X?(_&&q.onLoadedObservable.remove(_),a.q.UseFallbackTexture&&t!==a.q.FallbackTexture&&this._createTextureBase(a.q.FallbackTexture,K,q.invertY,N,W,null,b,n,e,i,q),D=(D||"Unknown error")+(a.q.UseFallbackTexture?" - Fallback texture was used":""),q.onErrorObservable.notifyObservers({message:D,exception:z}),b&&b(D,z)):(G.V.Warn(`Failed to load ${t}, falling back to ${X}`),this._createTextureBase(X,K,q.invertY,N,W,x,b,n,e,i,q,Z,w,m,d,l))};if(T){const K=async t=>{(await T).loadData(t,q,((t,K,D,a,G,x)=>{x?C("TextureLoader failed to load data"):n(q,J,N,{width:t,height:K},q.invertY,!D,a,(()=>(G(),!1)),W)}),d)};i?i instanceof ArrayBuffer?K(new Uint8Array(i)):ArrayBuffer.isView(i)?K(i):b&&b("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(t,(t=>K(new Uint8Array(t))),void 0,N?N.offlineProvider:void 0,!0,((t,K)=>{C("Unable to load "+(t&&t.responseURL,K))}))}else{const D=t=>{P&&!this._doNotHandleContextLost&&(q._buffer=t),n(q,J,N,t,q.invertY,K,!1,e,W)};!Q||y?i&&("string"==typeof i.decoding||i.close)?D(i):E._FileToolsLoadImage(t||"",D,C,N?N.offlineProvider:null,m,q.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):"string"==typeof i||i instanceof ArrayBuffer||ArrayBuffer.isView(i)||i instanceof Blob?E._FileToolsLoadImage(i,D,C,N?N.offlineProvider:null,m,q.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):i&&D(i)}return q}_rebuildBuffers(){for(const t of this._uniformBuffers)t._rebuildAfterContextLost()}get _shouldUseHighPrecisionShader(){return!(!this._caps.highPrecisionShaderSupported||!this._highPrecisionShadersAllowed)}getHostDocument(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:Z.Nf()?document:null}getLoadedTexturesCache(){return this._internalTexturesCache}clearInternalTexturesCache(){this._internalTexturesCache.length=0}getCaps(){return this._caps}resetTextureCache(){for(const t in this._boundTexturesCache)Object.prototype.hasOwnProperty.call(this._boundTexturesCache,t)&&(this._boundTexturesCache[t]=null);this._currentTextureChannel=-1}get name(){return this._name}set name(t){this._name=t}static get NpmPackage(){return"babylonjs@7.24.0"}static get Version(){return"7.24.0"}getRenderingCanvas(){return this._renderingCanvas}getAudioContext(){return this._audioContext}getAudioDestination(){return this._audioDestination}setHardwareScalingLevel(t){this._hardwareScalingLevel=t,this.resize()}getHardwareScalingLevel(){return this._hardwareScalingLevel}get doNotHandleContextLost(){return this._doNotHandleContextLost}set doNotHandleContextLost(t){this._doNotHandleContextLost=t}get isStencilEnable(){return this._isStencilEnable}getCreationOptions(){return this._creationOptions}constructor(t,K,D){var G,N,z,I,m,u,d,E,l,Q,P;this._colorWrite=!0,this._colorWriteChanged=!0,this._depthCullingState=new b.N,this._stencilStateComposer=new n.u,this._stencilState=new e.K,this._alphaState=new i.i,this._alphaMode=1,this._alphaEquation=0,this._activeRequests=[],this._badOS=!1,this._badDesktopOS=!1,this._compatibilityMode=!0,this._internalTexturesCache=new Array,this._currentRenderTarget=null,this._boundTexturesCache={},this._activeChannel=0,this._currentTextureChannel=-1,this._viewportCached={x:0,y:0,z:0,w:0},this._isWebGPU=!1,this.onCanvasBlurObservable=new w.cP,this.onCanvasFocusObservable=new w.cP,this.onNewSceneAddedObservable=new w.cP,this.onResizeObservable=new w.cP,this.onCanvasPointerOutObservable=new w.cP,this.disablePerformanceMonitorInBackground=!1,this.disableVertexArrayObjects=!1,this._frameId=0,this.hostInformation={isMobile:!1},this.isFullscreen=!1,this.enableOfflineSupport=!1,this.disableManifestCheck=!1,this.disableContextMenu=!0,this.currentRenderPassId=0,this.isPointerLock=!1,this.postProcesses=[],this.canvasTabIndex=1,this._contextWasLost=!1,this._useReverseDepthBuffer=!1,this.isNDCHalfZRange=!1,this.hasOriginBottomLeft=!0,this._renderTargetWrapperCache=new Array,this._compiledEffects={},this._isDisposed=!1,this.scenes=[],this._virtualScenes=new Array,this.onBeforeTextureInitObservable=new w.cP,this.renderEvenInBackground=!0,this.preventCacheWipeBetweenFrames=!1,this._frameHandler=0,this._activeRenderLoops=new Array,this._windowIsBackground=!1,this._boundRenderFunction=()=>this._renderLoop(),this.onBeforeShaderCompilationObservable=new w.cP,this.onAfterShaderCompilationObservable=new w.cP,this.onBeginFrameObservable=new w.cP,this.onEndFrameObservable=new w.cP,this._transformTextureUrl=null,this._uniformBuffers=new Array,this._storageBuffers=new Array,this._highPrecisionShadersAllowed=!0,this.onContextLostObservable=new w.cP,this.onContextRestoredObservable=new w.cP,this._name="",this.premultipliedAlpha=!0,this.adaptToDeviceRatio=!1,this._lastDevicePixelRatio=1,this._doNotHandleContextLost=!1,this.cullBackFaces=null,this._renderPassNames=["main"],this._fps=60,this._deltaTime=0,this._deterministicLockstep=!1,this._lockstepMaxSteps=4,this._timeStep=1/60,this.onDisposeObservable=new w.cP,a.q.Instances.push(this),this.startTime=x.j.Now,this._stencilStateComposer.stencilGlobal=this._stencilState,W.I.SetMatrixPrecision(!!K.useHighPrecisionMatrix),Z.XD()&&navigator.userAgent&&(this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),this.adaptToDeviceRatio=null!=D&&D,K.antialias=null!=t?t:K.antialias,K.deterministicLockstep=null!==(G=K.deterministicLockstep)&&void 0!==G&&G,K.lockstepMaxSteps=null!==(N=K.lockstepMaxSteps)&&void 0!==N?N:4,K.timeStep=null!==(z=K.timeStep)&&void 0!==z?z:1/60,K.audioEngine=null===(I=K.audioEngine)||void 0===I||I,K.stencil=null===(m=K.stencil)||void 0===m||m,this._audioContext=null!==(d=null===(u=K.audioEngineOptions)||void 0===u?void 0:u.audioContext)&&void 0!==d?d:null,this._audioDestination=null!==(l=null===(E=K.audioEngineOptions)||void 0===E?void 0:E.audioDestination)&&void 0!==l?l:null,this.premultipliedAlpha=null===(Q=K.premultipliedAlpha)||void 0===Q||Q,this._doNotHandleContextLost=!!K.doNotHandleContextLost,this._isStencilEnable=!!K.stencil,this.useExactSrgbConversions=null!==(P=K.useExactSrgbConversions)&&void 0!==P&&P;const y=Z.BA()&&window.devicePixelRatio||1,q=K.limitDeviceRatio||y;D=D||K.adaptToDeviceRatio||!1,this._hardwareScalingLevel=D?1/Math.min(q,y):1,this._lastDevicePixelRatio=y,this._creationOptions=K}resize(t=!1){let K,D;if(this.adaptToDeviceRatio){const t=Z.BA()&&window.devicePixelRatio||1,K=this._lastDevicePixelRatio/t;this._lastDevicePixelRatio=t,this._hardwareScalingLevel*=K}if(Z.BA()&&Z.Nf())if(this._renderingCanvas){const t=this._renderingCanvas.getBoundingClientRect?this._renderingCanvas.getBoundingClientRect():{width:this._renderingCanvas.width*this._hardwareScalingLevel,height:this._renderingCanvas.height*this._hardwareScalingLevel};K=this._renderingCanvas.clientWidth||t.width||this._renderingCanvas.width||100,D=this._renderingCanvas.clientHeight||t.height||this._renderingCanvas.height||100}else K=window.innerWidth,D=window.innerHeight;else K=this._renderingCanvas?this._renderingCanvas.width:100,D=this._renderingCanvas?this._renderingCanvas.height:100;this.setSize(K/this._hardwareScalingLevel,D/this._hardwareScalingLevel,t)}setSize(t,K,D=!1){if(!this._renderingCanvas)return!1;if(t|=0,K|=0,!D&&this._renderingCanvas.width===t&&this._renderingCanvas.height===K)return!1;if(this._renderingCanvas.width=t,this._renderingCanvas.height=K,this.scenes){for(let t=0;t<this.scenes.length;t++){const K=this.scenes[t];for(let t=0;t<K.cameras.length;t++)K.cameras[t]._currentRenderId=0}this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0}createRawTexture(t,K,D,a,G,N,W,x,b,n,e){throw z.n("engine.rawTexture")}createRawCubeTexture(t,K,D,a,G,N,W,x){throw z.n("engine.rawTexture")}createRawTexture3D(t,K,D,a,G,N,W,x,b,n,e){throw z.n("engine.rawTexture")}createRawTexture2DArray(t,K,D,a,G,N,W,x,b,n,e){throw z.n("engine.rawTexture")}_sharedInit(t){this._renderingCanvas=t}_setupMobileChecks(){navigator&&navigator.userAgent&&(this._checkForMobile=()=>{const t=navigator.userAgent;this.hostInformation.isMobile=-1!==t.indexOf("Mobile")||-1!==t.indexOf("Mac")&&Z.Nf()&&"ontouchend"in document},this._checkForMobile(),Z.BA()&&window.addEventListener("resize",this._checkForMobile))}createVideoElement(t){return document.createElement("video")}_reportDrawCall(t=1){var K;null===(K=this._drawCalls)||void 0===K||K.addCount(t,!1)}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}isDeterministicLockStep(){return this._deterministicLockstep}getLockstepMaxSteps(){return this._lockstepMaxSteps}getTimeStep(){return 1e3*this._timeStep}_createImageBitmapFromSource(t,K){throw new Error("createImageBitmapFromSource is not implemented")}createImageBitmap(t,K){return createImageBitmap(t,K)}resizeImageBitmap(t,K,D){throw new Error("resizeImageBitmap is not implemented")}getFontOffset(t){throw new Error("getFontOffset is not implemented")}static _CreateCanvas(t,K){if("undefined"==typeof document)return new OffscreenCanvas(t,K);const D=document.createElement("canvas");return D.width=t,D.height=K,D}createCanvas(t,K){return E._CreateCanvas(t,K)}static _FileToolsLoadImage(t,K,D,a,G,N){throw z.n("FileTools")}_loadFile(t,K,D,a,G,N){const W=m.W0(t,K,D,a,G,N);return this._activeRequests.push(W),W.onCompleteObservable.add((()=>{const t=this._activeRequests.indexOf(W);-1!==t&&this._activeRequests.splice(t,1)})),W}static _FileToolsLoadFile(t,K,D,a,G,N){if(m.sg.loadFile)return m.sg.loadFile(t,K,D,a,G,N);throw z.n("FileTools")}dispose(){var t;for(this.releaseEffects(),this._isDisposed=!0,this.stopRenderLoop(),this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null),this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null),this._renderingCanvas=null,this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(;this.scenes.length;)this.scenes[0].dispose();for(;this._virtualScenes.length;)this._virtualScenes[0].dispose();null===(t=this.releaseComputeEffects)||void 0===t||t.call(this),N.M.ResetCache();for(const t of this._activeRequests)t.abort();this._boundRenderFunction=null,this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onResizeObservable.clear(),this.onCanvasBlurObservable.clear(),this.onCanvasFocusObservable.clear(),this.onCanvasPointerOutObservable.clear(),this.onNewSceneAddedObservable.clear(),Z.BA()&&window.removeEventListener("resize",this._checkForMobile);const K=a.q.Instances.indexOf(this);K>=0&&a.q.Instances.splice(K,1),a.q.Instances.length||(a.q.OnEnginesDisposedObservable.notifyObservers(this),a.q.OnEnginesDisposedObservable.clear()),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear()}static DefaultLoadingScreenFactory(t){throw z.n("LoadingScreen")}static MarkAllMaterialsAsDirty(t,K){for(let D=0;D<a.q.Instances.length;D++){const G=a.q.Instances[D];for(let D=0;D<G.scenes.length;D++)G.scenes[D].markAllMaterialsAsDirty(t,K)}}}E._RenderPassIdCounter=0,E._RescalePostProcessFactory=null,E.CollisionsEpsilon=.001,E.QueueNewFrame=d},697772:(t,K,D)=>{D.d(K,{BG:()=>W,PR:()=>b,eG:()=>I,g7:()=>z,jf:()=>e,kF:()=>n,kX:()=>x,rT:()=>Z,tl:()=>i});var a=D(394501),G=D(33321),N=D(395726);function W(t,K,D){t._onCanvasFocus=()=>{t.onCanvasFocusObservable.notifyObservers(t)},t._onCanvasBlur=()=>{t.onCanvasBlurObservable.notifyObservers(t)},t._onCanvasContextMenu=K=>{t.disableContextMenu&&K.preventDefault()},K.addEventListener("focus",t._onCanvasFocus),K.addEventListener("blur",t._onCanvasBlur),K.addEventListener("contextmenu",t._onCanvasContextMenu),t._onBlur=()=>{t.disablePerformanceMonitorInBackground&&t.performanceMonitor.disable(),t._windowIsBackground=!0},t._onFocus=()=>{t.disablePerformanceMonitorInBackground&&t.performanceMonitor.enable(),t._windowIsBackground=!1},t._onCanvasPointerOut=D=>{document.elementFromPoint(D.clientX,D.clientY)!==K&&t.onCanvasPointerOutObservable.notifyObservers(D)};const N=t.getHostWindow();N&&"function"==typeof N.addEventListener&&(N.addEventListener("blur",t._onBlur),N.addEventListener("focus",t._onFocus)),K.addEventListener("pointerout",t._onCanvasPointerOut),D.doNotHandleTouchAction||function(t){t&&t.setAttribute&&(t.setAttribute("touch-action","none"),t.style.touchAction="none",t.style.webkitTapHighlightColor="transparent")}(K),!G.$.audioEngine&&D.audioEngine&&G.$.AudioEngineFactory&&(G.$.audioEngine=G.$.AudioEngineFactory(t.getRenderingCanvas(),t.getAudioContext(),t.getAudioDestination())),a.Nf()&&(t._onFullscreenChange=()=>{t.isFullscreen=!!document.fullscreenElement,t.isFullscreen&&t._pointerLockRequested&&K&&I(K)},document.addEventListener("fullscreenchange",t._onFullscreenChange,!1),document.addEventListener("webkitfullscreenchange",t._onFullscreenChange,!1),t._onPointerLockChange=()=>{t.isPointerLock=document.pointerLockElement===K},document.addEventListener("pointerlockchange",t._onPointerLockChange,!1),document.addEventListener("webkitpointerlockchange",t._onPointerLockChange,!1)),t.enableOfflineSupport=void 0!==G.$.OfflineProviderFactory,t._deterministicLockstep=!!D.deterministicLockstep,t._lockstepMaxSteps=D.lockstepMaxSteps||0,t._timeStep=D.timeStep||1/60}function x(t,K){1===N.q.Instances.length&&G.$.audioEngine&&(G.$.audioEngine.dispose(),G.$.audioEngine=null);const D=t.getHostWindow();D&&"function"==typeof D.removeEventListener&&(D.removeEventListener("blur",t._onBlur),D.removeEventListener("focus",t._onFocus)),K&&(K.removeEventListener("focus",t._onCanvasFocus),K.removeEventListener("blur",t._onCanvasBlur),K.removeEventListener("pointerout",t._onCanvasPointerOut),K.removeEventListener("contextmenu",t._onCanvasContextMenu)),a.Nf()&&(document.removeEventListener("fullscreenchange",t._onFullscreenChange),document.removeEventListener("mozfullscreenchange",t._onFullscreenChange),document.removeEventListener("webkitfullscreenchange",t._onFullscreenChange),document.removeEventListener("msfullscreenchange",t._onFullscreenChange),document.removeEventListener("pointerlockchange",t._onPointerLockChange),document.removeEventListener("mspointerlockchange",t._onPointerLockChange),document.removeEventListener("mozpointerlockchange",t._onPointerLockChange),document.removeEventListener("webkitpointerlockchange",t._onPointerLockChange))}function b(t){const K=document.createElement("span");K.textContent="Hg",K.style.font=t;const D=document.createElement("div");D.style.display="inline-block",D.style.width="1px",D.style.height="0px",D.style.verticalAlign="bottom";const a=document.createElement("div");a.style.whiteSpace="nowrap",a.appendChild(K),a.appendChild(D),document.body.appendChild(a);let G=0,N=0;try{N=D.getBoundingClientRect().top-K.getBoundingClientRect().top,D.style.verticalAlign="baseline",G=D.getBoundingClientRect().top-K.getBoundingClientRect().top}finally{document.body.removeChild(a)}return{ascent:G,height:N,descent:N-G}}function n(t,K,D){return new Promise(((a,G)=>{const N=new Image;N.onload=()=>{N.decode().then((()=>{t.createImageBitmap(N,D).then((t=>{a(t)}))}))},N.onerror=()=>{G(`Error loading image ${N.src}`)},N.src=K}))}function e(t,K,D,a){const G=t.createCanvas(D,a).getContext("2d");if(!G)throw new Error("Unable to get 2d context for resizeImageBitmap");return G.drawImage(K,0,0),G.getImageData(0,0,D,a).data}function i(t){const K=t.requestFullscreen||t.webkitRequestFullscreen;K&&K.call(t)}function z(){const t=document;document.exitFullscreen?document.exitFullscreen():t.webkitCancelFullScreen&&t.webkitCancelFullScreen()}function I(t){if(t.requestPointerLock){const K=t.requestPointerLock();K instanceof Promise?K.then((()=>{t.focus()})).catch((()=>{})):t.focus()}}function Z(){document.exitPointerLock&&document.exitPointerLock()}},412067:(t,K,D)=>{D.d(K,{N:()=>I});var a=D(182453),G=D(395726),N=D(499251),W=D(636828),x=D(672506),b=D(706400),n=D(380811),e=(D(889630),D(269673),D(80157),D(129970),D(779010),D(649646),D(299741),D(834405),D(33321)),i=D(697772),z=D(850327);D(240124);class I extends N.w{static get NpmPackage(){return e.$.NpmPackage}static get Version(){return e.$.Version}static get Instances(){return G.q.Instances}static get LastCreatedEngine(){return G.q.LastCreatedEngine}static get LastCreatedScene(){return G.q.LastCreatedScene}static DefaultLoadingScreenFactory(t){return e.$.DefaultLoadingScreenFactory(t)}get _supportsHardwareTextureRescaling(){return!!I._RescalePostProcessFactory}_measureFps(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}get performanceMonitor(){return this._performanceMonitor}constructor(t,K,D,a=!1){if(super(t,K,D,a),this.customAnimationFrameRequester=null,this._performanceMonitor=new W.r,this._drawCalls=new z.A,t&&(this._features.supportRenderPasses=!0,D=this._creationOptions,t.getContext)){const K=t;this._sharedInit(K)}}_initGLContext(){super._initGLContext(),this._rescalePostProcess=null}_sharedInit(t){super._sharedInit(t),i.BG(this,t,this._creationOptions)}resizeImageBitmap(t,K,D){return i.jf(this,t,K,D)}_createImageBitmapFromSource(t,K){return i.kF(this,t,K)}switchFullscreen(t){this.isFullscreen?this.exitFullscreen():this.enterFullscreen(t)}enterFullscreen(t){this.isFullscreen||(this._pointerLockRequested=t,this._renderingCanvas&&i.tl(this._renderingCanvas))}exitFullscreen(){this.isFullscreen&&i.g7()}setDitheringState(t){t?this._gl.enable(this._gl.DITHER):this._gl.disable(this._gl.DITHER)}setRasterizerState(t){t?this._gl.disable(this._gl.RASTERIZER_DISCARD):this._gl.enable(this._gl.RASTERIZER_DISCARD)}setDirectViewport(t,K,D,a){const G=this._cachedViewport;return this._cachedViewport=null,this._viewport(t,K,D,a),G}scissorClear(t,K,D,a,G){this.enableScissor(t,K,D,a),this.clear(G,!0,!0,!0),this.disableScissor()}enableScissor(t,K,D,a){const G=this._gl;G.enable(G.SCISSOR_TEST),G.scissor(t,K,D,a)}disableScissor(){const t=this._gl;t.disable(t.SCISSOR_TEST)}_loadFileAsync(t,K,D){return new Promise(((a,G)=>{this._loadFile(t,(t=>{a(t)}),void 0,K,D,((t,K)=>{G(K)}))}))}getVertexShaderSource(t){const K=this._gl.getAttachedShaders(t);return K?this._gl.getShaderSource(K[0]):null}getFragmentShaderSource(t){const K=this._gl.getAttachedShaders(t);return K?this._gl.getShaderSource(K[1]):null}set framebufferDimensionsObject(t){this._framebufferDimensionsObject=t,this._framebufferDimensionsObject&&this.onResizeObservable.notifyObservers(this)}_rebuildBuffers(){for(const t of this.scenes)t.resetCachedMaterial(),t._rebuildGeometries();for(const t of this._virtualScenes)t.resetCachedMaterial(),t._rebuildGeometries();super._rebuildBuffers()}getFontOffset(t){return i.PR(t)}_cancelFrame(){if(this.customAnimationFrameRequester){if(0!==this._frameHandler){this._frameHandler=0;const{cancelAnimationFrame:t}=this.customAnimationFrameRequester;t&&t(this.customAnimationFrameRequester.requestID)}}else super._cancelFrame()}_renderLoop(){if(this._frameHandler=0,!this._contextWasLost){let t=!0;(this.isDisposed||!this.renderEvenInBackground&&this._windowIsBackground)&&(t=!1),t&&(this.beginFrame(),this._renderViews()||this._renderFrame(),this.endFrame())}this._activeRenderLoops.length>0&&0===this._frameHandler&&(this.customAnimationFrameRequester?(this.customAnimationFrameRequester.requestID=this._queueNewFrame(this.customAnimationFrameRequester.renderFunction||this._boundRenderFunction,this.customAnimationFrameRequester),this._frameHandler=this.customAnimationFrameRequester.requestID):this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()))}enterPointerlock(){this._renderingCanvas&&i.eG(this._renderingCanvas)}exitPointerlock(){i.rT()}beginFrame(){this._measureFps(),super.beginFrame()}_deletePipelineContext(t){const K=t;K&&K.program&&K.transformFeedback&&(this.deleteTransformFeedback(K.transformFeedback),K.transformFeedback=null),super._deletePipelineContext(t)}createShaderProgram(t,K,D,a,G,N=null){G=G||this._gl,this.onBeforeShaderCompilationObservable.notifyObservers(this);const W=super.createShaderProgram(t,K,D,a,G,N);return this.onAfterShaderCompilationObservable.notifyObservers(this),W}_createShaderProgram(t,K,D,a,G=null){const N=a.createProgram();if(t.program=N,!N)throw new Error("Unable to create program");if(a.attachShader(N,K),a.attachShader(N,D),this.webGLVersion>1&&G){const K=this.createTransformFeedback();this.bindTransformFeedback(K),this.setTranformFeedbackVaryings(N,G),t.transformFeedback=K}return a.linkProgram(N),this.webGLVersion>1&&G&&this.bindTransformFeedback(null),t.context=a,t.vertexShader=K,t.fragmentShader=D,t.isParallelCompiled||this._finalizePipelineContext(t),N}_releaseTexture(t){super._releaseTexture(t)}_releaseRenderTargetWrapper(t){super._releaseRenderTargetWrapper(t),this.scenes.forEach((K=>{K.postProcesses.forEach((K=>{K._outputTexture===t&&(K._outputTexture=null)})),K.cameras.forEach((K=>{K._postProcesses.forEach((K=>{K&&K._outputTexture===t&&(K._outputTexture=null)}))}))}))}_rescaleTexture(t,K,D,a,G){this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE);const N=this.createRenderTargetTexture({width:K.width,height:K.height},{generateMipMaps:!1,type:0,samplingMode:2,generateDepthBuffer:!1,generateStencilBuffer:!1});if(!this._rescalePostProcess&&I._RescalePostProcessFactory&&(this._rescalePostProcess=I._RescalePostProcessFactory(this)),this._rescalePostProcess){this._rescalePostProcess.externalTextureSamplerBinding=!0;const W=()=>{this._rescalePostProcess.onApply=function(K){K._bindTexture("textureSampler",t)};let W=D;W||(W=this.scenes[this.scenes.length-1]),W.postProcessManager.directRender([this._rescalePostProcess],N,!0),this._bindTextureDirectly(this._gl.TEXTURE_2D,K,!0),this._gl.copyTexImage2D(this._gl.TEXTURE_2D,0,a,0,0,K.width,K.height,0),this.unBindFramebuffer(N),N.dispose(),G&&G()},x=this._rescalePostProcess.getEffect();x?x.executeWhenCompiled(W):this._rescalePostProcess.onEffectCreatedObservable.addOnce((t=>{t.executeWhenCompiled(W)}))}}wrapWebGLTexture(t,K=!1,D=3,G=0,N=0){const W=new n.d(t,this._gl),x=new a.h(this,0,!0);return x._hardwareTexture=W,x.baseWidth=G,x.baseHeight=N,x.width=G,x.height=N,x.isReady=!0,x.useMipMaps=K,this.updateTextureSamplingMode(D,x),x}_uploadImageToTexture(t,K,D=0,a=0){const G=this._gl,N=this._getWebGLTextureType(t.type),W=this._getInternalFormat(t.format),x=this._getRGBABufferInternalSizedFormat(t.type,W),b=t.isCube?G.TEXTURE_CUBE_MAP:G.TEXTURE_2D;this._bindTextureDirectly(b,t,!0),this._unpackFlipY(t.invertY);let n=G.TEXTURE_2D;t.isCube&&(n=G.TEXTURE_CUBE_MAP_POSITIVE_X+D),G.texImage2D(n,a,x,W,N,K),this._bindTextureDirectly(b,null,!0)}updateTextureComparisonFunction(t,K){if(1===this.webGLVersion)return void b.V.Error("WebGL 1 does not support texture comparison.");const D=this._gl;t.isCube?(this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,t,!0),0===K?(D.texParameteri(D.TEXTURE_CUBE_MAP,D.TEXTURE_COMPARE_FUNC,515),D.texParameteri(D.TEXTURE_CUBE_MAP,D.TEXTURE_COMPARE_MODE,D.NONE)):(D.texParameteri(D.TEXTURE_CUBE_MAP,D.TEXTURE_COMPARE_FUNC,K),D.texParameteri(D.TEXTURE_CUBE_MAP,D.TEXTURE_COMPARE_MODE,D.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null)):(this._bindTextureDirectly(this._gl.TEXTURE_2D,t,!0),0===K?(D.texParameteri(D.TEXTURE_2D,D.TEXTURE_COMPARE_FUNC,515),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_COMPARE_MODE,D.NONE)):(D.texParameteri(D.TEXTURE_2D,D.TEXTURE_COMPARE_FUNC,K),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_COMPARE_MODE,D.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_2D,null)),t._comparisonFunction=K}createInstancesBuffer(t){const K=this._gl.createBuffer();if(!K)throw new Error("Unable to create instance buffer");const D=new x.A(K);return D.capacity=t,this.bindArrayBuffer(D),this._gl.bufferData(this._gl.ARRAY_BUFFER,t,this._gl.DYNAMIC_DRAW),D.references=1,D}deleteInstancesBuffer(t){this._gl.deleteBuffer(t)}_clientWaitAsync(t,K=0,D=10){const a=this._gl;return new Promise(((G,N)=>{const W=()=>{const x=a.clientWaitSync(t,K,0);x!=a.WAIT_FAILED?x!=a.TIMEOUT_EXPIRED?G():setTimeout(W,D):N()};W()}))}_readPixelsAsync(t,K,D,a,G,N,W){if(this._webGLVersion<2)throw new Error("_readPixelsAsync only work on WebGL2+");const x=this._gl,b=x.createBuffer();x.bindBuffer(x.PIXEL_PACK_BUFFER,b),x.bufferData(x.PIXEL_PACK_BUFFER,W.byteLength,x.STREAM_READ),x.readPixels(t,K,D,a,G,N,0),x.bindBuffer(x.PIXEL_PACK_BUFFER,null);const n=x.fenceSync(x.SYNC_GPU_COMMANDS_COMPLETE,0);return n?(x.flush(),this._clientWaitAsync(n,0,10).then((()=>(x.deleteSync(n),x.bindBuffer(x.PIXEL_PACK_BUFFER,b),x.getBufferSubData(x.PIXEL_PACK_BUFFER,0,W),x.bindBuffer(x.PIXEL_PACK_BUFFER,null),x.deleteBuffer(b),W)))):null}dispose(){this.hideLoadingUI(),this._rescalePostProcess&&this._rescalePostProcess.dispose(),i.kX(this,this._renderingCanvas),super.dispose()}}I.ALPHA_DISABLE=0,I.ALPHA_ADD=1,I.ALPHA_COMBINE=2,I.ALPHA_SUBTRACT=3,I.ALPHA_MULTIPLY=4,I.ALPHA_MAXIMIZED=5,I.ALPHA_ONEONE=6,I.ALPHA_PREMULTIPLIED=7,I.ALPHA_PREMULTIPLIED_PORTERDUFF=8,I.ALPHA_INTERPOLATE=9,I.ALPHA_SCREENMODE=10,I.DELAYLOADSTATE_NONE=0,I.DELAYLOADSTATE_LOADED=1,I.DELAYLOADSTATE_LOADING=2,I.DELAYLOADSTATE_NOTLOADED=4,I.NEVER=512,I.ALWAYS=519,I.LESS=513,I.EQUAL=514,I.LEQUAL=515,I.GREATER=516,I.GEQUAL=518,I.NOTEQUAL=517,I.KEEP=7680,I.REPLACE=7681,I.INCR=7682,I.DECR=7683,I.INVERT=5386,I.INCR_WRAP=34055,I.DECR_WRAP=34056,I.TEXTURE_CLAMP_ADDRESSMODE=0,I.TEXTURE_WRAP_ADDRESSMODE=1,I.TEXTURE_MIRROR_ADDRESSMODE=2,I.TEXTUREFORMAT_ALPHA=0,I.TEXTUREFORMAT_LUMINANCE=1,I.TEXTUREFORMAT_LUMINANCE_ALPHA=2,I.TEXTUREFORMAT_RGB=4,I.TEXTUREFORMAT_RGBA=5,I.TEXTUREFORMAT_RED=6,I.TEXTUREFORMAT_R=6,I.TEXTUREFORMAT_RG=7,I.TEXTUREFORMAT_RED_INTEGER=8,I.TEXTUREFORMAT_R_INTEGER=8,I.TEXTUREFORMAT_RG_INTEGER=9,I.TEXTUREFORMAT_RGB_INTEGER=10,I.TEXTUREFORMAT_RGBA_INTEGER=11,I.TEXTURETYPE_UNSIGNED_BYTE=0,I.TEXTURETYPE_UNSIGNED_INT=0,I.TEXTURETYPE_FLOAT=1,I.TEXTURETYPE_HALF_FLOAT=2,I.TEXTURETYPE_BYTE=3,I.TEXTURETYPE_SHORT=4,I.TEXTURETYPE_UNSIGNED_SHORT=5,I.TEXTURETYPE_INT=6,I.TEXTURETYPE_UNSIGNED_INTEGER=7,I.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8,I.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9,I.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10,I.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11,I.TEXTURETYPE_UNSIGNED_INT_24_8=12,I.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13,I.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14,I.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=15,I.TEXTURE_NEAREST_SAMPLINGMODE=1,I.TEXTURE_BILINEAR_SAMPLINGMODE=2,I.TEXTURE_TRILINEAR_SAMPLINGMODE=3,I.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8,I.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11,I.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3,I.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4,I.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5,I.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6,I.TEXTURE_NEAREST_LINEAR=7,I.TEXTURE_NEAREST_NEAREST=1,I.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9,I.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10,I.TEXTURE_LINEAR_LINEAR=2,I.TEXTURE_LINEAR_NEAREST=12,I.TEXTURE_EXPLICIT_MODE=0,I.TEXTURE_SPHERICAL_MODE=1,I.TEXTURE_PLANAR_MODE=2,I.TEXTURE_CUBIC_MODE=3,I.TEXTURE_PROJECTION_MODE=4,I.TEXTURE_SKYBOX_MODE=5,I.TEXTURE_INVCUBIC_MODE=6,I.TEXTURE_EQUIRECTANGULAR_MODE=7,I.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8,I.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,I.SCALEMODE_FLOOR=1,I.SCALEMODE_NEAREST=2,I.SCALEMODE_CEILING=3},395726:(t,K,D)=>{D.d(K,{q:()=>G});var a=D(638113);class G{static get LastCreatedEngine(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]}static get LastCreatedScene(){return this._LastCreatedScene}}G.Instances=[],G.OnEnginesDisposedObservable=new a.cP,G._LastCreatedScene=null,G.UseFallbackTexture=!0,G.FallbackTexture=""},155429:(t,K,D)=>{D.d(K,{I:()=>a});class a{static SetMatrixPrecision(t){if(a.MatrixTrackPrecisionChange=!1,t&&!a.MatrixUse64Bits&&a.MatrixTrackedMatrices)for(let t=0;t<a.MatrixTrackedMatrices.length;++t){const K=a.MatrixTrackedMatrices[t],D=K._m;K._m=new Array(16);for(let t=0;t<16;++t)K._m[t]=D[t]}a.MatrixUse64Bits=t,a.MatrixCurrentType=a.MatrixUse64Bits?Array:Float32Array,a.MatrixTrackedMatrices=null}}a.MatrixUse64Bits=!1,a.MatrixTrackPrecisionChange=!0,a.MatrixCurrentType=Float32Array,a.MatrixTrackedMatrices=[]},380245:(t,K,D)=>{D.d(K,{v:()=>a});class a{get depthStencilTexture(){return this._depthStencilTexture}get depthStencilTextureWithStencil(){return this._depthStencilTextureWithStencil}get isCube(){return this._isCube}get isMulti(){return this._isMulti}get is2DArray(){return this.layers>0}get is3D(){return this.depth>0}get size(){return this.width}get width(){return this._size.width||this._size}get height(){return this._size.height||this._size}get layers(){return this._size.layers||0}get depth(){return this._size.depth||0}get texture(){var t,K;return null!==(K=null===(t=this._textures)||void 0===t?void 0:t[0])&&void 0!==K?K:null}get textures(){return this._textures}get faceIndices(){return this._faceIndices}get layerIndices(){return this._layerIndices}get samples(){return this._samples}setSamples(t,K=!0,D=!1){if(this.samples===t&&!D)return t;const a=this._isMulti?this._engine.updateMultipleRenderTargetTextureSampleCount(this,t,K):this._engine.updateRenderTargetTextureSampleCount(this,t);return this._samples=t,a}constructor(t,K,D,a,G){this._textures=null,this._faceIndices=null,this._layerIndices=null,this._samples=1,this._attachments=null,this._generateStencilBuffer=!1,this._generateDepthBuffer=!1,this._depthStencilTextureWithStencil=!1,this._isMulti=t,this._isCube=K,this._size=D,this._engine=a,this._depthStencilTexture=null,this.label=G}setTextures(t){Array.isArray(t)?this._textures=t:this._textures=t?[t]:null}setTexture(t,K=0,D=!0){this._textures||(this._textures=[]),this._textures[K]!==t&&(this._textures[K]&&D&&this._textures[K].dispose(),this._textures[K]=t)}setLayerAndFaceIndices(t,K){this._layerIndices=t,this._faceIndices=K}setLayerAndFaceIndex(t=0,K,D){this._layerIndices||(this._layerIndices=[]),this._faceIndices||(this._faceIndices=[]),void 0!==K&&K>=0&&(this._layerIndices[t]=K),void 0!==D&&D>=0&&(this._faceIndices[t]=D)}createDepthStencilTexture(t=0,K=!0,D=!1,a=1,G=14,N){var W;return null===(W=this._depthStencilTexture)||void 0===W||W.dispose(),this._depthStencilTextureWithStencil=D,this._depthStencilTextureLabel=N,this._depthStencilTexture=this._engine.createDepthStencilTexture(this._size,{bilinearFiltering:K,comparisonFunction:t,generateStencil:D,isCube:this._isCube,samples:a,depthTextureFormat:G,label:N},this),this._depthStencilTexture}_shareDepth(t){this.shareDepth(t)}shareDepth(t){this._depthStencilTexture&&(t._depthStencilTexture&&t._depthStencilTexture.dispose(),t._depthStencilTexture=this._depthStencilTexture,t._depthStencilTextureWithStencil=this._depthStencilTextureWithStencil,this._depthStencilTexture.incrementReferences())}_swapAndDie(t){this.texture&&this.texture._swapAndDie(t),this._textures=null,this.dispose(!0)}_cloneRenderTargetWrapper(){var t,K,D,a,G,N,W,x;let b=null;if(this._isMulti){const D=this.textures;if(D&&D.length>0){let a=!1,G=D.length,N=-1;const W=D[D.length-1]._source;14!==W&&12!==W||(a=!0,N=D[D.length-1].format,G--);const x=[],n=[],e=[],i=[],z=[],I=[],Z=[],w={};for(let a=0;a<G;++a){const G=D[a];x.push(G.samplingMode),n.push(G.type),e.push(G.format),void 0!==w[G.uniqueId]?(i.push(-1),Z.push(0)):(w[G.uniqueId]=a,G.is2DArray?(i.push(35866),Z.push(G.depth)):G.isCube?(i.push(34067),Z.push(0)):G.is3D?(i.push(32879),Z.push(G.depth)):(i.push(3553),Z.push(0))),this._faceIndices&&z.push(null!==(t=this._faceIndices[a])&&void 0!==t?t:0),this._layerIndices&&I.push(null!==(K=this._layerIndices[a])&&void 0!==K?K:0)}const m={samplingModes:x,generateMipMaps:D[0].generateMipMaps,generateDepthBuffer:this._generateDepthBuffer,generateStencilBuffer:this._generateStencilBuffer,generateDepthTexture:a,depthTextureFormat:N,types:n,formats:e,textureCount:G,targetTypes:i,faceIndex:z,layerIndex:I,layerCounts:Z,label:this.label},u={width:this.width,height:this.height,depth:this.depth};b=this._engine.createMultipleRenderTarget(u,m);for(let t=0;t<G;++t){if(-1!==i[t])continue;const K=w[D[t].uniqueId];b.setTexture(b.textures[K],t)}}}else{const t={};if(t.generateDepthBuffer=this._generateDepthBuffer,t.generateMipMaps=null!==(a=null===(D=this.texture)||void 0===D?void 0:D.generateMipMaps)&&void 0!==a&&a,t.generateStencilBuffer=this._generateStencilBuffer,t.samplingMode=null===(G=this.texture)||void 0===G?void 0:G.samplingMode,t.type=null===(N=this.texture)||void 0===N?void 0:N.type,t.format=null===(W=this.texture)||void 0===W?void 0:W.format,t.noColorAttachment=!this._textures,t.label=this.label,this.isCube)b=this._engine.createRenderTargetCubeTexture(this.width,t);else{const K={width:this.width,height:this.height,layers:this.is2DArray||this.is3D?null===(x=this.texture)||void 0===x?void 0:x.depth:void 0};b=this._engine.createRenderTargetTexture(K,t)}b.texture&&(b.texture.isReady=!0)}return b}_swapRenderTargetWrapper(t){if(this._textures&&t._textures)for(let K=0;K<this._textures.length;++K)this._textures[K]._swapAndDie(t._textures[K],!1),t._textures[K].isReady=!0;this._depthStencilTexture&&t._depthStencilTexture&&(this._depthStencilTexture._swapAndDie(t._depthStencilTexture),t._depthStencilTexture.isReady=!0),this._textures=null,this._depthStencilTexture=null}_rebuild(){const t=this._cloneRenderTargetWrapper();if(t){if(this._depthStencilTexture){const K=this._depthStencilTexture.samplingMode,D=this._depthStencilTexture.format,a=2===K||3===K||11===K;t.createDepthStencilTexture(this._depthStencilTexture._comparisonFunction,a,this._depthStencilTextureWithStencil,this._depthStencilTexture.samples,D,this._depthStencilTextureLabel)}this.samples>1&&t.setSamples(this.samples),t._swapRenderTargetWrapper(this),t.dispose()}}releaseTextures(){var t,K;if(this._textures)for(let D=0;null!==(K=D<(null===(t=this._textures)||void 0===t?void 0:t.length))&&void 0!==K&&K;++D)this._textures[D].dispose();this._textures=null}dispose(t=!1){var K;t||(null===(K=this._depthStencilTexture)||void 0===K||K.dispose(),this._depthStencilTexture=null,this.releaseTextures()),this._engine._releaseRenderTargetWrapper(this)}}},395879:(t,K,D)=>{D.d(K,{l:()=>a});class a{static GetShadersRepository(t=0){return 0===t?a.ShadersRepository:a.ShadersRepositoryWGSL}static GetShadersStore(t=0){return 0===t?a.ShadersStore:a.ShadersStoreWGSL}static GetIncludesShadersStore(t=0){return 0===t?a.IncludesShadersStore:a.IncludesShadersStoreWGSL}}a.ShadersRepository="src/Shaders/",a.ShadersStore={},a.IncludesShadersStore={},a.ShadersRepositoryWGSL="src/ShadersWGSL/",a.ShadersStoreWGSL={},a.IncludesShadersStoreWGSL={}},712251:(t,K,D)=>{D.d(K,{C5:()=>u,Cm:()=>b,EX:()=>e,GX:()=>i,N5:()=>x,YM:()=>Z,bS:()=>d,kf:()=>n,tI:()=>z,tg:()=>I});var a=D(640785),G=D(45410);const N=new WeakMap,W={_webGLVersion:2,cachedPipelines:{}};function x(t){let K=N.get(t);if(!K){if(!t)return W;K={_webGLVersion:t.TEXTURE_BINDING_3D?2:1,_context:t,cachedPipelines:{}},N.set(t,K)}return K}function b(t){N.delete(t)}function n(t,K,D,a,G,N){var W;const b=x(a);return N||(N=null!==(W=b._createShaderProgramInjection)&&void 0!==W?W:z),N(t,m(K,"vertex",a,b._contextWasLost),m(D,"fragment",a,b._contextWasLost),a,G,b.validateShaderPrograms)}function e(t,K,D,a,G,N=null,W){var b;const n=x(G);W||(W=null!==(b=n._createShaderProgramInjection)&&void 0!==b?b:z);const e=n._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return W(t,w(K,"vertex",a,e,G,n._contextWasLost),w(D,"fragment",a,e,G,n._contextWasLost),G,N,n.validateShaderPrograms)}function i(t,K){const D=new a.x,G=x(t);return G.parallelShaderCompile&&(D.isParallelCompiled=!0),D.context=G._context,D}function z(t,K,D,a,G=null,N){const W=a.createProgram();if(t.program=W,!W)throw new Error("Unable to create program");return a.attachShader(W,K),a.attachShader(W,D),a.linkProgram(W),t.context=a,t.vertexShader=K,t.fragmentShader=D,t.isParallelCompiled||I(t,a,N),W}function I(t,K,D){const a=t.context,G=t.vertexShader,N=t.fragmentShader,W=t.program;if(!a.getProgramParameter(W,a.LINK_STATUS)){if(!K.getShaderParameter(G,K.COMPILE_STATUS)){const D=K.getShaderInfoLog(G);if(D)throw t.vertexCompilationError=D,new Error("VERTEX SHADER "+D)}if(!K.getShaderParameter(N,K.COMPILE_STATUS)){const D=K.getShaderInfoLog(N);if(D)throw t.fragmentCompilationError=D,new Error("FRAGMENT SHADER "+D)}const D=a.getProgramInfoLog(W);if(D)throw t.programLinkError=D,new Error(D)}if(D&&(a.validateProgram(W),!a.getProgramParameter(W,a.VALIDATE_STATUS))){const K=a.getProgramInfoLog(W);if(K)throw t.programValidationError=K,new Error(K)}a.deleteShader(G),a.deleteShader(N),t.vertexShader=void 0,t.fragmentShader=void 0,t.onCompiled&&(t.onCompiled(),t.onCompiled=void 0)}function Z(t,K,D,a,G,N,W,b,i,z="",I,Z,w){var m,u;const d=x(t.context);Z||(Z=null!==(m=d.createRawShaderProgramInjection)&&void 0!==m?m:n),w||(w=null!==(u=d.createShaderProgramInjection)&&void 0!==u?u:e);const E=t;E.program=a?Z(E,K,D,E.context,i):w(E,K,D,b,E.context,i),E.program.__SPECTOR_rebuildProgram=W,I()}function w(t,K,D,a,N,W){return m(G.iL(t,D,a),K,N,W)}function m(t,K,D,a){const G=D.createShader("vertex"===K?D.VERTEX_SHADER:D.FRAGMENT_SHADER);if(!G){let t=D.NO_ERROR,G=D.NO_ERROR;for(;(G=D.getError())!==D.NO_ERROR;)t=G;throw new Error(`Something went wrong while creating a gl ${K} shader object. gl error=${t}, gl isContextLost=${D.isContextLost()}, _contextWasLost=${a}`)}return D.shaderSource(G,t),D.compileShader(G),G}function u(t,K){K.useProgram(t)}function d(t,K){const D=t;if(!D.isParallelCompiled)return void K(t);const a=D.onCompiled;D.onCompiled=()=>{null==a||a(),K(t)}}},499251:(t,K,D)=>{D.d(K,{w:()=>d});var a=D(712251),G=D(163406),N=D(706400),W=D(394501);class x{constructor(){this.shaderLanguage=0}postProcessor(t,K,D,a,G){if(G.drawBuffersExtensionDisabled){const K=/#extension.+GL_EXT_draw_buffers.+(enable|require)/g;t=t.replace(K,"")}return t}}var b=D(874858),n=D(672506),e=D(104270),i=D(33321),z=D(380811),I=D(182453),Z=D(498083),w=D(45410),m=D(286648);class u{}class d extends i.${get name(){return this._name}set name(t){this._name=t}get version(){return this._webGLVersion}static get ShadersRepository(){return Z.M.ShadersRepository}static set ShadersRepository(t){Z.M.ShadersRepository=t}get supportsUniformBuffers(){return this.webGLVersion>1&&!this.disableUniformBuffers}get needPOTTextures(){return this._webGLVersion<2||this.forcePOTTextures}get _supportsHardwareTextureRescaling(){return!1}set framebufferDimensionsObject(t){this._framebufferDimensionsObject=t}snapshotRenderingReset(){this.snapshotRendering=!1}constructor(t,K,D,G){if(D=D||{},super(null!=K?K:D.antialias,D,G),this._name="WebGL",this.forcePOTTextures=!1,this.validateShaderPrograms=!1,this.disableUniformBuffers=!1,this._webGLVersion=1,this._vertexAttribArraysEnabled=[],this._uintIndicesCurrentlySet=!1,this._currentBoundBuffer=new Array,this._currentFramebuffer=null,this._dummyFramebuffer=null,this._currentBufferPointers=new Array,this._currentInstanceLocations=new Array,this._currentInstanceBuffers=new Array,this._vaoRecordInProgress=!1,this._mustWipeVertexAttributes=!1,this._nextFreeTextureSlots=new Array,this._maxSimultaneousTextures=0,this._maxMSAASamplesOverride=null,this._unpackFlipYCached=null,this.enableUnpackFlipYCached=!0,this._boundUniforms={},!t)return;let W=null;if(t.getContext){if(W=t,this._renderingCanvas=W,void 0===D.preserveDrawingBuffer&&(D.preserveDrawingBuffer=!1),void 0===D.xrCompatible&&(D.xrCompatible=!1),navigator&&navigator.userAgent){this._setupMobileChecks();const t=navigator.userAgent;for(const K of d.ExceptionList){const a=K.key,G=K.targets;if(new RegExp(a).test(t)){if(K.capture&&K.captureConstraint){const D=K.capture,a=K.captureConstraint,G=new RegExp(D).exec(t);if(G&&G.length>0&&parseInt(G[G.length-1])>=a)continue}for(const t of G)switch(t){case"uniformBuffer":this.disableUniformBuffers=!0;break;case"vao":this.disableVertexArrayObjects=!0;break;case"antialias":D.antialias=!1;break;case"maxMSAASamples":this._maxMSAASamplesOverride=1}}}}if(this._doNotHandleContextLost||(this._onContextLost=t=>{t.preventDefault(),this._contextWasLost=!0,N.V.Warn("WebGL context lost."),this.onContextLostObservable.notifyObservers(this)},this._onContextRestored=()=>{this._restoreEngineAfterContextLost((()=>this._initGLContext()))},W.addEventListener("webglcontextlost",this._onContextLost,!1),W.addEventListener("webglcontextrestored",this._onContextRestored,!1),D.powerPreference=D.powerPreference||"high-performance"),this._badDesktopOS&&(D.xrCompatible=!1),!D.disableWebGL2Support)try{this._gl=W.getContext("webgl2",D)||W.getContext("experimental-webgl2",D),this._gl&&(this._webGLVersion=2,this._shaderPlatformName="WEBGL2",this._gl.deleteQuery||(this._webGLVersion=1,this._shaderPlatformName="WEBGL1"))}catch(t){}if(!this._gl){if(!W)throw new Error("The provided canvas is null or undefined.");try{this._gl=W.getContext("webgl",D)||W.getContext("experimental-webgl",D)}catch(t){throw new Error("WebGL not supported")}}if(!this._gl)throw new Error("WebGL not supported")}else{this._gl=t,this._renderingCanvas=this._gl.canvas,this._gl.renderbufferStorageMultisample?(this._webGLVersion=2,this._shaderPlatformName="WEBGL2"):this._shaderPlatformName="WEBGL1";const K=this._gl.getContextAttributes();K&&(D.stencil=K.stencil)}this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),void 0!==D.useHighPrecisionFloats&&(this._highPrecisionShadersAllowed=D.useHighPrecisionFloats),this.resize(),this._initGLContext(),this._initFeatures();for(let t=0;t<this._caps.maxVertexAttribs;t++)this._currentBufferPointers[t]=new u;this._shaderProcessor=this.webGLVersion>1?new b.B:new x;const n=`Babylon.js v${d.Version}`;N.V.Log(n+` - ${this.description}`),this._renderingCanvas&&this._renderingCanvas.setAttribute&&this._renderingCanvas.setAttribute("data-engine",n);const e=a.N5(this._gl);e.validateShaderPrograms=this.validateShaderPrograms,e.parallelShaderCompile=this._caps.parallelShaderCompile}_clearEmptyResources(){this._dummyFramebuffer=null,super._clearEmptyResources()}_getShaderProcessingContext(t){return null}areAllEffectsReady(){for(const t in this._compiledEffects)if(!this._compiledEffects[t].isReady())return!1;return!0}_initGLContext(){var t;this._caps={maxTexturesImageUnits:this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),maxCombinedTexturesImageUnits:this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),maxVertexTextureImageUnits:this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),maxSamples:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_SAMPLES):1,maxCubemapTextureSize:this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),maxRenderTextureSize:this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),maxVertexAttribs:this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),maxVaryingVectors:this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),maxFragmentUniformVectors:this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),maxVertexUniformVectors:this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),parallelShaderCompile:this._gl.getExtension("KHR_parallel_shader_compile")||void 0,standardDerivatives:this._webGLVersion>1||null!==this._gl.getExtension("OES_standard_derivatives"),maxAnisotropy:1,astc:this._gl.getExtension("WEBGL_compressed_texture_astc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_astc"),bptc:this._gl.getExtension("EXT_texture_compression_bptc")||this._gl.getExtension("WEBKIT_EXT_texture_compression_bptc"),s3tc:this._gl.getExtension("WEBGL_compressed_texture_s3tc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),s3tc_srgb:this._gl.getExtension("WEBGL_compressed_texture_s3tc_srgb")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc_srgb"),pvrtc:this._gl.getExtension("WEBGL_compressed_texture_pvrtc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:this._gl.getExtension("WEBGL_compressed_texture_etc1")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),etc2:this._gl.getExtension("WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBGL_compressed_texture_es3_0"),textureAnisotropicFilterExtension:this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),uintIndices:this._webGLVersion>1||null!==this._gl.getExtension("OES_element_index_uint"),fragmentDepthSupported:this._webGLVersion>1||null!==this._gl.getExtension("EXT_frag_depth"),highPrecisionShaderSupported:!1,timerQuery:this._gl.getExtension("EXT_disjoint_timer_query_webgl2")||this._gl.getExtension("EXT_disjoint_timer_query"),supportOcclusionQuery:this._webGLVersion>1,canUseTimestampForTimerQuery:!1,drawBuffersExtension:!1,maxMSAASamples:1,colorBufferFloat:!!(this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_float")),supportFloatTexturesResolve:!1,rg11b10ufColorRenderable:!1,colorBufferHalfFloat:!!(this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_half_float")),textureFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_float")),textureHalfFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_half_float")),textureHalfFloatRender:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloatLinearFiltering:!1,vertexArrayObject:!1,instancedArrays:!1,textureLOD:!!(this._webGLVersion>1||this._gl.getExtension("EXT_shader_texture_lod")),texelFetch:1!==this._webGLVersion,blendMinMax:!1,multiview:this._gl.getExtension("OVR_multiview2"),oculusMultiview:this._gl.getExtension("OCULUS_multiview"),depthTextureExtension:!1,canUseGLInstanceID:this._webGLVersion>1,canUseGLVertexID:this._webGLVersion>1,supportComputeShaders:!1,supportSRGBBuffers:!1,supportTransformFeedbacks:this._webGLVersion>1,textureMaxLevel:this._webGLVersion>1,texture2DArrayMaxLayerCount:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_ARRAY_TEXTURE_LAYERS):128,disableMorphTargetTexture:!1},this._caps.supportFloatTexturesResolve=this._caps.colorBufferFloat,this._caps.rg11b10ufColorRenderable=this._caps.colorBufferFloat,this._glVersion=this._gl.getParameter(this._gl.VERSION);const K=this._gl.getExtension("WEBGL_debug_renderer_info");if(null!=K&&(this._glRenderer=this._gl.getParameter(K.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(K.UNMASKED_VENDOR_WEBGL)),this._glVendor||(this._glVendor=this._gl.getParameter(this._gl.VENDOR)||"Unknown vendor"),this._glRenderer||(this._glRenderer=this._gl.getParameter(this._gl.RENDERER)||"Unknown renderer"),36193!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=36193),34842!==this._gl.RGBA16F&&(this._gl.RGBA16F=34842),34836!==this._gl.RGBA32F&&(this._gl.RGBA32F=34836),35056!==this._gl.DEPTH24_STENCIL8&&(this._gl.DEPTH24_STENCIL8=35056),this._caps.timerQuery&&(1===this._webGLVersion&&(this._gl.getQuery=this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery)),this._caps.canUseTimestampForTimerQuery=(null!==(t=this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT,this._caps.timerQuery.QUERY_COUNTER_BITS_EXT))&&void 0!==t?t:0)>0),this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._caps.textureFloatLinearFiltering=!(!this._caps.textureFloat||!this._gl.getExtension("OES_texture_float_linear")),this._caps.textureFloatRender=!(!this._caps.textureFloat||!this._canRenderToFloatFramebuffer()),this._caps.textureHalfFloatLinearFiltering=!!(this._webGLVersion>1||this._caps.textureHalfFloat&&this._gl.getExtension("OES_texture_half_float_linear")),this._caps.astc&&(this._gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=this._caps.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR),this._caps.bptc&&(this._gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=this._caps.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT),this._caps.s3tc_srgb&&(this._gl.COMPRESSED_SRGB_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT),this._caps.etc2&&(this._gl.COMPRESSED_SRGB8_ETC2=this._caps.etc2.COMPRESSED_SRGB8_ETC2,this._gl.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=this._caps.etc2.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC),this._webGLVersion>1&&5131!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=5131),this._caps.textureHalfFloatRender=this._caps.textureHalfFloat&&this._canRenderToHalfFloatFramebuffer(),this._webGLVersion>1)this._caps.drawBuffersExtension=!0,this._caps.maxMSAASamples=null!==this._maxMSAASamplesOverride?this._maxMSAASamplesOverride:this._gl.getParameter(this._gl.MAX_SAMPLES);else{const t=this._gl.getExtension("WEBGL_draw_buffers");if(null!==t){this._caps.drawBuffersExtension=!0,this._gl.drawBuffers=t.drawBuffersWEBGL.bind(t),this._gl.DRAW_FRAMEBUFFER=this._gl.FRAMEBUFFER;for(let K=0;K<16;K++)this._gl["COLOR_ATTACHMENT"+K+"_WEBGL"]=t["COLOR_ATTACHMENT"+K+"_WEBGL"]}}if(this._webGLVersion>1)this._caps.depthTextureExtension=!0;else{const t=this._gl.getExtension("WEBGL_depth_texture");null!=t&&(this._caps.depthTextureExtension=!0,this._gl.UNSIGNED_INT_24_8=t.UNSIGNED_INT_24_8_WEBGL)}if(this.disableVertexArrayObjects)this._caps.vertexArrayObject=!1;else if(this._webGLVersion>1)this._caps.vertexArrayObject=!0;else{const t=this._gl.getExtension("OES_vertex_array_object");null!=t&&(this._caps.vertexArrayObject=!0,this._gl.createVertexArray=t.createVertexArrayOES.bind(t),this._gl.bindVertexArray=t.bindVertexArrayOES.bind(t),this._gl.deleteVertexArray=t.deleteVertexArrayOES.bind(t))}if(this._webGLVersion>1)this._caps.instancedArrays=!0;else{const t=this._gl.getExtension("ANGLE_instanced_arrays");null!=t?(this._caps.instancedArrays=!0,this._gl.drawArraysInstanced=t.drawArraysInstancedANGLE.bind(t),this._gl.drawElementsInstanced=t.drawElementsInstancedANGLE.bind(t),this._gl.vertexAttribDivisor=t.vertexAttribDivisorANGLE.bind(t)):this._caps.instancedArrays=!1}if(this._gl.getShaderPrecisionFormat){const t=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT),K=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT);t&&K&&(this._caps.highPrecisionShaderSupported=0!==t.precision&&0!==K.precision)}if(this._webGLVersion>1)this._caps.blendMinMax=!0;else{const t=this._gl.getExtension("EXT_blend_minmax");null!=t&&(this._caps.blendMinMax=!0,this._gl.MAX=t.MAX_EXT,this._gl.MIN=t.MIN_EXT)}if(!this._caps.supportSRGBBuffers){if(this._webGLVersion>1)this._caps.supportSRGBBuffers=!0,this._glSRGBExtensionValues={SRGB:WebGL2RenderingContext.SRGB,SRGB8:WebGL2RenderingContext.SRGB8,SRGB8_ALPHA8:WebGL2RenderingContext.SRGB8_ALPHA8};else{const t=this._gl.getExtension("EXT_sRGB");null!=t&&(this._caps.supportSRGBBuffers=!0,this._glSRGBExtensionValues={SRGB:t.SRGB_EXT,SRGB8:t.SRGB_ALPHA_EXT,SRGB8_ALPHA8:t.SRGB_ALPHA_EXT})}this._caps.supportSRGBBuffers=this._caps.supportSRGBBuffers&&!(!this._creationOptions||!this._creationOptions.forceSRGBBufferSupportState)}this._depthCullingState.depthTest=!0,this._depthCullingState.depthFunc=this._gl.LEQUAL,this._depthCullingState.depthMask=!0,this._maxSimultaneousTextures=this._caps.maxCombinedTexturesImageUnits;for(let t=0;t<this._maxSimultaneousTextures;t++)this._nextFreeTextureSlots.push(t);"Mali-G72"===this._glRenderer&&(this._caps.disableMorphTargetTexture=!0)}_initFeatures(){this._features={forceBitmapOverHTMLImageElement:"undefined"==typeof HTMLImageElement,supportRenderAndCopyToLodForFloatTextures:1!==this._webGLVersion,supportDepthStencilTexture:1!==this._webGLVersion,supportShadowSamplers:1!==this._webGLVersion,uniformBufferHardCheckMatrix:!1,allowTexturePrefiltering:1!==this._webGLVersion,trackUbosInFrame:!1,checkUbosContentBeforeUpload:!1,supportCSM:1!==this._webGLVersion,basisNeedsPOT:1===this._webGLVersion,support3DTextures:1!==this._webGLVersion,needTypeSuffixInShaderConstants:1!==this._webGLVersion,supportMSAA:1!==this._webGLVersion,supportSSAO2:1!==this._webGLVersion,supportIBLShadows:1!==this._webGLVersion,supportExtendedTextureFormats:1!==this._webGLVersion,supportSwitchCaseInShader:1!==this._webGLVersion,supportSyncTextureRead:!0,needsInvertingBitmap:!0,useUBOBindingCache:!0,needShaderCodeInlining:!1,needToAlwaysBindUniformBuffers:!1,supportRenderPasses:!1,supportSpriteInstancing:!0,forceVertexBufferStrideAndOffsetMultiple4Bytes:!1,_checkNonFloatVertexBuffersDontRecreatePipelineContext:!1,_collectUbosUpdatedInFrame:!1}}get webGLVersion(){return this._webGLVersion}getClassName(){return"ThinEngine"}_prepareWorkingCanvas(){if(this._workingCanvas)return;this._workingCanvas=this.createCanvas(1,1);const t=this._workingCanvas.getContext("2d");t&&(this._workingContext=t)}getInfo(){return this.getGlInfo()}getGlInfo(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}}extractDriverInfo(){const t=this.getGlInfo();return t&&t.renderer?t.renderer:""}getRenderWidth(t=!1){return!t&&this._currentRenderTarget?this._currentRenderTarget.width:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferWidth:this._gl.drawingBufferWidth}getRenderHeight(t=!1){return!t&&this._currentRenderTarget?this._currentRenderTarget.height:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferHeight:this._gl.drawingBufferHeight}clear(t,K,D,a=!1){var G,N;const W=this.stencilStateComposer.useStencilGlobalOnly;this.stencilStateComposer.useStencilGlobalOnly=!0,this.applyStates(),this.stencilStateComposer.useStencilGlobalOnly=W;let x=0;if(K&&t){let K=!0;if(this._currentRenderTarget){const D=null===(G=this._currentRenderTarget.texture)||void 0===G?void 0:G.format;if(8===D||9===D||10===D||11===D){const D=null===(N=this._currentRenderTarget.texture)||void 0===N?void 0:N.type;7===D||5===D?(d._TempClearColorUint32[0]=255*t.r,d._TempClearColorUint32[1]=255*t.g,d._TempClearColorUint32[2]=255*t.b,d._TempClearColorUint32[3]=255*t.a,this._gl.clearBufferuiv(this._gl.COLOR,0,d._TempClearColorUint32),K=!1):(d._TempClearColorInt32[0]=255*t.r,d._TempClearColorInt32[1]=255*t.g,d._TempClearColorInt32[2]=255*t.b,d._TempClearColorInt32[3]=255*t.a,this._gl.clearBufferiv(this._gl.COLOR,0,d._TempClearColorInt32),K=!1)}}K&&(this._gl.clearColor(t.r,t.g,t.b,void 0!==t.a?t.a:1),x|=this._gl.COLOR_BUFFER_BIT)}D&&(this.useReverseDepthBuffer?(this._depthCullingState.depthFunc=this._gl.GEQUAL,this._gl.clearDepth(0)):this._gl.clearDepth(1),x|=this._gl.DEPTH_BUFFER_BIT),a&&(this._gl.clearStencil(0),x|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(x)}_viewport(t,K,D,a){t===this._viewportCached.x&&K===this._viewportCached.y&&D===this._viewportCached.z&&a===this._viewportCached.w||(this._viewportCached.x=t,this._viewportCached.y=K,this._viewportCached.z=D,this._viewportCached.w=a,this._gl.viewport(t,K,D,a))}endFrame(){super.endFrame(),this._badOS&&this.flushFramebuffer()}get performanceMonitor(){throw new Error("Not Supported by ThinEngine")}bindFramebuffer(t,K=0,D,a,G,W=0,x=0){var b,n,e,i,z,I;const Z=t;this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget),this._currentRenderTarget=t,this._bindUnboundFramebuffer(Z._framebuffer);const w=this._gl;t.isMulti||(t.is2DArray||t.is3D?(w.framebufferTextureLayer(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,null===(b=t.texture._hardwareTexture)||void 0===b?void 0:b.underlyingResource,W,x),Z._currentLOD=W):t.isCube?w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+K,null===(n=t.texture._hardwareTexture)||void 0===n?void 0:n.underlyingResource,W):Z._currentLOD!==W&&(w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_2D,null===(e=t.texture._hardwareTexture)||void 0===e?void 0:e.underlyingResource,W),Z._currentLOD=W));const m=t._depthStencilTexture;if(m){t.is3D&&(t.texture.width===m.width&&t.texture.height===m.height&&t.texture.depth===m.depth||N.V.Warn("Depth/Stencil attachment for 3D target must have same dimensions as color attachment"));const D=t._depthStencilTextureWithStencil?w.DEPTH_STENCIL_ATTACHMENT:w.DEPTH_ATTACHMENT;t.is2DArray||t.is3D?w.framebufferTextureLayer(w.FRAMEBUFFER,D,null===(i=m._hardwareTexture)||void 0===i?void 0:i.underlyingResource,W,x):t.isCube?w.framebufferTexture2D(w.FRAMEBUFFER,D,w.TEXTURE_CUBE_MAP_POSITIVE_X+K,null===(z=m._hardwareTexture)||void 0===z?void 0:z.underlyingResource,W):w.framebufferTexture2D(w.FRAMEBUFFER,D,w.TEXTURE_2D,null===(I=m._hardwareTexture)||void 0===I?void 0:I.underlyingResource,W)}Z._MSAAFramebuffer&&this._bindUnboundFramebuffer(Z._MSAAFramebuffer),this._cachedViewport&&!G?this.setViewport(this._cachedViewport,D,a):(D||(D=t.width,W&&(D/=Math.pow(2,W))),a||(a=t.height,W&&(a/=Math.pow(2,W))),this._viewport(0,0,D,a)),this.wipeCaches()}setState(t,K=0,D,a=!1,G,N,W=0){var x,b;(this._depthCullingState.cull!==t||D)&&(this._depthCullingState.cull=t);const n=null===(b=null!==(x=this.cullBackFaces)&&void 0!==x?x:G)||void 0===b||b?this._gl.BACK:this._gl.FRONT;(this._depthCullingState.cullFace!==n||D)&&(this._depthCullingState.cullFace=n),this.setZOffset(K),this.setZOffsetUnits(W);const e=a?this._gl.CW:this._gl.CCW;(this._depthCullingState.frontFace!==e||D)&&(this._depthCullingState.frontFace=e),this._stencilStateComposer.stencilMaterial=N}_bindUnboundFramebuffer(t){this._currentFramebuffer!==t&&(this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,t),this._currentFramebuffer=t)}_currentFrameBufferIsDefaultFrameBuffer(){return null===this._currentFramebuffer}generateMipmaps(t){const K=this._getTextureTarget(t);this._bindTextureDirectly(K,t,!0),this._gl.generateMipmap(K),this._bindTextureDirectly(K,null)}unBindFramebuffer(t,K=!1,D){var a;const G=t;this._currentRenderTarget=null;const N=this._gl;if(G._MSAAFramebuffer){if(t.isMulti)return void this.unBindMultiColorAttachmentFramebuffer(t,K,D);N.bindFramebuffer(N.READ_FRAMEBUFFER,G._MSAAFramebuffer),N.bindFramebuffer(N.DRAW_FRAMEBUFFER,G._framebuffer),N.blitFramebuffer(0,0,t.width,t.height,0,0,t.width,t.height,N.COLOR_BUFFER_BIT,N.NEAREST)}!(null===(a=t.texture)||void 0===a?void 0:a.generateMipMaps)||K||t.isCube||this.generateMipmaps(t.texture),D&&(G._MSAAFramebuffer&&this._bindUnboundFramebuffer(G._framebuffer),D()),this._bindUnboundFramebuffer(null)}flushFramebuffer(){this._gl.flush()}restoreDefaultFramebuffer(){this._currentRenderTarget?this.unBindFramebuffer(this._currentRenderTarget):this._bindUnboundFramebuffer(null),this._cachedViewport&&this.setViewport(this._cachedViewport),this.wipeCaches()}_resetVertexBufferBinding(){this.bindArrayBuffer(null),this._cachedVertexBuffers=null}createVertexBuffer(t,K,D){return this._createVertexBuffer(t,this._gl.STATIC_DRAW)}_createVertexBuffer(t,K){const D=this._gl.createBuffer();if(!D)throw new Error("Unable to create vertex buffer");const a=new n.A(D);return this.bindArrayBuffer(a),"number"!=typeof t?t instanceof Array?(this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(t),K),a.capacity=4*t.length):(this._gl.bufferData(this._gl.ARRAY_BUFFER,t,K),a.capacity=t.byteLength):(this._gl.bufferData(this._gl.ARRAY_BUFFER,new Uint8Array(t),K),a.capacity=t),this._resetVertexBufferBinding(),a.references=1,a}createDynamicVertexBuffer(t,K){return this._createVertexBuffer(t,this._gl.DYNAMIC_DRAW)}_resetIndexBufferBinding(){this.bindIndexBuffer(null),this._cachedIndexBuffer=null}createIndexBuffer(t,K,D){const a=this._gl.createBuffer(),G=new n.A(a);if(!a)throw new Error("Unable to create index buffer");this.bindIndexBuffer(G);const N=this._normalizeIndexData(t);return this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,N,K?this._gl.DYNAMIC_DRAW:this._gl.STATIC_DRAW),this._resetIndexBufferBinding(),G.references=1,G.is32Bits=4===N.BYTES_PER_ELEMENT,G}_normalizeIndexData(t){if(2===t.BYTES_PER_ELEMENT)return t;if(this._caps.uintIndices){if(t instanceof Uint32Array)return t;for(let K=0;K<t.length;K++)if(t[K]>=65535)return new Uint32Array(t);return new Uint16Array(t)}return new Uint16Array(t)}bindArrayBuffer(t){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(t,this._gl.ARRAY_BUFFER)}bindUniformBlock(t,K,D){const a=t.program,G=this._gl.getUniformBlockIndex(a,K);this._gl.uniformBlockBinding(a,G,D)}bindIndexBuffer(t){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(t,this._gl.ELEMENT_ARRAY_BUFFER)}_bindBuffer(t,K){(this._vaoRecordInProgress||this._currentBoundBuffer[K]!==t)&&(this._gl.bindBuffer(K,t?t.underlyingResource:null),this._currentBoundBuffer[K]=t)}updateArrayBuffer(t){this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t)}_vertexAttribPointer(t,K,D,a,G,N,W){const x=this._currentBufferPointers[K];if(!x)return;let b=!1;x.active?(x.buffer!==t&&(x.buffer=t,b=!0),x.size!==D&&(x.size=D,b=!0),x.type!==a&&(x.type=a,b=!0),x.normalized!==G&&(x.normalized=G,b=!0),x.stride!==N&&(x.stride=N,b=!0),x.offset!==W&&(x.offset=W,b=!0)):(b=!0,x.active=!0,x.index=K,x.size=D,x.type=a,x.normalized=G,x.stride=N,x.offset=W,x.buffer=t),(b||this._vaoRecordInProgress)&&(this.bindArrayBuffer(t),a===this._gl.UNSIGNED_INT||a===this._gl.INT?this._gl.vertexAttribIPointer(K,D,a,N,W):this._gl.vertexAttribPointer(K,D,a,G,N,W))}_bindIndexBufferWithCache(t){null!=t&&this._cachedIndexBuffer!==t&&(this._cachedIndexBuffer=t,this.bindIndexBuffer(t),this._uintIndicesCurrentlySet=t.is32Bits)}_bindVertexBuffersAttributes(t,K,D){const a=K.getAttributesNames();this._vaoRecordInProgress||this._unbindVertexArrayObject(),this.unbindAllAttributes();for(let G=0;G<a.length;G++){const N=K.getAttributeLocation(G);if(N>=0){const K=a[G];let W=null;if(D&&(W=D[K]),W||(W=t[K]),!W)continue;this._gl.enableVertexAttribArray(N),this._vaoRecordInProgress||(this._vertexAttribArraysEnabled[N]=!0);const x=W.getBuffer();x&&(this._vertexAttribPointer(x,N,W.getSize(),W.type,W.normalized,W.byteStride,W.byteOffset),W.getIsInstanced()&&(this._gl.vertexAttribDivisor(N,W.getInstanceDivisor()),this._vaoRecordInProgress||(this._currentInstanceLocations.push(N),this._currentInstanceBuffers.push(x))))}}}recordVertexArrayObject(t,K,D,a){const G=this._gl.createVertexArray();if(!G)throw new Error("Unable to create VAO");return this._vaoRecordInProgress=!0,this._gl.bindVertexArray(G),this._mustWipeVertexAttributes=!0,this._bindVertexBuffersAttributes(t,D,a),this.bindIndexBuffer(K),this._vaoRecordInProgress=!1,this._gl.bindVertexArray(null),G}bindVertexArrayObject(t,K){this._cachedVertexArrayObject!==t&&(this._cachedVertexArrayObject=t,this._gl.bindVertexArray(t),this._cachedVertexBuffers=null,this._cachedIndexBuffer=null,this._uintIndicesCurrentlySet=null!=K&&K.is32Bits,this._mustWipeVertexAttributes=!0)}bindBuffersDirectly(t,K,D,a,G){if(this._cachedVertexBuffers!==t||this._cachedEffectForVertexBuffers!==G){this._cachedVertexBuffers=t,this._cachedEffectForVertexBuffers=G;const K=G.getAttributesCount();this._unbindVertexArrayObject(),this.unbindAllAttributes();let N=0;for(let W=0;W<K;W++)if(W<D.length){const K=G.getAttributeLocation(W);K>=0&&(this._gl.enableVertexAttribArray(K),this._vertexAttribArraysEnabled[K]=!0,this._vertexAttribPointer(t,K,D[W],this._gl.FLOAT,!1,a,N)),N+=4*D[W]}}this._bindIndexBufferWithCache(K)}_unbindVertexArrayObject(){this._cachedVertexArrayObject&&(this._cachedVertexArrayObject=null,this._gl.bindVertexArray(null))}bindBuffers(t,K,D,a){this._cachedVertexBuffers===t&&this._cachedEffectForVertexBuffers===D||(this._cachedVertexBuffers=t,this._cachedEffectForVertexBuffers=D,this._bindVertexBuffersAttributes(t,D,a)),this._bindIndexBufferWithCache(K)}unbindInstanceAttributes(){let t;for(let K=0,D=this._currentInstanceLocations.length;K<D;K++){const D=this._currentInstanceBuffers[K];t!=D&&D.references&&(t=D,this.bindArrayBuffer(D));const a=this._currentInstanceLocations[K];this._gl.vertexAttribDivisor(a,0)}this._currentInstanceBuffers.length=0,this._currentInstanceLocations.length=0}releaseVertexArrayObject(t){this._gl.deleteVertexArray(t)}_releaseBuffer(t){return t.references--,0===t.references&&(this._deleteBuffer(t),!0)}_deleteBuffer(t){this._gl.deleteBuffer(t.underlyingResource)}updateAndBindInstancesBuffer(t,K,D){if(this.bindArrayBuffer(t),K&&this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,K),void 0!==D[0].index)this.bindInstancesBuffer(t,D,!0);else for(let K=0;K<4;K++){const a=D[K];this._vertexAttribArraysEnabled[a]||(this._gl.enableVertexAttribArray(a),this._vertexAttribArraysEnabled[a]=!0),this._vertexAttribPointer(t,a,4,this._gl.FLOAT,!1,64,16*K),this._gl.vertexAttribDivisor(a,1),this._currentInstanceLocations.push(a),this._currentInstanceBuffers.push(t)}}bindInstancesBuffer(t,K,D=!0){this.bindArrayBuffer(t);let a=0;if(D)for(let t=0;t<K.length;t++)a+=4*K[t].attributeSize;for(let D=0;D<K.length;D++){const G=K[D];void 0===G.index&&(G.index=this._currentEffect.getAttributeLocationByName(G.attributeName)),G.index<0||(this._vertexAttribArraysEnabled[G.index]||(this._gl.enableVertexAttribArray(G.index),this._vertexAttribArraysEnabled[G.index]=!0),this._vertexAttribPointer(t,G.index,G.attributeSize,G.attributeType||this._gl.FLOAT,G.normalized||!1,a,G.offset),this._gl.vertexAttribDivisor(G.index,void 0===G.divisor?1:G.divisor),this._currentInstanceLocations.push(G.index),this._currentInstanceBuffers.push(t))}}disableInstanceAttributeByName(t){if(!this._currentEffect)return;const K=this._currentEffect.getAttributeLocationByName(t);this.disableInstanceAttribute(K)}disableInstanceAttribute(t){let K,D=!1;for(;-1!==(K=this._currentInstanceLocations.indexOf(t));)this._currentInstanceLocations.splice(K,1),this._currentInstanceBuffers.splice(K,1),D=!0,K=this._currentInstanceLocations.indexOf(t);D&&(this._gl.vertexAttribDivisor(t,0),this.disableAttributeByIndex(t))}disableAttributeByIndex(t){this._gl.disableVertexAttribArray(t),this._vertexAttribArraysEnabled[t]=!1,this._currentBufferPointers[t].active=!1}draw(t,K,D,a){this.drawElementsType(t?0:1,K,D,a)}drawPointClouds(t,K,D){this.drawArraysType(2,t,K,D)}drawUnIndexed(t,K,D,a){this.drawArraysType(t?0:1,K,D,a)}drawElementsType(t,K,D,a){this.applyStates(),this._reportDrawCall();const G=this._drawMode(t),N=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,W=this._uintIndicesCurrentlySet?4:2;a?this._gl.drawElementsInstanced(G,D,N,K*W,a):this._gl.drawElements(G,D,N,K*W)}drawArraysType(t,K,D,a){this.applyStates(),this._reportDrawCall();const G=this._drawMode(t);a?this._gl.drawArraysInstanced(G,K,D,a):this._gl.drawArrays(G,K,D)}_drawMode(t){switch(t){case 0:default:return this._gl.TRIANGLES;case 2:case 3:return this._gl.POINTS;case 1:case 4:return this._gl.LINES;case 5:return this._gl.LINE_LOOP;case 6:return this._gl.LINE_STRIP;case 7:return this._gl.TRIANGLE_STRIP;case 8:return this._gl.TRIANGLE_FAN}}_releaseEffect(t){this._compiledEffects[t._key]&&delete this._compiledEffects[t._key];const K=t.getPipelineContext();K&&this._deletePipelineContext(K)}_deletePipelineContext(t){const K=t;K&&K.program&&(K.program.__SPECTOR_rebuildProgram=null,m.mO(K),this._gl.deleteProgram(K.program))}_getGlobalDefines(t){return w.xt(t,this.isNDCHalfZRange,this.useReverseDepthBuffer,this.useExactSrgbConversions)}createEffect(t,K,D,G,N,W,x,b,n,e=0,i){var z,I,w;const m="string"==typeof t?t:t.vertexToken||t.vertexSource||t.vertexElement||t.vertex,u="string"==typeof t?t:t.fragmentToken||t.fragmentSource||t.fragmentElement||t.fragment,d=this._getGlobalDefines();let E=null!==(z=null!=N?N:K.defines)&&void 0!==z?z:"";d&&(E+=d);const l=m+"+"+u+"@"+E;if(this._compiledEffects[l]){const t=this._compiledEffects[l];return x&&t.isReady()&&x(t),t._refCount++,t}this._gl&&a.N5(this._gl);const Q=new Z.M(t,K,D,G,this,N,W,x,b,n,l,null!==(I=K.shaderLanguage)&&void 0!==I?I:e,null!==(w=K.extraInitializationsAsync)&&void 0!==w?w:i);return this._compiledEffects[l]=Q,Q}_getShaderSource(t){return this._gl.getShaderSource(t)}createRawShaderProgram(t,K,D,G,N=null){const W=a.N5(this._gl);return W._contextWasLost=this._contextWasLost,W.validateShaderPrograms=this.validateShaderPrograms,a.kf(t,K,D,G||this._gl,N)}createShaderProgram(t,K,D,G,N,W=null){const x=a.N5(this._gl);return x._contextWasLost=this._contextWasLost,x.validateShaderPrograms=this.validateShaderPrograms,a.EX(t,K,D,G,N||this._gl,W)}inlineShaderCode(t){return t}createPipelineContext(t){this._gl&&(a.N5(this._gl).parallelShaderCompile=this._caps.parallelShaderCompile);const K=a.GX(this._gl,t);return K.engine=this,K}createMaterialContext(){}createDrawContext(){}_finalizePipelineContext(t){return a.tg(t,this._gl,this.validateShaderPrograms)}_preparePipelineContext(t,K,D,G,N,W,x,b,n,e,i){const z=a.N5(this._gl);return z._contextWasLost=this._contextWasLost,z.validateShaderPrograms=this.validateShaderPrograms,z._createShaderProgramInjection=this._createShaderProgram.bind(this),z.createRawShaderProgramInjection=this.createRawShaderProgram.bind(this),z.createShaderProgramInjection=this.createShaderProgram.bind(this),z.loadFileInjection=this._loadFile.bind(this),a.YM(t,K,D,G,N,W,x,b,n,e,i)}_createShaderProgram(t,K,D,G,N=null){return a.tI(t,K,D,G,N)}_isRenderingStateCompiled(t){const K=t;return!(this._isDisposed||K._isDisposed||!this._gl.getProgramParameter(K.program,this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)||(this._finalizePipelineContext(K),0))}_executeWhenRenderingStateIsCompiled(t,K){a.bS(t,K)}getUniforms(t,K){const D=new Array,a=t;for(let t=0;t<K.length;t++)D.push(this._gl.getUniformLocation(a.program,K[t]));return D}getAttributes(t,K){const D=[],a=t;for(let t=0;t<K.length;t++)try{D.push(this._gl.getAttribLocation(a.program,K[t]))}catch(t){D.push(-1)}return D}enableEffect(t){(t=null!==t&&G.E(t)?t.effect:t)&&t!==this._currentEffect&&(this._stencilStateComposer.stencilMaterial=void 0,this.bindSamplers(t),this._currentEffect=t,t.onBind&&t.onBind(t),t._onBindObservable&&t._onBindObservable.notifyObservers(t))}setInt(t,K){return!!t&&(this._gl.uniform1i(t,K),!0)}setInt2(t,K,D){return!!t&&(this._gl.uniform2i(t,K,D),!0)}setInt3(t,K,D,a){return!!t&&(this._gl.uniform3i(t,K,D,a),!0)}setInt4(t,K,D,a,G){return!!t&&(this._gl.uniform4i(t,K,D,a,G),!0)}setIntArray(t,K){return!!t&&(this._gl.uniform1iv(t,K),!0)}setIntArray2(t,K){return!(!t||K.length%2!=0||(this._gl.uniform2iv(t,K),0))}setIntArray3(t,K){return!(!t||K.length%3!=0||(this._gl.uniform3iv(t,K),0))}setIntArray4(t,K){return!(!t||K.length%4!=0||(this._gl.uniform4iv(t,K),0))}setUInt(t,K){return!!t&&(this._gl.uniform1ui(t,K),!0)}setUInt2(t,K,D){return!!t&&(this._gl.uniform2ui(t,K,D),!0)}setUInt3(t,K,D,a){return!!t&&(this._gl.uniform3ui(t,K,D,a),!0)}setUInt4(t,K,D,a,G){return!!t&&(this._gl.uniform4ui(t,K,D,a,G),!0)}setUIntArray(t,K){return!!t&&(this._gl.uniform1uiv(t,K),!0)}setUIntArray2(t,K){return!(!t||K.length%2!=0||(this._gl.uniform2uiv(t,K),0))}setUIntArray3(t,K){return!(!t||K.length%3!=0||(this._gl.uniform3uiv(t,K),0))}setUIntArray4(t,K){return!(!t||K.length%4!=0||(this._gl.uniform4uiv(t,K),0))}setArray(t,K){return!(!t||K.length<1||(this._gl.uniform1fv(t,K),0))}setArray2(t,K){return!(!t||K.length%2!=0||(this._gl.uniform2fv(t,K),0))}setArray3(t,K){return!(!t||K.length%3!=0||(this._gl.uniform3fv(t,K),0))}setArray4(t,K){return!(!t||K.length%4!=0||(this._gl.uniform4fv(t,K),0))}setMatrices(t,K){return!!t&&(this._gl.uniformMatrix4fv(t,!1,K),!0)}setMatrix3x3(t,K){return!!t&&(this._gl.uniformMatrix3fv(t,!1,K),!0)}setMatrix2x2(t,K){return!!t&&(this._gl.uniformMatrix2fv(t,!1,K),!0)}setFloat(t,K){return!!t&&(this._gl.uniform1f(t,K),!0)}setFloat2(t,K,D){return!!t&&(this._gl.uniform2f(t,K,D),!0)}setFloat3(t,K,D,a){return!!t&&(this._gl.uniform3f(t,K,D,a),!0)}setFloat4(t,K,D,a,G){return!!t&&(this._gl.uniform4f(t,K,D,a,G),!0)}applyStates(){if(this._depthCullingState.apply(this._gl),this._stencilStateComposer.apply(this._gl),this._alphaState.apply(this._gl),this._colorWriteChanged){this._colorWriteChanged=!1;const t=this._colorWrite;this._gl.colorMask(t,t,t,t)}}wipeCaches(t){this.preventCacheWipeBetweenFrames&&!t||(this._currentEffect=null,this._viewportCached.x=0,this._viewportCached.y=0,this._viewportCached.z=0,this._viewportCached.w=0,this._unbindVertexArrayObject(),t&&(this._currentProgram=null,this.resetTextureCache(),this._stencilStateComposer.reset(),this._depthCullingState.reset(),this._depthCullingState.depthFunc=this._gl.LEQUAL,this._alphaState.reset(),this._alphaMode=1,this._alphaEquation=0,this._colorWrite=!0,this._colorWriteChanged=!0,this._unpackFlipYCached=null,this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),this._mustWipeVertexAttributes=!0,this.unbindAllAttributes()),this._resetVertexBufferBinding(),this._cachedIndexBuffer=null,this._cachedEffectForVertexBuffers=null,this.bindIndexBuffer(null))}_getSamplingParameters(t,K){const D=this._gl;let a=D.NEAREST,G=D.NEAREST;switch(t){case 11:a=D.LINEAR,G=K?D.LINEAR_MIPMAP_NEAREST:D.LINEAR;break;case 3:a=D.LINEAR,G=K?D.LINEAR_MIPMAP_LINEAR:D.LINEAR;break;case 8:a=D.NEAREST,G=K?D.NEAREST_MIPMAP_LINEAR:D.NEAREST;break;case 4:a=D.NEAREST,G=K?D.NEAREST_MIPMAP_NEAREST:D.NEAREST;break;case 5:a=D.NEAREST,G=K?D.LINEAR_MIPMAP_NEAREST:D.LINEAR;break;case 6:a=D.NEAREST,G=K?D.LINEAR_MIPMAP_LINEAR:D.LINEAR;break;case 7:a=D.NEAREST,G=D.LINEAR;break;case 1:a=D.NEAREST,G=D.NEAREST;break;case 9:a=D.LINEAR,G=K?D.NEAREST_MIPMAP_NEAREST:D.NEAREST;break;case 10:a=D.LINEAR,G=K?D.NEAREST_MIPMAP_LINEAR:D.NEAREST;break;case 2:a=D.LINEAR,G=D.LINEAR;break;case 12:a=D.LINEAR,G=D.NEAREST}return{min:G,mag:a}}_createTexture(){const t=this._gl.createTexture();if(!t)throw new Error("Unable to create texture");return t}_createHardwareTexture(){return new z.d(this._createTexture(),this._gl)}_createInternalTexture(t,K,D=!0,a=0){var G;let W,x=!1,b=0,n=3,e=5,i=!1,z=1;void 0!==K&&"object"==typeof K?(x=!!K.generateMipMaps,b=void 0===K.type?0:K.type,n=void 0===K.samplingMode?3:K.samplingMode,e=void 0===K.format?5:K.format,i=void 0!==K.useSRGBBuffer&&K.useSRGBBuffer,z=null!==(G=K.samples)&&void 0!==G?G:1,W=K.label):x=!!K,i&&(i=this._caps.supportSRGBBuffers&&(this.webGLVersion>1||this.isWebGPU)),(1!==b||this._caps.textureFloatLinearFiltering)&&(2!==b||this._caps.textureHalfFloatLinearFiltering)||(n=1),1!==b||this._caps.textureFloat||(b=0,N.V.Warn("Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE"));const Z=this._gl,w=new I.h(this,a),m=t.width||t,u=t.height||t,d=t.depth||0,E=t.layers||0,l=this._getSamplingParameters(n,x),Q=0!==E?Z.TEXTURE_2D_ARRAY:0!==d?Z.TEXTURE_3D:Z.TEXTURE_2D,P=this._getRGBABufferInternalSizedFormat(b,e,i),y=this._getInternalFormat(e),q=this._getWebGLTextureType(b);return this._bindTextureDirectly(Q,w),0!==E?(w.is2DArray=!0,Z.texImage3D(Q,0,P,m,u,E,0,y,q,null)):0!==d?(w.is3D=!0,Z.texImage3D(Q,0,P,m,u,d,0,y,q,null)):Z.texImage2D(Q,0,P,m,u,0,y,q,null),Z.texParameteri(Q,Z.TEXTURE_MAG_FILTER,l.mag),Z.texParameteri(Q,Z.TEXTURE_MIN_FILTER,l.min),Z.texParameteri(Q,Z.TEXTURE_WRAP_S,Z.CLAMP_TO_EDGE),Z.texParameteri(Q,Z.TEXTURE_WRAP_T,Z.CLAMP_TO_EDGE),x&&this._gl.generateMipmap(Q),this._bindTextureDirectly(Q,null),w._useSRGBBuffer=i,w.baseWidth=m,w.baseHeight=u,w.width=m,w.height=u,w.depth=E,w.isReady=!0,w.samples=z,w.generateMipMaps=x,w.samplingMode=n,w.type=b,w.format=e,w.label=W,this._internalTexturesCache.push(w),w}_getUseSRGBBuffer(t,K){return t&&this._caps.supportSRGBBuffers&&(this.webGLVersion>1||K)}createTexture(t,K,D,a,G=3,N=null,W=null,x=null,b=null,n=null,e=null,i,z,Z,w){return this._createTextureBase(t,K,D,a,G,N,W,((...t)=>this._prepareWebGLTexture(...t,n)),((t,K,D,G,N,W)=>{const x=this._gl,b=D.width===t&&D.height===K;N._creationFlags=null!=Z?Z:0;const n=this._getTexImageParametersForCreateTexture(N.format,N._useSRGBBuffer);if(b)return x.texImage2D(x.TEXTURE_2D,0,n.internalFormat,n.format,n.type,D),!1;const e=this._caps.maxTextureSize;if(D.width>e||D.height>e||!this._supportsHardwareTextureRescaling)return this._prepareWorkingCanvas(),!(!this._workingCanvas||!this._workingContext||(this._workingCanvas.width=t,this._workingCanvas.height=K,this._workingContext.drawImage(D,0,0,D.width,D.height,0,0,t,K),x.texImage2D(x.TEXTURE_2D,0,n.internalFormat,n.format,n.type,this._workingCanvas),N.width=t,N.height=K,1));{const t=new I.h(this,2);this._bindTextureDirectly(x.TEXTURE_2D,t,!0),x.texImage2D(x.TEXTURE_2D,0,n.internalFormat,n.format,n.type,D),this._rescaleTexture(t,N,a,n.format,(()=>{this._releaseTexture(t),this._bindTextureDirectly(x.TEXTURE_2D,N,!0),W()}))}return!0}),x,b,n,e,i,z,w)}_getTexImageParametersForCreateTexture(t,K){let D,a;return 1===this.webGLVersion?(D=this._getInternalFormat(t,K),a=D):(D=this._getInternalFormat(t,!1),a=this._getRGBABufferInternalSizedFormat(0,t,K)),{internalFormat:a,format:D,type:this._gl.UNSIGNED_BYTE}}_rescaleTexture(t,K,D,a,G){}_unpackFlipY(t){this._unpackFlipYCached!==t&&(this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,t?1:0),this.enableUnpackFlipYCached&&(this._unpackFlipYCached=t))}_getUnpackAlignement(){return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT)}_getTextureTarget(t){return t.isCube?this._gl.TEXTURE_CUBE_MAP:t.is3D?this._gl.TEXTURE_3D:t.is2DArray||t.isMultiview?this._gl.TEXTURE_2D_ARRAY:this._gl.TEXTURE_2D}updateTextureSamplingMode(t,K,D=!1){const a=this._getTextureTarget(K),G=this._getSamplingParameters(t,K.useMipMaps||D);this._setTextureParameterInteger(a,this._gl.TEXTURE_MAG_FILTER,G.mag,K),this._setTextureParameterInteger(a,this._gl.TEXTURE_MIN_FILTER,G.min),D&&(K.generateMipMaps=!0,this._gl.generateMipmap(a)),this._bindTextureDirectly(a,null),K.samplingMode=t}updateTextureDimensions(t,K,D,a=1){}updateTextureWrappingMode(t,K,D=null,a=null){const G=this._getTextureTarget(t);null!==K&&(this._setTextureParameterInteger(G,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(K),t),t._cachedWrapU=K),null!==D&&(this._setTextureParameterInteger(G,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(D),t),t._cachedWrapV=D),(t.is2DArray||t.is3D)&&null!==a&&(this._setTextureParameterInteger(G,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(a),t),t._cachedWrapR=a),this._bindTextureDirectly(G,null)}_uploadCompressedDataToTextureDirectly(t,K,D,a,G,N=0,W=0){const x=this._gl;let b=x.TEXTURE_2D;if(t.isCube&&(b=x.TEXTURE_CUBE_MAP_POSITIVE_X+N),t._useSRGBBuffer)switch(K){case 37492:case 36196:this._caps.etc2?K=x.COMPRESSED_SRGB8_ETC2:t._useSRGBBuffer=!1;break;case 37496:this._caps.etc2?K=x.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:t._useSRGBBuffer=!1;break;case 36492:K=x.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;break;case 37808:K=x.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;break;case 33776:this._caps.s3tc_srgb?K=x.COMPRESSED_SRGB_S3TC_DXT1_EXT:t._useSRGBBuffer=!1;break;case 33777:this._caps.s3tc_srgb?K=x.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:t._useSRGBBuffer=!1;break;case 33779:this._caps.s3tc_srgb?K=x.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:t._useSRGBBuffer=!1;break;default:t._useSRGBBuffer=!1}this._gl.compressedTexImage2D(b,W,K,D,a,0,G)}_uploadDataToTextureDirectly(t,K,D=0,a=0,G,N=!1){const W=this._gl,x=this._getWebGLTextureType(t.type),b=this._getInternalFormat(t.format),n=void 0===G?this._getRGBABufferInternalSizedFormat(t.type,t.format,t._useSRGBBuffer):this._getInternalFormat(G,t._useSRGBBuffer);this._unpackFlipY(t.invertY);let e=W.TEXTURE_2D;t.isCube&&(e=W.TEXTURE_CUBE_MAP_POSITIVE_X+D);const i=Math.round(Math.log(t.width)*Math.LOG2E),z=Math.round(Math.log(t.height)*Math.LOG2E),I=N?t.width:Math.pow(2,Math.max(i-a,0)),Z=N?t.height:Math.pow(2,Math.max(z-a,0));W.texImage2D(e,a,n,I,Z,0,b,x,K)}updateTextureData(t,K,D,a,G,N,W=0,x=0,b=!1){const n=this._gl,e=this._getWebGLTextureType(t.type),i=this._getInternalFormat(t.format);this._unpackFlipY(t.invertY);let z=n.TEXTURE_2D,I=n.TEXTURE_2D;t.isCube&&(I=n.TEXTURE_CUBE_MAP_POSITIVE_X+W,z=n.TEXTURE_CUBE_MAP),this._bindTextureDirectly(z,t,!0),n.texSubImage2D(I,x,D,a,G,N,i,e,K),b&&this._gl.generateMipmap(I),this._bindTextureDirectly(z,null)}_uploadArrayBufferViewToTexture(t,K,D=0,a=0){const G=this._gl,N=t.isCube?G.TEXTURE_CUBE_MAP:G.TEXTURE_2D;this._bindTextureDirectly(N,t,!0),this._uploadDataToTextureDirectly(t,K,D,a),this._bindTextureDirectly(N,null,!0)}_prepareWebGLTextureContinuation(t,K,D,a,G){const N=this._gl;if(!N)return;const W=this._getSamplingParameters(G,!D);N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MAG_FILTER,W.mag),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MIN_FILTER,W.min),D||a||N.generateMipmap(N.TEXTURE_2D),this._bindTextureDirectly(N.TEXTURE_2D,null),K&&K.removePendingData(t),t.onLoadedObservable.notifyObservers(t),t.onLoadedObservable.clear()}_prepareWebGLTexture(t,K,D,a,G,N,W,x,b,n){const i=this.getCaps().maxTextureSize,z=Math.min(i,this.needPOTTextures?e.R(a.width,i):a.width),I=Math.min(i,this.needPOTTextures?e.R(a.height,i):a.height),Z=this._gl;Z&&(t._hardwareTexture?(this._bindTextureDirectly(Z.TEXTURE_2D,t,!0),this._unpackFlipY(void 0===G||!!G),t.baseWidth=a.width,t.baseHeight=a.height,t.width=z,t.height=I,t.isReady=!0,t.type=-1!==t.type?t.type:0,t.format=-1!==t.format?t.format:null!=n?n:".jpg"!==K||t._useSRGBBuffer?5:4,x(z,I,a,K,t,(()=>{this._prepareWebGLTextureContinuation(t,D,N,W,b)}))||this._prepareWebGLTextureContinuation(t,D,N,W,b)):D&&D.removePendingData(t))}_getInternalFormatFromDepthTextureFormat(t,K,D){const a=this._gl;if(!K)return a.STENCIL_INDEX8;let G=D?a.DEPTH_STENCIL:a.DEPTH_COMPONENT;return this.webGLVersion>1?15===t?G=a.DEPTH_COMPONENT16:16===t?G=a.DEPTH_COMPONENT24:17===t||13===t?G=D?a.DEPTH24_STENCIL8:a.DEPTH_COMPONENT24:14===t?G=a.DEPTH_COMPONENT32F:18===t&&(G=D?a.DEPTH32F_STENCIL8:a.DEPTH_COMPONENT32F):G=a.DEPTH_COMPONENT16,G}_setupFramebufferDepthAttachments(t,K,D,a,G=1,N){const W=this._gl;N=null!=N?N:t?13:14;const x=this._getInternalFormatFromDepthTextureFormat(N,K,t);return t&&K?this._createRenderBuffer(D,a,G,W.DEPTH_STENCIL,x,W.DEPTH_STENCIL_ATTACHMENT):K?this._createRenderBuffer(D,a,G,x,x,W.DEPTH_ATTACHMENT):t?this._createRenderBuffer(D,a,G,x,x,W.STENCIL_ATTACHMENT):null}_createRenderBuffer(t,K,D,a,G,N,W=!0){const x=this._gl.createRenderbuffer();return this._updateRenderBuffer(x,t,K,D,a,G,N,W)}_updateRenderBuffer(t,K,D,a,G,N,W,x=!0){const b=this._gl;return b.bindRenderbuffer(b.RENDERBUFFER,t),a>1&&b.renderbufferStorageMultisample?b.renderbufferStorageMultisample(b.RENDERBUFFER,a,N,K,D):b.renderbufferStorage(b.RENDERBUFFER,G,K,D),b.framebufferRenderbuffer(b.FRAMEBUFFER,W,b.RENDERBUFFER,t),x&&b.bindRenderbuffer(b.RENDERBUFFER,null),t}_releaseTexture(t){this._deleteTexture(t._hardwareTexture),this.unbindAllTextures();const K=this._internalTexturesCache.indexOf(t);-1!==K&&this._internalTexturesCache.splice(K,1),t._lodTextureHigh&&t._lodTextureHigh.dispose(),t._lodTextureMid&&t._lodTextureMid.dispose(),t._lodTextureLow&&t._lodTextureLow.dispose(),t._irradianceTexture&&t._irradianceTexture.dispose()}_deleteTexture(t){null==t||t.release()}_setProgram(t){this._currentProgram!==t&&(a.C5(t,this._gl),this._currentProgram=t)}bindSamplers(t){const K=t.getPipelineContext();this._setProgram(K.program);const D=t.getSamplers();for(let K=0;K<D.length;K++){const a=t.getUniform(D[K]);a&&(this._boundUniforms[K]=a)}this._currentEffect=null}_activateCurrentTexture(){this._currentTextureChannel!==this._activeChannel&&(this._gl.activeTexture(this._gl.TEXTURE0+this._activeChannel),this._currentTextureChannel=this._activeChannel)}_bindTextureDirectly(t,K,D=!1,a=!1){var G,W;let x=!1;const b=K&&K._associatedChannel>-1;if(D&&b&&(this._activeChannel=K._associatedChannel),this._boundTexturesCache[this._activeChannel]!==K||a){if(this._activateCurrentTexture(),K&&K.isMultiview)throw N.V.Error(["_bindTextureDirectly called with a multiview texture!",t,K]),"_bindTextureDirectly called with a multiview texture!";this._gl.bindTexture(t,null!==(W=null===(G=null==K?void 0:K._hardwareTexture)||void 0===G?void 0:G.underlyingResource)&&void 0!==W?W:null),this._boundTexturesCache[this._activeChannel]=K,K&&(K._associatedChannel=this._activeChannel)}else D&&(x=!0,this._activateCurrentTexture());return b&&!D&&this._bindSamplerUniformToChannel(K._associatedChannel,this._activeChannel),x}_bindTexture(t,K,D){if(void 0===t)return;K&&(K._associatedChannel=t),this._activeChannel=t;const a=K?this._getTextureTarget(K):this._gl.TEXTURE_2D;this._bindTextureDirectly(a,K)}unbindAllTextures(){for(let t=0;t<this._maxSimultaneousTextures;t++)this._activeChannel=t,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))}setTexture(t,K,D,a){void 0!==t&&(K&&(this._boundUniforms[t]=K),this._setTexture(t,D))}_bindSamplerUniformToChannel(t,K){const D=this._boundUniforms[t];D&&D._currentState!==K&&(this._gl.uniform1i(D,K),D._currentState=K)}_getTextureWrapMode(t){switch(t){case 1:return this._gl.REPEAT;case 0:return this._gl.CLAMP_TO_EDGE;case 2:return this._gl.MIRRORED_REPEAT}return this._gl.REPEAT}_setTexture(t,K,D=!1,a=!1,G=""){if(!K)return null!=this._boundTexturesCache[t]&&(this._activeChannel=t,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))),!1;if(K.video){this._activeChannel=t;const D=K.getInternalTexture();D&&(D._associatedChannel=t),K.update()}else if(4===K.delayLoadState)return K.delayLoad(),!1;let N;N=a?K.depthStencilTexture:K.isReady()?K.getInternalTexture():K.isCube?this.emptyCubeTexture:K.is3D?this.emptyTexture3D:K.is2DArray?this.emptyTexture2DArray:this.emptyTexture,!D&&N&&(N._associatedChannel=t);let W=!0;this._boundTexturesCache[t]===N&&(D||this._bindSamplerUniformToChannel(N._associatedChannel,t),W=!1),this._activeChannel=t;const x=this._getTextureTarget(N);if(W&&this._bindTextureDirectly(x,N,D),N&&!N.isMultiview){if(N.isCube&&N._cachedCoordinatesMode!==K.coordinatesMode){N._cachedCoordinatesMode=K.coordinatesMode;const t=3!==K.coordinatesMode&&5!==K.coordinatesMode?1:0;K.wrapU=t,K.wrapV=t}N._cachedWrapU!==K.wrapU&&(N._cachedWrapU=K.wrapU,this._setTextureParameterInteger(x,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(K.wrapU),N)),N._cachedWrapV!==K.wrapV&&(N._cachedWrapV=K.wrapV,this._setTextureParameterInteger(x,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(K.wrapV),N)),N.is3D&&N._cachedWrapR!==K.wrapR&&(N._cachedWrapR=K.wrapR,this._setTextureParameterInteger(x,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(K.wrapR),N)),this._setAnisotropicLevel(x,N,K.anisotropicFilteringLevel)}return!0}setTextureArray(t,K,D,a){if(void 0!==t&&K){this._textureUnits&&this._textureUnits.length===D.length||(this._textureUnits=new Int32Array(D.length));for(let K=0;K<D.length;K++){const a=D[K].getInternalTexture();a?(this._textureUnits[K]=t+K,a._associatedChannel=t+K):this._textureUnits[K]=-1}this._gl.uniform1iv(K,this._textureUnits);for(let t=0;t<D.length;t++)this._setTexture(this._textureUnits[t],D[t],!0)}}_setAnisotropicLevel(t,K,D){const a=this._caps.textureAnisotropicFilterExtension;11!==K.samplingMode&&3!==K.samplingMode&&2!==K.samplingMode&&(D=1),a&&K._cachedAnisotropicFilteringLevel!==D&&(this._setTextureParameterFloat(t,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(D,this._caps.maxAnisotropy),K),K._cachedAnisotropicFilteringLevel=D)}_setTextureParameterFloat(t,K,D,a){this._bindTextureDirectly(t,a,!0,!0),this._gl.texParameterf(t,K,D)}_setTextureParameterInteger(t,K,D,a){a&&this._bindTextureDirectly(t,a,!0,!0),this._gl.texParameteri(t,K,D)}unbindAllAttributes(){if(this._mustWipeVertexAttributes){this._mustWipeVertexAttributes=!1;for(let t=0;t<this._caps.maxVertexAttribs;t++)this.disableAttributeByIndex(t)}else for(let t=0,K=this._vertexAttribArraysEnabled.length;t<K;t++)t>=this._caps.maxVertexAttribs||!this._vertexAttribArraysEnabled[t]||this.disableAttributeByIndex(t)}releaseEffects(){const t=Object.keys(this._compiledEffects);for(const K of t)this._compiledEffects[K].dispose();this._compiledEffects={}}dispose(){var t;W.BA()&&this._renderingCanvas&&(this._doNotHandleContextLost||(this._renderingCanvas.removeEventListener("webglcontextlost",this._onContextLost),this._renderingCanvas.removeEventListener("webglcontextrestored",this._onContextRestored))),super.dispose(),this._dummyFramebuffer&&this._gl.deleteFramebuffer(this._dummyFramebuffer),this.unbindAllAttributes(),this._boundUniforms={},this._workingCanvas=null,this._workingContext=null,this._currentBufferPointers.length=0,this._currentProgram=null,this._creationOptions.loseContextOnDispose&&(null===(t=this._gl.getExtension("WEBGL_lose_context"))||void 0===t||t.loseContext()),a.Cm(this._gl)}attachContextLostEvent(t){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextlost",t,!1)}attachContextRestoredEvent(t){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextrestored",t,!1)}getError(){return this._gl.getError()}_canRenderToFloatFramebuffer(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(1)}_canRenderToHalfFloatFramebuffer(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(2)}_canRenderToFramebuffer(t){const K=this._gl;for(;K.getError()!==K.NO_ERROR;);let D=!0;const a=K.createTexture();K.bindTexture(K.TEXTURE_2D,a),K.texImage2D(K.TEXTURE_2D,0,this._getRGBABufferInternalSizedFormat(t),1,1,0,K.RGBA,this._getWebGLTextureType(t),null),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,K.NEAREST),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MAG_FILTER,K.NEAREST);const G=K.createFramebuffer();K.bindFramebuffer(K.FRAMEBUFFER,G),K.framebufferTexture2D(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_2D,a,0);const N=K.checkFramebufferStatus(K.FRAMEBUFFER);if(D=D&&N===K.FRAMEBUFFER_COMPLETE,D=D&&K.getError()===K.NO_ERROR,D&&(K.clear(K.COLOR_BUFFER_BIT),D=D&&K.getError()===K.NO_ERROR),D){K.bindFramebuffer(K.FRAMEBUFFER,null);const t=K.RGBA,a=K.UNSIGNED_BYTE,G=new Uint8Array(4);K.readPixels(0,0,1,1,t,a,G),D=D&&K.getError()===K.NO_ERROR}for(K.deleteTexture(a),K.deleteFramebuffer(G),K.bindFramebuffer(K.FRAMEBUFFER,null);!D&&K.getError()!==K.NO_ERROR;);return D}_getWebGLTextureType(t){if(1===this._webGLVersion){switch(t){case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT_OES;case 0:return this._gl.UNSIGNED_BYTE;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5}return this._gl.UNSIGNED_BYTE}switch(t){case 3:return this._gl.BYTE;case 0:return this._gl.UNSIGNED_BYTE;case 4:return this._gl.SHORT;case 5:return this._gl.UNSIGNED_SHORT;case 6:return this._gl.INT;case 7:return this._gl.UNSIGNED_INT;case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5;case 11:return this._gl.UNSIGNED_INT_2_10_10_10_REV;case 12:return this._gl.UNSIGNED_INT_24_8;case 13:return this._gl.UNSIGNED_INT_10F_11F_11F_REV;case 14:return this._gl.UNSIGNED_INT_5_9_9_9_REV;case 15:return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV}return this._gl.UNSIGNED_BYTE}_getInternalFormat(t,K=!1){let D=K?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA;switch(t){case 0:D=this._gl.ALPHA;break;case 1:D=this._gl.LUMINANCE;break;case 2:D=this._gl.LUMINANCE_ALPHA;break;case 6:D=this._gl.RED;break;case 7:D=this._gl.RG;break;case 4:D=K?this._glSRGBExtensionValues.SRGB:this._gl.RGB;break;case 5:D=K?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA}if(this._webGLVersion>1)switch(t){case 8:D=this._gl.RED_INTEGER;break;case 9:D=this._gl.RG_INTEGER;break;case 10:D=this._gl.RGB_INTEGER;break;case 11:D=this._gl.RGBA_INTEGER}return D}_getRGBABufferInternalSizedFormat(t,K,D=!1){if(1===this._webGLVersion){if(void 0!==K)switch(K){case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;case 4:return D?this._glSRGBExtensionValues.SRGB:this._gl.RGB}return this._gl.RGBA}switch(t){case 3:switch(K){case 6:return this._gl.R8_SNORM;case 7:return this._gl.RG8_SNORM;case 4:return this._gl.RGB8_SNORM;case 8:return this._gl.R8I;case 9:return this._gl.RG8I;case 10:return this._gl.RGB8I;case 11:return this._gl.RGBA8I;default:return this._gl.RGBA8_SNORM}case 0:switch(K){case 6:return this._gl.R8;case 7:return this._gl.RG8;case 4:return D?this._glSRGBExtensionValues.SRGB8:this._gl.RGB8;case 5:return D?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA8;case 8:return this._gl.R8UI;case 9:return this._gl.RG8UI;case 10:return this._gl.RGB8UI;case 11:return this._gl.RGBA8UI;case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;default:return this._gl.RGBA8}case 4:switch(K){case 8:return this._gl.R16I;case 9:return this._gl.RG16I;case 10:return this._gl.RGB16I;default:return this._gl.RGBA16I}case 5:switch(K){case 8:return this._gl.R16UI;case 9:return this._gl.RG16UI;case 10:return this._gl.RGB16UI;default:return this._gl.RGBA16UI}case 6:switch(K){case 8:return this._gl.R32I;case 9:return this._gl.RG32I;case 10:return this._gl.RGB32I;default:return this._gl.RGBA32I}case 7:switch(K){case 8:return this._gl.R32UI;case 9:return this._gl.RG32UI;case 10:return this._gl.RGB32UI;default:return this._gl.RGBA32UI}case 1:switch(K){case 6:return this._gl.R32F;case 7:return this._gl.RG32F;case 4:return this._gl.RGB32F;default:return this._gl.RGBA32F}case 2:switch(K){case 6:return this._gl.R16F;case 7:return this._gl.RG16F;case 4:return this._gl.RGB16F;default:return this._gl.RGBA16F}case 10:return this._gl.RGB565;case 13:return this._gl.R11F_G11F_B10F;case 14:return this._gl.RGB9_E5;case 8:return this._gl.RGBA4;case 9:return this._gl.RGB5_A1;case 11:switch(K){case 5:default:return this._gl.RGB10_A2;case 11:return this._gl.RGB10_A2UI}}return D?this._glSRGBExtensionValues.SRGB8_ALPHA8:this._gl.RGBA8}readPixels(t,K,D,a,G=!0,N=!0){const W=G?4:3,x=G?this._gl.RGBA:this._gl.RGB,b=new Uint8Array(a*D*W);return N&&this.flushFramebuffer(),this._gl.readPixels(t,K,D,a,x,this._gl.UNSIGNED_BYTE,b),Promise.resolve(b)}static get IsSupportedAsync(){return Promise.resolve(this.isSupported())}static get IsSupported(){return this.isSupported()}static isSupported(){if(null!==this._HasMajorPerformanceCaveat)return!this._HasMajorPerformanceCaveat;if(null===this._IsSupported)try{const t=i.$._CreateCanvas(1,1),K=t.getContext("webgl")||t.getContext("experimental-webgl");this._IsSupported=null!=K&&!!window.WebGLRenderingContext}catch(t){this._IsSupported=!1}return this._IsSupported}static get HasMajorPerformanceCaveat(){if(null===this._HasMajorPerformanceCaveat)try{const t=i.$._CreateCanvas(1,1),K=t.getContext("webgl",{failIfMajorPerformanceCaveat:!0})||t.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0});this._HasMajorPerformanceCaveat=!K}catch(t){this._HasMajorPerformanceCaveat=!1}return this._HasMajorPerformanceCaveat}}d._TempClearColorUint32=new Uint32Array(4),d._TempClearColorInt32=new Int32Array(4),d.ExceptionList=[{key:"Chrome/63.0",capture:"63\\.0\\.3239\\.(\\d+)",captureConstraint:108,targets:["uniformBuffer"]},{key:"Firefox/58",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Firefox/59",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/72.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/73.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/74.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/71",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/72",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/12\\d\\..+?Mobile",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:".*AppleWebKit.*(15.4).*Safari",capture:null,captureConstraint:null,targets:["antialias","maxMSAASamples"]},{key:".*(15.4).*AppleWebKit.*Safari",capture:null,captureConstraint:null,targets:["antialias","maxMSAASamples"]}],d._ConcatenateShader=w.iL,d._IsSupported=null,d._HasMajorPerformanceCaveat=null},332108:(t,K,D)=>{var a;D.d(K,{s:()=>G}),function(t){t[t["PointerMove"]=0]="PointerMove",t[t["PointerDown"]=1]="PointerDown",t[t["PointerUp"]=2]="PointerUp"}(a||(a={}));class G{}G.DOM_DELTA_PIXEL=0,G.DOM_DELTA_LINE=1,G.DOM_DELTA_PAGE=2},834255:(t,K,D)=>{D.d(K,{Bu:()=>N,TB:()=>a,W0:()=>G});class a{}a.KEYDOWN=1,a.KEYUP=2;class G{constructor(t,K){this.type=t,this.event=K}}class N extends G{get skipOnPointerObservable(){return this.skipOnKeyboardObservable}set skipOnPointerObservable(t){this.skipOnKeyboardObservable=t}constructor(t,K){super(t,K),this.type=t,this.event=K,this.skipOnKeyboardObservable=!1}}},706211:(t,K,D)=>{D.d(K,{Zp:()=>G,mx:()=>x,tT:()=>W});var a=D(604910);class G{}G.POINTERDOWN=1,G.POINTERUP=2,G.POINTERMOVE=4,G.POINTERWHEEL=8,G.POINTERPICK=16,G.POINTERTAP=32,G.POINTERDOUBLETAP=64;class N{constructor(t,K){this.type=t,this.event=K}}class W extends N{constructor(t,K,D,G){super(t,K),this.ray=null,this.originalPickingInfo=null,this.skipOnPointerObservable=!1,this.localPosition=new a.I9(D,G)}}class x extends N{get pickInfo(){return this._pickInfo||this._generatePickInfo(),this._pickInfo}constructor(t,K,D,a=null){super(t,K),this._pickInfo=D,this._inputManager=a}_generatePickInfo(){this._inputManager&&(this._pickInfo=this._inputManager._pickMove(this.event),this._inputManager._setRayOnPointerInfo(this._pickInfo,this.event),this._inputManager=null)}}},214413:(t,K,D)=>{D.d(K,{c:()=>m});var a=D(604910),G=D(888413),N=D(554014),W=D(675100),x=D(59036),b=D(472295),n=D(706400),e=D(395726);const i=a.Pq.Up(),z=a.Pq.Zero(),I=new a.Pq,Z=new a.Pq,w=new a.uq;class m extends W.o{_validateFilter(t){return t===W.o.FILTER_NONE||t===W.o.FILTER_PCF||t===W.o.FILTER_PCSS?t:(n.V.Error('Unsupported filter "'+t+'"!'),W.o.FILTER_NONE)}get numCascades(){return this._numCascades}set numCascades(t){(t=Math.min(Math.max(t,m.MIN_CASCADES_COUNT),m.MAX_CASCADES_COUNT))!==this._numCascades&&(this._numCascades=t,this.recreateShadowMap(),this._recreateSceneUBOs())}get freezeShadowCastersBoundingInfo(){return this._freezeShadowCastersBoundingInfo}set freezeShadowCastersBoundingInfo(t){this._freezeShadowCastersBoundingInfoObservable&&t&&(this._scene.onBeforeRenderObservable.remove(this._freezeShadowCastersBoundingInfoObservable),this._freezeShadowCastersBoundingInfoObservable=null),this._freezeShadowCastersBoundingInfoObservable||t||(this._freezeShadowCastersBoundingInfoObservable=this._scene.onBeforeRenderObservable.add((()=>this._computeShadowCastersBoundingInfo()))),this._freezeShadowCastersBoundingInfo=t,t&&this._computeShadowCastersBoundingInfo()}_computeShadowCastersBoundingInfo(){if(this._scbiMin.copyFromFloats(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._scbiMax.copyFromFloats(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),this._shadowMap&&this._shadowMap.renderList){const t=this._shadowMap.renderList;for(let K=0;K<t.length;K++){const D=t[K];if(!D)continue;const a=D.getBoundingInfo().boundingBox;this._scbiMin.minimizeInPlace(a.minimumWorld),this._scbiMax.maximizeInPlace(a.maximumWorld)}const K=this._scene.meshes;for(let t=0;t<K.length;t++){const D=K[t];if(!(D&&D.isVisible&&D.isEnabled&&D.receiveShadows))continue;const a=D.getBoundingInfo().boundingBox;this._scbiMin.minimizeInPlace(a.minimumWorld),this._scbiMax.maximizeInPlace(a.maximumWorld)}}this._shadowCastersBoundingInfo.reConstruct(this._scbiMin,this._scbiMax)}get shadowCastersBoundingInfo(){return this._shadowCastersBoundingInfo}set shadowCastersBoundingInfo(t){this._shadowCastersBoundingInfo=t}setMinMaxDistance(t,K){this._minDistance===t&&this._maxDistance===K||(t>K&&(t=0,K=1),t<0&&(t=0),K>1&&(K=1),this._minDistance=t,this._maxDistance=K,this._breaksAreDirty=!0)}get minDistance(){return this._minDistance}get maxDistance(){return this._maxDistance}getClassName(){return m.CLASSNAME}getCascadeMinExtents(t){return t>=0&&t<this._numCascades?this._cascadeMinExtents[t]:null}getCascadeMaxExtents(t){return t>=0&&t<this._numCascades?this._cascadeMaxExtents[t]:null}get shadowMaxZ(){return this._getCamera()?this._shadowMaxZ:0}set shadowMaxZ(t){const K=this._getCamera();K?this._shadowMaxZ===t||t<K.minZ||t>K.maxZ&&0!==K.maxZ||(this._shadowMaxZ=t,this._light._markMeshesAsLightDirty(),this._breaksAreDirty=!0):this._shadowMaxZ=t}get debug(){return this._debug}set debug(t){this._debug=t,this._light._markMeshesAsLightDirty()}get depthClamp(){return this._depthClamp}set depthClamp(t){this._depthClamp=t}get cascadeBlendPercentage(){return this._cascadeBlendPercentage}set cascadeBlendPercentage(t){this._cascadeBlendPercentage=t,this._light._markMeshesAsLightDirty()}get lambda(){return this._lambda}set lambda(t){const K=Math.min(Math.max(t,0),1);this._lambda!=K&&(this._lambda=K,this._breaksAreDirty=!0)}getCascadeViewMatrix(t){return t>=0&&t<this._numCascades?this._viewMatrices[t]:null}getCascadeProjectionMatrix(t){return t>=0&&t<this._numCascades?this._projectionMatrices[t]:null}getCascadeTransformMatrix(t){return t>=0&&t<this._numCascades?this._transformMatrices[t]:null}setDepthRenderer(t){this._depthRenderer=t,this._depthReducer&&this._depthReducer.setDepthRenderer(this._depthRenderer)}get autoCalcDepthBounds(){return this._autoCalcDepthBounds}set autoCalcDepthBounds(t){const K=this._getCamera();if(K){if(this._autoCalcDepthBounds=t,!t)return this._depthReducer&&this._depthReducer.deactivate(),void this.setMinMaxDistance(0,1);this._depthReducer||(this._depthReducer=new b.k(K),this._depthReducer.onAfterReductionPerformed.add((t=>{let K=t.min,D=t.max;K>=D&&(K=0,D=1),K==this._minDistance&&D==this._maxDistance||this.setMinMaxDistance(K,D)})),this._depthReducer.setDepthRenderer(this._depthRenderer)),this._depthReducer.activate()}}get autoCalcDepthBoundsRefreshRate(){var t,K,D;return null!==(D=null===(K=null===(t=this._depthReducer)||void 0===t?void 0:t.depthRenderer)||void 0===K?void 0:K.getDepthMap().refreshRate)&&void 0!==D?D:-1}set autoCalcDepthBoundsRefreshRate(t){var K;(null===(K=this._depthReducer)||void 0===K?void 0:K.depthRenderer)&&(this._depthReducer.depthRenderer.getDepthMap().refreshRate=t)}splitFrustum(){this._breaksAreDirty=!0}_splitFrustum(){const t=this._getCamera();if(!t)return;const K=t.minZ,D=t.maxZ||this._shadowMaxZ,a=D-K,G=this._minDistance,N=K+G*a,W=K+(this._shadowMaxZ<D&&this._shadowMaxZ>=K?Math.min((this._shadowMaxZ-K)/(D-K),this._maxDistance):this._maxDistance)*a,x=W-N,b=W/N;for(let t=0;t<this._cascades.length;++t){const D=(t+1)/this._numCascades,W=N*b**D,n=N+x*D,e=this._lambda*(W-n)+n;this._cascades[t].prevBreakDistance=0===t?G:this._cascades[t-1].breakDistance,this._cascades[t].breakDistance=(e-K)/a,this._viewSpaceFrustumsZ[t]=e,this._frustumLengths[t]=(this._cascades[t].breakDistance-this._cascades[t].prevBreakDistance)*a}this._breaksAreDirty=!1}_computeMatrices(){const t=this._scene;if(!this._getCamera())return;a.Pq.NormalizeToRef(this._light.getShadowDirection(0),this._lightDirection),1===Math.abs(a.Pq.Dot(this._lightDirection,a.Pq.Up()))&&(this._lightDirection.z=1e-13),this._cachedDirection.copyFrom(this._lightDirection);const K=t.getEngine().useReverseDepthBuffer;for(let D=0;D<this._numCascades;++D){this._computeFrustumInWorldSpace(D),this._computeCascadeFrustum(D),this._cascadeMaxExtents[D].subtractToRef(this._cascadeMinExtents[D],I),this._frustumCenter[D].addToRef(this._lightDirection.scale(this._cascadeMinExtents[D].z),this._shadowCameraPos[D]),a.uq.LookAtLHToRef(this._shadowCameraPos[D],this._frustumCenter[D],i,this._viewMatrices[D]);let G=0,N=I.z;const x=this._shadowCastersBoundingInfo;x.update(this._viewMatrices[D]),N=Math.min(N,x.boundingBox.maximumWorld.z),G=this._depthClamp&&this.filter!==W.o.FILTER_PCSS?Math.max(G,x.boundingBox.minimumWorld.z):Math.min(G,x.boundingBox.minimumWorld.z),a.uq.OrthoOffCenterLHToRef(this._cascadeMinExtents[D].x,this._cascadeMaxExtents[D].x,this._cascadeMinExtents[D].y,this._cascadeMaxExtents[D].y,K?N:G,K?G:N,this._projectionMatrices[D],t.getEngine().isNDCHalfZRange),this._cascadeMinExtents[D].z=G,this._cascadeMaxExtents[D].z=N,this._viewMatrices[D].multiplyToRef(this._projectionMatrices[D],this._transformMatrices[D]),a.Pq.TransformCoordinatesToRef(z,this._transformMatrices[D],I),I.scaleInPlace(this._mapSize/2),Z.copyFromFloats(Math.round(I.x),Math.round(I.y),Math.round(I.z)),Z.subtractInPlace(I).scaleInPlace(2/this._mapSize),a.uq.TranslationToRef(Z.x,Z.y,0,w),this._projectionMatrices[D].multiplyToRef(w,this._projectionMatrices[D]),this._viewMatrices[D].multiplyToRef(this._projectionMatrices[D],this._transformMatrices[D]),this._transformMatrices[D].copyToArray(this._transformMatricesAsArray,16*D)}}_computeFrustumInWorldSpace(t){const K=this._getCamera();if(!K)return;const D=this._cascades[t].prevBreakDistance,G=this._cascades[t].breakDistance,N=this._scene.getEngine().isNDCHalfZRange;K.getViewMatrix();const W=0===K.maxZ,x=K.maxZ;W&&(K.maxZ=this._shadowMaxZ,K.getProjectionMatrix(!0));const b=a.uq.Invert(K.getTransformationMatrix());W&&(K.maxZ=x,K.getProjectionMatrix(!0));const n=this._scene.getEngine().useReverseDepthBuffer?4:0;for(let K=0;K<m._FrustumCornersNDCSpace.length;++K)I.copyFrom(m._FrustumCornersNDCSpace[(K+n)%m._FrustumCornersNDCSpace.length]),N&&-1===I.z&&(I.z=0),a.Pq.TransformCoordinatesToRef(I,b,this._frustumCornersWorldSpace[t][K]);for(let K=0;K<m._FrustumCornersNDCSpace.length/2;++K)I.copyFrom(this._frustumCornersWorldSpace[t][K+4]).subtractInPlace(this._frustumCornersWorldSpace[t][K]),Z.copyFrom(I).scaleInPlace(D),I.scaleInPlace(G),I.addInPlace(this._frustumCornersWorldSpace[t][K]),this._frustumCornersWorldSpace[t][K+4].copyFrom(I),this._frustumCornersWorldSpace[t][K].addInPlace(Z)}_computeCascadeFrustum(t){if(this._cascadeMinExtents[t].copyFromFloats(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cascadeMaxExtents[t].copyFromFloats(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),this._frustumCenter[t].copyFromFloats(0,0,0),this._getCamera()){for(let K=0;K<this._frustumCornersWorldSpace[t].length;++K)this._frustumCenter[t].addInPlace(this._frustumCornersWorldSpace[t][K]);if(this._frustumCenter[t].scaleInPlace(1/this._frustumCornersWorldSpace[t].length),this.stabilizeCascades){let K=0;for(let D=0;D<this._frustumCornersWorldSpace[t].length;++D){const a=this._frustumCornersWorldSpace[t][D].subtractToRef(this._frustumCenter[t],I).length();K=Math.max(K,a)}K=Math.ceil(16*K)/16,this._cascadeMaxExtents[t].copyFromFloats(K,K,K),this._cascadeMinExtents[t].copyFromFloats(-K,-K,-K)}else{const K=this._frustumCenter[t];this._frustumCenter[t].addToRef(this._lightDirection,I),a.uq.LookAtLHToRef(K,I,i,w);for(let K=0;K<this._frustumCornersWorldSpace[t].length;++K)a.Pq.TransformCoordinatesToRef(this._frustumCornersWorldSpace[t][K],w,I),this._cascadeMinExtents[t].minimizeInPlace(I),this._cascadeMaxExtents[t].maximizeInPlace(I)}}}_recreateSceneUBOs(){if(this._disposeSceneUBOs(),this._sceneUBOs)for(let t=0;t<this._numCascades;++t)this._sceneUBOs.push(this._scene.createSceneUniformBuffer(`Scene for CSM Shadow Generator (light "${this._light.name}" cascade #${t})`))}static get IsSupported(){const t=e.q.LastCreatedEngine;return!!t&&t._features.supportCSM}constructor(t,K,D,a,G=!0){m.IsSupported?(super(t,K,D,a,G),this.usePercentageCloserFiltering=!0):n.V.Error("CascadedShadowMap is not supported by the current engine.")}_initializeGenerator(){var t,K,D,G,N,W,b,n,e,i,z,I,Z,w,u,d,E,l,Q,P;this.penumbraDarkness=null!==(t=this.penumbraDarkness)&&void 0!==t?t:1,this._numCascades=null!==(K=this._numCascades)&&void 0!==K?K:m.DEFAULT_CASCADES_COUNT,this.stabilizeCascades=null!==(D=this.stabilizeCascades)&&void 0!==D&&D,this._freezeShadowCastersBoundingInfoObservable=null!==(G=this._freezeShadowCastersBoundingInfoObservable)&&void 0!==G?G:null,this.freezeShadowCastersBoundingInfo=null!==(N=this.freezeShadowCastersBoundingInfo)&&void 0!==N&&N,this._scbiMin=null!==(W=this._scbiMin)&&void 0!==W?W:new a.Pq(0,0,0),this._scbiMax=null!==(b=this._scbiMax)&&void 0!==b?b:new a.Pq(0,0,0),this._shadowCastersBoundingInfo=null!==(n=this._shadowCastersBoundingInfo)&&void 0!==n?n:new x.j(new a.Pq(0,0,0),new a.Pq(0,0,0)),this._breaksAreDirty=null===(e=this._breaksAreDirty)||void 0===e||e,this._minDistance=null!==(i=this._minDistance)&&void 0!==i?i:0,this._maxDistance=null!==(z=this._maxDistance)&&void 0!==z?z:1,this._currentLayer=null!==(I=this._currentLayer)&&void 0!==I?I:0,this._shadowMaxZ=null!==(u=null!==(Z=this._shadowMaxZ)&&void 0!==Z?Z:null===(w=this._getCamera())||void 0===w?void 0:w.maxZ)&&void 0!==u?u:1e4,this._debug=null!==(d=this._debug)&&void 0!==d&&d,this._depthClamp=null===(E=this._depthClamp)||void 0===E||E,this._cascadeBlendPercentage=null!==(l=this._cascadeBlendPercentage)&&void 0!==l?l:.1,this._lambda=null!==(Q=this._lambda)&&void 0!==Q?Q:.5,this._autoCalcDepthBounds=null!==(P=this._autoCalcDepthBounds)&&void 0!==P&&P,this._recreateSceneUBOs(),super._initializeGenerator()}_createTargetRenderTexture(){const t=this._scene.getEngine(),K={width:this._mapSize,height:this._mapSize,layers:this.numCascades};this._shadowMap=new G.$(this._light.name+"_CSMShadowMap",K,this._scene,!1,!0,this._textureType,!1,void 0,!1,!1,void 0,this._useRedTextureType?6:5),this._shadowMap.createDepthStencilTexture(t.useReverseDepthBuffer?516:513,!0,void 0,void 0,void 0,`DepthStencilForCSMShadowGenerator-${this._light.name}`),this._shadowMap.noPrePassRenderer=!0}_initializeShadowMap(){if(super._initializeShadowMap(),null===this._shadowMap)return;this._transformMatricesAsArray=new Float32Array(16*this._numCascades),this._viewSpaceFrustumsZ=new Array(this._numCascades),this._frustumLengths=new Array(this._numCascades),this._lightSizeUVCorrection=new Array(2*this._numCascades),this._depthCorrection=new Array(this._numCascades),this._cascades=[],this._viewMatrices=[],this._projectionMatrices=[],this._transformMatrices=[],this._cascadeMinExtents=[],this._cascadeMaxExtents=[],this._frustumCenter=[],this._shadowCameraPos=[],this._frustumCornersWorldSpace=[];for(let t=0;t<this._numCascades;++t){this._cascades[t]={prevBreakDistance:0,breakDistance:0},this._viewMatrices[t]=a.uq.Zero(),this._projectionMatrices[t]=a.uq.Zero(),this._transformMatrices[t]=a.uq.Zero(),this._cascadeMinExtents[t]=new a.Pq,this._cascadeMaxExtents[t]=new a.Pq,this._frustumCenter[t]=new a.Pq,this._shadowCameraPos[t]=new a.Pq,this._frustumCornersWorldSpace[t]=new Array(m._FrustumCornersNDCSpace.length);for(let K=0;K<m._FrustumCornersNDCSpace.length;++K)this._frustumCornersWorldSpace[t][K]=new a.Pq}const t=this._scene.getEngine();this._shadowMap.onBeforeBindObservable.clear(),this._shadowMap.onBeforeRenderObservable.clear(),this._shadowMap.onBeforeRenderObservable.add((K=>{this._sceneUBOs&&this._scene.setSceneUniformBuffer(this._sceneUBOs[K]),this._currentLayer=K,this._filter===W.o.FILTER_PCF&&t.setColorWrite(!1),this._scene.setTransformMatrix(this.getCascadeViewMatrix(K),this.getCascadeProjectionMatrix(K)),this._useUBO&&(this._scene.getSceneUniformBuffer().unbindEffect(),this._scene.finalizeSceneUbo())})),this._shadowMap.onBeforeBindObservable.add((()=>{var K;this._currentSceneUBO=this._scene.getSceneUniformBuffer(),null===(K=t._debugPushGroup)||void 0===K||K.call(t,`cascaded shadow map generation for pass id ${t.currentRenderPassId}`,1),this._breaksAreDirty&&this._splitFrustum(),this._computeMatrices()})),this._splitFrustum()}_bindCustomEffectForRenderSubMeshForShadowMap(t,K){K.setMatrix("viewProjection",this.getCascadeTransformMatrix(this._currentLayer))}_isReadyCustomDefines(t){t.push("#define SM_DEPTHCLAMP "+(this._depthClamp&&this._filter!==W.o.FILTER_PCSS?"1":"0"))}prepareDefines(t,K){super.prepareDefines(t,K);const D=this._scene,a=this._light;if(!D.shadowsEnabled||!a.shadowEnabled)return;t["SHADOWCSM"+K]=!0,t["SHADOWCSMDEBUG"+K]=this.debug,t["SHADOWCSMNUM_CASCADES"+K]=this.numCascades,t["SHADOWCSM_RIGHTHANDED"+K]=D.useRightHandedSystem;const G=this._getCamera();G&&this._shadowMaxZ<=(G.maxZ||this._shadowMaxZ)&&(t["SHADOWCSMUSESHADOWMAXZ"+K]=!0),0===this.cascadeBlendPercentage&&(t["SHADOWCSMNOBLEND"+K]=!0)}bindShadowLight(t,K){const D=this._light;if(!this._scene.shadowsEnabled||!D.shadowEnabled)return;const a=this._getCamera();if(!a)return;const G=this.getShadowMap();if(!G)return;const N=G.getSize().width;if(K.setMatrices("lightMatrix"+t,this._transformMatricesAsArray),K.setArray("viewFrustumZ"+t,this._viewSpaceFrustumsZ),K.setFloat("cascadeBlendFactor"+t,0===this.cascadeBlendPercentage?1e4:1/this.cascadeBlendPercentage),K.setArray("frustumLengths"+t,this._frustumLengths),this._filter===W.o.FILTER_PCF)K.setDepthStencilTexture("shadowTexture"+t,G),D._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),N,1/N,this.frustumEdgeFalloff,t);else if(this._filter===W.o.FILTER_PCSS){for(let t=0;t<this._numCascades;++t)this._lightSizeUVCorrection[2*t+0]=0===t?1:(this._cascadeMaxExtents[0].x-this._cascadeMinExtents[0].x)/(this._cascadeMaxExtents[t].x-this._cascadeMinExtents[t].x),this._lightSizeUVCorrection[2*t+1]=0===t?1:(this._cascadeMaxExtents[0].y-this._cascadeMinExtents[0].y)/(this._cascadeMaxExtents[t].y-this._cascadeMinExtents[t].y),this._depthCorrection[t]=0===t?1:(this._cascadeMaxExtents[t].z-this._cascadeMinExtents[t].z)/(this._cascadeMaxExtents[0].z-this._cascadeMinExtents[0].z);K.setDepthStencilTexture("shadowTexture"+t,G),K.setTexture("depthTexture"+t,G),K.setArray2("lightSizeUVCorrection"+t,this._lightSizeUVCorrection),K.setArray("depthCorrection"+t,this._depthCorrection),K.setFloat("penumbraDarkness"+t,this.penumbraDarkness),D._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),1/N,this._contactHardeningLightSizeUVRatio*N,this.frustumEdgeFalloff,t)}else K.setTexture("shadowTexture"+t,G),D._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),N,1/N,this.frustumEdgeFalloff,t);D._uniformBuffer.updateFloat2("depthValues",this.getLight().getDepthMinZ(a),this.getLight().getDepthMinZ(a)+this.getLight().getDepthMaxZ(a),t)}getTransformMatrix(){return this.getCascadeTransformMatrix(0)}dispose(){super.dispose(),this._freezeShadowCastersBoundingInfoObservable&&(this._scene.onBeforeRenderObservable.remove(this._freezeShadowCastersBoundingInfoObservable),this._freezeShadowCastersBoundingInfoObservable=null),this._depthReducer&&(this._depthReducer.dispose(),this._depthReducer=null)}serialize(){const t=super.serialize(),K=this.getShadowMap();if(!K)return t;if(t.numCascades=this._numCascades,t.debug=this._debug,t.stabilizeCascades=this.stabilizeCascades,t.lambda=this._lambda,t.cascadeBlendPercentage=this.cascadeBlendPercentage,t.depthClamp=this._depthClamp,t.autoCalcDepthBounds=this.autoCalcDepthBounds,t.shadowMaxZ=this._shadowMaxZ,t.penumbraDarkness=this.penumbraDarkness,t.freezeShadowCastersBoundingInfo=this._freezeShadowCastersBoundingInfo,t.minDistance=this.minDistance,t.maxDistance=this.maxDistance,t.renderList=[],K.renderList)for(let D=0;D<K.renderList.length;D++){const a=K.renderList[D];t.renderList.push(a.id)}return t}static Parse(t,K){const D=W.o.Parse(t,K,((t,K,D)=>new m(t,K,void 0,D)));return void 0!==t.numCascades&&(D.numCascades=t.numCascades),void 0!==t.debug&&(D.debug=t.debug),void 0!==t.stabilizeCascades&&(D.stabilizeCascades=t.stabilizeCascades),void 0!==t.lambda&&(D.lambda=t.lambda),void 0!==t.cascadeBlendPercentage&&(D.cascadeBlendPercentage=t.cascadeBlendPercentage),void 0!==t.depthClamp&&(D.depthClamp=t.depthClamp),void 0!==t.autoCalcDepthBounds&&(D.autoCalcDepthBounds=t.autoCalcDepthBounds),void 0!==t.shadowMaxZ&&(D.shadowMaxZ=t.shadowMaxZ),void 0!==t.penumbraDarkness&&(D.penumbraDarkness=t.penumbraDarkness),void 0!==t.freezeShadowCastersBoundingInfo&&(D.freezeShadowCastersBoundingInfo=t.freezeShadowCastersBoundingInfo),void 0!==t.minDistance&&void 0!==t.maxDistance&&D.setMinMaxDistance(t.minDistance,t.maxDistance),D}}m._FrustumCornersNDCSpace=[new a.Pq(-1,+1,-1),new a.Pq(+1,+1,-1),new a.Pq(+1,-1,-1),new a.Pq(-1,-1,-1),new a.Pq(-1,+1,+1),new a.Pq(+1,+1,+1),new a.Pq(+1,-1,+1),new a.Pq(-1,-1,+1)],m.CLASSNAME="CascadedShadowGenerator",m.DEFAULT_CASCADES_COUNT=4,m.MIN_CASCADES_COUNT=2,m.MAX_CASCADES_COUNT=4,m._SceneComponentInitialization=t=>{throw N.n("ShadowGeneratorSceneComponent")}},675100:(t,K,D)=>{D.d(K,{o:()=>d});var a=D(604910),G=D(332290),N=D(23987),W=D(349487),x=D(432050),b=D(888413),n=D(850034),e=D(958413),i=D(638113),z=D(554014),I=D(522208),Z=D(809319),w=D(964061),m=D(651577),u=D(855300);class d{get bias(){return this._bias}set bias(t){this._bias=t}get normalBias(){return this._normalBias}set normalBias(t){this._normalBias=t}get blurBoxOffset(){return this._blurBoxOffset}set blurBoxOffset(t){this._blurBoxOffset!==t&&(this._blurBoxOffset=t,this._disposeBlurPostProcesses())}get blurScale(){return this._blurScale}set blurScale(t){this._blurScale!==t&&(this._blurScale=t,this._disposeBlurPostProcesses())}get blurKernel(){return this._blurKernel}set blurKernel(t){this._blurKernel!==t&&(this._blurKernel=t,this._disposeBlurPostProcesses())}get useKernelBlur(){return this._useKernelBlur}set useKernelBlur(t){this._useKernelBlur!==t&&(this._useKernelBlur=t,this._disposeBlurPostProcesses())}get depthScale(){return void 0!==this._depthScale?this._depthScale:this._light.getDepthScale()}set depthScale(t){this._depthScale=t}_validateFilter(t){return t}get filter(){return this._filter}set filter(t){if(t=this._validateFilter(t),this._light.needCube()){if(t===d.FILTER_BLUREXPONENTIALSHADOWMAP)return void(this.useExponentialShadowMap=!0);if(t===d.FILTER_BLURCLOSEEXPONENTIALSHADOWMAP)return void(this.useCloseExponentialShadowMap=!0);if(t===d.FILTER_PCF||t===d.FILTER_PCSS)return void(this.usePoissonSampling=!0)}t!==d.FILTER_PCF&&t!==d.FILTER_PCSS||this._scene.getEngine()._features.supportShadowSamplers?this._filter!==t&&(this._filter=t,this._disposeBlurPostProcesses(),this._applyFilterValues(),this._light._markMeshesAsLightDirty()):this.usePoissonSampling=!0}get usePoissonSampling(){return this.filter===d.FILTER_POISSONSAMPLING}set usePoissonSampling(t){const K=this._validateFilter(d.FILTER_POISSONSAMPLING);(t||this.filter===d.FILTER_POISSONSAMPLING)&&(this.filter=t?K:d.FILTER_NONE)}get useExponentialShadowMap(){return this.filter===d.FILTER_EXPONENTIALSHADOWMAP}set useExponentialShadowMap(t){const K=this._validateFilter(d.FILTER_EXPONENTIALSHADOWMAP);(t||this.filter===d.FILTER_EXPONENTIALSHADOWMAP)&&(this.filter=t?K:d.FILTER_NONE)}get useBlurExponentialShadowMap(){return this.filter===d.FILTER_BLUREXPONENTIALSHADOWMAP}set useBlurExponentialShadowMap(t){const K=this._validateFilter(d.FILTER_BLUREXPONENTIALSHADOWMAP);(t||this.filter===d.FILTER_BLUREXPONENTIALSHADOWMAP)&&(this.filter=t?K:d.FILTER_NONE)}get useCloseExponentialShadowMap(){return this.filter===d.FILTER_CLOSEEXPONENTIALSHADOWMAP}set useCloseExponentialShadowMap(t){const K=this._validateFilter(d.FILTER_CLOSEEXPONENTIALSHADOWMAP);(t||this.filter===d.FILTER_CLOSEEXPONENTIALSHADOWMAP)&&(this.filter=t?K:d.FILTER_NONE)}get useBlurCloseExponentialShadowMap(){return this.filter===d.FILTER_BLURCLOSEEXPONENTIALSHADOWMAP}set useBlurCloseExponentialShadowMap(t){const K=this._validateFilter(d.FILTER_BLURCLOSEEXPONENTIALSHADOWMAP);(t||this.filter===d.FILTER_BLURCLOSEEXPONENTIALSHADOWMAP)&&(this.filter=t?K:d.FILTER_NONE)}get usePercentageCloserFiltering(){return this.filter===d.FILTER_PCF}set usePercentageCloserFiltering(t){const K=this._validateFilter(d.FILTER_PCF);(t||this.filter===d.FILTER_PCF)&&(this.filter=t?K:d.FILTER_NONE)}get filteringQuality(){return this._filteringQuality}set filteringQuality(t){this._filteringQuality!==t&&(this._filteringQuality=t,this._disposeBlurPostProcesses(),this._applyFilterValues(),this._light._markMeshesAsLightDirty())}get useContactHardeningShadow(){return this.filter===d.FILTER_PCSS}set useContactHardeningShadow(t){const K=this._validateFilter(d.FILTER_PCSS);(t||this.filter===d.FILTER_PCSS)&&(this.filter=t?K:d.FILTER_NONE)}get contactHardeningLightSizeUVRatio(){return this._contactHardeningLightSizeUVRatio}set contactHardeningLightSizeUVRatio(t){this._contactHardeningLightSizeUVRatio=t}get darkness(){return this._darkness}set darkness(t){this.setDarkness(t)}getDarkness(){return this._darkness}setDarkness(t){return this._darkness=t>=1?1:t<=0?0:t,this}get transparencyShadow(){return this._transparencyShadow}set transparencyShadow(t){this.setTransparencyShadow(t)}setTransparencyShadow(t){return this._transparencyShadow=t,this}getShadowMap(){return this._shadowMap}getShadowMapForRendering(){return this._shadowMap2?this._shadowMap2:this._shadowMap}getClassName(){return d.CLASSNAME}addShadowCaster(t,K=!0){if(!this._shadowMap)return this;if(this._shadowMap.renderList||(this._shadowMap.renderList=[]),-1===this._shadowMap.renderList.indexOf(t)&&this._shadowMap.renderList.push(t),K)for(const K of t.getChildMeshes())-1===this._shadowMap.renderList.indexOf(K)&&this._shadowMap.renderList.push(K);return this}removeShadowCaster(t,K=!0){if(!this._shadowMap||!this._shadowMap.renderList)return this;const D=this._shadowMap.renderList.indexOf(t);if(-1!==D&&this._shadowMap.renderList.splice(D,1),K)for(const K of t.getChildren())this.removeShadowCaster(K);return this}getLight(){return this._light}get shaderLanguage(){return this._shaderLanguage}_getCamera(){var t;return null!==(t=this._camera)&&void 0!==t?t:this._scene.activeCamera}get mapSize(){return this._mapSize}set mapSize(t){this._mapSize=t,this._light._markMeshesAsLightDirty(),this.recreateShadowMap()}constructor(t,K,D,G,N,W=!1){this.onBeforeShadowMapRenderObservable=new i.cP,this.onAfterShadowMapRenderObservable=new i.cP,this.onBeforeShadowMapRenderMeshObservable=new i.cP,this.onAfterShadowMapRenderMeshObservable=new i.cP,this._bias=5e-5,this._normalBias=0,this._blurBoxOffset=1,this._blurScale=2,this._blurKernel=1,this._useKernelBlur=!1,this._filter=d.FILTER_NONE,this._filteringQuality=d.QUALITY_HIGH,this._contactHardeningLightSizeUVRatio=.1,this._darkness=0,this._transparencyShadow=!1,this.enableSoftTransparentShadow=!1,this.useOpacityTextureForTransparentShadow=!1,this.frustumEdgeFalloff=0,this._shaderLanguage=0,this.forceBackFacesOnly=!1,this._lightDirection=a.Pq.Zero(),this._viewMatrix=a.uq.Zero(),this._projectionMatrix=a.uq.Zero(),this._transformMatrix=a.uq.Zero(),this._cachedPosition=new a.Pq(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cachedDirection=new a.Pq(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._currentFaceIndex=0,this._currentFaceIndexCache=0,this._defaultTextureMatrix=a.uq.Identity(),this._shadersLoaded=!1,this._mapSize=t,this._light=K,this._scene=K.getScene(),this._camera=null!=G?G:null,this._useRedTextureType=!!N,this._initShaderSourceAsync(W);let x=K._shadowGenerators;x||(x=K._shadowGenerators=new Map),x.set(this._camera,this),this.id=K.id,this._useUBO=this._scene.getEngine().supportsUniformBuffers,this._useUBO&&(this._sceneUBOs=[],this._sceneUBOs.push(this._scene.createSceneUniformBuffer(`Scene for Shadow Generator (light "${this._light.name}")`))),d._SceneComponentInitialization(this._scene);const b=this._scene.getEngine().getCaps();D?b.textureFloatRender&&b.textureFloatLinearFiltering?this._textureType=1:b.textureHalfFloatRender&&b.textureHalfFloatLinearFiltering?this._textureType=2:this._textureType=0:b.textureHalfFloatRender&&b.textureHalfFloatLinearFiltering?this._textureType=2:b.textureFloatRender&&b.textureFloatLinearFiltering?this._textureType=1:this._textureType=0,this._initializeGenerator(),this._applyFilterValues()}_initializeGenerator(){this._light._markMeshesAsLightDirty(),this._initializeShadowMap()}_createTargetRenderTexture(){const t=this._scene.getEngine();t._features.supportDepthStencilTexture?(this._shadowMap=new b.$(this._light.name+"_shadowMap",this._mapSize,this._scene,!1,!0,this._textureType,this._light.needCube(),void 0,!1,!1,void 0,this._useRedTextureType?6:5),this._shadowMap.createDepthStencilTexture(t.useReverseDepthBuffer?516:513,!0,void 0,void 0,void 0,`DepthStencilForShadowGenerator-${this._light.name}`)):this._shadowMap=new b.$(this._light.name+"_shadowMap",this._mapSize,this._scene,!1,!0,this._textureType,this._light.needCube()),this._shadowMap.noPrePassRenderer=!0}_initializeShadowMap(){if(this._createTargetRenderTexture(),null===this._shadowMap)return;this._shadowMap.wrapU=x.g.CLAMP_ADDRESSMODE,this._shadowMap.wrapV=x.g.CLAMP_ADDRESSMODE,this._shadowMap.anisotropicFilteringLevel=1,this._shadowMap.updateSamplingMode(x.g.BILINEAR_SAMPLINGMODE),this._shadowMap.renderParticles=!1,this._shadowMap.ignoreCameraViewport=!0,this._storedUniqueId&&(this._shadowMap.uniqueId=this._storedUniqueId),this._shadowMap.customRenderFunction=(t,K,D,a)=>this._renderForShadowMap(t,K,D,a),this._shadowMap.customIsReadyFunction=()=>!0;const t=this._scene.getEngine();this._shadowMap.onBeforeBindObservable.add((()=>{var K;this._currentSceneUBO=this._scene.getSceneUniformBuffer(),null===(K=t._debugPushGroup)||void 0===K||K.call(t,`shadow map generation for pass id ${t.currentRenderPassId}`,1)})),this._shadowMap.onBeforeRenderObservable.add((K=>{this._sceneUBOs&&this._scene.setSceneUniformBuffer(this._sceneUBOs[0]),this._currentFaceIndex=K,this._filter===d.FILTER_PCF&&t.setColorWrite(!1),this.getTransformMatrix(),this._scene.setTransformMatrix(this._viewMatrix,this._projectionMatrix),this._useUBO&&(this._scene.getSceneUniformBuffer().unbindEffect(),this._scene.finalizeSceneUbo())})),this._shadowMap.onAfterUnbindObservable.add((()=>{var K,D;if(this._sceneUBOs&&this._scene.setSceneUniformBuffer(this._currentSceneUBO),this._scene.updateTransformMatrix(),this._filter===d.FILTER_PCF&&t.setColorWrite(!0),!this.useBlurExponentialShadowMap&&!this.useBlurCloseExponentialShadowMap)return void(null===(K=t._debugPopGroup)||void 0===K||K.call(t,1));const a=this.getShadowMapForRendering();a&&(this._scene.postProcessManager.directRender(this._blurPostProcesses,a.renderTarget,!0),t.unBindFramebuffer(a.renderTarget,!0),null===(D=t._debugPopGroup)||void 0===D||D.call(t,1))}));const K=new G.ov(0,0,0,0),D=new G.ov(1,1,1,1);this._shadowMap.onClearObservable.add((t=>{this._filter===d.FILTER_PCF?t.clear(D,!1,!0,!1):this.useExponentialShadowMap||this.useBlurExponentialShadowMap?t.clear(K,!0,!0,!1):t.clear(D,!0,!0,!1)})),this._shadowMap.onResizeObservable.add((t=>{this._storedUniqueId=this._shadowMap.uniqueId,this._mapSize=t.getRenderSize(),this._light._markMeshesAsLightDirty(),this.recreateShadowMap()}));for(let t=Z.m.MIN_RENDERINGGROUPS;t<Z.m.MAX_RENDERINGGROUPS;t++)this._shadowMap.setRenderingAutoClearDepthStencil(t,!1)}async _initShaderSourceAsync(t=!1){!this._scene.getEngine().isWebGPU||t||d.ForceGLSL?await Promise.all([D.e(7075).then(D.bind(D,507075)),D.e(12235).then(D.bind(D,412235)),D.e(58047).then(D.bind(D,958047)),D.e(71635).then(D.bind(D,271635))]):(this._shaderLanguage=1,await Promise.all([D.e(5310).then(D.bind(D,105310)),D.e(51871).then(D.bind(D,151871)),D.e(44830).then(D.bind(D,144830)),D.e(92838).then(D.bind(D,792838))])),this._shadersLoaded=!0}_initializeBlurRTTAndPostProcesses(){const t=this._scene.getEngine(),K=this._mapSize/this.blurScale;this.useKernelBlur&&1===this.blurScale||(this._shadowMap2=new b.$(this._light.name+"_shadowMap2",K,this._scene,!1,!0,this._textureType,void 0,void 0,!1),this._shadowMap2.wrapU=x.g.CLAMP_ADDRESSMODE,this._shadowMap2.wrapV=x.g.CLAMP_ADDRESSMODE,this._shadowMap2.updateSamplingMode(x.g.BILINEAR_SAMPLINGMODE)),this.useKernelBlur?(this._kernelBlurXPostprocess=new e.j(this._light.name+"KernelBlurX",new a.I9(1,0),this.blurKernel,1,null,x.g.BILINEAR_SAMPLINGMODE,t,!1,this._textureType),this._kernelBlurXPostprocess.width=K,this._kernelBlurXPostprocess.height=K,this._kernelBlurXPostprocess.externalTextureSamplerBinding=!0,this._kernelBlurXPostprocess.onApplyObservable.add((t=>{t.setTexture("textureSampler",this._shadowMap)})),this._kernelBlurYPostprocess=new e.j(this._light.name+"KernelBlurY",new a.I9(0,1),this.blurKernel,1,null,x.g.BILINEAR_SAMPLINGMODE,t,!1,this._textureType),this._kernelBlurXPostprocess.autoClear=!1,this._kernelBlurYPostprocess.autoClear=!1,0===this._textureType&&(this._kernelBlurXPostprocess.packedFloat=!0,this._kernelBlurYPostprocess.packedFloat=!0),this._blurPostProcesses=[this._kernelBlurXPostprocess,this._kernelBlurYPostprocess]):(this._boxBlurPostprocess=new n.w(this._light.name+"DepthBoxBlur","depthBoxBlur",["screenSize","boxOffset"],[],1,null,x.g.BILINEAR_SAMPLINGMODE,t,!1,"#define OFFSET "+this._blurBoxOffset,this._textureType,void 0,void 0,void 0,void 0,this._shaderLanguage),this._boxBlurPostprocess.externalTextureSamplerBinding=!0,this._boxBlurPostprocess.onApplyObservable.add((t=>{t.setFloat2("screenSize",K,K),t.setTexture("textureSampler",this._shadowMap)})),this._boxBlurPostprocess.autoClear=!1,this._blurPostProcesses=[this._boxBlurPostprocess])}_renderForShadowMap(t,K,D,a){let G;if(a.length)for(G=0;G<a.length;G++)this._renderSubMeshForShadowMap(a.data[G]);for(G=0;G<t.length;G++)this._renderSubMeshForShadowMap(t.data[G]);for(G=0;G<K.length;G++)this._renderSubMeshForShadowMap(K.data[G]);if(this._transparencyShadow)for(G=0;G<D.length;G++)this._renderSubMeshForShadowMap(D.data[G],!0);else for(G=0;G<D.length;G++)D.data[G].getEffectiveMesh()._internalAbstractMeshDataInfo._isActiveIntermediate=!1}_bindCustomEffectForRenderSubMeshForShadowMap(t,K,D){K.setMatrix("viewProjection",this.getTransformMatrix())}_renderSubMeshForShadowMap(t,K=!1){var D,a;const G=t.getRenderingMesh(),N=t.getEffectiveMesh(),x=this._scene,b=x.getEngine(),n=t.getMaterial();if(N._internalAbstractMeshDataInfo._isActiveIntermediate=!1,!n||0===t.verticesCount||t._renderId===x.getRenderId())return;const e=x.useRightHandedSystem,i=N._getWorldMatrixDeterminant()<0;let z=n._getEffectiveOrientation(G);(i&&!e||!i&&e)&&(z=0===z?1:0);const I=0===z;b.setState(n.backFaceCulling,void 0,void 0,I,n.cullBackFaces);const Z=G._getInstancesRenderList(t._id,!!t.getReplacementMesh());if(Z.mustReturn)return;const d=b.getCaps().instancedArrays&&(null!==Z.visibleInstances[t._id]&&void 0!==Z.visibleInstances[t._id]||G.hasThinInstances);if(!this.customAllowRendering||this.customAllowRendering(t))if(this.isReady(t,d,K)){t._renderId=x.getRenderId();const e=n.shadowDepthWrapper,i=null!==(D=null==e?void 0:e.getEffect(t,this,b.currentRenderPassId))&&void 0!==D?D:t._getDrawWrapper(),z=w.E.GetEffect(i);b.enableEffect(i),d||G._bind(t,z,n.fillMode),this.getTransformMatrix(),z.setFloat3("biasAndScaleSM",this.bias,this.normalBias,this.depthScale),this.getLight().getTypeID()===W.v.LIGHTTYPEID_DIRECTIONALLIGHT?z.setVector3("lightDataSM",this._cachedDirection):z.setVector3("lightDataSM",this._cachedPosition);const I=this._getCamera();if(I&&z.setFloat2("depthValuesSM",this.getLight().getDepthMinZ(I),this.getLight().getDepthMinZ(I)+this.getLight().getDepthMaxZ(I)),K&&this.enableSoftTransparentShadow&&z.setFloat2("softTransparentShadowSM",N.visibility*n.alpha,(null===(a=this._opacityTexture)||void 0===a?void 0:a.getAlphaFromRGB)?1:0),e)t._setMainDrawWrapperOverride(i),e.standalone?e.baseMaterial.bindForSubMesh(N.getWorldMatrix(),G,t):n.bindForSubMesh(N.getWorldMatrix(),G,t),t._setMainDrawWrapperOverride(null);else{if(this._opacityTexture&&(z.setTexture("diffuseSampler",this._opacityTexture),z.setMatrix("diffuseMatrix",this._opacityTexture.getTextureMatrix()||this._defaultTextureMatrix)),G.useBones&&G.computeBonesUsingShaders&&G.skeleton){const t=G.skeleton;if(t.isUsingTextureForMatrices){const K=t.getTransformMatrixTexture(G);if(!K)return;z.setTexture("boneSampler",K),z.setFloat("boneTextureWidth",4*(t.bones.length+1))}else z.setMatrices("mBones",t.getTransformMatrices(G))}u.nR(G,z),G.morphTargetManager&&G.morphTargetManager.isUsingTextureForTargets&&G.morphTargetManager._bind(z);const K=t.getMesh().bakedVertexAnimationManager;K&&K.isEnabled&&K.bind(z,d),m.gS(z,n,x)}this._useUBO||e||this._bindCustomEffectForRenderSubMeshForShadowMap(t,z,N),u._8(z,this._scene.getSceneUniformBuffer()),this._scene.getSceneUniformBuffer().bindUniformBuffer();const E=N.getWorldMatrix();d&&(N.getMeshUniformBuffer().bindToEffect(z,"Mesh"),N.transferToEffect(E)),this.forceBackFacesOnly&&b.setState(!0,0,!1,!0,n.cullBackFaces),this.onBeforeShadowMapRenderMeshObservable.notifyObservers(G),this.onBeforeShadowMapRenderObservable.notifyObservers(z),G._processRendering(N,t,z,n.fillMode,Z,d,((t,K)=>{N===G||t?(N.getMeshUniformBuffer().bindToEffect(z,"Mesh"),N.transferToEffect(t?K:E)):(G.getMeshUniformBuffer().bindToEffect(z,"Mesh"),G.transferToEffect(K))})),this.forceBackFacesOnly&&b.setState(!0,0,!1,!1,n.cullBackFaces),this.onAfterShadowMapRenderObservable.notifyObservers(z),this.onAfterShadowMapRenderMeshObservable.notifyObservers(G)}else this._shadowMap&&this._shadowMap.resetRefreshCounter()}_applyFilterValues(){this._shadowMap&&(this.filter===d.FILTER_NONE||this.filter===d.FILTER_PCSS?this._shadowMap.updateSamplingMode(x.g.NEAREST_SAMPLINGMODE):this._shadowMap.updateSamplingMode(x.g.BILINEAR_SAMPLINGMODE))}forceCompilation(t,K){const D={useInstances:!1,...K},a=this.getShadowMap();if(!a)return void(t&&t(this));const G=a.renderList;if(!G)return void(t&&t(this));const N=[];for(const t of G)N.push(...t.subMeshes);if(0===N.length)return void(t&&t(this));let W=0;const x=()=>{var K,a;if(this._scene&&this._scene.getEngine()){for(;this.isReady(N[W],D.useInstances,null!==(a=null===(K=N[W].getMaterial())||void 0===K?void 0:K.needAlphaBlendingForMesh(N[W].getMesh()))&&void 0!==a&&a);)if(W++,W>=N.length)return void(t&&t(this));setTimeout(x,16)}};x()}forceCompilationAsync(t){return new Promise((K=>{this.forceCompilation((()=>{K()}),t)}))}_isReadyCustomDefines(t,K,D){}_prepareShadowDefines(t,K,D,a){D.push("#define SM_LIGHTTYPE_"+this._light.getClassName().toUpperCase()),D.push("#define SM_FLOAT "+(0!==this._textureType?"1":"0")),D.push("#define SM_ESM "+(this.useExponentialShadowMap||this.useBlurExponentialShadowMap?"1":"0")),D.push("#define SM_DEPTHTEXTURE "+(this.usePercentageCloserFiltering||this.useContactHardeningShadow?"1":"0"));const G=t.getMesh();return D.push("#define SM_NORMALBIAS "+(this.normalBias&&G.isVerticesDataPresent(N.R.NormalKind)?"1":"0")),D.push("#define SM_DIRECTIONINLIGHTDATA "+(this.getLight().getTypeID()===W.v.LIGHTTYPEID_DIRECTIONALLIGHT?"1":"0")),D.push("#define SM_USEDISTANCE "+(this._light.needCube()?"1":"0")),D.push("#define SM_SOFTTRANSPARENTSHADOW "+(this.enableSoftTransparentShadow&&a?"1":"0")),this._isReadyCustomDefines(D,t,K),D}isReady(t,K,D){var a;if(!this._shadersLoaded)return!1;const G=t.getMaterial(),W=null==G?void 0:G.shadowDepthWrapper;if(this._opacityTexture=null,!G)return!1;const x=[];if(this._prepareShadowDefines(t,K,x,D),W){if(!W.isReadyForSubMesh(t,x,this,K,this._scene.getEngine().currentRenderPassId))return!1}else{const D=t._getDrawWrapper(void 0,!0);let W=D.effect,b=D.defines;const n=[N.R.PositionKind],e=t.getMesh();this.normalBias&&e.isVerticesDataPresent(N.R.NormalKind)&&(n.push(N.R.NormalKind),x.push("#define NORMAL"),e.nonUniformScaling&&x.push("#define NONUNIFORMSCALING"));const i=G.needAlphaTesting();if((i||G.needAlphaBlending())&&(this.useOpacityTextureForTransparentShadow?this._opacityTexture=G.opacityTexture:this._opacityTexture=G.getAlphaTestTexture(),this._opacityTexture)){if(!this._opacityTexture.isReady())return!1;const t=null!==(a=G.alphaCutOff)&&void 0!==a?a:d.DEFAULT_ALPHA_CUTOFF;x.push("#define ALPHATEXTURE"),i&&x.push(`#define ALPHATESTVALUE ${t}${t%1==0?".":""}`),e.isVerticesDataPresent(N.R.UVKind)&&(n.push(N.R.UVKind),x.push("#define UV1")),e.isVerticesDataPresent(N.R.UV2Kind)&&1===this._opacityTexture.coordinatesIndex&&(n.push(N.R.UV2Kind),x.push("#define UV2"))}const z=new I.J;if(e.useBones&&e.computeBonesUsingShaders&&e.skeleton){n.push(N.R.MatricesIndicesKind),n.push(N.R.MatricesWeightsKind),e.numBoneInfluencers>4&&(n.push(N.R.MatricesIndicesExtraKind),n.push(N.R.MatricesWeightsExtraKind));const t=e.skeleton;x.push("#define NUM_BONE_INFLUENCERS "+e.numBoneInfluencers),e.numBoneInfluencers>0&&z.addCPUSkinningFallback(0,e),t.isUsingTextureForMatrices?x.push("#define BONETEXTURE"):x.push("#define BonesPerMesh "+(t.bones.length+1))}else x.push("#define NUM_BONE_INFLUENCERS 0");const Z=e.morphTargetManager;let w=0;if(Z&&(w=Z.numMaxInfluencers||Z.numInfluencers,w>0&&(x.push("#define MORPHTARGETS"),x.push("#define NUM_MORPH_INFLUENCERS "+w),Z.isUsingTextureForTargets&&x.push("#define MORPHTARGETS_TEXTURE"),u.MF(n,e,w))),m.tv(G,this._scene,x),K&&(x.push("#define INSTANCES"),u.te(n),t.getRenderingMesh().hasThinInstances&&x.push("#define THIN_INSTANCES")),this.customShaderOptions&&this.customShaderOptions.defines)for(const t of this.customShaderOptions.defines)-1===x.indexOf(t)&&x.push(t);const E=e.bakedVertexAnimationManager;E&&E.isEnabled&&(x.push("#define BAKED_VERTEX_ANIMATION_TEXTURE"),K&&n.push("bakedVertexAnimationSettingsInstanced"));const l=x.join("\n");if(b!==l){b=l;let t="shadowMap";const K=["world","mBones","viewProjection","diffuseMatrix","lightDataSM","depthValuesSM","biasAndScaleSM","morphTargetInfluences","morphTargetCount","boneTextureWidth","softTransparentShadowSM","morphTargetTextureInfo","morphTargetTextureIndices","bakedVertexAnimationSettings","bakedVertexAnimationTextureSizeInverted","bakedVertexAnimationTime","bakedVertexAnimationTexture"],a=["diffuseSampler","boneSampler","morphTargets","bakedVertexAnimationTexture"],G=["Scene","Mesh"];if(m.TV(K),this.customShaderOptions){if(t=this.customShaderOptions.shaderName,this.customShaderOptions.attributes)for(const t of this.customShaderOptions.attributes)-1===n.indexOf(t)&&n.push(t);if(this.customShaderOptions.uniforms)for(const t of this.customShaderOptions.uniforms)-1===K.indexOf(t)&&K.push(t);if(this.customShaderOptions.samplers)for(const t of this.customShaderOptions.samplers)-1===a.indexOf(t)&&a.push(t)}const N=this._scene.getEngine();W=N.createEffect(t,{attributes:n,uniformsNames:K,uniformBuffersNames:G,samplers:a,defines:l,fallbacks:z,onCompiled:null,onError:null,indexParameters:{maxSimultaneousMorphTargets:w},shaderLanguage:this._shaderLanguage},N),D.setEffect(W,b)}if(!W.isReady())return!1}return(this.useBlurExponentialShadowMap||this.useBlurCloseExponentialShadowMap)&&(this._blurPostProcesses&&this._blurPostProcesses.length||this._initializeBlurRTTAndPostProcesses()),!(this._kernelBlurXPostprocess&&!this._kernelBlurXPostprocess.isReady()||this._kernelBlurYPostprocess&&!this._kernelBlurYPostprocess.isReady()||this._boxBlurPostprocess&&!this._boxBlurPostprocess.isReady())}prepareDefines(t,K){const D=this._scene,a=this._light;D.shadowsEnabled&&a.shadowEnabled&&(t["SHADOW"+K]=!0,this.useContactHardeningShadow?(t["SHADOWPCSS"+K]=!0,this._filteringQuality===d.QUALITY_LOW?t["SHADOWLOWQUALITY"+K]=!0:this._filteringQuality===d.QUALITY_MEDIUM&&(t["SHADOWMEDIUMQUALITY"+K]=!0)):this.usePercentageCloserFiltering?(t["SHADOWPCF"+K]=!0,this._filteringQuality===d.QUALITY_LOW?t["SHADOWLOWQUALITY"+K]=!0:this._filteringQuality===d.QUALITY_MEDIUM&&(t["SHADOWMEDIUMQUALITY"+K]=!0)):this.usePoissonSampling?t["SHADOWPOISSON"+K]=!0:this.useExponentialShadowMap||this.useBlurExponentialShadowMap?t["SHADOWESM"+K]=!0:(this.useCloseExponentialShadowMap||this.useBlurCloseExponentialShadowMap)&&(t["SHADOWCLOSEESM"+K]=!0),a.needCube()&&(t["SHADOWCUBE"+K]=!0))}bindShadowLight(t,K){const D=this._light;if(!this._scene.shadowsEnabled||!D.shadowEnabled)return;const a=this._getCamera();if(!a)return;const G=this.getShadowMap();if(!G)return;D.needCube()||K.setMatrix("lightMatrix"+t,this.getTransformMatrix());const N=this.getShadowMapForRendering();this._filter===d.FILTER_PCF?(K.setDepthStencilTexture("shadowTexture"+t,N),D._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),G.getSize().width,1/G.getSize().width,this.frustumEdgeFalloff,t)):this._filter===d.FILTER_PCSS?(K.setDepthStencilTexture("shadowTexture"+t,N),K.setTexture("depthTexture"+t,N),D._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),1/G.getSize().width,this._contactHardeningLightSizeUVRatio*G.getSize().width,this.frustumEdgeFalloff,t)):(K.setTexture("shadowTexture"+t,N),D._uniformBuffer.updateFloat4("shadowsInfo",this.getDarkness(),this.blurScale/G.getSize().width,this.depthScale,this.frustumEdgeFalloff,t)),D._uniformBuffer.updateFloat2("depthValues",this.getLight().getDepthMinZ(a),this.getLight().getDepthMinZ(a)+this.getLight().getDepthMaxZ(a),t)}get viewMatrix(){return this._viewMatrix}get projectionMatrix(){return this._projectionMatrix}getTransformMatrix(){const t=this._scene;if(this._currentRenderId===t.getRenderId()&&this._currentFaceIndexCache===this._currentFaceIndex)return this._transformMatrix;this._currentRenderId=t.getRenderId(),this._currentFaceIndexCache=this._currentFaceIndex;let K=this._light.position;if(this._light.computeTransformedInformation()&&(K=this._light.transformedPosition),a.Pq.NormalizeToRef(this._light.getShadowDirection(this._currentFaceIndex),this._lightDirection),1===Math.abs(a.Pq.Dot(this._lightDirection,a.Pq.Up()))&&(this._lightDirection.z=1e-13),this._light.needProjectionMatrixCompute()||!this._cachedPosition||!this._cachedDirection||!K.equals(this._cachedPosition)||!this._lightDirection.equals(this._cachedDirection)){this._cachedPosition.copyFrom(K),this._cachedDirection.copyFrom(this._lightDirection),a.uq.LookAtLHToRef(K,K.add(this._lightDirection),a.Pq.Up(),this._viewMatrix);const t=this.getShadowMap();if(t){const K=t.renderList;K&&this._light.setShadowProjectionMatrix(this._projectionMatrix,this._viewMatrix,K)}this._viewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix)}return this._transformMatrix}recreateShadowMap(){const t=this._shadowMap;if(!t)return;const K=t.renderList;if(this._disposeRTTandPostProcesses(),this._initializeGenerator(),this.filter=this._filter,this._applyFilterValues(),K){this._shadowMap.renderList||(this._shadowMap.renderList=[]);for(const t of K)this._shadowMap.renderList.push(t)}else this._shadowMap.renderList=null}_disposeBlurPostProcesses(){this._shadowMap2&&(this._shadowMap2.dispose(),this._shadowMap2=null),this._boxBlurPostprocess&&(this._boxBlurPostprocess.dispose(),this._boxBlurPostprocess=null),this._kernelBlurXPostprocess&&(this._kernelBlurXPostprocess.dispose(),this._kernelBlurXPostprocess=null),this._kernelBlurYPostprocess&&(this._kernelBlurYPostprocess.dispose(),this._kernelBlurYPostprocess=null),this._blurPostProcesses=[]}_disposeRTTandPostProcesses(){this._shadowMap&&(this._shadowMap.dispose(),this._shadowMap=null),this._disposeBlurPostProcesses()}_disposeSceneUBOs(){if(this._sceneUBOs){for(const t of this._sceneUBOs)t.dispose();this._sceneUBOs=[]}}dispose(){if(this._disposeRTTandPostProcesses(),this._disposeSceneUBOs(),this._light){if(this._light._shadowGenerators){const t=this._light._shadowGenerators.entries();for(let K=t.next();!0!==K.done;K=t.next()){const[t,D]=K.value;D===this&&this._light._shadowGenerators.delete(t)}0===this._light._shadowGenerators.size&&(this._light._shadowGenerators=null)}this._light._markMeshesAsLightDirty()}this.onBeforeShadowMapRenderMeshObservable.clear(),this.onBeforeShadowMapRenderObservable.clear(),this.onAfterShadowMapRenderMeshObservable.clear(),this.onAfterShadowMapRenderObservable.clear()}serialize(){var t;const K={},D=this.getShadowMap();if(!D)return K;if(K.className=this.getClassName(),K.lightId=this._light.id,K.cameraId=null===(t=this._camera)||void 0===t?void 0:t.id,K.id=this.id,K.mapSize=D.getRenderSize(),K.forceBackFacesOnly=this.forceBackFacesOnly,K.darkness=this.getDarkness(),K.transparencyShadow=this._transparencyShadow,K.frustumEdgeFalloff=this.frustumEdgeFalloff,K.bias=this.bias,K.normalBias=this.normalBias,K.usePercentageCloserFiltering=this.usePercentageCloserFiltering,K.useContactHardeningShadow=this.useContactHardeningShadow,K.contactHardeningLightSizeUVRatio=this.contactHardeningLightSizeUVRatio,K.filteringQuality=this.filteringQuality,K.useExponentialShadowMap=this.useExponentialShadowMap,K.useBlurExponentialShadowMap=this.useBlurExponentialShadowMap,K.useCloseExponentialShadowMap=this.useBlurExponentialShadowMap,K.useBlurCloseExponentialShadowMap=this.useBlurExponentialShadowMap,K.usePoissonSampling=this.usePoissonSampling,K.depthScale=this.depthScale,K.blurBoxOffset=this.blurBoxOffset,K.blurKernel=this.blurKernel,K.blurScale=this.blurScale,K.useKernelBlur=this.useKernelBlur,K.renderList=[],D.renderList)for(let t=0;t<D.renderList.length;t++){const a=D.renderList[t];K.renderList.push(a.id)}return K}static Parse(t,K,D){const a=K.getLightById(t.lightId),G=void 0!==t.cameraId?K.getCameraById(t.cameraId):null,N=D?D(t.mapSize,a,G):new d(t.mapSize,a,void 0,G),W=N.getShadowMap();for(let D=0;D<t.renderList.length;D++)K.getMeshesById(t.renderList[D]).forEach((function(t){W&&(W.renderList||(W.renderList=[]),W.renderList.push(t))}));return void 0!==t.id&&(N.id=t.id),N.forceBackFacesOnly=!!t.forceBackFacesOnly,void 0!==t.darkness&&N.setDarkness(t.darkness),t.transparencyShadow&&N.setTransparencyShadow(!0),void 0!==t.frustumEdgeFalloff&&(N.frustumEdgeFalloff=t.frustumEdgeFalloff),void 0!==t.bias&&(N.bias=t.bias),void 0!==t.normalBias&&(N.normalBias=t.normalBias),t.usePercentageCloserFiltering?N.usePercentageCloserFiltering=!0:t.useContactHardeningShadow?N.useContactHardeningShadow=!0:t.usePoissonSampling?N.usePoissonSampling=!0:t.useExponentialShadowMap?N.useExponentialShadowMap=!0:t.useBlurExponentialShadowMap?N.useBlurExponentialShadowMap=!0:t.useCloseExponentialShadowMap?N.useCloseExponentialShadowMap=!0:t.useBlurCloseExponentialShadowMap?N.useBlurCloseExponentialShadowMap=!0:t.useVarianceShadowMap?N.useExponentialShadowMap=!0:t.useBlurVarianceShadowMap&&(N.useBlurExponentialShadowMap=!0),void 0!==t.contactHardeningLightSizeUVRatio&&(N.contactHardeningLightSizeUVRatio=t.contactHardeningLightSizeUVRatio),void 0!==t.filteringQuality&&(N.filteringQuality=t.filteringQuality),t.depthScale&&(N.depthScale=t.depthScale),t.blurScale&&(N.blurScale=t.blurScale),t.blurBoxOffset&&(N.blurBoxOffset=t.blurBoxOffset),t.useKernelBlur&&(N.useKernelBlur=t.useKernelBlur),t.blurKernel&&(N.blurKernel=t.blurKernel),N}}d.CLASSNAME="ShadowGenerator",d.ForceGLSL=!1,d.FILTER_NONE=0,d.FILTER_EXPONENTIALSHADOWMAP=1,d.FILTER_POISSONSAMPLING=2,d.FILTER_BLUREXPONENTIALSHADOWMAP=3,d.FILTER_CLOSEEXPONENTIALSHADOWMAP=4,d.FILTER_BLURCLOSEEXPONENTIALSHADOWMAP=5,d.FILTER_PCF=6,d.FILTER_PCSS=7,d.QUALITY_HIGH=0,d.QUALITY_MEDIUM=1,d.QUALITY_LOW=2,d.DEFAULT_ALPHA_CUTOFF=.5,d._SceneComponentInitialization=t=>{throw z.n("ShadowGeneratorSceneComponent")}},625735:(t,K,D)=>{var a=D(675100),G=D(214413),N=D(122030);D(837475).d.AddParser(N.v.NAME_SHADOWGENERATOR,((t,K)=>{if(void 0!==t.shadowGenerators&&null!==t.shadowGenerators)for(let D=0,N=t.shadowGenerators.length;D<N;D++){const N=t.shadowGenerators[D];N.className===G.c.CLASSNAME?G.c.Parse(N,K):a.o.Parse(N,K)}}));class W{constructor(t){this.name=N.v.NAME_SHADOWGENERATOR,this.scene=t}register(){this.scene._gatherRenderTargetsStage.registerStep(N.v.STEP_GATHERRENDERTARGETS_SHADOWGENERATOR,this,this._gatherRenderTargets)}rebuild(){}serialize(t){t.shadowGenerators=[];const K=this.scene.lights;for(const D of K){const K=D.getShadowGenerators();if(K){const D=K.values();for(let K=D.next();!0!==K.done;K=D.next()){const D=K.value;t.shadowGenerators.push(D.serialize())}}}}addFromContainer(t){}removeFromContainer(t,K){}dispose(){}_gatherRenderTargets(t){const K=this.scene;if(this.scene.shadowsEnabled)for(let D=0;D<K.lights.length;D++){const a=K.lights[D],G=a.getShadowGenerators();if(a.isEnabled()&&a.shadowEnabled&&G){const D=G.values();for(let a=D.next();!0!==a.done;a=D.next()){const D=a.value.getShadowMap();-1!==K.textures.indexOf(D)&&t.push(D)}}}}}a.o._SceneComponentInitialization=t=>{let K=t._getComponent(N.v.NAME_SHADOWGENERATOR);K||(K=new W(t),t._addComponent(K))}},349487:(t,K,D)=>{D.d(K,{v:()=>z});var a=D(297809),G=D(760998),N=D(604910),W=D(332290),x=D(869581),b=D(384898),n=D(310035),e=D(875830),i=D(337776);class z extends x.b{get range(){return this._range}set range(t){this._range=t,this._inverseSquaredRange=1/(this.range*this.range)}get intensityMode(){return this._intensityMode}set intensityMode(t){this._intensityMode=t,this._computePhotometricScale()}get radius(){return this._radius}set radius(t){this._radius=t,this._computePhotometricScale()}get shadowEnabled(){return this._shadowEnabled}set shadowEnabled(t){this._shadowEnabled!==t&&(this._shadowEnabled=t,this._markMeshesAsLightDirty())}get includedOnlyMeshes(){return this._includedOnlyMeshes}set includedOnlyMeshes(t){this._includedOnlyMeshes=t,this._hookArrayForIncludedOnly(t)}get excludedMeshes(){return this._excludedMeshes}set excludedMeshes(t){this._excludedMeshes=t,this._hookArrayForExcluded(t)}get excludeWithLayerMask(){return this._excludeWithLayerMask}set excludeWithLayerMask(t){this._excludeWithLayerMask=t,this._resyncMeshes()}get includeOnlyWithLayerMask(){return this._includeOnlyWithLayerMask}set includeOnlyWithLayerMask(t){this._includeOnlyWithLayerMask=t,this._resyncMeshes()}get lightmapMode(){return this._lightmapMode}set lightmapMode(t){this._lightmapMode!==t&&(this._lightmapMode=t,this._markMeshesAsLightDirty())}getViewMatrix(t){return null}getProjectionMatrix(t,K){return null}constructor(t,K){super(t,K,!1),this.diffuse=new W.v9(1,1,1),this.specular=new W.v9(1,1,1),this.falloffType=z.FALLOFF_DEFAULT,this.intensity=1,this._range=Number.MAX_VALUE,this._inverseSquaredRange=0,this._photometricScale=1,this._intensityMode=z.INTENSITYMODE_AUTOMATIC,this._radius=1e-5,this.renderPriority=0,this._shadowEnabled=!0,this._excludeWithLayerMask=0,this._includeOnlyWithLayerMask=0,this._lightmapMode=0,this._shadowGenerators=null,this._excludedMeshesIds=new Array,this._includedOnlyMeshesIds=new Array,this._isLight=!0,this.getScene().addLight(this),this._uniformBuffer=new b.D(this.getScene().getEngine(),void 0,void 0,t),this._buildUniformLayout(),this.includedOnlyMeshes=[],this.excludedMeshes=[],this._resyncMeshes()}transferTexturesToEffect(t,K){return this}_bindLight(t,K,D,a,G=!0){var N;const x=t.toString();let b=!1;if(this._uniformBuffer.bindToEffect(D,"Light"+x),this._renderId!==K.getRenderId()||this._lastUseSpecular!==a||!this._uniformBuffer.useUbo){this._renderId=K.getRenderId(),this._lastUseSpecular=a;const t=this.getScaledIntensity();this.transferToEffect(D,x),this.diffuse.scaleToRef(t,W.IG.Color3[0]),this._uniformBuffer.updateColor4("vLightDiffuse",W.IG.Color3[0],this.range,x),a&&(this.specular.scaleToRef(t,W.IG.Color3[1]),this._uniformBuffer.updateColor4("vLightSpecular",W.IG.Color3[1],this.radius,x)),b=!0}if(this.transferTexturesToEffect(D,x),K.shadowsEnabled&&this.shadowEnabled&&G){const t=null!==(N=this.getShadowGenerator(K.activeCamera))&&void 0!==N?N:this.getShadowGenerator();t&&(t.bindShadowLight(x,D),b=!0)}b?this._uniformBuffer.update():this._uniformBuffer.bindUniformBuffer()}getClassName(){return"Light"}toString(t){let K="Name: "+this.name;if(K+=", type: "+["Point","Directional","Spot","Hemispheric"][this.getTypeID()],this.animations)for(let D=0;D<this.animations.length;D++)K+=", animation[0]: "+this.animations[D].toString(t);return K}_syncParentEnabledState(){super._syncParentEnabledState(),this.isDisposed()||this._resyncMeshes()}setEnabled(t){super.setEnabled(t),this._resyncMeshes()}getShadowGenerator(t=null){var K;return null===this._shadowGenerators?null:null!==(K=this._shadowGenerators.get(t))&&void 0!==K?K:null}getShadowGenerators(){return this._shadowGenerators}getAbsolutePosition(){return N.Pq.Zero()}canAffectMesh(t){return!(t&&(this.includedOnlyMeshes&&this.includedOnlyMeshes.length>0&&-1===this.includedOnlyMeshes.indexOf(t)||this.excludedMeshes&&this.excludedMeshes.length>0&&-1!==this.excludedMeshes.indexOf(t)||!(0===this.includeOnlyWithLayerMask||this.includeOnlyWithLayerMask&t.layerMask)||0!==this.excludeWithLayerMask&&this.excludeWithLayerMask&t.layerMask))}dispose(t,K=!1){if(this._shadowGenerators){const t=this._shadowGenerators.values();for(let K=t.next();!0!==K.done;K=t.next())K.value.dispose();this._shadowGenerators=null}if(this.getScene().stopAnimation(this),this._parentContainer){const t=this._parentContainer.lights.indexOf(this);t>-1&&this._parentContainer.lights.splice(t,1),this._parentContainer=null}for(const t of this.getScene().meshes)t._removeLightSource(this,!0);this._uniformBuffer.dispose(),this.getScene().removeLight(this),super.dispose(t,K)}getTypeID(){return 0}getScaledIntensity(){return this._photometricScale*this.intensity}clone(t,K=null){const D=z.GetConstructorFromName(this.getTypeID(),t,this.getScene());if(!D)return null;const a=i.p.Clone(D,this);return t&&(a.name=t),K&&(a.parent=K),a.setEnabled(this.isEnabled()),this.onClonedObservable.notifyObservers(a),a}serialize(){const t=i.p.Serialize(this);return t.uniqueId=this.uniqueId,t.type=this.getTypeID(),this.parent&&this.parent._serializeAsParent(t),this.excludedMeshes.length>0&&(t.excludedMeshesIds=[],this.excludedMeshes.forEach((K=>{t.excludedMeshesIds.push(K.id)}))),this.includedOnlyMeshes.length>0&&(t.includedOnlyMeshesIds=[],this.includedOnlyMeshes.forEach((K=>{t.includedOnlyMeshesIds.push(K.id)}))),i.p.AppendSerializedAnimations(this,t),t.ranges=this.serializeAnimationRanges(),t.isEnabled=this.isEnabled(),t}static GetConstructorFromName(t,K,D){return x.b.Construct("Light_Type_"+t,K,D)||null}static Parse(t,K){const D=z.GetConstructorFromName(t.type,t.name,K);if(!D)return null;const a=i.p.Parse(D,t,K);if(t.excludedMeshesIds&&(a._excludedMeshesIds=t.excludedMeshesIds),t.includedOnlyMeshesIds&&(a._includedOnlyMeshesIds=t.includedOnlyMeshesIds),void 0!==t.parentId&&(a._waitingParentId=t.parentId),void 0!==t.parentInstanceIndex&&(a._waitingParentInstanceIndex=t.parentInstanceIndex),void 0!==t.falloffType&&(a.falloffType=t.falloffType),void 0!==t.lightmapMode&&(a.lightmapMode=t.lightmapMode),t.animations){for(let K=0;K<t.animations.length;K++){const D=t.animations[K],G=n.n9("BABYLON.Animation");G&&a.animations.push(G.Parse(D))}x.b.ParseAnimationRanges(a,t,K)}return t.autoAnimate&&K.beginAnimation(a,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,t.autoAnimateSpeed||1),void 0!==t.isEnabled&&a.setEnabled(t.isEnabled),a}_hookArrayForExcluded(t){const K=t.push;t.push=(...D)=>{const a=K.apply(t,D);for(const t of D)t._resyncLightSource(this);return a};const D=t.splice;t.splice=(K,a)=>{const G=D.apply(t,[K,a]);for(const t of G)t._resyncLightSource(this);return G};for(const K of t)K._resyncLightSource(this)}_hookArrayForIncludedOnly(t){const K=t.push;t.push=(...D)=>{const a=K.apply(t,D);return this._resyncMeshes(),a};const D=t.splice;t.splice=(K,a)=>{const G=D.apply(t,[K,a]);return this._resyncMeshes(),G},this._resyncMeshes()}_resyncMeshes(){for(const t of this.getScene().meshes)t._resyncLightSource(this)}_markMeshesAsLightDirty(){for(const t of this.getScene().meshes)-1!==t.lightSources.indexOf(this)&&t._markSubMeshesAsLightDirty()}_computePhotometricScale(){this._photometricScale=this._getPhotometricScale(),this.getScene().resetCachedMaterial()}_getPhotometricScale(){let t=0;const K=this.getTypeID();let D=this.intensityMode;switch(D===z.INTENSITYMODE_AUTOMATIC&&(D=K===z.LIGHTTYPEID_DIRECTIONALLIGHT?z.INTENSITYMODE_ILLUMINANCE:z.INTENSITYMODE_LUMINOUSINTENSITY),K){case z.LIGHTTYPEID_POINTLIGHT:case z.LIGHTTYPEID_SPOTLIGHT:switch(D){case z.INTENSITYMODE_LUMINOUSPOWER:t=1/(4*Math.PI);break;case z.INTENSITYMODE_LUMINOUSINTENSITY:t=1;break;case z.INTENSITYMODE_LUMINANCE:t=this.radius*this.radius}break;case z.LIGHTTYPEID_DIRECTIONALLIGHT:switch(D){case z.INTENSITYMODE_ILLUMINANCE:t=1;break;case z.INTENSITYMODE_LUMINANCE:{let K=this.radius;K=Math.max(K,.001),t=2*Math.PI*(1-Math.cos(K));break}}break;case z.LIGHTTYPEID_HEMISPHERICLIGHT:t=1}return t}_reorderLightsInScene(){const t=this.getScene();0!=this._renderPriority&&(t.requireLightSorting=!0),this.getScene().sortLightsByPriority()}}z.FALLOFF_DEFAULT=e.c.FALLOFF_DEFAULT,z.FALLOFF_PHYSICAL=e.c.FALLOFF_PHYSICAL,z.FALLOFF_GLTF=e.c.FALLOFF_GLTF,z.FALLOFF_STANDARD=e.c.FALLOFF_STANDARD,z.LIGHTMAP_DEFAULT=e.c.LIGHTMAP_DEFAULT,z.LIGHTMAP_SPECULAR=e.c.LIGHTMAP_SPECULAR,z.LIGHTMAP_SHADOWSONLY=e.c.LIGHTMAP_SHADOWSONLY,z.INTENSITYMODE_AUTOMATIC=e.c.INTENSITYMODE_AUTOMATIC,z.INTENSITYMODE_LUMINOUSPOWER=e.c.INTENSITYMODE_LUMINOUSPOWER,z.INTENSITYMODE_LUMINOUSINTENSITY=e.c.INTENSITYMODE_LUMINOUSINTENSITY,z.INTENSITYMODE_ILLUMINANCE=e.c.INTENSITYMODE_ILLUMINANCE,z.INTENSITYMODE_LUMINANCE=e.c.INTENSITYMODE_LUMINANCE,z.LIGHTTYPEID_POINTLIGHT=e.c.LIGHTTYPEID_POINTLIGHT,z.LIGHTTYPEID_DIRECTIONALLIGHT=e.c.LIGHTTYPEID_DIRECTIONALLIGHT,z.LIGHTTYPEID_SPOTLIGHT=e.c.LIGHTTYPEID_SPOTLIGHT,z.LIGHTTYPEID_HEMISPHERICLIGHT=e.c.LIGHTTYPEID_HEMISPHERICLIGHT,a.Cg([G.jT()],z.prototype,"diffuse",void 0),a.Cg([G.jT()],z.prototype,"specular",void 0),a.Cg([G.lK()],z.prototype,"falloffType",void 0),a.Cg([G.lK()],z.prototype,"intensity",void 0),a.Cg([G.lK()],z.prototype,"range",null),a.Cg([G.lK()],z.prototype,"intensityMode",null),a.Cg([G.lK()],z.prototype,"radius",null),a.Cg([G.lK()],z.prototype,"_renderPriority",void 0),a.Cg([G.$z("_reorderLightsInScene")],z.prototype,"renderPriority",void 0),a.Cg([G.lK("shadowEnabled")],z.prototype,"_shadowEnabled",void 0),a.Cg([G.lK("excludeWithLayerMask")],z.prototype,"_excludeWithLayerMask",void 0),a.Cg([G.lK("includeOnlyWithLayerMask")],z.prototype,"_includeOnlyWithLayerMask",void 0),a.Cg([G.lK("lightmapMode")],z.prototype,"_lightmapMode",void 0)},875830:(t,K,D)=>{D.d(K,{c:()=>a});class a{static CompareLightsPriority(t,K){return t.shadowEnabled!==K.shadowEnabled?(K.shadowEnabled?1:0)-(t.shadowEnabled?1:0):K.renderPriority-t.renderPriority}}a.FALLOFF_DEFAULT=0,a.FALLOFF_PHYSICAL=1,a.FALLOFF_GLTF=2,a.FALLOFF_STANDARD=3,a.LIGHTMAP_DEFAULT=0,a.LIGHTMAP_SPECULAR=1,a.LIGHTMAP_SHADOWSONLY=2,a.INTENSITYMODE_AUTOMATIC=0,a.INTENSITYMODE_LUMINOUSPOWER=1,a.INTENSITYMODE_LUMINOUSINTENSITY=2,a.INTENSITYMODE_ILLUMINANCE=3,a.INTENSITYMODE_LUMINANCE=4,a.LIGHTTYPEID_POINTLIGHT=0,a.LIGHTTYPEID_DIRECTIONALLIGHT=1,a.LIGHTTYPEID_SPOTLIGHT=2,a.LIGHTTYPEID_HEMISPHERICLIGHT=3},548949:(t,K,D)=>{D.d(K,{cn:()=>J});var a,G=D(898973),N=D(638113),W=D(889460),x=D(395726),b=D(706400),n=D(396574),e=D(435683),i=D(879808),z=D(977041),I=D(33321);(function(t){t[t["Clean"]=0]="Clean",t[t["Stop"]=1]="Stop",t[t["Sync"]=2]="Sync",t[t["NoSync"]=3]="NoSync"})(a||(a={}));const Z=new N.cP,w={};let m=!1;function u(){return w[".babylon"]}function d(t){return w[t]||(b.V.Warn("Unable to find a plugin to load "+t+" files. Trying to use .babylon default plugin. To load from a specific filetype (eg. gltf) see: https://doc.babylonjs.com/features/featuresDeepDive/importers/loadingFileTypes"),u())}function E(t,K,D){let a="Unable to load from "+(t.rawData?"binary data":t.url);return K?a+=`: ${K}`:D&&(a+=`: ${D}`),a}function l(t,K,D,a,G,N,W,x,b){var n;const i="data:"===(z=t.url).substr(0,5)?z.substr(5):null;var z;if(t.rawData&&!W)throw"When using ArrayBufferView to load data the file extension must be provided.";const m=W?d(W):i?function(t){for(const K in w){const D=w[K].plugin;if(D.canDirectLoad&&D.canDirectLoad(t))return w[K]}return u()}(t.url):function(t){const K=t.indexOf("?");-1!==K&&(t=t.substring(0,K));const D=t.lastIndexOf(".");return d(t.substring(D,t.length).toLowerCase())}(t.url);if(!m)throw new Error(`No plugin or fallback for ${null!=W?W:t.url}`);if(!1===(null===(n=null==b?void 0:b[m.plugin.name])||void 0===n?void 0:n.enabled))throw new Error(`The '${m.plugin.name}' plugin is disabled via the loader options passed to the loading operation.`);if(t.rawData&&!m.isBinary)throw"Loading from ArrayBufferView can not be used with plugins that don't support binary loading.";return(t=>{if(m.plugin.createPlugin){const K=m.plugin.createPlugin(null!=b?b:{});return K instanceof Promise?(K.then(t).catch((t=>{G("Error instantiating plugin.",t)})),null):(t(K),K)}return t(m.plugin),m.plugin})((b=>{var n;if(!b)throw`The loader plugin corresponding to the '${W}' file type has not been found. If using es6, please import the plugin you wish to use before.`;if(Z.notifyObservers(b),i&&(b.canDirectLoad&&b.canDirectLoad(t.url)||!e.f2(t.url))){if(b.directLoad){const t=b.directLoad(K,i);t instanceof Promise?t.then((t=>{D(b,t)})).catch((t=>{G("Error in directLoad of _loadData: "+t,t)})):D(b,t)}else D(b,i);return}const z=m.isBinary,w=(t,a)=>{K.isDisposed?G("Scene has been disposed"):D(b,t,a)};let u=null,d=!1;null===(n=b.onDisposeObservable)||void 0===n||n.add((()=>{d=!0,u&&(u.abort(),u=null),N()}));const E=()=>{if(d)return;const D=(t,K)=>{G(null==t?void 0:t.statusText,K)};if(!b.loadFile&&t.rawData)throw"Plugin does not support loading ArrayBufferView.";u=b.loadFile?b.loadFile(K,t.rawData||t.file||t.url,t.rootUrl,w,a,z,D,x):K._loadFile(t.file||t.url,w,a,!0,z,D)},l=K.getEngine();let Q=l.enableOfflineSupport;if(Q){let D=!1;for(const a of K.disableOfflineSupportExceptionRules)if(a.test(t.url)){D=!0;break}Q=!D}Q&&I.$.OfflineProviderFactory?K.offlineProvider=I.$.OfflineProviderFactory(t.url,E,l.disableManifestCheck):E()}))}function Q(t,K){let D,a,N=null,W=null;if(K)if(K.name)D=`file:${K.name}`,a=K.name,N=K;else if(ArrayBuffer.isView(K))D="",a=z.z(),W=K;else if(K.startsWith("data:"))D=K,a="";else if(t){const N=K;if("/"===N.substr(0,1))return G.S0.Error("Wrong sceneFilename parameter"),null;D=t+N,a=N}else D=K,a=G.S0.GetFilename(K),t=G.S0.GetFolderPath(K);else D=t,a=G.S0.GetFilename(t),t=G.S0.GetFolderPath(t);return{url:D,rootUrl:t,name:a,file:N,rawData:W}}function P(t,K,D="",a=x.q.LastCreatedScene,G=null,N=null,W=null,n=null,e="",z={}){if(!a)return b.V.Error("No scene available to import mesh to"),null;const I=Q(K,D);if(!I)return null;const Z={};a.addPendingData(Z);const w=()=>{a.removePendingData(Z)},m=(t,K)=>{const D=E(I,t,K);W?W(a,D,new i.bu(D,i.tG.SceneLoaderError,K)):b.V.Error(D),w()},u=N?t=>{try{N(t)}catch(t){m("Error in onProgress callback: "+t,t)}}:void 0,d=(t,K,D,N,W,x,b,n)=>{if(a.importedMeshesFiles.push(I.url),G)try{G(t,K,D,N,W,x,b,n)}catch(t){m("Error in onSuccess callback: "+t,t)}a.removePendingData(Z)};return l(I,a,((K,D,G)=>{if(K.rewriteRootURL&&(I.rootUrl=K.rewriteRootURL(I.rootUrl,G)),K.importMesh){const G=[],N=[],W=[];if(!K.importMesh(t,a,D,I.rootUrl,G,N,W,m))return;a.loadingPluginName=K.name,d(G,N,W,[],[],[],[],[])}else K.importMeshAsync(t,a,D,I.rootUrl,u,I.name).then((t=>{a.loadingPluginName=K.name,d(t.meshes,t.particleSystems,t.skeletons,t.animationGroups,t.transformNodes,t.geometries,t.lights,t.spriteManagers)})).catch((t=>{m(t.message,t)}))}),u,m,w,n,e,z)}function y(t,K="",D=x.q.LastCreatedEngine,a=null,N=null,b=null,n=null,e="",i={}){return D?q(t,K,new W.Z(D),a,N,b,n,e,i):(G.S0.Error("No engine available"),null)}function q(t,K="",D=x.q.LastCreatedScene,a=null,G=null,N=null,W=null,e="",z={}){if(!D)return b.V.Error("No scene available to append to"),null;const I=Q(t,K);if(!I)return null;const Z={};D.addPendingData(Z);const w=()=>{D.removePendingData(Z)};n.B.ShowLoadingScreen&&!m&&(m=!0,D.getEngine().displayLoadingUI(),D.executeWhenReady((()=>{D.getEngine().hideLoadingUI(),m=!1})));const u=(t,K)=>{const a=E(I,t,K);N?N(D,a,new i.bu(a,i.tG.SceneLoaderError,K)):b.V.Error(a),w()},d=G?t=>{try{G(t)}catch(t){u("Error in onProgress callback",t)}}:void 0,P=()=>{if(a)try{a(D)}catch(t){u("Error in onSuccess callback",t)}D.removePendingData(Z)};return l(I,D,((t,K)=>{if(t.load){if(!t.load(D,K,I.rootUrl,u))return;D.loadingPluginName=t.name,P()}else t.loadAsync(D,K,I.rootUrl,d,I.name).then((()=>{D.loadingPluginName=t.name,P()})).catch((t=>{u(t.message,t)}))}),d,u,w,W,e,z)}function X(t,K="",D=x.q.LastCreatedScene,a=null,G=null,N=null,W=null,n="",e={}){if(!D)return b.V.Error("No scene available to load asset container to"),null;const z=Q(t,K);if(!z)return null;const I={};D.addPendingData(I);const Z=()=>{D.removePendingData(I)},w=(t,K)=>{const a=E(z,t,K);N?N(D,a,new i.bu(a,i.tG.SceneLoaderError,K)):b.V.Error(a),Z()},m=G?t=>{try{G(t)}catch(t){w("Error in onProgress callback",t)}}:void 0,u=t=>{if(a)try{a(t)}catch(t){w("Error in onSuccess callback",t)}D.removePendingData(I)};return l(z,D,((t,K)=>{if(t.loadAssetContainer){const a=t.loadAssetContainer(D,K,z.rootUrl,w);if(!a)return;a.populateRootNodes(),D.loadingPluginName=t.name,u(a)}else t.loadAssetContainerAsync?t.loadAssetContainerAsync(D,K,z.rootUrl,m,z.name).then((K=>{K.populateRootNodes(),D.loadingPluginName=t.name,u(K)})).catch((t=>{w(t.message,t)})):w("LoadAssetContainer is not supported by this plugin. Plugin did not provide a loadAssetContainer or loadAssetContainerAsync method.")}),m,w,Z,W,n,e)}function h(t,K="",D=x.q.LastCreatedScene,a=!0,G=0,N=null,W=null,n=null,e=null,i=null,z="",I={}){if(!D)return void b.V.Error("No scene available to load animations to");if(a){for(const t of D.animatables)t.reset();D.stopAllAnimations(),D.animationGroups.slice().forEach((t=>{t.dispose()})),D.getNodes().forEach((t=>{t.animations&&(t.animations=[])}))}else switch(G){case 0:D.animationGroups.slice().forEach((t=>{t.dispose()}));break;case 1:D.animationGroups.forEach((t=>{t.stop()}));break;case 2:D.animationGroups.forEach((t=>{t.reset(),t.restart()}));break;case 3:break;default:return void b.V.Error("Unknown animation group loading mode value '"+G+"'")}const Z=D.animatables.length;X(t,K,D,(t=>{t.mergeAnimationsTo(D,D.animatables.slice(Z),N),t.dispose(),D.onAnimationFileImportedObservable.notifyObservers(D),W&&W(D)}),n,e,i,z,I)}class J{static get ForceFullSceneLoadingForIncremental(){return n.B.ForceFullSceneLoadingForIncremental}static set ForceFullSceneLoadingForIncremental(t){n.B.ForceFullSceneLoadingForIncremental=t}static get ShowLoadingScreen(){return n.B.ShowLoadingScreen}static set ShowLoadingScreen(t){n.B.ShowLoadingScreen=t}static get loggingLevel(){return n.B.loggingLevel}static set loggingLevel(t){n.B.loggingLevel=t}static get CleanBoneMatrixWeights(){return n.B.CleanBoneMatrixWeights}static set CleanBoneMatrixWeights(t){n.B.CleanBoneMatrixWeights=t}static GetDefaultPlugin(){return u()}static GetPluginForExtension(t){var K;return null===(K=d(t))||void 0===K?void 0:K.plugin}static IsPluginForExtensionAvailable(t){return function(t){return!!w[t]}(t)}static RegisterPlugin(t){(function(t){if("string"==typeof t.extensions){const K=t.extensions;w[K.toLowerCase()]={plugin:t,isBinary:!1}}else{const K=t.extensions;Object.keys(K).forEach((D=>{w[D.toLowerCase()]={plugin:t,isBinary:K[D].isBinary}}))}})(t)}static ImportMesh(t,K,D,a,G,N,W,x,b){return P(t,K,D,a,G,N,W,x,b)}static ImportMeshAsync(t,K,D,a,G,N,W){return function(t,K,D,a,G,N,W,x){return new Promise(((b,n)=>{P(t,K,D,a,((t,K,D,a,G,N,W,x)=>{b({meshes:t,particleSystems:K,skeletons:D,animationGroups:a,transformNodes:G,geometries:N,lights:W,spriteManagers:x})}),G,((t,K,D)=>{n(D||new Error(K))}),N,W,x)}))}(t,K,D,a,G,N,W)}static Load(t,K,D,a,G,N,W,x){return y(t,K,D,a,G,N,W,x)}static LoadAsync(t,K,D,a,G,N){return function(t,K,D,a,G,N,W){return new Promise(((x,b)=>{y(t,K,D,(t=>{x(t)}),a,((t,K,D)=>{b(D||new Error(K))}),G,N,W)}))}(t,K,D,a,G,N)}static Append(t,K,D,a,G,N,W,x){return q(t,K,D,a,G,N,W,x)}static AppendAsync(t,K,D,a,G,N){return function(t,K,D,a,G,N,W){return new Promise(((x,b)=>{q(t,K,D,(t=>{x(t)}),a,((t,K,D)=>{b(D||new Error(K))}),G,N,W)}))}(t,K,D,a,G,N)}static LoadAssetContainer(t,K,D,a,G,N,W,x){return X(t,K,D,a,G,N,W,x)}static LoadAssetContainerAsync(t,K,D,a,G,N){return function(t,K,D,a,G,N,W){return new Promise(((x,b)=>{X(t,K,D,(t=>{x(t)}),a,((t,K,D)=>{b(D||new Error(K))}),G,N,W)}))}(t,K,D,a,G,N)}static ImportAnimations(t,K,D,a,G,N,W,x,b,n,e){h(t,K,D,a,G,N,W,x,b,n,e)}static ImportAnimationsAsync(t,K,D,a,G,N,W,x,b,n,e){return function(t,K,D,a,G,N,W,x,b,n){return new Promise(((e,i)=>{h(t,K,D,a,G,N,(t=>{e(t)}),W,((t,K,D)=>{i(D||new Error(K))}),x,b,n)}))}(t,K,D,a,G,N,x,n,e)}}J.NO_LOGGING=0,J.MINIMAL_LOGGING=1,J.SUMMARY_LOGGING=2,J.DETAILED_LOGGING=3,J.OnPluginActivatedObservable=Z},396574:(t,K,D)=>{D.d(K,{B:()=>a});class a{static get ForceFullSceneLoadingForIncremental(){return a._ForceFullSceneLoadingForIncremental}static set ForceFullSceneLoadingForIncremental(t){a._ForceFullSceneLoadingForIncremental=t}static get ShowLoadingScreen(){return a._ShowLoadingScreen}static set ShowLoadingScreen(t){a._ShowLoadingScreen=t}static get loggingLevel(){return a._LoggingLevel}static set loggingLevel(t){a._LoggingLevel=t}static get CleanBoneMatrixWeights(){return a._CleanBoneMatrixWeights}static set CleanBoneMatrixWeights(t){a._CleanBoneMatrixWeights=t}}a._ForceFullSceneLoadingForIncremental=!1,a._ShowLoadingScreen=!0,a._CleanBoneMatrixWeights=!1,a._LoggingLevel=0},892643:(t,K,D)=>{function a(t,K){return t.endsWith(".dds")?D.e(44639).then(D.bind(D,44639)).then((t=>new t._DDSTextureLoader)):t.endsWith(".basis")?D.e(40310).then(D.bind(D,340310)).then((t=>new t._BasisTextureLoader)):t.endsWith(".env")?D.e(82689).then(D.bind(D,882689)).then((t=>new t._ENVTextureLoader)):t.endsWith(".hdr")?D.e(38410).then(D.bind(D,838410)).then((t=>new t._HDRTextureLoader)):t.endsWith(".ktx")||t.endsWith(".ktx2")||"image/ktx"===K||"image/ktx2"===K?D.e(59603).then(D.bind(D,359603)).then((t=>new t._KTXTextureLoader)):t.endsWith(".tga")?D.e(67412).then(D.bind(D,567412)).then((t=>new t._TGATextureLoader)):t.endsWith(".exr")?D.e(50883).then(D.bind(D,750883)).then((t=>new t._ExrTextureLoader)):null}D.d(K,{g:()=>a})},194373:(t,K,D)=>{D.d(K,{t:()=>i});var a=D(297809),G=D(760998),N=D(638113),W=D(604910),x=D(395726),b=D(977041),n=(D(435683),D(140699)),e=D(337776);D(269673);class i extends n.D{set hasAlpha(t){this._hasAlpha!==t&&(this._hasAlpha=t,this._scene&&this._scene.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this))))}get hasAlpha(){return this._hasAlpha}set getAlphaFromRGB(t){this._getAlphaFromRGB!==t&&(this._getAlphaFromRGB=t,this._scene&&this._scene.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(t){this._coordinatesIndex!==t&&(this._coordinatesIndex=t,this._scene&&this._scene.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(t){this._coordinatesMode!==t&&(this._coordinatesMode=t,this._scene&&this._scene.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(t){this._wrapU=t}get wrapV(){return this._wrapV}set wrapV(t){this._wrapV=t}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(t){this._texture?this._texture.isCube=t:this._isCube=t}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(t){this._texture&&(this._texture.is3D=t)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(t){this._texture&&(this._texture.is2DArray=t)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(t){var K;if(this._texture){if(this._texture._gammaSpace===t)return;this._texture._gammaSpace=t}else{if(this._gammaSpace===t)return;this._gammaSpace=t}null===(K=this.getScene())||void 0===K||K.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(t){var K;t!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=t),null===(K=this.getScene())||void 0===K||K.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(t){this._texture&&(this._texture._lodGenerationOffset=t)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(t){this._texture&&(this._texture._lodGenerationScale=t)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(t){this._texture&&(this._texture._linearSpecularLOD=t)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(t){this._texture&&(this._texture._irradianceTexture=t)}get uid(){return this._uid||(this._uid=b.z()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(t){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(t)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(t,K=null){super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=i.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.onDisposeObservable=new N.cP,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,t?i._IsScene(t)?this._scene=t:this._engine=t:this._scene=x.q.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=K,this._uid=null}getScene(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return W.uq.IdentityReadOnly}getReflectionTextureMatrix(){return W.uq.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(t){}get canRescale(){return!1}_getFromCache(t,K,D,a,G,N){const W=this._getEngine();if(!W)return null;const x=W._getUseSRGBBuffer(!!G,K),b=W.getLoadedTexturesCache();for(let W=0;W<b.length;W++){const n=b[W];if(!(void 0!==G&&x!==n._useSRGBBuffer||void 0!==a&&a!==n.invertY||n.url!==t||n.generateMipMaps!==!K||D&&D!==n.samplingMode||void 0!==N&&N!==n.isCube))return n.incrementReferences(),n}return null}_rebuild(t=!1){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const t=this.getScene();t&&t.markAllMaterialsAsDirty(1)}readPixels(t=0,K=0,D=null,a=!0,G=!1,N=0,W=0,x=Number.MAX_VALUE,b=Number.MAX_VALUE){if(!this._texture)return null;const n=this._getEngine();if(!n)return null;const e=this.getSize();let i=e.width,z=e.height;0!==K&&(i/=Math.pow(2,K),z/=Math.pow(2,K),i=Math.round(i),z=Math.round(z)),x=Math.min(i,x),b=Math.min(z,b);try{return this._texture.isCube?n._readTexturePixels(this._texture,x,b,t,K,D,a,G,N,W):n._readTexturePixels(this._texture,x,b,-1,K,D,a,G,N,W)}catch(t){return null}}_readPixelsSync(t=0,K=0,D=null,a=!0,G=!1){if(!this._texture)return null;const N=this.getSize();let W=N.width,x=N.height;const b=this._getEngine();if(!b)return null;0!=K&&(W/=Math.pow(2,K),x/=Math.pow(2,K),W=Math.round(W),x=Math.round(x));try{return this._texture.isCube?b._readTexturePixelsSync(this._texture,W,x,t,K,D,a,G):b._readTexturePixelsSync(this._texture,W,x,-1,K,D,a,G)}catch(t){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const t=this._scene.textures.indexOf(this);if(t>=0&&this._scene.textures.splice(t,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const t=this._parentContainer.textures.indexOf(this);t>-1&&this._parentContainer.textures.splice(t,1),this._parentContainer=null}}this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.metadata=null,super.dispose()}serialize(t=!1){if(!this.name&&!t)return null;const K=e.p.Serialize(this);return e.p.AppendSerializedAnimations(this,K),K}static WhenAllReady(t,K){let D=t.length;if(0!==D)for(let a=0;a<t.length;a++){const G=t[a];if(G.isReady())0==--D&&K();else{const t=G.onLoadObservable;t?t.addOnce((()=>{0==--D&&K()})):0==--D&&K()}}else K()}static _IsScene(t){return"Scene"===t.getClassName()}}i.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,a.Cg([G.lK()],i.prototype,"uniqueId",void 0),a.Cg([G.lK()],i.prototype,"name",void 0),a.Cg([G.lK()],i.prototype,"metadata",void 0),a.Cg([G.lK("hasAlpha")],i.prototype,"_hasAlpha",void 0),a.Cg([G.lK("getAlphaFromRGB")],i.prototype,"_getAlphaFromRGB",void 0),a.Cg([G.lK()],i.prototype,"level",void 0),a.Cg([G.lK("coordinatesIndex")],i.prototype,"_coordinatesIndex",void 0),a.Cg([G.lK()],i.prototype,"optimizeUVAllocation",void 0),a.Cg([G.lK("coordinatesMode")],i.prototype,"_coordinatesMode",void 0),a.Cg([G.lK()],i.prototype,"wrapU",null),a.Cg([G.lK()],i.prototype,"wrapV",null),a.Cg([G.lK()],i.prototype,"wrapR",void 0),a.Cg([G.lK()],i.prototype,"anisotropicFilteringLevel",void 0),a.Cg([G.lK()],i.prototype,"isCube",null),a.Cg([G.lK()],i.prototype,"is3D",null),a.Cg([G.lK()],i.prototype,"is2DArray",null),a.Cg([G.lK()],i.prototype,"gammaSpace",null),a.Cg([G.lK()],i.prototype,"invertZ",void 0),a.Cg([G.lK()],i.prototype,"lodLevelInAlpha",void 0),a.Cg([G.lK()],i.prototype,"lodGenerationOffset",null),a.Cg([G.lK()],i.prototype,"lodGenerationScale",null),a.Cg([G.lK()],i.prototype,"linearSpecularLOD",null),a.Cg([G.uM()],i.prototype,"irradianceTexture",null),a.Cg([G.lK()],i.prototype,"isRenderTarget",void 0)},587053:(t,K,D)=>{var a=D(906264),G=D(194373);G.t.prototype.forceSphericalPolynomialsRecompute=function(){this._texture&&(this._texture._sphericalPolynomial=null,this._texture._sphericalPolynomialPromise=null,this._texture._sphericalPolynomialComputed=!1)},Object.defineProperty(G.t.prototype,"sphericalPolynomial",{get:function(){if(this._texture){if(this._texture._sphericalPolynomial||this._texture._sphericalPolynomialComputed)return this._texture._sphericalPolynomial;if(this._texture.isReady)return this._texture._sphericalPolynomialPromise||(this._texture._sphericalPolynomialPromise=a.d.ConvertCubeMapTextureToSphericalPolynomial(this),null===this._texture._sphericalPolynomialPromise?this._texture._sphericalPolynomialComputed=!0:this._texture._sphericalPolynomialPromise.then((t=>{this._texture._sphericalPolynomial=t,this._texture._sphericalPolynomialComputed=!0}))),null}return null},set:function(t){this._texture&&(this._texture._sphericalPolynomial=t)},enumerable:!0,configurable:!0})},182453:(t,K,D)=>{D.d(K,{h:()=>W});var a,G=D(638113),N=D(796152);(function(t){t[t["Unknown"]=0]="Unknown",t[t["Url"]=1]="Url",t[t["Temp"]=2]="Temp",t[t["Raw"]=3]="Raw",t[t["Dynamic"]=4]="Dynamic",t[t["RenderTarget"]=5]="RenderTarget",t[t["MultiRenderTarget"]=6]="MultiRenderTarget",t[t["Cube"]=7]="Cube",t[t["CubeRaw"]=8]="CubeRaw",t[t["CubePrefiltered"]=9]="CubePrefiltered",t[t["Raw3D"]=10]="Raw3D",t[t["Raw2DArray"]=11]="Raw2DArray",t[t["DepthStencil"]=12]="DepthStencil",t[t["CubeRawRGBD"]=13]="CubeRawRGBD",t[t["Depth"]=14]="Depth"})(a||(a={}));class W extends N.u{get useMipMaps(){return this.generateMipMaps}set useMipMaps(t){this.generateMipMaps=t}get uniqueId(){return this._uniqueId}_setUniqueId(t){this._uniqueId=t}getEngine(){return this._engine}get source(){return this._source}constructor(t,K,D=!1){super(),this.isReady=!1,this.isCube=!1,this.is3D=!1,this.is2DArray=!1,this.isMultiview=!1,this.url="",this.generateMipMaps=!1,this.samples=0,this.type=-1,this.format=-1,this.onLoadedObservable=new G.cP,this.onErrorObservable=new G.cP,this.onRebuildCallback=null,this.width=0,this.height=0,this.depth=0,this.baseWidth=0,this.baseHeight=0,this.baseDepth=0,this.invertY=!1,this._invertVScale=!1,this._associatedChannel=-1,this._source=0,this._buffer=null,this._bufferView=null,this._bufferViewArray=null,this._bufferViewArrayArray=null,this._size=0,this._extension="",this._files=null,this._workingCanvas=null,this._workingContext=null,this._cachedCoordinatesMode=null,this._isDisabled=!1,this._compression=null,this._sphericalPolynomial=null,this._sphericalPolynomialPromise=null,this._sphericalPolynomialComputed=!1,this._lodGenerationScale=0,this._lodGenerationOffset=0,this._useSRGBBuffer=!1,this._creationFlags=0,this._lodTextureHigh=null,this._lodTextureMid=null,this._lodTextureLow=null,this._isRGBD=!1,this._linearSpecularLOD=!1,this._irradianceTexture=null,this._hardwareTexture=null,this._maxLodLevel=null,this._references=1,this._gammaSpace=null,this._premulAlpha=!1,this._dynamicTextureSource=null,this._engine=t,this._source=K,this._uniqueId=W._Counter++,D||(this._hardwareTexture=t._createHardwareTexture())}incrementReferences(){this._references++}updateSize(t,K,D=1){this._engine.updateTextureDimensions(this,t,K,D),this.width=t,this.height=K,this.depth=D,this.baseWidth=t,this.baseHeight=K,this.baseDepth=D,this._size=t*K*D}_rebuild(){var t,K;if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){const t=this.onRebuildCallback(this),K=K=>{K._swapAndDie(this,!1),this.isReady=t.isReady};return void(t.isAsync?t.proxy.then(K):K(t.proxy))}let D;switch(this.source){case 2:case 12:case 14:break;case 1:return void(D=this._engine.createTexture(null!==(t=this._originalUrl)&&void 0!==t?t:this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,(t=>{t._swapAndDie(this,!1),this.isReady=!0}),null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer));case 3:D=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type,this._creationFlags,this._useSRGBBuffer),D._swapAndDie(this,!1),this.isReady=!0;break;case 10:D=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),D._swapAndDie(this,!1),this.isReady=!0;break;case 11:D=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),D._swapAndDie(this,!1),this.isReady=!0;break;case 4:D=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode),D._swapAndDie(this,!1),this._dynamicTextureSource&&this._engine.updateDynamicTexture(this,this._dynamicTextureSource,this.invertY,this._premulAlpha,this.format,!0);break;case 7:return void(D=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,(()=>{D._swapAndDie(this,!1),this.isReady=!0}),null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer,ArrayBuffer.isView(this._buffer)?this._buffer:null));case 8:D=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,null!==(K=this._originalFormat)&&void 0!==K?K:this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression),D._swapAndDie(this,!1),this.isReady=!0;break;case 13:return;case 9:return D=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,(t=>{t&&t._swapAndDie(this,!1),this.isReady=!0}),null,this.format,this._extension),void(D._sphericalPolynomial=this._sphericalPolynomial)}}_swapAndDie(t,K=!0){var D;null===(D=this._hardwareTexture)||void 0===D||D.setUsage(t._source,this.generateMipMaps,this.is2DArray,this.isCube,this.is3D,this.width,this.height,this.depth),t._hardwareTexture=this._hardwareTexture,K&&(t._isRGBD=this._isRGBD),this._lodTextureHigh&&(t._lodTextureHigh&&t._lodTextureHigh.dispose(),t._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(t._lodTextureMid&&t._lodTextureMid.dispose(),t._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(t._lodTextureLow&&t._lodTextureLow.dispose(),t._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(t._irradianceTexture&&t._irradianceTexture.dispose(),t._irradianceTexture=this._irradianceTexture);const a=this._engine.getLoadedTexturesCache();let G=a.indexOf(this);-1!==G&&a.splice(G,1),G=a.indexOf(t),-1===G&&a.push(t)}dispose(){this._references--,this.onLoadedObservable.clear(),this.onErrorObservable.clear(),0===this._references&&(this._engine._releaseTexture(this),this._hardwareTexture=null,this._dynamicTextureSource=null)}}W._Counter=0},888413:(t,K,D)=>{D.d(K,{$:()=>i});var a=D(638113),G=D(604910),N=D(432050),W=D(848287),x=D(809319),b=(D(68561),D(240396),D(650646),D(967872)),n=D(827627),e=D(104270);D(498083).M.prototype.setDepthStencilTexture=function(t,K){this._engine.setDepthStencilTexture(this._samplers[t],this._uniforms[t],K,t)};class i extends N.g{get renderList(){return this._renderList}set renderList(t){this._unObserveRenderList&&(this._unObserveRenderList(),this._unObserveRenderList=null),t&&(this._unObserveRenderList=b.lL(t,this._renderListHasChanged)),this._renderList=t}get postProcesses(){return this._postProcesses}get _prePassEnabled(){return!!this._prePassRenderTarget&&this._prePassRenderTarget.enabled}set onAfterUnbind(t){this._onAfterUnbindObserver&&this.onAfterUnbindObservable.remove(this._onAfterUnbindObserver),this._onAfterUnbindObserver=this.onAfterUnbindObservable.add(t)}set onBeforeRender(t){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(t)}set onAfterRender(t){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(t)}set onClear(t){this._onClearObserver&&this.onClearObservable.remove(this._onClearObserver),this._onClearObserver=this.onClearObservable.add(t)}get renderPassIds(){return this._renderPassIds}get currentRefreshId(){return this._currentRefreshId}setMaterialForRendering(t,K){let D;D=Array.isArray(t)?t:[t];for(let t=0;t<D.length;++t)for(let a=0;a<this._renderPassIds.length;++a)D[t].setMaterialForRenderPass(this._renderPassIds[a],void 0!==K?Array.isArray(K)?K[a]:K:void 0)}get isMulti(){var t,K;return null!==(K=null===(t=this._renderTarget)||void 0===t?void 0:t.isMulti)&&void 0!==K&&K}get renderTargetOptions(){return this._renderTargetOptions}get renderTarget(){return this._renderTarget}_onRatioRescale(){this._sizeRatio&&this.resize(this._initialSizeParameter)}set boundingBoxSize(t){if(this._boundingBoxSize&&this._boundingBoxSize.equals(t))return;this._boundingBoxSize=t;const K=this.getScene();K&&K.markAllMaterialsAsDirty(1)}get boundingBoxSize(){return this._boundingBoxSize}get depthStencilTexture(){var t,K;return null!==(K=null===(t=this._renderTarget)||void 0===t?void 0:t._depthStencilTexture)&&void 0!==K?K:null}constructor(t,K,D,W=!1,b=!0,n=0,e=!1,i=N.g.TRILINEAR_SAMPLINGMODE,z=!0,I=!1,Z=!1,w=5,m=!1,u,d,E=!1,l=!1){var Q,P,y,q,X,h,J;let T,_=!0;if("object"==typeof W){const t=W;W=!!t.generateMipMaps,b=null===(Q=t.doNotChangeAspectRatio)||void 0===Q||Q,n=null!==(P=t.type)&&void 0!==P?P:0,e=!!t.isCube,i=null!==(y=t.samplingMode)&&void 0!==y?y:N.g.TRILINEAR_SAMPLINGMODE,z=null===(q=t.generateDepthBuffer)||void 0===q||q,I=!!t.generateStencilBuffer,Z=!!t.isMulti,w=null!==(X=t.format)&&void 0!==X?X:5,m=!!t.delayAllocation,u=t.samples,d=t.creationFlags,E=!!t.noColorAttachment,l=!!t.useSRGBBuffer,T=t.colorAttachment,_=null!==(h=t.gammaSpace)&&void 0!==h?h:_}if(super(null,D,!W,void 0,i,void 0,void 0,void 0,void 0,w),this._unObserveRenderList=null,this._renderListHasChanged=(t,K)=>{var D;const a=this._renderList?this._renderList.length:0;(0===K&&a>0||0===a)&&(null===(D=this.getScene())||void 0===D||D.meshes.forEach((t=>{t._markSubMeshesAsLightDirty()})))},this.renderParticles=!0,this.renderSprites=!1,this.forceLayerMaskCheck=!1,this.ignoreCameraViewport=!1,this.onBeforeBindObservable=new a.cP,this.onAfterUnbindObservable=new a.cP,this.onBeforeRenderObservable=new a.cP,this.onAfterRenderObservable=new a.cP,this.onClearObservable=new a.cP,this.onResizeObservable=new a.cP,this._cleared=!1,this.skipInitialClear=!1,this._currentRefreshId=-1,this._refreshRate=1,this._samples=1,this._canRescale=!0,this._renderTarget=null,this.boundingBoxPosition=G.Pq.Zero(),!(D=this.getScene()))return;const C=this.getScene().getEngine();this._gammaSpace=_,this._coordinatesMode=N.g.PROJECTION_MODE,this.renderList=[],this.name=t,this.isRenderTarget=!0,this._initialSizeParameter=K,this._renderPassIds=[],this._isCubeData=e,this._processSizeParameter(K),this.renderPassId=this._renderPassIds[0],this._resizeObserver=C.onResizeObservable.add((()=>{})),this._generateMipMaps=!!W,this._doNotChangeAspectRatio=b,this._renderingManager=new x.m(D),this._renderingManager._useSceneAutoClearSetup=!0,Z||(this._renderTargetOptions={generateMipMaps:W,type:n,format:null!==(J=this._format)&&void 0!==J?J:void 0,samplingMode:this.samplingMode,generateDepthBuffer:z,generateStencilBuffer:I,samples:u,creationFlags:d,noColorAttachment:E,useSRGBBuffer:l,colorAttachment:T,label:this.name},this.samplingMode===N.g.NEAREST_SAMPLINGMODE&&(this.wrapU=N.g.CLAMP_ADDRESSMODE,this.wrapV=N.g.CLAMP_ADDRESSMODE),m||(e?(this._renderTarget=D.getEngine().createRenderTargetCubeTexture(this.getRenderSize(),this._renderTargetOptions),this.coordinatesMode=N.g.INVCUBIC_MODE,this._textureMatrix=G.uq.Identity()):this._renderTarget=D.getEngine().createRenderTargetTexture(this._size,this._renderTargetOptions),this._texture=this._renderTarget.texture,void 0!==u&&(this.samples=u)))}createDepthStencilTexture(t=0,K=!0,D=!1,a=1,G=14,N){var W;null===(W=this._renderTarget)||void 0===W||W.createDepthStencilTexture(t,K,D,a,G,N)}_releaseRenderPassId(){if(this._scene){const t=this._scene.getEngine();for(let K=0;K<this._renderPassIds.length;++K)t.releaseRenderPassId(this._renderPassIds[K])}this._renderPassIds=[]}_createRenderPassId(){this._releaseRenderPassId();const t=this._scene.getEngine(),K=this._isCubeData?6:this.getRenderLayers()||1;for(let D=0;D<K;++D)this._renderPassIds[D]=t.createRenderPassId(`RenderTargetTexture - ${this.name}#${D}`)}_processSizeParameter(t,K=!0){if(t.ratio){this._sizeRatio=t.ratio;const K=this._getEngine();this._size={width:this._bestReflectionRenderTargetDimension(K.getRenderWidth(),this._sizeRatio),height:this._bestReflectionRenderTargetDimension(K.getRenderHeight(),this._sizeRatio)}}else this._size=t;K&&this._createRenderPassId()}get samples(){var t,K;return null!==(K=null===(t=this._renderTarget)||void 0===t?void 0:t.samples)&&void 0!==K?K:this._samples}set samples(t){this._renderTarget&&(this._samples=this._renderTarget.setSamples(t))}resetRefreshCounter(){this._currentRefreshId=-1}get refreshRate(){return this._refreshRate}set refreshRate(t){this._refreshRate=t,this.resetRefreshCounter()}addPostProcess(t){if(!this._postProcessManager){const t=this.getScene();if(!t)return;this._postProcessManager=new W.X(t),this._postProcesses=new Array}this._postProcesses.push(t),this._postProcesses[0].autoClear=!1}clearPostProcesses(t=!1){if(this._postProcesses){if(t)for(const t of this._postProcesses)t.dispose();this._postProcesses=[]}}removePostProcess(t){if(!this._postProcesses)return;const K=this._postProcesses.indexOf(t);-1!==K&&(this._postProcesses.splice(K,1),this._postProcesses.length>0&&(this._postProcesses[0].autoClear=!1))}_shouldRender(){return-1===this._currentRefreshId||this.refreshRate===this._currentRefreshId?(this._currentRefreshId=1,!0):(this._currentRefreshId++,!1)}getRenderSize(){return this.getRenderWidth()}getRenderWidth(){return this._size.width?this._size.width:this._size}getRenderHeight(){return this._size.width?this._size.height:this._size}getRenderLayers(){const t=this._size.layers;if(t)return t;return this._size.depth||0}disableRescaling(){this._canRescale=!1}get canRescale(){return this._canRescale}scale(t){const K=Math.max(1,this.getRenderSize()*t);this.resize(K)}getReflectionTextureMatrix(){return this.isCube?this._textureMatrix:super.getReflectionTextureMatrix()}resize(t){var K;const D=this.isCube;null===(K=this._renderTarget)||void 0===K||K.dispose(),this._renderTarget=null;const a=this.getScene();a&&(this._processSizeParameter(t,!1),this._renderTarget=D?a.getEngine().createRenderTargetCubeTexture(this.getRenderSize(),this._renderTargetOptions):a.getEngine().createRenderTargetTexture(this._size,this._renderTargetOptions),this._texture=this._renderTarget.texture,void 0!==this._renderTargetOptions.samples&&(this.samples=this._renderTargetOptions.samples),this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this))}render(t=!1,K=!1){this._render(t,K)}isReadyForRendering(){return this._render(!1,!1,!0)}_render(t=!1,K=!1,D=!1){var a;const G=this.getScene();if(!G)return D;const N=G.getEngine();if(void 0!==this.useCameraPostProcesses&&(t=this.useCameraPostProcesses),this._waitingRenderList){if(!this.renderListPredicate){this.renderList=[];for(let t=0;t<this._waitingRenderList.length;t++){const K=this._waitingRenderList[t],D=G.getMeshById(K);D&&this.renderList.push(D)}}this._waitingRenderList=void 0}if(this.renderListPredicate){this.renderList?this.renderList.length=0:this.renderList=[];const t=this.getScene();if(!t)return D;const K=t.meshes;for(let t=0;t<K.length;t++){const D=K[t];this.renderListPredicate(D)&&this.renderList.push(D)}}const W=N.currentRenderPassId;this.onBeforeBindObservable.notifyObservers(this);const x=null!==(a=this.activeCamera)&&void 0!==a?a:G.activeCamera,b=G.activeCamera;x&&(x!==G.activeCamera&&(G.setTransformMatrix(x.getViewMatrix(),x.getProjectionMatrix(!0)),G.activeCamera=x),N.setViewport(x.rigParent?x.rigParent.viewport:x.viewport,this.getRenderWidth(),this.getRenderHeight())),this._defaultRenderListPrepared=!1;let n=D;if(D){G.getViewMatrix()||G.updateTransformMatrix();const t=this.is2DArray||this.is3D?this.getRenderLayers():this.isCube?6:1;for(let K=0;K<t&&n;K++){let t=null;const a=this.renderList?this.renderList:G.getActiveMeshes().data,W=this.renderList?this.renderList.length:G.getActiveMeshes().length;N.currentRenderPassId=this._renderPassIds[K],this.onBeforeRenderObservable.notifyObservers(K),this.getCustomRenderList&&(t=this.getCustomRenderList(K,a,W)),t||(t=a),this._doNotChangeAspectRatio||G.updateTransformMatrix(!0);for(let K=0;K<t.length&&n;++K){const a=t[K];if(a.isEnabled()&&!a.isBlocked&&a.isVisible&&a.subMeshes)if(this.customIsReadyFunction){if(!this.customIsReadyFunction(a,this.refreshRate,D)){n=!1;continue}}else if(!a.isReady(!0)){n=!1;continue}}this.onAfterRenderObservable.notifyObservers(K),(this.is2DArray||this.is3D||this.isCube)&&(G.incrementRenderId(),G.resetCachedMaterial())}}else if(!this.is2DArray&&!this.is3D||this.isMulti)if(this.isCube&&!this.isMulti)for(let D=0;D<6;D++)this._renderToTarget(D,t,K,void 0,x),G.incrementRenderId(),G.resetCachedMaterial();else this._renderToTarget(0,t,K,void 0,x);else for(let D=0;D<this.getRenderLayers();D++)this._renderToTarget(0,t,K,D,x),G.incrementRenderId(),G.resetCachedMaterial();return this.onAfterUnbindObservable.notifyObservers(this),N.currentRenderPassId=W,b&&(G.activeCamera=b,this.activeCamera&&this.activeCamera!==G.activeCamera&&G.setTransformMatrix(G.activeCamera.getViewMatrix(),G.activeCamera.getProjectionMatrix(!0)),N.setViewport(G.activeCamera.viewport)),G.resetCachedMaterial(),n}_bestReflectionRenderTargetDimension(t,K){const D=128,a=t*K,G=e.OG(a+D*D/(D+a));return Math.min(e.C4(t),G)}_prepareRenderingManager(t,K,D,a){const G=this.getScene();if(!G)return;this._renderingManager.reset();const N=G.getRenderId();for(let W=0;W<K;W++){const K=t[W];if(K&&!K.isBlocked){if(this.customIsReadyFunction){if(!this.customIsReadyFunction(K,this.refreshRate,!1)){this.resetRefreshCounter();continue}}else if(!K.isReady(0===this.refreshRate)){this.resetRefreshCounter();continue}if(!K._internalAbstractMeshDataInfo._currentLODIsUpToDate&&G.activeCamera&&(K._internalAbstractMeshDataInfo._currentLOD=G.customLODSelector?G.customLODSelector(K,this.activeCamera||G.activeCamera):K.getLOD(this.activeCamera||G.activeCamera),K._internalAbstractMeshDataInfo._currentLODIsUpToDate=!0),!K._internalAbstractMeshDataInfo._currentLOD)continue;let t,W=K._internalAbstractMeshDataInfo._currentLOD;if(W._preActivateForIntermediateRendering(N),t=!(!a||!D||K.layerMask&D.layerMask),K.isEnabled()&&K.isVisible&&K.subMeshes&&!t){if(W!==K&&W._activate(N,!0),K._activate(N,!0)&&K.subMeshes.length){K.isAnInstance?K._internalAbstractMeshDataInfo._actAsRegularMesh&&(W=K):W._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!1,W._internalAbstractMeshDataInfo._isActiveIntermediate=!0;for(let t=0;t<W.subMeshes.length;t++){const K=W.subMeshes[t];this._renderingManager.dispatch(K,W)}}K._postActivate()}}}for(let t=0;t<G.particleSystems.length;t++){const K=G.particleSystems[t],D=K.emitter;K.isStarted()&&D&&(!D.position||D.isEnabled())&&this._renderingManager.dispatchParticles(K)}}_bindFrameBuffer(t=0,K=0){const D=this.getScene();if(!D)return;const a=D.getEngine();this._renderTarget&&a.bindFramebuffer(this._renderTarget,this.isCube?t:void 0,void 0,void 0,this.ignoreCameraViewport,0,K)}_unbindFrameBuffer(t,K){this._renderTarget&&t.unBindFramebuffer(this._renderTarget,this.isCube,(()=>{this.onAfterRenderObservable.notifyObservers(K)}))}_prepareFrame(t,K,D,a){this._postProcessManager?this._prePassEnabled||this._postProcessManager._prepareFrame(this._texture,this._postProcesses):a&&t.postProcessManager._prepareFrame(this._texture)||this._bindFrameBuffer(K,D)}_renderToTarget(t,K,D,a=0,G=null){var N,W,x,b,e,i;const z=this.getScene();if(!z)return;const I=z.getEngine();if(null===(N=I._debugPushGroup)||void 0===N||N.call(I,`render to face #${t} layer #${a}`,1),this._prepareFrame(z,t,a,K),this.is2DArray||this.is3D?(I.currentRenderPassId=this._renderPassIds[a],this.onBeforeRenderObservable.notifyObservers(a)):(I.currentRenderPassId=this._renderPassIds[t],this.onBeforeRenderObservable.notifyObservers(t)),I.snapshotRendering&&1===I.snapshotRenderingMode)this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(I):this.skipInitialClear||I.clear(this.clearColor||z.clearColor,!0,!0,!0);else{let N=null;const i=this.renderList?this.renderList:z.getActiveMeshes().data,Z=this.renderList?this.renderList.length:z.getActiveMeshes().length;this.getCustomRenderList&&(N=this.getCustomRenderList(this.is2DArray||this.is3D?a:t,i,Z)),N?this._prepareRenderingManager(N,N.length,G,this.forceLayerMaskCheck):(this._defaultRenderListPrepared||(this._prepareRenderingManager(i,Z,G,!this.renderList||this.forceLayerMaskCheck),this._defaultRenderListPrepared=!0),N=i);for(const K of z._beforeRenderTargetClearStage)K.action(this,t,a);this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(I):this.skipInitialClear||I.clear(this.clearColor||z.clearColor,!0,!0,!0),this._doNotChangeAspectRatio||z.updateTransformMatrix(!0);for(const K of z._beforeRenderTargetDrawStage)K.action(this,t,a);this._renderingManager.render(this.customRenderFunction,N,this.renderParticles,this.renderSprites);for(const K of z._afterRenderTargetDrawStage)K.action(this,t,a);const w=null!==(x=null===(W=this._texture)||void 0===W?void 0:W.generateMipMaps)&&void 0!==x&&x;this._texture&&(this._texture.generateMipMaps=!1),this._postProcessManager?this._postProcessManager._finalizeFrame(!1,null!==(b=this._renderTarget)&&void 0!==b?b:void 0,t,this._postProcesses,this.ignoreCameraViewport):K&&z.postProcessManager._finalizeFrame(!1,null!==(e=this._renderTarget)&&void 0!==e?e:void 0,t);for(const K of z._afterRenderTargetPostProcessStage)K.action(this,t,a);this._texture&&(this._texture.generateMipMaps=w),this._doNotChangeAspectRatio||z.updateTransformMatrix(!0),D&&n.yp(this.getRenderWidth(),this.getRenderHeight(),I)}this._unbindFrameBuffer(I,t),this._texture&&this.isCube&&5===t&&I.generateMipMapsForCubemap(this._texture,!0),null===(i=I._debugPopGroup)||void 0===i||i.call(I,1)}setRenderingOrder(t,K=null,D=null,a=null){this._renderingManager.setRenderingOrder(t,K,D,a)}setRenderingAutoClearDepthStencil(t,K){this._renderingManager.setRenderingAutoClearDepthStencil(t,K),this._renderingManager._useSceneAutoClearSetup=!1}clone(){const t=this.getSize(),K=new i(this.name,t,this.getScene(),this._renderTargetOptions.generateMipMaps,this._doNotChangeAspectRatio,this._renderTargetOptions.type,this.isCube,this._renderTargetOptions.samplingMode,this._renderTargetOptions.generateDepthBuffer,this._renderTargetOptions.generateStencilBuffer,void 0,this._renderTargetOptions.format,void 0,this._renderTargetOptions.samples);return K.hasAlpha=this.hasAlpha,K.level=this.level,K.coordinatesMode=this.coordinatesMode,this.renderList&&(K.renderList=this.renderList.slice(0)),K}serialize(){if(!this.name)return null;const t=super.serialize();if(t.renderTargetSize=this.getRenderSize(),t.renderList=[],this.renderList)for(let K=0;K<this.renderList.length;K++)t.renderList.push(this.renderList[K].id);return t}disposeFramebufferObjects(){var t;null===(t=this._renderTarget)||void 0===t||t.dispose(!0)}releaseInternalTexture(){var t;null===(t=this._renderTarget)||void 0===t||t.releaseTextures(),this._texture=null}dispose(){var t;this.onResizeObservable.clear(),this.onClearObservable.clear(),this.onAfterRenderObservable.clear(),this.onAfterUnbindObservable.clear(),this.onBeforeBindObservable.clear(),this.onBeforeRenderObservable.clear(),this._postProcessManager&&(this._postProcessManager.dispose(),this._postProcessManager=null),this._prePassRenderTarget&&this._prePassRenderTarget.dispose(),this._releaseRenderPassId(),this.clearPostProcesses(!0),this._resizeObserver&&(this.getScene().getEngine().onResizeObservable.remove(this._resizeObserver),this._resizeObserver=null),this.renderList=null;const K=this.getScene();if(!K)return;let D=K.customRenderTargets.indexOf(this);D>=0&&K.customRenderTargets.splice(D,1);for(const t of K.cameras)D=t.customRenderTargets.indexOf(this),D>=0&&t.customRenderTargets.splice(D,1);null===(t=this._renderTarget)||void 0===t||t.dispose(),this._renderTarget=null,this._texture=null,super.dispose()}_rebuild(){this.refreshRate===i.REFRESHRATE_RENDER_ONCE&&(this.refreshRate=i.REFRESHRATE_RENDER_ONCE),this._postProcessManager&&this._postProcessManager._rebuild()}freeRenderingGroups(){this._renderingManager&&this._renderingManager.freeRenderingGroups()}getViewCount(){return 1}}i.REFRESHRATE_RENDER_ONCE=0,i.REFRESHRATE_RENDER_ONEVERYFRAME=1,i.REFRESHRATE_RENDER_ONEVERYTWOFRAMES=2,N.g._CreateRenderTargetTexture=(t,K,D,a,G)=>new i(t,K,D,a)},432050:(t,K,D)=>{D.d(K,{g:()=>u});var a=D(297809),G=D(760998),N=D(638113),W=D(604910),x=D(194373),b=D(310035),n=D(554014),e=D(602187),i=D(862e3),z=D(298039),I=D(711210),Z=D(393518),w=D(158548),m=D(337776);class u extends x.t{static _CreateVideoTexture(t,K,D,a=!1,G=!1,N=u.TRILINEAR_SAMPLINGMODE,W={},x,b=5){throw n.n("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(t){this._isBlocking=t}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(t,K,D,a,G=u.TRILINEAR_SAMPLINGMODE,W=null,x=null,b=null,n=!1,i,z,I,Z,m){var d,E,l,Q,P,y,q,X,h,J;let T;super(K),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new N.cP,this._isBlocking=!0,this.name=t||"",this.url=t;let _=!1,C=null,H=!0;"object"==typeof D&&null!==D?(T=null!==(d=D.noMipmap)&&void 0!==d&&d,a=null!==(E=D.invertY)&&void 0!==E?E:!w.rX,G=null!==(l=D.samplingMode)&&void 0!==l?l:u.TRILINEAR_SAMPLINGMODE,W=null!==(Q=D.onLoad)&&void 0!==Q?Q:null,x=null!==(P=D.onError)&&void 0!==P?P:null,b=null!==(y=D.buffer)&&void 0!==y?y:null,n=null!==(q=D.deleteBuffer)&&void 0!==q&&q,i=D.format,z=D.mimeType,I=D.loaderOptions,Z=D.creationFlags,_=null!==(X=D.useSRGBBuffer)&&void 0!==X&&X,C=null!==(h=D.internalTexture)&&void 0!==h?h:null,H=null!==(J=D.gammaSpace)&&void 0!==J?J:H):T=!!D,this._gammaSpace=H,this._noMipmap=T,this._invertY=void 0===a?!w.rX:a,this._initialSamplingMode=G,this._buffer=b,this._deleteBuffer=n,this._mimeType=z,this._loaderOptions=I,this._creationFlags=Z,this._useSRGBBuffer=_,this._forcedExtension=m,i&&(this._format=i);const o=this.getScene(),U=this._getEngine();if(!U)return;U.onBeforeTextureInitObservable.notifyObservers(this);const V=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),W&&W(),!this.isBlocking&&o&&o.resetCachedMaterial()},s=(t,K)=>{this._loadingError=!0,this._errorObject={message:t,exception:K},x&&x(t,K),u.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!C)return this._delayedOnLoad=V,void(this._delayedOnError=s);if(this._texture=null!=C?C:this._getFromCache(this.url,T,G,this._invertY,_,this.isCube),this._texture)if(this._texture.isReady)e._.SetImmediate((()=>V()));else{const t=this._texture.onLoadedObservable.add(V);this._texture.onErrorObservable.add((K=>{var D;s(K.message,K.exception),null===(D=this._texture)||void 0===D||D.onLoadedObservable.remove(t)}))}else if(o&&o.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=V,this._delayedOnError=s;else{try{this._texture=U.createTexture(this.url,T,this._invertY,o,G,V,s,this._buffer,void 0,this._format,this._forcedExtension,z,I,Z,_)}catch(t){throw s("error loading",t),t}n&&(this._buffer=null)}}updateURL(t,K=null,D,a){this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(1,(t=>t.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=t),this.url=t,this._buffer=K,this._forcedExtension=a,this.delayLoadState=4,D&&(this._delayedOnLoad=D),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const t=this.getScene();t&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?e._.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=t.getEngine().createTexture(this.url,this._noMipmap,this._invertY,t,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(t,K,D,a){t*=this._cachedUScale,K*=this._cachedVScale,t-=this.uRotationCenter*this._cachedUScale,K-=this.vRotationCenter*this._cachedVScale,D-=this.wRotationCenter,W.Pq.TransformCoordinatesFromFloatsToRef(t,K,D,this._rowGenerationMatrix,a),a.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,a.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,a.z+=this.wRotationCenter}getTextureMatrix(t=1){if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*t===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*t,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=W.uq.Zero(),this._rowGenerationMatrix=new W.uq,this._t0=W.Pq.Zero(),this._t1=W.Pq.Zero(),this._t2=W.Pq.Zero()),W.uq.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(W.uq.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,W.AA.Matrix[0]),W.uq.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,W.AA.Matrix[1]),W.uq.ScalingToRef(this._cachedUScale,this._cachedVScale,0,W.AA.Matrix[2]),W.uq.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,W.AA.Matrix[3]),W.AA.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(W.AA.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(W.AA.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(W.AA.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),W.uq.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const K=this.getScene();if(!K)return this._cachedTextureMatrix;const D=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&D!==this._cachedIdentity3x2&&K.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const t=this.getScene();if(!t)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==u.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===t.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=W.uq.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=W.uq.Zero());const K=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case u.PLANAR_MODE:W.uq.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case u.PROJECTION_MODE:{W.uq.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const K=t.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=K.updateFlag,K.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:W.uq.IdentityToRef(this._cachedReflectionTextureMatrix)}return K&&t.markAllMaterialsAsDirty(1,(t=>t.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const t={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,onLoad:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return m.p.Clone((()=>new u(this._texture?this._texture.url:null,this.getScene(),t)),this)}serialize(){var t,K;const D=this.name;u.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const a=super.serialize(u._SerializeInternalTextureUniqueId);return a?((u.SerializeBuffers||u.ForceSerializeBuffers)&&("string"==typeof this._buffer&&"data:"===this._buffer.substr(0,5)?(a.base64String=this._buffer,a.name=a.name.replace("data:","")):this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array?a.base64String="data:image/png;base64,"+I.EL(this._buffer):(u.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(a.base64String=!this._engine||this._engine._features.supportSyncTextureRead?Z.lP(this):Z.nh(this))),a.invertY=this._invertY,a.samplingMode=this.samplingMode,a._creationFlags=this._creationFlags,a._useSRGBBuffer=this._useSRGBBuffer,u._SerializeInternalTextureUniqueId&&(a.internalTextureUniqueId=null!==(K=null===(t=this._texture)||void 0===t?void 0:t.uniqueId)&&void 0!==K?K:void 0),a.noMipmap=this._noMipmap,this.name=D,a):null}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(t,K,D){if(t.customType){const a=i.n.Instantiate(t.customType).Parse(t,K,D);return t.samplingMode&&a.updateSamplingMode&&a._samplingMode&&a._samplingMode!==t.samplingMode&&a.updateSamplingMode(t.samplingMode),a}if(t.isCube&&!t.isRenderTarget)return u._CubeTextureParser(t,K,D);const a=void 0!==t.internalTextureUniqueId;if(!t.name&&!t.isRenderTarget&&!a)return null;let G;if(a){const D=K.getEngine().getLoadedTexturesCache();for(const K of D)if(K.uniqueId===t.internalTextureUniqueId){G=K;break}}const N=K=>{var D;if(K&&K._texture&&(K._texture._cachedWrapU=null,K._texture._cachedWrapV=null,K._texture._cachedWrapR=null),t.samplingMode){const D=t.samplingMode;K&&K.samplingMode!==D&&K.updateSamplingMode(D)}if(K&&t.animations)for(let D=0;D<t.animations.length;D++){const a=t.animations[D],G=b.n9("BABYLON.Animation");G&&K.animations.push(G.Parse(a))}a&&!G&&(null===(D=null==K?void 0:K._texture)||void 0===D||D._setUniqueId(t.internalTextureUniqueId))};return m.p.Parse((()=>{var a,W,x;let b=!0;if(t.noMipmap&&(b=!1),t.mirrorPlane){const D=u._CreateMirror(t.name,t.renderTargetSize,K,b);return D._waitingRenderList=t.renderList,D.mirrorPlane=z.Z.FromArray(t.mirrorPlane),N(D),D}if(t.isRenderTarget){let D=null;if(t.isCube){if(K.reflectionProbes)for(let D=0;D<K.reflectionProbes.length;D++){const a=K.reflectionProbes[D];if(a.name===t.name)return a.cubeTexture}}else D=u._CreateRenderTargetTexture(t.name,t.renderTargetSize,K,b,null!==(a=t._creationFlags)&&void 0!==a?a:0),D._waitingRenderList=t.renderList;return N(D),D}if(t.isVideo){const a=u._CreateVideoTexture(D+(t.url||t.name),D+(t.src||t.url),K,b,t.invertY,t.samplingMode,t.settings||{});return N(a),a}{let a;if(t.base64String&&!G)a=u.CreateFromBase64String(t.base64String,t.base64String,K,!b,t.invertY,t.samplingMode,(()=>{N(a)}),null!==(W=t._creationFlags)&&void 0!==W?W:0,null!==(x=t._useSRGBBuffer)&&void 0!==x&&x),a.name=t.name;else{let W;W=t.name&&(t.name.indexOf("://")>0||t.name.startsWith("data:"))?t.name:D+t.name,t.url&&(t.url.startsWith("data:")||u.UseSerializedUrlIfAny)&&(W=t.url);const x={noMipmap:!b,invertY:t.invertY,samplingMode:t.samplingMode,onLoad:()=>{N(a)},internalTexture:G};a=new u(W,K,x)}return a}}),t,K)}static CreateFromBase64String(t,K,D,a,G,N=u.TRILINEAR_SAMPLINGMODE,W=null,x=null,b=5,n,e){return new u("data:"+K,D,a,G,N,W,x,t,!1,b,void 0,void 0,n,e)}static LoadFromDataString(t,K,D,a=!1,G,N=!0,W=u.TRILINEAR_SAMPLINGMODE,x=null,b=null,n=5,e,i){return"data:"!==t.substr(0,5)&&(t="data:"+t),new u(t,D,G,N,W,x,b,K,a,n,void 0,void 0,e,i)}}u.SerializeBuffers=!0,u.ForceSerializeBuffers=!1,u.OnTextureLoadErrorObservable=new N.cP,u._SerializeInternalTextureUniqueId=!1,u._CubeTextureParser=(t,K,D)=>{throw n.n("CubeTexture")},u._CreateMirror=(t,K,D,a)=>{throw n.n("MirrorTexture")},u._CreateRenderTargetTexture=(t,K,D,a,G)=>{throw n.n("RenderTargetTexture")},u.NEAREST_SAMPLINGMODE=1,u.NEAREST_NEAREST_MIPLINEAR=8,u.BILINEAR_SAMPLINGMODE=2,u.LINEAR_LINEAR_MIPNEAREST=11,u.TRILINEAR_SAMPLINGMODE=3,u.LINEAR_LINEAR_MIPLINEAR=3,u.NEAREST_NEAREST_MIPNEAREST=4,u.NEAREST_LINEAR_MIPNEAREST=5,u.NEAREST_LINEAR_MIPLINEAR=6,u.NEAREST_LINEAR=7,u.NEAREST_NEAREST=1,u.LINEAR_NEAREST_MIPNEAREST=9,u.LINEAR_NEAREST_MIPLINEAR=10,u.LINEAR_LINEAR=2,u.LINEAR_NEAREST=12,u.EXPLICIT_MODE=0,u.SPHERICAL_MODE=1,u.PLANAR_MODE=2,u.CUBIC_MODE=3,u.PROJECTION_MODE=4,u.SKYBOX_MODE=5,u.INVCUBIC_MODE=6,u.EQUIRECTANGULAR_MODE=7,u.FIXED_EQUIRECTANGULAR_MODE=8,u.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,u.CLAMP_ADDRESSMODE=0,u.WRAP_ADDRESSMODE=1,u.MIRROR_ADDRESSMODE=2,u.UseSerializedUrlIfAny=!0,a.Cg([G.lK()],u.prototype,"url",void 0),a.Cg([G.lK()],u.prototype,"uOffset",void 0),a.Cg([G.lK()],u.prototype,"vOffset",void 0),a.Cg([G.lK()],u.prototype,"uScale",void 0),a.Cg([G.lK()],u.prototype,"vScale",void 0),a.Cg([G.lK()],u.prototype,"uAng",void 0),a.Cg([G.lK()],u.prototype,"vAng",void 0),a.Cg([G.lK()],u.prototype,"wAng",void 0),a.Cg([G.lK()],u.prototype,"uRotationCenter",void 0),a.Cg([G.lK()],u.prototype,"vRotationCenter",void 0),a.Cg([G.lK()],u.prototype,"wRotationCenter",void 0),a.Cg([G.lK()],u.prototype,"homogeneousRotationInUVTransform",void 0),a.Cg([G.lK()],u.prototype,"isBlocking",null),b.Y5("BABYLON.Texture",u),m.p._TextureParser=u.Parse},796152:(t,K,D)=>{D.d(K,{u:()=>a});class a{get wrapU(){return this._cachedWrapU}set wrapU(t){this._cachedWrapU=t}get wrapV(){return this._cachedWrapV}set wrapV(t){this._cachedWrapV=t}get wrapR(){return this._cachedWrapR}set wrapR(t){this._cachedWrapR=t}get anisotropicFilteringLevel(){return this._cachedAnisotropicFilteringLevel}set anisotropicFilteringLevel(t){this._cachedAnisotropicFilteringLevel=t}get comparisonFunction(){return this._comparisonFunction}set comparisonFunction(t){this._comparisonFunction=t}get useMipMaps(){return this._useMipMaps}set useMipMaps(t){this._useMipMaps=t}constructor(){this.samplingMode=-1,this._useMipMaps=!0,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._comparisonFunction=0}setParameters(t=1,K=1,D=1,a=1,G=2,N=0){return this._cachedWrapU=t,this._cachedWrapV=K,this._cachedWrapR=D,this._cachedAnisotropicFilteringLevel=a,this.samplingMode=G,this._comparisonFunction=N,this}compareSampler(t){return this._cachedWrapU===t._cachedWrapU&&this._cachedWrapV===t._cachedWrapV&&this._cachedWrapR===t._cachedWrapR&&this._cachedAnisotropicFilteringLevel===t._cachedAnisotropicFilteringLevel&&this.samplingMode===t.samplingMode&&this._comparisonFunction===t._comparisonFunction&&this._useMipMaps===t._useMipMaps}}},140699:(t,K,D)=>{D.d(K,{D:()=>G});var a=D(500556);class G{get wrapU(){return this._wrapU}set wrapU(t){this._wrapU=t}get wrapV(){return this._wrapV}set wrapV(t){this._wrapV=t}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(t){this._texture&&(this._texture.isCube=t)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(t){this._texture&&(this._texture.is3D=t)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(t){this._texture&&(this._texture.is2DArray=t)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(t){return void 0!==(null==t?void 0:t.shareDepth)}constructor(t){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=a.o.Zero(),this._cachedBaseSize=a.o.Zero(),this._initialSamplingMode=2,this._texture=G._IsRenderTargetWrapper(t)?t.texture:t,this._texture&&(this._engine=this._texture.getEngine())}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(t){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(t,this._texture)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}},651577:(t,K,D)=>{function a(t){-1===t.indexOf("vClipPlane")&&t.push("vClipPlane"),-1===t.indexOf("vClipPlane2")&&t.push("vClipPlane2"),-1===t.indexOf("vClipPlane3")&&t.push("vClipPlane3"),-1===t.indexOf("vClipPlane4")&&t.push("vClipPlane4"),-1===t.indexOf("vClipPlane5")&&t.push("vClipPlane5"),-1===t.indexOf("vClipPlane6")&&t.push("vClipPlane6")}function G(t,K,D){var a,G,N,W,x,b;const n=!!(null!==(a=t.clipPlane)&&void 0!==a?a:K.clipPlane),e=!!(null!==(G=t.clipPlane2)&&void 0!==G?G:K.clipPlane2),i=!!(null!==(N=t.clipPlane3)&&void 0!==N?N:K.clipPlane3),z=!!(null!==(W=t.clipPlane4)&&void 0!==W?W:K.clipPlane4),I=!!(null!==(x=t.clipPlane5)&&void 0!==x?x:K.clipPlane5),Z=!!(null!==(b=t.clipPlane6)&&void 0!==b?b:K.clipPlane6);n&&D.push("#define CLIPPLANE"),e&&D.push("#define CLIPPLANE2"),i&&D.push("#define CLIPPLANE3"),z&&D.push("#define CLIPPLANE4"),I&&D.push("#define CLIPPLANE5"),Z&&D.push("#define CLIPPLANE6")}function N(t,K,D){var a,G,N,W,x,b;let n=!1;const e=!!(null!==(a=t.clipPlane)&&void 0!==a?a:K.clipPlane),i=!!(null!==(G=t.clipPlane2)&&void 0!==G?G:K.clipPlane2),z=!!(null!==(N=t.clipPlane3)&&void 0!==N?N:K.clipPlane3),I=!!(null!==(W=t.clipPlane4)&&void 0!==W?W:K.clipPlane4),Z=!!(null!==(x=t.clipPlane5)&&void 0!==x?x:K.clipPlane5),w=!!(null!==(b=t.clipPlane6)&&void 0!==b?b:K.clipPlane6);return D["CLIPPLANE"]!==e&&(D["CLIPPLANE"]=e,n=!0),D["CLIPPLANE2"]!==i&&(D["CLIPPLANE2"]=i,n=!0),D["CLIPPLANE3"]!==z&&(D["CLIPPLANE3"]=z,n=!0),D["CLIPPLANE4"]!==I&&(D["CLIPPLANE4"]=I,n=!0),D["CLIPPLANE5"]!==Z&&(D["CLIPPLANE5"]=Z,n=!0),D["CLIPPLANE6"]!==w&&(D["CLIPPLANE6"]=w,n=!0),n}function W(t,K,D){var a,G,N,W,b,n;let e=null!==(a=K.clipPlane)&&void 0!==a?a:D.clipPlane;x(t,"vClipPlane",e),e=null!==(G=K.clipPlane2)&&void 0!==G?G:D.clipPlane2,x(t,"vClipPlane2",e),e=null!==(N=K.clipPlane3)&&void 0!==N?N:D.clipPlane3,x(t,"vClipPlane3",e),e=null!==(W=K.clipPlane4)&&void 0!==W?W:D.clipPlane4,x(t,"vClipPlane4",e),e=null!==(b=K.clipPlane5)&&void 0!==b?b:D.clipPlane5,x(t,"vClipPlane5",e),e=null!==(n=K.clipPlane6)&&void 0!==n?n:D.clipPlane6,x(t,"vClipPlane6",e)}function x(t,K,D){D&&t.setFloat4(K,D.normal.x,D.normal.y,D.normal.z,D.d)}D.d(K,{Eq:()=>N,TV:()=>a,gS:()=>W,tv:()=>G})},844468:(t,K,D)=>{function a(t){t.push("vCameraColorCurveNeutral","vCameraColorCurvePositive","vCameraColorCurveNegative")}D.d(K,{B:()=>a})},87639:(t,K,D)=>{D.d(K,{Q:()=>b});var a=D(297809),G=D(760998),N=D(332290),W=D(337776),x=D(844468);class b{constructor(){this._dirty=!0,this._tempColor=new N.ov(0,0,0,0),this._globalCurve=new N.ov(0,0,0,0),this._highlightsCurve=new N.ov(0,0,0,0),this._midtonesCurve=new N.ov(0,0,0,0),this._shadowsCurve=new N.ov(0,0,0,0),this._positiveCurve=new N.ov(0,0,0,0),this._negativeCurve=new N.ov(0,0,0,0),this._globalHue=30,this._globalDensity=0,this._globalSaturation=0,this._globalExposure=0,this._highlightsHue=30,this._highlightsDensity=0,this._highlightsSaturation=0,this._highlightsExposure=0,this._midtonesHue=30,this._midtonesDensity=0,this._midtonesSaturation=0,this._midtonesExposure=0,this._shadowsHue=30,this._shadowsDensity=0,this._shadowsSaturation=0,this._shadowsExposure=0}get globalHue(){return this._globalHue}set globalHue(t){this._globalHue=t,this._dirty=!0}get globalDensity(){return this._globalDensity}set globalDensity(t){this._globalDensity=t,this._dirty=!0}get globalSaturation(){return this._globalSaturation}set globalSaturation(t){this._globalSaturation=t,this._dirty=!0}get globalExposure(){return this._globalExposure}set globalExposure(t){this._globalExposure=t,this._dirty=!0}get highlightsHue(){return this._highlightsHue}set highlightsHue(t){this._highlightsHue=t,this._dirty=!0}get highlightsDensity(){return this._highlightsDensity}set highlightsDensity(t){this._highlightsDensity=t,this._dirty=!0}get highlightsSaturation(){return this._highlightsSaturation}set highlightsSaturation(t){this._highlightsSaturation=t,this._dirty=!0}get highlightsExposure(){return this._highlightsExposure}set highlightsExposure(t){this._highlightsExposure=t,this._dirty=!0}get midtonesHue(){return this._midtonesHue}set midtonesHue(t){this._midtonesHue=t,this._dirty=!0}get midtonesDensity(){return this._midtonesDensity}set midtonesDensity(t){this._midtonesDensity=t,this._dirty=!0}get midtonesSaturation(){return this._midtonesSaturation}set midtonesSaturation(t){this._midtonesSaturation=t,this._dirty=!0}get midtonesExposure(){return this._midtonesExposure}set midtonesExposure(t){this._midtonesExposure=t,this._dirty=!0}get shadowsHue(){return this._shadowsHue}set shadowsHue(t){this._shadowsHue=t,this._dirty=!0}get shadowsDensity(){return this._shadowsDensity}set shadowsDensity(t){this._shadowsDensity=t,this._dirty=!0}get shadowsSaturation(){return this._shadowsSaturation}set shadowsSaturation(t){this._shadowsSaturation=t,this._dirty=!0}get shadowsExposure(){return this._shadowsExposure}set shadowsExposure(t){this._shadowsExposure=t,this._dirty=!0}getClassName(){return"ColorCurves"}static Bind(t,K,D="vCameraColorCurvePositive",a="vCameraColorCurveNeutral",G="vCameraColorCurveNegative"){t._dirty&&(t._dirty=!1,t._getColorGradingDataToRef(t._globalHue,t._globalDensity,t._globalSaturation,t._globalExposure,t._globalCurve),t._getColorGradingDataToRef(t._highlightsHue,t._highlightsDensity,t._highlightsSaturation,t._highlightsExposure,t._tempColor),t._tempColor.multiplyToRef(t._globalCurve,t._highlightsCurve),t._getColorGradingDataToRef(t._midtonesHue,t._midtonesDensity,t._midtonesSaturation,t._midtonesExposure,t._tempColor),t._tempColor.multiplyToRef(t._globalCurve,t._midtonesCurve),t._getColorGradingDataToRef(t._shadowsHue,t._shadowsDensity,t._shadowsSaturation,t._shadowsExposure,t._tempColor),t._tempColor.multiplyToRef(t._globalCurve,t._shadowsCurve),t._highlightsCurve.subtractToRef(t._midtonesCurve,t._positiveCurve),t._midtonesCurve.subtractToRef(t._shadowsCurve,t._negativeCurve)),K&&(K.setFloat4(D,t._positiveCurve.r,t._positiveCurve.g,t._positiveCurve.b,t._positiveCurve.a),K.setFloat4(a,t._midtonesCurve.r,t._midtonesCurve.g,t._midtonesCurve.b,t._midtonesCurve.a),K.setFloat4(G,t._negativeCurve.r,t._negativeCurve.g,t._negativeCurve.b,t._negativeCurve.a))}_getColorGradingDataToRef(t,K,D,a,G){null!=t&&(t=b._Clamp(t,0,360),K=b._Clamp(K,-100,100),D=b._Clamp(D,-100,100),a=b._Clamp(a,-100,100),K=b._ApplyColorGradingSliderNonlinear(K),K*=.5,a=b._ApplyColorGradingSliderNonlinear(a),K<0&&(K*=-1,t=(t+180)%360),b._FromHSBToRef(t,K,50+.25*a,G),G.scaleToRef(2,G),G.a=1+.01*D)}static _ApplyColorGradingSliderNonlinear(t){t/=100;let K=Math.abs(t);return K=Math.pow(K,2),t<0&&(K*=-1),K*=100,K}static _FromHSBToRef(t,K,D,a){let G=b._Clamp(t,0,360);const N=b._Clamp(K/100,0,1),W=b._Clamp(D/100,0,1);if(0===N)a.r=W,a.g=W,a.b=W;else{G/=60;const t=Math.floor(G),K=G-t,D=W*(1-N),x=W*(1-N*K),b=W*(1-N*(1-K));switch(t){case 0:a.r=W,a.g=b,a.b=D;break;case 1:a.r=x,a.g=W,a.b=D;break;case 2:a.r=D,a.g=W,a.b=b;break;case 3:a.r=D,a.g=x,a.b=W;break;case 4:a.r=b,a.g=D,a.b=W;break;default:a.r=W,a.g=D,a.b=x}}a.a=1}static _Clamp(t,K,D){return Math.min(Math.max(t,K),D)}clone(){return W.p.Clone((()=>new b),this)}serialize(){return W.p.Serialize(this)}static Parse(t){return W.p.Parse((()=>new b),t,null,null)}}b.PrepareUniforms=x.B,a.Cg([G.lK()],b.prototype,"_globalHue",void 0),a.Cg([G.lK()],b.prototype,"_globalDensity",void 0),a.Cg([G.lK()],b.prototype,"_globalSaturation",void 0),a.Cg([G.lK()],b.prototype,"_globalExposure",void 0),a.Cg([G.lK()],b.prototype,"_highlightsHue",void 0),a.Cg([G.lK()],b.prototype,"_highlightsDensity",void 0),a.Cg([G.lK()],b.prototype,"_highlightsSaturation",void 0),a.Cg([G.lK()],b.prototype,"_highlightsExposure",void 0),a.Cg([G.lK()],b.prototype,"_midtonesHue",void 0),a.Cg([G.lK()],b.prototype,"_midtonesDensity",void 0),a.Cg([G.lK()],b.prototype,"_midtonesSaturation",void 0),a.Cg([G.lK()],b.prototype,"_midtonesExposure",void 0),W.p._ColorCurvesParser=b.Parse},163406:(t,K,D)=>{function a(t){return void 0===t.getPipelineContext}D.d(K,{E:()=>a})},964061:(t,K,D)=>{D.d(K,{E:()=>a});class a{static GetEffect(t){return void 0===t.getPipelineContext?t.effect:t}constructor(t,K=!0){this._wasPreviouslyReady=!1,this._forceRebindOnNextCall=!0,this._wasPreviouslyUsingInstances=null,this.effect=null,this.defines=null,this.drawContext=t.createDrawContext(),K&&(this.materialContext=t.createMaterialContext())}setEffect(t,K,D=!0){var a;this.effect=t,void 0!==K&&(this.defines=K),D&&(null===(a=this.drawContext)||void 0===a||a.reset())}dispose(){var t;null===(t=this.drawContext)||void 0===t||t.dispose()}}},286648:(t,K,D)=>{D.d(K,{b4:()=>n,bu:()=>i,mO:()=>e,uR:()=>I});var a=D(394501),G=D(712251),N=D(395879),W=D(706400),x=D(867967),b=D(45410);function n(t,K){return G.N5(K).cachedPipelines[t]}function e(t){const K=t._name,D=t.context;if(K&&D){const t=G.N5(D),a=t.cachedPipelines[K];null==a||a.dispose(),delete t.cachedPipelines[K]}}function i(t,K,D,G,N,W,b){let n,e;const i=a.BA()?null==W?void 0:W.getHostDocument():null;n="string"==typeof K?K:K.vertexSource?"source:"+K.vertexSource:K.vertexElement?(null==i?void 0:i.getElementById(K.vertexElement))||K.vertexElement:K.vertex||K,e="string"==typeof K?K:K.fragmentSource?"source:"+K.fragmentSource:K.fragmentElement?(null==i?void 0:i.getElementById(K.fragmentElement))||K.fragmentElement:K.fragment||K;const I=[void 0,void 0],Z=()=>{if(I[0]&&I[1]){t.isFragment=!0;const[a,n]=I;x.M0(n,t,((W,n)=>{b&&(b._fragmentSourceCodeBeforeMigration=n),D&&(W=D("fragment",W));const e=x.nO(a,W,t);t=null;const i=function(t,K,D,a){return D?{vertexSourceCode:(1===a?"//":"")+"#define SHADER_NAME vertex:"+(D.vertexElement||D.vertex||D.spectorName||D)+"\n"+t,fragmentSourceCode:(1===a?"//":"")+"#define SHADER_NAME fragment:"+(D.fragmentElement||D.fragment||D.spectorName||D)+"\n"+K}:{vertexSourceCode:t,fragmentSourceCode:K}}(e.vertexCode,e.fragmentCode,K,N);null==G||G(i.vertexSourceCode,i.fragmentSourceCode)}),W)}};z(n,"Vertex","",(K=>{x.pB(t),x.M0(K,t,((t,a)=>{b&&(b._rawVertexSourceCode=K,b._vertexSourceCodeBeforeMigration=a),D&&(t=D("vertex",t)),I[0]=t,Z()}),W)}),N),z(e,"Fragment","Pixel",(t=>{b&&(b._rawFragmentSourceCode=t),I[1]=t,Z()}),N)}function z(t,K,D,G,W,x){if("undefined"!=typeof HTMLElement&&t instanceof HTMLElement)return void G(a.Zl(t));if("source:"===t.substr(0,7))return void G(t.substr(7));if("base64:"===t.substr(0,7))return void G(window.atob(t.substr(7)));const n=N.l.GetShadersStore(W);if(n[t+K+"Shader"])return void G(n[t+K+"Shader"]);if(D&&n[t+D+"Shader"])return void G(n[t+D+"Shader"]);let e;if(e="."===t[0]||"/"===t[0]||t.indexOf("http")>-1?t:N.l.GetShadersRepository(W)+t,!(x=x||b.W0))throw new Error("loadFileInjection is not defined");x(e+"."+K.toLowerCase()+".fx",G)}const I=(t,K,D,a)=>{try{const N=t.existingPipelineContext||K(t.shaderProcessingContext);return N._name=t.name,t.name&&t.context&&(G.N5(t.context).cachedPipelines[t.name]=N),D(N,t.vertex,t.fragment,!!t.createAsRaw,"","",t.rebuildRebind,t.defines,t.transformFeedbackVaryings,"",(()=>{a(N,(()=>{var K;null===(K=t.onRenderingStateCompiled)||void 0===K||K.call(t,N)}))})),N}catch(t){throw W.V.Error("Error compiling effect"),t}}},498083:(t,K,D)=>{D.d(K,{M:()=>x});var a=D(638113),G=D(706400),N=D(395879),W=D(286648);class x{static get ShadersRepository(){return N.l.ShadersRepository}static set ShadersRepository(t){N.l.ShadersRepository=t}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new a.cP),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(t,K,D,G=null,N,b=null,n=null,e=null,i=null,z,I="",Z=0,w){var m,u,d,E;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new a.cP,this.onErrorObservable=new a.cP,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=t,this._key=I;const l=this._key.replace(/\r/g,"").replace(/\n/g,"|");let Q;if(K.attributes){const t=K;if(this._engine=D,this._attributesNames=t.attributes,this._uniformsNames=t.uniformsNames.concat(t.samplers),this._samplerList=t.samplers.slice(),this.defines=t.defines,this.onError=t.onError,this.onCompiled=t.onCompiled,this._fallbacks=t.fallbacks,this._indexParameters=t.indexParameters,this._transformFeedbackVaryings=t.transformFeedbackVaryings||null,this._multiTarget=!!t.multiTarget,this._shaderLanguage=null!==(m=t.shaderLanguage)&&void 0!==m?m:0,t.uniformBuffersNames){this._uniformBuffersNamesList=t.uniformBuffersNames.slice();for(let K=0;K<t.uniformBuffersNames.length;K++)this._uniformBuffersNames[t.uniformBuffersNames[K]]=K}this._processFinalCode=null!==(u=t.processFinalCode)&&void 0!==u?u:null,this._processCodeAfterIncludes=null!==(d=t.processCodeAfterIncludes)&&void 0!==d?d:void 0,Q=t.existingPipelineContext}else this._engine=N,this.defines=null==b?"":b,this._uniformsNames=D.concat(G),this._samplerList=G?G.slice():[],this._attributesNames=K,this._uniformBuffersNamesList=[],this._shaderLanguage=Z,this.onError=i,this.onCompiled=e,this._indexParameters=z,this._fallbacks=n;"WEBGL2"===this._engine.shaderPlatformName&&(Q=null!==(E=W.b4(l,this._engine._gl))&&void 0!==E?E:Q),this._attributeLocationByName={},this.uniqueId=x._UniqueIdSeed++,Q?(this._pipelineContext=Q,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,w)}async _processShaderCodeAsync(t=null,K=!1,D=null,a){a&&await a(),this._processingContext=D||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const G={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:null!=t?t:this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:N.l.GetShadersRepository(this._shaderLanguage),includesShadersStore:N.l.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};W.bu(G,this.name,this._processFinalCode,((t,D)=>{this._vertexSourceCode=t,this._fragmentSourceCode=D,this._prepareEffect(K)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch(t){return!1}}_isReadyInternal(){return!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(t){return this._attributes[t]}getAttributeLocationByName(t){return this._attributeLocationByName[t]}getAttributesCount(){return this._attributes.length}getUniformIndex(t){return this._uniformsNames.indexOf(t)}getUniform(t){return this._uniforms[t]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}executeWhenCompiled(t){this.isReady()?t(this):(this.onCompileObservable.add((K=>{t(K)})),this._pipelineContext&&!this._pipelineContext.isAsync||setTimeout((()=>{this._checkIsReady(null)}),16))}_checkIsReady(t){try{if(this._isReadyInternal())return}catch(K){return void this._processCompilationErrors(K,t)}this._isDisposed||setTimeout((()=>{this._checkIsReady(t)}),16)}get vertexSourceCode(){var t,K;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:null!==(K=null===(t=this._pipelineContext)||void 0===t?void 0:t._getVertexShaderCode())&&void 0!==K?K:this._vertexSourceCode}get fragmentSourceCode(){var t,K;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:null!==(K=null===(t=this._pipelineContext)||void 0===t?void 0:t._getFragmentShaderCode())&&void 0!==K?K:this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(t,K,D,a){this._isReady=!1,this._vertexSourceCodeOverride=t,this._fragmentSourceCodeOverride=K,this.onError=(t,K)=>{a&&a(K)},this.onCompiled=()=>{var t,K;const a=this.getEngine().scenes;if(a)for(let t=0;t<a.length;t++)a[t].markAllMaterialsAsDirty(63);null===(K=(t=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===K||K.call(t,D)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(t){if(this._pipelineContext=t,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let t=0;t<this._attributesNames.length;t++){const K=this._attributesNames[t];this._attributeLocationByName[K]=this._attributes[t]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh()}_prepareEffect(t=!1){const K=this._pipelineContext;this._isReady=!1;try{const D=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),a=D?null:this.defines,G=D?this._vertexSourceCodeOverride:this._vertexSourceCode,N=D?this._fragmentSourceCodeOverride:this._fragmentSourceCode,x=this._engine;this._pipelineContext=W.uR({existingPipelineContext:t?K:null,vertex:G,fragment:N,context:"WEBGL2"===x.shaderPlatformName?x._gl:void 0,rebuildRebind:(t,K,D,a)=>this._rebuildProgram(t,K,D,a),defines:a,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:D,parallelShaderCompile:x._caps.parallelShaderCompile,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:D=>{K&&!t&&this._engine._deletePipelineContext(K),D&&this._onRenderingStateCompiled(D)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContext.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(K)}catch(t){this._processCompilationErrors(t,K)}}_getShaderCodeAndErrorLine(t,K,D){const a=D?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let G=null;if(K&&t){const N=K.match(a);if(N&&2===N.length){const K=parseInt(N[1]),a=t.split("\n",-1);a.length>=K&&(G=`Offending line [${K}] in ${D?"fragment":"vertex"} code: ${a[K-1]}`)}}return[t,G]}_processCompilationErrors(t,K=null){var D,a,N;this._compilationError=t.message;const W=this._attributesNames,b=this._fallbacks;if(G.V.Error("Unable to compile effect:"),G.V.Error("Uniforms: "+this._uniformsNames.map((function(t){return" "+t}))),G.V.Error("Attributes: "+W.map((function(t){return" "+t}))),G.V.Error("Defines:\n"+this.defines),x.LogShaderCodeOnCompilationError){let t=null,K=null,W=null;(null===(D=this._pipelineContext)||void 0===D?void 0:D._getVertexShaderCode())&&([W,t]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),W&&(G.V.Error("Vertex code:"),G.V.Error(W))),(null===(a=this._pipelineContext)||void 0===a?void 0:a._getFragmentShaderCode())&&([W,K]=this._getShaderCodeAndErrorLine(null===(N=this._pipelineContext)||void 0===N?void 0:N._getFragmentShaderCode(),this._compilationError,!0),W&&(G.V.Error("Fragment code:"),G.V.Error(W))),t&&G.V.Error(t),K&&G.V.Error(K)}G.V.Error("Error: "+this._compilationError);const n=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this)};K&&(this._pipelineContext=K,this._isReady=!0,n()),b?(this._pipelineContext=null,b.hasMoreFallbacks?(this._allFallbacksProcessed=!1,G.V.Error("Trying next fallback."),this.defines=b.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,n(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,K||n())}get isSupported(){return""===this._compilationError}_bindTexture(t,K){this._engine._bindTexture(this._samplers[t],K,t)}setTexture(t,K){this._engine.setTexture(this._samplers[t],this._uniforms[t],K,t)}setTextureArray(t,K){const D=t+"Ex";if(-1===this._samplerList.indexOf(D+"0")){const a=this._samplerList.indexOf(t);for(let t=1;t<K.length;t++){const K=D+(t-1).toString();this._samplerList.splice(a+t,0,K)}let G=0;for(const t of this._samplerList)this._samplers[t]=G,G+=1}this._engine.setTextureArray(this._samplers[t],this._uniforms[t],K,t)}bindUniformBuffer(t,K){const D=this._uniformBuffersNames[K];void 0===D||x._BaseCache[D]===t&&this._engine._features.useUBOBindingCache||(x._BaseCache[D]=t,this._engine.bindUniformBufferBase(t,D,K))}bindUniformBlock(t,K){this._engine.bindUniformBlock(this._pipelineContext,t,K)}setInt(t,K){return this._pipelineContext.setInt(t,K),this}setInt2(t,K,D){return this._pipelineContext.setInt2(t,K,D),this}setInt3(t,K,D,a){return this._pipelineContext.setInt3(t,K,D,a),this}setInt4(t,K,D,a,G){return this._pipelineContext.setInt4(t,K,D,a,G),this}setIntArray(t,K){return this._pipelineContext.setIntArray(t,K),this}setIntArray2(t,K){return this._pipelineContext.setIntArray2(t,K),this}setIntArray3(t,K){return this._pipelineContext.setIntArray3(t,K),this}setIntArray4(t,K){return this._pipelineContext.setIntArray4(t,K),this}setUInt(t,K){return this._pipelineContext.setUInt(t,K),this}setUInt2(t,K,D){return this._pipelineContext.setUInt2(t,K,D),this}setUInt3(t,K,D,a){return this._pipelineContext.setUInt3(t,K,D,a),this}setUInt4(t,K,D,a,G){return this._pipelineContext.setUInt4(t,K,D,a,G),this}setUIntArray(t,K){return this._pipelineContext.setUIntArray(t,K),this}setUIntArray2(t,K){return this._pipelineContext.setUIntArray2(t,K),this}setUIntArray3(t,K){return this._pipelineContext.setUIntArray3(t,K),this}setUIntArray4(t,K){return this._pipelineContext.setUIntArray4(t,K),this}setFloatArray(t,K){return this._pipelineContext.setArray(t,K),this}setFloatArray2(t,K){return this._pipelineContext.setArray2(t,K),this}setFloatArray3(t,K){return this._pipelineContext.setArray3(t,K),this}setFloatArray4(t,K){return this._pipelineContext.setArray4(t,K),this}setArray(t,K){return this._pipelineContext.setArray(t,K),this}setArray2(t,K){return this._pipelineContext.setArray2(t,K),this}setArray3(t,K){return this._pipelineContext.setArray3(t,K),this}setArray4(t,K){return this._pipelineContext.setArray4(t,K),this}setMatrices(t,K){return this._pipelineContext.setMatrices(t,K),this}setMatrix(t,K){return this._pipelineContext.setMatrix(t,K),this}setMatrix3x3(t,K){return this._pipelineContext.setMatrix3x3(t,K),this}setMatrix2x2(t,K){return this._pipelineContext.setMatrix2x2(t,K),this}setFloat(t,K){return this._pipelineContext.setFloat(t,K),this}setBool(t,K){return this._pipelineContext.setInt(t,K?1:0),this}setVector2(t,K){return this._pipelineContext.setVector2(t,K),this}setFloat2(t,K,D){return this._pipelineContext.setFloat2(t,K,D),this}setVector3(t,K){return this._pipelineContext.setVector3(t,K),this}setFloat3(t,K,D,a){return this._pipelineContext.setFloat3(t,K,D,a),this}setVector4(t,K){return this._pipelineContext.setVector4(t,K),this}setQuaternion(t,K){return this._pipelineContext.setQuaternion(t,K),this}setFloat4(t,K,D,a,G){return this._pipelineContext.setFloat4(t,K,D,a,G),this}setColor3(t,K){return this._pipelineContext.setColor3(t,K),this}setColor4(t,K,D){return this._pipelineContext.setColor4(t,K,D),this}setDirectColor4(t,K){return this._pipelineContext.setDirectColor4(t,K),this}dispose(){this._refCount--,this._refCount>0||(this._pipelineContext&&W.mO(this._pipelineContext),this._engine._releaseEffect(this),this._isDisposed=!0)}static RegisterShader(t,K,D,a=0){K&&(N.l.GetShadersStore(a)[`${t}PixelShader`]=K),D&&(N.l.GetShadersStore(a)[`${t}VertexShader`]=D)}static ResetCache(){x._BaseCache={}}}x.LogShaderCodeOnCompilationError=!0,x._UniqueIdSeed=0,x._BaseCache={},x.ShadersStore=N.l.ShadersStore,x.IncludesShadersStore=N.l.IncludesShadersStore},522208:(t,K,D)=>{D.d(K,{J:()=>a});class a{constructor(){this._defines={},this._currentRank=32,this._maxRank=-1,this._mesh=null}unBindMesh(){this._mesh=null}addFallback(t,K){this._defines[t]||(t<this._currentRank&&(this._currentRank=t),t>this._maxRank&&(this._maxRank=t),this._defines[t]=new Array),this._defines[t].push(K)}addCPUSkinningFallback(t,K){this._mesh=K,t<this._currentRank&&(this._currentRank=t),t>this._maxRank&&(this._maxRank=t)}get hasMoreFallbacks(){return this._currentRank<=this._maxRank}reduce(t,K){if(this._mesh&&this._mesh.computeBonesUsingShaders&&this._mesh.numBoneInfluencers>0){this._mesh.computeBonesUsingShaders=!1,t=t.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0"),K._bonesComputationForcedToCPU=!0;const D=this._mesh.getScene();for(let t=0;t<D.meshes.length;t++){const a=D.meshes[t];if(a.material){if(a.computeBonesUsingShaders&&0!==a.numBoneInfluencers)if(a.material.getEffect()===K)a.computeBonesUsingShaders=!1;else if(a.subMeshes)for(const t of a.subMeshes)if(t.effect===K){a.computeBonesUsingShaders=!1;break}}else!this._mesh.material&&a.computeBonesUsingShaders&&a.numBoneInfluencers>0&&(a.computeBonesUsingShaders=!1)}}else{const K=this._defines[this._currentRank];if(K)for(let D=0;D<K.length;D++)t=t.replace("#define "+K[D],"");this._currentRank++}return t}}},101032:(t,K,D)=>{D.d(K,{$:()=>e,J:()=>n});var a=D(23987),G=D(60071),N=D(638113),W=D(498083),x=D(964061);D(310839);const b={positions:[1,1,-1,1,-1,-1,1,-1],indices:[0,1,2,0,2,3]};class n{constructor(t,K=b){var D,N;this._fullscreenViewport=new G.L(0,0,1,1);const W=null!==(D=K.positions)&&void 0!==D?D:b.positions,x=null!==(N=K.indices)&&void 0!==N?N:b.indices;this.engine=t,this._vertexBuffers={[a.R.PositionKind]:new a.R(t,W,a.R.PositionKind,!1,!1,2)},this._indexBuffer=t.createIndexBuffer(x),this._onContextRestoredObserver=t.onContextRestoredObservable.add((()=>{this._indexBuffer=t.createIndexBuffer(x);for(const t in this._vertexBuffers)this._vertexBuffers[t]._rebuild()}))}setViewport(t=this._fullscreenViewport){this.engine.setViewport(t)}bindBuffers(t){this.engine.bindBuffers(this._vertexBuffers,this._indexBuffer,t)}applyEffectWrapper(t){this.engine.setState(!0),this.engine.depthCullingState.depthTest=!1,this.engine.stencilState.stencilTest=!1,this.engine.enableEffect(t._drawWrapper),this.bindBuffers(t.effect),t.onApplyObservable.notifyObservers({})}saveStates(){this._savedStateDepthTest=this.engine.depthCullingState.depthTest,this._savedStateStencilTest=this.engine.stencilState.stencilTest}restoreStates(){this.engine.depthCullingState.depthTest=this._savedStateDepthTest,this.engine.stencilState.stencilTest=this._savedStateStencilTest}draw(){this.engine.drawElementsType(0,0,6)}_isRenderTargetTexture(t){return void 0!==t.renderTarget}render(t,K=null){if(!t.effect.isReady())return;this.saveStates(),this.setViewport();const D=null===K?null:this._isRenderTargetTexture(K)?K.renderTarget:K;D&&this.engine.bindFramebuffer(D),this.applyEffectWrapper(t),this.draw(),D&&this.engine.unBindFramebuffer(D),this.restoreStates()}dispose(){const t=this._vertexBuffers[a.R.PositionKind];t&&(t.dispose(),delete this._vertexBuffers[a.R.PositionKind]),this._indexBuffer&&this.engine._releaseBuffer(this._indexBuffer),this._onContextRestoredObserver&&(this.engine.onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null)}}class e{get effect(){return this._drawWrapper.effect}set effect(t){this._drawWrapper.effect=t}constructor(t){let K;this.onApplyObservable=new N.cP;const D=t.uniformNames||[];t.vertexShader?K={fragmentSource:t.fragmentShader,vertexSource:t.vertexShader,spectorName:t.name||"effectWrapper"}:(D.push("scale"),K={fragmentSource:t.fragmentShader,vertex:"postprocess",spectorName:t.name||"effectWrapper"},this.onApplyObservable.add((()=>{this.effect.setFloat2("scale",1,1)})));const a=t.defines?t.defines.join("\n"):"";this._drawWrapper=new x.E(t.engine),t.useShaderStore?(K.fragment=K.fragmentSource,K.vertex||(K.vertex=K.vertexSource),delete K.fragmentSource,delete K.vertexSource,this.effect=t.engine.createEffect(K,t.attributeNames||["position"],D,t.samplerNames,a,void 0,t.onCompiled,void 0,void 0,t.shaderLanguage,t.extraInitializationsAsync)):(this.effect=new W.M(K,t.attributeNames||["position"],D,t.samplerNames,t.engine,a,void 0,t.onCompiled,void 0,void 0,void 0,t.shaderLanguage,t.extraInitializationsAsync),this._onContextRestoredObserver=t.engine.onContextRestoredObservable.add((()=>{this.effect._pipelineContext=null,this.effect._prepareEffect()})))}dispose(t=!1){this._onContextRestoredObserver&&(this.effect.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null),this.effect.dispose()}}},309229:(t,K,D)=>{D.d(K,{C:()=>N,_:()=>G});var a=D(844468);function G(t,K){K.EXPOSURE&&t.push("exposureLinear"),K.CONTRAST&&t.push("contrast"),K.COLORGRADING&&t.push("colorTransformSettings"),(K.VIGNETTE||K.DITHER)&&t.push("vInverseScreenSize"),K.VIGNETTE&&(t.push("vignetteSettings1"),t.push("vignetteSettings2")),K.COLORCURVES&&a.B(t),K.DITHER&&t.push("ditherIntensity")}function N(t,K){K.COLORGRADING&&t.push("txColorTransform")}},239590:(t,K,D)=>{D.d(K,{p:()=>z});var a=D(297809),G=D(760998),N=D(638113),W=D(332290),x=D(87639),b=D(104270),n=D(337776),e=D(309229),i=D(310035);class z{constructor(){this.colorCurves=new x.Q,this._colorCurvesEnabled=!1,this._colorGradingEnabled=!1,this._colorGradingWithGreenDepth=!0,this._colorGradingBGR=!0,this._exposure=1,this._toneMappingEnabled=!1,this._toneMappingType=z.TONEMAPPING_STANDARD,this._contrast=1,this.vignetteStretch=0,this.vignetteCenterX=0,this.vignetteCenterY=0,this.vignetteWeight=1.5,this.vignetteColor=new W.ov(0,0,0,0),this.vignetteCameraFov=.5,this._vignetteBlendMode=z.VIGNETTEMODE_MULTIPLY,this._vignetteEnabled=!1,this._ditheringEnabled=!1,this._ditheringIntensity=1/255,this._skipFinalColorClamp=!1,this._applyByPostProcess=!1,this._isEnabled=!0,this.onUpdateParameters=new N.cP}get colorCurvesEnabled(){return this._colorCurvesEnabled}set colorCurvesEnabled(t){this._colorCurvesEnabled!==t&&(this._colorCurvesEnabled=t,this._updateParameters())}get colorGradingTexture(){return this._colorGradingTexture}set colorGradingTexture(t){this._colorGradingTexture!==t&&(this._colorGradingTexture=t,this._updateParameters())}get colorGradingEnabled(){return this._colorGradingEnabled}set colorGradingEnabled(t){this._colorGradingEnabled!==t&&(this._colorGradingEnabled=t,this._updateParameters())}get colorGradingWithGreenDepth(){return this._colorGradingWithGreenDepth}set colorGradingWithGreenDepth(t){this._colorGradingWithGreenDepth!==t&&(this._colorGradingWithGreenDepth=t,this._updateParameters())}get colorGradingBGR(){return this._colorGradingBGR}set colorGradingBGR(t){this._colorGradingBGR!==t&&(this._colorGradingBGR=t,this._updateParameters())}get exposure(){return this._exposure}set exposure(t){this._exposure!==t&&(this._exposure=t,this._updateParameters())}get toneMappingEnabled(){return this._toneMappingEnabled}set toneMappingEnabled(t){this._toneMappingEnabled!==t&&(this._toneMappingEnabled=t,this._updateParameters())}get toneMappingType(){return this._toneMappingType}set toneMappingType(t){this._toneMappingType!==t&&(this._toneMappingType=t,this._updateParameters())}get contrast(){return this._contrast}set contrast(t){this._contrast!==t&&(this._contrast=t,this._updateParameters())}get vignetteCentreY(){return this.vignetteCenterY}set vignetteCentreY(t){this.vignetteCenterY=t}get vignetteCentreX(){return this.vignetteCenterX}set vignetteCentreX(t){this.vignetteCenterX=t}get vignetteBlendMode(){return this._vignetteBlendMode}set vignetteBlendMode(t){this._vignetteBlendMode!==t&&(this._vignetteBlendMode=t,this._updateParameters())}get vignetteEnabled(){return this._vignetteEnabled}set vignetteEnabled(t){this._vignetteEnabled!==t&&(this._vignetteEnabled=t,this._updateParameters())}get ditheringEnabled(){return this._ditheringEnabled}set ditheringEnabled(t){this._ditheringEnabled!==t&&(this._ditheringEnabled=t,this._updateParameters())}get ditheringIntensity(){return this._ditheringIntensity}set ditheringIntensity(t){this._ditheringIntensity!==t&&(this._ditheringIntensity=t,this._updateParameters())}get skipFinalColorClamp(){return this._skipFinalColorClamp}set skipFinalColorClamp(t){this._skipFinalColorClamp!==t&&(this._skipFinalColorClamp=t,this._updateParameters())}get applyByPostProcess(){return this._applyByPostProcess}set applyByPostProcess(t){this._applyByPostProcess!==t&&(this._applyByPostProcess=t,this._updateParameters())}get isEnabled(){return this._isEnabled}set isEnabled(t){this._isEnabled!==t&&(this._isEnabled=t,this._updateParameters())}_updateParameters(){this.onUpdateParameters.notifyObservers(this)}getClassName(){return"ImageProcessingConfiguration"}prepareDefines(t,K=!1){if(K!==this.applyByPostProcess||!this._isEnabled)return t.VIGNETTE=!1,t.TONEMAPPING=0,t.CONTRAST=!1,t.EXPOSURE=!1,t.COLORCURVES=!1,t.COLORGRADING=!1,t.COLORGRADING3D=!1,t.DITHER=!1,t.IMAGEPROCESSING=!1,t.SKIPFINALCOLORCLAMP=this.skipFinalColorClamp,void(t.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess&&this._isEnabled);if(t.VIGNETTE=this.vignetteEnabled,t.VIGNETTEBLENDMODEMULTIPLY=this.vignetteBlendMode===z._VIGNETTEMODE_MULTIPLY,t.VIGNETTEBLENDMODEOPAQUE=!t.VIGNETTEBLENDMODEMULTIPLY,this._toneMappingEnabled)switch(this._toneMappingType){case z.TONEMAPPING_KHR_PBR_NEUTRAL:t.TONEMAPPING=3;break;case z.TONEMAPPING_ACES:t.TONEMAPPING=2;break;default:t.TONEMAPPING=1}else t.TONEMAPPING=0;t.CONTRAST=1!==this.contrast,t.EXPOSURE=1!==this.exposure,t.COLORCURVES=this.colorCurvesEnabled&&!!this.colorCurves,t.COLORGRADING=this.colorGradingEnabled&&!!this.colorGradingTexture,t.COLORGRADING?t.COLORGRADING3D=this.colorGradingTexture.is3D:t.COLORGRADING3D=!1,t.SAMPLER3DGREENDEPTH=this.colorGradingWithGreenDepth,t.SAMPLER3DBGRMAP=this.colorGradingBGR,t.DITHER=this._ditheringEnabled,t.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess,t.SKIPFINALCOLORCLAMP=this.skipFinalColorClamp,t.IMAGEPROCESSING=t.VIGNETTE||!!t.TONEMAPPING||t.CONTRAST||t.EXPOSURE||t.COLORCURVES||t.COLORGRADING||t.DITHER}isReady(){return!this.colorGradingEnabled||!this.colorGradingTexture||this.colorGradingTexture.isReady()}bind(t,K){if(this._colorCurvesEnabled&&this.colorCurves&&x.Q.Bind(this.colorCurves,t),this._vignetteEnabled||this._ditheringEnabled){const D=1/t.getEngine().getRenderWidth(),a=1/t.getEngine().getRenderHeight();if(t.setFloat2("vInverseScreenSize",D,a),this._ditheringEnabled&&t.setFloat("ditherIntensity",.5*this._ditheringIntensity),this._vignetteEnabled){const G=null!=K?K:a/D;let N=Math.tan(.5*this.vignetteCameraFov),W=N*G;const x=Math.sqrt(W*N);W=b.zF(W,x,this.vignetteStretch),N=b.zF(N,x,this.vignetteStretch),t.setFloat4("vignetteSettings1",W,N,-W*this.vignetteCenterX,-N*this.vignetteCenterY);const n=-2*this.vignetteWeight;t.setFloat4("vignetteSettings2",this.vignetteColor.r,this.vignetteColor.g,this.vignetteColor.b,n)}}if(t.setFloat("exposureLinear",this.exposure),t.setFloat("contrast",this.contrast),this.colorGradingTexture){t.setTexture("txColorTransform",this.colorGradingTexture);const K=this.colorGradingTexture.getSize().height;t.setFloat4("colorTransformSettings",(K-1)/K,.5/K,K,this.colorGradingTexture.level)}}clone(){return n.p.Clone((()=>new z),this)}serialize(){return n.p.Serialize(this)}static Parse(t){const K=n.p.Parse((()=>new z),t,null,null);return void 0!==t.vignetteCentreX&&(K.vignetteCenterX=t.vignetteCentreX),void 0!==t.vignetteCentreY&&(K.vignetteCenterY=t.vignetteCentreY),K}static get VIGNETTEMODE_MULTIPLY(){return this._VIGNETTEMODE_MULTIPLY}static get VIGNETTEMODE_OPAQUE(){return this._VIGNETTEMODE_OPAQUE}}z.TONEMAPPING_STANDARD=0,z.TONEMAPPING_ACES=1,z.TONEMAPPING_KHR_PBR_NEUTRAL=2,z.PrepareUniforms=e._,z.PrepareSamplers=e.C,z._VIGNETTEMODE_MULTIPLY=0,z._VIGNETTEMODE_OPAQUE=1,a.Cg([G.wL()],z.prototype,"colorCurves",void 0),a.Cg([G.lK()],z.prototype,"_colorCurvesEnabled",void 0),a.Cg([G.uM("colorGradingTexture")],z.prototype,"_colorGradingTexture",void 0),a.Cg([G.lK()],z.prototype,"_colorGradingEnabled",void 0),a.Cg([G.lK()],z.prototype,"_colorGradingWithGreenDepth",void 0),a.Cg([G.lK()],z.prototype,"_colorGradingBGR",void 0),a.Cg([G.lK()],z.prototype,"_exposure",void 0),a.Cg([G.lK()],z.prototype,"_toneMappingEnabled",void 0),a.Cg([G.lK()],z.prototype,"_toneMappingType",void 0),a.Cg([G.lK()],z.prototype,"_contrast",void 0),a.Cg([G.lK()],z.prototype,"vignetteStretch",void 0),a.Cg([G.lK()],z.prototype,"vignetteCenterX",void 0),a.Cg([G.lK()],z.prototype,"vignetteCenterY",void 0),a.Cg([G.lK()],z.prototype,"vignetteWeight",void 0),a.Cg([G.qK()],z.prototype,"vignetteColor",void 0),a.Cg([G.lK()],z.prototype,"vignetteCameraFov",void 0),a.Cg([G.lK()],z.prototype,"_vignetteBlendMode",void 0),a.Cg([G.lK()],z.prototype,"_vignetteEnabled",void 0),a.Cg([G.lK()],z.prototype,"_ditheringEnabled",void 0),a.Cg([G.lK()],z.prototype,"_ditheringIntensity",void 0),a.Cg([G.lK()],z.prototype,"_skipFinalColorClamp",void 0),a.Cg([G.lK()],z.prototype,"_applyByPostProcess",void 0),a.Cg([G.lK()],z.prototype,"_isEnabled",void 0),n.p._ImageProcessingConfigurationParser=z.Parse,i.Y5("BABYLON.ImageProcessingConfiguration",z)},722736:(t,K,D)=>{D.d(K,{c:()=>i});var a=D(297809),G=D(55973),N=D(760998),W=D(591160),x=D(527335),b=D(185537),n=D(855300);class e extends x.M{constructor(){super(...arguments),this.DETAIL=!1,this.DETAILDIRECTUV=0,this.DETAIL_NORMALBLENDMETHOD=0}}class i extends b.y{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}isCompatible(){return!0}constructor(t,K=!0){super(t,"DetailMap",140,new e,K),this._texture=null,this.diffuseBlendLevel=1,this.roughnessBlendLevel=1,this.bumpLevel=1,this._normalBlendMethod=G.i.MATERIAL_NORMALBLENDMETHOD_WHITEOUT,this._isEnabled=!1,this.isEnabled=!1,this._internalMarkAllSubMeshesAsTexturesDirty=t._dirtyCallbacks[1]}isReadyForSubMesh(t,K,D){return!this._isEnabled||!(t._areTexturesDirty&&K.texturesEnabled&&D.getCaps().standardDerivatives&&this._texture&&W.h.DetailTextureEnabled&&!this._texture.isReady())}prepareDefines(t,K){if(this._isEnabled){t.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod;const D=K.getEngine();t._areTexturesDirty&&(D.getCaps().standardDerivatives&&this._texture&&W.h.DetailTextureEnabled&&this._isEnabled?(n.YT(this._texture,t,"DETAIL"),t.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod):t.DETAIL=!1)}else t.DETAIL=!1}bindForSubMesh(t,K){if(!this._isEnabled)return;const D=this._material.isFrozen;t.useUbo&&D&&t.isSync||this._texture&&W.h.DetailTextureEnabled&&(t.updateFloat4("vDetailInfos",this._texture.coordinatesIndex,this.diffuseBlendLevel,this.bumpLevel,this.roughnessBlendLevel),n.mA(this._texture,t,"detail")),K.texturesEnabled&&this._texture&&W.h.DetailTextureEnabled&&t.setTexture("detailSampler",this._texture)}hasTexture(t){return this._texture===t}getActiveTextures(t){this._texture&&t.push(this._texture)}getAnimatables(t){this._texture&&this._texture.animations&&this._texture.animations.length>0&&t.push(this._texture)}dispose(t){var K;t&&(null===(K=this._texture)||void 0===K||K.dispose())}getClassName(){return"DetailMapConfiguration"}getSamplers(t){t.push("detailSampler")}getUniforms(){return{ubo:[{name:"vDetailInfos",size:4,type:"vec4"},{name:"detailMatrix",size:16,type:"mat4"}]}}}a.Cg([N.uM("detailTexture"),N.$z("_markAllSubMeshesAsTexturesDirty")],i.prototype,"texture",void 0),a.Cg([N.lK()],i.prototype,"diffuseBlendLevel",void 0),a.Cg([N.lK()],i.prototype,"roughnessBlendLevel",void 0),a.Cg([N.lK()],i.prototype,"bumpLevel",void 0),a.Cg([N.lK(),N.$z("_markAllSubMeshesAsTexturesDirty")],i.prototype,"normalBlendMethod",void 0),a.Cg([N.lK(),N.$z("_markAllSubMeshesAsTexturesDirty")],i.prototype,"isEnabled",void 0)},55973:(t,K,D)=>{D.d(K,{i:()=>m});var a=D(297809),G=D(760998),N=D(898973),W=D(638113),x=D(395726),b=D(374216),n=D(384898),e=D(706400),i=D(298039),z=D(964061),I=D(337776);class Z{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=519,this.funcRef=1,this.funcMask=255,this.opStencilFail=7680,this.opDepthFail=7680,this.opStencilDepthPass=7681}get func(){return this._func}set func(t){this._func=t}get funcRef(){return this._funcRef}set funcRef(t){this._funcRef=t}get funcMask(){return this._funcMask}set funcMask(t){this._funcMask=t}get opStencilFail(){return this._opStencilFail}set opStencilFail(t){this._opStencilFail=t}get opDepthFail(){return this._opDepthFail}set opDepthFail(t){this._opDepthFail=t}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(t){this._opStencilDepthPass=t}get mask(){return this._mask}set mask(t){this._mask=t}get enabled(){return this._enabled}set enabled(t){this._enabled=t}getClassName(){return"MaterialStencilState"}copyTo(t){I.p.Clone((()=>t),this)}serialize(){return I.p.Serialize(this)}parse(t,K,D){I.p.Parse((()=>this),t,K,D)}}a.Cg([G.lK()],Z.prototype,"func",null),a.Cg([G.lK()],Z.prototype,"funcRef",null),a.Cg([G.lK()],Z.prototype,"funcMask",null),a.Cg([G.lK()],Z.prototype,"opStencilFail",null),a.Cg([G.lK()],Z.prototype,"opDepthFail",null),a.Cg([G.lK()],Z.prototype,"opStencilDepthPass",null),a.Cg([G.lK()],Z.prototype,"mask",null),a.Cg([G.lK()],Z.prototype,"enabled",null);var w=D(855300);class m{get shaderLanguage(){return this._shaderLanguage}get canRenderToMRT(){return!1}set alpha(t){if(this._alpha===t)return;const K=this._alpha;this._alpha=t,1!==K&&1!==t||this.markAsDirty(m.MiscDirtyFlag+m.PrePassDirtyFlag)}get alpha(){return this._alpha}set backFaceCulling(t){this._backFaceCulling!==t&&(this._backFaceCulling=t,this.markAsDirty(m.TextureDirtyFlag))}get backFaceCulling(){return this._backFaceCulling}set cullBackFaces(t){this._cullBackFaces!==t&&(this._cullBackFaces=t,this.markAsDirty(m.TextureDirtyFlag))}get cullBackFaces(){return this._cullBackFaces}get blockDirtyMechanism(){return this._blockDirtyMechanism}set blockDirtyMechanism(t){this._blockDirtyMechanism!==t&&(this._blockDirtyMechanism=t,t||this.markDirty())}atomicMaterialsUpdate(t){this.blockDirtyMechanism=!0;try{t(this)}finally{this.blockDirtyMechanism=!1}}get hasRenderTargetTextures(){return this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._eventInfo.hasRenderTargetTextures}set onDispose(t){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(t)}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new W.cP),this._onBindObservable}set onBind(t){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver),this._onBindObserver=this.onBindObservable.add(t)}get onUnBindObservable(){return this._onUnBindObservable||(this._onUnBindObservable=new W.cP),this._onUnBindObservable}get onEffectCreatedObservable(){return this._onEffectCreatedObservable||(this._onEffectCreatedObservable=new W.cP),this._onEffectCreatedObservable}set alphaMode(t){this._alphaMode!==t&&(this._alphaMode=t,this.markAsDirty(m.TextureDirtyFlag))}get alphaMode(){return this._alphaMode}set needDepthPrePass(t){this._needDepthPrePass!==t&&(this._needDepthPrePass=t,this._needDepthPrePass&&(this.checkReadyOnEveryCall=!0))}get needDepthPrePass(){return this._needDepthPrePass}get isPrePassCapable(){return!1}set fogEnabled(t){this._fogEnabled!==t&&(this._fogEnabled=t,this.markAsDirty(m.MiscDirtyFlag))}get fogEnabled(){return this._fogEnabled}get wireframe(){switch(this._fillMode){case m.WireFrameFillMode:case m.LineListDrawMode:case m.LineLoopDrawMode:case m.LineStripDrawMode:return!0}return this._scene.forceWireframe}set wireframe(t){this.fillMode=t?m.WireFrameFillMode:m.TriangleFillMode}get pointsCloud(){switch(this._fillMode){case m.PointFillMode:case m.PointListDrawMode:return!0}return this._scene.forcePointsCloud}set pointsCloud(t){this.fillMode=t?m.PointFillMode:m.TriangleFillMode}get fillMode(){return this._fillMode}set fillMode(t){this._fillMode!==t&&(this._fillMode=t,this.markAsDirty(m.MiscDirtyFlag))}get useLogarithmicDepth(){return this._useLogarithmicDepth}set useLogarithmicDepth(t){const K=this.getScene().getEngine().getCaps().fragmentDepthSupported;t&&!K&&e.V.Warn("Logarithmic depth has been requested for a material on a device that doesn't support it."),this._useLogarithmicDepth=t&&K,this._markAllSubMeshesAsMiscDirty()}_getDrawWrapper(){return this._drawWrapper}_setDrawWrapper(t){this._drawWrapper=t}constructor(t,K,D){this.shadowDepthWrapper=null,this.allowShaderHotSwapping=!0,this._shaderLanguage=0,this.metadata=null,this.reservedDataStore=null,this.checkReadyOnEveryCall=!1,this.checkReadyOnlyOnce=!1,this.state="",this._alpha=1,this._backFaceCulling=!0,this._cullBackFaces=!0,this._blockDirtyMechanism=!1,this.sideOrientation=null,this.onCompiled=null,this.onError=null,this.getRenderTargetTextures=null,this.doNotSerialize=!1,this._storeEffectOnSubMeshes=!1,this.animations=null,this.onDisposeObservable=new W.cP,this._onDisposeObserver=null,this._onUnBindObservable=null,this._onBindObserver=null,this._alphaMode=2,this._needDepthPrePass=!1,this.disableDepthWrite=!1,this.disableColorWrite=!1,this.forceDepthWrite=!1,this.depthFunction=0,this.separateCullingPass=!1,this._fogEnabled=!0,this.pointSize=1,this.zOffset=0,this.zOffsetUnits=0,this.stencil=new Z,this._useUBO=!1,this._fillMode=m.TriangleFillMode,this._cachedDepthWriteState=!1,this._cachedColorWriteState=!1,this._cachedDepthFunctionState=0,this._indexInSceneMaterialArray=-1,this.meshMap=null,this._parentContainer=null,this._uniformBufferLayoutBuilt=!1,this._eventInfo={},this._callbackPluginEventGeneric=()=>{},this._callbackPluginEventIsReadyForSubMesh=()=>{},this._callbackPluginEventPrepareDefines=()=>{},this._callbackPluginEventPrepareDefinesBeforeAttributes=()=>{},this._callbackPluginEventHardBindForSubMesh=()=>{},this._callbackPluginEventBindForSubMesh=()=>{},this._callbackPluginEventHasRenderTargetTextures=()=>{},this._callbackPluginEventFillRenderTargetTextures=()=>{},this._forceAlphaTest=!1,this._transparencyMode=null,this.name=t;const a=K||x.q.LastCreatedScene;a&&(this._scene=a,this._dirtyCallbacks={},this._dirtyCallbacks[1]=this._markAllSubMeshesAsTexturesDirty.bind(this),this._dirtyCallbacks[2]=this._markAllSubMeshesAsLightsDirty.bind(this),this._dirtyCallbacks[4]=this._markAllSubMeshesAsFresnelDirty.bind(this),this._dirtyCallbacks[8]=this._markAllSubMeshesAsAttributesDirty.bind(this),this._dirtyCallbacks[16]=this._markAllSubMeshesAsMiscDirty.bind(this),this._dirtyCallbacks[32]=this._markAllSubMeshesAsPrePassDirty.bind(this),this._dirtyCallbacks[63]=this._markAllSubMeshesAsAllDirty.bind(this),this.id=t||N.S0.RandomId(),this.uniqueId=this._scene.getUniqueId(),this._materialContext=this._scene.getEngine().createMaterialContext(),this._drawWrapper=new z.E(this._scene.getEngine(),!1),this._drawWrapper.materialContext=this._materialContext,this._uniformBuffer=new n.D(this._scene.getEngine(),void 0,void 0,t),this._useUBO=this.getScene().getEngine().supportsUniformBuffers,D||this._scene.addMaterial(this),this._scene.useMaterialMeshMap&&(this.meshMap={}),m.OnEventObservable.notifyObservers(this,1))}toString(t){return"Name: "+this.name}getClassName(){return"Material"}get _isMaterial(){return!0}get isFrozen(){return this.checkReadyOnlyOnce}freeze(){this.markDirty(),this.checkReadyOnlyOnce=!0}unfreeze(){this.markDirty(),this.checkReadyOnlyOnce=!1}isReady(t,K){return!0}isReadyForSubMesh(t,K,D){const a=K.materialDefines;return!!a&&(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=a,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),this._eventInfo.isReadyForSubMesh)}getEffect(){return this._drawWrapper.effect}getScene(){return this._scene}_getEffectiveOrientation(t){return null!==this.sideOrientation?this.sideOrientation:t.sideOrientation}get transparencyMode(){return this._transparencyMode}set transparencyMode(t){this._transparencyMode!==t&&(this._transparencyMode=t,this._forceAlphaTest=t===m.MATERIAL_ALPHATESTANDBLEND,this._markAllSubMeshesAsTexturesAndMiscDirty())}get _disableAlphaBlending(){return this._transparencyMode===m.MATERIAL_OPAQUE||this._transparencyMode===m.MATERIAL_ALPHATEST}needAlphaBlending(){return!this._disableAlphaBlending&&this.alpha<1}needAlphaBlendingForMesh(t){return t.visibility<1||!this._disableAlphaBlending&&(t.hasVertexAlpha||this.needAlphaBlending())}needAlphaTesting(){return!!this._forceAlphaTest}_shouldTurnAlphaTestOn(t){return!this.needAlphaBlendingForMesh(t)&&this.needAlphaTesting()}getAlphaTestTexture(){return null}markDirty(t=!1){const K=this.getScene().meshes;for(const D of K)if(D.subMeshes)for(const K of D.subMeshes)if(K.getMaterial()===this)for(const D of K._drawWrappers)D&&this._materialContext===D.materialContext&&(D._wasPreviouslyReady=!1,D._wasPreviouslyUsingInstances=null,D._forceRebindOnNextCall=t);t&&this.markAsDirty(m.AllDirtyFlag)}_preBind(t,K=null){const D=this._scene.getEngine(),a=(null==K?this.sideOrientation:K)===m.ClockWiseSideOrientation;return D.enableEffect(t||this._getDrawWrapper()),D.setState(this.backFaceCulling,this.zOffset,!1,a,this._scene._mirroredCameraPosition?!this.cullBackFaces:this.cullBackFaces,this.stencil,this.zOffsetUnits),a}bind(t,K){}buildUniformLayout(){const t=this._uniformBuffer;this._eventInfo.ubo=t,this._callbackPluginEventGeneric(8,this._eventInfo),t.create(),this._uniformBufferLayoutBuilt=!0}bindForSubMesh(t,K,D){const a=D._drawWrapper;this._eventInfo.subMesh=D,this._callbackPluginEventBindForSubMesh(this._eventInfo),a._forceRebindOnNextCall=!1}bindOnlyWorldMatrix(t){}bindView(t){this._useUBO?this._needToBindSceneUbo=!0:t.setMatrix("view",this.getScene().getViewMatrix())}bindViewProjection(t){this._useUBO?this._needToBindSceneUbo=!0:(t.setMatrix("viewProjection",this.getScene().getTransformMatrix()),t.setMatrix("projection",this.getScene().getProjectionMatrix()))}bindEyePosition(t,K){this._useUBO?this._needToBindSceneUbo=!0:this._scene.bindEyePosition(t,K)}_afterBind(t,K=null,D){if(this._scene._cachedMaterial=this,this._needToBindSceneUbo&&K&&(this._needToBindSceneUbo=!1,w._8(K,this.getScene().getSceneUniformBuffer()),this._scene.finalizeSceneUbo()),this._scene._cachedVisibility=t?t.visibility:1,this._onBindObservable&&t&&this._onBindObservable.notifyObservers(t),this.disableDepthWrite){const t=this._scene.getEngine();this._cachedDepthWriteState=t.getDepthWrite(),t.setDepthWrite(!1)}if(this.disableColorWrite){const t=this._scene.getEngine();this._cachedColorWriteState=t.getColorWrite(),t.setColorWrite(!1)}if(0!==this.depthFunction){const t=this._scene.getEngine();this._cachedDepthFunctionState=t.getDepthFunction()||0,t.setDepthFunction(this.depthFunction)}}unbind(){this._onUnBindObservable&&this._onUnBindObservable.notifyObservers(this),0!==this.depthFunction&&this._scene.getEngine().setDepthFunction(this._cachedDepthFunctionState),this.disableDepthWrite&&this._scene.getEngine().setDepthWrite(this._cachedDepthWriteState),this.disableColorWrite&&this._scene.getEngine().setColorWrite(this._cachedColorWriteState)}getAnimatables(){return this._eventInfo.animatables=[],this._callbackPluginEventGeneric(256,this._eventInfo),this._eventInfo.animatables}getActiveTextures(){return this._eventInfo.activeTextures=[],this._callbackPluginEventGeneric(512,this._eventInfo),this._eventInfo.activeTextures}hasTexture(t){return this._eventInfo.hasTexture=!1,this._eventInfo.texture=t,this._callbackPluginEventGeneric(1024,this._eventInfo),this._eventInfo.hasTexture}clone(t){return null}_clonePlugins(t,K){const D={};if(this._serializePlugins(D),m._ParsePlugins(D,t,this._scene,K),this.pluginManager)for(const K of this.pluginManager._plugins){const D=t.pluginManager.getPlugin(K.name);D&&K.copyTo(D)}}getBindedMeshes(){if(this.meshMap){const t=[];for(const K in this.meshMap){const D=this.meshMap[K];D&&t.push(D)}return t}return this._scene.meshes.filter((t=>t.material===this))}forceCompilation(t,K,D,a){const G={clipPlane:!1,useInstances:!1,...D},N=this.getScene(),W=this.allowShaderHotSwapping;this.allowShaderHotSwapping=!1;const x=()=>{if(!this._scene||!this._scene.getEngine())return;const D=N.clipPlane;if(G.clipPlane&&(N.clipPlane=new i.Z(0,0,0,1)),this._storeEffectOnSubMeshes){let D=!0,N=null;if(t.subMeshes){const K=new b.K(0,0,0,0,0,t,void 0,!1,!1);K.materialDefines&&(K.materialDefines._renderId=-1),this.isReadyForSubMesh(t,K,G.useInstances)||(K.effect&&K.effect.getCompilationError()&&K.effect.allFallbacksProcessed()?N=K.effect.getCompilationError():(D=!1,setTimeout(x,16)))}D&&(this.allowShaderHotSwapping=W,N&&a&&a(N),K&&K(this))}else this.isReady()?(this.allowShaderHotSwapping=W,K&&K(this)):setTimeout(x,16);G.clipPlane&&(N.clipPlane=D)};x()}forceCompilationAsync(t,K){return new Promise(((D,a)=>{this.forceCompilation(t,(()=>{D()}),K,(t=>{a(t)}))}))}markAsDirty(t){this.getScene().blockMaterialDirtyMechanism||this._blockDirtyMechanism||(m._DirtyCallbackArray.length=0,t&m.TextureDirtyFlag&&m._DirtyCallbackArray.push(m._TextureDirtyCallBack),t&m.LightDirtyFlag&&m._DirtyCallbackArray.push(m._LightsDirtyCallBack),t&m.FresnelDirtyFlag&&m._DirtyCallbackArray.push(m._FresnelDirtyCallBack),t&m.AttributesDirtyFlag&&m._DirtyCallbackArray.push(m._AttributeDirtyCallBack),t&m.MiscDirtyFlag&&m._DirtyCallbackArray.push(m._MiscDirtyCallBack),t&m.PrePassDirtyFlag&&m._DirtyCallbackArray.push(m._PrePassDirtyCallBack),m._DirtyCallbackArray.length&&this._markAllSubMeshesAsDirty(m._RunDirtyCallBacks),this.getScene().resetCachedMaterial())}resetDrawCache(){const t=this.getScene().meshes;for(const K of t)if(K.subMeshes)for(const t of K.subMeshes)t.getMaterial()===this&&t.resetDrawCache()}_markAllSubMeshesAsDirty(t){if(this.getScene().blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const K=this.getScene().meshes;for(const D of K)if(D.subMeshes)for(const K of D.subMeshes)if(K.getMaterial(!1)===this)for(const D of K._drawWrappers)D&&D.defines&&D.defines.markAllAsDirty&&this._materialContext===D.materialContext&&t(D.defines)}_markScenePrePassDirty(){if(this.getScene().blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const t=this.getScene().enablePrePassRenderer();t&&t.markAsDirty()}_markAllSubMeshesAsAllDirty(){this._markAllSubMeshesAsDirty(m._AllDirtyCallBack)}_markAllSubMeshesAsImageProcessingDirty(){this._markAllSubMeshesAsDirty(m._ImageProcessingDirtyCallBack)}_markAllSubMeshesAsTexturesDirty(){this._markAllSubMeshesAsDirty(m._TextureDirtyCallBack)}_markAllSubMeshesAsFresnelDirty(){this._markAllSubMeshesAsDirty(m._FresnelDirtyCallBack)}_markAllSubMeshesAsFresnelAndMiscDirty(){this._markAllSubMeshesAsDirty(m._FresnelAndMiscDirtyCallBack)}_markAllSubMeshesAsLightsDirty(){this._markAllSubMeshesAsDirty(m._LightsDirtyCallBack)}_markAllSubMeshesAsAttributesDirty(){this._markAllSubMeshesAsDirty(m._AttributeDirtyCallBack)}_markAllSubMeshesAsMiscDirty(){this._markAllSubMeshesAsDirty(m._MiscDirtyCallBack)}_markAllSubMeshesAsPrePassDirty(){this._markAllSubMeshesAsDirty(m._MiscDirtyCallBack)}_markAllSubMeshesAsTexturesAndMiscDirty(){this._markAllSubMeshesAsDirty(m._TextureAndMiscDirtyCallBack)}_checkScenePerformancePriority(){if(0!==this._scene.performancePriority){this.checkReadyOnlyOnce=!0;const t=this._scene.onScenePerformancePriorityChangedObservable.addOnce((()=>{this.checkReadyOnlyOnce=!1}));this.onDisposeObservable.add((()=>{this._scene.onScenePerformancePriorityChangedObservable.remove(t)}))}}setPrePassRenderer(t){return!1}dispose(t,K,D){const a=this.getScene();if(a.stopAnimation(this),a.freeProcessedMaterials(),a.removeMaterial(this),this._eventInfo.forceDisposeTextures=K,this._callbackPluginEventGeneric(2,this._eventInfo),this._parentContainer){const t=this._parentContainer.materials.indexOf(this);t>-1&&this._parentContainer.materials.splice(t,1),this._parentContainer=null}if(!0!==D)if(this.meshMap)for(const K in this.meshMap){const D=this.meshMap[K];D&&(D.material=null,this.releaseVertexArrayObject(D,t))}else{const K=a.meshes;for(const D of K)D.material!==this||D.sourceMesh||(D.material=null,this.releaseVertexArrayObject(D,t))}this._uniformBuffer.dispose(),t&&this._drawWrapper.effect&&(this._storeEffectOnSubMeshes||this._drawWrapper.effect.dispose(),this._drawWrapper.effect=null),this.metadata=null,this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this._onBindObservable&&this._onBindObservable.clear(),this._onUnBindObservable&&this._onUnBindObservable.clear(),this._onEffectCreatedObservable&&this._onEffectCreatedObservable.clear(),this._eventInfo&&(this._eventInfo={})}releaseVertexArrayObject(t,K){const D=t.geometry;if(D)if(this._storeEffectOnSubMeshes){if(t.subMeshes)for(const a of t.subMeshes)D._releaseVertexArrayObject(a.effect),K&&a.effect&&a.effect.dispose()}else D._releaseVertexArrayObject(this._drawWrapper.effect)}serialize(){const t=I.p.Serialize(this);return t.stencil=this.stencil.serialize(),t.uniqueId=this.uniqueId,this._serializePlugins(t),t}_serializePlugins(t){if(t.plugins={},this.pluginManager)for(const K of this.pluginManager._plugins)t.plugins[K.getClassName()]=K.serialize()}static Parse(t,K,D){if(t.customType){if("BABYLON.PBRMaterial"===t.customType&&t.overloadedAlbedo&&(t.customType="BABYLON.LegacyPBRMaterial",!BABYLON.LegacyPBRMaterial))return e.V.Error("Your scene is trying to load a legacy version of the PBRMaterial, please, include it from the materials library."),null}else t.customType="BABYLON.StandardMaterial";const a=N.S0.Instantiate(t.customType).Parse(t,K,D);return a._loadedUniqueId=t.uniqueId,a}static _ParsePlugins(t,K,D,a){var G;if(t.plugins)for(const W in t.plugins){const x=t.plugins[W];let b=null===(G=K.pluginManager)||void 0===G?void 0:G.getPlugin(x.name);if(!b){const t=N.S0.Instantiate("BABYLON."+W);t&&(b=new t(K))}null==b||b.parse(x,D,a)}}}m.TriangleFillMode=0,m.WireFrameFillMode=1,m.PointFillMode=2,m.PointListDrawMode=3,m.LineListDrawMode=4,m.LineLoopDrawMode=5,m.LineStripDrawMode=6,m.TriangleStripDrawMode=7,m.TriangleFanDrawMode=8,m.ClockWiseSideOrientation=0,m.CounterClockWiseSideOrientation=1,m.TextureDirtyFlag=1,m.LightDirtyFlag=2,m.FresnelDirtyFlag=4,m.AttributesDirtyFlag=8,m.MiscDirtyFlag=16,m.PrePassDirtyFlag=32,m.AllDirtyFlag=63,m.MATERIAL_OPAQUE=0,m.MATERIAL_ALPHATEST=1,m.MATERIAL_ALPHABLEND=2,m.MATERIAL_ALPHATESTANDBLEND=3,m.MATERIAL_NORMALBLENDMETHOD_WHITEOUT=0,m.MATERIAL_NORMALBLENDMETHOD_RNM=1,m.OnEventObservable=new W.cP,m._AllDirtyCallBack=t=>t.markAllAsDirty(),m._ImageProcessingDirtyCallBack=t=>t.markAsImageProcessingDirty(),m._TextureDirtyCallBack=t=>t.markAsTexturesDirty(),m._FresnelDirtyCallBack=t=>t.markAsFresnelDirty(),m._MiscDirtyCallBack=t=>t.markAsMiscDirty(),m._PrePassDirtyCallBack=t=>t.markAsPrePassDirty(),m._LightsDirtyCallBack=t=>t.markAsLightDirty(),m._AttributeDirtyCallBack=t=>t.markAsAttributesDirty(),m._FresnelAndMiscDirtyCallBack=t=>{m._FresnelDirtyCallBack(t),m._MiscDirtyCallBack(t)},m._TextureAndMiscDirtyCallBack=t=>{m._TextureDirtyCallBack(t),m._MiscDirtyCallBack(t)},m._DirtyCallbackArray=[],m._RunDirtyCallBacks=t=>{for(const K of m._DirtyCallbackArray)K(t)},a.Cg([G.lK()],m.prototype,"id",void 0),a.Cg([G.lK()],m.prototype,"uniqueId",void 0),a.Cg([G.lK()],m.prototype,"name",void 0),a.Cg([G.lK()],m.prototype,"metadata",void 0),a.Cg([G.lK()],m.prototype,"checkReadyOnEveryCall",void 0),a.Cg([G.lK()],m.prototype,"checkReadyOnlyOnce",void 0),a.Cg([G.lK()],m.prototype,"state",void 0),a.Cg([G.lK("alpha")],m.prototype,"_alpha",void 0),a.Cg([G.lK("backFaceCulling")],m.prototype,"_backFaceCulling",void 0),a.Cg([G.lK("cullBackFaces")],m.prototype,"_cullBackFaces",void 0),a.Cg([G.lK()],m.prototype,"sideOrientation",void 0),a.Cg([G.lK("alphaMode")],m.prototype,"_alphaMode",void 0),a.Cg([G.lK()],m.prototype,"_needDepthPrePass",void 0),a.Cg([G.lK()],m.prototype,"disableDepthWrite",void 0),a.Cg([G.lK()],m.prototype,"disableColorWrite",void 0),a.Cg([G.lK()],m.prototype,"forceDepthWrite",void 0),a.Cg([G.lK()],m.prototype,"depthFunction",void 0),a.Cg([G.lK()],m.prototype,"separateCullingPass",void 0),a.Cg([G.lK("fogEnabled")],m.prototype,"_fogEnabled",void 0),a.Cg([G.lK()],m.prototype,"pointSize",void 0),a.Cg([G.lK()],m.prototype,"zOffset",void 0),a.Cg([G.lK()],m.prototype,"zOffsetUnits",void 0),a.Cg([G.lK()],m.prototype,"pointsCloud",null),a.Cg([G.lK()],m.prototype,"fillMode",null),a.Cg([G.lK()],m.prototype,"useLogarithmicDepth",null),a.Cg([G.lK()],m.prototype,"transparencyMode",null)},527335:(t,K,D)=>{D.d(K,{M:()=>a});class a{constructor(t){if(this._keys=[],this._isDirty=!0,this._areLightsDirty=!0,this._areLightsDisposed=!1,this._areAttributesDirty=!0,this._areTexturesDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._arePrePassDirty=!0,this._areImageProcessingDirty=!0,this._normals=!1,this._uvs=!1,this._needNormals=!1,this._needUVs=!1,this._externalProperties=t,t)for(const K in t)Object.prototype.hasOwnProperty.call(t,K)&&this._setDefaultValue(K)}get isDirty(){return this._isDirty}markAsProcessed(){this._isDirty=!1,this._areAttributesDirty=!1,this._areTexturesDirty=!1,this._areFresnelDirty=!1,this._areLightsDirty=!1,this._areLightsDisposed=!1,this._areMiscDirty=!1,this._arePrePassDirty=!1,this._areImageProcessingDirty=!1}markAsUnprocessed(){this._isDirty=!0}markAllAsDirty(){this._areTexturesDirty=!0,this._areAttributesDirty=!0,this._areLightsDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._arePrePassDirty=!1,this._areImageProcessingDirty=!0,this._isDirty=!0}markAsImageProcessingDirty(){this._areImageProcessingDirty=!0,this._isDirty=!0}markAsLightDirty(t=!1){this._areLightsDirty=!0,this._areLightsDisposed=this._areLightsDisposed||t,this._isDirty=!0}markAsAttributesDirty(){this._areAttributesDirty=!0,this._isDirty=!0}markAsTexturesDirty(){this._areTexturesDirty=!0,this._isDirty=!0}markAsFresnelDirty(){this._areFresnelDirty=!0,this._isDirty=!0}markAsMiscDirty(){this._areMiscDirty=!0,this._isDirty=!0}markAsPrePassDirty(){this._arePrePassDirty=!0,this._isDirty=!0}rebuild(){this._keys.length=0;for(const t of Object.keys(this))"_"!==t[0]&&this._keys.push(t);if(this._externalProperties)for(const t in this._externalProperties)-1===this._keys.indexOf(t)&&this._keys.push(t)}isEqual(t){if(this._keys.length!==t._keys.length)return!1;for(let K=0;K<this._keys.length;K++){const D=this._keys[K];if(this[D]!==t[D])return!1}return!0}cloneTo(t){this._keys.length!==t._keys.length&&(t._keys=this._keys.slice(0));for(let K=0;K<this._keys.length;K++){const D=this._keys[K];t[D]=this[D]}}reset(){this._keys.forEach((t=>this._setDefaultValue(t)))}_setDefaultValue(t){var K,D,a,G,N;const W=null!==(a=null===(D=null===(K=this._externalProperties)||void 0===K?void 0:K[t])||void 0===D?void 0:D.type)&&void 0!==a?a:typeof this[t],x=null===(N=null===(G=this._externalProperties)||void 0===G?void 0:G[t])||void 0===N?void 0:N.default;switch(W){case"number":this[t]=null!=x?x:0;break;case"string":this[t]=null!=x?x:"";break;default:this[t]=null!=x&&x}}toString(){let t="";for(let K=0;K<this._keys.length;K++){const D=this._keys[K],a=this[D];switch(typeof a){case"number":case"string":t+="#define "+D+" "+a+"\n";break;default:a&&(t+="#define "+D+"\n")}}return t}}},591160:(t,K,D)=>{D.d(K,{h:()=>G});var a=D(33321);class G{static get DiffuseTextureEnabled(){return this._DiffuseTextureEnabled}static set DiffuseTextureEnabled(t){this._DiffuseTextureEnabled!==t&&(this._DiffuseTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get DetailTextureEnabled(){return this._DetailTextureEnabled}static set DetailTextureEnabled(t){this._DetailTextureEnabled!==t&&(this._DetailTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get DecalMapEnabled(){return this._DecalMapEnabled}static set DecalMapEnabled(t){this._DecalMapEnabled!==t&&(this._DecalMapEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get AmbientTextureEnabled(){return this._AmbientTextureEnabled}static set AmbientTextureEnabled(t){this._AmbientTextureEnabled!==t&&(this._AmbientTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get OpacityTextureEnabled(){return this._OpacityTextureEnabled}static set OpacityTextureEnabled(t){this._OpacityTextureEnabled!==t&&(this._OpacityTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get ReflectionTextureEnabled(){return this._ReflectionTextureEnabled}static set ReflectionTextureEnabled(t){this._ReflectionTextureEnabled!==t&&(this._ReflectionTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get EmissiveTextureEnabled(){return this._EmissiveTextureEnabled}static set EmissiveTextureEnabled(t){this._EmissiveTextureEnabled!==t&&(this._EmissiveTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get SpecularTextureEnabled(){return this._SpecularTextureEnabled}static set SpecularTextureEnabled(t){this._SpecularTextureEnabled!==t&&(this._SpecularTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get BumpTextureEnabled(){return this._BumpTextureEnabled}static set BumpTextureEnabled(t){this._BumpTextureEnabled!==t&&(this._BumpTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get LightmapTextureEnabled(){return this._LightmapTextureEnabled}static set LightmapTextureEnabled(t){this._LightmapTextureEnabled!==t&&(this._LightmapTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get RefractionTextureEnabled(){return this._RefractionTextureEnabled}static set RefractionTextureEnabled(t){this._RefractionTextureEnabled!==t&&(this._RefractionTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get ColorGradingTextureEnabled(){return this._ColorGradingTextureEnabled}static set ColorGradingTextureEnabled(t){this._ColorGradingTextureEnabled!==t&&(this._ColorGradingTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get FresnelEnabled(){return this._FresnelEnabled}static set FresnelEnabled(t){this._FresnelEnabled!==t&&(this._FresnelEnabled=t,a.$.MarkAllMaterialsAsDirty(4))}static get ClearCoatTextureEnabled(){return this._ClearCoatTextureEnabled}static set ClearCoatTextureEnabled(t){this._ClearCoatTextureEnabled!==t&&(this._ClearCoatTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get ClearCoatBumpTextureEnabled(){return this._ClearCoatBumpTextureEnabled}static set ClearCoatBumpTextureEnabled(t){this._ClearCoatBumpTextureEnabled!==t&&(this._ClearCoatBumpTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get ClearCoatTintTextureEnabled(){return this._ClearCoatTintTextureEnabled}static set ClearCoatTintTextureEnabled(t){this._ClearCoatTintTextureEnabled!==t&&(this._ClearCoatTintTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get SheenTextureEnabled(){return this._SheenTextureEnabled}static set SheenTextureEnabled(t){this._SheenTextureEnabled!==t&&(this._SheenTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get AnisotropicTextureEnabled(){return this._AnisotropicTextureEnabled}static set AnisotropicTextureEnabled(t){this._AnisotropicTextureEnabled!==t&&(this._AnisotropicTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get ThicknessTextureEnabled(){return this._ThicknessTextureEnabled}static set ThicknessTextureEnabled(t){this._ThicknessTextureEnabled!==t&&(this._ThicknessTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get RefractionIntensityTextureEnabled(){return this._ThicknessTextureEnabled}static set RefractionIntensityTextureEnabled(t){this._RefractionIntensityTextureEnabled!==t&&(this._RefractionIntensityTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get TranslucencyIntensityTextureEnabled(){return this._TranslucencyIntensityTextureEnabled}static set TranslucencyIntensityTextureEnabled(t){this._TranslucencyIntensityTextureEnabled!==t&&(this._TranslucencyIntensityTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get TranslucencyColorTextureEnabled(){return this._TranslucencyColorTextureEnabled}static set TranslucencyColorTextureEnabled(t){this._TranslucencyColorTextureEnabled!==t&&(this._TranslucencyColorTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}static get IridescenceTextureEnabled(){return this._IridescenceTextureEnabled}static set IridescenceTextureEnabled(t){this._IridescenceTextureEnabled!==t&&(this._IridescenceTextureEnabled=t,a.$.MarkAllMaterialsAsDirty(1))}}G._DiffuseTextureEnabled=!0,G._DetailTextureEnabled=!0,G._DecalMapEnabled=!0,G._AmbientTextureEnabled=!0,G._OpacityTextureEnabled=!0,G._ReflectionTextureEnabled=!0,G._EmissiveTextureEnabled=!0,G._SpecularTextureEnabled=!0,G._BumpTextureEnabled=!0,G._LightmapTextureEnabled=!0,G._RefractionTextureEnabled=!0,G._ColorGradingTextureEnabled=!0,G._FresnelEnabled=!0,G._ClearCoatTextureEnabled=!0,G._ClearCoatBumpTextureEnabled=!0,G._ClearCoatTintTextureEnabled=!0,G._SheenTextureEnabled=!0,G._AnisotropicTextureEnabled=!0,G._ThicknessTextureEnabled=!0,G._RefractionIntensityTextureEnabled=!0,G._TranslucencyIntensityTextureEnabled=!0,G._TranslucencyColorTextureEnabled=!0,G._IridescenceTextureEnabled=!0},855300:(t,K,D)=>{D.d(K,{Bb:()=>s,DL:()=>e,ER:()=>q,IF:()=>I,J2:()=>E,MF:()=>z,N4:()=>U,Nc:()=>o,OR:()=>_,RL:()=>P,VO:()=>H,YT:()=>u,Yy:()=>i,_8:()=>m,az:()=>J,c4:()=>X,f$:()=>l,fm:()=>h,mA:()=>d,nR:()=>w,ni:()=>y,qB:()=>C,te:()=>Z});var a=D(706400),G=D(332290),N=D(395726),W=D(875830),x=D(651577);const b=G.v9.Black(),n={NUM_MORPH_INFLUENCERS:0};function e(t,K,D){if(!t||t["LOGARITHMICDEPTH"]||t.indexOf&&t.indexOf("LOGARITHMICDEPTH")>=0){const t=D.activeCamera;1===t.mode&&a.V.Error("Logarithmic depth is not compatible with orthographic cameras!",20),K.setFloat("logarithmicDepthConstant",2/(Math.log(t.maxZ+1)/Math.LN2))}}function i(t,K,D,a=!1){D&&t.fogEnabled&&(!K||K.applyFog)&&0!==t.fogMode&&(D.setFloat4("vFogInfos",t.fogMode,t.fogStart,t.fogEnd,t.fogDensity),a?(t.fogColor.toLinearSpaceToRef(b,t.getEngine().useExactSrgbConversions),D.setColor3("vFogColor",b)):D.setColor3("vFogColor",t.fogColor))}function z(t,K,D){n.NUM_MORPH_INFLUENCERS=D,I(t,K,n)}function I(t,K,D){const G=D["NUM_MORPH_INFLUENCERS"];if(G>0&&N.q.LastCreatedEngine){const W=N.q.LastCreatedEngine.getCaps().maxVertexAttribs,x=K.morphTargetManager;if(null==x?void 0:x.isUsingTextureForTargets)return;const b=x&&x.supportsNormals&&D["NORMAL"],n=x&&x.supportsTangents&&D["TANGENT"],e=x&&x.supportsUVs&&D["UV1"];for(let D=0;D<G;D++)t.push(`position`+D),b&&t.push(`normal`+D),n&&t.push(`tangent`+D),e&&t.push(`uv`+"_"+D),t.length>W&&a.V.Error("Cannot add more vertex attributes for mesh "+K.name)}}function Z(t,K=!1){t.push("world0"),t.push("world1"),t.push("world2"),t.push("world3"),K&&(t.push("previousWorld0"),t.push("previousWorld1"),t.push("previousWorld2"),t.push("previousWorld3"))}function w(t,K){const D=t.morphTargetManager;t&&D&&K.setFloatArray("morphTargetInfluences",D.influences)}function m(t,K){K.bindToEffect(t,"Scene")}function u(t,K,D){K._needUVs=!0,K[D]=!0,t.optimizeUVAllocation&&t.getTextureMatrix().isIdentityAs3x2()?(K[D+"DIRECTUV"]=t.coordinatesIndex+1,K["MAINUV"+(t.coordinatesIndex+1)]=!0):K[D+"DIRECTUV"]=0}function d(t,K,D){const a=t.getTextureMatrix();K.updateMatrix(D+"Matrix",a)}function E(t,K,D){D["BAKED_VERTEX_ANIMATION_TEXTURE"]&&D["INSTANCES"]&&t.push("bakedVertexAnimationSettingsInstanced")}function l(t,K,D){var a;if(K&&t&&(t.computeBonesUsingShaders&&K._bonesComputationForcedToCPU&&(t.computeBonesUsingShaders=!1),t.useBones&&t.computeBonesUsingShaders&&t.skeleton)){const G=t.skeleton;if(G.isUsingTextureForMatrices&&K.getUniformIndex("boneTextureWidth")>-1){const D=G.getTransformMatrixTexture(t);K.setTexture("boneSampler",D),K.setFloat("boneTextureWidth",4*(G.bones.length+1))}else{const N=G.getTransformMatrices(t);N&&(K.setMatrices("mBones",N),D&&t.getScene().prePassRenderer&&t.getScene().prePassRenderer.getIndex(2)&&(D.previousBones[t.uniqueId]||(D.previousBones[t.uniqueId]=N.slice()),K.setMatrices("mPreviousBones",D.previousBones[t.uniqueId]),a=N,D.previousBones[t.uniqueId].set(a)))}}}function Q(t,K,D,a,G,N=!0){t._bindLight(K,D,a,G,N)}function P(t,K,D,a,G=4){const N=Math.min(K.lightSources.length,G);for(let G=0;G<N;G++)Q(K.lightSources[G],G,t,D,"boolean"==typeof a?a:a["SPECULARTERM"],K.receiveShadows)}function y(t,K,D,a){D["NUM_BONE_INFLUENCERS"]>0&&(a.addCPUSkinningFallback(0,K),t.push(`matricesIndices`),t.push(`matricesWeights`),D["NUM_BONE_INFLUENCERS"]>4&&(t.push(`matricesIndicesExtra`),t.push(`matricesWeightsExtra`)))}function q(t,K){(K["INSTANCES"]||K["THIN_INSTANCES"])&&Z(t,!!K["PREPASS_VELOCITY"]),K.INSTANCESCOLOR&&t.push(`instanceColor`)}function X(t,K,D=4,a=0){let G=0;for(let N=0;N<D&&t["LIGHT"+N];N++)N>0&&(G=a+N,K.addFallback(G,"LIGHT"+N)),t["SHADOWS"]||(t["SHADOW"+N]&&K.addFallback(a,"SHADOW"+N),t["SHADOWPCF"+N]&&K.addFallback(a,"SHADOWPCF"+N),t["SHADOWPCSS"+N]&&K.addFallback(a,"SHADOWPCSS"+N),t["SHADOWPOISSON"+N]&&K.addFallback(a,"SHADOWPOISSON"+N),t["SHADOWESM"+N]&&K.addFallback(a,"SHADOWESM"+N),t["SHADOWCLOSEESM"+N]&&K.addFallback(a,"SHADOWCLOSEESM"+N));return G++}function h(t,K,D,a,G,N,W,x=!1){W._areMiscDirty&&(W["LOGARITHMICDEPTH"]=D,W["POINTSIZE"]=a,W["FOG"]=G&&function(t,K){return K.fogEnabled&&t.applyFog&&0!==K.fogMode}(t,K),W["NONUNIFORMSCALING"]=t.nonUniformScaling,W["ALPHATEST"]=N,W["DECAL_AFTER_DETAIL"]=x)}function J(t,K,D,a,G=4,N=!1){if(!D._areLightsDirty)return D._needNormals;let W=0;const x={needNormals:D._needNormals,needRebuild:!1,lightmapMode:!1,shadowEnabled:!1,specularEnabled:!1};if(t.lightsEnabled&&!N)for(const N of K.lightSources)if(T(t,K,N,W,D,a,x),W++,W===G)break;D["SPECULARTERM"]=x.specularEnabled,D["SHADOWS"]=x.shadowEnabled;for(let t=W;t<G;t++)void 0!==D["LIGHT"+t]&&(D["LIGHT"+t]=!1,D["HEMILIGHT"+t]=!1,D["POINTLIGHT"+t]=!1,D["DIRLIGHT"+t]=!1,D["SPOTLIGHT"+t]=!1,D["SHADOW"+t]=!1,D["SHADOWCSM"+t]=!1,D["SHADOWCSMDEBUG"+t]=!1,D["SHADOWCSMNUM_CASCADES"+t]=!1,D["SHADOWCSMUSESHADOWMAXZ"+t]=!1,D["SHADOWCSMNOBLEND"+t]=!1,D["SHADOWCSM_RIGHTHANDED"+t]=!1,D["SHADOWPCF"+t]=!1,D["SHADOWPCSS"+t]=!1,D["SHADOWPOISSON"+t]=!1,D["SHADOWESM"+t]=!1,D["SHADOWCLOSEESM"+t]=!1,D["SHADOWCUBE"+t]=!1,D["SHADOWLOWQUALITY"+t]=!1,D["SHADOWMEDIUMQUALITY"+t]=!1);const b=t.getEngine().getCaps();return void 0===D["SHADOWFLOAT"]&&(x.needRebuild=!0),D["SHADOWFLOAT"]=x.shadowEnabled&&(b.textureFloatRender&&b.textureFloatLinearFiltering||b.textureHalfFloatRender&&b.textureHalfFloatLinearFiltering),D["LIGHTMAPEXCLUDED"]=x.lightmapMode,x.needRebuild&&D.rebuild(),x.needNormals}function T(t,K,D,a,G,N,x){var b;switch(x.needNormals=!0,void 0===G["LIGHT"+a]&&(x.needRebuild=!0),G["LIGHT"+a]=!0,G["SPOTLIGHT"+a]=!1,G["HEMILIGHT"+a]=!1,G["POINTLIGHT"+a]=!1,G["DIRLIGHT"+a]=!1,D.prepareLightSpecificDefines(G,a),G["LIGHT_FALLOFF_PHYSICAL"+a]=!1,G["LIGHT_FALLOFF_GLTF"+a]=!1,G["LIGHT_FALLOFF_STANDARD"+a]=!1,D.falloffType){case W.c.FALLOFF_GLTF:G["LIGHT_FALLOFF_GLTF"+a]=!0;break;case W.c.FALLOFF_PHYSICAL:G["LIGHT_FALLOFF_PHYSICAL"+a]=!0;break;case W.c.FALLOFF_STANDARD:G["LIGHT_FALLOFF_STANDARD"+a]=!0}if(N&&!D.specular.equalsFloats(0,0,0)&&(x.specularEnabled=!0),G["SHADOW"+a]=!1,G["SHADOWCSM"+a]=!1,G["SHADOWCSMDEBUG"+a]=!1,G["SHADOWCSMNUM_CASCADES"+a]=!1,G["SHADOWCSMUSESHADOWMAXZ"+a]=!1,G["SHADOWCSMNOBLEND"+a]=!1,G["SHADOWCSM_RIGHTHANDED"+a]=!1,G["SHADOWPCF"+a]=!1,G["SHADOWPCSS"+a]=!1,G["SHADOWPOISSON"+a]=!1,G["SHADOWESM"+a]=!1,G["SHADOWCLOSEESM"+a]=!1,G["SHADOWCUBE"+a]=!1,G["SHADOWLOWQUALITY"+a]=!1,G["SHADOWMEDIUMQUALITY"+a]=!1,K&&K.receiveShadows&&t.shadowsEnabled&&D.shadowEnabled){const K=null!==(b=D.getShadowGenerator(t.activeCamera))&&void 0!==b?b:D.getShadowGenerator();if(K){const t=K.getShadowMap();t&&t.renderList&&t.renderList.length>0&&(x.shadowEnabled=!0,K.prepareDefines(G,a))}}D.lightmapMode!=W.c.LIGHTMAP_DEFAULT?(x.lightmapMode=!0,G["LIGHTMAPEXCLUDED"+a]=!0,G["LIGHTMAPNOSPECULAR"+a]=D.lightmapMode==W.c.LIGHTMAP_SHADOWSONLY):(G["LIGHTMAPEXCLUDED"+a]=!1,G["LIGHTMAPNOSPECULAR"+a]=!1)}function _(t,K,D,a,G,N=null,W=!1){let b=function(t,K){let D=!1;if(t.activeCamera){const a=K["CAMERA_ORTHOGRAPHIC"]?1:0,G=K["CAMERA_PERSPECTIVE"]?1:0,N=1===t.activeCamera.mode?1:0,W=0===t.activeCamera.mode?1:0;(a^N||G^W)&&(K["CAMERA_ORTHOGRAPHIC"]=1===N,K["CAMERA_PERSPECTIVE"]=1===W,D=!0)}return D}(t,a);!1!==N&&(b=x.Eq(D,t,a)),a["DEPTHPREPASS"]!==!K.getColorWrite()&&(a["DEPTHPREPASS"]=!a["DEPTHPREPASS"],b=!0),a["INSTANCES"]!==G&&(a["INSTANCES"]=G,b=!0),a["THIN_INSTANCES"]!==W&&(a["THIN_INSTANCES"]=W,b=!0),b&&a.markAsUnprocessed()}function C(t,K,D,a,G=!1,N=!0,W=!0){if(!K._areAttributesDirty&&K._needNormals===K._normals&&K._needUVs===K._uvs)return!1;K._normals=K._needNormals,K._uvs=K._needUVs,K["NORMAL"]=K._needNormals&&t.isVerticesDataPresent(`normal`),K._needNormals&&t.isVerticesDataPresent(`tangent`)&&(K["TANGENT"]=!0);for(let D=1;D<=6;++D)K["UV"+D]=!!K._needUVs&&t.isVerticesDataPresent(`uv${1===D?"":D}`);if(D){const D=t.useVertexColors&&t.isVerticesDataPresent(`color`);K["VERTEXCOLOR"]=D,K["VERTEXALPHA"]=t.hasVertexAlpha&&D&&N}return t.isVerticesDataPresent(`instanceColor`)&&(t.hasInstances||t.hasThinInstances)&&(K["INSTANCESCOLOR"]=!0),a&&function(t,K){if(t.useBones&&t.computeBonesUsingShaders&&t.skeleton){K["NUM_BONE_INFLUENCERS"]=t.numBoneInfluencers;const D=void 0!==K["BONETEXTURE"];if(t.skeleton.isUsingTextureForMatrices&&D)K["BONETEXTURE"]=!0;else{K["BonesPerMesh"]=t.skeleton.bones.length+1,K["BONETEXTURE"]=!D&&void 0;const a=t.getScene().prePassRenderer;if(a&&a.enabled){const D=-1===a.excludedSkinnedMesh.indexOf(t);K["BONES_VELOCITY_ENABLED"]=D}}}else K["NUM_BONE_INFLUENCERS"]=0,K["BonesPerMesh"]=0,void 0!==K["BONETEXTURE"]&&(K["BONETEXTURE"]=!1)}(t,K),G&&function(t,K){const D=t.morphTargetManager;D?(K["MORPHTARGETS_UV"]=D.supportsUVs&&K["UV1"],K["MORPHTARGETS_TANGENT"]=D.supportsTangents&&K["TANGENT"],K["MORPHTARGETS_NORMAL"]=D.supportsNormals&&K["NORMAL"],K["NUM_MORPH_INFLUENCERS"]=D.numMaxInfluencers||D.numInfluencers,K["MORPHTARGETS"]=K["NUM_MORPH_INFLUENCERS"]>0,K["MORPHTARGETS_TEXTURE"]=D.isUsingTextureForTargets):(K["MORPHTARGETS_UV"]=!1,K["MORPHTARGETS_TANGENT"]=!1,K["MORPHTARGETS_NORMAL"]=!1,K["MORPHTARGETS"]=!1,K["NUM_MORPH_INFLUENCERS"]=0)}(t,K),W&&function(t,K){const D=t.bakedVertexAnimationManager;K["BAKED_VERTEX_ANIMATION_TEXTURE"]=!(!D||!D.isEnabled)}(t,K),!0}function H(t,K){if(t.activeCamera){const D=K.MULTIVIEW;K.MULTIVIEW=null!==t.activeCamera.outputRenderTarget&&t.activeCamera.outputRenderTarget.getViewCount()>1,K.MULTIVIEW!=D&&K.markAsUnprocessed()}}function o(t,K,D){const a=K.ORDER_INDEPENDENT_TRANSPARENCY,G=K.ORDER_INDEPENDENT_TRANSPARENCY_16BITS;K.ORDER_INDEPENDENT_TRANSPARENCY=t.useOrderIndependentTransparency&&D,K.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!t.getEngine().getCaps().textureFloatLinearFiltering,a===K.ORDER_INDEPENDENT_TRANSPARENCY&&G===K.ORDER_INDEPENDENT_TRANSPARENCY_16BITS||K.markAsUnprocessed()}function U(t,K,D){const a=K.PREPASS;if(!K._arePrePassDirty)return;const G=[{type:1,define:"PREPASS_POSITION",index:"PREPASS_POSITION_INDEX"},{type:9,define:"PREPASS_LOCAL_POSITION",index:"PREPASS_LOCAL_POSITION_INDEX"},{type:2,define:"PREPASS_VELOCITY",index:"PREPASS_VELOCITY_INDEX"},{type:11,define:"PREPASS_VELOCITY_LINEAR",index:"PREPASS_VELOCITY_LINEAR_INDEX"},{type:3,define:"PREPASS_REFLECTIVITY",index:"PREPASS_REFLECTIVITY_INDEX"},{type:0,define:"PREPASS_IRRADIANCE",index:"PREPASS_IRRADIANCE_INDEX"},{type:7,define:"PREPASS_ALBEDO_SQRT",index:"PREPASS_ALBEDO_SQRT_INDEX"},{type:5,define:"PREPASS_DEPTH",index:"PREPASS_DEPTH_INDEX"},{type:10,define:"PREPASS_NDC_DEPTH",index:"PREPASS_NDC_DEPTH_INDEX"},{type:6,define:"PREPASS_NORMAL",index:"PREPASS_NORMAL_INDEX"},{type:8,define:"PREPASS_WORLD_NORMAL",index:"PREPASS_WORLD_NORMAL_INDEX"}];if(t.prePassRenderer&&t.prePassRenderer.enabled&&D){K.PREPASS=!0,K.SCENE_MRT_COUNT=t.prePassRenderer.mrtCount,K.PREPASS_NORMAL_WORLDSPACE=t.prePassRenderer.generateNormalsInWorldSpace;for(let D=0;D<G.length;D++){const a=t.prePassRenderer.getIndex(G[D].type);-1!==a?(K[G[D].define]=!0,K[G[D].index]=a):K[G[D].define]=!1}}else{K.PREPASS=!1;for(let t=0;t<G.length;t++)K[G[t].define]=!1}K.PREPASS!=a&&(K.markAsUnprocessed(),K.markAsImageProcessingDirty())}function V(t,K,D,a,G=null,N=!1){G&&G.push("Light"+t),N||(K.push("vLightData"+t,"vLightDiffuse"+t,"vLightSpecular"+t,"vLightDirection"+t,"vLightFalloff"+t,"vLightGround"+t,"lightMatrix"+t,"shadowsInfo"+t,"depthValues"+t),D.push("shadowTexture"+t),D.push("depthTexture"+t),K.push("viewFrustumZ"+t,"cascadeBlendFactor"+t,"lightSizeUVCorrection"+t,"depthCorrection"+t,"penumbraDarkness"+t,"frustumLengths"+t),a&&(D.push("projectionLightTexture"+t),K.push("textureProjectionMatrix"+t)))}function s(t,K,D,a=4){let G,N=null;if(t.uniformsNames){const W=t;G=W.uniformsNames,N=W.uniformBuffersNames,K=W.samplers,D=W.defines,a=W.maxSimultaneousLights||0}else G=t,K||(K=[]);for(let t=0;t<a&&D["LIGHT"+t];t++)V(t,G,K,D["PROJECTEDLIGHTTEXTURE"+t],N);D["NUM_MORPH_INFLUENCERS"]&&(G.push("morphTargetInfluences"),G.push("morphTargetCount")),D["BAKED_VERTEX_ANIMATION_TEXTURE"]&&(G.push("bakedVertexAnimationSettings"),G.push("bakedVertexAnimationTextureSizeInverted"),G.push("bakedVertexAnimationTime"),K.push("bakedVertexAnimationTexture"))}},185537:(t,K,D)=>{D.d(K,{y:()=>b});var a=D(297809),G=D(760998),N=D(586365),W=D(337776),x=D(310035);class b{isCompatible(t){return 0===t}_enable(t){t&&this._pluginManager._activatePlugin(this)}constructor(t,K,D,a,G=!0,W=!1,x=!1){this.priority=500,this.resolveIncludes=!1,this.registerForExtraEvents=!1,this._material=t,this.name=K,this.priority=D,this.resolveIncludes=x,t.pluginManager||(t.pluginManager=new N.uZ(t),t.onDisposeObservable.add((()=>{t.pluginManager=void 0}))),this._pluginDefineNames=a,this._pluginManager=t.pluginManager,G&&this._pluginManager._addPlugin(this),W&&this._enable(!0),this.markAllDefinesAsDirty=t._dirtyCallbacks[63]}getClassName(){return"MaterialPluginBase"}isReadyForSubMesh(t,K,D,a){return!0}hardBindForSubMesh(t,K,D,a){}bindForSubMesh(t,K,D,a){}dispose(t){}getCustomCode(t,K=0){return null}collectDefines(t){if(this._pluginDefineNames)for(const K of Object.keys(this._pluginDefineNames)){if("_"===K[0])continue;const D=typeof this._pluginDefineNames[K];t[K]={type:"number"===D?"number":"string"===D?"string":"boolean"===D?"boolean":"object",default:this._pluginDefineNames[K]}}}prepareDefinesBeforeAttributes(t,K,D){}prepareDefines(t,K,D){}hasTexture(t){return!1}hasRenderTargetTextures(){return!1}fillRenderTargetTextures(t){}getActiveTextures(t){}getAnimatables(t){}addFallbacks(t,K,D){return D}getSamplers(t){}getAttributes(t,K,D){}getUniformBuffersNames(t){}getUniforms(t=0){return{}}copyTo(t){W.p.Clone((()=>t),this)}serialize(){return W.p.Serialize(this)}parse(t,K,D){W.p.Parse((()=>this),t,K,D)}}a.Cg([G.lK()],b.prototype,"name",void 0),a.Cg([G.lK()],b.prototype,"priority",void 0),a.Cg([G.lK()],b.prototype,"resolveIncludes",void 0),a.Cg([G.lK()],b.prototype,"registerForExtraEvents",void 0),x.Y5("BABYLON.MaterialPluginBase",b)},586365:(t,K,D)=>{D.d(K,{uZ:()=>b});var a=D(55973),G=D(395726),N=D(867967),W=D(395879);const x=new RegExp("^([gimus]+)!");class b{constructor(t){this._plugins=[],this._activePlugins=[],this._activePluginsForExtraEvents=[],this._material=t,this._scene=t.getScene(),this._engine=this._scene.getEngine()}_addPlugin(t){for(let K=0;K<this._plugins.length;++K)if(this._plugins[K].name===t.name)return!1;if(this._material._uniformBufferLayoutBuilt)throw`The plugin "${t.name}" can't be added to the material "${this._material.name}" because this material has already been used for rendering! Please add plugins to materials before any rendering with this material occurs.`;if(!t.isCompatible(this._material.shaderLanguage))throw`The plugin "${t.name}" can't be added to the material "${this._material.name}" because the plugin is not compatible with the shader language of the material.`;const K=t.getClassName();b._MaterialPluginClassToMainDefine[K]||(b._MaterialPluginClassToMainDefine[K]="MATERIALPLUGIN_"+ ++b._MaterialPluginCounter),this._material._callbackPluginEventGeneric=(t,K)=>this._handlePluginEvent(t,K),this._plugins.push(t),this._plugins.sort(((t,K)=>t.priority-K.priority)),this._codeInjectionPoints={};const D={};D[b._MaterialPluginClassToMainDefine[K]]={type:"boolean",default:!0};for(const t of this._plugins)t.collectDefines(D),this._collectPointNames("vertex",t.getCustomCode("vertex",this._material.shaderLanguage)),this._collectPointNames("fragment",t.getCustomCode("fragment",this._material.shaderLanguage));return this._defineNamesFromPlugins=D,!0}_activatePlugin(t){-1===this._activePlugins.indexOf(t)&&(this._activePlugins.push(t),this._activePlugins.sort(((t,K)=>t.priority-K.priority)),this._material._callbackPluginEventIsReadyForSubMesh=this._handlePluginEventIsReadyForSubMesh.bind(this),this._material._callbackPluginEventPrepareDefinesBeforeAttributes=this._handlePluginEventPrepareDefinesBeforeAttributes.bind(this),this._material._callbackPluginEventPrepareDefines=this._handlePluginEventPrepareDefines.bind(this),this._material._callbackPluginEventBindForSubMesh=this._handlePluginEventBindForSubMesh.bind(this),t.registerForExtraEvents&&(this._activePluginsForExtraEvents.push(t),this._activePluginsForExtraEvents.sort(((t,K)=>t.priority-K.priority)),this._material._callbackPluginEventHasRenderTargetTextures=this._handlePluginEventHasRenderTargetTextures.bind(this),this._material._callbackPluginEventFillRenderTargetTextures=this._handlePluginEventFillRenderTargetTextures.bind(this),this._material._callbackPluginEventHardBindForSubMesh=this._handlePluginEventHardBindForSubMesh.bind(this)))}getPlugin(t){for(let K=0;K<this._plugins.length;++K)if(this._plugins[K].name===t)return this._plugins[K];return null}_handlePluginEventIsReadyForSubMesh(t){let K=!0;for(const D of this._activePlugins)K=K&&D.isReadyForSubMesh(t.defines,this._scene,this._engine,t.subMesh);t.isReadyForSubMesh=K}_handlePluginEventPrepareDefinesBeforeAttributes(t){for(const K of this._activePlugins)K.prepareDefinesBeforeAttributes(t.defines,this._scene,t.mesh)}_handlePluginEventPrepareDefines(t){for(const K of this._activePlugins)K.prepareDefines(t.defines,this._scene,t.mesh)}_handlePluginEventHardBindForSubMesh(t){for(const K of this._activePluginsForExtraEvents)K.hardBindForSubMesh(this._material._uniformBuffer,this._scene,this._engine,t.subMesh)}_handlePluginEventBindForSubMesh(t){for(const K of this._activePlugins)K.bindForSubMesh(this._material._uniformBuffer,this._scene,this._engine,t.subMesh)}_handlePluginEventHasRenderTargetTextures(t){let K=!1;for(const t of this._activePluginsForExtraEvents)if(K=t.hasRenderTargetTextures(),K)break;t.hasRenderTargetTextures=K}_handlePluginEventFillRenderTargetTextures(t){for(const K of this._activePluginsForExtraEvents)K.fillRenderTargetTextures(t.renderTargets)}_handlePluginEvent(t,K){var D;switch(t){case 512:{const t=K;for(const K of this._activePlugins)K.getActiveTextures(t.activeTextures);break}case 256:{const t=K;for(const K of this._activePlugins)K.getAnimatables(t.animatables);break}case 1024:{const t=K;let D=!1;for(const K of this._activePlugins)if(D=K.hasTexture(t.texture),D)break;t.hasTexture=D;break}case 2:{const t=K;for(const K of this._plugins)K.dispose(t.forceDisposeTextures);break}case 4:K.defineNames=this._defineNamesFromPlugins;break;case 128:{const t=K;for(const K of this._activePlugins)t.fallbackRank=K.addFallbacks(t.defines,t.fallbacks,t.fallbackRank),K.getAttributes(t.attributes,this._scene,t.mesh);this._uniformList.length>0&&t.uniforms.push(...this._uniformList),this._samplerList.length>0&&t.samplers.push(...this._samplerList),this._uboList.length>0&&t.uniformBuffersNames.push(...this._uboList),t.customCode=this._injectCustomCode(t,t.customCode);break}case 8:{const t=K;this._uboDeclaration="",this._vertexDeclaration="",this._fragmentDeclaration="",this._uniformList=[],this._samplerList=[],this._uboList=[];const a=1===this._material.shaderLanguage;for(const K of this._plugins){const G=K.getUniforms(this._material.shaderLanguage);if(G){if(G.ubo)for(const K of G.ubo){if(K.size&&K.type){const G=null!==(D=K.arraySize)&&void 0!==D?D:0;if(t.ubo.addUniform(K.name,K.size,G),a){let t;switch(K.type){case"mat4":t="mat4x4f";break;case"float":t="f32";break;default:t=`${K.type}f`}this._uboDeclaration+=`uniform ${K.name}: ${t}${G>0?`[${G}]`:""};\n`}else this._uboDeclaration+=`${K.type} ${K.name}${G>0?`[${G}]`:""};\n`}this._uniformList.push(K.name)}G.vertex&&(this._vertexDeclaration+=G.vertex+"\n"),G.fragment&&(this._fragmentDeclaration+=G.fragment+"\n")}K.getSamplers(this._samplerList),K.getUniformBuffersNames(this._uboList)}break}}}_collectPointNames(t,K){if(K)for(const D in K)this._codeInjectionPoints[t]||(this._codeInjectionPoints[t]={}),this._codeInjectionPoints[t][D]=!0}_injectCustomCode(t,K){return(D,a)=>{var G,b;K&&(a=K(D,a)),this._uboDeclaration&&(a=a.replace("#define ADDITIONAL_UBO_DECLARATION",this._uboDeclaration)),this._vertexDeclaration&&(a=a.replace("#define ADDITIONAL_VERTEX_DECLARATION",this._vertexDeclaration)),this._fragmentDeclaration&&(a=a.replace("#define ADDITIONAL_FRAGMENT_DECLARATION",this._fragmentDeclaration));const n=null===(G=this._codeInjectionPoints)||void 0===G?void 0:G[D];if(!n)return a;let e=null;for(let K in n){let G="";for(const a of this._activePlugins){let x=null===(b=a.getCustomCode(D,this._material.shaderLanguage))||void 0===b?void 0:b[K];if(x){if(a.resolveIncludes){if(null===e){const K=0;e={defines:[],indexParameters:t.indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:void 0,supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:W.l.GetShadersRepository(K),includesShadersStore:W.l.GetIncludesShadersStore(K),version:void 0,platformName:this._engine.shaderPlatformName,processingContext:void 0,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:void 0}}e.isFragment="fragment"===D,N.Iq(x,e,(t=>x=t))}G+=x+"\n"}}if(G.length>0)if("!"===K.charAt(0)){K=K.substring(1);let t="g";if("!"===K.charAt(0))t="",K=K.substring(1);else{const D=x.exec(K);D&&D.length>=2&&(t=D[1],K=K.substring(t.length+1))}t.indexOf("g")<0&&(t+="g");const D=a,N=new RegExp(K,t);let W=N.exec(D);for(;null!==W;){let t=G;for(let K=0;K<W.length;++K)t=t.replace("$"+K,W[K]);a=a.replace(W[0],t),W=N.exec(D)}}else{const t="#define "+K;a=a.replace(t,"\n"+G+"\n"+t)}}return a}}}b._MaterialPluginClassToMainDefine={},b._MaterialPluginCounter=0,G.q.OnEnginesDisposedObservable.add((()=>{n.length=0,e=!1,a.i.OnEventObservable.remove(i),i=null}));const n=[];let e=!1,i=null},626956:(t,K,D)=>{D.d(K,{J:()=>a});class a{constructor(){this.previousWorldMatrices={},this.previousBones={}}static AddUniforms(t){t.push("previousWorld","previousViewProjection","mPreviousBones")}static AddSamplers(t){}bindForSubMesh(t,K,D,a,G){if(K.prePassRenderer&&K.prePassRenderer.enabled&&K.prePassRenderer.currentRTisSceneRT&&(-1!==K.prePassRenderer.getIndex(2)||-1!==K.prePassRenderer.getIndex(11))){this.previousWorldMatrices[D.uniqueId]||(this.previousWorldMatrices[D.uniqueId]=a.clone()),this.previousViewProjection||(this.previousViewProjection=K.getTransformMatrix().clone(),this.currentViewProjection=K.getTransformMatrix().clone());const G=K.getEngine();this.currentViewProjection.updateFlag!==K.getTransformMatrix().updateFlag?(this._lastUpdateFrameId=G.frameId,this.previousViewProjection.copyFrom(this.currentViewProjection),this.currentViewProjection.copyFrom(K.getTransformMatrix())):this._lastUpdateFrameId!==G.frameId&&(this._lastUpdateFrameId=G.frameId,this.previousViewProjection.copyFrom(this.currentViewProjection)),t.setMatrix("previousWorld",this.previousWorldMatrices[D.uniqueId]),t.setMatrix("previousViewProjection",this.previousViewProjection),this.previousWorldMatrices[D.uniqueId]=a.clone()}}}},235519:(t,K,D)=>{D.d(K,{E:()=>N});var a=D(604910),G=D(55973);class N extends G.i{constructor(t,K,D=!0){super(t,K),this._normalMatrix=new a.uq,this._storeEffectOnSubMeshes=D}getEffect(){return this._storeEffectOnSubMeshes?this._activeEffect:super.getEffect()}isReady(t,K){return!!t&&(!this._storeEffectOnSubMeshes||!t.subMeshes||0===t.subMeshes.length||this.isReadyForSubMesh(t,t.subMeshes[0],K))}_isReadyForSubMesh(t){const K=t.materialDefines;return!(this.checkReadyOnEveryCall||!t.effect||!K||K._renderId!==this.getScene().getRenderId())}bindOnlyWorldMatrix(t){this._activeEffect.setMatrix("world",t)}bindOnlyNormalMatrix(t){this._activeEffect.setMatrix("normalMatrix",t)}bind(t,K){K&&this.bindForSubMesh(t,K,K.subMeshes[0])}_afterBind(t,K=null,D){super._afterBind(t,K,D),this.getScene()._cachedEffect=K,D?D._drawWrapper._forceRebindOnNextCall=!1:this._drawWrapper._forceRebindOnNextCall=!1}_mustRebind(t,K,D,a=1){return D._drawWrapper._forceRebindOnNextCall||t.isCachedMaterialInvalid(this,K,a)}dispose(t,K,D){this._activeEffect=void 0,super.dispose(t,K,D)}}},32138:(t,K,D)=>{D.d(K,{F:()=>h});var a=D(297809),G=D(760998),N=D(293506),W=D(889460),x=D(604910),b=D(332290),n=D(23987),e=D(626956),i=D(239590),z=D(55973),I=D(527335),Z=D(235519),w=D(432050),m=D(310035),u=D(591160),d=D(522208),E=D(722736),l=D(651577),Q=D(855300),P=D(337776),y=D(384898);const q={effect:null,subMesh:null};class X extends I.M{constructor(t){super(t),this.MAINUV1=!1,this.MAINUV2=!1,this.MAINUV3=!1,this.MAINUV4=!1,this.MAINUV5=!1,this.MAINUV6=!1,this.DIFFUSE=!1,this.DIFFUSEDIRECTUV=0,this.BAKED_VERTEX_ANIMATION_TEXTURE=!1,this.AMBIENT=!1,this.AMBIENTDIRECTUV=0,this.OPACITY=!1,this.OPACITYDIRECTUV=0,this.OPACITYRGB=!1,this.REFLECTION=!1,this.EMISSIVE=!1,this.EMISSIVEDIRECTUV=0,this.SPECULAR=!1,this.SPECULARDIRECTUV=0,this.BUMP=!1,this.BUMPDIRECTUV=0,this.PARALLAX=!1,this.PARALLAX_RHS=!1,this.PARALLAXOCCLUSION=!1,this.SPECULAROVERALPHA=!1,this.CLIPPLANE=!1,this.CLIPPLANE2=!1,this.CLIPPLANE3=!1,this.CLIPPLANE4=!1,this.CLIPPLANE5=!1,this.CLIPPLANE6=!1,this.ALPHATEST=!1,this.DEPTHPREPASS=!1,this.ALPHAFROMDIFFUSE=!1,this.POINTSIZE=!1,this.FOG=!1,this.SPECULARTERM=!1,this.DIFFUSEFRESNEL=!1,this.OPACITYFRESNEL=!1,this.REFLECTIONFRESNEL=!1,this.REFRACTIONFRESNEL=!1,this.EMISSIVEFRESNEL=!1,this.FRESNEL=!1,this.NORMAL=!1,this.TANGENT=!1,this.UV1=!1,this.UV2=!1,this.UV3=!1,this.UV4=!1,this.UV5=!1,this.UV6=!1,this.VERTEXCOLOR=!1,this.VERTEXALPHA=!1,this.NUM_BONE_INFLUENCERS=0,this.BonesPerMesh=0,this.BONETEXTURE=!1,this.BONES_VELOCITY_ENABLED=!1,this.INSTANCES=!1,this.THIN_INSTANCES=!1,this.INSTANCESCOLOR=!1,this.GLOSSINESS=!1,this.ROUGHNESS=!1,this.EMISSIVEASILLUMINATION=!1,this.LINKEMISSIVEWITHDIFFUSE=!1,this.REFLECTIONFRESNELFROMSPECULAR=!1,this.LIGHTMAP=!1,this.LIGHTMAPDIRECTUV=0,this.OBJECTSPACE_NORMALMAP=!1,this.USELIGHTMAPASSHADOWMAP=!1,this.REFLECTIONMAP_3D=!1,this.REFLECTIONMAP_SPHERICAL=!1,this.REFLECTIONMAP_PLANAR=!1,this.REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFRACTIONMAP_CUBIC=!1,this.REFLECTIONMAP_PROJECTION=!1,this.REFLECTIONMAP_SKYBOX=!1,this.REFLECTIONMAP_EXPLICIT=!1,this.REFLECTIONMAP_EQUIRECTANGULAR=!1,this.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_OPPOSITEZ=!1,this.INVERTCUBICMAP=!1,this.LOGARITHMICDEPTH=!1,this.REFRACTION=!1,this.REFRACTIONMAP_3D=!1,this.REFLECTIONOVERALPHA=!1,this.TWOSIDEDLIGHTING=!1,this.SHADOWFLOAT=!1,this.MORPHTARGETS=!1,this.MORPHTARGETS_NORMAL=!1,this.MORPHTARGETS_TANGENT=!1,this.MORPHTARGETS_UV=!1,this.NUM_MORPH_INFLUENCERS=0,this.MORPHTARGETS_TEXTURE=!1,this.NONUNIFORMSCALING=!1,this.PREMULTIPLYALPHA=!1,this.ALPHATEST_AFTERALLALPHACOMPUTATIONS=!1,this.ALPHABLEND=!0,this.PREPASS=!1,this.PREPASS_IRRADIANCE=!1,this.PREPASS_IRRADIANCE_INDEX=-1,this.PREPASS_ALBEDO_SQRT=!1,this.PREPASS_ALBEDO_SQRT_INDEX=-1,this.PREPASS_DEPTH=!1,this.PREPASS_DEPTH_INDEX=-1,this.PREPASS_NDC_DEPTH=!1,this.PREPASS_NDC_DEPTH_INDEX=-1,this.PREPASS_NORMAL=!1,this.PREPASS_NORMAL_INDEX=-1,this.PREPASS_NORMAL_WORLDSPACE=!1,this.PREPASS_WORLD_NORMAL=!1,this.PREPASS_WORLD_NORMAL_INDEX=-1,this.PREPASS_POSITION=!1,this.PREPASS_POSITION_INDEX=-1,this.PREPASS_LOCAL_POSITION=!1,this.PREPASS_LOCAL_POSITION_INDEX=-1,this.PREPASS_VELOCITY=!1,this.PREPASS_VELOCITY_INDEX=-1,this.PREPASS_VELOCITY_LINEAR=!1,this.PREPASS_VELOCITY_LINEAR_INDEX=-1,this.PREPASS_REFLECTIVITY=!1,this.PREPASS_REFLECTIVITY_INDEX=-1,this.SCENE_MRT_COUNT=0,this.RGBDLIGHTMAP=!1,this.RGBDREFLECTION=!1,this.RGBDREFRACTION=!1,this.IMAGEPROCESSING=!1,this.VIGNETTE=!1,this.VIGNETTEBLENDMODEMULTIPLY=!1,this.VIGNETTEBLENDMODEOPAQUE=!1,this.TONEMAPPING=0,this.CONTRAST=!1,this.COLORCURVES=!1,this.COLORGRADING=!1,this.COLORGRADING3D=!1,this.SAMPLER3DGREENDEPTH=!1,this.SAMPLER3DBGRMAP=!1,this.DITHER=!1,this.IMAGEPROCESSINGPOSTPROCESS=!1,this.SKIPFINALCOLORCLAMP=!1,this.MULTIVIEW=!1,this.ORDER_INDEPENDENT_TRANSPARENCY=!1,this.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!1,this.CAMERA_ORTHOGRAPHIC=!1,this.CAMERA_PERSPECTIVE=!1,this.IS_REFLECTION_LINEAR=!1,this.IS_REFRACTION_LINEAR=!1,this.EXPOSURE=!1,this.DECAL_AFTER_DETAIL=!1,this.rebuild()}setReflectionMode(t){const K=["REFLECTIONMAP_CUBIC","REFLECTIONMAP_EXPLICIT","REFLECTIONMAP_PLANAR","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_SKYBOX","REFLECTIONMAP_SPHERICAL","REFLECTIONMAP_EQUIRECTANGULAR","REFLECTIONMAP_EQUIRECTANGULAR_FIXED","REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED"];for(const D of K)this[D]=D===t}}class h extends Z.E{get imageProcessingConfiguration(){return this._imageProcessingConfiguration}set imageProcessingConfiguration(t){this._attachImageProcessingConfiguration(t),this._markAllSubMeshesAsTexturesDirty()}_attachImageProcessingConfiguration(t){t!==this._imageProcessingConfiguration&&(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),this._imageProcessingConfiguration=t||this.getScene().imageProcessingConfiguration,this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add((()=>{this._markAllSubMeshesAsImageProcessingDirty()}))))}get isPrePassCapable(){return!this.disableDepthWrite}get cameraColorCurvesEnabled(){return this.imageProcessingConfiguration.colorCurvesEnabled}set cameraColorCurvesEnabled(t){this.imageProcessingConfiguration.colorCurvesEnabled=t}get cameraColorGradingEnabled(){return this.imageProcessingConfiguration.colorGradingEnabled}set cameraColorGradingEnabled(t){this.imageProcessingConfiguration.colorGradingEnabled=t}get cameraToneMappingEnabled(){return this._imageProcessingConfiguration.toneMappingEnabled}set cameraToneMappingEnabled(t){this._imageProcessingConfiguration.toneMappingEnabled=t}get cameraExposure(){return this._imageProcessingConfiguration.exposure}set cameraExposure(t){this._imageProcessingConfiguration.exposure=t}get cameraContrast(){return this._imageProcessingConfiguration.contrast}set cameraContrast(t){this._imageProcessingConfiguration.contrast=t}get cameraColorGradingTexture(){return this._imageProcessingConfiguration.colorGradingTexture}set cameraColorGradingTexture(t){this._imageProcessingConfiguration.colorGradingTexture=t}get cameraColorCurves(){return this._imageProcessingConfiguration.colorCurves}set cameraColorCurves(t){this._imageProcessingConfiguration.colorCurves=t}get canRenderToMRT(){return!0}constructor(t,K,D=!1){super(t,K),this._diffuseTexture=null,this._ambientTexture=null,this._opacityTexture=null,this._reflectionTexture=null,this._emissiveTexture=null,this._specularTexture=null,this._bumpTexture=null,this._lightmapTexture=null,this._refractionTexture=null,this.ambientColor=new b.v9(0,0,0),this.diffuseColor=new b.v9(1,1,1),this.specularColor=new b.v9(1,1,1),this.emissiveColor=new b.v9(0,0,0),this.specularPower=64,this._useAlphaFromDiffuseTexture=!1,this._useEmissiveAsIllumination=!1,this._linkEmissiveWithDiffuse=!1,this._useSpecularOverAlpha=!1,this._useReflectionOverAlpha=!1,this._disableLighting=!1,this._useObjectSpaceNormalMap=!1,this._useParallax=!1,this._useParallaxOcclusion=!1,this.parallaxScaleBias=.05,this._roughness=0,this.indexOfRefraction=.98,this.invertRefractionY=!0,this.alphaCutOff=.4,this._useLightmapAsShadowmap=!1,this._useReflectionFresnelFromSpecular=!1,this._useGlossinessFromSpecularMapAlpha=!1,this._maxSimultaneousLights=4,this._invertNormalMapX=!1,this._invertNormalMapY=!1,this._twoSidedLighting=!1,this._applyDecalMapAfterDetailMap=!1,this._shadersLoaded=!1,this._renderTargets=new N.L(16),this._worldViewProjectionMatrix=x.uq.Zero(),this._globalAmbientColor=new b.v9(0,0,0),this._cacheHasRenderTargetTextures=!1;const a=this.getScene().getEngine();!a.isWebGPU||D||h.ForceGLSL||(this._uniformBuffer&&this._uniformBuffer.dispose(),this._uniformBuffer=new y.D(a,void 0,void 0,this.name,!0),this._shaderLanguage=1),this.detailMap=new E.c(this),this._attachImageProcessingConfiguration(null),this.prePassConfiguration=new e.J,this.getRenderTargetTextures=()=>(this._renderTargets.reset(),h.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget&&this._renderTargets.push(this._reflectionTexture),h.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget&&this._renderTargets.push(this._refractionTexture),this._eventInfo.renderTargets=this._renderTargets,this._callbackPluginEventFillRenderTargetTextures(this._eventInfo),this._renderTargets)}get hasRenderTargetTextures(){return!!(h.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget)||!!(h.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget)||this._cacheHasRenderTargetTextures}getClassName(){return"StandardMaterial"}needAlphaBlending(){return!this._disableAlphaBlending&&(this.alpha<1||null!=this._opacityTexture||this._shouldUseAlphaFromDiffuseTexture()||this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled)}needAlphaTesting(){return!!this._forceAlphaTest||this._hasAlphaChannel()&&(null==this._transparencyMode||this._transparencyMode===z.i.MATERIAL_ALPHATEST)}_shouldUseAlphaFromDiffuseTexture(){return null!=this._diffuseTexture&&this._diffuseTexture.hasAlpha&&this._useAlphaFromDiffuseTexture&&this._transparencyMode!==z.i.MATERIAL_OPAQUE}_hasAlphaChannel(){return null!=this._diffuseTexture&&this._diffuseTexture.hasAlpha||null!=this._opacityTexture}getAlphaTestTexture(){return this._diffuseTexture}isReadyForSubMesh(t,K,a=!1){this._uniformBufferLayoutBuilt||this.buildUniformLayout();const G=K._drawWrapper;if(G.effect&&this.isFrozen&&G._wasPreviouslyReady&&G._wasPreviouslyUsingInstances===a)return!0;K.materialDefines||(this._callbackPluginEventGeneric(4,this._eventInfo),K.materialDefines=new X(this._eventInfo.defineNames));const N=this.getScene(),W=K.materialDefines;if(this._isReadyForSubMesh(K))return!0;const x=N.getEngine();W._needNormals=Q.az(N,t,W,!0,this._maxSimultaneousLights,this._disableLighting),Q.VO(N,W);const b=this.needAlphaBlendingForMesh(t)&&this.getScene().useOrderIndependentTransparency;if(Q.N4(N,W,this.canRenderToMRT&&!b),Q.Nc(N,W,b),W._areTexturesDirty){this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._cacheHasRenderTargetTextures=this._eventInfo.hasRenderTargetTextures,W._needUVs=!1;for(let t=1;t<=6;++t)W["MAINUV"+t]=!1;if(N.texturesEnabled){if(W.DIFFUSEDIRECTUV=0,W.BUMPDIRECTUV=0,W.AMBIENTDIRECTUV=0,W.OPACITYDIRECTUV=0,W.EMISSIVEDIRECTUV=0,W.SPECULARDIRECTUV=0,W.LIGHTMAPDIRECTUV=0,this._diffuseTexture&&h.DiffuseTextureEnabled){if(!this._diffuseTexture.isReadyOrNotBlocking())return!1;Q.YT(this._diffuseTexture,W,"DIFFUSE")}else W.DIFFUSE=!1;if(this._ambientTexture&&h.AmbientTextureEnabled){if(!this._ambientTexture.isReadyOrNotBlocking())return!1;Q.YT(this._ambientTexture,W,"AMBIENT")}else W.AMBIENT=!1;if(this._opacityTexture&&h.OpacityTextureEnabled){if(!this._opacityTexture.isReadyOrNotBlocking())return!1;Q.YT(this._opacityTexture,W,"OPACITY"),W.OPACITYRGB=this._opacityTexture.getAlphaFromRGB}else W.OPACITY=!1;if(this._reflectionTexture&&h.ReflectionTextureEnabled){if(!this._reflectionTexture.isReadyOrNotBlocking())return!1;switch(W._needNormals=!0,W.REFLECTION=!0,W.ROUGHNESS=this._roughness>0,W.REFLECTIONOVERALPHA=this._useReflectionOverAlpha,W.INVERTCUBICMAP=this._reflectionTexture.coordinatesMode===w.g.INVCUBIC_MODE,W.REFLECTIONMAP_3D=this._reflectionTexture.isCube,W.REFLECTIONMAP_OPPOSITEZ=W.REFLECTIONMAP_3D&&this.getScene().useRightHandedSystem?!this._reflectionTexture.invertZ:this._reflectionTexture.invertZ,W.RGBDREFLECTION=this._reflectionTexture.isRGBD,this._reflectionTexture.coordinatesMode){case w.g.EXPLICIT_MODE:W.setReflectionMode("REFLECTIONMAP_EXPLICIT");break;case w.g.PLANAR_MODE:W.setReflectionMode("REFLECTIONMAP_PLANAR");break;case w.g.PROJECTION_MODE:W.setReflectionMode("REFLECTIONMAP_PROJECTION");break;case w.g.SKYBOX_MODE:W.setReflectionMode("REFLECTIONMAP_SKYBOX");break;case w.g.SPHERICAL_MODE:W.setReflectionMode("REFLECTIONMAP_SPHERICAL");break;case w.g.EQUIRECTANGULAR_MODE:W.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR");break;case w.g.FIXED_EQUIRECTANGULAR_MODE:W.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR_FIXED");break;case w.g.FIXED_EQUIRECTANGULAR_MIRRORED_MODE:W.setReflectionMode("REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED");break;case w.g.CUBIC_MODE:case w.g.INVCUBIC_MODE:default:W.setReflectionMode("REFLECTIONMAP_CUBIC")}W.USE_LOCAL_REFLECTIONMAP_CUBIC=!!this._reflectionTexture.boundingBoxSize}else W.REFLECTION=!1,W.REFLECTIONMAP_OPPOSITEZ=!1;if(this._emissiveTexture&&h.EmissiveTextureEnabled){if(!this._emissiveTexture.isReadyOrNotBlocking())return!1;Q.YT(this._emissiveTexture,W,"EMISSIVE")}else W.EMISSIVE=!1;if(this._lightmapTexture&&h.LightmapTextureEnabled){if(!this._lightmapTexture.isReadyOrNotBlocking())return!1;Q.YT(this._lightmapTexture,W,"LIGHTMAP"),W.USELIGHTMAPASSHADOWMAP=this._useLightmapAsShadowmap,W.RGBDLIGHTMAP=this._lightmapTexture.isRGBD}else W.LIGHTMAP=!1;if(this._specularTexture&&h.SpecularTextureEnabled){if(!this._specularTexture.isReadyOrNotBlocking())return!1;Q.YT(this._specularTexture,W,"SPECULAR"),W.GLOSSINESS=this._useGlossinessFromSpecularMapAlpha}else W.SPECULAR=!1;if(N.getEngine().getCaps().standardDerivatives&&this._bumpTexture&&h.BumpTextureEnabled){if(!this._bumpTexture.isReady())return!1;Q.YT(this._bumpTexture,W,"BUMP"),W.PARALLAX=this._useParallax,W.PARALLAX_RHS=N.useRightHandedSystem,W.PARALLAXOCCLUSION=this._useParallaxOcclusion,W.OBJECTSPACE_NORMALMAP=this._useObjectSpaceNormalMap}else W.BUMP=!1,W.PARALLAX=!1,W.PARALLAX_RHS=!1,W.PARALLAXOCCLUSION=!1;if(this._refractionTexture&&h.RefractionTextureEnabled){if(!this._refractionTexture.isReadyOrNotBlocking())return!1;W._needUVs=!0,W.REFRACTION=!0,W.REFRACTIONMAP_3D=this._refractionTexture.isCube,W.RGBDREFRACTION=this._refractionTexture.isRGBD,W.USE_LOCAL_REFRACTIONMAP_CUBIC=!!this._refractionTexture.boundingBoxSize}else W.REFRACTION=!1;W.TWOSIDEDLIGHTING=!this._backFaceCulling&&this._twoSidedLighting}else W.DIFFUSE=!1,W.AMBIENT=!1,W.OPACITY=!1,W.REFLECTION=!1,W.EMISSIVE=!1,W.LIGHTMAP=!1,W.BUMP=!1,W.REFRACTION=!1;W.ALPHAFROMDIFFUSE=this._shouldUseAlphaFromDiffuseTexture(),W.EMISSIVEASILLUMINATION=this._useEmissiveAsIllumination,W.LINKEMISSIVEWITHDIFFUSE=this._linkEmissiveWithDiffuse,W.SPECULAROVERALPHA=this._useSpecularOverAlpha,W.PREMULTIPLYALPHA=7===this.alphaMode||8===this.alphaMode,W.ALPHATEST_AFTERALLALPHACOMPUTATIONS=null!==this.transparencyMode,W.ALPHABLEND=null===this.transparencyMode||this.needAlphaBlendingForMesh(t)}if(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=W,this._eventInfo.subMesh=K,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),!this._eventInfo.isReadyForSubMesh)return!1;if(W._areImageProcessingDirty&&this._imageProcessingConfiguration){if(!this._imageProcessingConfiguration.isReady())return!1;this._imageProcessingConfiguration.prepareDefines(W),W.IS_REFLECTION_LINEAR=null!=this.reflectionTexture&&!this.reflectionTexture.gammaSpace,W.IS_REFRACTION_LINEAR=null!=this.refractionTexture&&!this.refractionTexture.gammaSpace}W._areFresnelDirty&&(h.FresnelEnabled?(this._diffuseFresnelParameters||this._opacityFresnelParameters||this._emissiveFresnelParameters||this._refractionFresnelParameters||this._reflectionFresnelParameters)&&(W.DIFFUSEFRESNEL=this._diffuseFresnelParameters&&this._diffuseFresnelParameters.isEnabled,W.OPACITYFRESNEL=this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled,W.REFLECTIONFRESNEL=this._reflectionFresnelParameters&&this._reflectionFresnelParameters.isEnabled,W.REFLECTIONFRESNELFROMSPECULAR=this._useReflectionFresnelFromSpecular,W.REFRACTIONFRESNEL=this._refractionFresnelParameters&&this._refractionFresnelParameters.isEnabled,W.EMISSIVEFRESNEL=this._emissiveFresnelParameters&&this._emissiveFresnelParameters.isEnabled,W._needNormals=!0,W.FRESNEL=!0):W.FRESNEL=!1),Q.fm(t,N,this._useLogarithmicDepth,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(t)||this._forceAlphaTest,W,this._applyDecalMapAfterDetailMap),Q.OR(N,x,this,W,a,null,K.getRenderingMesh().hasThinInstances),this._eventInfo.defines=W,this._eventInfo.mesh=t,this._callbackPluginEventPrepareDefinesBeforeAttributes(this._eventInfo),Q.qB(t,W,!0,!0,!0),this._callbackPluginEventPrepareDefines(this._eventInfo);let z=!1;if(W.isDirty){const a=W._areLightsDisposed;W.markAsProcessed();const G=new d.J;W.REFLECTION&&G.addFallback(0,"REFLECTION"),W.SPECULAR&&G.addFallback(0,"SPECULAR"),W.BUMP&&G.addFallback(0,"BUMP"),W.PARALLAX&&G.addFallback(1,"PARALLAX"),W.PARALLAX_RHS&&G.addFallback(1,"PARALLAX_RHS"),W.PARALLAXOCCLUSION&&G.addFallback(0,"PARALLAXOCCLUSION"),W.SPECULAROVERALPHA&&G.addFallback(0,"SPECULAROVERALPHA"),W.FOG&&G.addFallback(1,"FOG"),W.POINTSIZE&&G.addFallback(0,"POINTSIZE"),W.LOGARITHMICDEPTH&&G.addFallback(0,"LOGARITHMICDEPTH"),Q.c4(W,G,this._maxSimultaneousLights),W.SPECULARTERM&&G.addFallback(0,"SPECULARTERM"),W.DIFFUSEFRESNEL&&G.addFallback(1,"DIFFUSEFRESNEL"),W.OPACITYFRESNEL&&G.addFallback(2,"OPACITYFRESNEL"),W.REFLECTIONFRESNEL&&G.addFallback(3,"REFLECTIONFRESNEL"),W.EMISSIVEFRESNEL&&G.addFallback(4,"EMISSIVEFRESNEL"),W.FRESNEL&&G.addFallback(4,"FRESNEL"),W.MULTIVIEW&&G.addFallback(0,"MULTIVIEW");const b=[n.R.PositionKind];W.NORMAL&&b.push(n.R.NormalKind),W.TANGENT&&b.push(n.R.TangentKind);for(let t=1;t<=6;++t)W["UV"+t]&&b.push(`uv${1===t?"":t}`);W.VERTEXCOLOR&&b.push(n.R.ColorKind),Q.ni(b,t,W,G),Q.ER(b,W),Q.IF(b,t,W),Q.J2(b,t,W);let I="default";const Z=["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vDiffuseColor","vSpecularColor","vEmissiveColor","visibility","vFogInfos","vFogColor","pointSize","vDiffuseInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vEmissiveInfos","vSpecularInfos","vBumpInfos","vLightmapInfos","vRefractionInfos","mBones","diffuseMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","specularMatrix","bumpMatrix","normalMatrix","lightmapMatrix","refractionMatrix","diffuseLeftColor","diffuseRightColor","opacityParts","reflectionLeftColor","reflectionRightColor","emissiveLeftColor","emissiveRightColor","refractionLeftColor","refractionRightColor","vReflectionPosition","vReflectionSize","vRefractionPosition","vRefractionSize","logarithmicDepthConstant","vTangentSpaceParams","alphaCutOff","boneTextureWidth","morphTargetTextureInfo","morphTargetTextureIndices"],w=["diffuseSampler","ambientSampler","opacitySampler","reflectionCubeSampler","reflection2DSampler","emissiveSampler","specularSampler","bumpSampler","lightmapSampler","refractionCubeSampler","refraction2DSampler","boneSampler","morphTargets","oitDepthSampler","oitFrontColorSampler"],m=["Material","Scene","Mesh"],u={maxSimultaneousLights:this._maxSimultaneousLights,maxSimultaneousMorphTargets:W.NUM_MORPH_INFLUENCERS};this._eventInfo.fallbacks=G,this._eventInfo.fallbackRank=0,this._eventInfo.defines=W,this._eventInfo.uniforms=Z,this._eventInfo.attributes=b,this._eventInfo.samplers=w,this._eventInfo.uniformBuffersNames=m,this._eventInfo.customCode=void 0,this._eventInfo.mesh=t,this._eventInfo.indexParameters=u,this._callbackPluginEventGeneric(128,this._eventInfo),e.J.AddUniforms(Z),e.J.AddSamplers(w),i.p&&(i.p.PrepareUniforms(Z,W),i.p.PrepareSamplers(w,W)),Q.Bb({uniformsNames:Z,uniformBuffersNames:m,samplers:w,defines:W,maxSimultaneousLights:this._maxSimultaneousLights}),l.TV(Z);const E={};this.customShaderNameResolve&&(I=this.customShaderNameResolve(I,Z,m,w,W,b,E));const P=W.toString(),y=K.effect;let X=N.getEngine().createEffect(I,{attributes:b,uniformsNames:Z,uniformBuffersNames:m,samplers:w,defines:P,fallbacks:G,onCompiled:this.onCompiled,onError:this.onError,indexParameters:u,processFinalCode:E.processFinalCode,processCodeAfterIncludes:this._eventInfo.customCode,multiTarget:W.PREPASS,shaderLanguage:this._shaderLanguage,extraInitializationsAsync:this._shadersLoaded?void 0:async()=>{1===this._shaderLanguage?await Promise.all([D.e(10228).then(D.bind(D,410228)),D.e(11300).then(D.bind(D,211300))]):await Promise.all([D.e(10036).then(D.bind(D,310036)),D.e(53566).then(D.bind(D,53566))]),this._shadersLoaded=!0}},x);if(this._eventInfo.customCode=void 0,X)if(this._onEffectCreatedObservable&&(q.effect=X,q.subMesh=K,this._onEffectCreatedObservable.notifyObservers(q)),this.allowShaderHotSwapping&&y&&!X.isReady()){if(X=y,W.markAsUnprocessed(),z=this.isFrozen,a)return W._areLightsDisposed=!0,!1}else N.resetCachedMaterial(),K.setEffect(X,W,this._materialContext)}return!(!K.effect||!K.effect.isReady()||(W._renderId=N.getRenderId(),G._wasPreviouslyReady=!z,G._wasPreviouslyUsingInstances=a,this._checkScenePerformancePriority(),0))}buildUniformLayout(){const t=this._uniformBuffer;t.addUniform("diffuseLeftColor",4),t.addUniform("diffuseRightColor",4),t.addUniform("opacityParts",4),t.addUniform("reflectionLeftColor",4),t.addUniform("reflectionRightColor",4),t.addUniform("refractionLeftColor",4),t.addUniform("refractionRightColor",4),t.addUniform("emissiveLeftColor",4),t.addUniform("emissiveRightColor",4),t.addUniform("vDiffuseInfos",2),t.addUniform("vAmbientInfos",2),t.addUniform("vOpacityInfos",2),t.addUniform("vReflectionInfos",2),t.addUniform("vReflectionPosition",3),t.addUniform("vReflectionSize",3),t.addUniform("vEmissiveInfos",2),t.addUniform("vLightmapInfos",2),t.addUniform("vSpecularInfos",2),t.addUniform("vBumpInfos",3),t.addUniform("diffuseMatrix",16),t.addUniform("ambientMatrix",16),t.addUniform("opacityMatrix",16),t.addUniform("reflectionMatrix",16),t.addUniform("emissiveMatrix",16),t.addUniform("lightmapMatrix",16),t.addUniform("specularMatrix",16),t.addUniform("bumpMatrix",16),t.addUniform("vTangentSpaceParams",2),t.addUniform("pointSize",1),t.addUniform("alphaCutOff",1),t.addUniform("refractionMatrix",16),t.addUniform("vRefractionInfos",4),t.addUniform("vRefractionPosition",3),t.addUniform("vRefractionSize",3),t.addUniform("vSpecularColor",4),t.addUniform("vEmissiveColor",3),t.addUniform("vDiffuseColor",4),t.addUniform("vAmbientColor",3),super.buildUniformLayout()}bindForSubMesh(t,K,D){var a;const G=this.getScene(),N=D.materialDefines;if(!N)return;const x=D.effect;if(!x)return;this._activeEffect=x,K.getMeshUniformBuffer().bindToEffect(x,"Mesh"),K.transferToEffect(t),this._uniformBuffer.bindToEffect(x,"Material"),this.prePassConfiguration.bindForSubMesh(this._activeEffect,G,K,t,this.isFrozen),this._eventInfo.subMesh=D,this._callbackPluginEventHardBindForSubMesh(this._eventInfo),N.OBJECTSPACE_NORMALMAP&&(t.toNormalMatrix(this._normalMatrix),this.bindOnlyNormalMatrix(this._normalMatrix));const n=this._mustRebind(G,x,D,K.visibility);Q.f$(K,x);const e=this._uniformBuffer;if(n){if(this.bindViewProjection(x),!e.useUbo||!this.isFrozen||!e.isSync||D._drawWrapper._forceRebindOnNextCall){if(h.FresnelEnabled&&N.FRESNEL&&(this.diffuseFresnelParameters&&this.diffuseFresnelParameters.isEnabled&&(e.updateColor4("diffuseLeftColor",this.diffuseFresnelParameters.leftColor,this.diffuseFresnelParameters.power),e.updateColor4("diffuseRightColor",this.diffuseFresnelParameters.rightColor,this.diffuseFresnelParameters.bias)),this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled&&e.updateColor4("opacityParts",new b.v9(this.opacityFresnelParameters.leftColor.toLuminance(),this.opacityFresnelParameters.rightColor.toLuminance(),this.opacityFresnelParameters.bias),this.opacityFresnelParameters.power),this.reflectionFresnelParameters&&this.reflectionFresnelParameters.isEnabled&&(e.updateColor4("reflectionLeftColor",this.reflectionFresnelParameters.leftColor,this.reflectionFresnelParameters.power),e.updateColor4("reflectionRightColor",this.reflectionFresnelParameters.rightColor,this.reflectionFresnelParameters.bias)),this.refractionFresnelParameters&&this.refractionFresnelParameters.isEnabled&&(e.updateColor4("refractionLeftColor",this.refractionFresnelParameters.leftColor,this.refractionFresnelParameters.power),e.updateColor4("refractionRightColor",this.refractionFresnelParameters.rightColor,this.refractionFresnelParameters.bias)),this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled&&(e.updateColor4("emissiveLeftColor",this.emissiveFresnelParameters.leftColor,this.emissiveFresnelParameters.power),e.updateColor4("emissiveRightColor",this.emissiveFresnelParameters.rightColor,this.emissiveFresnelParameters.bias))),G.texturesEnabled){if(this._diffuseTexture&&h.DiffuseTextureEnabled&&(e.updateFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,this._diffuseTexture.level),Q.mA(this._diffuseTexture,e,"diffuse")),this._ambientTexture&&h.AmbientTextureEnabled&&(e.updateFloat2("vAmbientInfos",this._ambientTexture.coordinatesIndex,this._ambientTexture.level),Q.mA(this._ambientTexture,e,"ambient")),this._opacityTexture&&h.OpacityTextureEnabled&&(e.updateFloat2("vOpacityInfos",this._opacityTexture.coordinatesIndex,this._opacityTexture.level),Q.mA(this._opacityTexture,e,"opacity")),this._hasAlphaChannel()&&e.updateFloat("alphaCutOff",this.alphaCutOff),this._reflectionTexture&&h.ReflectionTextureEnabled&&(e.updateFloat2("vReflectionInfos",this._reflectionTexture.level,this.roughness),e.updateMatrix("reflectionMatrix",this._reflectionTexture.getReflectionTextureMatrix()),this._reflectionTexture.boundingBoxSize)){const t=this._reflectionTexture;e.updateVector3("vReflectionPosition",t.boundingBoxPosition),e.updateVector3("vReflectionSize",t.boundingBoxSize)}if(this._emissiveTexture&&h.EmissiveTextureEnabled&&(e.updateFloat2("vEmissiveInfos",this._emissiveTexture.coordinatesIndex,this._emissiveTexture.level),Q.mA(this._emissiveTexture,e,"emissive")),this._lightmapTexture&&h.LightmapTextureEnabled&&(e.updateFloat2("vLightmapInfos",this._lightmapTexture.coordinatesIndex,this._lightmapTexture.level),Q.mA(this._lightmapTexture,e,"lightmap")),this._specularTexture&&h.SpecularTextureEnabled&&(e.updateFloat2("vSpecularInfos",this._specularTexture.coordinatesIndex,this._specularTexture.level),Q.mA(this._specularTexture,e,"specular")),this._bumpTexture&&G.getEngine().getCaps().standardDerivatives&&h.BumpTextureEnabled&&(e.updateFloat3("vBumpInfos",this._bumpTexture.coordinatesIndex,1/this._bumpTexture.level,this.parallaxScaleBias),Q.mA(this._bumpTexture,e,"bump"),G._mirroredCameraPosition?e.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?1:-1,this._invertNormalMapY?1:-1):e.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?-1:1,this._invertNormalMapY?-1:1)),this._refractionTexture&&h.RefractionTextureEnabled){let t=1;if(this._refractionTexture.isCube||(e.updateMatrix("refractionMatrix",this._refractionTexture.getReflectionTextureMatrix()),this._refractionTexture.depth&&(t=this._refractionTexture.depth)),e.updateFloat4("vRefractionInfos",this._refractionTexture.level,this.indexOfRefraction,t,this.invertRefractionY?-1:1),this._refractionTexture.boundingBoxSize){const t=this._refractionTexture;e.updateVector3("vRefractionPosition",t.boundingBoxPosition),e.updateVector3("vRefractionSize",t.boundingBoxSize)}}}this.pointsCloud&&e.updateFloat("pointSize",this.pointSize),N.SPECULARTERM&&e.updateColor4("vSpecularColor",this.specularColor,this.specularPower),e.updateColor3("vEmissiveColor",h.EmissiveTextureEnabled?this.emissiveColor:b.v9.BlackReadOnly),e.updateColor4("vDiffuseColor",this.diffuseColor,this.alpha),G.ambientColor.multiplyToRef(this.ambientColor,this._globalAmbientColor),e.updateColor3("vAmbientColor",this._globalAmbientColor)}G.texturesEnabled&&(this._diffuseTexture&&h.DiffuseTextureEnabled&&x.setTexture("diffuseSampler",this._diffuseTexture),this._ambientTexture&&h.AmbientTextureEnabled&&x.setTexture("ambientSampler",this._ambientTexture),this._opacityTexture&&h.OpacityTextureEnabled&&x.setTexture("opacitySampler",this._opacityTexture),this._reflectionTexture&&h.ReflectionTextureEnabled&&(this._reflectionTexture.isCube?x.setTexture("reflectionCubeSampler",this._reflectionTexture):x.setTexture("reflection2DSampler",this._reflectionTexture)),this._emissiveTexture&&h.EmissiveTextureEnabled&&x.setTexture("emissiveSampler",this._emissiveTexture),this._lightmapTexture&&h.LightmapTextureEnabled&&x.setTexture("lightmapSampler",this._lightmapTexture),this._specularTexture&&h.SpecularTextureEnabled&&x.setTexture("specularSampler",this._specularTexture),this._bumpTexture&&G.getEngine().getCaps().standardDerivatives&&h.BumpTextureEnabled&&x.setTexture("bumpSampler",this._bumpTexture),this._refractionTexture&&h.RefractionTextureEnabled&&(this._refractionTexture.isCube?x.setTexture("refractionCubeSampler",this._refractionTexture):x.setTexture("refraction2DSampler",this._refractionTexture))),this.getScene().useOrderIndependentTransparency&&this.needAlphaBlendingForMesh(K)&&this.getScene().depthPeelingRenderer.bind(x),this._eventInfo.subMesh=D,this._callbackPluginEventBindForSubMesh(this._eventInfo),l.gS(x,this,G),this.bindEyePosition(x)}else G.getEngine()._features.needToAlwaysBindUniformBuffers&&(this._needToBindSceneUbo=!0);!n&&this.isFrozen||(G.lightsEnabled&&!this._disableLighting&&Q.RL(G,K,x,N,this._maxSimultaneousLights),(G.fogEnabled&&K.applyFog&&G.fogMode!==W.Z.FOGMODE_NONE||this._reflectionTexture||this._refractionTexture||K.receiveShadows||N.PREPASS)&&this.bindView(x),Q.Yy(G,K,x),N.NUM_MORPH_INFLUENCERS&&Q.nR(K,x),N.BAKED_VERTEX_ANIMATION_TEXTURE&&(null===(a=K.bakedVertexAnimationManager)||void 0===a||a.bind(x,N.INSTANCES)),this.useLogarithmicDepth&&Q.DL(N,x,G),this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.applyByPostProcess&&this._imageProcessingConfiguration.bind(this._activeEffect)),this._afterBind(K,this._activeEffect,D),e.update()}getAnimatables(){const t=super.getAnimatables();return this._diffuseTexture&&this._diffuseTexture.animations&&this._diffuseTexture.animations.length>0&&t.push(this._diffuseTexture),this._ambientTexture&&this._ambientTexture.animations&&this._ambientTexture.animations.length>0&&t.push(this._ambientTexture),this._opacityTexture&&this._opacityTexture.animations&&this._opacityTexture.animations.length>0&&t.push(this._opacityTexture),this._reflectionTexture&&this._reflectionTexture.animations&&this._reflectionTexture.animations.length>0&&t.push(this._reflectionTexture),this._emissiveTexture&&this._emissiveTexture.animations&&this._emissiveTexture.animations.length>0&&t.push(this._emissiveTexture),this._specularTexture&&this._specularTexture.animations&&this._specularTexture.animations.length>0&&t.push(this._specularTexture),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&t.push(this._bumpTexture),this._lightmapTexture&&this._lightmapTexture.animations&&this._lightmapTexture.animations.length>0&&t.push(this._lightmapTexture),this._refractionTexture&&this._refractionTexture.animations&&this._refractionTexture.animations.length>0&&t.push(this._refractionTexture),t}getActiveTextures(){const t=super.getActiveTextures();return this._diffuseTexture&&t.push(this._diffuseTexture),this._ambientTexture&&t.push(this._ambientTexture),this._opacityTexture&&t.push(this._opacityTexture),this._reflectionTexture&&t.push(this._reflectionTexture),this._emissiveTexture&&t.push(this._emissiveTexture),this._specularTexture&&t.push(this._specularTexture),this._bumpTexture&&t.push(this._bumpTexture),this._lightmapTexture&&t.push(this._lightmapTexture),this._refractionTexture&&t.push(this._refractionTexture),t}hasTexture(t){return!!super.hasTexture(t)||this._diffuseTexture===t||this._ambientTexture===t||this._opacityTexture===t||this._reflectionTexture===t||this._emissiveTexture===t||this._specularTexture===t||this._bumpTexture===t||this._lightmapTexture===t||this._refractionTexture===t}dispose(t,K){var D,a,G,N,W,x,b,n,e;K&&(null===(D=this._diffuseTexture)||void 0===D||D.dispose(),null===(a=this._ambientTexture)||void 0===a||a.dispose(),null===(G=this._opacityTexture)||void 0===G||G.dispose(),null===(N=this._reflectionTexture)||void 0===N||N.dispose(),null===(W=this._emissiveTexture)||void 0===W||W.dispose(),null===(x=this._specularTexture)||void 0===x||x.dispose(),null===(b=this._bumpTexture)||void 0===b||b.dispose(),null===(n=this._lightmapTexture)||void 0===n||n.dispose(),null===(e=this._refractionTexture)||void 0===e||e.dispose()),this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),super.dispose(t,K)}clone(t,K=!0,D=""){const a=P.p.Clone((()=>new h(t,this.getScene())),this,{cloneTexturesOnlyOnce:K});return a.name=t,a.id=t,this.stencil.copyTo(a.stencil),this._clonePlugins(a,D),a}static Parse(t,K,D){const a=P.p.Parse((()=>new h(t.name,K)),t,K,D);return t.stencil&&a.stencil.parse(t.stencil,K,D),z.i._ParsePlugins(t,a,K,D),a}static get DiffuseTextureEnabled(){return u.h.DiffuseTextureEnabled}static set DiffuseTextureEnabled(t){u.h.DiffuseTextureEnabled=t}static get DetailTextureEnabled(){return u.h.DetailTextureEnabled}static set DetailTextureEnabled(t){u.h.DetailTextureEnabled=t}static get AmbientTextureEnabled(){return u.h.AmbientTextureEnabled}static set AmbientTextureEnabled(t){u.h.AmbientTextureEnabled=t}static get OpacityTextureEnabled(){return u.h.OpacityTextureEnabled}static set OpacityTextureEnabled(t){u.h.OpacityTextureEnabled=t}static get ReflectionTextureEnabled(){return u.h.ReflectionTextureEnabled}static set ReflectionTextureEnabled(t){u.h.ReflectionTextureEnabled=t}static get EmissiveTextureEnabled(){return u.h.EmissiveTextureEnabled}static set EmissiveTextureEnabled(t){u.h.EmissiveTextureEnabled=t}static get SpecularTextureEnabled(){return u.h.SpecularTextureEnabled}static set SpecularTextureEnabled(t){u.h.SpecularTextureEnabled=t}static get BumpTextureEnabled(){return u.h.BumpTextureEnabled}static set BumpTextureEnabled(t){u.h.BumpTextureEnabled=t}static get LightmapTextureEnabled(){return u.h.LightmapTextureEnabled}static set LightmapTextureEnabled(t){u.h.LightmapTextureEnabled=t}static get RefractionTextureEnabled(){return u.h.RefractionTextureEnabled}static set RefractionTextureEnabled(t){u.h.RefractionTextureEnabled=t}static get ColorGradingTextureEnabled(){return u.h.ColorGradingTextureEnabled}static set ColorGradingTextureEnabled(t){u.h.ColorGradingTextureEnabled=t}static get FresnelEnabled(){return u.h.FresnelEnabled}static set FresnelEnabled(t){u.h.FresnelEnabled=t}}h.ForceGLSL=!1,a.Cg([G.uM("diffuseTexture")],h.prototype,"_diffuseTexture",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesAndMiscDirty")],h.prototype,"diffuseTexture",void 0),a.Cg([G.uM("ambientTexture")],h.prototype,"_ambientTexture",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"ambientTexture",void 0),a.Cg([G.uM("opacityTexture")],h.prototype,"_opacityTexture",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesAndMiscDirty")],h.prototype,"opacityTexture",void 0),a.Cg([G.uM("reflectionTexture")],h.prototype,"_reflectionTexture",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"reflectionTexture",void 0),a.Cg([G.uM("emissiveTexture")],h.prototype,"_emissiveTexture",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"emissiveTexture",void 0),a.Cg([G.uM("specularTexture")],h.prototype,"_specularTexture",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"specularTexture",void 0),a.Cg([G.uM("bumpTexture")],h.prototype,"_bumpTexture",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"bumpTexture",void 0),a.Cg([G.uM("lightmapTexture")],h.prototype,"_lightmapTexture",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"lightmapTexture",void 0),a.Cg([G.uM("refractionTexture")],h.prototype,"_refractionTexture",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"refractionTexture",void 0),a.Cg([G.jT("ambient")],h.prototype,"ambientColor",void 0),a.Cg([G.jT("diffuse")],h.prototype,"diffuseColor",void 0),a.Cg([G.jT("specular")],h.prototype,"specularColor",void 0),a.Cg([G.jT("emissive")],h.prototype,"emissiveColor",void 0),a.Cg([G.lK()],h.prototype,"specularPower",void 0),a.Cg([G.lK("useAlphaFromDiffuseTexture")],h.prototype,"_useAlphaFromDiffuseTexture",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesAndMiscDirty")],h.prototype,"useAlphaFromDiffuseTexture",void 0),a.Cg([G.lK("useEmissiveAsIllumination")],h.prototype,"_useEmissiveAsIllumination",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"useEmissiveAsIllumination",void 0),a.Cg([G.lK("linkEmissiveWithDiffuse")],h.prototype,"_linkEmissiveWithDiffuse",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"linkEmissiveWithDiffuse",void 0),a.Cg([G.lK("useSpecularOverAlpha")],h.prototype,"_useSpecularOverAlpha",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"useSpecularOverAlpha",void 0),a.Cg([G.lK("useReflectionOverAlpha")],h.prototype,"_useReflectionOverAlpha",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"useReflectionOverAlpha",void 0),a.Cg([G.lK("disableLighting")],h.prototype,"_disableLighting",void 0),a.Cg([G.$z("_markAllSubMeshesAsLightsDirty")],h.prototype,"disableLighting",void 0),a.Cg([G.lK("useObjectSpaceNormalMap")],h.prototype,"_useObjectSpaceNormalMap",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"useObjectSpaceNormalMap",void 0),a.Cg([G.lK("useParallax")],h.prototype,"_useParallax",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"useParallax",void 0),a.Cg([G.lK("useParallaxOcclusion")],h.prototype,"_useParallaxOcclusion",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"useParallaxOcclusion",void 0),a.Cg([G.lK()],h.prototype,"parallaxScaleBias",void 0),a.Cg([G.lK("roughness")],h.prototype,"_roughness",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"roughness",void 0),a.Cg([G.lK()],h.prototype,"indexOfRefraction",void 0),a.Cg([G.lK()],h.prototype,"invertRefractionY",void 0),a.Cg([G.lK()],h.prototype,"alphaCutOff",void 0),a.Cg([G.lK("useLightmapAsShadowmap")],h.prototype,"_useLightmapAsShadowmap",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"useLightmapAsShadowmap",void 0),a.Cg([G.Y9("diffuseFresnelParameters")],h.prototype,"_diffuseFresnelParameters",void 0),a.Cg([G.$z("_markAllSubMeshesAsFresnelDirty")],h.prototype,"diffuseFresnelParameters",void 0),a.Cg([G.Y9("opacityFresnelParameters")],h.prototype,"_opacityFresnelParameters",void 0),a.Cg([G.$z("_markAllSubMeshesAsFresnelAndMiscDirty")],h.prototype,"opacityFresnelParameters",void 0),a.Cg([G.Y9("reflectionFresnelParameters")],h.prototype,"_reflectionFresnelParameters",void 0),a.Cg([G.$z("_markAllSubMeshesAsFresnelDirty")],h.prototype,"reflectionFresnelParameters",void 0),a.Cg([G.Y9("refractionFresnelParameters")],h.prototype,"_refractionFresnelParameters",void 0),a.Cg([G.$z("_markAllSubMeshesAsFresnelDirty")],h.prototype,"refractionFresnelParameters",void 0),a.Cg([G.Y9("emissiveFresnelParameters")],h.prototype,"_emissiveFresnelParameters",void 0),a.Cg([G.$z("_markAllSubMeshesAsFresnelDirty")],h.prototype,"emissiveFresnelParameters",void 0),a.Cg([G.lK("useReflectionFresnelFromSpecular")],h.prototype,"_useReflectionFresnelFromSpecular",void 0),a.Cg([G.$z("_markAllSubMeshesAsFresnelDirty")],h.prototype,"useReflectionFresnelFromSpecular",void 0),a.Cg([G.lK("useGlossinessFromSpecularMapAlpha")],h.prototype,"_useGlossinessFromSpecularMapAlpha",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"useGlossinessFromSpecularMapAlpha",void 0),a.Cg([G.lK("maxSimultaneousLights")],h.prototype,"_maxSimultaneousLights",void 0),a.Cg([G.$z("_markAllSubMeshesAsLightsDirty")],h.prototype,"maxSimultaneousLights",void 0),a.Cg([G.lK("invertNormalMapX")],h.prototype,"_invertNormalMapX",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"invertNormalMapX",void 0),a.Cg([G.lK("invertNormalMapY")],h.prototype,"_invertNormalMapY",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"invertNormalMapY",void 0),a.Cg([G.lK("twoSidedLighting")],h.prototype,"_twoSidedLighting",void 0),a.Cg([G.$z("_markAllSubMeshesAsTexturesDirty")],h.prototype,"twoSidedLighting",void 0),a.Cg([G.lK("applyDecalMapAfterDetailMap")],h.prototype,"_applyDecalMapAfterDetailMap",void 0),a.Cg([G.$z("_markAllSubMeshesAsMiscDirty")],h.prototype,"applyDecalMapAfterDetailMap",void 0),m.Y5("BABYLON.StandardMaterial",h),W.Z.DefaultMaterialFactory=t=>new h("default material",t)},384898:(t,K,D)=>{D.d(K,{D:()=>N});var a=D(706400),G=D(898973);D(617024);class N{constructor(t,K,D,a,G=!1){this._valueCache={},this._engine=t,this._noUBO=!t.supportsUniformBuffers||G,this._dynamic=D,this._name=null!=a?a:"no-name",this._data=K||[],this._uniformLocations={},this._uniformSizes={},this._uniformArraySizes={},this._uniformLocationPointer=0,this._needSync=!1,this._engine._features.trackUbosInFrame&&(this._buffers=[],this._bufferIndex=-1,this._createBufferOnWrite=!1,this._currentFrameId=0),this._noUBO?(this.updateMatrix3x3=this._updateMatrix3x3ForEffect,this.updateMatrix2x2=this._updateMatrix2x2ForEffect,this.updateFloat=this._updateFloatForEffect,this.updateFloat2=this._updateFloat2ForEffect,this.updateFloat3=this._updateFloat3ForEffect,this.updateFloat4=this._updateFloat4ForEffect,this.updateFloatArray=this._updateFloatArrayForEffect,this.updateArray=this._updateArrayForEffect,this.updateIntArray=this._updateIntArrayForEffect,this.updateUIntArray=this._updateUIntArrayForEffect,this.updateMatrix=this._updateMatrixForEffect,this.updateMatrices=this._updateMatricesForEffect,this.updateVector3=this._updateVector3ForEffect,this.updateVector4=this._updateVector4ForEffect,this.updateColor3=this._updateColor3ForEffect,this.updateColor4=this._updateColor4ForEffect,this.updateDirectColor4=this._updateDirectColor4ForEffect,this.updateInt=this._updateIntForEffect,this.updateInt2=this._updateInt2ForEffect,this.updateInt3=this._updateInt3ForEffect,this.updateInt4=this._updateInt4ForEffect,this.updateUInt=this._updateUIntForEffect,this.updateUInt2=this._updateUInt2ForEffect,this.updateUInt3=this._updateUInt3ForEffect,this.updateUInt4=this._updateUInt4ForEffect):(this._engine._uniformBuffers.push(this),this.updateMatrix3x3=this._updateMatrix3x3ForUniform,this.updateMatrix2x2=this._updateMatrix2x2ForUniform,this.updateFloat=this._updateFloatForUniform,this.updateFloat2=this._updateFloat2ForUniform,this.updateFloat3=this._updateFloat3ForUniform,this.updateFloat4=this._updateFloat4ForUniform,this.updateFloatArray=this._updateFloatArrayForUniform,this.updateArray=this._updateArrayForUniform,this.updateIntArray=this._updateIntArrayForUniform,this.updateUIntArray=this._updateUIntArrayForUniform,this.updateMatrix=this._updateMatrixForUniform,this.updateMatrices=this._updateMatricesForUniform,this.updateVector3=this._updateVector3ForUniform,this.updateVector4=this._updateVector4ForUniform,this.updateColor3=this._updateColor3ForUniform,this.updateColor4=this._updateColor4ForUniform,this.updateDirectColor4=this._updateDirectColor4ForUniform,this.updateInt=this._updateIntForUniform,this.updateInt2=this._updateInt2ForUniform,this.updateInt3=this._updateInt3ForUniform,this.updateInt4=this._updateInt4ForUniform,this.updateUInt=this._updateUIntForUniform,this.updateUInt2=this._updateUInt2ForUniform,this.updateUInt3=this._updateUInt3ForUniform,this.updateUInt4=this._updateUInt4ForUniform)}get useUbo(){return!this._noUBO}get isSync(){return!this._needSync}isDynamic(){return void 0!==this._dynamic}getData(){return this._bufferData}getBuffer(){return this._buffer}_fillAlignment(t){let K;if(K=t<=2?t:4,this._uniformLocationPointer%K!=0){const t=this._uniformLocationPointer;this._uniformLocationPointer+=K-this._uniformLocationPointer%K;const D=this._uniformLocationPointer-t;for(let t=0;t<D;t++)this._data.push(0)}}addUniform(t,K,D=0){if(this._noUBO)return;if(void 0!==this._uniformLocations[t])return;let a;if(D>0){if(K instanceof Array)throw"addUniform should not be use with Array in UBO: "+t;this._fillAlignment(4),this._uniformArraySizes[t]={strideSize:K,arraySize:D},16==K?K*=D:K=K*D+(4-K)*D,a=[];for(let t=0;t<K;t++)a.push(0)}else{if(K instanceof Array)a=K,K=a.length;else{a=[];for(let t=0;t<K;t++)a.push(0)}this._fillAlignment(K)}this._uniformSizes[t]=K,this._uniformLocations[t]=this._uniformLocationPointer,this._uniformLocationPointer+=K;for(let t=0;t<K;t++)this._data.push(a[t]);this._needSync=!0}addMatrix(t,K){this.addUniform(t,Array.prototype.slice.call(K.asArray()))}addFloat2(t,K,D){const a=[K,D];this.addUniform(t,a)}addFloat3(t,K,D,a){const G=[K,D,a];this.addUniform(t,G)}addColor3(t,K){const D=[K.r,K.g,K.b];this.addUniform(t,D)}addColor4(t,K,D){const a=[K.r,K.g,K.b,D];this.addUniform(t,a)}addVector3(t,K){const D=[K.x,K.y,K.z];this.addUniform(t,D)}addMatrix3x3(t){this.addUniform(t,12)}addMatrix2x2(t){this.addUniform(t,8)}create(){this._noUBO||this._buffer||(this._fillAlignment(4),this._bufferData=new Float32Array(this._data),this._rebuild(),this._needSync=!0)}_getNames(){const t=[];let K=0;for(const D in this._uniformLocations)if(t.push(D),10==++K)break;return t.join(",")}_rebuild(){!this._noUBO&&this._bufferData&&(this._dynamic?this._buffer=this._engine.createDynamicUniformBuffer(this._bufferData,this._name+"_UniformList:"+this._getNames()):this._buffer=this._engine.createUniformBuffer(this._bufferData,this._name+"_UniformList:"+this._getNames()),this._engine._features.trackUbosInFrame&&(this._buffers.push([this._buffer,this._engine._features.checkUbosContentBeforeUpload?this._bufferData.slice():void 0]),this._bufferIndex=this._buffers.length-1,this._createBufferOnWrite=!1))}_rebuildAfterContextLost(){this._engine._features.trackUbosInFrame&&(this._buffers=[],this._currentFrameId=0),this._rebuild()}get _numBuffers(){return this._buffers.length}get _indexBuffer(){return this._bufferIndex}get name(){return this._name}get currentEffect(){return this._currentEffect}_buffersEqual(t,K){for(let D=0;D<t.length;++D)if(t[D]!==K[D])return!1;return!0}_copyBuffer(t,K){for(let D=0;D<t.length;++D)K[D]=t[D]}update(){if(!this._noUBO)if(this.bindUniformBuffer(),this._buffer)if(this._dynamic||this._needSync){if(this._buffers&&this._buffers.length>1&&this._buffers[this._bufferIndex][1]){if(this._buffersEqual(this._bufferData,this._buffers[this._bufferIndex][1]))return this._needSync=!1,void(this._createBufferOnWrite=this._engine._features.trackUbosInFrame);this._copyBuffer(this._bufferData,this._buffers[this._bufferIndex][1])}this._engine.updateUniformBuffer(this._buffer,this._bufferData),this._engine._features._collectUbosUpdatedInFrame&&(N._UpdatedUbosInFrame[this._name]||(N._UpdatedUbosInFrame[this._name]=0),N._UpdatedUbosInFrame[this._name]++),this._needSync=!1,this._createBufferOnWrite=this._engine._features.trackUbosInFrame}else this._createBufferOnWrite=this._engine._features.trackUbosInFrame;else this.create()}_createNewBuffer(){this._bufferIndex+1<this._buffers.length?(this._bufferIndex++,this._buffer=this._buffers[this._bufferIndex][0],this._createBufferOnWrite=!1,this._needSync=!0):this._rebuild()}_checkNewFrame(){this._engine._features.trackUbosInFrame&&this._currentFrameId!==this._engine.frameId&&(this._currentFrameId=this._engine.frameId,this._createBufferOnWrite=!1,this._buffers&&this._buffers.length>0?(this._needSync=0!==this._bufferIndex,this._bufferIndex=0,this._buffer=this._buffers[this._bufferIndex][0]):this._bufferIndex=-1)}updateUniform(t,K,D){this._checkNewFrame();let G=this._uniformLocations[t];if(void 0===G){if(this._buffer)return void a.V.Error("Cannot add an uniform after UBO has been created. uniformName="+t);this.addUniform(t,D),G=this._uniformLocations[t]}if(this._buffer||this.create(),this._dynamic)for(let t=0;t<D;t++)this._bufferData[G+t]=K[t];else{let t=!1;for(let a=0;a<D;a++)(16===D&&!this._engine._features.uniformBufferHardCheckMatrix||this._bufferData[G+a]!==Math.fround(K[a]))&&(t=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[G+a]=K[a]);this._needSync=this._needSync||t}}updateUniformArray(t,K,D){this._checkNewFrame();const N=this._uniformLocations[t];if(void 0===N)return void a.V.Error("Cannot add an uniform Array dynamically. Please, add it using addUniform and make sure that uniform buffers are supported by the current engine.");this._buffer||this.create();const W=this._uniformArraySizes[t];if(this._dynamic)for(let t=0;t<D;t++)this._bufferData[N+t]=K[t];else{let t=!1,a=0,x=0;for(let b=0;b<D;b++)if(this._bufferData[N+4*x+a]!==G.S0.FloatRound(K[b])&&(t=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[N+4*x+a]=K[b]),a++,a===W.strideSize){for(;a<4;a++)this._bufferData[N+4*x+a]=0;a=0,x++}this._needSync=this._needSync||t}}_cacheMatrix(t,K){this._checkNewFrame();const D=this._valueCache[t],a=K.updateFlag;return(void 0===D||D!==a)&&(this._valueCache[t]=a,!0)}_updateMatrix3x3ForUniform(t,K){for(let t=0;t<3;t++)N._TempBuffer[4*t]=K[3*t],N._TempBuffer[4*t+1]=K[3*t+1],N._TempBuffer[4*t+2]=K[3*t+2],N._TempBuffer[4*t+3]=0;this.updateUniform(t,N._TempBuffer,12)}_updateMatrix3x3ForEffect(t,K){this._currentEffect.setMatrix3x3(t,K)}_updateMatrix2x2ForEffect(t,K){this._currentEffect.setMatrix2x2(t,K)}_updateMatrix2x2ForUniform(t,K){for(let t=0;t<2;t++)N._TempBuffer[4*t]=K[2*t],N._TempBuffer[4*t+1]=K[2*t+1],N._TempBuffer[4*t+2]=0,N._TempBuffer[4*t+3]=0;this.updateUniform(t,N._TempBuffer,8)}_updateFloatForEffect(t,K){this._currentEffect.setFloat(t,K)}_updateFloatForUniform(t,K){N._TempBuffer[0]=K,this.updateUniform(t,N._TempBuffer,1)}_updateFloat2ForEffect(t,K,D,a=""){this._currentEffect.setFloat2(t+a,K,D)}_updateFloat2ForUniform(t,K,D){N._TempBuffer[0]=K,N._TempBuffer[1]=D,this.updateUniform(t,N._TempBuffer,2)}_updateFloat3ForEffect(t,K,D,a,G=""){this._currentEffect.setFloat3(t+G,K,D,a)}_updateFloat3ForUniform(t,K,D,a){N._TempBuffer[0]=K,N._TempBuffer[1]=D,N._TempBuffer[2]=a,this.updateUniform(t,N._TempBuffer,3)}_updateFloat4ForEffect(t,K,D,a,G,N=""){this._currentEffect.setFloat4(t+N,K,D,a,G)}_updateFloat4ForUniform(t,K,D,a,G){N._TempBuffer[0]=K,N._TempBuffer[1]=D,N._TempBuffer[2]=a,N._TempBuffer[3]=G,this.updateUniform(t,N._TempBuffer,4)}_updateFloatArrayForEffect(t,K){this._currentEffect.setFloatArray(t,K)}_updateFloatArrayForUniform(t,K){this.updateUniformArray(t,K,K.length)}_updateArrayForEffect(t,K){this._currentEffect.setArray(t,K)}_updateArrayForUniform(t,K){this.updateUniformArray(t,K,K.length)}_updateIntArrayForEffect(t,K){this._currentEffect.setIntArray(t,K)}_updateIntArrayForUniform(t,K){N._TempBufferInt32View.set(K),this.updateUniformArray(t,N._TempBuffer,K.length)}_updateUIntArrayForEffect(t,K){this._currentEffect.setUIntArray(t,K)}_updateUIntArrayForUniform(t,K){N._TempBufferUInt32View.set(K),this.updateUniformArray(t,N._TempBuffer,K.length)}_updateMatrixForEffect(t,K){this._currentEffect.setMatrix(t,K)}_updateMatrixForUniform(t,K){this._cacheMatrix(t,K)&&this.updateUniform(t,K.asArray(),16)}_updateMatricesForEffect(t,K){this._currentEffect.setMatrices(t,K)}_updateMatricesForUniform(t,K){this.updateUniform(t,K,K.length)}_updateVector3ForEffect(t,K){this._currentEffect.setVector3(t,K)}_updateVector3ForUniform(t,K){N._TempBuffer[0]=K.x,N._TempBuffer[1]=K.y,N._TempBuffer[2]=K.z,this.updateUniform(t,N._TempBuffer,3)}_updateVector4ForEffect(t,K){this._currentEffect.setVector4(t,K)}_updateVector4ForUniform(t,K){N._TempBuffer[0]=K.x,N._TempBuffer[1]=K.y,N._TempBuffer[2]=K.z,N._TempBuffer[3]=K.w,this.updateUniform(t,N._TempBuffer,4)}_updateColor3ForEffect(t,K,D=""){this._currentEffect.setColor3(t+D,K)}_updateColor3ForUniform(t,K){N._TempBuffer[0]=K.r,N._TempBuffer[1]=K.g,N._TempBuffer[2]=K.b,this.updateUniform(t,N._TempBuffer,3)}_updateColor4ForEffect(t,K,D,a=""){this._currentEffect.setColor4(t+a,K,D)}_updateDirectColor4ForEffect(t,K,D=""){this._currentEffect.setDirectColor4(t+D,K)}_updateColor4ForUniform(t,K,D){N._TempBuffer[0]=K.r,N._TempBuffer[1]=K.g,N._TempBuffer[2]=K.b,N._TempBuffer[3]=D,this.updateUniform(t,N._TempBuffer,4)}_updateDirectColor4ForUniform(t,K){N._TempBuffer[0]=K.r,N._TempBuffer[1]=K.g,N._TempBuffer[2]=K.b,N._TempBuffer[3]=K.a,this.updateUniform(t,N._TempBuffer,4)}_updateIntForEffect(t,K,D=""){this._currentEffect.setInt(t+D,K)}_updateIntForUniform(t,K){N._TempBufferInt32View[0]=K,this.updateUniform(t,N._TempBuffer,1)}_updateInt2ForEffect(t,K,D,a=""){this._currentEffect.setInt2(t+a,K,D)}_updateInt2ForUniform(t,K,D){N._TempBufferInt32View[0]=K,N._TempBufferInt32View[1]=D,this.updateUniform(t,N._TempBuffer,2)}_updateInt3ForEffect(t,K,D,a,G=""){this._currentEffect.setInt3(t+G,K,D,a)}_updateInt3ForUniform(t,K,D,a){N._TempBufferInt32View[0]=K,N._TempBufferInt32View[1]=D,N._TempBufferInt32View[2]=a,this.updateUniform(t,N._TempBuffer,3)}_updateInt4ForEffect(t,K,D,a,G,N=""){this._currentEffect.setInt4(t+N,K,D,a,G)}_updateInt4ForUniform(t,K,D,a,G){N._TempBufferInt32View[0]=K,N._TempBufferInt32View[1]=D,N._TempBufferInt32View[2]=a,N._TempBufferInt32View[3]=G,this.updateUniform(t,N._TempBuffer,4)}_updateUIntForEffect(t,K,D=""){this._currentEffect.setUInt(t+D,K)}_updateUIntForUniform(t,K){N._TempBufferUInt32View[0]=K,this.updateUniform(t,N._TempBuffer,1)}_updateUInt2ForEffect(t,K,D,a=""){this._currentEffect.setUInt2(t+a,K,D)}_updateUInt2ForUniform(t,K,D){N._TempBufferUInt32View[0]=K,N._TempBufferUInt32View[1]=D,this.updateUniform(t,N._TempBuffer,2)}_updateUInt3ForEffect(t,K,D,a,G=""){this._currentEffect.setUInt3(t+G,K,D,a)}_updateUInt3ForUniform(t,K,D,a){N._TempBufferUInt32View[0]=K,N._TempBufferUInt32View[1]=D,N._TempBufferUInt32View[2]=a,this.updateUniform(t,N._TempBuffer,3)}_updateUInt4ForEffect(t,K,D,a,G,N=""){this._currentEffect.setUInt4(t+N,K,D,a,G)}_updateUInt4ForUniform(t,K,D,a,G){N._TempBufferUInt32View[0]=K,N._TempBufferUInt32View[1]=D,N._TempBufferUInt32View[2]=a,N._TempBufferUInt32View[3]=G,this.updateUniform(t,N._TempBuffer,4)}setTexture(t,K){this._currentEffect.setTexture(t,K)}setTextureArray(t,K){this._currentEffect.setTextureArray(t,K)}bindTexture(t,K){this._currentEffect._bindTexture(t,K)}updateUniformDirectly(t,K){this.updateUniform(t,K,K.length),this.update()}bindToEffect(t,K){this._currentEffect=t,this._currentEffectName=K}bindUniformBuffer(){!this._noUBO&&this._buffer&&this._currentEffect&&this._currentEffect.bindUniformBuffer(this._buffer,this._currentEffectName)}unbindEffect(){this._currentEffect=void 0,this._currentEffectName=void 0}setDataBuffer(t){if(!this._buffers)return this._buffer===t;for(let K=0;K<this._buffers.length;++K)if(this._buffers[K][0]===t)return this._bufferIndex=K,this._buffer=t,this._createBufferOnWrite=!1,this._currentEffect=void 0,!0;return!1}dispose(){if(this._noUBO)return;const t=this._engine._uniformBuffers,K=t.indexOf(this);if(-1!==K&&(t[K]=t[t.length-1],t.pop()),this._engine._features.trackUbosInFrame&&this._buffers)for(let t=0;t<this._buffers.length;++t){const K=this._buffers[t][0];this._engine._releaseBuffer(K)}else this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)}}N._UpdatedUbosInFrame={},N._MAX_UNIFORM_SIZE=256,N._TempBuffer=new Float32Array(N._MAX_UNIFORM_SIZE),N._TempBufferInt32View=new Int32Array(N._TempBuffer.buffer),N._TempBufferUInt32View=new Uint32Array(N._TempBuffer.buffer)},690096:(t,K,D)=>{D.d(K,{_0:()=>W});var a,G,N=D(604910);(function(t){t[t["LOCAL"]=0]="LOCAL",t[t["WORLD"]=1]="WORLD",t[t["BONE"]=2]="BONE"})(a||(a={}));class W{}W.X=new N.Pq(1,0,0),W.Y=new N.Pq(0,1,0),W.Z=new N.Pq(0,0,1),function(t){t[t["X"]=0]="X",t[t["Y"]=1]="Y",t[t["Z"]=2]="Z"}(G||(G={}))},332290:(t,K,D)=>{D.d(K,{IG:()=>Z,ov:()=>I,v9:()=>z});var a=D(967872),G=D(310035),N=D(779908),W=D(615473),x=D(241082);function b(t){return Math.pow(t,N.tk)}function n(t){return t<=.04045?.0773993808*t:Math.pow(.947867299*(t+.055),2.4)}function e(t){return Math.pow(t,N.rv)}function i(t){return t<=.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}class z{constructor(t=0,K=0,D=0){this.r=t,this.g=K,this.b=D}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let t=255*this.r|0;return t=397*t^(255*this.g|0),t=397*t^(255*this.b|0),t}toArray(t,K=0){return t[K]=this.r,t[K+1]=this.g,t[K+2]=this.b,this}fromArray(t,K=0){return z.FromArrayToRef(t,K,this),this}toColor4(t=1){return new I(this.r,this.g,this.b,t)}asArray(){return[this.r,this.g,this.b]}toLuminance(){return.3*this.r+.59*this.g+.11*this.b}multiply(t){return new z(this.r*t.r,this.g*t.g,this.b*t.b)}multiplyToRef(t,K){return K.r=this.r*t.r,K.g=this.g*t.g,K.b=this.b*t.b,K}multiplyInPlace(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyByFloats(t,K,D){return new z(this.r*t,this.g*K,this.b*D)}divide(t){throw new ReferenceError("Can not divide a color")}divideToRef(t,K){throw new ReferenceError("Can not divide a color")}divideInPlace(t){throw new ReferenceError("Can not divide a color")}minimizeInPlace(t){return this.minimizeInPlaceFromFloats(t.r,t.g,t.b)}maximizeInPlace(t){return this.maximizeInPlaceFromFloats(t.r,t.g,t.b)}minimizeInPlaceFromFloats(t,K,D){return this.r=Math.min(t,this.r),this.g=Math.min(K,this.g),this.b=Math.min(D,this.b),this}maximizeInPlaceFromFloats(t,K,D){return this.r=Math.max(t,this.r),this.g=Math.max(K,this.g),this.b=Math.max(D,this.b),this}floorToRef(t){throw new ReferenceError("Can not floor a color")}floor(){throw new ReferenceError("Can not floor a color")}fractToRef(t){throw new ReferenceError("Can not fract a color")}fract(){throw new ReferenceError("Can not fract a color")}equals(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b}equalsFloats(t,K,D){return this.equalsToFloats(t,K,D)}equalsToFloats(t,K,D){return this.r===t&&this.g===K&&this.b===D}equalsWithEpsilon(t,K=N.bH){return W.X.WithinEpsilon(this.r,t.r,K)&&W.X.WithinEpsilon(this.g,t.g,K)&&W.X.WithinEpsilon(this.b,t.b,K)}negate(){throw new ReferenceError("Can not negate a color")}negateInPlace(){throw new ReferenceError("Can not negate a color")}negateToRef(t){throw new ReferenceError("Can not negate a color")}scale(t){return new z(this.r*t,this.g*t,this.b*t)}scaleInPlace(t){return this.r*=t,this.g*=t,this.b*=t,this}scaleToRef(t,K){return K.r=this.r*t,K.g=this.g*t,K.b=this.b*t,K}scaleAndAddToRef(t,K){return K.r+=this.r*t,K.g+=this.g*t,K.b+=this.b*t,K}clampToRef(t=0,K=1,D){return D.r=x.OQ(this.r,t,K),D.g=x.OQ(this.g,t,K),D.b=x.OQ(this.b,t,K),D}add(t){return new z(this.r+t.r,this.g+t.g,this.b+t.b)}addInPlace(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addInPlaceFromFloats(t,K,D){return this.r+=t,this.g+=K,this.b+=D,this}addToRef(t,K){return K.r=this.r+t.r,K.g=this.g+t.g,K.b=this.b+t.b,K}subtract(t){return new z(this.r-t.r,this.g-t.g,this.b-t.b)}subtractToRef(t,K){return K.r=this.r-t.r,K.g=this.g-t.g,K.b=this.b-t.b,K}subtractInPlace(t){return this.r-=t.r,this.g-=t.g,this.b-=t.b,this}subtractFromFloats(t,K,D){return new z(this.r-t,this.g-K,this.b-D)}subtractFromFloatsToRef(t,K,D,a){return a.r=this.r-t,a.g=this.g-K,a.b=this.b-D,a}clone(){return new z(this.r,this.g,this.b)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyFromFloats(t,K,D){return this.r=t,this.g=K,this.b=D,this}set(t,K,D){return this.copyFromFloats(t,K,D)}setAll(t){return this.r=this.g=this.b=t,this}toHexString(){const t=Math.round(255*this.r),K=Math.round(255*this.g),D=Math.round(255*this.b);return"#"+x.Db(t)+x.Db(K)+x.Db(D)}toHSV(){return this.toHSVToRef(new z)}toHSVToRef(t){const K=this.r,D=this.g,a=this.b,G=Math.max(K,D,a),N=Math.min(K,D,a);let W=0,x=0;const b=G,n=G-N;return 0!==G&&(x=n/G),G!=N&&(G==K?(W=(D-a)/n,D<a&&(W+=6)):G==D?W=(a-K)/n+2:G==a&&(W=(K-D)/n+4),W*=60),t.r=W,t.g=x,t.b=b,t}toLinearSpace(t=!1){const K=new z;return this.toLinearSpaceToRef(K,t),K}toLinearSpaceToRef(t,K=!1){return K?(t.r=n(this.r),t.g=n(this.g),t.b=n(this.b)):(t.r=b(this.r),t.g=b(this.g),t.b=b(this.b)),this}toGammaSpace(t=!1){const K=new z;return this.toGammaSpaceToRef(K,t),K}toGammaSpaceToRef(t,K=!1){return K?(t.r=i(this.r),t.g=i(this.g),t.b=i(this.b)):(t.r=e(this.r),t.g=e(this.g),t.b=e(this.b)),this}static HSVtoRGBToRef(t,K,D,a){const G=D*K,N=t/60,W=G*(1-Math.abs(N%2-1));let x=0,b=0,n=0;N>=0&&N<=1?(x=G,b=W):N>=1&&N<=2?(x=W,b=G):N>=2&&N<=3?(b=G,n=W):N>=3&&N<=4?(b=W,n=G):N>=4&&N<=5?(x=W,n=G):N>=5&&N<=6&&(x=G,n=W);const e=D-G;return a.r=x+e,a.g=b+e,a.b=n+e,a}static FromHSV(t,K,D){const a=new z(0,0,0);return z.HSVtoRGBToRef(t,K,D,a),a}static FromHexString(t){if("#"!==t.substring(0,1)||7!==t.length)return new z(0,0,0);const K=parseInt(t.substring(1,3),16),D=parseInt(t.substring(3,5),16),a=parseInt(t.substring(5,7),16);return z.FromInts(K,D,a)}static FromArray(t,K=0){return new z(t[K],t[K+1],t[K+2])}static FromArrayToRef(t,K=0,D){D.r=t[K],D.g=t[K+1],D.b=t[K+2]}static FromInts(t,K,D){return new z(t/255,K/255,D/255)}static Lerp(t,K,D){const a=new z(0,0,0);return z.LerpToRef(t,K,D,a),a}static LerpToRef(t,K,D,a){a.r=t.r+(K.r-t.r)*D,a.g=t.g+(K.g-t.g)*D,a.b=t.b+(K.b-t.b)*D}static Hermite(t,K,D,a,G){const N=G*G,W=G*N,x=2*W-3*N+1,b=-2*W+3*N,n=W-2*N+G,e=W-N,i=t.r*x+D.r*b+K.r*n+a.r*e,I=t.g*x+D.g*b+K.g*n+a.g*e,Z=t.b*x+D.b*b+K.b*n+a.b*e;return new z(i,I,Z)}static Hermite1stDerivative(t,K,D,a,G){const N=z.Black();return this.Hermite1stDerivativeToRef(t,K,D,a,G,N),N}static Hermite1stDerivativeToRef(t,K,D,a,G,N){const W=G*G;N.r=6*(W-G)*t.r+(3*W-4*G+1)*K.r+6*(-W+G)*D.r+(3*W-2*G)*a.r,N.g=6*(W-G)*t.g+(3*W-4*G+1)*K.g+6*(-W+G)*D.g+(3*W-2*G)*a.g,N.b=6*(W-G)*t.b+(3*W-4*G+1)*K.b+6*(-W+G)*D.b+(3*W-2*G)*a.b}static Red(){return new z(1,0,0)}static Green(){return new z(0,1,0)}static Blue(){return new z(0,0,1)}static Black(){return new z(0,0,0)}static get BlackReadOnly(){return z._BlackReadOnly}static White(){return new z(1,1,1)}static Purple(){return new z(.5,0,.5)}static Magenta(){return new z(1,0,1)}static Yellow(){return new z(1,1,0)}static Gray(){return new z(.5,.5,.5)}static Teal(){return new z(0,1,1)}static Random(){return new z(Math.random(),Math.random(),Math.random())}}z._BlackReadOnly=z.Black(),Object.defineProperties(z.prototype,{dimension:{value:[3]},rank:{value:1}});class I{constructor(t=0,K=0,D=0,a=1){this.r=t,this.g=K,this.b=D,this.a=a}asArray(){return[this.r,this.g,this.b,this.a]}toArray(t,K=0){return t[K]=this.r,t[K+1]=this.g,t[K+2]=this.b,t[K+3]=this.a,this}fromArray(t,K=0){return this.r=t[K],this.g=t[K+1],this.b=t[K+2],this.a=t[K+3],this}equals(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}add(t){return new I(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)}addToRef(t,K){return K.r=this.r+t.r,K.g=this.g+t.g,K.b=this.b+t.b,K.a=this.a+t.a,K}addInPlace(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this}addInPlaceFromFloats(t,K,D,a){return this.r+=t,this.g+=K,this.b+=D,this.a+=a,this}subtract(t){return new I(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)}subtractToRef(t,K){return K.r=this.r-t.r,K.g=this.g-t.g,K.b=this.b-t.b,K.a=this.a-t.a,K}subtractInPlace(t){return this.r-=t.r,this.g-=t.g,this.b-=t.b,this.a-=t.a,this}subtractFromFloats(t,K,D,a){return new I(this.r-t,this.g-K,this.b-D,this.a-a)}subtractFromFloatsToRef(t,K,D,a,G){return G.r=this.r-t,G.g=this.g-K,G.b=this.b-D,G.a=this.a-a,G}scale(t){return new I(this.r*t,this.g*t,this.b*t,this.a*t)}scaleInPlace(t){return this.r*=t,this.g*=t,this.b*=t,this.a*=t,this}scaleToRef(t,K){return K.r=this.r*t,K.g=this.g*t,K.b=this.b*t,K.a=this.a*t,K}scaleAndAddToRef(t,K){return K.r+=this.r*t,K.g+=this.g*t,K.b+=this.b*t,K.a+=this.a*t,K}clampToRef(t=0,K=1,D){return D.r=x.OQ(this.r,t,K),D.g=x.OQ(this.g,t,K),D.b=x.OQ(this.b,t,K),D.a=x.OQ(this.a,t,K),D}multiply(t){return new I(this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a)}multiplyToRef(t,K){return K.r=this.r*t.r,K.g=this.g*t.g,K.b=this.b*t.b,K.a=this.a*t.a,K}multiplyInPlace(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this.a*=t.a,this}multiplyByFloats(t,K,D,a){return new I(this.r*t,this.g*K,this.b*D,this.a*a)}divide(t){throw new ReferenceError("Can not divide a color")}divideToRef(t,K){throw new ReferenceError("Can not divide a color")}divideInPlace(t){throw new ReferenceError("Can not divide a color")}minimizeInPlace(t){return this.r=Math.min(this.r,t.r),this.g=Math.min(this.g,t.g),this.b=Math.min(this.b,t.b),this.a=Math.min(this.a,t.a),this}maximizeInPlace(t){return this.r=Math.max(this.r,t.r),this.g=Math.max(this.g,t.g),this.b=Math.max(this.b,t.b),this.a=Math.max(this.a,t.a),this}minimizeInPlaceFromFloats(t,K,D,a){return this.r=Math.min(t,this.r),this.g=Math.min(K,this.g),this.b=Math.min(D,this.b),this.a=Math.min(a,this.a),this}maximizeInPlaceFromFloats(t,K,D,a){return this.r=Math.max(t,this.r),this.g=Math.max(K,this.g),this.b=Math.max(D,this.b),this.a=Math.max(a,this.a),this}floorToRef(t){throw new ReferenceError("Can not floor a color")}floor(){throw new ReferenceError("Can not floor a color")}fractToRef(t){throw new ReferenceError("Can not fract a color")}fract(){throw new ReferenceError("Can not fract a color")}negate(){throw new ReferenceError("Can not negate a color")}negateInPlace(){throw new ReferenceError("Can not negate a color")}negateToRef(t){throw new ReferenceError("Can not negate a color")}equalsWithEpsilon(t,K=N.bH){return W.X.WithinEpsilon(this.r,t.r,K)&&W.X.WithinEpsilon(this.g,t.g,K)&&W.X.WithinEpsilon(this.b,t.b,K)&&W.X.WithinEpsilon(this.a,t.a,K)}equalsToFloats(t,K,D,a){return this.r===t&&this.g===K&&this.b===D&&this.a===a}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let t=255*this.r|0;return t=397*t^(255*this.g|0),t=397*t^(255*this.b|0),t=397*t^(255*this.a|0),t}clone(){return(new I).copyFrom(this)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}copyFromFloats(t,K,D,a){return this.r=t,this.g=K,this.b=D,this.a=a,this}set(t,K,D,a){return this.copyFromFloats(t,K,D,a)}setAll(t){return this.r=this.g=this.b=this.a=t,this}toHexString(t=!1){const K=Math.round(255*this.r),D=Math.round(255*this.g),a=Math.round(255*this.b);if(t)return"#"+x.Db(K)+x.Db(D)+x.Db(a);const G=Math.round(255*this.a);return"#"+x.Db(K)+x.Db(D)+x.Db(a)+x.Db(G)}toLinearSpace(t=!1){const K=new I;return this.toLinearSpaceToRef(K,t),K}toLinearSpaceToRef(t,K=!1){return K?(t.r=n(this.r),t.g=n(this.g),t.b=n(this.b)):(t.r=b(this.r),t.g=b(this.g),t.b=b(this.b)),t.a=this.a,this}toGammaSpace(t=!1){const K=new I;return this.toGammaSpaceToRef(K,t),K}toGammaSpaceToRef(t,K=!1){return K?(t.r=i(this.r),t.g=i(this.g),t.b=i(this.b)):(t.r=e(this.r),t.g=e(this.g),t.b=e(this.b)),t.a=this.a,this}static FromHexString(t){if("#"!==t.substring(0,1)||9!==t.length&&7!==t.length)return new I(0,0,0,0);const K=parseInt(t.substring(1,3),16),D=parseInt(t.substring(3,5),16),a=parseInt(t.substring(5,7),16),G=9===t.length?parseInt(t.substring(7,9),16):255;return I.FromInts(K,D,a,G)}static Lerp(t,K,D){return I.LerpToRef(t,K,D,new I)}static LerpToRef(t,K,D,a){return a.r=t.r+(K.r-t.r)*D,a.g=t.g+(K.g-t.g)*D,a.b=t.b+(K.b-t.b)*D,a.a=t.a+(K.a-t.a)*D,a}static Hermite(t,K,D,a,G){const N=G*G,W=G*N,x=2*W-3*N+1,b=-2*W+3*N,n=W-2*N+G,e=W-N,i=t.r*x+D.r*b+K.r*n+a.r*e,z=t.g*x+D.g*b+K.g*n+a.g*e,Z=t.b*x+D.b*b+K.b*n+a.b*e,w=t.a*x+D.a*b+K.a*n+a.a*e;return new I(i,z,Z,w)}static Hermite1stDerivative(t,K,D,a,G){const N=new I;return this.Hermite1stDerivativeToRef(t,K,D,a,G,N),N}static Hermite1stDerivativeToRef(t,K,D,a,G,N){const W=G*G;N.r=6*(W-G)*t.r+(3*W-4*G+1)*K.r+6*(-W+G)*D.r+(3*W-2*G)*a.r,N.g=6*(W-G)*t.g+(3*W-4*G+1)*K.g+6*(-W+G)*D.g+(3*W-2*G)*a.g,N.b=6*(W-G)*t.b+(3*W-4*G+1)*K.b+6*(-W+G)*D.b+(3*W-2*G)*a.b,N.a=6*(W-G)*t.a+(3*W-4*G+1)*K.a+6*(-W+G)*D.a+(3*W-2*G)*a.a}static FromColor3(t,K=1){return new I(t.r,t.g,t.b,K)}static FromArray(t,K=0){return new I(t[K],t[K+1],t[K+2],t[K+3])}static FromArrayToRef(t,K=0,D){D.r=t[K],D.g=t[K+1],D.b=t[K+2],D.a=t[K+3]}static FromInts(t,K,D,a){return new I(t/255,K/255,D/255,a/255)}static CheckColors4(t,K){if(t.length===3*K){const K=[];for(let D=0;D<t.length;D+=3){const a=D/3*4;K[a]=t[D],K[a+1]=t[D+1],K[a+2]=t[D+2],K[a+3]=1}return K}return t}}Object.defineProperties(I.prototype,{dimension:{value:[4]},rank:{value:1}});class Z{}Z.Color3=a.mI(3,z.Black),Z.Color4=a.mI(3,(()=>new I(0,0,0,0))),G.Y5("BABYLON.Color3",z),G.Y5("BABYLON.Color4",I)},779908:(t,K,D)=>{D.d(K,{a6:()=>N,bH:()=>W,rv:()=>a,tk:()=>G});const a=1/2.2,G=2.2,N=(1+Math.sqrt(5))/2,W=.001},993739:(t,K,D)=>{D.d(K,{P:()=>G});var a=D(298039);class G{static GetPlanes(t){const K=[];for(let t=0;t<6;t++)K.push(new a.Z(0,0,0,0));return G.GetPlanesToRef(t,K),K}static GetNearPlaneToRef(t,K){const D=t.m;K.normal.x=D[3]+D[2],K.normal.y=D[7]+D[6],K.normal.z=D[11]+D[10],K.d=D[15]+D[14],K.normalize()}static GetFarPlaneToRef(t,K){const D=t.m;K.normal.x=D[3]-D[2],K.normal.y=D[7]-D[6],K.normal.z=D[11]-D[10],K.d=D[15]-D[14],K.normalize()}static GetLeftPlaneToRef(t,K){const D=t.m;K.normal.x=D[3]+D[0],K.normal.y=D[7]+D[4],K.normal.z=D[11]+D[8],K.d=D[15]+D[12],K.normalize()}static GetRightPlaneToRef(t,K){const D=t.m;K.normal.x=D[3]-D[0],K.normal.y=D[7]-D[4],K.normal.z=D[11]-D[8],K.d=D[15]-D[12],K.normalize()}static GetTopPlaneToRef(t,K){const D=t.m;K.normal.x=D[3]-D[1],K.normal.y=D[7]-D[5],K.normal.z=D[11]-D[9],K.d=D[15]-D[13],K.normalize()}static GetBottomPlaneToRef(t,K){const D=t.m;K.normal.x=D[3]+D[1],K.normal.y=D[7]+D[5],K.normal.z=D[11]+D[9],K.d=D[15]+D[13],K.normalize()}static GetPlanesToRef(t,K){G.GetNearPlaneToRef(t,K[0]),G.GetFarPlaneToRef(t,K[1]),G.GetLeftPlaneToRef(t,K[2]),G.GetRightPlaneToRef(t,K[3]),G.GetTopPlaneToRef(t,K[4]),G.GetBottomPlaneToRef(t,K[5])}static IsPointInFrustum(t,K){for(let D=0;D<6;D++)if(K[D].dotCoordinate(t)<0)return!1;return!0}}},755752:(t,K,D)=>{D.d(K,{b:()=>b,c:()=>x});var a=D(297809),G=D(604910),N=D(760998);class W{static extractMinAndMaxIndexed(t,K,D,a,G,N){for(let W=D;W<D+a;W++){const D=3*K[W],a=t[D],x=t[D+1],b=t[D+2];G.minimizeInPlaceFromFloats(a,x,b),N.maximizeInPlaceFromFloats(a,x,b)}}static extractMinAndMax(t,K,D,a,G,N){for(let W=K,x=K*a;W<K+D;W++,x+=a){const K=t[x],D=t[x+1],a=t[x+2];G.minimizeInPlaceFromFloats(K,D,a),N.maximizeInPlaceFromFloats(K,D,a)}}}function x(t,K,D,a,N=null){const x=new G.Pq(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),b=new G.Pq(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return W.extractMinAndMaxIndexed(t,K,D,a,x,b),N&&(x.x-=x.x*N.x+N.y,x.y-=x.y*N.x+N.y,x.z-=x.z*N.x+N.y,b.x+=b.x*N.x+N.y,b.y+=b.y*N.x+N.y,b.z+=b.z*N.x+N.y),{minimum:x,maximum:b}}function b(t,K,D,a=null,N){const x=new G.Pq(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),b=new G.Pq(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return N||(N=3),W.extractMinAndMax(t,K,D,N,x,b),a&&(x.x-=x.x*a.x+a.y,x.y-=x.y*a.x+a.y,x.z-=x.z*a.x+a.y,b.x+=b.x*a.x+a.y,b.y+=b.y*a.x+a.y,b.z+=b.z*a.x+a.y),{minimum:x,maximum:b}}a.Cg([N.Cx.filter(((...[t,K])=>!Array.isArray(t)&&!Array.isArray(K)))],W,"extractMinAndMaxIndexed",null),a.Cg([N.Cx.filter(((...[t])=>!Array.isArray(t)))],W,"extractMinAndMax",null)},948733:(t,K,D)=>{D.d(K,{v9:()=>a.v9,ov:()=>a.ov,bH:()=>G.bH,AA:()=>N.AA,Pq:()=>N.Pq}),D(690096);var a=D(332290),G=D(779908),N=(D(993739),D(808966),D(298039),D(500556),D(604910));D(60071)},808966:(t,K,D)=>{D.d(K,{Cu:()=>e,jj:()=>z,tO:()=>i,vr:()=>x});var a,G=D(615473),N=D(604910),W=D(779908);(function(t){t[t["CW"]=0]="CW",t[t["CCW"]=1]="CCW"})(a||(a={}));class x{static Interpolate(t,K,D,a,G){const N=1-3*a+3*K,W=3*a-6*K,x=3*K;let b=t;for(let K=0;K<5;K++){const K=b*b;b-=(N*(K*b)+W*K+x*b-t)*(1/(3*N*K+2*W*b+x)),b=Math.min(1,Math.max(0,b))}return 3*Math.pow(1-b,2)*b*D+3*(1-b)*Math.pow(b,2)*G+Math.pow(b,3)}}class b{constructor(t){this._radians=t,this._radians<0&&(this._radians+=2*Math.PI)}degrees(){return 180*this._radians/Math.PI}radians(){return this._radians}static BetweenTwoPoints(t,K){const D=K.subtract(t),a=Math.atan2(D.y,D.x);return new b(a)}static BetweenTwoVectors(t,K){let D=t.lengthSquared()*K.lengthSquared();if(0===D)return new b(Math.PI/2);D=Math.sqrt(D);let a=t.dot(K)/D;a=G.X.Clamp(a,-1,1);const N=Math.acos(a);return new b(N)}static FromRadians(t){return new b(t)}static FromDegrees(t){return new b(t*Math.PI/180)}}class n{constructor(t,K,D){this.startPoint=t,this.midPoint=K,this.endPoint=D;const a=Math.pow(K.x,2)+Math.pow(K.y,2),G=(Math.pow(t.x,2)+Math.pow(t.y,2)-a)/2,W=(a-Math.pow(D.x,2)-Math.pow(D.y,2))/2,x=(t.x-K.x)*(K.y-D.y)-(K.x-D.x)*(t.y-K.y);this.centerPoint=new N.I9((G*(K.y-D.y)-W*(t.y-K.y))/x,((t.x-K.x)*W-(K.x-D.x)*G)/x),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=b.BetweenTwoPoints(this.centerPoint,this.startPoint);const n=this.startAngle.degrees();let e=b.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),i=b.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();e-n>+180&&(e-=360),e-n<-180&&(e+=360),i-e>+180&&(i-=360),i-e<-180&&(i+=360),this.orientation=e-n<0?0:1,this.angle=b.FromDegrees(0===this.orientation?n-i:i-n)}}class e{constructor(t,K){this._points=new Array,this._length=0,this.closed=!1,this._points.push(new N.I9(t,K))}addLineTo(t,K){if(this.closed)return this;const D=new N.I9(t,K),a=this._points[this._points.length-1];return this._points.push(D),this._length+=D.subtract(a).length(),this}addArcTo(t,K,D,a,G=36){if(this.closed)return this;const W=this._points[this._points.length-1],x=new N.I9(t,K),b=new N.I9(D,a),e=new n(W,x,b);let i=e.angle.radians()/G;0===e.orientation&&(i*=-1);let z=e.startAngle.radians()+i;for(let t=0;t<G;t++){const t=Math.cos(z)*e.radius+e.centerPoint.x,K=Math.sin(z)*e.radius+e.centerPoint.y;this.addLineTo(t,K),z+=i}return this}addQuadraticCurveTo(t,K,D,a,G=36){if(this.closed)return this;const N=(t,K,D,a)=>(1-t)*(1-t)*K+2*t*(1-t)*D+t*t*a,W=this._points[this._points.length-1];for(let x=0;x<=G;x++){const b=x/G,n=N(b,W.x,t,D),e=N(b,W.y,K,a);this.addLineTo(n,e)}return this}addBezierCurveTo(t,K,D,a,G,N,W=36){if(this.closed)return this;const x=(t,K,D,a,G)=>(1-t)*(1-t)*(1-t)*K+3*t*(1-t)*(1-t)*D+3*t*t*(1-t)*a+t*t*t*G,b=this._points[this._points.length-1];for(let n=0;n<=W;n++){const e=n/W,i=x(e,b.x,t,D,G),z=x(e,b.y,K,a,N);this.addLineTo(i,z)}return this}isPointInside(t){let K=!1;const D=this._points.length;for(let a=D-1,G=0;G<D;a=G++){let D=this._points[a],N=this._points[G],W=N.x-D.x,x=N.y-D.y;if(Math.abs(x)>Number.EPSILON){if(x<0&&(D=this._points[G],W=-W,N=this._points[a],x=-x),t.y<D.y||t.y>N.y)continue;if(t.y===D.y&&t.x===D.x)return!0;{const a=x*(t.x-D.x)-W*(t.y-D.y);if(0===a)return!0;if(a<0)continue;K=!K}}else{if(t.y!==D.y)continue;if(N.x<=t.x&&t.x<=D.x||D.x<=t.x&&t.x<=N.x)return!0}}return K}close(){return this.closed=!0,this}length(){let t=this._length;if(this.closed){const K=this._points[this._points.length-1];t+=this._points[0].subtract(K).length()}return t}area(){const t=this._points.length;let K=0;for(let D=t-1,a=0;a<t;D=a++)K+=this._points[D].x*this._points[a].y-this._points[a].x*this._points[D].y;return.5*K}getPoints(){return this._points}getPointAtLengthPosition(t){if(t<0||t>1)return N.I9.Zero();const K=t*this.length();let D=0;for(let t=0;t<this._points.length;t++){const a=(t+1)%this._points.length,G=this._points[t],W=this._points[a].subtract(G),x=W.length()+D;if(K>=D&&K<=x){const t=W.normalize(),a=K-D;return new N.I9(G.x+t.x*a,G.y+t.y*a)}D=x}return N.I9.Zero()}static StartingAt(t,K){return new e(t,K)}}class i{constructor(t,K=null,D,a=!1){this.path=t,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array,this._pointAtData={id:0,point:N.Pq.Zero(),previousPointArrayIndex:0,position:0,subPosition:0,interpolateReady:!1,interpolationMatrix:N.uq.Identity()};for(let K=0;K<t.length;K++)this._curve[K]=t[K].clone();this._raw=D||!1,this._alignTangentsWithPath=a,this._compute(K,a)}getCurve(){return this._curve}getPoints(){return this._curve}length(){return this._distances[this._distances.length-1]}getTangents(){return this._tangents}getNormals(){return this._normals}getBinormals(){return this._binormals}getDistances(){return this._distances}getPointAt(t){return this._updatePointAtData(t).point}getTangentAt(t,K=!1){return this._updatePointAtData(t,K),K?N.Pq.TransformCoordinates(N.Pq.Forward(),this._pointAtData.interpolationMatrix):this._tangents[this._pointAtData.previousPointArrayIndex]}getNormalAt(t,K=!1){return this._updatePointAtData(t,K),K?N.Pq.TransformCoordinates(N.Pq.Right(),this._pointAtData.interpolationMatrix):this._normals[this._pointAtData.previousPointArrayIndex]}getBinormalAt(t,K=!1){return this._updatePointAtData(t,K),K?N.Pq.TransformCoordinates(N.Pq.UpReadOnly,this._pointAtData.interpolationMatrix):this._binormals[this._pointAtData.previousPointArrayIndex]}getDistanceAt(t){return this.length()*t}getPreviousPointIndexAt(t){return this._updatePointAtData(t),this._pointAtData.previousPointArrayIndex}getSubPositionAt(t){return this._updatePointAtData(t),this._pointAtData.subPosition}getClosestPositionTo(t){let K=Number.MAX_VALUE,D=0;for(let a=0;a<this._curve.length-1;a++){const G=this._curve[a+0],W=this._curve[a+1].subtract(G).normalize(),x=this._distances[a+1]-this._distances[a+0],b=Math.min(Math.max(N.Pq.Dot(W,t.subtract(G).normalize()),0)*N.Pq.Distance(G,t)/x,1),n=N.Pq.Distance(G.add(W.scale(b*x)),t);n<K&&(K=n,D=(this._distances[a+0]+x*b)/this.length())}return D}slice(t=0,K=1){if(t<0&&(t=1- -1*t%1),K<0&&(K=1- -1*K%1),t>K){const D=t;t=K,K=D}const D=this.getCurve(),a=this.getPointAt(t);let G=this.getPreviousPointIndexAt(t);const N=this.getPointAt(K),W=this.getPreviousPointIndexAt(K)+1,x=[];return 0!==t&&(G++,x.push(a)),x.push(...D.slice(G,W)),1===K&&1!==t||x.push(N),new i(x,this.getNormalAt(t),this._raw,this._alignTangentsWithPath)}update(t,K=null,D=!1){for(let K=0;K<t.length;K++)this._curve[K].x=t[K].x,this._curve[K].y=t[K].y,this._curve[K].z=t[K].z;return this._compute(K,D),this}_compute(t,K=!1){const D=this._curve.length;if(D<2)return;this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[D-1]=this._curve[D-1].subtract(this._curve[D-2]),this._raw||this._tangents[D-1].normalize();const a=this._tangents[0],G=this._normalVector(a,t);let W,x,b,n,e;this._normals[0]=G,this._raw||this._normals[0].normalize(),this._binormals[0]=N.Pq.Cross(a,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;for(let t=1;t<D;t++)W=this._getLastNonNullVector(t),t<D-1&&(x=this._getFirstNonNullVector(t),this._tangents[t]=K?x:W.add(x),this._tangents[t].normalize()),this._distances[t]=this._distances[t-1]+this._curve[t].subtract(this._curve[t-1]).length(),b=this._tangents[t],e=this._binormals[t-1],this._normals[t]=N.Pq.Cross(e,b),this._raw||(0===this._normals[t].length()?(n=this._normals[t-1],this._normals[t]=n.clone()):this._normals[t].normalize()),this._binormals[t]=N.Pq.Cross(b,this._normals[t]),this._raw||this._binormals[t].normalize();this._pointAtData.id=NaN}_getFirstNonNullVector(t){let K=1,D=this._curve[t+K].subtract(this._curve[t]);for(;0===D.length()&&t+K+1<this._curve.length;)K++,D=this._curve[t+K].subtract(this._curve[t]);return D}_getLastNonNullVector(t){let K=1,D=this._curve[t].subtract(this._curve[t-K]);for(;0===D.length()&&t>K+1;)K++,D=this._curve[t].subtract(this._curve[t-K]);return D}_normalVector(t,K){let D,a=t.length();if(0===a&&(a=1),null==K){let K;K=G.X.WithinEpsilon(Math.abs(t.y)/a,1,W.bH)?G.X.WithinEpsilon(Math.abs(t.x)/a,1,W.bH)?G.X.WithinEpsilon(Math.abs(t.z)/a,1,W.bH)?N.Pq.Zero():new N.Pq(0,0,1):new N.Pq(1,0,0):new N.Pq(0,-1,0),D=N.Pq.Cross(t,K)}else D=N.Pq.Cross(t,K),N.Pq.CrossToRef(D,t,D);return D.normalize(),D}_updatePointAtData(t,K=!1){if(this._pointAtData.id===t)return this._pointAtData.interpolateReady||this._updateInterpolationMatrix(),this._pointAtData;this._pointAtData.id=t;const D=this.getPoints();if(t<=0)return this._setPointAtData(0,0,D[0],0,K);if(t>=1)return this._setPointAtData(1,1,D[D.length-1],D.length-1,K);let a,G=D[0],W=0;const x=t*this.length();for(let b=1;b<D.length;b++){a=D[b];const n=N.Pq.Distance(G,a);if(W+=n,W===x)return this._setPointAtData(t,1,a,b,K);if(W>x){const D=(W-x)/n,N=G.subtract(a),e=a.add(N.scaleInPlace(D));return this._setPointAtData(t,1-D,e,b-1,K)}G=a}return this._pointAtData}_setPointAtData(t,K,D,a,G){return this._pointAtData.point=D,this._pointAtData.position=t,this._pointAtData.subPosition=K,this._pointAtData.previousPointArrayIndex=a,this._pointAtData.interpolateReady=G,G&&this._updateInterpolationMatrix(),this._pointAtData}_updateInterpolationMatrix(){this._pointAtData.interpolationMatrix=N.uq.Identity();const t=this._pointAtData.previousPointArrayIndex;if(t!==this._tangents.length-1){const K=t+1,D=this._tangents[t].clone(),a=this._normals[t].clone(),G=this._binormals[t].clone(),W=this._tangents[K].clone(),x=this._normals[K].clone(),b=this._binormals[K].clone(),n=N.PT.RotationQuaternionFromAxis(a,G,D),e=N.PT.RotationQuaternionFromAxis(x,b,W);N.PT.Slerp(n,e,this._pointAtData.subPosition).toRotationMatrix(this._pointAtData.interpolationMatrix)}}}class z{static CreateQuadraticBezier(t,K,D,a){a=a>2?a:3;const G=[],W=(t,K,D,a)=>(1-t)*(1-t)*K+2*t*(1-t)*D+t*t*a;for(let x=0;x<=a;x++)G.push(new N.Pq(W(x/a,t.x,K.x,D.x),W(x/a,t.y,K.y,D.y),W(x/a,t.z,K.z,D.z)));return new z(G)}static CreateCubicBezier(t,K,D,a,G){G=G>3?G:4;const W=[],x=(t,K,D,a,G)=>(1-t)*(1-t)*(1-t)*K+3*t*(1-t)*(1-t)*D+3*t*t*(1-t)*a+t*t*t*G;for(let b=0;b<=G;b++)W.push(new N.Pq(x(b/G,t.x,K.x,D.x,a.x),x(b/G,t.y,K.y,D.y,a.y),x(b/G,t.z,K.z,D.z,a.z)));return new z(W)}static CreateHermiteSpline(t,K,D,a,G){const W=[],x=1/G;for(let b=0;b<=G;b++)W.push(N.Pq.Hermite(t,K,D,a,b*x));return new z(W)}static CreateCatmullRomSpline(t,K,D){const a=[],G=1/K;let W=0;if(D){const D=t.length;for(let x=0;x<D;x++){W=0;for(let b=0;b<K;b++)a.push(N.Pq.CatmullRom(t[x%D],t[(x+1)%D],t[(x+2)%D],t[(x+3)%D],W)),W+=G}a.push(a[0])}else{const D=[];D.push(t[0].clone()),Array.prototype.push.apply(D,t),D.push(t[t.length-1].clone());let x=0;for(;x<D.length-3;x++){W=0;for(let t=0;t<K;t++)a.push(N.Pq.CatmullRom(D[x],D[x+1],D[x+2],D[x+3],W)),W+=G}x--,a.push(N.Pq.CatmullRom(D[x],D[x+1],D[x+2],D[x+3],W))}return new z(a)}static ArcThru3Points(t,K,D,a=32,G=!1,W=!1){const x=[],b=K.subtract(t),n=D.subtract(K),e=t.subtract(D),i=N.Pq.Cross(b,n),I=i.length();if(I<Math.pow(10,-8))return new z(x);const Z=b.lengthSquared(),w=n.lengthSquared(),m=e.lengthSquared(),u=i.lengthSquared(),d=.5*b.length()*n.length()*e.length()/I,E=-.5*w*N.Pq.Dot(b,e)/u,l=-.5*m*N.Pq.Dot(b,n)/u,Q=-.5*Z*N.Pq.Dot(n,e)/u,P=t.scale(E).add(K.scale(l)).add(D.scale(Q)),y=t.subtract(P).normalize(),q=N.Pq.Cross(i,y).normalize();if(W){const K=2*Math.PI/a;for(let t=0;t<=2*Math.PI;t+=K)x.push(P.add(y.scale(d*Math.cos(t)).add(q.scale(d*Math.sin(t)))));x.push(t)}else{const K=1/a;let W=0,b=N.Pq.Zero();do{b=P.add(y.scale(d*Math.cos(W)).add(q.scale(d*Math.sin(W)))),x.push(b),W+=K}while(!b.equalsWithEpsilon(D,d*K*1.1));x.push(D),G&&x.push(t)}return new z(x)}constructor(t){this._length=0,this._points=t,this._length=this._computeLength(t)}getPoints(){return this._points}length(){return this._length}continue(t){const K=this._points[this._points.length-1],D=this._points.slice(),a=t.getPoints();for(let t=1;t<a.length;t++)D.push(a[t].subtract(a[0]).add(K));return new z(D)}_computeLength(t){let K=0;for(let D=1;D<t.length;D++)K+=t[D].subtract(t[D-1]).length();return K}}},298039:(t,K,D)=>{D.d(K,{Z:()=>G});var a=D(604910);class G{constructor(t,K,D,G){this.normal=new a.Pq(t,K,D),this.d=G}asArray(){return[this.normal.x,this.normal.y,this.normal.z,this.d]}clone(){return new G(this.normal.x,this.normal.y,this.normal.z,this.d)}getClassName(){return"Plane"}getHashCode(){let t=this.normal.getHashCode();return t=397*t^(0|this.d),t}normalize(){const t=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z);let K=0;return 0!==t&&(K=1/t),this.normal.x*=K,this.normal.y*=K,this.normal.z*=K,this.d*=K,this}transform(t){const K=G._TmpMatrix;t.invertToRef(K);const D=K.m,a=this.normal.x,N=this.normal.y,W=this.normal.z,x=this.d,b=a*D[0]+N*D[1]+W*D[2]+x*D[3],n=a*D[4]+N*D[5]+W*D[6]+x*D[7],e=a*D[8]+N*D[9]+W*D[10]+x*D[11],i=a*D[12]+N*D[13]+W*D[14]+x*D[15];return new G(b,n,e,i)}dotCoordinate(t){return this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z+this.d}copyFromPoints(t,K,D){const a=K.x-t.x,G=K.y-t.y,N=K.z-t.z,W=D.x-t.x,x=D.y-t.y,b=D.z-t.z,n=G*b-N*x,e=N*W-a*b,i=a*x-G*W,z=Math.sqrt(n*n+e*e+i*i);let I;return I=0!==z?1/z:0,this.normal.x=n*I,this.normal.y=e*I,this.normal.z=i*I,this.d=-(this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z),this}isFrontFacingTo(t,K){return a.Pq.Dot(this.normal,t)<=K}signedDistanceTo(t){return a.Pq.Dot(t,this.normal)+this.d}static FromArray(t){return new G(t[0],t[1],t[2],t[3])}static FromPoints(t,K,D){const a=new G(0,0,0,0);return a.copyFromPoints(t,K,D),a}static FromPositionAndNormal(t,K){const D=new G(0,0,0,0);return this.FromPositionAndNormalToRef(t,K,D)}static FromPositionAndNormalToRef(t,K,D){return D.normal.copyFrom(K),D.normal.normalize(),D.d=-t.dot(D.normal),D}static SignedDistanceToPlaneFromPositionAndNormal(t,K,D){const G=-(K.x*t.x+K.y*t.y+K.z*t.z);return a.Pq.Dot(D,K)+G}}G._TmpMatrix=a.uq.Identity()},241082:(t,K,D)=>{function a(t,K,D=1401298e-51){return Math.abs(t-K)<=D}function G(t,K){return t===K?t:Math.random()*(K-t)+t}function N(t,K,D){return t+(K-t)*D}function W(t,K=0,D=1){return Math.min(D,Math.max(K,t))}function x(t){return t-2*Math.PI*Math.floor((t+Math.PI)/(2*Math.PI))}function b(t){const K=t.toString(16);return t<=15?("0"+K).toUpperCase():K.toUpperCase()}D.d(K,{Db:()=>b,Mj:()=>a,OQ:()=>W,VD:()=>G,cP:()=>N,ed:()=>x})},615473:(t,K,D)=>{D.d(K,{X:()=>G});var a=D(241082);class G{static Sign(t){return 0==(t=+t)||isNaN(t)?t:t>0?1:-1}static Log2(t){return Math.log(t)*Math.LOG2E}static ILog2(t){if(Math.log2)return Math.floor(Math.log2(t));if(t<0)return NaN;if(0===t)return-1/0;let K=0;if(t<1){for(;t<1;)K++,t*=2;K=-K}else if(t>1)for(;t>1;)K++,t=Math.floor(t/2);return K}static Repeat(t,K){return t-Math.floor(t/K)*K}static Normalize(t,K,D){return(t-K)/(D-K)}static Denormalize(t,K,D){return t*(D-K)+K}static DeltaAngle(t,K){let D=G.Repeat(K-t,360);return D>180&&(D-=360),D}static PingPong(t,K){const D=G.Repeat(t,2*K);return K-Math.abs(D-K)}static SmoothStep(t,K,D){let a=G.Clamp(D);return a=-2*a*a*a+3*a*a,K*a+t*(1-a)}static MoveTowards(t,K,D){let a=0;return a=Math.abs(K-t)<=D?K:t+G.Sign(K-t)*D,a}static MoveTowardsAngle(t,K,D){const a=G.DeltaAngle(t,K);let N=0;return-D<a&&a<D?N=K:(K=t+a,N=G.MoveTowards(t,K,D)),N}static LerpAngle(t,K,D){let N=G.Repeat(K-t,360);return N>180&&(N-=360),t+N*a.OQ(D)}static InverseLerp(t,K,D){let G=0;return G=t!=K?a.OQ((D-t)/(K-t)):0,G}static Hermite(t,K,D,a,G){const N=G*G,W=G*N;return t*(2*W-3*N+1)+D*(-2*W+3*N)+K*(W-2*N+G)+a*(W-N)}static Hermite1stDerivative(t,K,D,a,G){const N=G*G;return 6*(N-G)*t+(3*N-4*G+1)*K+6*(-N+G)*D+(3*N-2*G)*a}static RangeToPercent(t,K,D){return(t-K)/(D-K)}static PercentToRange(t,K,D){return(D-K)*t+K}static HCF(t,K){const D=t%K;return 0===D?K:G.HCF(K,D)}}G.TwoPi=2*Math.PI,G.WithinEpsilon=a.Mj,G.ToHex=a.Db,G.Clamp=a.OQ,G.Lerp=a.cP,G.RandomRange=a.VD,G.NormalizeRadians=a.ed},500556:(t,K,D)=>{D.d(K,{o:()=>a});class a{constructor(t,K){this.width=t,this.height=K}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let t=0|this.width;return t=397*t^(0|this.height),t}copyFrom(t){this.width=t.width,this.height=t.height}copyFromFloats(t,K){return this.width=t,this.height=K,this}set(t,K){return this.copyFromFloats(t,K)}multiplyByFloats(t,K){return new a(this.width*t,this.height*K)}clone(){return new a(this.width,this.height)}equals(t){return!!t&&this.width===t.width&&this.height===t.height}get surface(){return this.width*this.height}static Zero(){return new a(0,0)}add(t){return new a(this.width+t.width,this.height+t.height)}subtract(t){return new a(this.width-t.width,this.height-t.height)}scale(t){return new a(this.width*t,this.height*t)}static Lerp(t,K,D){const G=t.width+(K.width-t.width)*D,N=t.height+(K.height-t.height)*D;return new a(G,N)}}},604910:(t,K,D)=>{D.d(K,{AA:()=>m,I9:()=>e,IU:()=>z,PT:()=>I,Pq:()=>i,uq:()=>Z});var a=D(779908),G=D(967872),N=D(310035),W=D(155429),x=D(395726),b=D(241082);const n=t=>parseInt(t.toString().replace(/\W/g,""));class e{constructor(t=0,K=0){this.x=t,this.y=K}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let t=n(this.x);return t=397*t^n(this.y),t}toArray(t,K=0){return t[K]=this.x,t[K+1]=this.y,this}fromArray(t,K=0){return e.FromArrayToRef(t,K,this),this}asArray(){return[this.x,this.y]}copyFrom(t){return this.x=t.x,this.y=t.y,this}copyFromFloats(t,K){return this.x=t,this.y=K,this}set(t,K){return this.copyFromFloats(t,K)}setAll(t){return this.copyFromFloats(t,t)}add(t){return new e(this.x+t.x,this.y+t.y)}addToRef(t,K){return K.x=this.x+t.x,K.y=this.y+t.y,K}addInPlace(t){return this.x+=t.x,this.y+=t.y,this}addInPlaceFromFloats(t,K){return this.x+=t,this.y+=K,this}addVector3(t){return new e(this.x+t.x,this.y+t.y)}subtract(t){return new e(this.x-t.x,this.y-t.y)}subtractToRef(t,K){return K.x=this.x-t.x,K.y=this.y-t.y,K}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this}multiply(t){return new e(this.x*t.x,this.y*t.y)}multiplyToRef(t,K){return K.x=this.x*t.x,K.y=this.y*t.y,K}multiplyByFloats(t,K){return new e(this.x*t,this.y*K)}divide(t){return new e(this.x/t.x,this.y/t.y)}divideToRef(t,K){return K.x=this.x/t.x,K.y=this.y/t.y,K}divideInPlace(t){return this.x=this.x/t.x,this.y=this.y/t.y,this}minimizeInPlace(t){return this.minimizeInPlaceFromFloats(t.x,t.y)}maximizeInPlace(t){return this.maximizeInPlaceFromFloats(t.x,t.y)}minimizeInPlaceFromFloats(t,K){return this.x=Math.min(t,this.x),this.y=Math.min(K,this.y),this}maximizeInPlaceFromFloats(t,K){return this.x=Math.max(t,this.x),this.y=Math.max(K,this.y),this}subtractFromFloats(t,K){return new e(this.x-t,this.y-K)}subtractFromFloatsToRef(t,K,D){return D.x=this.x-t,D.y=this.y-K,D}negate(){return new e(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(t){return t.x=-this.x,t.y=-this.y,t}scaleInPlace(t){return this.x*=t,this.y*=t,this}scale(t){return new e(this.x*t,this.y*t)}scaleToRef(t,K){return K.x=this.x*t,K.y=this.y*t,K}scaleAndAddToRef(t,K){return K.x+=this.x*t,K.y+=this.y*t,K}equals(t){return t&&this.x===t.x&&this.y===t.y}equalsWithEpsilon(t,K=a.bH){return t&&b.Mj(this.x,t.x,K)&&b.Mj(this.y,t.y,K)}equalsToFloats(t,K){return this.x===t&&this.y===K}floor(){return new e(Math.floor(this.x),Math.floor(this.y))}floorToRef(t){return t.x=Math.floor(this.x),t.y=Math.floor(this.y),t}fract(){return new e(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}fractToRef(t){return t.x=this.x-Math.floor(this.x),t.y=this.y-Math.floor(this.y),t}rotateToRef(t,K){const D=Math.cos(t),a=Math.sin(t),G=D*this.x-a*this.y,N=a*this.x+D*this.y;return K.x=G,K.y=N,K}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(t){return 0===t||1===t?this:this.scaleInPlace(1/t)}normalizeToNew(){const t=new e;return this.normalizeToRef(t),t}normalizeToRef(t){const K=this.length();return 0===K&&(t.x=this.x,t.y=this.y),this.scaleToRef(1/K,t)}clone(){return new e(this.x,this.y)}dot(t){return this.x*t.x+this.y*t.y}static Zero(){return new e(0,0)}static One(){return new e(1,1)}static Random(t=0,K=1){return new e(b.VD(t,K),b.VD(t,K))}static RandomToRef(t=0,K=1,D){return D.copyFromFloats(b.VD(t,K),b.VD(t,K))}static get ZeroReadOnly(){return e._ZeroReadOnly}static FromArray(t,K=0){return new e(t[K],t[K+1])}static FromArrayToRef(t,K,D){return D.x=t[K],D.y=t[K+1],D}static FromFloatsToRef(t,K,D){return D.copyFromFloats(t,K),D}static CatmullRom(t,K,D,a,G){const N=G*G,W=G*N,x=.5*(2*K.x+(-t.x+D.x)*G+(2*t.x-5*K.x+4*D.x-a.x)*N+(-t.x+3*K.x-3*D.x+a.x)*W),b=.5*(2*K.y+(-t.y+D.y)*G+(2*t.y-5*K.y+4*D.y-a.y)*N+(-t.y+3*K.y-3*D.y+a.y)*W);return new e(x,b)}static ClampToRef(t,K,D,a){return a.x=b.OQ(t.x,K.x,D.x),a.y=b.OQ(t.y,K.y,D.y),a}static Clamp(t,K,D){const a=b.OQ(t.x,K.x,D.x),G=b.OQ(t.y,K.y,D.y);return new e(a,G)}static Hermite(t,K,D,a,G){const N=G*G,W=G*N,x=2*W-3*N+1,b=-2*W+3*N,n=W-2*N+G,i=W-N,z=t.x*x+D.x*b+K.x*n+a.x*i,I=t.y*x+D.y*b+K.y*n+a.y*i;return new e(z,I)}static Hermite1stDerivative(t,K,D,a,G){return this.Hermite1stDerivativeToRef(t,K,D,a,G,new e)}static Hermite1stDerivativeToRef(t,K,D,a,G,N){const W=G*G;return N.x=6*(W-G)*t.x+(3*W-4*G+1)*K.x+6*(-W+G)*D.x+(3*W-2*G)*a.x,N.y=6*(W-G)*t.y+(3*W-4*G+1)*K.y+6*(-W+G)*D.y+(3*W-2*G)*a.y,N}static Lerp(t,K,D){return e.LerpToRef(t,K,D,new e)}static LerpToRef(t,K,D,a){return a.x=t.x+(K.x-t.x)*D,a.y=t.y+(K.y-t.y)*D,a}static Dot(t,K){return t.x*K.x+t.y*K.y}static Normalize(t){return e.NormalizeToRef(t,new e)}static NormalizeToRef(t,K){return t.normalizeToRef(K),K}static Minimize(t,K){const D=t.x<K.x?t.x:K.x,a=t.y<K.y?t.y:K.y;return new e(D,a)}static Maximize(t,K){const D=t.x>K.x?t.x:K.x,a=t.y>K.y?t.y:K.y;return new e(D,a)}static Transform(t,K){return e.TransformToRef(t,K,new e)}static TransformToRef(t,K,D){const a=K.m,G=t.x*a[0]+t.y*a[4]+a[12],N=t.x*a[1]+t.y*a[5]+a[13];return D.x=G,D.y=N,D}static PointInTriangle(t,K,D,a){const G=1/2*(-D.y*a.x+K.y*(-D.x+a.x)+K.x*(D.y-a.y)+D.x*a.y),N=G<0?-1:1,W=(K.y*a.x-K.x*a.y+(a.y-K.y)*t.x+(K.x-a.x)*t.y)*N,x=(K.x*D.y-K.y*D.x+(K.y-D.y)*t.x+(D.x-K.x)*t.y)*N;return W>0&&x>0&&W+x<2*G*N}static Distance(t,K){return Math.sqrt(e.DistanceSquared(t,K))}static DistanceSquared(t,K){const D=t.x-K.x,a=t.y-K.y;return D*D+a*a}static Center(t,K){return e.CenterToRef(t,K,new e)}static CenterToRef(t,K,D){return D.copyFromFloats((t.x+K.x)/2,(t.y+K.y)/2)}static DistanceOfPointFromSegment(t,K,D){const a=e.DistanceSquared(K,D);if(0===a)return e.Distance(t,K);const G=D.subtract(K),N=Math.max(0,Math.min(1,e.Dot(t.subtract(K),G)/a)),W=K.add(G.multiplyByFloats(N,N));return e.Distance(t,W)}}e._ZeroReadOnly=e.Zero(),Object.defineProperties(e.prototype,{dimension:{value:[2]},rank:{value:1}});class i{get x(){return this._x}set x(t){this._x=t,this._isDirty=!0}get y(){return this._y}set y(t){this._y=t,this._isDirty=!0}get z(){return this._z}set z(t){this._z=t,this._isDirty=!0}constructor(t=0,K=0,D=0){this._isDirty=!0,this._x=t,this._y=K,this._z=D}toString(){return`{X: ${this._x} Y: ${this._y} Z: ${this._z}}`}getClassName(){return"Vector3"}getHashCode(){let t=n(this._x);return t=397*t^n(this._y),t=397*t^n(this._z),t}asArray(){return[this._x,this._y,this._z]}toArray(t,K=0){return t[K]=this._x,t[K+1]=this._y,t[K+2]=this._z,this}fromArray(t,K=0){return i.FromArrayToRef(t,K,this),this}toQuaternion(){return I.RotationYawPitchRoll(this._y,this._x,this._z)}addInPlace(t){return this._x+=t._x,this._y+=t._y,this._z+=t._z,this._isDirty=!0,this}addInPlaceFromFloats(t,K,D){return this._x+=t,this._y+=K,this._z+=D,this._isDirty=!0,this}add(t){return new i(this._x+t._x,this._y+t._y,this._z+t._z)}addToRef(t,K){return K._x=this._x+t._x,K._y=this._y+t._y,K._z=this._z+t._z,K._isDirty=!0,K}subtractInPlace(t){return this._x-=t._x,this._y-=t._y,this._z-=t._z,this._isDirty=!0,this}subtract(t){return new i(this._x-t._x,this._y-t._y,this._z-t._z)}subtractToRef(t,K){return this.subtractFromFloatsToRef(t._x,t._y,t._z,K)}subtractFromFloats(t,K,D){return new i(this._x-t,this._y-K,this._z-D)}subtractFromFloatsToRef(t,K,D,a){return a._x=this._x-t,a._y=this._y-K,a._z=this._z-D,a._isDirty=!0,a}negate(){return new i(-this._x,-this._y,-this._z)}negateInPlace(){return this._x*=-1,this._y*=-1,this._z*=-1,this._isDirty=!0,this}negateToRef(t){return t._x=-1*this._x,t._y=-1*this._y,t._z=-1*this._z,t._isDirty=!0,t}scaleInPlace(t){return this._x*=t,this._y*=t,this._z*=t,this._isDirty=!0,this}scale(t){return new i(this._x*t,this._y*t,this._z*t)}scaleToRef(t,K){return K._x=this._x*t,K._y=this._y*t,K._z=this._z*t,K._isDirty=!0,K}getNormalToRef(t){const K=this.length();let D=Math.acos(this.y/K);const a=Math.atan2(this.z,this.x);D>Math.PI/2?D-=Math.PI/2:D+=Math.PI/2;const G=K*Math.sin(D)*Math.cos(a),N=K*Math.cos(D),W=K*Math.sin(D)*Math.sin(a);return t.set(G,N,W),t}applyRotationQuaternionToRef(t,K){const D=this._x,a=this._y,G=this._z,N=t._x,W=t._y,x=t._z,b=t._w,n=2*(W*G-x*a),e=2*(x*D-N*G),i=2*(N*a-W*D);return K._x=D+b*n+W*i-x*e,K._y=a+b*e+x*n-N*i,K._z=G+b*i+N*e-W*n,K._isDirty=!0,K}applyRotationQuaternionInPlace(t){return this.applyRotationQuaternionToRef(t,this)}applyRotationQuaternion(t){return this.applyRotationQuaternionToRef(t,new i)}scaleAndAddToRef(t,K){return K._x+=this._x*t,K._y+=this._y*t,K._z+=this._z*t,K._isDirty=!0,K}projectOnPlane(t,K){return this.projectOnPlaneToRef(t,K,new i)}projectOnPlaneToRef(t,K,D){const a=t.normal,G=t.d,N=w.Vector3[0];this.subtractToRef(K,N),N.normalize();const W=i.Dot(N,a);if(Math.abs(W)<1e-10)D.setAll(1/0);else{const t=-(i.Dot(K,a)+G)/W,x=N.scaleInPlace(t);K.addToRef(x,D)}return D}equals(t){return t&&this._x===t._x&&this._y===t._y&&this._z===t._z}equalsWithEpsilon(t,K=a.bH){return t&&b.Mj(this._x,t._x,K)&&b.Mj(this._y,t._y,K)&&b.Mj(this._z,t._z,K)}equalsToFloats(t,K,D){return this._x===t&&this._y===K&&this._z===D}multiplyInPlace(t){return this._x*=t._x,this._y*=t._y,this._z*=t._z,this._isDirty=!0,this}multiply(t){return this.multiplyByFloats(t._x,t._y,t._z)}multiplyToRef(t,K){return K._x=this._x*t._x,K._y=this._y*t._y,K._z=this._z*t._z,K._isDirty=!0,K}multiplyByFloats(t,K,D){return new i(this._x*t,this._y*K,this._z*D)}divide(t){return new i(this._x/t._x,this._y/t._y,this._z/t._z)}divideToRef(t,K){return K._x=this._x/t._x,K._y=this._y/t._y,K._z=this._z/t._z,K._isDirty=!0,K}divideInPlace(t){return this._x=this._x/t._x,this._y=this._y/t._y,this._z=this._z/t._z,this._isDirty=!0,this}minimizeInPlace(t){return this.minimizeInPlaceFromFloats(t._x,t._y,t._z)}maximizeInPlace(t){return this.maximizeInPlaceFromFloats(t._x,t._y,t._z)}minimizeInPlaceFromFloats(t,K,D){return t<this._x&&(this.x=t),K<this._y&&(this.y=K),D<this._z&&(this.z=D),this}maximizeInPlaceFromFloats(t,K,D){return t>this._x&&(this.x=t),K>this._y&&(this.y=K),D>this._z&&(this.z=D),this}isNonUniformWithinEpsilon(t){const K=Math.abs(this._x),D=Math.abs(this._y);if(!b.Mj(K,D,t))return!0;const a=Math.abs(this._z);return!b.Mj(K,a,t)||!b.Mj(D,a,t)}get isNonUniform(){const t=Math.abs(this._x);return t!==Math.abs(this._y)||t!==Math.abs(this._z)}floorToRef(t){return t._x=Math.floor(this._x),t._y=Math.floor(this._y),t._z=Math.floor(this._z),t._isDirty=!0,t}floor(){return new i(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}fractToRef(t){return t._x=this.x-Math.floor(this._x),t._y=this.y-Math.floor(this._y),t._z=this.z-Math.floor(this._z),t._isDirty=!0,t}fract(){return new i(this.x-Math.floor(this._x),this.y-Math.floor(this._y),this.z-Math.floor(this._z))}length(){return Math.sqrt(this.lengthSquared())}lengthSquared(){return this._x*this._x+this._y*this._y+this._z*this._z}get hasAZeroComponent(){return this._x*this._y*this._z==0}normalize(){return this.normalizeFromLength(this.length())}reorderInPlace(t){if("xyz"===(t=t.toLowerCase()))return this;const K=w.Vector3[0].copyFrom(this);return this.x=K[t[0]],this.y=K[t[1]],this.z=K[t[2]],this}rotateByQuaternionToRef(t,K){return t.toRotationMatrix(w.Matrix[0]),i.TransformCoordinatesToRef(this,w.Matrix[0],K),K}rotateByQuaternionAroundPointToRef(t,K,D){return this.subtractToRef(K,w.Vector3[0]),w.Vector3[0].rotateByQuaternionToRef(t,w.Vector3[0]),K.addToRef(w.Vector3[0],D),D}cross(t){return i.CrossToRef(this,t,new i)}normalizeFromLength(t){return 0===t||1===t?this:this.scaleInPlace(1/t)}normalizeToNew(){return this.normalizeToRef(new i)}normalizeToRef(t){const K=this.length();return 0===K||1===K?(t._x=this._x,t._y=this._y,t._z=this._z,t._isDirty=!0,t):this.scaleToRef(1/K,t)}clone(){return new i(this._x,this._y,this._z)}copyFrom(t){return this.copyFromFloats(t._x,t._y,t._z)}copyFromFloats(t,K,D){return this._x=t,this._y=K,this._z=D,this._isDirty=!0,this}set(t,K,D){return this.copyFromFloats(t,K,D)}setAll(t){return this._x=this._y=this._z=t,this._isDirty=!0,this}static GetClipFactor(t,K,D,a){const G=i.Dot(t,D);return(G-a)/(G-i.Dot(K,D))}static GetAngleBetweenVectors(t,K,D){const a=t.normalizeToRef(w.Vector3[1]),G=K.normalizeToRef(w.Vector3[2]);let N=i.Dot(a,G);N=b.OQ(N,-1,1);const W=Math.acos(N),x=w.Vector3[3];return i.CrossToRef(a,G,x),i.Dot(x,D)>0?isNaN(W)?0:W:isNaN(W)?-Math.PI:-Math.acos(N)}static GetAngleBetweenVectorsOnPlane(t,K,D){w.Vector3[0].copyFrom(t);const a=w.Vector3[0];w.Vector3[1].copyFrom(K);const G=w.Vector3[1];w.Vector3[2].copyFrom(D);const N=w.Vector3[2],W=w.Vector3[3],x=w.Vector3[4];a.normalize(),G.normalize(),N.normalize(),i.CrossToRef(N,a,W),i.CrossToRef(W,N,x);const n=Math.atan2(i.Dot(G,W),i.Dot(G,x));return b.ed(n)}static PitchYawRollToMoveBetweenPointsToRef(t,K,D){const a=m.Vector3[0];return K.subtractToRef(t,a),D._y=Math.atan2(a.x,a.z)||0,D._x=Math.atan2(Math.sqrt(a.x**2+a.z**2),a.y)||0,D._z=0,D._isDirty=!0,D}static PitchYawRollToMoveBetweenPoints(t,K){const D=i.Zero();return i.PitchYawRollToMoveBetweenPointsToRef(t,K,D)}static SlerpToRef(t,K,D,G){D=b.OQ(D,0,1);const N=w.Vector3[0],W=w.Vector3[1];N.copyFrom(t);const x=N.length();N.normalizeFromLength(x),W.copyFrom(K);const n=W.length();W.normalizeFromLength(n);const e=i.Dot(N,W);let z,I;if(e<1-a.bH){const t=Math.acos(e),K=1/Math.sin(t);z=Math.sin((1-D)*t)*K,I=Math.sin(D*t)*K}else z=1-D,I=D;return N.scaleInPlace(z),W.scaleInPlace(I),G.copyFrom(N).addInPlace(W),G.scaleInPlace(b.cP(x,n,D)),G}static SmoothToRef(t,K,D,a,G){return i.SlerpToRef(t,K,0===a?1:D/a,G),G}static FromArray(t,K=0){return new i(t[K],t[K+1],t[K+2])}static FromFloatArray(t,K){return i.FromArray(t,K)}static FromArrayToRef(t,K,D){return D._x=t[K],D._y=t[K+1],D._z=t[K+2],D._isDirty=!0,D}static FromFloatArrayToRef(t,K,D){return i.FromArrayToRef(t,K,D)}static FromFloatsToRef(t,K,D,a){return a.copyFromFloats(t,K,D),a}static Zero(){return new i(0,0,0)}static One(){return new i(1,1,1)}static Up(){return new i(0,1,0)}static get UpReadOnly(){return i._UpReadOnly}static get DownReadOnly(){return i._DownReadOnly}static get RightReadOnly(){return i._RightReadOnly}static get LeftReadOnly(){return i._LeftReadOnly}static get LeftHandedForwardReadOnly(){return i._LeftHandedForwardReadOnly}static get RightHandedForwardReadOnly(){return i._RightHandedForwardReadOnly}static get LeftHandedBackwardReadOnly(){return i._LeftHandedBackwardReadOnly}static get RightHandedBackwardReadOnly(){return i._RightHandedBackwardReadOnly}static get ZeroReadOnly(){return i._ZeroReadOnly}static get OneReadOnly(){return i._OneReadOnly}static Down(){return new i(0,-1,0)}static Forward(t=!1){return new i(0,0,t?-1:1)}static Backward(t=!1){return new i(0,0,t?1:-1)}static Right(){return new i(1,0,0)}static Left(){return new i(-1,0,0)}static Random(t=0,K=1){return new i(b.VD(t,K),b.VD(t,K),b.VD(t,K))}static RandomToRef(t=0,K=1,D){return D.copyFromFloats(b.VD(t,K),b.VD(t,K),b.VD(t,K))}static TransformCoordinates(t,K){const D=i.Zero();return i.TransformCoordinatesToRef(t,K,D),D}static TransformCoordinatesToRef(t,K,D){return i.TransformCoordinatesFromFloatsToRef(t._x,t._y,t._z,K,D),D}static TransformCoordinatesFromFloatsToRef(t,K,D,a,G){const N=a.m,W=t*N[0]+K*N[4]+D*N[8]+N[12],x=t*N[1]+K*N[5]+D*N[9]+N[13],b=t*N[2]+K*N[6]+D*N[10]+N[14],n=1/(t*N[3]+K*N[7]+D*N[11]+N[15]);return G._x=W*n,G._y=x*n,G._z=b*n,G._isDirty=!0,G}static TransformNormal(t,K){const D=i.Zero();return i.TransformNormalToRef(t,K,D),D}static TransformNormalToRef(t,K,D){return this.TransformNormalFromFloatsToRef(t._x,t._y,t._z,K,D),D}static TransformNormalFromFloatsToRef(t,K,D,a,G){const N=a.m;return G._x=t*N[0]+K*N[4]+D*N[8],G._y=t*N[1]+K*N[5]+D*N[9],G._z=t*N[2]+K*N[6]+D*N[10],G._isDirty=!0,G}static CatmullRom(t,K,D,a,G){const N=G*G,W=G*N,x=.5*(2*K._x+(-t._x+D._x)*G+(2*t._x-5*K._x+4*D._x-a._x)*N+(-t._x+3*K._x-3*D._x+a._x)*W),b=.5*(2*K._y+(-t._y+D._y)*G+(2*t._y-5*K._y+4*D._y-a._y)*N+(-t._y+3*K._y-3*D._y+a._y)*W),n=.5*(2*K._z+(-t._z+D._z)*G+(2*t._z-5*K._z+4*D._z-a._z)*N+(-t._z+3*K._z-3*D._z+a._z)*W);return new i(x,b,n)}static Clamp(t,K,D){const a=new i;return i.ClampToRef(t,K,D,a),a}static ClampToRef(t,K,D,a){let G=t._x;G=G>D._x?D._x:G,G=G<K._x?K._x:G;let N=t._y;N=N>D._y?D._y:N,N=N<K._y?K._y:N;let W=t._z;return W=W>D._z?D._z:W,W=W<K._z?K._z:W,a.copyFromFloats(G,N,W),a}static CheckExtends(t,K,D){K.minimizeInPlace(t),D.maximizeInPlace(t)}static Hermite(t,K,D,a,G){const N=G*G,W=G*N,x=2*W-3*N+1,b=-2*W+3*N,n=W-2*N+G,e=W-N,z=t._x*x+D._x*b+K._x*n+a._x*e,I=t._y*x+D._y*b+K._y*n+a._y*e,Z=t._z*x+D._z*b+K._z*n+a._z*e;return new i(z,I,Z)}static Hermite1stDerivative(t,K,D,a,G){const N=new i;return this.Hermite1stDerivativeToRef(t,K,D,a,G,N),N}static Hermite1stDerivativeToRef(t,K,D,a,G,N){const W=G*G;return N._x=6*(W-G)*t._x+(3*W-4*G+1)*K._x+6*(-W+G)*D._x+(3*W-2*G)*a._x,N._y=6*(W-G)*t._y+(3*W-4*G+1)*K._y+6*(-W+G)*D._y+(3*W-2*G)*a._y,N._z=6*(W-G)*t._z+(3*W-4*G+1)*K._z+6*(-W+G)*D._z+(3*W-2*G)*a._z,N._isDirty=!0,N}static Lerp(t,K,D){const a=new i(0,0,0);return i.LerpToRef(t,K,D,a),a}static LerpToRef(t,K,D,a){return a._x=t._x+(K._x-t._x)*D,a._y=t._y+(K._y-t._y)*D,a._z=t._z+(K._z-t._z)*D,a._isDirty=!0,a}static Dot(t,K){return t._x*K._x+t._y*K._y+t._z*K._z}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z}static Cross(t,K){const D=new i;return i.CrossToRef(t,K,D),D}static CrossToRef(t,K,D){const a=t._y*K._z-t._z*K._y,G=t._z*K._x-t._x*K._z,N=t._x*K._y-t._y*K._x;return D.copyFromFloats(a,G,N),D}static Normalize(t){const K=i.Zero();return i.NormalizeToRef(t,K),K}static NormalizeToRef(t,K){return t.normalizeToRef(K),K}static Project(t,K,D,a){const G=new i;return i.ProjectToRef(t,K,D,a,G),G}static ProjectToRef(t,K,D,a,G){var N;const W=a.width,b=a.height,n=a.x,e=a.y,z=w.Matrix[1],I=null===(N=x.q.LastCreatedEngine)||void 0===N?void 0:N.isNDCHalfZRange,m=I?1:.5,u=I?0:.5;Z.FromValuesToRef(W/2,0,0,0,0,-b/2,0,0,0,0,m,0,n+W/2,b/2+e,u,1,z);const d=w.Matrix[0];return K.multiplyToRef(D,d),d.multiplyToRef(z,d),i.TransformCoordinatesToRef(t,d,G),G}static Reflect(t,K){return this.ReflectToRef(t,K,new i)}static ReflectToRef(t,K,D){const a=m.Vector3[0];return a.copyFrom(K).scaleInPlace(2*i.Dot(t,K)),D.copyFrom(t).subtractInPlace(a)}static _UnprojectFromInvertedMatrixToRef(t,K,D){i.TransformCoordinatesToRef(t,K,D);const a=K.m,G=t._x*a[3]+t._y*a[7]+t._z*a[11]+a[15];return b.Mj(G,1)&&D.scaleInPlace(1/G),D}static UnprojectFromTransform(t,K,D,a,G){return this.Unproject(t,K,D,a,G,Z.IdentityReadOnly)}static Unproject(t,K,D,a,G,N){const W=new i;return i.UnprojectToRef(t,K,D,a,G,N,W),W}static UnprojectToRef(t,K,D,a,G,N,W){return i.UnprojectFloatsToRef(t._x,t._y,t._z,K,D,a,G,N,W),W}static UnprojectFloatsToRef(t,K,D,a,G,N,W,b,n){var e;const z=w.Matrix[0];N.multiplyToRef(W,z),z.multiplyToRef(b,z),z.invert();const I=w.Vector3[0];return I.x=t/a*2-1,I.y=-(K/G*2-1),(null===(e=x.q.LastCreatedEngine)||void 0===e?void 0:e.isNDCHalfZRange)?I.z=D:I.z=2*D-1,i._UnprojectFromInvertedMatrixToRef(I,z,n),n}static Minimize(t,K){const D=new i;return D.copyFrom(t),D.minimizeInPlace(K),D}static Maximize(t,K){const D=new i;return D.copyFrom(t),D.maximizeInPlace(K),D}static Distance(t,K){return Math.sqrt(i.DistanceSquared(t,K))}static DistanceSquared(t,K){const D=t._x-K._x,a=t._y-K._y,G=t._z-K._z;return D*D+a*a+G*G}static ProjectOnTriangleToRef(t,K,D,G,N){const W=w.Vector3[0],x=w.Vector3[1],n=w.Vector3[2],e=w.Vector3[3],z=w.Vector3[4];D.subtractToRef(K,W),G.subtractToRef(K,x),G.subtractToRef(D,n);const I=W.length(),Z=x.length(),m=n.length();if(I<a.bH||Z<a.bH||m<a.bH)return N.copyFrom(K),i.Distance(t,K);t.subtractToRef(K,z),i.CrossToRef(W,x,e);const u=e.length();if(u<a.bH)return N.copyFrom(K),i.Distance(t,K);e.normalizeFromLength(u);let d=z.length();if(d<a.bH)return N.copyFrom(K),0;z.normalizeFromLength(d);const E=i.Dot(e,z),l=w.Vector3[5],Q=w.Vector3[6];l.copyFrom(e).scaleInPlace(-d*E),Q.copyFrom(t).addInPlace(l);const P=w.Vector3[4],y=w.Vector3[5],q=w.Vector3[7],X=w.Vector3[8];P.copyFrom(W).scaleInPlace(1/I),X.copyFrom(x).scaleInPlace(1/Z),P.addInPlace(X).scaleInPlace(-1),y.copyFrom(W).scaleInPlace(-1/I),X.copyFrom(n).scaleInPlace(1/m),y.addInPlace(X).scaleInPlace(-1),q.copyFrom(n).scaleInPlace(-1/m),X.copyFrom(x).scaleInPlace(-1/Z),q.addInPlace(X).scaleInPlace(-1);const h=w.Vector3[9];let J;h.copyFrom(Q).subtractInPlace(K),i.CrossToRef(P,h,X),J=i.Dot(X,e);const T=J;h.copyFrom(Q).subtractInPlace(D),i.CrossToRef(y,h,X),J=i.Dot(X,e);const _=J;h.copyFrom(Q).subtractInPlace(G),i.CrossToRef(q,h,X),J=i.Dot(X,e);const C=J,H=w.Vector3[10];let o,U;T>0&&_<0?(H.copyFrom(W),o=K,U=D):_>0&&C<0?(H.copyFrom(n),o=D,U=G):(H.copyFrom(x).scaleInPlace(-1),o=G,U=K);const V=w.Vector3[9],s=w.Vector3[4];if(o.subtractToRef(Q,X),U.subtractToRef(Q,V),i.CrossToRef(X,V,s),!(i.Dot(s,e)<0))return N.copyFrom(Q),Math.abs(d*E);const F=w.Vector3[5];i.CrossToRef(H,s,F),F.normalize();const c=w.Vector3[9];c.copyFrom(o).subtractInPlace(Q);const g=c.length();if(g<a.bH)return N.copyFrom(o),i.Distance(t,o);c.normalizeFromLength(g);const R=i.Dot(F,c),A=w.Vector3[7];A.copyFrom(Q).addInPlace(F.scaleInPlace(g*R)),X.copyFrom(A).subtractInPlace(o),d=H.length(),H.normalizeFromLength(d);let Y=i.Dot(X,H)/Math.max(d,a.bH);return Y=b.OQ(Y,0,1),A.copyFrom(o).addInPlace(H.scaleInPlace(Y*d)),N.copyFrom(A),i.Distance(t,A)}static Center(t,K){return i.CenterToRef(t,K,i.Zero())}static CenterToRef(t,K,D){return D.copyFromFloats((t._x+K._x)/2,(t._y+K._y)/2,(t._z+K._z)/2)}static RotationFromAxis(t,K,D){const a=new i;return i.RotationFromAxisToRef(t,K,D,a),a}static RotationFromAxisToRef(t,K,D,a){const G=w.Quaternion[0];return I.RotationQuaternionFromAxisToRef(t,K,D,G),G.toEulerAnglesToRef(a),a}}i._UpReadOnly=i.Up(),i._DownReadOnly=i.Down(),i._LeftHandedForwardReadOnly=i.Forward(!1),i._RightHandedForwardReadOnly=i.Forward(!0),i._LeftHandedBackwardReadOnly=i.Backward(!1),i._RightHandedBackwardReadOnly=i.Backward(!0),i._RightReadOnly=i.Right(),i._LeftReadOnly=i.Left(),i._ZeroReadOnly=i.Zero(),i._OneReadOnly=i.One(),Object.defineProperties(i.prototype,{dimension:{value:[3]},rank:{value:1}});class z{constructor(t=0,K=0,D=0,a=0){this.x=t,this.y=K,this.z=D,this.w=a}toString(){return`{X: ${this.x} Y: ${this.y} Z: ${this.z} W: ${this.w}}`}getClassName(){return"Vector4"}getHashCode(){let t=n(this.x);return t=397*t^n(this.y),t=397*t^n(this.z),t=397*t^n(this.w),t}asArray(){return[this.x,this.y,this.z,this.w]}toArray(t,K){return void 0===K&&(K=0),t[K]=this.x,t[K+1]=this.y,t[K+2]=this.z,t[K+3]=this.w,this}fromArray(t,K=0){return z.FromArrayToRef(t,K,this),this}addInPlace(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addInPlaceFromFloats(t,K,D,a){return this.x+=t,this.y+=K,this.z+=D,this.w+=a,this}add(t){return new z(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)}addToRef(t,K){return K.x=this.x+t.x,K.y=this.y+t.y,K.z=this.z+t.z,K.w=this.w+t.w,K}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subtract(t){return new z(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)}subtractToRef(t,K){return K.x=this.x-t.x,K.y=this.y-t.y,K.z=this.z-t.z,K.w=this.w-t.w,K}subtractFromFloats(t,K,D,a){return new z(this.x-t,this.y-K,this.z-D,this.w-a)}subtractFromFloatsToRef(t,K,D,a,G){return G.x=this.x-t,G.y=this.y-K,G.z=this.z-D,G.w=this.w-a,G}negate(){return new z(-this.x,-this.y,-this.z,-this.w)}negateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this.w*=-1,this}negateToRef(t){return t.x=-this.x,t.y=-this.y,t.z=-this.z,t.w=-this.w,t}scaleInPlace(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}scale(t){return new z(this.x*t,this.y*t,this.z*t,this.w*t)}scaleToRef(t,K){return K.x=this.x*t,K.y=this.y*t,K.z=this.z*t,K.w=this.w*t,K}scaleAndAddToRef(t,K){return K.x+=this.x*t,K.y+=this.y*t,K.z+=this.z*t,K.w+=this.w*t,K}equals(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w}equalsWithEpsilon(t,K=a.bH){return t&&b.Mj(this.x,t.x,K)&&b.Mj(this.y,t.y,K)&&b.Mj(this.z,t.z,K)&&b.Mj(this.w,t.w,K)}equalsToFloats(t,K,D,a){return this.x===t&&this.y===K&&this.z===D&&this.w===a}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiply(t){return new z(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)}multiplyToRef(t,K){return K.x=this.x*t.x,K.y=this.y*t.y,K.z=this.z*t.z,K.w=this.w*t.w,K}multiplyByFloats(t,K,D,a){return new z(this.x*t,this.y*K,this.z*D,this.w*a)}divide(t){return new z(this.x/t.x,this.y/t.y,this.z/t.z,this.w/t.w)}divideToRef(t,K){return K.x=this.x/t.x,K.y=this.y/t.y,K.z=this.z/t.z,K.w=this.w/t.w,K}divideInPlace(t){return this.divideToRef(t,this)}minimizeInPlace(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),t.w<this.w&&(this.w=t.w),this}maximizeInPlace(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),t.w>this.w&&(this.w=t.w),this}minimizeInPlaceFromFloats(t,K,D,a){return this.x=Math.min(t,this.x),this.y=Math.min(K,this.y),this.z=Math.min(D,this.z),this.w=Math.min(a,this.w),this}maximizeInPlaceFromFloats(t,K,D,a){return this.x=Math.max(t,this.x),this.y=Math.max(K,this.y),this.z=Math.max(D,this.z),this.w=Math.max(a,this.w),this}floorToRef(t){return t.x=Math.floor(this.x),t.y=Math.floor(this.y),t.z=Math.floor(this.z),t.w=Math.floor(this.w),t}floor(){return new z(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))}fractToRef(t){return t.x=this.x-Math.floor(this.x),t.y=this.y-Math.floor(this.y),t.z=this.z-Math.floor(this.z),t.w=this.w-Math.floor(this.w),t}fract(){return new z(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(t){return 0===t||1===t?this:this.scaleInPlace(1/t)}normalizeToNew(){return this.normalizeToRef(new z)}normalizeToRef(t){const K=this.length();return 0===K||1===K?(t.x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,t):this.scaleToRef(1/K,t)}toVector3(){return new i(this.x,this.y,this.z)}clone(){return new z(this.x,this.y,this.z,this.w)}copyFrom(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}copyFromFloats(t,K,D,a){return this.x=t,this.y=K,this.z=D,this.w=a,this}set(t,K,D,a){return this.copyFromFloats(t,K,D,a)}setAll(t){return this.x=this.y=this.z=this.w=t,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}static FromArray(t,K){return K||(K=0),new z(t[K],t[K+1],t[K+2],t[K+3])}static FromArrayToRef(t,K,D){return D.x=t[K],D.y=t[K+1],D.z=t[K+2],D.w=t[K+3],D}static FromFloatArrayToRef(t,K,D){return z.FromArrayToRef(t,K,D),D}static FromFloatsToRef(t,K,D,a,G){return G.x=t,G.y=K,G.z=D,G.w=a,G}static Zero(){return new z(0,0,0,0)}static One(){return new z(1,1,1,1)}static Random(t=0,K=1){return new z(b.VD(t,K),b.VD(t,K),b.VD(t,K),b.VD(t,K))}static RandomToRef(t=0,K=1,D){return D.x=b.VD(t,K),D.y=b.VD(t,K),D.z=b.VD(t,K),D.w=b.VD(t,K),D}static Clamp(t,K,D){return z.ClampToRef(t,K,D,new z)}static ClampToRef(t,K,D,a){return a.x=b.OQ(t.x,K.x,D.x),a.y=b.OQ(t.y,K.y,D.y),a.z=b.OQ(t.z,K.z,D.z),a.w=b.OQ(t.w,K.w,D.w),a}static CheckExtends(t,K,D){K.minimizeInPlace(t),D.maximizeInPlace(t)}static get ZeroReadOnly(){return z._ZeroReadOnly}static Normalize(t){return z.NormalizeToRef(t,new z)}static NormalizeToRef(t,K){return t.normalizeToRef(K),K}static Minimize(t,K){const D=new z;return D.copyFrom(t),D.minimizeInPlace(K),D}static Maximize(t,K){const D=new z;return D.copyFrom(t),D.maximizeInPlace(K),D}static Distance(t,K){return Math.sqrt(z.DistanceSquared(t,K))}static DistanceSquared(t,K){const D=t.x-K.x,a=t.y-K.y,G=t.z-K.z,N=t.w-K.w;return D*D+a*a+G*G+N*N}static Center(t,K){return z.CenterToRef(t,K,new z)}static CenterToRef(t,K,D){return D.x=(t.x+K.x)/2,D.y=(t.y+K.y)/2,D.z=(t.z+K.z)/2,D.w=(t.w+K.w)/2,D}static TransformCoordinates(t,K){return z.TransformCoordinatesToRef(t,K,new z)}static TransformCoordinatesToRef(t,K,D){return z.TransformCoordinatesFromFloatsToRef(t._x,t._y,t._z,K,D),D}static TransformCoordinatesFromFloatsToRef(t,K,D,a,G){const N=a.m,W=t*N[0]+K*N[4]+D*N[8]+N[12],x=t*N[1]+K*N[5]+D*N[9]+N[13],b=t*N[2]+K*N[6]+D*N[10]+N[14],n=t*N[3]+K*N[7]+D*N[11]+N[15];return G.x=W,G.y=x,G.z=b,G.w=n,G}static TransformNormal(t,K){return z.TransformNormalToRef(t,K,new z)}static TransformNormalToRef(t,K,D){const a=K.m,G=t.x*a[0]+t.y*a[4]+t.z*a[8],N=t.x*a[1]+t.y*a[5]+t.z*a[9],W=t.x*a[2]+t.y*a[6]+t.z*a[10];return D.x=G,D.y=N,D.z=W,D.w=t.w,D}static TransformNormalFromFloatsToRef(t,K,D,a,G,N){const W=G.m;return N.x=t*W[0]+K*W[4]+D*W[8],N.y=t*W[1]+K*W[5]+D*W[9],N.z=t*W[2]+K*W[6]+D*W[10],N.w=a,N}static FromVector3(t,K=0){return new z(t._x,t._y,t._z,K)}static Dot(t,K){return t.x*K.x+t.y*K.y+t.z*K.z+t.w*K.w}}z._ZeroReadOnly=z.Zero(),Object.defineProperties(z.prototype,{dimension:{value:[4]},rank:{value:1}});class I{get x(){return this._x}set x(t){this._x=t,this._isDirty=!0}get y(){return this._y}set y(t){this._y=t,this._isDirty=!0}get z(){return this._z}set z(t){this._z=t,this._isDirty=!0}get w(){return this._w}set w(t){this._w=t,this._isDirty=!0}constructor(t=0,K=0,D=0,a=1){this._isDirty=!0,this._x=t,this._y=K,this._z=D,this._w=a}toString(){return`{X: ${this._x} Y: ${this._y} Z: ${this._z} W: ${this._w}}`}getClassName(){return"Quaternion"}getHashCode(){let t=n(this._x);return t=397*t^n(this._y),t=397*t^n(this._z),t=397*t^n(this._w),t}asArray(){return[this._x,this._y,this._z,this._w]}toArray(t,K=0){return t[K]=this._x,t[K+1]=this._y,t[K+2]=this._z,t[K+3]=this._w,this}fromArray(t,K=0){return I.FromArrayToRef(t,K,this)}equals(t){return t&&this._x===t._x&&this._y===t._y&&this._z===t._z&&this._w===t._w}equalsWithEpsilon(t,K=a.bH){return t&&b.Mj(this._x,t._x,K)&&b.Mj(this._y,t._y,K)&&b.Mj(this._z,t._z,K)&&b.Mj(this._w,t._w,K)}clone(){return new I(this._x,this._y,this._z,this._w)}copyFrom(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._w=t._w,this._isDirty=!0,this}copyFromFloats(t,K,D,a){return this._x=t,this._y=K,this._z=D,this._w=a,this._isDirty=!0,this}set(t,K,D,a){return this.copyFromFloats(t,K,D,a)}setAll(t){return this.copyFromFloats(t,t,t,t)}add(t){return new I(this._x+t._x,this._y+t._y,this._z+t._z,this._w+t._w)}addInPlace(t){return this._x+=t._x,this._y+=t._y,this._z+=t._z,this._w+=t._w,this._isDirty=!0,this}addToRef(t,K){return K._x=this._x+t._x,K._y=this._y+t._y,K._z=this._z+t._z,K._w=this._w+t._w,K._isDirty=!0,K}addInPlaceFromFloats(t,K,D,a){return this._x+=t,this._y+=K,this._z+=D,this._w+=a,this._isDirty=!0,this}subtractToRef(t,K){return K._x=this._x-t._x,K._y=this._y-t._y,K._z=this._z-t._z,K._w=this._w-t._w,K._isDirty=!0,K}subtractFromFloats(t,K,D,a){return this.subtractFromFloatsToRef(t,K,D,a,new I)}subtractFromFloatsToRef(t,K,D,a,G){return G._x=this._x-t,G._y=this._y-K,G._z=this._z-D,G._w=this._w-a,G._isDirty=!0,G}subtract(t){return new I(this._x-t._x,this._y-t._y,this._z-t._z,this._w-t._w)}subtractInPlace(t){return this._x-=t._x,this._y-=t._y,this._z-=t._z,this._w-=t._w,this._isDirty=!0,this}scale(t){return new I(this._x*t,this._y*t,this._z*t,this._w*t)}scaleToRef(t,K){return K._x=this._x*t,K._y=this._y*t,K._z=this._z*t,K._w=this._w*t,K._isDirty=!0,K}scaleInPlace(t){return this._x*=t,this._y*=t,this._z*=t,this._w*=t,this._isDirty=!0,this}scaleAndAddToRef(t,K){return K._x+=this._x*t,K._y+=this._y*t,K._z+=this._z*t,K._w+=this._w*t,K._isDirty=!0,K}multiply(t){const K=new I(0,0,0,1);return this.multiplyToRef(t,K),K}multiplyToRef(t,K){const D=this._x*t._w+this._y*t._z-this._z*t._y+this._w*t._x,a=-this._x*t._z+this._y*t._w+this._z*t._x+this._w*t._y,G=this._x*t._y-this._y*t._x+this._z*t._w+this._w*t._z,N=-this._x*t._x-this._y*t._y-this._z*t._z+this._w*t._w;return K.copyFromFloats(D,a,G,N),K}multiplyInPlace(t){return this.multiplyToRef(t,this)}multiplyByFloats(t,K,D,a){return this._x*=t,this._y*=K,this._z*=D,this._w*=a,this._isDirty=!0,this}divide(t){throw new ReferenceError("Can not divide a quaternion")}divideToRef(t,K){throw new ReferenceError("Can not divide a quaternion")}divideInPlace(t){throw new ReferenceError("Can not divide a quaternion")}minimizeInPlace(){throw new ReferenceError("Can not minimize a quaternion")}minimizeInPlaceFromFloats(){throw new ReferenceError("Can not minimize a quaternion")}maximizeInPlace(){throw new ReferenceError("Can not maximize a quaternion")}maximizeInPlaceFromFloats(){throw new ReferenceError("Can not maximize a quaternion")}negate(){return this.negateToRef(new I)}negateInPlace(){return this._x=-this._x,this._y=-this._y,this._z=-this._z,this._w=-this._w,this._isDirty=!0,this}negateToRef(t){return t._x=-this._x,t._y=-this._y,t._z=-this._z,t._w=-this._w,t._isDirty=!0,t}equalsToFloats(t,K,D,a){return this._x===t&&this._y===K&&this._z===D&&this._w===a}floorToRef(t){throw new ReferenceError("Can not floor a quaternion")}floor(){throw new ReferenceError("Can not floor a quaternion")}fractToRef(t){throw new ReferenceError("Can not fract a quaternion")}fract(){throw new ReferenceError("Can not fract a quaternion")}conjugateToRef(t){return t.copyFromFloats(-this._x,-this._y,-this._z,this._w),t}conjugateInPlace(){return this._x*=-1,this._y*=-1,this._z*=-1,this._isDirty=!0,this}conjugate(){return new I(-this._x,-this._y,-this._z,this._w)}invert(){const t=this.conjugate(),K=this.lengthSquared();return 0==K||1==K||t.scaleInPlace(1/K),t}invertInPlace(){this.conjugateInPlace();const t=this.lengthSquared();return 0==t||1==t||this.scaleInPlace(1/t),this}lengthSquared(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this.lengthSquared())}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(t){return 0===t||1===t?this:this.scaleInPlace(1/t)}normalizeToNew(){const t=new I(0,0,0,1);return this.normalizeToRef(t),t}normalizeToRef(t){const K=this.length();return 0===K||1===K?t.copyFromFloats(this._x,this._y,this._z,this._w):this.scaleToRef(1/K,t)}toEulerAngles(){const t=i.Zero();return this.toEulerAnglesToRef(t),t}toEulerAnglesToRef(t){const K=this._z,D=this._x,a=this._y,G=this._w,N=a*K-D*G,W=.4999999;if(N<-W)t._y=2*Math.atan2(a,G),t._x=Math.PI/2,t._z=0,t._isDirty=!0;else if(N>W)t._y=2*Math.atan2(a,G),t._x=-Math.PI/2,t._z=0,t._isDirty=!0;else{const W=G*G,x=K*K,b=D*D,n=a*a;t._z=Math.atan2(2*(D*a+K*G),-x-b+n+W),t._x=Math.asin(-2*N),t._y=Math.atan2(2*(K*D+a*G),x-b-n+W),t._isDirty=!0}return t}toAlphaBetaGammaToRef(t){const K=this._z,D=this._x,a=this._y,G=this._w,N=Math.sqrt(D*D+a*a),W=Math.sqrt(K*K+G*G),x=2*Math.atan2(N,W),b=2*Math.atan2(K,G),n=2*Math.atan2(a,D),e=(b+n)/2,i=(b-n)/2;return t.set(i,x,e),t}toRotationMatrix(t){return Z.FromQuaternionToRef(this,t),t}fromRotationMatrix(t){return I.FromRotationMatrixToRef(t,this),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}static FromRotationMatrix(t){const K=new I;return I.FromRotationMatrixToRef(t,K),K}static FromRotationMatrixToRef(t,K){const D=t.m,a=D[0],G=D[4],N=D[8],W=D[1],x=D[5],b=D[9],n=D[2],e=D[6],i=D[10],z=a+x+i;let I;return z>0?(I=.5/Math.sqrt(z+1),K._w=.25/I,K._x=(e-b)*I,K._y=(N-n)*I,K._z=(W-G)*I,K._isDirty=!0):a>x&&a>i?(I=2*Math.sqrt(1+a-x-i),K._w=(e-b)/I,K._x=.25*I,K._y=(G+W)/I,K._z=(N+n)/I,K._isDirty=!0):x>i?(I=2*Math.sqrt(1+x-a-i),K._w=(N-n)/I,K._x=(G+W)/I,K._y=.25*I,K._z=(b+e)/I,K._isDirty=!0):(I=2*Math.sqrt(1+i-a-x),K._w=(W-G)/I,K._x=(N+n)/I,K._y=(b+e)/I,K._z=.25*I,K._isDirty=!0),K}static Dot(t,K){return t._x*K._x+t._y*K._y+t._z*K._z+t._w*K._w}static AreClose(t,K,D=.1){const a=I.Dot(t,K);return 1-a*a<=D}static SmoothToRef(t,K,D,a,G){let N=0===a?1:D/a;return N=b.OQ(N,0,1),I.SlerpToRef(t,K,N,G),G}static Zero(){return new I(0,0,0,0)}static Inverse(t){return new I(-t._x,-t._y,-t._z,t._w)}static InverseToRef(t,K){return K.set(-t._x,-t._y,-t._z,t._w),K}static Identity(){return new I(0,0,0,1)}static IsIdentity(t){return t&&0===t._x&&0===t._y&&0===t._z&&1===t._w}static RotationAxis(t,K){return I.RotationAxisToRef(t,K,new I)}static RotationAxisToRef(t,K,D){D._w=Math.cos(K/2);const a=Math.sin(K/2)/t.length();return D._x=t._x*a,D._y=t._y*a,D._z=t._z*a,D._isDirty=!0,D}static FromArray(t,K){return K||(K=0),new I(t[K],t[K+1],t[K+2],t[K+3])}static FromArrayToRef(t,K,D){return D._x=t[K],D._y=t[K+1],D._z=t[K+2],D._w=t[K+3],D._isDirty=!0,D}static FromFloatsToRef(t,K,D,a,G){return G.copyFromFloats(t,K,D,a),G}static FromEulerAngles(t,K,D){const a=new I;return I.RotationYawPitchRollToRef(K,t,D,a),a}static FromEulerAnglesToRef(t,K,D,a){return I.RotationYawPitchRollToRef(K,t,D,a),a}static FromEulerVector(t){const K=new I;return I.RotationYawPitchRollToRef(t._y,t._x,t._z,K),K}static FromEulerVectorToRef(t,K){return I.RotationYawPitchRollToRef(t._y,t._x,t._z,K),K}static FromUnitVectorsToRef(t,K,D,G=a.bH){const N=i.Dot(t,K)+1;return N<G?Math.abs(t.x)>Math.abs(t.z)?D.set(-t.y,t.x,0,0):D.set(0,-t.z,t.y,0):(i.CrossToRef(t,K,m.Vector3[0]),D.set(m.Vector3[0].x,m.Vector3[0].y,m.Vector3[0].z,N)),D.normalize()}static RotationYawPitchRoll(t,K,D){const a=new I;return I.RotationYawPitchRollToRef(t,K,D,a),a}static RotationYawPitchRollToRef(t,K,D,a){const G=.5*D,N=.5*K,W=.5*t,x=Math.sin(G),b=Math.cos(G),n=Math.sin(N),e=Math.cos(N),i=Math.sin(W),z=Math.cos(W);return a._x=z*n*b+i*e*x,a._y=i*e*b-z*n*x,a._z=z*e*x-i*n*b,a._w=z*e*b+i*n*x,a._isDirty=!0,a}static RotationAlphaBetaGamma(t,K,D){const a=new I;return I.RotationAlphaBetaGammaToRef(t,K,D,a),a}static RotationAlphaBetaGammaToRef(t,K,D,a){const G=.5*(D+t),N=.5*(D-t),W=.5*K;return a._x=Math.cos(N)*Math.sin(W),a._y=Math.sin(N)*Math.sin(W),a._z=Math.sin(G)*Math.cos(W),a._w=Math.cos(G)*Math.cos(W),a._isDirty=!0,a}static RotationQuaternionFromAxis(t,K,D){const a=new I(0,0,0,0);return I.RotationQuaternionFromAxisToRef(t,K,D,a),a}static RotationQuaternionFromAxisToRef(t,K,D,a){const G=w.Matrix[0];return t=t.normalizeToRef(w.Vector3[0]),K=K.normalizeToRef(w.Vector3[1]),D=D.normalizeToRef(w.Vector3[2]),Z.FromXYZAxesToRef(t,K,D,G),I.FromRotationMatrixToRef(G,a),a}static FromLookDirectionLH(t,K){const D=new I;return I.FromLookDirectionLHToRef(t,K,D),D}static FromLookDirectionLHToRef(t,K,D){const a=w.Matrix[0];return Z.LookDirectionLHToRef(t,K,a),I.FromRotationMatrixToRef(a,D),D}static FromLookDirectionRH(t,K){const D=new I;return I.FromLookDirectionRHToRef(t,K,D),D}static FromLookDirectionRHToRef(t,K,D){const a=w.Matrix[0];return Z.LookDirectionRHToRef(t,K,a),I.FromRotationMatrixToRef(a,D)}static Slerp(t,K,D){const a=I.Identity();return I.SlerpToRef(t,K,D,a),a}static SlerpToRef(t,K,D,a){let G,N,W=t._x*K._x+t._y*K._y+t._z*K._z+t._w*K._w,x=!1;if(W<0&&(x=!0,W=-W),W>.999999)N=1-D,G=x?-D:D;else{const t=Math.acos(W),K=1/Math.sin(t);N=Math.sin((1-D)*t)*K,G=x?-Math.sin(D*t)*K:Math.sin(D*t)*K}return a._x=N*t._x+G*K._x,a._y=N*t._y+G*K._y,a._z=N*t._z+G*K._z,a._w=N*t._w+G*K._w,a._isDirty=!0,a}static Hermite(t,K,D,a,G){const N=G*G,W=G*N,x=2*W-3*N+1,b=-2*W+3*N,n=W-2*N+G,e=W-N,i=t._x*x+D._x*b+K._x*n+a._x*e,z=t._y*x+D._y*b+K._y*n+a._y*e,Z=t._z*x+D._z*b+K._z*n+a._z*e,w=t._w*x+D._w*b+K._w*n+a._w*e;return new I(i,z,Z,w)}static Hermite1stDerivative(t,K,D,a,G){const N=new I;return this.Hermite1stDerivativeToRef(t,K,D,a,G,N),N}static Hermite1stDerivativeToRef(t,K,D,a,G,N){const W=G*G;return N._x=6*(W-G)*t._x+(3*W-4*G+1)*K._x+6*(-W+G)*D._x+(3*W-2*G)*a._x,N._y=6*(W-G)*t._y+(3*W-4*G+1)*K._y+6*(-W+G)*D._y+(3*W-2*G)*a._y,N._z=6*(W-G)*t._z+(3*W-4*G+1)*K._z+6*(-W+G)*D._z+(3*W-2*G)*a._z,N._w=6*(W-G)*t._w+(3*W-4*G+1)*K._w+6*(-W+G)*D._w+(3*W-2*G)*a._w,N._isDirty=!0,N}static Normalize(t){const K=I.Zero();return I.NormalizeToRef(t,K),K}static NormalizeToRef(t,K){return t.normalizeToRef(K),K}static Clamp(t,K,D){const a=new I;return I.ClampToRef(t,K,D,a),a}static ClampToRef(t,K,D,a){return a.copyFromFloats(b.OQ(t.x,K.x,D.x),b.OQ(t.y,K.y,D.y),b.OQ(t.z,K.z,D.z),b.OQ(t.w,K.w,D.w))}static Random(t=0,K=1){return new I(b.VD(t,K),b.VD(t,K),b.VD(t,K),b.VD(t,K))}static RandomToRef(t=0,K=1,D){return D.copyFromFloats(b.VD(t,K),b.VD(t,K),b.VD(t,K),b.VD(t,K))}static Minimize(){throw new ReferenceError("Quaternion.Minimize does not make sense")}static Maximize(){throw new ReferenceError("Quaternion.Maximize does not make sense")}static Distance(t,K){return Math.sqrt(I.DistanceSquared(t,K))}static DistanceSquared(t,K){const D=t.x-K.x,a=t.y-K.y,G=t.z-K.z,N=t.w-K.w;return D*D+a*a+G*G+N*N}static Center(t,K){return I.CenterToRef(t,K,I.Zero())}static CenterToRef(t,K,D){return D.copyFromFloats((t.x+K.x)/2,(t.y+K.y)/2,(t.z+K.z)/2,(t.w+K.w)/2)}}Object.defineProperties(I.prototype,{dimension:{value:[4]},rank:{value:1}});class Z{static get Use64Bits(){return W.I.MatrixUse64Bits}get m(){return this._m}markAsUpdated(){this.updateFlag=Z._UpdateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0}_updateIdentityStatus(t,K=!1,D=!1,a=!0){this._isIdentity=t,this._isIdentity3x2=t||D,this._isIdentityDirty=!this._isIdentity&&K,this._isIdentity3x2Dirty=!this._isIdentity3x2&&a}constructor(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this.updateFlag=-1,W.I.MatrixTrackPrecisionChange&&W.I.MatrixTrackedMatrices.push(this),this._m=new W.I.MatrixCurrentType(16),this.markAsUpdated()}isIdentity(){if(this._isIdentityDirty){this._isIdentityDirty=!1;const t=this._m;this._isIdentity=1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]}return this._isIdentity}isIdentityAs3x2(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]||0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2}determinant(){if(!0===this._isIdentity)return 1;const t=this._m,K=t[0],D=t[1],a=t[2],G=t[3],N=t[4],W=t[5],x=t[6],b=t[7],n=t[8],e=t[9],i=t[10],z=t[11],I=t[12],Z=t[13],w=t[14],m=t[15],u=i*m-w*z,d=e*m-Z*z,E=e*w-Z*i,l=n*m-I*z,Q=n*w-i*I,P=n*Z-I*e;return K*+(W*u-x*d+b*E)+D*-(N*u-x*l+b*Q)+a*+(N*d-W*l+b*P)+G*-(N*E-W*Q+x*P)}toString(){return`{${this.m[0]}, ${this.m[1]}, ${this.m[2]}, ${this.m[3]}\n${this.m[4]}, ${this.m[5]}, ${this.m[6]}, ${this.m[7]}\n${this.m[8]}, ${this.m[9]}, ${this.m[10]}, ${this.m[11]}\n${this.m[12]}, ${this.m[13]}, ${this.m[14]}, ${this.m[15]}}`}toArray(t=null,K=0){if(!t)return this._m;const D=this._m;for(let a=0;a<16;a++)t[K+a]=D[a];return this}asArray(){return this._m}fromArray(t,K=0){return Z.FromArrayToRef(t,K,this)}copyFromFloats(...t){return Z.FromArrayToRef(t,0,this)}set(...t){const K=this._m;for(let D=0;D<16;D++)K[D]=t[D];return this.markAsUpdated(),this}setAll(t){const K=this._m;for(let D=0;D<16;D++)K[D]=t;return this.markAsUpdated(),this}invert(){return this.invertToRef(this),this}reset(){return Z.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this}add(t){const K=new Z;return this.addToRef(t,K),K}addToRef(t,K){const D=this._m,a=K._m,G=t.m;for(let t=0;t<16;t++)a[t]=D[t]+G[t];return K.markAsUpdated(),K}addToSelf(t){const K=this._m,D=t.m;return K[0]+=D[0],K[1]+=D[1],K[2]+=D[2],K[3]+=D[3],K[4]+=D[4],K[5]+=D[5],K[6]+=D[6],K[7]+=D[7],K[8]+=D[8],K[9]+=D[9],K[10]+=D[10],K[11]+=D[11],K[12]+=D[12],K[13]+=D[13],K[14]+=D[14],K[15]+=D[15],this.markAsUpdated(),this}addInPlace(t){const K=this._m,D=t.m;for(let t=0;t<16;t++)K[t]+=D[t];return this.markAsUpdated(),this}addInPlaceFromFloats(...t){const K=this._m;for(let D=0;D<16;D++)K[D]+=t[D];return this.markAsUpdated(),this}subtract(t){const K=this._m,D=t.m;for(let t=0;t<16;t++)K[t]-=D[t];return this.markAsUpdated(),this}subtractToRef(t,K){const D=this._m,a=t.m,G=K._m;for(let t=0;t<16;t++)G[t]=D[t]-a[t];return K.markAsUpdated(),K}subtractInPlace(t){const K=this._m,D=t.m;for(let t=0;t<16;t++)K[t]-=D[t];return this.markAsUpdated(),this}subtractFromFloats(...t){return this.subtractFromFloatsToRef(...t,new Z)}subtractFromFloatsToRef(...t){const K=t.pop(),D=this._m,a=K._m,G=t;for(let t=0;t<16;t++)a[t]=D[t]-G[t];return K.markAsUpdated(),K}invertToRef(t){if(!0===this._isIdentity)return Z.IdentityToRef(t),t;const K=this._m,D=K[0],a=K[1],G=K[2],N=K[3],W=K[4],x=K[5],b=K[6],n=K[7],e=K[8],i=K[9],z=K[10],I=K[11],w=K[12],m=K[13],u=K[14],d=K[15],E=z*d-u*I,l=i*d-m*I,Q=i*u-m*z,P=e*d-w*I,y=e*u-z*w,q=e*m-w*i,X=+(x*E-b*l+n*Q),h=-(W*E-b*P+n*y),J=+(W*l-x*P+n*q),T=-(W*Q-x*y+b*q),_=D*X+a*h+G*J+N*T;if(0===_)return t.copyFrom(this),t;const C=1/_,H=b*d-u*n,o=x*d-m*n,U=x*u-m*b,V=W*d-w*n,s=W*u-w*b,F=W*m-w*x,c=b*I-z*n,g=x*I-i*n,R=x*z-i*b,A=W*I-e*n,Y=W*z-e*b,L=W*i-e*x,S=-(a*E-G*l+N*Q),f=+(D*E-G*P+N*y),$=-(D*l-a*P+N*q),B=+(D*Q-a*y+G*q),O=+(a*H-G*o+N*U),v=-(D*H-G*V+N*s),p=+(D*o-a*V+N*F),j=-(D*U-a*s+G*F),r=-(a*c-G*g+N*R),M=+(D*c-G*A+N*Y),k=-(D*g-a*A+N*L),tt=+(D*R-a*Y+G*L);return Z.FromValuesToRef(X*C,S*C,O*C,r*C,h*C,f*C,v*C,M*C,J*C,$*C,p*C,k*C,T*C,B*C,j*C,tt*C,t),t}addAtIndex(t,K){return this._m[t]+=K,this.markAsUpdated(),this}multiplyAtIndex(t,K){return this._m[t]*=K,this.markAsUpdated(),this}setTranslationFromFloats(t,K,D){return this._m[12]=t,this._m[13]=K,this._m[14]=D,this.markAsUpdated(),this}addTranslationFromFloats(t,K,D){return this._m[12]+=t,this._m[13]+=K,this._m[14]+=D,this.markAsUpdated(),this}setTranslation(t){return this.setTranslationFromFloats(t._x,t._y,t._z)}getTranslation(){return new i(this._m[12],this._m[13],this._m[14])}getTranslationToRef(t){return t.x=this._m[12],t.y=this._m[13],t.z=this._m[14],t}removeRotationAndScaling(){const t=this.m;return Z.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t[12],t[13],t[14],t[15],this),this._updateIdentityStatus(0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]),this}copyFrom(t){t.copyToArray(this._m);const K=t;return this.updateFlag=K.updateFlag,this._updateIdentityStatus(K._isIdentity,K._isIdentityDirty,K._isIdentity3x2,K._isIdentity3x2Dirty),this}copyToArray(t,K=0){const D=this._m;return t[K]=D[0],t[K+1]=D[1],t[K+2]=D[2],t[K+3]=D[3],t[K+4]=D[4],t[K+5]=D[5],t[K+6]=D[6],t[K+7]=D[7],t[K+8]=D[8],t[K+9]=D[9],t[K+10]=D[10],t[K+11]=D[11],t[K+12]=D[12],t[K+13]=D[13],t[K+14]=D[14],t[K+15]=D[15],this}multiply(t){const K=new Z;return this.multiplyToRef(t,K),K}multiplyInPlace(t){const K=this._m,D=t.m;for(let t=0;t<16;t++)K[t]*=D[t];return this.markAsUpdated(),this}multiplyByFloats(...t){const K=this._m;for(let D=0;D<16;D++)K[D]*=t[D];return this.markAsUpdated(),this}multiplyByFloatsToRef(...t){const K=t.pop(),D=this._m,a=K._m,G=t;for(let t=0;t<16;t++)a[t]=D[t]*G[t];return K.markAsUpdated(),K}multiplyToRef(t,K){return this._isIdentity?(K.copyFrom(t),K):t._isIdentity?(K.copyFrom(this),K):(this.multiplyToArray(t,K._m,0),K.markAsUpdated(),K)}multiplyToArray(t,K,D){const a=this._m,G=t.m,N=a[0],W=a[1],x=a[2],b=a[3],n=a[4],e=a[5],i=a[6],z=a[7],I=a[8],Z=a[9],w=a[10],m=a[11],u=a[12],d=a[13],E=a[14],l=a[15],Q=G[0],P=G[1],y=G[2],q=G[3],X=G[4],h=G[5],J=G[6],T=G[7],_=G[8],C=G[9],H=G[10],o=G[11],U=G[12],V=G[13],s=G[14],F=G[15];return K[D]=N*Q+W*X+x*_+b*U,K[D+1]=N*P+W*h+x*C+b*V,K[D+2]=N*y+W*J+x*H+b*s,K[D+3]=N*q+W*T+x*o+b*F,K[D+4]=n*Q+e*X+i*_+z*U,K[D+5]=n*P+e*h+i*C+z*V,K[D+6]=n*y+e*J+i*H+z*s,K[D+7]=n*q+e*T+i*o+z*F,K[D+8]=I*Q+Z*X+w*_+m*U,K[D+9]=I*P+Z*h+w*C+m*V,K[D+10]=I*y+Z*J+w*H+m*s,K[D+11]=I*q+Z*T+w*o+m*F,K[D+12]=u*Q+d*X+E*_+l*U,K[D+13]=u*P+d*h+E*C+l*V,K[D+14]=u*y+d*J+E*H+l*s,K[D+15]=u*q+d*T+E*o+l*F,this}divide(t){return this.divideToRef(t,new Z)}divideToRef(t,K){const D=this._m,a=t.m,G=K._m;for(let t=0;t<16;t++)G[t]=D[t]/a[t];return K.markAsUpdated(),K}divideInPlace(t){const K=this._m,D=t.m;for(let t=0;t<16;t++)K[t]/=D[t];return this.markAsUpdated(),this}minimizeInPlace(t){const K=this._m,D=t.m;for(let t=0;t<16;t++)K[t]=Math.min(K[t],D[t]);return this.markAsUpdated(),this}minimizeInPlaceFromFloats(...t){const K=this._m;for(let D=0;D<16;D++)K[D]=Math.min(K[D],t[D]);return this.markAsUpdated(),this}maximizeInPlace(t){const K=this._m,D=t.m;for(let t=0;t<16;t++)K[t]=Math.min(K[t],D[t]);return this.markAsUpdated(),this}maximizeInPlaceFromFloats(...t){const K=this._m;for(let D=0;D<16;D++)K[D]=Math.min(K[D],t[D]);return this.markAsUpdated(),this}negate(){return this.negateToRef(new Z)}negateInPlace(){const t=this._m;for(let K=0;K<16;K++)t[K]=-t[K];return this.markAsUpdated(),this}negateToRef(t){const K=this._m,D=t._m;for(let t=0;t<16;t++)D[t]=-K[t];return t.markAsUpdated(),t}equals(t){const K=t;if(!K)return!1;if((this._isIdentity||K._isIdentity)&&!this._isIdentityDirty&&!K._isIdentityDirty)return this._isIdentity&&K._isIdentity;const D=this.m,a=K.m;return D[0]===a[0]&&D[1]===a[1]&&D[2]===a[2]&&D[3]===a[3]&&D[4]===a[4]&&D[5]===a[5]&&D[6]===a[6]&&D[7]===a[7]&&D[8]===a[8]&&D[9]===a[9]&&D[10]===a[10]&&D[11]===a[11]&&D[12]===a[12]&&D[13]===a[13]&&D[14]===a[14]&&D[15]===a[15]}equalsWithEpsilon(t,K=0){const D=this._m,a=t.m;for(let t=0;t<16;t++)if(!b.Mj(D[t],a[t],K))return!1;return!0}equalsToFloats(...t){const K=this._m;for(let D=0;D<16;D++)if(K[D]!=t[D])return!1;return!0}floor(){return this.floorToRef(new Z)}floorToRef(t){const K=this._m,D=t._m;for(let t=0;t<16;t++)D[t]=Math.floor(K[t]);return t.markAsUpdated(),t}fract(){return this.fractToRef(new Z)}fractToRef(t){const K=this._m,D=t._m;for(let t=0;t<16;t++)D[t]=K[t]-Math.floor(K[t]);return t.markAsUpdated(),t}clone(){const t=new Z;return t.copyFrom(this),t}getClassName(){return"Matrix"}getHashCode(){let t=n(this._m[0]);for(let K=1;K<16;K++)t=397*t^n(this._m[K]);return t}decomposeToTransformNode(t){return t.rotationQuaternion=t.rotationQuaternion||new I,this.decompose(t.scaling,t.rotationQuaternion,t.position)}decompose(t,K,D,a,G=!0){if(this._isIdentity)return D&&D.setAll(0),t&&t.setAll(1),K&&K.copyFromFloats(0,0,0,1),!0;const N=this._m;if(D&&D.copyFromFloats(N[12],N[13],N[14]),(t=t||w.Vector3[0]).x=Math.sqrt(N[0]*N[0]+N[1]*N[1]+N[2]*N[2]),t.y=Math.sqrt(N[4]*N[4]+N[5]*N[5]+N[6]*N[6]),t.z=Math.sqrt(N[8]*N[8]+N[9]*N[9]+N[10]*N[10]),a){const K=(G?a.absoluteScaling.x:a.scaling.x)<0?-1:1,D=(G?a.absoluteScaling.y:a.scaling.y)<0?-1:1,N=(G?a.absoluteScaling.z:a.scaling.z)<0?-1:1;t.x*=K,t.y*=D,t.z*=N}else this.determinant()<=0&&(t.y*=-1);if(0===t._x||0===t._y||0===t._z)return K&&K.copyFromFloats(0,0,0,1),!1;if(K){const D=1/t._x,a=1/t._y,G=1/t._z;Z.FromValuesToRef(N[0]*D,N[1]*D,N[2]*D,0,N[4]*a,N[5]*a,N[6]*a,0,N[8]*G,N[9]*G,N[10]*G,0,0,0,0,1,w.Matrix[0]),I.FromRotationMatrixToRef(w.Matrix[0],K)}return!0}getRow(t){if(t<0||t>3)return null;const K=4*t;return new z(this._m[K+0],this._m[K+1],this._m[K+2],this._m[K+3])}getRowToRef(t,K){if(t>=0&&t<=3){const D=4*t;K.x=this._m[D+0],K.y=this._m[D+1],K.z=this._m[D+2],K.w=this._m[D+3]}return K}setRow(t,K){return this.setRowFromFloats(t,K.x,K.y,K.z,K.w)}transpose(){const t=new Z;return Z.TransposeToRef(this,t),t}transposeToRef(t){return Z.TransposeToRef(this,t),t}setRowFromFloats(t,K,D,a,G){if(t<0||t>3)return this;const N=4*t;return this._m[N+0]=K,this._m[N+1]=D,this._m[N+2]=a,this._m[N+3]=G,this.markAsUpdated(),this}scale(t){const K=new Z;return this.scaleToRef(t,K),K}scaleToRef(t,K){for(let D=0;D<16;D++)K._m[D]=this._m[D]*t;return K.markAsUpdated(),K}scaleAndAddToRef(t,K){for(let D=0;D<16;D++)K._m[D]+=this._m[D]*t;return K.markAsUpdated(),K}scaleInPlace(t){const K=this._m;for(let D=0;D<16;D++)K[D]*=t;return this.markAsUpdated(),this}toNormalMatrix(t){const K=w.Matrix[0];this.invertToRef(K),K.transposeToRef(t);const D=t._m;return Z.FromValuesToRef(D[0],D[1],D[2],0,D[4],D[5],D[6],0,D[8],D[9],D[10],0,0,0,0,1,t),t}getRotationMatrix(){const t=new Z;return this.getRotationMatrixToRef(t),t}getRotationMatrixToRef(t){const K=w.Vector3[0];if(!this.decompose(K))return Z.IdentityToRef(t),t;const D=this._m,a=1/K._x,G=1/K._y,N=1/K._z;return Z.FromValuesToRef(D[0]*a,D[1]*a,D[2]*a,0,D[4]*G,D[5]*G,D[6]*G,0,D[8]*N,D[9]*N,D[10]*N,0,0,0,0,1,t),t}toggleModelMatrixHandInPlace(){const t=this._m;return t[2]*=-1,t[6]*=-1,t[8]*=-1,t[9]*=-1,t[14]*=-1,this.markAsUpdated(),this}toggleProjectionMatrixHandInPlace(){const t=this._m;return t[8]*=-1,t[9]*=-1,t[10]*=-1,t[11]*=-1,this.markAsUpdated(),this}static FromArray(t,K=0){const D=new Z;return Z.FromArrayToRef(t,K,D),D}static FromArrayToRef(t,K,D){for(let a=0;a<16;a++)D._m[a]=t[a+K];return D.markAsUpdated(),D}static FromFloat32ArrayToRefScaled(t,K,D,a){return a._m[0]=t[0+K]*D,a._m[1]=t[1+K]*D,a._m[2]=t[2+K]*D,a._m[3]=t[3+K]*D,a._m[4]=t[4+K]*D,a._m[5]=t[5+K]*D,a._m[6]=t[6+K]*D,a._m[7]=t[7+K]*D,a._m[8]=t[8+K]*D,a._m[9]=t[9+K]*D,a._m[10]=t[10+K]*D,a._m[11]=t[11+K]*D,a._m[12]=t[12+K]*D,a._m[13]=t[13+K]*D,a._m[14]=t[14+K]*D,a._m[15]=t[15+K]*D,a.markAsUpdated(),a}static get IdentityReadOnly(){return Z._IdentityReadOnly}static FromValuesToRef(t,K,D,a,G,N,W,x,b,n,e,i,z,I,Z,w,m){const u=m._m;u[0]=t,u[1]=K,u[2]=D,u[3]=a,u[4]=G,u[5]=N,u[6]=W,u[7]=x,u[8]=b,u[9]=n,u[10]=e,u[11]=i,u[12]=z,u[13]=I,u[14]=Z,u[15]=w,m.markAsUpdated()}static FromValues(t,K,D,a,G,N,W,x,b,n,e,i,z,I,w,m){const u=new Z,d=u._m;return d[0]=t,d[1]=K,d[2]=D,d[3]=a,d[4]=G,d[5]=N,d[6]=W,d[7]=x,d[8]=b,d[9]=n,d[10]=e,d[11]=i,d[12]=z,d[13]=I,d[14]=w,d[15]=m,u.markAsUpdated(),u}static Compose(t,K,D){const a=new Z;return Z.ComposeToRef(t,K,D,a),a}static ComposeToRef(t,K,D,a){const G=a._m,N=K._x,W=K._y,x=K._z,b=K._w,n=N+N,e=W+W,i=x+x,z=N*n,I=N*e,Z=N*i,w=W*e,m=W*i,u=x*i,d=b*n,E=b*e,l=b*i,Q=t._x,P=t._y,y=t._z;return G[0]=(1-(w+u))*Q,G[1]=(I+l)*Q,G[2]=(Z-E)*Q,G[3]=0,G[4]=(I-l)*P,G[5]=(1-(z+u))*P,G[6]=(m+d)*P,G[7]=0,G[8]=(Z+E)*y,G[9]=(m-d)*y,G[10]=(1-(z+w))*y,G[11]=0,G[12]=D._x,G[13]=D._y,G[14]=D._z,G[15]=1,a.markAsUpdated(),a}static Identity(){const t=Z.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return t._updateIdentityStatus(!0),t}static IdentityToRef(t){return Z.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,t),t._updateIdentityStatus(!0),t}static Zero(){const t=Z.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return t._updateIdentityStatus(!1),t}static RotationX(t){const K=new Z;return Z.RotationXToRef(t,K),K}static Invert(t){const K=new Z;return t.invertToRef(K),K}static RotationXToRef(t,K){const D=Math.sin(t),a=Math.cos(t);return Z.FromValuesToRef(1,0,0,0,0,a,D,0,0,-D,a,0,0,0,0,1,K),K._updateIdentityStatus(1===a&&0===D),K}static RotationY(t){const K=new Z;return Z.RotationYToRef(t,K),K}static RotationYToRef(t,K){const D=Math.sin(t),a=Math.cos(t);return Z.FromValuesToRef(a,0,-D,0,0,1,0,0,D,0,a,0,0,0,0,1,K),K._updateIdentityStatus(1===a&&0===D),K}static RotationZ(t){const K=new Z;return Z.RotationZToRef(t,K),K}static RotationZToRef(t,K){const D=Math.sin(t),a=Math.cos(t);return Z.FromValuesToRef(a,D,0,0,-D,a,0,0,0,0,1,0,0,0,0,1,K),K._updateIdentityStatus(1===a&&0===D),K}static RotationAxis(t,K){const D=new Z;return Z.RotationAxisToRef(t,K,D),D}static RotationAxisToRef(t,K,D){const a=Math.sin(-K),G=Math.cos(-K),N=1-G;t=t.normalizeToRef(w.Vector3[0]);const W=D._m;return W[0]=t._x*t._x*N+G,W[1]=t._x*t._y*N-t._z*a,W[2]=t._x*t._z*N+t._y*a,W[3]=0,W[4]=t._y*t._x*N+t._z*a,W[5]=t._y*t._y*N+G,W[6]=t._y*t._z*N-t._x*a,W[7]=0,W[8]=t._z*t._x*N-t._y*a,W[9]=t._z*t._y*N+t._x*a,W[10]=t._z*t._z*N+G,W[11]=0,W[12]=0,W[13]=0,W[14]=0,W[15]=1,D.markAsUpdated(),D}static RotationAlignToRef(t,K,D,G=!1){const N=i.Dot(K,t),W=D._m;if(N<-1+a.bH)W[0]=-1,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=G?1:-1,W[6]=0,W[7]=0,W[8]=0,W[9]=0,W[10]=G?-1:1,W[11]=0;else{const D=i.Cross(K,t),a=1/(1+N);W[0]=D._x*D._x*a+N,W[1]=D._y*D._x*a-D._z,W[2]=D._z*D._x*a+D._y,W[3]=0,W[4]=D._x*D._y*a+D._z,W[5]=D._y*D._y*a+N,W[6]=D._z*D._y*a-D._x,W[7]=0,W[8]=D._x*D._z*a-D._y,W[9]=D._y*D._z*a+D._x,W[10]=D._z*D._z*a+N,W[11]=0}return W[12]=0,W[13]=0,W[14]=0,W[15]=1,D.markAsUpdated(),D}static RotationYawPitchRoll(t,K,D){const a=new Z;return Z.RotationYawPitchRollToRef(t,K,D,a),a}static RotationYawPitchRollToRef(t,K,D,a){return I.RotationYawPitchRollToRef(t,K,D,w.Quaternion[0]),w.Quaternion[0].toRotationMatrix(a),a}static Scaling(t,K,D){const a=new Z;return Z.ScalingToRef(t,K,D,a),a}static ScalingToRef(t,K,D,a){return Z.FromValuesToRef(t,0,0,0,0,K,0,0,0,0,D,0,0,0,0,1,a),a._updateIdentityStatus(1===t&&1===K&&1===D),a}static Translation(t,K,D){const a=new Z;return Z.TranslationToRef(t,K,D,a),a}static TranslationToRef(t,K,D,a){return Z.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t,K,D,1,a),a._updateIdentityStatus(0===t&&0===K&&0===D),a}static Lerp(t,K,D){const a=new Z;return Z.LerpToRef(t,K,D,a),a}static LerpToRef(t,K,D,a){const G=a._m,N=t.m,W=K.m;for(let t=0;t<16;t++)G[t]=N[t]*(1-D)+W[t]*D;return a.markAsUpdated(),a}static DecomposeLerp(t,K,D){const a=new Z;return Z.DecomposeLerpToRef(t,K,D,a),a}static DecomposeLerpToRef(t,K,D,a){const G=w.Vector3[0],N=w.Quaternion[0],W=w.Vector3[1];t.decompose(G,N,W);const x=w.Vector3[2],b=w.Quaternion[1],n=w.Vector3[3];K.decompose(x,b,n);const e=w.Vector3[4];i.LerpToRef(G,x,D,e);const z=w.Quaternion[2];I.SlerpToRef(N,b,D,z);const m=w.Vector3[5];return i.LerpToRef(W,n,D,m),Z.ComposeToRef(e,z,m,a),a}static LookAtLH(t,K,D){const a=new Z;return Z.LookAtLHToRef(t,K,D,a),a}static LookAtLHToRef(t,K,D,a){const G=w.Vector3[0],N=w.Vector3[1],W=w.Vector3[2];K.subtractToRef(t,W),W.normalize(),i.CrossToRef(D,W,G);const x=G.lengthSquared();0===x?G.x=1:G.normalizeFromLength(Math.sqrt(x)),i.CrossToRef(W,G,N),N.normalize();const b=-i.Dot(G,t),n=-i.Dot(N,t),e=-i.Dot(W,t);return Z.FromValuesToRef(G._x,N._x,W._x,0,G._y,N._y,W._y,0,G._z,N._z,W._z,0,b,n,e,1,a),a}static LookAtRH(t,K,D){const a=new Z;return Z.LookAtRHToRef(t,K,D,a),a}static LookAtRHToRef(t,K,D,a){const G=w.Vector3[0],N=w.Vector3[1],W=w.Vector3[2];t.subtractToRef(K,W),W.normalize(),i.CrossToRef(D,W,G);const x=G.lengthSquared();0===x?G.x=1:G.normalizeFromLength(Math.sqrt(x)),i.CrossToRef(W,G,N),N.normalize();const b=-i.Dot(G,t),n=-i.Dot(N,t),e=-i.Dot(W,t);return Z.FromValuesToRef(G._x,N._x,W._x,0,G._y,N._y,W._y,0,G._z,N._z,W._z,0,b,n,e,1,a),a}static LookDirectionLH(t,K){const D=new Z;return Z.LookDirectionLHToRef(t,K,D),D}static LookDirectionLHToRef(t,K,D){const a=w.Vector3[0];a.copyFrom(t),a.scaleInPlace(-1);const G=w.Vector3[1];return i.CrossToRef(K,a,G),Z.FromValuesToRef(G._x,G._y,G._z,0,K._x,K._y,K._z,0,a._x,a._y,a._z,0,0,0,0,1,D),D}static LookDirectionRH(t,K){const D=new Z;return Z.LookDirectionRHToRef(t,K,D),D}static LookDirectionRHToRef(t,K,D){const a=w.Vector3[2];return i.CrossToRef(K,t,a),Z.FromValuesToRef(a._x,a._y,a._z,0,K._x,K._y,K._z,0,t._x,t._y,t._z,0,0,0,0,1,D),D}static OrthoLH(t,K,D,a,G){const N=new Z;return Z.OrthoLHToRef(t,K,D,a,N,G),N}static OrthoLHToRef(t,K,D,a,G,N){const W=2/t,x=2/K,b=2/(a-D),n=-(a+D)/(a-D);return Z.FromValuesToRef(W,0,0,0,0,x,0,0,0,0,b,0,0,0,n,1,G),N&&G.multiplyToRef(u,G),G._updateIdentityStatus(1===W&&1===x&&1===b&&0===n),G}static OrthoOffCenterLH(t,K,D,a,G,N,W){const x=new Z;return Z.OrthoOffCenterLHToRef(t,K,D,a,G,N,x,W),x}static OrthoOffCenterLHToRef(t,K,D,a,G,N,W,x){const b=2/(K-t),n=2/(a-D),e=2/(N-G),i=-(N+G)/(N-G),z=(t+K)/(t-K),I=(a+D)/(D-a);return Z.FromValuesToRef(b,0,0,0,0,n,0,0,0,0,e,0,z,I,i,1,W),x&&W.multiplyToRef(u,W),W.markAsUpdated(),W}static ObliqueOffCenterLHToRef(t,K,D,a,G,N,W,x,b,n,e){const i=-W*Math.cos(x),z=-W*Math.sin(x);return Z.TranslationToRef(0,0,-b,w.Matrix[1]),Z.FromValuesToRef(1,0,0,0,0,1,0,0,i,z,1,0,0,0,0,1,w.Matrix[0]),w.Matrix[1].multiplyToRef(w.Matrix[0],w.Matrix[0]),Z.TranslationToRef(0,0,b,w.Matrix[1]),w.Matrix[0].multiplyToRef(w.Matrix[1],w.Matrix[0]),Z.OrthoOffCenterLHToRef(t,K,D,a,G,N,n,e),w.Matrix[0].multiplyToRef(n,n),n}static OrthoOffCenterRH(t,K,D,a,G,N,W){const x=new Z;return Z.OrthoOffCenterRHToRef(t,K,D,a,G,N,x,W),x}static OrthoOffCenterRHToRef(t,K,D,a,G,N,W,x){return Z.OrthoOffCenterLHToRef(t,K,D,a,G,N,W,x),W._m[10]*=-1,W}static ObliqueOffCenterRHToRef(t,K,D,a,G,N,W,x,b,n,e){const i=W*Math.cos(x),z=W*Math.sin(x);return Z.TranslationToRef(0,0,b,w.Matrix[1]),Z.FromValuesToRef(1,0,0,0,0,1,0,0,i,z,1,0,0,0,0,1,w.Matrix[0]),w.Matrix[1].multiplyToRef(w.Matrix[0],w.Matrix[0]),Z.TranslationToRef(0,0,-b,w.Matrix[1]),w.Matrix[0].multiplyToRef(w.Matrix[1],w.Matrix[0]),Z.OrthoOffCenterRHToRef(t,K,D,a,G,N,n,e),w.Matrix[0].multiplyToRef(n,n),n}static PerspectiveLH(t,K,D,a,G,N=0){const W=new Z,x=2*D/t,b=2*D/K,n=(a+D)/(a-D),e=-2*a*D/(a-D),i=Math.tan(N);return Z.FromValuesToRef(x,0,0,0,0,b,0,i,0,0,n,1,0,0,e,0,W),G&&W.multiplyToRef(u,W),W._updateIdentityStatus(!1),W}static PerspectiveFovLH(t,K,D,a,G,N=0,W=!1){const x=new Z;return Z.PerspectiveFovLHToRef(t,K,D,a,x,!0,G,N,W),x}static PerspectiveFovLHToRef(t,K,D,a,G,N=!0,W,x=0,b=!1){const n=D,e=a,i=1/Math.tan(.5*t),z=N?i/K:i,I=N?i:i*K,w=b&&0===n?-1:0!==e?(e+n)/(e-n):1,m=b&&0===n?2*e:0!==e?-2*e*n/(e-n):-2*n,d=Math.tan(x);return Z.FromValuesToRef(z,0,0,0,0,I,0,d,0,0,w,1,0,0,m,0,G),W&&G.multiplyToRef(u,G),G._updateIdentityStatus(!1),G}static PerspectiveFovReverseLHToRef(t,K,D,a,G,N=!0,W,x=0){const b=1/Math.tan(.5*t),n=N?b/K:b,e=N?b:b*K,i=Math.tan(x);return Z.FromValuesToRef(n,0,0,0,0,e,0,i,0,0,-D,1,0,0,1,0,G),W&&G.multiplyToRef(u,G),G._updateIdentityStatus(!1),G}static PerspectiveFovRH(t,K,D,a,G,N=0,W=!1){const x=new Z;return Z.PerspectiveFovRHToRef(t,K,D,a,x,!0,G,N,W),x}static PerspectiveFovRHToRef(t,K,D,a,G,N=!0,W,x=0,b=!1){const n=D,e=a,i=1/Math.tan(.5*t),z=N?i/K:i,I=N?i:i*K,w=b&&0===n?1:0!==e?-(e+n)/(e-n):-1,m=b&&0===n?2*e:0!==e?-2*e*n/(e-n):-2*n,d=Math.tan(x);return Z.FromValuesToRef(z,0,0,0,0,I,0,d,0,0,w,-1,0,0,m,0,G),W&&G.multiplyToRef(u,G),G._updateIdentityStatus(!1),G}static PerspectiveFovReverseRHToRef(t,K,D,a,G,N=!0,W,x=0){const b=1/Math.tan(.5*t),n=N?b/K:b,e=N?b:b*K,i=Math.tan(x);return Z.FromValuesToRef(n,0,0,0,0,e,0,i,0,0,-D,-1,0,0,-1,0,G),W&&G.multiplyToRef(u,G),G._updateIdentityStatus(!1),G}static GetFinalMatrix(t,K,D,a,G,N){const W=t.width,x=t.height,b=t.x,n=t.y,e=Z.FromValues(W/2,0,0,0,0,-x/2,0,0,0,0,N-G,0,b+W/2,x/2+n,G,1),i=new Z;return K.multiplyToRef(D,i),i.multiplyToRef(a,i),i.multiplyToRef(e,i)}static GetAsMatrix2x2(t){const K=t.m,D=[K[0],K[1],K[4],K[5]];return W.I.MatrixUse64Bits?D:new Float32Array(D)}static GetAsMatrix3x3(t){const K=t.m,D=[K[0],K[1],K[2],K[4],K[5],K[6],K[8],K[9],K[10]];return W.I.MatrixUse64Bits?D:new Float32Array(D)}static Transpose(t){const K=new Z;return Z.TransposeToRef(t,K),K}static TransposeToRef(t,K){const D=t.m,a=D[0],G=D[4],N=D[8],W=D[12],x=D[1],b=D[5],n=D[9],e=D[13],i=D[2],z=D[6],I=D[10],Z=D[14],w=D[3],m=D[7],u=D[11],d=D[15],E=K._m;return E[0]=a,E[1]=G,E[2]=N,E[3]=W,E[4]=x,E[5]=b,E[6]=n,E[7]=e,E[8]=i,E[9]=z,E[10]=I,E[11]=Z,E[12]=w,E[13]=m,E[14]=u,E[15]=d,K.markAsUpdated(),K._updateIdentityStatus(t._isIdentity,t._isIdentityDirty),K}static Reflection(t){const K=new Z;return Z.ReflectionToRef(t,K),K}static ReflectionToRef(t,K){t.normalize();const D=t.normal.x,a=t.normal.y,G=t.normal.z,N=-2*D,W=-2*a,x=-2*G;return Z.FromValuesToRef(N*D+1,W*D,x*D,0,N*a,W*a+1,x*a,0,N*G,W*G,x*G+1,0,N*t.d,W*t.d,x*t.d,1,K),K}static FromXYZAxesToRef(t,K,D,a){return Z.FromValuesToRef(t._x,t._y,t._z,0,K._x,K._y,K._z,0,D._x,D._y,D._z,0,0,0,0,1,a),a}static FromQuaternionToRef(t,K){const D=t._x*t._x,a=t._y*t._y,G=t._z*t._z,N=t._x*t._y,W=t._z*t._w,x=t._z*t._x,b=t._y*t._w,n=t._y*t._z,e=t._x*t._w;return K._m[0]=1-2*(a+G),K._m[1]=2*(N+W),K._m[2]=2*(x-b),K._m[3]=0,K._m[4]=2*(N-W),K._m[5]=1-2*(G+D),K._m[6]=2*(n+e),K._m[7]=0,K._m[8]=2*(x+b),K._m[9]=2*(n-e),K._m[10]=1-2*(a+D),K._m[11]=0,K._m[12]=0,K._m[13]=0,K._m[14]=0,K._m[15]=1,K.markAsUpdated(),K}}Z._UpdateFlagSeed=0,Z._IdentityReadOnly=Z.Identity(),Object.defineProperties(Z.prototype,{dimension:{value:[4,4]},rank:{value:2}});class w{}w.Vector3=G.ln(11,i.Zero),w.Matrix=G.ln(2,Z.Identity),w.Quaternion=G.ln(3,I.Zero);class m{}m.Vector2=G.ln(3,e.Zero),m.Vector3=G.ln(13,i.Zero),m.Vector4=G.ln(3,z.Zero),m.Quaternion=G.ln(3,I.Zero),m.Matrix=G.ln(8,Z.Identity),N.Y5("BABYLON.Vector2",e),N.Y5("BABYLON.Vector3",i),N.Y5("BABYLON.Vector4",z),N.Y5("BABYLON.Matrix",Z);const u=Z.FromValues(1,0,0,0,0,1,0,0,0,0,.5,0,0,0,.5,1)},60071:(t,K,D)=>{D.d(K,{L:()=>a});class a{constructor(t,K,D,a){this.x=t,this.y=K,this.width=D,this.height=a}toGlobal(t,K){return new a(this.x*t,this.y*K,this.width*t,this.height*K)}toGlobalToRef(t,K,D){return D.x=this.x*t,D.y=this.y*K,D.width=this.width*t,D.height=this.height*K,this}clone(){return new a(this.x,this.y,this.width,this.height)}}},562756:(t,K,D)=>{D.d(K,{O:()=>n,Q:()=>e});var a=D(604910),G=D(948733);const N=[Math.sqrt(1/(4*Math.PI)),-Math.sqrt(3/(4*Math.PI)),Math.sqrt(3/(4*Math.PI)),-Math.sqrt(3/(4*Math.PI)),Math.sqrt(15/(4*Math.PI)),-Math.sqrt(15/(4*Math.PI)),Math.sqrt(5/(16*Math.PI)),-Math.sqrt(15/(4*Math.PI)),Math.sqrt(15/(16*Math.PI))],W=[()=>1,t=>t.y,t=>t.z,t=>t.x,t=>t.x*t.y,t=>t.y*t.z,t=>3*t.z*t.z-1,t=>t.x*t.z,t=>t.x*t.x-t.y*t.y],x=(t,K)=>N[t]*W[t](K),b=[Math.PI,2*Math.PI/3,2*Math.PI/3,2*Math.PI/3,Math.PI/4,Math.PI/4,Math.PI/4,Math.PI/4,Math.PI/4];class n{constructor(){this.preScaled=!1,this.l00=a.Pq.Zero(),this.l1_1=a.Pq.Zero(),this.l10=a.Pq.Zero(),this.l11=a.Pq.Zero(),this.l2_2=a.Pq.Zero(),this.l2_1=a.Pq.Zero(),this.l20=a.Pq.Zero(),this.l21=a.Pq.Zero(),this.l22=a.Pq.Zero()}addLight(t,K,D){G.AA.Vector3[0].set(K.r,K.g,K.b);const a=G.AA.Vector3[0],N=G.AA.Vector3[1];a.scaleToRef(D,N),N.scaleToRef(x(0,t),G.AA.Vector3[2]),this.l00.addInPlace(G.AA.Vector3[2]),N.scaleToRef(x(1,t),G.AA.Vector3[2]),this.l1_1.addInPlace(G.AA.Vector3[2]),N.scaleToRef(x(2,t),G.AA.Vector3[2]),this.l10.addInPlace(G.AA.Vector3[2]),N.scaleToRef(x(3,t),G.AA.Vector3[2]),this.l11.addInPlace(G.AA.Vector3[2]),N.scaleToRef(x(4,t),G.AA.Vector3[2]),this.l2_2.addInPlace(G.AA.Vector3[2]),N.scaleToRef(x(5,t),G.AA.Vector3[2]),this.l2_1.addInPlace(G.AA.Vector3[2]),N.scaleToRef(x(6,t),G.AA.Vector3[2]),this.l20.addInPlace(G.AA.Vector3[2]),N.scaleToRef(x(7,t),G.AA.Vector3[2]),this.l21.addInPlace(G.AA.Vector3[2]),N.scaleToRef(x(8,t),G.AA.Vector3[2]),this.l22.addInPlace(G.AA.Vector3[2])}scaleInPlace(t){this.l00.scaleInPlace(t),this.l1_1.scaleInPlace(t),this.l10.scaleInPlace(t),this.l11.scaleInPlace(t),this.l2_2.scaleInPlace(t),this.l2_1.scaleInPlace(t),this.l20.scaleInPlace(t),this.l21.scaleInPlace(t),this.l22.scaleInPlace(t)}convertIncidentRadianceToIrradiance(){this.l00.scaleInPlace(b[0]),this.l1_1.scaleInPlace(b[1]),this.l10.scaleInPlace(b[2]),this.l11.scaleInPlace(b[3]),this.l2_2.scaleInPlace(b[4]),this.l2_1.scaleInPlace(b[5]),this.l20.scaleInPlace(b[6]),this.l21.scaleInPlace(b[7]),this.l22.scaleInPlace(b[8])}convertIrradianceToLambertianRadiance(){this.scaleInPlace(1/Math.PI)}preScaleForRendering(){this.preScaled=!0,this.l00.scaleInPlace(N[0]),this.l1_1.scaleInPlace(N[1]),this.l10.scaleInPlace(N[2]),this.l11.scaleInPlace(N[3]),this.l2_2.scaleInPlace(N[4]),this.l2_1.scaleInPlace(N[5]),this.l20.scaleInPlace(N[6]),this.l21.scaleInPlace(N[7]),this.l22.scaleInPlace(N[8])}updateFromArray(t){return a.Pq.FromArrayToRef(t[0],0,this.l00),a.Pq.FromArrayToRef(t[1],0,this.l1_1),a.Pq.FromArrayToRef(t[2],0,this.l10),a.Pq.FromArrayToRef(t[3],0,this.l11),a.Pq.FromArrayToRef(t[4],0,this.l2_2),a.Pq.FromArrayToRef(t[5],0,this.l2_1),a.Pq.FromArrayToRef(t[6],0,this.l20),a.Pq.FromArrayToRef(t[7],0,this.l21),a.Pq.FromArrayToRef(t[8],0,this.l22),this}updateFromFloatsArray(t){return a.Pq.FromFloatsToRef(t[0],t[1],t[2],this.l00),a.Pq.FromFloatsToRef(t[3],t[4],t[5],this.l1_1),a.Pq.FromFloatsToRef(t[6],t[7],t[8],this.l10),a.Pq.FromFloatsToRef(t[9],t[10],t[11],this.l11),a.Pq.FromFloatsToRef(t[12],t[13],t[14],this.l2_2),a.Pq.FromFloatsToRef(t[15],t[16],t[17],this.l2_1),a.Pq.FromFloatsToRef(t[18],t[19],t[20],this.l20),a.Pq.FromFloatsToRef(t[21],t[22],t[23],this.l21),a.Pq.FromFloatsToRef(t[24],t[25],t[26],this.l22),this}static FromArray(t){return(new n).updateFromArray(t)}static FromPolynomial(t){const K=new n;return K.l00=t.xx.scale(.376127).add(t.yy.scale(.376127)).add(t.zz.scale(.376126)),K.l1_1=t.y.scale(.977204),K.l10=t.z.scale(.977204),K.l11=t.x.scale(.977204),K.l2_2=t.xy.scale(1.16538),K.l2_1=t.yz.scale(1.16538),K.l20=t.zz.scale(1.34567).subtract(t.xx.scale(.672834)).subtract(t.yy.scale(.672834)),K.l21=t.zx.scale(1.16538),K.l22=t.xx.scale(1.16538).subtract(t.yy.scale(1.16538)),K.l1_1.scaleInPlace(-1),K.l11.scaleInPlace(-1),K.l2_1.scaleInPlace(-1),K.l21.scaleInPlace(-1),K.scaleInPlace(Math.PI),K}}class e{constructor(){this.x=a.Pq.Zero(),this.y=a.Pq.Zero(),this.z=a.Pq.Zero(),this.xx=a.Pq.Zero(),this.yy=a.Pq.Zero(),this.zz=a.Pq.Zero(),this.xy=a.Pq.Zero(),this.yz=a.Pq.Zero(),this.zx=a.Pq.Zero()}get preScaledHarmonics(){return this._harmonics||(this._harmonics=n.FromPolynomial(this)),this._harmonics.preScaled||this._harmonics.preScaleForRendering(),this._harmonics}addAmbient(t){G.AA.Vector3[0].copyFromFloats(t.r,t.g,t.b);const K=G.AA.Vector3[0];this.xx.addInPlace(K),this.yy.addInPlace(K),this.zz.addInPlace(K)}scaleInPlace(t){this.x.scaleInPlace(t),this.y.scaleInPlace(t),this.z.scaleInPlace(t),this.xx.scaleInPlace(t),this.yy.scaleInPlace(t),this.zz.scaleInPlace(t),this.yz.scaleInPlace(t),this.zx.scaleInPlace(t),this.xy.scaleInPlace(t)}updateFromHarmonics(t){return this._harmonics=t,this.x.copyFrom(t.l11),this.x.scaleInPlace(1.02333).scaleInPlace(-1),this.y.copyFrom(t.l1_1),this.y.scaleInPlace(1.02333).scaleInPlace(-1),this.z.copyFrom(t.l10),this.z.scaleInPlace(1.02333),this.xx.copyFrom(t.l00),G.AA.Vector3[0].copyFrom(t.l20).scaleInPlace(.247708),G.AA.Vector3[1].copyFrom(t.l22).scaleInPlace(.429043),this.xx.scaleInPlace(.886277).subtractInPlace(G.AA.Vector3[0]).addInPlace(G.AA.Vector3[1]),this.yy.copyFrom(t.l00),this.yy.scaleInPlace(.886277).subtractInPlace(G.AA.Vector3[0]).subtractInPlace(G.AA.Vector3[1]),this.zz.copyFrom(t.l00),G.AA.Vector3[0].copyFrom(t.l20).scaleInPlace(.495417),this.zz.scaleInPlace(.886277).addInPlace(G.AA.Vector3[0]),this.yz.copyFrom(t.l2_1),this.yz.scaleInPlace(.858086).scaleInPlace(-1),this.zx.copyFrom(t.l21),this.zx.scaleInPlace(.858086).scaleInPlace(-1),this.xy.copyFrom(t.l2_2),this.xy.scaleInPlace(.858086),this.scaleInPlace(1/Math.PI),this}static FromHarmonics(t){return(new e).updateFromHarmonics(t)}static FromArray(t){const K=new e;return a.Pq.FromArrayToRef(t[0],0,K.x),a.Pq.FromArrayToRef(t[1],0,K.y),a.Pq.FromArrayToRef(t[2],0,K.z),a.Pq.FromArrayToRef(t[3],0,K.xx),a.Pq.FromArrayToRef(t[4],0,K.yy),a.Pq.FromArrayToRef(t[5],0,K.zz),a.Pq.FromArrayToRef(t[6],0,K.yz),a.Pq.FromArrayToRef(t[7],0,K.zx),a.Pq.FromArrayToRef(t[8],0,K.xy),K}}},672506:(t,K,D)=>{D.d(K,{A:()=>G});var a=D(389011);class G extends a.n{constructor(t){super(),this._buffer=t}get underlyingResource(){return this._buffer}}},938868:(t,K,D)=>{D.d(K,{u:()=>y});var a=D(297809),G=D(638113),N=D(604910),W=D(23987),x=D(818696),b=D(633727),n=D(79160),e=D(59036),i=D(384898),z=D(775316),I=D(554014),Z=D(755752),w=D(332290),m=D(779908),u=D(690096),d=D(310035),E=D(760998),l=D(33321);class Q{constructor(){this.facetNb=0,this.partitioningSubdivisions=10,this.partitioningBBoxRatio=1.01,this.facetDataEnabled=!1,this.facetParameters={},this.bbSize=N.Pq.Zero(),this.subDiv={max:1,X:1,Y:1,Z:1},this.facetDepthSort=!1,this.facetDepthSortEnabled=!1}}class P{constructor(){this._hasVertexAlpha=!1,this._useVertexColors=!0,this._numBoneInfluencers=4,this._applyFog=!0,this._receiveShadows=!1,this._facetData=new Q,this._visibility=1,this._skeleton=null,this._layerMask=268435455,this._computeBonesUsingShaders=!0,this._isActive=!1,this._onlyForInstances=!1,this._isActiveIntermediate=!1,this._onlyForInstancesIntermediate=!1,this._actAsRegularMesh=!1,this._currentLOD=null,this._currentLODIsUpToDate=!1,this._collisionRetryCount=3,this._morphTargetManager=null,this._renderingGroupId=0,this._bakedVertexAnimationManager=null,this._material=null,this._positions=null,this._pointerOverDisableMeshTesting=!1,this._meshCollisionData=new z.j,this._enableDistantPicking=!1,this._rawBoundingInfo=null,this._sideOrientationHint=!1,this._inheritVisibility=!1}}class y extends b.V{static get BILLBOARDMODE_NONE(){return b.V.BILLBOARDMODE_NONE}static get BILLBOARDMODE_X(){return b.V.BILLBOARDMODE_X}static get BILLBOARDMODE_Y(){return b.V.BILLBOARDMODE_Y}static get BILLBOARDMODE_Z(){return b.V.BILLBOARDMODE_Z}static get BILLBOARDMODE_ALL(){return b.V.BILLBOARDMODE_ALL}static get BILLBOARDMODE_USE_POSITION(){return b.V.BILLBOARDMODE_USE_POSITION}get facetNb(){return this._internalAbstractMeshDataInfo._facetData.facetNb}get partitioningSubdivisions(){return this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions}set partitioningSubdivisions(t){this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions=t}get partitioningBBoxRatio(){return this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio}set partitioningBBoxRatio(t){this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio=t}get mustDepthSortFacets(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSort}set mustDepthSortFacets(t){this._internalAbstractMeshDataInfo._facetData.facetDepthSort=t}get facetDepthSortFrom(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom}set facetDepthSortFrom(t){this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom=t}get collisionRetryCount(){return this._internalAbstractMeshDataInfo._collisionRetryCount}set collisionRetryCount(t){this._internalAbstractMeshDataInfo._collisionRetryCount=t}get isFacetDataEnabled(){return this._internalAbstractMeshDataInfo._facetData.facetDataEnabled}get morphTargetManager(){return this._internalAbstractMeshDataInfo._morphTargetManager}set morphTargetManager(t){this._internalAbstractMeshDataInfo._morphTargetManager!==t&&(this._internalAbstractMeshDataInfo._morphTargetManager=t,this._syncGeometryWithMorphTargetManager())}get bakedVertexAnimationManager(){return this._internalAbstractMeshDataInfo._bakedVertexAnimationManager}set bakedVertexAnimationManager(t){this._internalAbstractMeshDataInfo._bakedVertexAnimationManager!==t&&(this._internalAbstractMeshDataInfo._bakedVertexAnimationManager=t,this._markSubMeshesAsAttributesDirty())}_syncGeometryWithMorphTargetManager(){}_updateNonUniformScalingState(t){return!!super._updateNonUniformScalingState(t)&&(this._markSubMeshesAsMiscDirty(),!0)}get rawBoundingInfo(){return this._internalAbstractMeshDataInfo._rawBoundingInfo}set rawBoundingInfo(t){this._internalAbstractMeshDataInfo._rawBoundingInfo=t}set onCollide(t){this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver&&this.onCollideObservable.remove(this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver),this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver=this.onCollideObservable.add(t)}set onCollisionPositionChange(t){this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver&&this.onCollisionPositionChangeObservable.remove(this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver),this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver=this.onCollisionPositionChangeObservable.add(t)}get visibility(){return this._internalAbstractMeshDataInfo._visibility}set visibility(t){if(this._internalAbstractMeshDataInfo._visibility===t)return;const K=this._internalAbstractMeshDataInfo._visibility;this._internalAbstractMeshDataInfo._visibility=t,(1===K&&1!==t||1!==K&&1===t)&&this._markSubMeshesAsDirty((t=>{t.markAsMiscDirty(),t.markAsPrePassDirty()}))}get inheritVisibility(){return this._internalAbstractMeshDataInfo._inheritVisibility}set inheritVisibility(t){this._internalAbstractMeshDataInfo._inheritVisibility=t}get isVisible(){if(!this._isVisible||!this.inheritVisibility||!this._parentNode)return this._isVisible;if(this._isVisible){let t=this._parentNode;for(;t;){const K=t.isVisible;if(void 0!==K)return K;t=t.parent}}return this._isVisible}set isVisible(t){this._isVisible=t}get pointerOverDisableMeshTesting(){return this._internalAbstractMeshDataInfo._pointerOverDisableMeshTesting}set pointerOverDisableMeshTesting(t){this._internalAbstractMeshDataInfo._pointerOverDisableMeshTesting=t}get renderingGroupId(){return this._internalAbstractMeshDataInfo._renderingGroupId}set renderingGroupId(t){this._internalAbstractMeshDataInfo._renderingGroupId=t}get material(){return this._internalAbstractMeshDataInfo._material}set material(t){this._setMaterial(t)}_setMaterial(t){this._internalAbstractMeshDataInfo._material!==t&&(this._internalAbstractMeshDataInfo._material&&this._internalAbstractMeshDataInfo._material.meshMap&&(this._internalAbstractMeshDataInfo._material.meshMap[this.uniqueId]=void 0),this._internalAbstractMeshDataInfo._material=t,t&&t.meshMap&&(t.meshMap[this.uniqueId]=this),this.onMaterialChangedObservable.hasObservers()&&this.onMaterialChangedObservable.notifyObservers(this),this.subMeshes&&(this.resetDrawCache(),this._unBindEffect()))}getMaterialForRenderPass(t){var K;return null===(K=this._internalAbstractMeshDataInfo._materialForRenderPass)||void 0===K?void 0:K[t]}setMaterialForRenderPass(t,K){this.resetDrawCache(t),this._internalAbstractMeshDataInfo._materialForRenderPass||(this._internalAbstractMeshDataInfo._materialForRenderPass=[]),this._internalAbstractMeshDataInfo._materialForRenderPass[t]=K}get receiveShadows(){return this._internalAbstractMeshDataInfo._receiveShadows}set receiveShadows(t){this._internalAbstractMeshDataInfo._receiveShadows!==t&&(this._internalAbstractMeshDataInfo._receiveShadows=t,this._markSubMeshesAsLightDirty())}get hasVertexAlpha(){return this._internalAbstractMeshDataInfo._hasVertexAlpha}set hasVertexAlpha(t){this._internalAbstractMeshDataInfo._hasVertexAlpha!==t&&(this._internalAbstractMeshDataInfo._hasVertexAlpha=t,this._markSubMeshesAsAttributesDirty(),this._markSubMeshesAsMiscDirty())}get useVertexColors(){return this._internalAbstractMeshDataInfo._useVertexColors}set useVertexColors(t){this._internalAbstractMeshDataInfo._useVertexColors!==t&&(this._internalAbstractMeshDataInfo._useVertexColors=t,this._markSubMeshesAsAttributesDirty())}get computeBonesUsingShaders(){return this._internalAbstractMeshDataInfo._computeBonesUsingShaders}set computeBonesUsingShaders(t){this._internalAbstractMeshDataInfo._computeBonesUsingShaders!==t&&(this._internalAbstractMeshDataInfo._computeBonesUsingShaders=t,this._markSubMeshesAsAttributesDirty())}get numBoneInfluencers(){return this._internalAbstractMeshDataInfo._numBoneInfluencers}set numBoneInfluencers(t){this._internalAbstractMeshDataInfo._numBoneInfluencers!==t&&(this._internalAbstractMeshDataInfo._numBoneInfluencers=t,this._markSubMeshesAsAttributesDirty())}get applyFog(){return this._internalAbstractMeshDataInfo._applyFog}set applyFog(t){this._internalAbstractMeshDataInfo._applyFog!==t&&(this._internalAbstractMeshDataInfo._applyFog=t,this._markSubMeshesAsMiscDirty())}get enableDistantPicking(){return this._internalAbstractMeshDataInfo._enableDistantPicking}set enableDistantPicking(t){this._internalAbstractMeshDataInfo._enableDistantPicking=t}get layerMask(){return this._internalAbstractMeshDataInfo._layerMask}set layerMask(t){t!==this._internalAbstractMeshDataInfo._layerMask&&(this._internalAbstractMeshDataInfo._layerMask=t,this._resyncLightSources())}get collisionMask(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionMask}set collisionMask(t){this._internalAbstractMeshDataInfo._meshCollisionData._collisionMask=isNaN(t)?-1:t}get collisionResponse(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionResponse}set collisionResponse(t){this._internalAbstractMeshDataInfo._meshCollisionData._collisionResponse=t}get collisionGroup(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionGroup}set collisionGroup(t){this._internalAbstractMeshDataInfo._meshCollisionData._collisionGroup=isNaN(t)?-1:t}get surroundingMeshes(){return this._internalAbstractMeshDataInfo._meshCollisionData._surroundingMeshes}set surroundingMeshes(t){this._internalAbstractMeshDataInfo._meshCollisionData._surroundingMeshes=t}get lightSources(){return this._lightSources}set skeleton(t){const K=this._internalAbstractMeshDataInfo._skeleton;K&&K.needInitialSkinMatrix&&K._unregisterMeshWithPoseMatrix(this),t&&t.needInitialSkinMatrix&&t._registerMeshWithPoseMatrix(this),this._internalAbstractMeshDataInfo._skeleton=t,this._internalAbstractMeshDataInfo._skeleton||(this._bonesTransformMatrices=null),this._markSubMeshesAsAttributesDirty()}get skeleton(){return this._internalAbstractMeshDataInfo._skeleton}constructor(t,K=null){switch(super(t,K,!1),this._internalAbstractMeshDataInfo=new P,this._waitingMaterialId=null,this.cullingStrategy=y.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY,this.onCollideObservable=new G.cP,this.onCollisionPositionChangeObservable=new G.cP,this.onMaterialChangedObservable=new G.cP,this.definedFacingForward=!0,this._occlusionQuery=null,this._renderingGroup=null,this.alphaIndex=Number.MAX_VALUE,this._isVisible=!0,this.isPickable=!0,this.isNearPickable=!1,this.isNearGrabbable=!1,this.showSubMeshesBoundingBox=!1,this.isBlocker=!1,this.enablePointerMoveEvents=!1,this.outlineColor=w.v9.Red(),this.outlineWidth=.02,this.overlayColor=w.v9.Red(),this.overlayAlpha=.5,this.useOctreeForRenderingSelection=!0,this.useOctreeForPicking=!0,this.useOctreeForCollisions=!0,this.alwaysSelectAsActiveMesh=!1,this.doNotSyncBoundingInfo=!1,this.actionManager=null,this.ellipsoid=new N.Pq(.5,1,.5),this.ellipsoidOffset=new N.Pq(0,0,0),this.edgesWidth=1,this.edgesColor=new w.ov(1,0,0,1),this._edgesRenderer=null,this._masterMesh=null,this._boundingInfo=null,this._boundingInfoIsDirty=!0,this._renderId=0,this._intersectionsInProgress=new Array,this._unIndexed=!1,this._lightSources=new Array,this._waitingData={lods:null,actions:null,freezeWorldMatrix:null},this._bonesTransformMatrices=null,this._transformMatrixTexture=null,this.onRebuildObservable=new G.cP,this._onCollisionPositionChange=(t,K,D=null)=>{K.subtractToRef(this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions,this._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions),this._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions.length()>l.$.CollisionsEpsilon&&this.position.addInPlace(this._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions),D&&this.onCollideObservable.notifyObservers(D),this.onCollisionPositionChangeObservable.notifyObservers(this.position)},(K=this.getScene()).addMesh(this),this._resyncLightSources(),this._uniformBuffer=new i.D(this.getScene().getEngine(),void 0,void 0,t,!this.getScene().getEngine().isWebGPU),this._buildUniformLayout(),K.performancePriority){case 2:this.doNotSyncBoundingInfo=!0;case 1:this.alwaysSelectAsActiveMesh=!0,this.isPickable=!1}}_buildUniformLayout(){this._uniformBuffer.addUniform("world",16),this._uniformBuffer.addUniform("visibility",1),this._uniformBuffer.create()}transferToEffect(t){const K=this._uniformBuffer;K.updateMatrix("world",t),K.updateFloat("visibility",this._internalAbstractMeshDataInfo._visibility),K.update()}getMeshUniformBuffer(){return this._uniformBuffer}getClassName(){return"AbstractMesh"}toString(t){let K="Name: "+this.name+", isInstance: "+("InstancedMesh"!==this.getClassName()?"YES":"NO");K+=", # of submeshes: "+(this.subMeshes?this.subMeshes.length:0);const D=this._internalAbstractMeshDataInfo._skeleton;return D&&(K+=", skeleton: "+D.name),t&&(K+=", billboard mode: "+["NONE","X","Y",null,"Z",null,null,"ALL"][this.billboardMode],K+=", freeze wrld mat: "+(this._isWorldMatrixFrozen||this._waitingData.freezeWorldMatrix?"YES":"NO")),K}_getEffectiveParent(){return this._masterMesh&&this.billboardMode!==b.V.BILLBOARDMODE_NONE?this._masterMesh:super._getEffectiveParent()}_getActionManagerForTrigger(t,K=!0){if(this.actionManager&&(K||this.actionManager.isRecursive)){if(!t)return this.actionManager;if(this.actionManager.hasSpecificTrigger(t))return this.actionManager}return this.parent?this.parent._getActionManagerForTrigger(t,!1):null}_rebuild(t=!1){if(this.onRebuildObservable.notifyObservers(this),null!==this._occlusionQuery&&(this._occlusionQuery=null),this.subMeshes){for(const t of this.subMeshes)t._rebuild();this.resetDrawCache()}}_resyncLightSources(){this._lightSources.length=0;for(const t of this.getScene().lights)t.isEnabled()&&t.canAffectMesh(this)&&this._lightSources.push(t);this._markSubMeshesAsLightDirty()}_resyncLightSource(t){const K=t.isEnabled()&&t.canAffectMesh(this),D=this._lightSources.indexOf(t);let a=!1;if(-1===D){if(!K)return;this._lightSources.push(t)}else{if(K)return;a=!0,this._lightSources.splice(D,1)}this._markSubMeshesAsLightDirty(a)}_unBindEffect(){for(const t of this.subMeshes)t.setEffect(null)}_removeLightSource(t,K){const D=this._lightSources.indexOf(t);-1!==D&&(this._lightSources.splice(D,1),this._markSubMeshesAsLightDirty(K))}_markSubMeshesAsDirty(t){if(this.subMeshes)for(const K of this.subMeshes)for(let D=0;D<K._drawWrappers.length;++D){const a=K._drawWrappers[D];a&&a.defines&&a.defines.markAllAsDirty&&t(a.defines)}}_markSubMeshesAsLightDirty(t=!1){this._markSubMeshesAsDirty((K=>K.markAsLightDirty(t)))}_markSubMeshesAsAttributesDirty(){this._markSubMeshesAsDirty((t=>t.markAsAttributesDirty()))}_markSubMeshesAsMiscDirty(){this._markSubMeshesAsDirty((t=>t.markAsMiscDirty()))}markAsDirty(t){return this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this}resetDrawCache(t){if(this.subMeshes)for(const K of this.subMeshes)K.resetDrawCache(t)}get isBlocked(){return!1}getLOD(t){return this}getTotalVertices(){return 0}getTotalIndices(){return 0}getIndices(){return null}getVerticesData(t){return null}setVerticesData(t,K,D,a){return this}updateVerticesData(t,K,D,a){return this}setIndices(t,K){return this}isVerticesDataPresent(t){return!1}getBoundingInfo(){return this._masterMesh?this._masterMesh.getBoundingInfo():(this._boundingInfoIsDirty&&(this._boundingInfoIsDirty=!1,this._updateBoundingInfo()),this._boundingInfo)}getRawBoundingInfo(){var t;return null!==(t=this.rawBoundingInfo)&&void 0!==t?t:this.getBoundingInfo()}setBoundingInfo(t){return this._boundingInfo=t,this}get hasBoundingInfo(){return null!==this._boundingInfo}buildBoundingInfo(t,K,D){return this._boundingInfo=new e.j(t,K,D),this._boundingInfo}normalizeToUnitCube(t=!0,K=!1,D){return super.normalizeToUnitCube(t,K,D)}get useBones(){return this.skeleton&&this.getScene().skeletonsEnabled&&this.isVerticesDataPresent(W.R.MatricesIndicesKind)&&this.isVerticesDataPresent(W.R.MatricesWeightsKind)}_preActivate(){}_preActivateForIntermediateRendering(t){}_activate(t,K){return this._renderId=t,!0}_postActivate(){}_freeze(){}_unFreeze(){}getWorldMatrix(){return this._masterMesh&&this.billboardMode===b.V.BILLBOARDMODE_NONE?this._masterMesh.getWorldMatrix():super.getWorldMatrix()}_getWorldMatrixDeterminant(){return this._masterMesh?this._masterMesh._getWorldMatrixDeterminant():super._getWorldMatrixDeterminant()}get isAnInstance(){return!1}get hasInstances(){return!1}get hasThinInstances(){return!1}movePOV(t,K,D){return this.position.addInPlace(this.calcMovePOV(t,K,D)),this}calcMovePOV(t,K,D){const a=new N.uq;(this.rotationQuaternion?this.rotationQuaternion:N.PT.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z)).toRotationMatrix(a);const G=N.Pq.Zero(),W=this.definedFacingForward?-1:1;return N.Pq.TransformCoordinatesFromFloatsToRef(t*W,K,D*W,a,G),G}rotatePOV(t,K,D){return this.rotation.addInPlace(this.calcRotatePOV(t,K,D)),this}calcRotatePOV(t,K,D){const a=this.definedFacingForward?1:-1;return new N.Pq(t*a,K,D*a)}_refreshBoundingInfo(t,K){if(t){const D=Z.b(t,0,this.getTotalVertices(),K);this._boundingInfo?this._boundingInfo.reConstruct(D.minimum,D.maximum):this._boundingInfo=new e.j(D.minimum,D.maximum)}if(this.subMeshes)for(let K=0;K<this.subMeshes.length;K++)this.subMeshes[K].refreshBoundingInfo(t);this._updateBoundingInfo()}_refreshBoundingInfoDirect(t){if(this._boundingInfo?this._boundingInfo.reConstruct(t.minimum,t.maximum):this._boundingInfo=new e.j(t.minimum,t.maximum),this.subMeshes)for(let t=0;t<this.subMeshes.length;t++)this.subMeshes[t].refreshBoundingInfo(null);this._updateBoundingInfo()}static _ApplySkeleton(t,K,D,a,G,x,b){(function(t,K,D,a,G,x,b){const n=N.AA.Vector3[0],e=N.AA.Matrix[0],i=N.AA.Matrix[1],z=K===W.R.NormalKind?N.Pq.TransformNormalFromFloatsToRef:N.Pq.TransformCoordinatesFromFloatsToRef;for(let K=0,W=0;K<t.length;K+=3,W+=4){let I,Z;for(e.reset(),I=0;I<4;I++)Z=G[W+I],Z>0&&(N.uq.FromFloat32ArrayToRefScaled(D,Math.floor(16*a[W+I]),Z,i),e.addToSelf(i));if(x&&b)for(I=0;I<4;I++)Z=b[W+I],Z>0&&(N.uq.FromFloat32ArrayToRefScaled(D,Math.floor(16*x[W+I]),Z,i),e.addToSelf(i));z(t[K],t[K+1],t[K+2],e,n),n.toArray(t,K)}})(t,K,D,a,G,x,b)}_getData(t,K,D=W.R.PositionKind){const a=t.cache,G=t=>{if(a){const K=a._vertexData||(a._vertexData={});return K[t]||this.copyVerticesData(t,K),K[t]}return this.getVerticesData(t)};if(K||(K=G(D)),!K)return null;if(a?(a._outputData?a._outputData.set(K):a._outputData=new Float32Array(K),K=a._outputData):(t.applyMorph&&this.morphTargetManager||t.applySkeleton&&this.skeleton)&&(K=K.slice()),t.applyMorph&&this.morphTargetManager&&function(t,K,D){let a=null;switch(K){case W.R.PositionKind:a=t=>t.getPositions();break;case W.R.NormalKind:a=t=>t.getNormals();break;case W.R.TangentKind:a=t=>t.getTangents();break;case W.R.UVKind:a=t=>t.getUVs();break;default:return}for(let K=0;K<t.length;K++){let G=t[K];for(let N=0;N<D.numTargets;N++){const W=D.getTarget(N),x=W.influence;if(0!==x){const D=a(W);D&&(G+=(D[K]-t[K])*x)}}t[K]=G}}(K,D,this.morphTargetManager),t.applySkeleton&&this.skeleton){const t=G(W.R.MatricesIndicesKind),a=G(W.R.MatricesWeightsKind);if(a&&t){const N=this.numBoneInfluencers>4,x=N?G(W.R.MatricesIndicesExtraKind):null,b=N?G(W.R.MatricesWeightsExtraKind):null,n=this.skeleton.getTransformMatrices(this);y._ApplySkeleton(K,D,n,t,a,x,b)}}if(!1!==t.updatePositionsArray&&D===W.R.PositionKind){const t=this._internalAbstractMeshDataInfo._positions||[],D=t.length;if(t.length=K.length/3,D<t.length)for(let K=D;K<t.length;K++)t[K]=new N.Pq;for(let D=0,a=0;D<t.length;D++,a+=3)t[D].copyFromFloats(K[a],K[a+1],K[a+2]);this._internalAbstractMeshDataInfo._positions=t}return K}getNormalsData(t=!1,K=!1){return this._getData({applySkeleton:t,applyMorph:K,updatePositionsArray:!1},null,W.R.NormalKind)}getPositionData(t=!1,K=!1,D=null){return this._getData({applySkeleton:t,applyMorph:K,updatePositionsArray:!1},D,W.R.PositionKind)}_updateBoundingInfo(){return this._boundingInfo?this._boundingInfo.update(this.worldMatrixFromCache):this._boundingInfo=new e.j(N.Pq.Zero(),N.Pq.Zero(),this.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache),this}_updateSubMeshesBoundingInfo(t){if(!this.subMeshes)return this;const K=this.subMeshes.length;for(let D=0;D<K;D++){const a=this.subMeshes[D];(K>1||!a.IsGlobal)&&a.updateBoundingInfo(t)}return this}_afterComputeWorldMatrix(){this.doNotSyncBoundingInfo||(this._boundingInfoIsDirty=!0)}isInFrustum(t){return this.getBoundingInfo().isInFrustum(t,this.cullingStrategy)}isCompletelyInFrustum(t){return this.getBoundingInfo().isCompletelyInFrustum(t)}intersectsMesh(t,K=!1,D){const a=this.getBoundingInfo(),G=t.getBoundingInfo();if(a.intersects(G,K))return!0;if(D)for(const D of this.getChildMeshes())if(D.intersectsMesh(t,K,!0))return!0;return!1}intersectsPoint(t){return this.getBoundingInfo().intersectsPoint(t)}get checkCollisions(){return this._internalAbstractMeshDataInfo._meshCollisionData._checkCollisions}set checkCollisions(t){this._internalAbstractMeshDataInfo._meshCollisionData._checkCollisions=t}get collider(){return this._internalAbstractMeshDataInfo._meshCollisionData._collider}moveWithCollisions(t){this.getAbsolutePosition().addToRef(this.ellipsoidOffset,this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions);const K=this.getScene().collisionCoordinator;return this._internalAbstractMeshDataInfo._meshCollisionData._collider||(this._internalAbstractMeshDataInfo._meshCollisionData._collider=K.createCollider()),this._internalAbstractMeshDataInfo._meshCollisionData._collider._radius=this.ellipsoid,K.getNewPosition(this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions,t,this._internalAbstractMeshDataInfo._meshCollisionData._collider,this.collisionRetryCount,this,this._onCollisionPositionChange,this.uniqueId),this}_collideForSubMesh(t,K,D){var a;if(this._generatePointsArray(),!this._positions)return this;if(!t._lastColliderWorldVertices||!t._lastColliderTransformMatrix.equals(K)){t._lastColliderTransformMatrix=K.clone(),t._lastColliderWorldVertices=[],t._trianglePlanes=[];const D=t.verticesStart,a=t.verticesStart+t.verticesCount;for(let G=D;G<a;G++)t._lastColliderWorldVertices.push(N.Pq.TransformCoordinates(this._positions[G],K))}return D._collide(t._trianglePlanes,t._lastColliderWorldVertices,this.getIndices(),t.indexStart,t.indexStart+t.indexCount,t.verticesStart,!!t.getMaterial(),this,this._shouldConvertRHS(),7===(null===(a=t.getMaterial())||void 0===a?void 0:a.fillMode)),this}_processCollisionsForSubMeshes(t,K){const D=this._scene.getCollidingSubMeshCandidates(this,t),a=D.length;for(let G=0;G<a;G++){const N=D.data[G];a>1&&!N._checkCollision(t)||this._collideForSubMesh(N,K,t)}return this}_shouldConvertRHS(){return!1}_checkCollision(t){if(!this.getBoundingInfo()._checkCollision(t))return this;const K=N.AA.Matrix[0],D=N.AA.Matrix[1];return N.uq.ScalingToRef(1/t._radius.x,1/t._radius.y,1/t._radius.z,K),this.worldMatrixFromCache.multiplyToRef(K,D),this._processCollisionsForSubMeshes(t,D),this}_generatePointsArray(){return!1}intersects(t,K,D,a=!1,G,W=!1){const x=new n.G,b=this.getClassName(),e="InstancedLinesMesh"===b||"LinesMesh"===b||"GreasedLineMesh"===b?this.intersectionThreshold:0,i=this.getBoundingInfo();if(!this.subMeshes)return x;if(!(W||t.intersectsSphere(i.boundingSphere,e)&&t.intersectsBox(i.boundingBox,e)))return x;if(a)return x.hit=!W,x.pickedMesh=W?null:this,x.distance=W?0:N.Pq.Distance(t.origin,i.boundingSphere.center),x.subMeshId=0,x;if(!this._generatePointsArray())return x;let z=null;const I=this._scene.getIntersectingSubMeshCandidates(this,t),Z=I.length;let w=!1;for(let t=0;t<Z;t++){const K=I.data[t].getMaterial();if(K&&(7==K.fillMode||0==K.fillMode||1==K.fillMode||2==K.fillMode||4==K.fillMode)){w=!0;break}}if(!w)return x.hit=!0,x.pickedMesh=this,x.distance=N.Pq.Distance(t.origin,i.boundingSphere.center),x.subMeshId=-1,x;for(let a=0;a<Z;a++){const G=I.data[a];if(Z>1&&!W&&!G.canIntersects(t))continue;const N=G.intersects(t,this._positions,this.getIndices(),K,D);if(N&&(K||!z||N.distance<z.distance)&&(z=N,z.subMeshId=a,K))break}if(z){const K=null!=G?G:this.getWorldMatrix(),D=N.AA.Vector3[0],a=N.AA.Vector3[1];N.Pq.TransformCoordinatesToRef(t.origin,K,D),t.direction.scaleToRef(z.distance,a);const W=N.Pq.TransformNormal(a,K).addInPlace(D);return x.hit=!0,x.distance=N.Pq.Distance(D,W),x.pickedPoint=W,x.pickedMesh=this,x.bu=z.bu||0,x.bv=z.bv||0,x.subMeshFaceId=z.faceId,x.faceId=z.faceId+I.data[z.subMeshId].indexStart/(-1!==this.getClassName().indexOf("LinesMesh")?2:3),x.subMeshId=z.subMeshId,x}return x}clone(t,K,D){return null}releaseSubMeshes(){if(this.subMeshes)for(;this.subMeshes.length;)this.subMeshes[0].dispose();else this.subMeshes=[];return this}dispose(t,K=!1){let D;const a=this.getScene();for(this._scene.useMaterialMeshMap&&this._internalAbstractMeshDataInfo._material&&this._internalAbstractMeshDataInfo._material.meshMap&&(this._internalAbstractMeshDataInfo._material.meshMap[this.uniqueId]=void 0),a.freeActiveMeshes(),a.freeRenderingGroups(),a.renderingManager.maintainStateBetweenFrames&&a.renderingManager.restoreDispachedFlags(),void 0!==this.actionManager&&null!==this.actionManager&&(this.actionManager.disposeWhenUnowned&&!this._scene.meshes.some((t=>t!==this&&t.actionManager===this.actionManager))&&this.actionManager.dispose(),this.actionManager=null),this._internalAbstractMeshDataInfo._skeleton=null,this._transformMatrixTexture&&(this._transformMatrixTexture.dispose(),this._transformMatrixTexture=null),D=0;D<this._intersectionsInProgress.length;D++){const t=this._intersectionsInProgress[D],K=t._intersectionsInProgress.indexOf(this);t._intersectionsInProgress.splice(K,1)}this._intersectionsInProgress.length=0,a.lights.forEach((t=>{let K=t.includedOnlyMeshes.indexOf(this);-1!==K&&t.includedOnlyMeshes.splice(K,1),K=t.excludedMeshes.indexOf(this),-1!==K&&t.excludedMeshes.splice(K,1);const D=t.getShadowGenerators();if(D){const t=D.values();for(let D=t.next();!0!==D.done;D=t.next()){const t=D.value.getShadowMap();t&&t.renderList&&(K=t.renderList.indexOf(this),-1!==K&&t.renderList.splice(K,1))}}})),"InstancedMesh"===this.getClassName()&&"InstancedLinesMesh"===this.getClassName()||this.releaseSubMeshes();const G=a.getEngine();if(null!==this._occlusionQuery&&(this.isOcclusionQueryInProgress=!1,G.deleteQuery(this._occlusionQuery),this._occlusionQuery=null),G.wipeCaches(),a.removeMesh(this),this._parentContainer){const t=this._parentContainer.meshes.indexOf(this);t>-1&&this._parentContainer.meshes.splice(t,1),this._parentContainer=null}if(K&&this.material&&("MultiMaterial"===this.material.getClassName()?this.material.dispose(!1,!0,!0):this.material.dispose(!1,!0)),!t)for(D=0;D<a.particleSystems.length;D++)a.particleSystems[D].emitter===this&&(a.particleSystems[D].dispose(),D--);this._internalAbstractMeshDataInfo._facetData.facetDataEnabled&&this.disableFacetData(),this._uniformBuffer.dispose(),this.onAfterWorldMatrixUpdateObservable.clear(),this.onCollideObservable.clear(),this.onCollisionPositionChangeObservable.clear(),this.onRebuildObservable.clear(),super.dispose(t,K)}_initFacetData(){const t=this._internalAbstractMeshDataInfo._facetData;t.facetNormals||(t.facetNormals=[]),t.facetPositions||(t.facetPositions=[]),t.facetPartitioning||(t.facetPartitioning=new Array),t.facetNb=this.getIndices().length/3|0,t.partitioningSubdivisions=t.partitioningSubdivisions?t.partitioningSubdivisions:10,t.partitioningBBoxRatio=t.partitioningBBoxRatio?t.partitioningBBoxRatio:1.01;for(let K=0;K<t.facetNb;K++)t.facetNormals[K]=N.Pq.Zero(),t.facetPositions[K]=N.Pq.Zero();return t.facetDataEnabled=!0,this}updateFacetData(){const t=this._internalAbstractMeshDataInfo._facetData;t.facetDataEnabled||this._initFacetData();const K=this.getVerticesData(W.R.PositionKind),D=this.getIndices(),a=this.getVerticesData(W.R.NormalKind),G=this.getBoundingInfo();if(t.facetDepthSort&&!t.facetDepthSortEnabled){if(t.facetDepthSortEnabled=!0,D instanceof Uint16Array)t.depthSortedIndices=new Uint16Array(D);else if(D instanceof Uint32Array)t.depthSortedIndices=new Uint32Array(D);else{let K=!1;for(let t=0;t<D.length;t++)if(D[t]>65535){K=!0;break}t.depthSortedIndices=K?new Uint32Array(D):new Uint16Array(D)}if(t.facetDepthSortFunction=function(t,K){return K.sqDistance-t.sqDistance},!t.facetDepthSortFrom){const K=this.getScene().activeCamera;t.facetDepthSortFrom=K?K.position:N.Pq.Zero()}t.depthSortedFacets=[];for(let K=0;K<t.facetNb;K++){const D={ind:3*K,sqDistance:0};t.depthSortedFacets.push(D)}t.invertedMatrix=N.uq.Identity(),t.facetDepthSortOrigin=N.Pq.Zero()}t.bbSize.x=G.maximum.x-G.minimum.x>m.bH?G.maximum.x-G.minimum.x:m.bH,t.bbSize.y=G.maximum.y-G.minimum.y>m.bH?G.maximum.y-G.minimum.y:m.bH,t.bbSize.z=G.maximum.z-G.minimum.z>m.bH?G.maximum.z-G.minimum.z:m.bH;let b=t.bbSize.x>t.bbSize.y?t.bbSize.x:t.bbSize.y;if(b=b>t.bbSize.z?b:t.bbSize.z,t.subDiv.max=t.partitioningSubdivisions,t.subDiv.X=Math.floor(t.subDiv.max*t.bbSize.x/b),t.subDiv.Y=Math.floor(t.subDiv.max*t.bbSize.y/b),t.subDiv.Z=Math.floor(t.subDiv.max*t.bbSize.z/b),t.subDiv.X=t.subDiv.X<1?1:t.subDiv.X,t.subDiv.Y=t.subDiv.Y<1?1:t.subDiv.Y,t.subDiv.Z=t.subDiv.Z<1?1:t.subDiv.Z,t.facetParameters.facetNormals=this.getFacetLocalNormals(),t.facetParameters.facetPositions=this.getFacetLocalPositions(),t.facetParameters.facetPartitioning=this.getFacetLocalPartitioning(),t.facetParameters.bInfo=G,t.facetParameters.bbSize=t.bbSize,t.facetParameters.subDiv=t.subDiv,t.facetParameters.ratio=this.partitioningBBoxRatio,t.facetParameters.depthSort=t.facetDepthSort,t.facetDepthSort&&t.facetDepthSortEnabled&&(this.computeWorldMatrix(!0),this._worldMatrix.invertToRef(t.invertedMatrix),N.Pq.TransformCoordinatesToRef(t.facetDepthSortFrom,t.invertedMatrix,t.facetDepthSortOrigin),t.facetParameters.distanceTo=t.facetDepthSortOrigin),t.facetParameters.depthSortedFacets=t.depthSortedFacets,a&&x.P.ComputeNormals(K,D,a,t.facetParameters),t.facetDepthSort&&t.facetDepthSortEnabled){t.depthSortedFacets.sort(t.facetDepthSortFunction);const K=t.depthSortedIndices.length/3|0;for(let a=0;a<K;a++){const K=t.depthSortedFacets[a].ind;t.depthSortedIndices[3*a]=D[K],t.depthSortedIndices[3*a+1]=D[K+1],t.depthSortedIndices[3*a+2]=D[K+2]}this.updateIndices(t.depthSortedIndices,void 0,!0)}return this}getFacetLocalNormals(){const t=this._internalAbstractMeshDataInfo._facetData;return t.facetNormals||this.updateFacetData(),t.facetNormals}getFacetLocalPositions(){const t=this._internalAbstractMeshDataInfo._facetData;return t.facetPositions||this.updateFacetData(),t.facetPositions}getFacetLocalPartitioning(){const t=this._internalAbstractMeshDataInfo._facetData;return t.facetPartitioning||this.updateFacetData(),t.facetPartitioning}getFacetPosition(t){const K=N.Pq.Zero();return this.getFacetPositionToRef(t,K),K}getFacetPositionToRef(t,K){const D=this.getFacetLocalPositions()[t],a=this.getWorldMatrix();return N.Pq.TransformCoordinatesToRef(D,a,K),this}getFacetNormal(t){const K=N.Pq.Zero();return this.getFacetNormalToRef(t,K),K}getFacetNormalToRef(t,K){const D=this.getFacetLocalNormals()[t];return N.Pq.TransformNormalToRef(D,this.getWorldMatrix(),K),this}getFacetsAtLocalCoordinates(t,K,D){const a=this.getBoundingInfo(),G=this._internalAbstractMeshDataInfo._facetData,N=Math.floor((t-a.minimum.x*G.partitioningBBoxRatio)*G.subDiv.X*G.partitioningBBoxRatio/G.bbSize.x),W=Math.floor((K-a.minimum.y*G.partitioningBBoxRatio)*G.subDiv.Y*G.partitioningBBoxRatio/G.bbSize.y),x=Math.floor((D-a.minimum.z*G.partitioningBBoxRatio)*G.subDiv.Z*G.partitioningBBoxRatio/G.bbSize.z);return N<0||N>G.subDiv.max||W<0||W>G.subDiv.max||x<0||x>G.subDiv.max?null:G.facetPartitioning[N+G.subDiv.max*W+G.subDiv.max*G.subDiv.max*x]}getClosestFacetAtCoordinates(t,K,D,a,G=!1,W=!0){const x=this.getWorldMatrix(),b=N.AA.Matrix[5];x.invertToRef(b);const n=N.AA.Vector3[8];N.Pq.TransformCoordinatesFromFloatsToRef(t,K,D,b,n);const e=this.getClosestFacetAtLocalCoordinates(n.x,n.y,n.z,a,G,W);return a&&N.Pq.TransformCoordinatesFromFloatsToRef(a.x,a.y,a.z,x,a),e}getClosestFacetAtLocalCoordinates(t,K,D,a,G=!1,N=!0){let W=null,x=0,b=0,n=0,e=0,i=0,z=0,I=0,Z=0;const w=this.getFacetLocalPositions(),m=this.getFacetLocalNormals(),u=this.getFacetsAtLocalCoordinates(t,K,D);if(!u)return null;let d,E,l,Q=Number.MAX_VALUE,P=Q;for(let y=0;y<u.length;y++)d=u[y],E=m[d],l=w[d],e=(t-l.x)*E.x+(K-l.y)*E.y+(D-l.z)*E.z,(!G||G&&N&&e>=0||G&&!N&&e<=0)&&(e=E.x*l.x+E.y*l.y+E.z*l.z,i=-(E.x*t+E.y*K+E.z*D-e)/(E.x*E.x+E.y*E.y+E.z*E.z),z=t+E.x*i,I=K+E.y*i,Z=D+E.z*i,x=z-t,b=I-K,n=Z-D,P=x*x+b*b+n*n,P<Q&&(Q=P,W=d,a&&(a.x=z,a.y=I,a.z=Z)));return W}getFacetDataParameters(){return this._internalAbstractMeshDataInfo._facetData.facetParameters}disableFacetData(){const t=this._internalAbstractMeshDataInfo._facetData;return t.facetDataEnabled&&(t.facetDataEnabled=!1,t.facetPositions=[],t.facetNormals=[],t.facetPartitioning=new Array,t.facetParameters=null,t.depthSortedIndices=new Uint32Array(0)),this}updateIndices(t,K,D=!1){return this}createNormals(t){const K=this.getVerticesData(W.R.PositionKind),D=this.getIndices();let a;return a=this.isVerticesDataPresent(W.R.NormalKind)?this.getVerticesData(W.R.NormalKind):[],x.P.ComputeNormals(K,D,a,{useRightHandedSystem:this.getScene().useRightHandedSystem}),this.setVerticesData(W.R.NormalKind,a,t),this}alignWithNormal(t,K){K||(K=u._0.Y);const D=N.AA.Vector3[0],a=N.AA.Vector3[1];return N.Pq.CrossToRef(K,t,a),N.Pq.CrossToRef(t,a,D),this.rotationQuaternion?N.PT.RotationQuaternionFromAxisToRef(D,t,a,this.rotationQuaternion):N.Pq.RotationFromAxisToRef(D,t,a,this.rotation),this}_checkOcclusionQuery(){return!1}disableEdgesRendering(){throw I.n("EdgesRenderer")}enableEdgesRendering(t,K,D){throw I.n("EdgesRenderer")}getConnectedParticleSystems(){return this._scene.particleSystems.filter((t=>t.emitter===this))}}y.OCCLUSION_TYPE_NONE=0,y.OCCLUSION_TYPE_OPTIMISTIC=1,y.OCCLUSION_TYPE_STRICT=2,y.OCCLUSION_ALGORITHM_TYPE_ACCURATE=0,y.OCCLUSION_ALGORITHM_TYPE_CONSERVATIVE=1,y.CULLINGSTRATEGY_STANDARD=0,y.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1,y.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2,y.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3,a.Cg([E.Cx.filter(((...[t,K,D,a,G])=>!(Array.isArray(t)||Array.isArray(K)||Array.isArray(D)||Array.isArray(a)||Array.isArray(G))))],y,"_ApplySkeleton",null),d.Y5("BABYLON.AbstractMesh",y)},818696:(t,K,D)=>{D.d(K,{P:()=>Z});var a=D(297809),G=D(604910),N=D(23987),W=D(554014),x=D(332290),b=D(706400),n=D(760998),e=D(378480),i=D(879808),z=D(374216);class I{}class Z{constructor(){this.uniqueId=0,this.metadata={},this._applyTo=e.Aj(this._applyToCoroutine.bind(this)),this.uniqueId=Z._UniqueIDGenerator,Z._UniqueIDGenerator++}set(t,K){switch(t.length||b.V.Warn(`Setting vertex data kind '${K}' with an empty array`),K){case N.R.PositionKind:this.positions=t;break;case N.R.NormalKind:this.normals=t;break;case N.R.TangentKind:this.tangents=t;break;case N.R.UVKind:this.uvs=t;break;case N.R.UV2Kind:this.uvs2=t;break;case N.R.UV3Kind:this.uvs3=t;break;case N.R.UV4Kind:this.uvs4=t;break;case N.R.UV5Kind:this.uvs5=t;break;case N.R.UV6Kind:this.uvs6=t;break;case N.R.ColorKind:this.colors=t;break;case N.R.MatricesIndicesKind:this.matricesIndices=t;break;case N.R.MatricesWeightsKind:this.matricesWeights=t;break;case N.R.MatricesIndicesExtraKind:this.matricesIndicesExtra=t;break;case N.R.MatricesWeightsExtraKind:this.matricesWeightsExtra=t}}applyToMesh(t,K){return this._applyTo(t,K,!1),this}applyToGeometry(t,K){return this._applyTo(t,K,!1),this}updateMesh(t){return this._update(t),this}updateGeometry(t){return this._update(t),this}*_applyToCoroutine(t,K=!1,D){if(this.positions&&(t.setVerticesData(N.R.PositionKind,this.positions,K),D&&(yield)),this.normals&&(t.setVerticesData(N.R.NormalKind,this.normals,K),D&&(yield)),this.tangents&&(t.setVerticesData(N.R.TangentKind,this.tangents,K),D&&(yield)),this.uvs&&(t.setVerticesData(N.R.UVKind,this.uvs,K),D&&(yield)),this.uvs2&&(t.setVerticesData(N.R.UV2Kind,this.uvs2,K),D&&(yield)),this.uvs3&&(t.setVerticesData(N.R.UV3Kind,this.uvs3,K),D&&(yield)),this.uvs4&&(t.setVerticesData(N.R.UV4Kind,this.uvs4,K),D&&(yield)),this.uvs5&&(t.setVerticesData(N.R.UV5Kind,this.uvs5,K),D&&(yield)),this.uvs6&&(t.setVerticesData(N.R.UV6Kind,this.uvs6,K),D&&(yield)),this.colors&&(t.setVerticesData(N.R.ColorKind,this.colors,K),this.hasVertexAlpha&&void 0!==t.hasVertexAlpha&&(t.hasVertexAlpha=!0),D&&(yield)),this.matricesIndices&&(t.setVerticesData(N.R.MatricesIndicesKind,this.matricesIndices,K),D&&(yield)),this.matricesWeights&&(t.setVerticesData(N.R.MatricesWeightsKind,this.matricesWeights,K),D&&(yield)),this.matricesIndicesExtra&&(t.setVerticesData(N.R.MatricesIndicesExtraKind,this.matricesIndicesExtra,K),D&&(yield)),this.matricesWeightsExtra&&(t.setVerticesData(N.R.MatricesWeightsExtraKind,this.matricesWeightsExtra,K),D&&(yield)),this.indices?(t.setIndices(this.indices,null,K),D&&(yield)):t.setIndices([],null),t.subMeshes&&this.materialInfos&&this.materialInfos.length>1){const K=t;K.subMeshes=[];for(const t of this.materialInfos)new z.K(t.materialIndex,t.verticesStart,t.verticesCount,t.indexStart,t.indexCount,K)}return this}_update(t,K,D){return this.positions&&t.updateVerticesData(N.R.PositionKind,this.positions,K,D),this.normals&&t.updateVerticesData(N.R.NormalKind,this.normals,K,D),this.tangents&&t.updateVerticesData(N.R.TangentKind,this.tangents,K,D),this.uvs&&t.updateVerticesData(N.R.UVKind,this.uvs,K,D),this.uvs2&&t.updateVerticesData(N.R.UV2Kind,this.uvs2,K,D),this.uvs3&&t.updateVerticesData(N.R.UV3Kind,this.uvs3,K,D),this.uvs4&&t.updateVerticesData(N.R.UV4Kind,this.uvs4,K,D),this.uvs5&&t.updateVerticesData(N.R.UV5Kind,this.uvs5,K,D),this.uvs6&&t.updateVerticesData(N.R.UV6Kind,this.uvs6,K,D),this.colors&&t.updateVerticesData(N.R.ColorKind,this.colors,K,D),this.matricesIndices&&t.updateVerticesData(N.R.MatricesIndicesKind,this.matricesIndices,K,D),this.matricesWeights&&t.updateVerticesData(N.R.MatricesWeightsKind,this.matricesWeights,K,D),this.matricesIndicesExtra&&t.updateVerticesData(N.R.MatricesIndicesExtraKind,this.matricesIndicesExtra,K,D),this.matricesWeightsExtra&&t.updateVerticesData(N.R.MatricesWeightsExtraKind,this.matricesWeightsExtra,K,D),this.indices&&t.setIndices(this.indices,null),this}static _TransformVector3Coordinates(t,K,D=0,a=t.length){const N=G.AA.Vector3[0],W=G.AA.Vector3[1];for(let x=D;x<D+a;x+=3)G.Pq.FromArrayToRef(t,x,N),G.Pq.TransformCoordinatesToRef(N,K,W),t[x]=W.x,t[x+1]=W.y,t[x+2]=W.z}static _TransformVector3Normals(t,K,D=0,a=t.length){const N=G.AA.Vector3[0],W=G.AA.Vector3[1];for(let x=D;x<D+a;x+=3)G.Pq.FromArrayToRef(t,x,N),G.Pq.TransformNormalToRef(N,K,W),t[x]=W.x,t[x+1]=W.y,t[x+2]=W.z}static _TransformVector4Normals(t,K,D=0,a=t.length){const N=G.AA.Vector4[0],W=G.AA.Vector4[1];for(let x=D;x<D+a;x+=4)G.IU.FromArrayToRef(t,x,N),G.IU.TransformNormalToRef(N,K,W),t[x]=W.x,t[x+1]=W.y,t[x+2]=W.z,t[x+3]=W.w}static _FlipFaces(t,K=0,D=t.length){for(let a=K;a<K+D;a+=3){const K=t[a+1];t[a+1]=t[a+2],t[a+2]=K}}transform(t){const K=t.determinant()<0;return this.positions&&Z._TransformVector3Coordinates(this.positions,t),this.normals&&Z._TransformVector3Normals(this.normals,t),this.tangents&&Z._TransformVector4Normals(this.tangents,t),K&&this.indices&&Z._FlipFaces(this.indices),this}splitBasedOnMaterialID(){if(!this.materialInfos||this.materialInfos.length<2)return[this];const t=[];for(const K of this.materialInfos){const D=new Z;if(this.positions&&(D.positions=this.positions.slice(3*K.verticesStart,3*(K.verticesCount+K.verticesStart))),this.normals&&(D.normals=this.normals.slice(3*K.verticesStart,3*(K.verticesCount+K.verticesStart))),this.tangents&&(D.tangents=this.tangents.slice(4*K.verticesStart,4*(K.verticesCount+K.verticesStart))),this.colors&&(D.colors=this.colors.slice(4*K.verticesStart,4*(K.verticesCount+K.verticesStart))),this.uvs&&(D.uvs=this.uvs.slice(2*K.verticesStart,2*(K.verticesCount+K.verticesStart))),this.uvs2&&(D.uvs2=this.uvs2.slice(2*K.verticesStart,2*(K.verticesCount+K.verticesStart))),this.uvs3&&(D.uvs3=this.uvs3.slice(2*K.verticesStart,2*(K.verticesCount+K.verticesStart))),this.uvs4&&(D.uvs4=this.uvs4.slice(2*K.verticesStart,2*(K.verticesCount+K.verticesStart))),this.uvs5&&(D.uvs5=this.uvs5.slice(2*K.verticesStart,2*(K.verticesCount+K.verticesStart))),this.uvs6&&(D.uvs6=this.uvs6.slice(2*K.verticesStart,2*(K.verticesCount+K.verticesStart))),this.matricesIndices&&(D.matricesIndices=this.matricesIndices.slice(4*K.verticesStart,4*(K.verticesCount+K.verticesStart))),this.matricesIndicesExtra&&(D.matricesIndicesExtra=this.matricesIndicesExtra.slice(4*K.verticesStart,4*(K.verticesCount+K.verticesStart))),this.matricesWeights&&(D.matricesWeights=this.matricesWeights.slice(4*K.verticesStart,4*(K.verticesCount+K.verticesStart))),this.matricesWeightsExtra&&(D.matricesWeightsExtra=this.matricesWeightsExtra.slice(4*K.verticesStart,4*(K.verticesCount+K.verticesStart))),this.indices){D.indices=[];for(let t=K.indexStart;t<K.indexStart+K.indexCount;t++)D.indices.push(this.indices[t]-K.verticesStart)}const a=new I;a.indexStart=0,a.indexCount=D.indices?D.indices.length:0,a.materialIndex=K.materialIndex,a.verticesStart=0,a.verticesCount=(D.positions?D.positions.length:0)/3,D.materialInfos=[a],t.push(D)}return t}merge(t,K=!1,D=!1,a=!1,G=!1){const N=Array.isArray(t)?t.map((t=>({vertexData:t}))):[{vertexData:t}];return e.V1(this._mergeCoroutine(void 0,N,K,!1,D,a,G))}*_mergeCoroutine(t,K,D=!1,a,G,W=!1,x=!1){var b,n,e,i;this._validate();let z=K.map((t=>t.vertexData)),w=this;if(x)for(const t of z)t&&(t._validate(),!this.normals&&t.normals&&(this.normals=new Float32Array(this.positions.length)),!this.tangents&&t.tangents&&(this.tangents=new Float32Array(this.positions.length/3*4)),!this.uvs&&t.uvs&&(this.uvs=new Float32Array(this.positions.length/3*2)),!this.uvs2&&t.uvs2&&(this.uvs2=new Float32Array(this.positions.length/3*2)),!this.uvs3&&t.uvs3&&(this.uvs3=new Float32Array(this.positions.length/3*2)),!this.uvs4&&t.uvs4&&(this.uvs4=new Float32Array(this.positions.length/3*2)),!this.uvs5&&t.uvs5&&(this.uvs5=new Float32Array(this.positions.length/3*2)),!this.uvs6&&t.uvs6&&(this.uvs6=new Float32Array(this.positions.length/3*2)),!this.colors&&t.colors&&(this.colors=new Float32Array(this.positions.length/3*4),this.colors.fill(1)),!this.matricesIndices&&t.matricesIndices&&(this.matricesIndices=new Float32Array(this.positions.length/3*4)),!this.matricesWeights&&t.matricesWeights&&(this.matricesWeights=new Float32Array(this.positions.length/3*4)),!this.matricesIndicesExtra&&t.matricesIndicesExtra&&(this.matricesIndicesExtra=new Float32Array(this.positions.length/3*4)),!this.matricesWeightsExtra&&t.matricesWeightsExtra&&(this.matricesWeightsExtra=new Float32Array(this.positions.length/3*4)));for(const t of z)if(t)if(x)this.normals&&!t.normals&&(t.normals=new Float32Array(t.positions.length)),this.tangents&&!t.tangents&&(t.tangents=new Float32Array(t.positions.length/3*4)),this.uvs&&!t.uvs&&(t.uvs=new Float32Array(t.positions.length/3*2)),this.uvs2&&!t.uvs2&&(t.uvs2=new Float32Array(t.positions.length/3*2)),this.uvs3&&!t.uvs3&&(t.uvs3=new Float32Array(t.positions.length/3*2)),this.uvs4&&!t.uvs4&&(t.uvs4=new Float32Array(t.positions.length/3*2)),this.uvs5&&!t.uvs5&&(t.uvs5=new Float32Array(t.positions.length/3*2)),this.uvs6&&!t.uvs6&&(t.uvs6=new Float32Array(t.positions.length/3*2)),this.colors&&!t.colors&&(t.colors=new Float32Array(t.positions.length/3*4),t.colors.fill(1)),this.matricesIndices&&!t.matricesIndices&&(t.matricesIndices=new Float32Array(t.positions.length/3*4)),this.matricesWeights&&!t.matricesWeights&&(t.matricesWeights=new Float32Array(t.positions.length/3*4)),this.matricesIndicesExtra&&!t.matricesIndicesExtra&&(t.matricesIndicesExtra=new Float32Array(t.positions.length/3*4)),this.matricesWeightsExtra&&!t.matricesWeightsExtra&&(t.matricesWeightsExtra=new Float32Array(t.positions.length/3*4));else if(t._validate(),!this.normals!=!t.normals||!this.tangents!=!t.tangents||!this.uvs!=!t.uvs||!this.uvs2!=!t.uvs2||!this.uvs3!=!t.uvs3||!this.uvs4!=!t.uvs4||!this.uvs5!=!t.uvs5||!this.uvs6!=!t.uvs6||!this.colors!=!t.colors||!this.matricesIndices!=!t.matricesIndices||!this.matricesWeights!=!t.matricesWeights||!this.matricesIndicesExtra!=!t.matricesIndicesExtra||!this.matricesWeightsExtra!=!t.matricesWeightsExtra)throw new Error("Cannot merge vertex data that do not have the same set of attributes");if(W){let D=0,a=0,G=0;const N=[];let W=null;const x=[];for(const K of this.splitBasedOnMaterialID())x.push({vertexData:K,transform:t});for(const t of K)if(t.vertexData)for(const K of t.vertexData.splitBasedOnMaterialID())x.push({vertexData:K,transform:t.transform});x.sort(((t,K)=>{const D=t.vertexData.materialInfos?t.vertexData.materialInfos[0].materialIndex:0,a=K.vertexData.materialInfos?K.vertexData.materialInfos[0].materialIndex:0;return D>a?1:D===a?0:-1}));for(const t of x){const K=t.vertexData;if(D=K.materialInfos?K.materialInfos[0].materialIndex:0,W&&W.materialIndex===D)W.indexCount+=K.indices.length,W.verticesCount+=K.positions.length/3;else{const t=new I;t.materialIndex=D,t.indexStart=a,t.indexCount=K.indices.length,t.verticesStart=G,t.verticesCount=K.positions.length/3,N.push(t),W=t}a+=K.indices.length,G+=K.positions.length/3}const b=x.splice(0,1)[0];w=b.vertexData,t=b.transform,z=x.map((t=>t.vertexData)),K=x,this.materialInfos=N}const m=z.reduce(((t,K)=>{var D,a;return t+(null!==(a=null===(D=K.indices)||void 0===D?void 0:D.length)&&void 0!==a?a:0)}),null!==(n=null===(b=w.indices)||void 0===b?void 0:b.length)&&void 0!==n?n:0);let u=G||z.some((t=>t.indices===w.indices))?null===(e=w.indices)||void 0===e?void 0:e.slice():w.indices;if(m>0){let G=null!==(i=null==u?void 0:u.length)&&void 0!==i?i:0;if(u||(u=new Array(m)),u.length!==m){if(Array.isArray(u))u.length=m;else{const t=D||u instanceof Uint32Array?new Uint32Array(m):new Uint16Array(m);t.set(u),u=t}t&&t.determinant()<0&&Z._FlipFaces(u,0,G)}let N=w.positions?w.positions.length/3:0;for(const{vertexData:t,transform:D}of K)if(t.indices){for(let K=0;K<t.indices.length;K++)u[G+K]=t.indices[K]+N;D&&D.determinant()<0&&Z._FlipFaces(u,G,t.indices.length),N+=t.positions.length/3,G+=t.indices.length,a&&(yield)}}return this.indices=u,this.positions=Z._MergeElement(N.R.PositionKind,w.positions,t,K.map((t=>[t.vertexData.positions,t.transform]))),a&&(yield),w.normals&&(this.normals=Z._MergeElement(N.R.NormalKind,w.normals,t,K.map((t=>[t.vertexData.normals,t.transform]))),a&&(yield)),w.tangents&&(this.tangents=Z._MergeElement(N.R.TangentKind,w.tangents,t,K.map((t=>[t.vertexData.tangents,t.transform]))),a&&(yield)),w.uvs&&(this.uvs=Z._MergeElement(N.R.UVKind,w.uvs,t,K.map((t=>[t.vertexData.uvs,t.transform]))),a&&(yield)),w.uvs2&&(this.uvs2=Z._MergeElement(N.R.UV2Kind,w.uvs2,t,K.map((t=>[t.vertexData.uvs2,t.transform]))),a&&(yield)),w.uvs3&&(this.uvs3=Z._MergeElement(N.R.UV3Kind,w.uvs3,t,K.map((t=>[t.vertexData.uvs3,t.transform]))),a&&(yield)),w.uvs4&&(this.uvs4=Z._MergeElement(N.R.UV4Kind,w.uvs4,t,K.map((t=>[t.vertexData.uvs4,t.transform]))),a&&(yield)),w.uvs5&&(this.uvs5=Z._MergeElement(N.R.UV5Kind,w.uvs5,t,K.map((t=>[t.vertexData.uvs5,t.transform]))),a&&(yield)),w.uvs6&&(this.uvs6=Z._MergeElement(N.R.UV6Kind,w.uvs6,t,K.map((t=>[t.vertexData.uvs6,t.transform]))),a&&(yield)),w.colors&&(this.colors=Z._MergeElement(N.R.ColorKind,w.colors,t,K.map((t=>[t.vertexData.colors,t.transform]))),(void 0!==w.hasVertexAlpha||K.some((t=>void 0!==t.vertexData.hasVertexAlpha)))&&(this.hasVertexAlpha=w.hasVertexAlpha||K.some((t=>t.vertexData.hasVertexAlpha))),a&&(yield)),w.matricesIndices&&(this.matricesIndices=Z._MergeElement(N.R.MatricesIndicesKind,w.matricesIndices,t,K.map((t=>[t.vertexData.matricesIndices,t.transform]))),a&&(yield)),w.matricesWeights&&(this.matricesWeights=Z._MergeElement(N.R.MatricesWeightsKind,w.matricesWeights,t,K.map((t=>[t.vertexData.matricesWeights,t.transform]))),a&&(yield)),w.matricesIndicesExtra&&(this.matricesIndicesExtra=Z._MergeElement(N.R.MatricesIndicesExtraKind,w.matricesIndicesExtra,t,K.map((t=>[t.vertexData.matricesIndicesExtra,t.transform]))),a&&(yield)),w.matricesWeightsExtra&&(this.matricesWeightsExtra=Z._MergeElement(N.R.MatricesWeightsExtraKind,w.matricesWeightsExtra,t,K.map((t=>[t.vertexData.matricesWeightsExtra,t.transform])))),this}static _MergeElement(t,K,D,a){const G=a.filter((t=>null!==t[0]&&void 0!==t[0]));if(!K&&0==G.length)return K;if(!K)return this._MergeElement(t,G[0][0],G[0][1],G.slice(1));const W=G.reduce(((t,K)=>t+K[0].length),K.length),x=t===N.R.PositionKind?Z._TransformVector3Coordinates:t===N.R.NormalKind?Z._TransformVector3Normals:t===N.R.TangentKind?Z._TransformVector4Normals:()=>{};if(K instanceof Float32Array){const t=new Float32Array(W);t.set(K),D&&x(t,D,0,K.length);let a=K.length;for(const[K,D]of G)t.set(K,a),D&&x(t,D,a,K.length),a+=K.length;return t}{const t=new Array(W);for(let D=0;D<K.length;D++)t[D]=K[D];D&&x(t,D,0,K.length);let a=K.length;for(const[K,D]of G){for(let D=0;D<K.length;D++)t[a+D]=K[D];D&&x(t,D,a,K.length),a+=K.length}return t}}_validate(){if(!this.positions)throw new i.bu("Positions are required",i.tG.MeshInvalidPositionsError);const t=(t,K)=>{const D=N.R.DeduceStride(t);if(K.length%D!=0)throw new Error("The "+t+"s array count must be a multiple of "+D);return K.length/D},K=t(N.R.PositionKind,this.positions),D=(D,a)=>{const G=t(D,a);if(G!==K)throw new Error("The "+D+"s element count ("+G+") does not match the positions count ("+K+")")};this.normals&&D(N.R.NormalKind,this.normals),this.tangents&&D(N.R.TangentKind,this.tangents),this.uvs&&D(N.R.UVKind,this.uvs),this.uvs2&&D(N.R.UV2Kind,this.uvs2),this.uvs3&&D(N.R.UV3Kind,this.uvs3),this.uvs4&&D(N.R.UV4Kind,this.uvs4),this.uvs5&&D(N.R.UV5Kind,this.uvs5),this.uvs6&&D(N.R.UV6Kind,this.uvs6),this.colors&&D(N.R.ColorKind,this.colors),this.matricesIndices&&D(N.R.MatricesIndicesKind,this.matricesIndices),this.matricesWeights&&D(N.R.MatricesWeightsKind,this.matricesWeights),this.matricesIndicesExtra&&D(N.R.MatricesIndicesExtraKind,this.matricesIndicesExtra),this.matricesWeightsExtra&&D(N.R.MatricesWeightsExtraKind,this.matricesWeightsExtra)}clone(){const t=this.serialize();return Z.Parse(t)}serialize(){const t={};if(this.positions&&(t.positions=Array.from(this.positions)),this.normals&&(t.normals=Array.from(this.normals)),this.tangents&&(t.tangents=Array.from(this.tangents)),this.uvs&&(t.uvs=Array.from(this.uvs)),this.uvs2&&(t.uvs2=Array.from(this.uvs2)),this.uvs3&&(t.uvs3=Array.from(this.uvs3)),this.uvs4&&(t.uvs4=Array.from(this.uvs4)),this.uvs5&&(t.uvs5=Array.from(this.uvs5)),this.uvs6&&(t.uvs6=Array.from(this.uvs6)),this.colors&&(t.colors=Array.from(this.colors),t.hasVertexAlpha=this.hasVertexAlpha),this.matricesIndices&&(t.matricesIndices=Array.from(this.matricesIndices),t.matricesIndices._isExpanded=!0),this.matricesWeights&&(t.matricesWeights=Array.from(this.matricesWeights)),this.matricesIndicesExtra&&(t.matricesIndicesExtra=Array.from(this.matricesIndicesExtra),t.matricesIndicesExtra._isExpanded=!0),this.matricesWeightsExtra&&(t.matricesWeightsExtra=Array.from(this.matricesWeightsExtra)),t.indices=Array.from(this.indices),this.materialInfos){t.materialInfos=[];for(const K of this.materialInfos){const D={indexStart:K.indexStart,indexCount:K.indexCount,materialIndex:K.materialIndex,verticesStart:K.verticesStart,verticesCount:K.verticesCount};t.materialInfos.push(D)}}return t}static ExtractFromMesh(t,K,D){return Z._ExtractFrom(t,K,D)}static ExtractFromGeometry(t,K,D){return Z._ExtractFrom(t,K,D)}static _ExtractFrom(t,K,D){const a=new Z;if(t.isVerticesDataPresent(N.R.PositionKind)&&(a.positions=t.getVerticesData(N.R.PositionKind,K,D)),t.isVerticesDataPresent(N.R.NormalKind)&&(a.normals=t.getVerticesData(N.R.NormalKind,K,D)),t.isVerticesDataPresent(N.R.TangentKind)&&(a.tangents=t.getVerticesData(N.R.TangentKind,K,D)),t.isVerticesDataPresent(N.R.UVKind)&&(a.uvs=t.getVerticesData(N.R.UVKind,K,D)),t.isVerticesDataPresent(N.R.UV2Kind)&&(a.uvs2=t.getVerticesData(N.R.UV2Kind,K,D)),t.isVerticesDataPresent(N.R.UV3Kind)&&(a.uvs3=t.getVerticesData(N.R.UV3Kind,K,D)),t.isVerticesDataPresent(N.R.UV4Kind)&&(a.uvs4=t.getVerticesData(N.R.UV4Kind,K,D)),t.isVerticesDataPresent(N.R.UV5Kind)&&(a.uvs5=t.getVerticesData(N.R.UV5Kind,K,D)),t.isVerticesDataPresent(N.R.UV6Kind)&&(a.uvs6=t.getVerticesData(N.R.UV6Kind,K,D)),t.isVerticesDataPresent(N.R.ColorKind)){const G=t.geometry||t,W=G.getVertexBuffer(N.R.ColorKind),x=G.getVerticesData(N.R.ColorKind,K,D);if(3===W.getSize()){const t=new Float32Array(4*x.length/3);for(let K=0,D=0;K<x.length;K+=3,D+=4)t[D]=x[K],t[D+1]=x[K+1],t[D+2]=x[K+2],t[D+3]=1;a.colors=t}else{if(4!==W.getSize())throw new Error(`Unexpected number of color components: ${W.getSize()}`);a.colors=x}}return t.isVerticesDataPresent(N.R.MatricesIndicesKind)&&(a.matricesIndices=t.getVerticesData(N.R.MatricesIndicesKind,K,D)),t.isVerticesDataPresent(N.R.MatricesWeightsKind)&&(a.matricesWeights=t.getVerticesData(N.R.MatricesWeightsKind,K,D)),t.isVerticesDataPresent(N.R.MatricesIndicesExtraKind)&&(a.matricesIndicesExtra=t.getVerticesData(N.R.MatricesIndicesExtraKind,K,D)),t.isVerticesDataPresent(N.R.MatricesWeightsExtraKind)&&(a.matricesWeightsExtra=t.getVerticesData(N.R.MatricesWeightsExtraKind,K,D)),a.indices=t.getIndices(K,D),a}static CreateRibbon(t){throw W.n("ribbonBuilder")}static CreateBox(t){throw W.n("boxBuilder")}static CreateTiledBox(t){throw W.n("tiledBoxBuilder")}static CreateTiledPlane(t){throw W.n("tiledPlaneBuilder")}static CreateSphere(t){throw W.n("sphereBuilder")}static CreateCylinder(t){throw W.n("cylinderBuilder")}static CreateTorus(t){throw W.n("torusBuilder")}static CreateLineSystem(t){throw W.n("linesBuilder")}static CreateDashedLines(t){throw W.n("linesBuilder")}static CreateGround(t){throw W.n("groundBuilder")}static CreateTiledGround(t){throw W.n("groundBuilder")}static CreateGroundFromHeightMap(t){throw W.n("groundBuilder")}static CreatePlane(t){throw W.n("planeBuilder")}static CreateDisc(t){throw W.n("discBuilder")}static CreatePolygon(t,K,D,a,G,N,x){throw W.n("polygonBuilder")}static CreateIcoSphere(t){throw W.n("icoSphereBuilder")}static CreatePolyhedron(t){throw W.n("polyhedronBuilder")}static CreateCapsule(t={orientation:G.Pq.Up(),subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6}){throw W.n("capsuleBuilder")}static CreateTorusKnot(t){throw W.n("torusKnotBuilder")}static ComputeNormals(t,K,D,a){let N=0,W=0,x=0,b=0,n=0,e=0,i=0,z=0,I=0,Z=0,w=0,m=0,u=0,d=0,E=0,l=0,Q=0,P=0,y=0,q=0,X=!1,h=!1,J=!1,T=!1,_=1,C=0,H=null;a&&(X=!!a.facetNormals,h=!!a.facetPositions,J=!!a.facetPartitioning,_=!0===a.useRightHandedSystem?-1:1,C=a.ratio||0,T=!!a.depthSort,H=a.distanceTo,T&&void 0===H&&(H=G.Pq.Zero()));let o=0,U=0,V=0,s=0;for(J&&a&&a.bbSize&&(o=a.subDiv.X*C/a.bbSize.x,U=a.subDiv.Y*C/a.bbSize.y,V=a.subDiv.Z*C/a.bbSize.z,s=a.subDiv.max*a.subDiv.max,a.facetPartitioning.length=0),N=0;N<t.length;N++)D[N]=0;const F=K.length/3|0;for(N=0;N<F;N++){if(m=3*K[3*N],u=m+1,d=m+2,E=3*K[3*N+1],l=E+1,Q=E+2,P=3*K[3*N+2],y=P+1,q=P+2,W=t[m]-t[E],x=t[u]-t[l],b=t[d]-t[Q],n=t[P]-t[E],e=t[y]-t[l],i=t[q]-t[Q],z=_*(x*i-b*e),I=_*(b*n-W*i),Z=_*(W*e-x*n),w=Math.sqrt(z*z+I*I+Z*Z),w=0===w?1:w,z/=w,I/=w,Z/=w,X&&a&&(a.facetNormals[N].x=z,a.facetNormals[N].y=I,a.facetNormals[N].z=Z),h&&a&&(a.facetPositions[N].x=(t[m]+t[E]+t[P])/3,a.facetPositions[N].y=(t[u]+t[l]+t[y])/3,a.facetPositions[N].z=(t[d]+t[Q]+t[q])/3),J&&a){const K=Math.floor((a.facetPositions[N].x-a.bInfo.minimum.x*C)*o),D=Math.floor((a.facetPositions[N].y-a.bInfo.minimum.y*C)*U),G=Math.floor((a.facetPositions[N].z-a.bInfo.minimum.z*C)*V),W=Math.floor((t[m]-a.bInfo.minimum.x*C)*o),x=Math.floor((t[u]-a.bInfo.minimum.y*C)*U),b=Math.floor((t[d]-a.bInfo.minimum.z*C)*V),n=Math.floor((t[E]-a.bInfo.minimum.x*C)*o),e=Math.floor((t[l]-a.bInfo.minimum.y*C)*U),i=Math.floor((t[Q]-a.bInfo.minimum.z*C)*V),z=Math.floor((t[P]-a.bInfo.minimum.x*C)*o),I=Math.floor((t[y]-a.bInfo.minimum.y*C)*U),Z=Math.floor((t[q]-a.bInfo.minimum.z*C)*V),w=W+a.subDiv.max*x+s*b,X=n+a.subDiv.max*e+s*i,h=z+a.subDiv.max*I+s*Z,J=K+a.subDiv.max*D+s*G;a.facetPartitioning[J]=a.facetPartitioning[J]?a.facetPartitioning[J]:new Array,a.facetPartitioning[w]=a.facetPartitioning[w]?a.facetPartitioning[w]:new Array,a.facetPartitioning[X]=a.facetPartitioning[X]?a.facetPartitioning[X]:new Array,a.facetPartitioning[h]=a.facetPartitioning[h]?a.facetPartitioning[h]:new Array,a.facetPartitioning[w].push(N),X!=w&&a.facetPartitioning[X].push(N),h!=X&&h!=w&&a.facetPartitioning[h].push(N),J!=w&&J!=X&&J!=h&&a.facetPartitioning[J].push(N)}if(T&&a&&a.facetPositions){const t=a.depthSortedFacets[N];t.ind=3*N,t.sqDistance=G.Pq.DistanceSquared(a.facetPositions[N],H)}D[m]+=z,D[u]+=I,D[d]+=Z,D[E]+=z,D[l]+=I,D[Q]+=Z,D[P]+=z,D[y]+=I,D[q]+=Z}for(N=0;N<D.length/3;N++)z=D[3*N],I=D[3*N+1],Z=D[3*N+2],w=Math.sqrt(z*z+I*I+Z*Z),w=0===w?1:w,z/=w,I/=w,Z/=w,D[3*N]=z,D[3*N+1]=I,D[3*N+2]=Z}static _ComputeSides(t,K,D,a,N,W,x){const b=D.length,n=a.length;let e,i;switch(t=t||Z.DEFAULTSIDE){case Z.FRONTSIDE:break;case Z.BACKSIDE:for(e=0;e<b;e+=3){const t=D[e];D[e]=D[e+2],D[e+2]=t}for(i=0;i<n;i++)a[i]=-a[i];break;case Z.DOUBLESIDE:{const t=K.length,z=t/3;for(let D=0;D<t;D++)K[t+D]=K[D];for(e=0;e<b;e+=3)D[e+b]=D[e+2]+z,D[e+1+b]=D[e+1]+z,D[e+2+b]=D[e]+z;for(i=0;i<n;i++)a[n+i]=-a[i];const I=N.length;let Z=0;for(Z=0;Z<I;Z++)N[Z+I]=N[Z];for(W=W||new G.IU(0,0,1,1),x=x||new G.IU(0,0,1,1),Z=0,e=0;e<I/2;e++)N[Z]=W.x+(W.z-W.x)*N[Z],N[Z+1]=W.y+(W.w-W.y)*N[Z+1],N[Z+I]=x.x+(x.z-x.x)*N[Z+I],N[Z+I+1]=x.y+(x.w-x.y)*N[Z+I+1],Z+=2;break}}}static Parse(t){const K=new Z,D=t.positions;D&&K.set(D,N.R.PositionKind);const a=t.normals;a&&K.set(a,N.R.NormalKind);const G=t.tangents;G&&K.set(G,N.R.TangentKind);const W=t.uvs;W&&K.set(W,N.R.UVKind);const b=t.uvs2;b&&K.set(b,N.R.UV2Kind);const n=t.uvs3;n&&K.set(n,N.R.UV3Kind);const e=t.uvs4;e&&K.set(e,N.R.UV4Kind);const i=t.uvs5;i&&K.set(i,N.R.UV5Kind);const z=t.uvs6;z&&K.set(z,N.R.UV6Kind);const w=t.colors;w&&(K.set(x.ov.CheckColors4(w,D.length/3),N.R.ColorKind),void 0!==t.hasVertexAlpha&&(K.hasVertexAlpha=t.hasVertexAlpha));const m=t.matricesIndices;m&&K.set(m,N.R.MatricesIndicesKind);const u=t.matricesWeights;u&&K.set(u,N.R.MatricesWeightsKind);const d=t.indices;d&&(K.indices=d);const E=t.materialInfos;if(E){K.materialInfos=[];for(const t of E){const D=new I;D.indexCount=t.indexCount,D.indexStart=t.indexStart,D.verticesCount=t.verticesCount,D.verticesStart=t.verticesStart,D.materialIndex=t.materialIndex,K.materialInfos.push(D)}}return K}static ImportVertexData(t,K){const D=Z.Parse(t);K.setAllVerticesData(D,t.updatable)}}Z.FRONTSIDE=0,Z.BACKSIDE=1,Z.DOUBLESIDE=2,Z.DEFAULTSIDE=0,Z._UniqueIDGenerator=0,a.Cg([n.Cx.filter(((...[t])=>!Array.isArray(t)))],Z,"_TransformVector3Coordinates",null),a.Cg([n.Cx.filter(((...[t])=>!Array.isArray(t)))],Z,"_TransformVector3Normals",null),a.Cg([n.Cx.filter(((...[t])=>!Array.isArray(t)))],Z,"_TransformVector4Normals",null),a.Cg([n.Cx.filter(((...[t])=>!Array.isArray(t)))],Z,"_FlipFaces",null)},374216:(t,K,D)=>{D.d(K,{K:()=>b});var a=D(23987),G=D(7686),N=D(59036),W=D(755752),x=D(964061);class b{get materialDefines(){var t;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.defines:null===(t=this._getDrawWrapper())||void 0===t?void 0:t.defines}set materialDefines(t){var K;(null!==(K=this._mainDrawWrapperOverride)&&void 0!==K?K:this._getDrawWrapper(void 0,!0)).defines=t}_getDrawWrapper(t,K=!1){t=null!=t?t:this._engine.currentRenderPassId;let D=this._drawWrappers[t];return!D&&K&&(this._drawWrappers[t]=D=new x.E(this._mesh.getScene().getEngine())),D}_removeDrawWrapper(t,K=!0){var D;K&&(null===(D=this._drawWrappers[t])||void 0===D||D.dispose()),this._drawWrappers[t]=void 0}get effect(){var t,K;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.effect:null!==(K=null===(t=this._getDrawWrapper())||void 0===t?void 0:t.effect)&&void 0!==K?K:null}get _drawWrapper(){var t;return null!==(t=this._mainDrawWrapperOverride)&&void 0!==t?t:this._getDrawWrapper(void 0,!0)}get _drawWrapperOverride(){return this._mainDrawWrapperOverride}_setMainDrawWrapperOverride(t){this._mainDrawWrapperOverride=t}setEffect(t,K=null,D,a=!0){const G=this._drawWrapper;G.setEffect(t,K,a),void 0!==D&&(G.materialContext=D),t||(G.defines=null,G.materialContext=void 0)}resetDrawCache(t){if(this._drawWrappers){if(void 0!==t)return void this._removeDrawWrapper(t);for(const t of this._drawWrappers)null==t||t.dispose()}this._drawWrappers=[]}static AddToMesh(t,K,D,a,G,N,W,x=!0){return new b(t,K,D,a,G,N,W,x)}constructor(t,K,D,a,G,N,W,x=!0,b=!0){this.materialIndex=t,this.verticesStart=K,this.verticesCount=D,this.indexStart=a,this.indexCount=G,this._mainDrawWrapperOverride=null,this._linesIndexCount=0,this._linesIndexBuffer=null,this._lastColliderWorldVertices=null,this._lastColliderTransformMatrix=null,this._wasDispatched=!1,this._renderId=0,this._alphaIndex=0,this._distanceToCamera=0,this._currentMaterial=null,this._mesh=N,this._renderingMesh=W||N,b&&N.subMeshes.push(this),this._engine=this._mesh.getScene().getEngine(),this.resetDrawCache(),this._trianglePlanes=[],this._id=N.subMeshes.length-1,x&&(this.refreshBoundingInfo(),N.computeWorldMatrix(!0))}get IsGlobal(){return 0===this.verticesStart&&this.verticesCount===this._mesh.getTotalVertices()&&0===this.indexStart&&this.indexCount===this._mesh.getTotalIndices()}getBoundingInfo(){return this.IsGlobal||this._mesh.hasThinInstances?this._mesh.getBoundingInfo():this._boundingInfo}setBoundingInfo(t){return this._boundingInfo=t,this}getMesh(){return this._mesh}getRenderingMesh(){return this._renderingMesh}getReplacementMesh(){return this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null}getEffectiveMesh(){return(this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null)||this._renderingMesh}getMaterial(t=!0){var K;const D=null!==(K=this._renderingMesh.getMaterialForRenderPass(this._engine.currentRenderPassId))&&void 0!==K?K:this._renderingMesh.material;if(!D)return t?this._mesh.getScene().defaultMaterial:null;if(this._isMultiMaterial(D)){const t=D.getSubMaterial(this.materialIndex);return this._currentMaterial!==t&&(this._currentMaterial=t,this.resetDrawCache()),t}return D}_isMultiMaterial(t){return void 0!==t.getSubMaterial}refreshBoundingInfo(t=null){if(this._lastColliderWorldVertices=null,this.IsGlobal||!this._renderingMesh||!this._renderingMesh.geometry)return this;if(t||(t=this._renderingMesh.getVerticesData(a.R.PositionKind)),!t)return this._boundingInfo=this._mesh.getBoundingInfo(),this;const K=this._renderingMesh.getIndices();let D;if(0===this.indexStart&&this.indexCount===K.length){const t=this._renderingMesh.getBoundingInfo();D={minimum:t.minimum.clone(),maximum:t.maximum.clone()}}else D=W.c(t,K,this.indexStart,this.indexCount,this._renderingMesh.geometry.boundingBias);return this._boundingInfo?this._boundingInfo.reConstruct(D.minimum,D.maximum):this._boundingInfo=new N.j(D.minimum,D.maximum),this}_checkCollision(t){return this.getBoundingInfo()._checkCollision(t)}updateBoundingInfo(t){let K=this.getBoundingInfo();return K||(this.refreshBoundingInfo(),K=this.getBoundingInfo()),K&&K.update(t),this}isInFrustum(t){const K=this.getBoundingInfo();return!!K&&K.isInFrustum(t,this._mesh.cullingStrategy)}isCompletelyInFrustum(t){const K=this.getBoundingInfo();return!!K&&K.isCompletelyInFrustum(t)}render(t){return this._renderingMesh.render(this,t,this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:void 0),this}_getLinesIndexBuffer(t,K){if(!this._linesIndexBuffer){const D=[];for(let K=this.indexStart;K<this.indexStart+this.indexCount;K+=3)D.push(t[K],t[K+1],t[K+1],t[K+2],t[K+2],t[K]);this._linesIndexBuffer=K.createIndexBuffer(D),this._linesIndexCount=D.length}return this._linesIndexBuffer}canIntersects(t){const K=this.getBoundingInfo();return!!K&&t.intersectsBox(K.boundingBox)}intersects(t,K,D,a,G){const N=this.getMaterial();if(!N)return null;let W=3,x=!1;switch(N.fillMode){case 3:case 5:case 6:case 8:return null;case 7:W=1,x=!0}return 4===N.fillMode?D.length?this._intersectLines(t,K,D,this._mesh.intersectionThreshold,a):this._intersectUnIndexedLines(t,K,D,this._mesh.intersectionThreshold,a):!D.length&&this._mesh._unIndexed?this._intersectUnIndexedTriangles(t,K,D,a,G):this._intersectTriangles(t,K,D,W,x,a,G)}_intersectLines(t,K,D,a,N){let W=null;for(let x=this.indexStart;x<this.indexStart+this.indexCount;x+=2){const b=K[D[x]],n=K[D[x+1]],e=t.intersectionSegment(b,n,a);if(!(e<0)&&(N||!W||e<W.distance)&&(W=new G.w(null,null,e),W.faceId=x/2,N))break}return W}_intersectUnIndexedLines(t,K,D,a,N){let W=null;for(let D=this.verticesStart;D<this.verticesStart+this.verticesCount;D+=2){const x=K[D],b=K[D+1],n=t.intersectionSegment(x,b,a);if(!(n<0)&&(N||!W||n<W.distance)&&(W=new G.w(null,null,n),W.faceId=D/2,N))break}return W}_intersectTriangles(t,K,D,a,G,N,W){let x=null,b=-1;for(let n=this.indexStart;n<this.indexStart+this.indexCount-(3-a);n+=a){b++;const a=D[n],e=D[n+1],i=D[n+2];if(G&&4294967295===i){n+=2;continue}const z=K[a],I=K[e],Z=K[i];if(!z||!I||!Z)continue;if(W&&!W(z,I,Z,t,a,e,i))continue;const w=t.intersectsTriangle(z,I,Z);if(w){if(w.distance<0)continue;if((N||!x||w.distance<x.distance)&&(x=w,x.faceId=b,N))break}}return x}_intersectUnIndexedTriangles(t,K,D,a,G){let N=null;for(let D=this.verticesStart;D<this.verticesStart+this.verticesCount;D+=3){const W=K[D],x=K[D+1],b=K[D+2];if(G&&!G(W,x,b,t,-1,-1,-1))continue;const n=t.intersectsTriangle(W,x,b);if(n){if(n.distance<0)continue;if((a||!N||n.distance<N.distance)&&(N=n,N.faceId=D/3,a))break}}return N}_rebuild(){this._linesIndexBuffer&&(this._linesIndexBuffer=null)}clone(t,K){const D=new b(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,t,K,!1);if(!this.IsGlobal){const t=this.getBoundingInfo();if(!t)return D;D._boundingInfo=new N.j(t.minimum,t.maximum)}return D}dispose(){this._linesIndexBuffer&&(this._mesh.getScene().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);const t=this._mesh.subMeshes.indexOf(this);this._mesh.subMeshes.splice(t,1),this.resetDrawCache()}getClassName(){return"SubMesh"}static CreateFromIndices(t,K,D,a,G,N=!0){let W=Number.MAX_VALUE,x=-Number.MAX_VALUE;const n=(G||a).getIndices();for(let t=K;t<K+D;t++){const K=n[t];K<W&&(W=K),K>x&&(x=K)}return new b(t,W,x-W+1,K,D,a,G,N)}}},633727:(t,K,D)=>{D.d(K,{V:()=>i});var a=D(297809),G=D(760998),N=D(337776),W=D(638113),x=D(604910),b=D(869581),n=D(310035);const e=x.uq.Compose(x.Pq.One(),x.PT.FromEulerAngles(0,Math.PI,0),x.Pq.Zero());class i extends b.b{get billboardMode(){return this._billboardMode}set billboardMode(t){this._billboardMode!==t&&(this._billboardMode=t,this._cache.useBillboardPosition=!!(this._billboardMode&i.BILLBOARDMODE_USE_POSITION),this._computeUseBillboardPath())}get preserveParentRotationForBillboard(){return this._preserveParentRotationForBillboard}set preserveParentRotationForBillboard(t){t!==this._preserveParentRotationForBillboard&&(this._preserveParentRotationForBillboard=t,this._computeUseBillboardPath())}_computeUseBillboardPath(){this._cache.useBillboardPath=this._billboardMode!==i.BILLBOARDMODE_NONE&&!this.preserveParentRotationForBillboard}get infiniteDistance(){return this._infiniteDistance}set infiniteDistance(t){this._infiniteDistance!==t&&(this._infiniteDistance=t)}constructor(t,K=null,D=!0){super(t,K,!1),this._forward=new x.Pq(0,0,1),this._up=new x.Pq(0,1,0),this._right=new x.Pq(1,0,0),this._position=x.Pq.Zero(),this._rotation=x.Pq.Zero(),this._rotationQuaternion=null,this._scaling=x.Pq.One(),this._transformToBoneReferal=null,this._isAbsoluteSynced=!1,this._billboardMode=i.BILLBOARDMODE_NONE,this._preserveParentRotationForBillboard=!1,this.scalingDeterminant=1,this._infiniteDistance=!1,this.ignoreNonUniformScaling=!1,this.reIntegrateRotationIntoRotationQuaternion=!1,this._poseMatrix=null,this._localMatrix=x.uq.Zero(),this._usePivotMatrix=!1,this._absolutePosition=x.Pq.Zero(),this._absoluteScaling=x.Pq.Zero(),this._absoluteRotationQuaternion=x.PT.Identity(),this._pivotMatrix=x.uq.Identity(),this._postMultiplyPivotMatrix=!1,this._isWorldMatrixFrozen=!1,this._indexInSceneTransformNodesArray=-1,this.onAfterWorldMatrixUpdateObservable=new W.cP,this._nonUniformScaling=!1,D&&this.getScene().addTransformNode(this)}getClassName(){return"TransformNode"}get position(){return this._position}set position(t){this._position=t,this._isDirty=!0}isUsingPivotMatrix(){return this._usePivotMatrix}isUsingPostMultiplyPivotMatrix(){return this._postMultiplyPivotMatrix}get rotation(){return this._rotation}set rotation(t){this._rotation=t,this._rotationQuaternion=null,this._isDirty=!0}get scaling(){return this._scaling}set scaling(t){this._scaling=t,this._isDirty=!0}get rotationQuaternion(){return this._rotationQuaternion}set rotationQuaternion(t){this._rotationQuaternion=t,t&&this._rotation.setAll(0),this._isDirty=!0}get forward(){return x.Pq.TransformNormalFromFloatsToRef(0,0,this.getScene().useRightHandedSystem?-1:1,this.getWorldMatrix(),this._forward),this._forward.normalize()}get up(){return x.Pq.TransformNormalFromFloatsToRef(0,1,0,this.getWorldMatrix(),this._up),this._up.normalize()}get right(){return x.Pq.TransformNormalFromFloatsToRef(this.getScene().useRightHandedSystem?-1:1,0,0,this.getWorldMatrix(),this._right),this._right.normalize()}updatePoseMatrix(t){return this._poseMatrix?(this._poseMatrix.copyFrom(t),this):(this._poseMatrix=t.clone(),this)}getPoseMatrix(){return this._poseMatrix||(this._poseMatrix=x.uq.Identity()),this._poseMatrix}_isSynchronized(){const t=this._cache;return!(this._billboardMode!==t.billboardMode||this._billboardMode!==i.BILLBOARDMODE_NONE||t.pivotMatrixUpdated||this._infiniteDistance||this._position._isDirty||this._scaling._isDirty||this._rotationQuaternion&&this._rotationQuaternion._isDirty||this._rotation._isDirty)}_initCache(){super._initCache();const t=this._cache;t.localMatrixUpdated=!1,t.billboardMode=-1,t.infiniteDistance=!1,t.useBillboardPosition=!1,t.useBillboardPath=!1}get absolutePosition(){return this.getAbsolutePosition()}get absoluteScaling(){return this._syncAbsoluteScalingAndRotation(),this._absoluteScaling}get absoluteRotationQuaternion(){return this._syncAbsoluteScalingAndRotation(),this._absoluteRotationQuaternion}setPreTransformMatrix(t){return this.setPivotMatrix(t,!1)}setPivotMatrix(t,K=!0){return this._pivotMatrix.copyFrom(t),this._usePivotMatrix=!this._pivotMatrix.isIdentity(),this._cache.pivotMatrixUpdated=!0,this._postMultiplyPivotMatrix=K,this._postMultiplyPivotMatrix&&(this._pivotMatrixInverse?this._pivotMatrix.invertToRef(this._pivotMatrixInverse):this._pivotMatrixInverse=x.uq.Invert(this._pivotMatrix)),this}getPivotMatrix(){return this._pivotMatrix}instantiateHierarchy(t=null,K,D){const a=this.clone("Clone of "+(this.name||this.id),t||this.parent,!0);a&&D&&D(this,a);for(const t of this.getChildTransformNodes(!0))t.instantiateHierarchy(a,K,D);return a}freezeWorldMatrix(t=null,K=!1){return t?K?(this._rotation.setAll(0),this._rotationQuaternion=this._rotationQuaternion||x.PT.Identity(),t.decompose(this._scaling,this._rotationQuaternion,this._position),this.computeWorldMatrix(!0)):(this._worldMatrix=t,this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this._afterComputeWorldMatrix()):(this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0)),this._isDirty=!1,this._isWorldMatrixFrozen=!0,this}unfreezeWorldMatrix(){return this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0),this}get isWorldMatrixFrozen(){return this._isWorldMatrixFrozen}getAbsolutePosition(){return this.computeWorldMatrix(),this._absolutePosition}setAbsolutePosition(t){if(!t)return this;let K,D,a;if(void 0===t.x){if(arguments.length<3)return this;K=arguments[0],D=arguments[1],a=arguments[2]}else K=t.x,D=t.y,a=t.z;if(this.parent){const t=x.AA.Matrix[0];this.parent.getWorldMatrix().invertToRef(t),x.Pq.TransformCoordinatesFromFloatsToRef(K,D,a,t,this.position)}else this.position.x=K,this.position.y=D,this.position.z=a;return this._absolutePosition.copyFrom(t),this}setPositionWithLocalVector(t){return this.computeWorldMatrix(),this.position=x.Pq.TransformNormal(t,this._localMatrix),this}getPositionExpressedInLocalSpace(){this.computeWorldMatrix();const t=x.AA.Matrix[0];return this._localMatrix.invertToRef(t),x.Pq.TransformNormal(this.position,t)}locallyTranslate(t){return this.computeWorldMatrix(!0),this.position=x.Pq.TransformCoordinates(t,this._localMatrix),this}lookAt(t,K=0,D=0,a=0,G=0){const N=i._LookAtVectorCache,W=0===G?this.position:this.getAbsolutePosition();if(t.subtractToRef(W,N),this.setDirection(N,K,D,a),1===G&&this.parent)if(this.rotationQuaternion){const t=x.AA.Matrix[0];this.rotationQuaternion.toRotationMatrix(t);const K=x.AA.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(K),K.invert(),t.multiplyToRef(K,t),this.rotationQuaternion.fromRotationMatrix(t)}else{const t=x.AA.Quaternion[0];x.PT.FromEulerVectorToRef(this.rotation,t);const K=x.AA.Matrix[0];t.toRotationMatrix(K);const D=x.AA.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(D),D.invert(),K.multiplyToRef(D,K),t.fromRotationMatrix(K),t.toEulerAnglesToRef(this.rotation)}return this}getDirection(t){const K=x.Pq.Zero();return this.getDirectionToRef(t,K),K}getDirectionToRef(t,K){return x.Pq.TransformNormalToRef(t,this.getWorldMatrix(),K),this}setDirection(t,K=0,D=0,a=0){const G=-Math.atan2(t.z,t.x)+Math.PI/2,N=Math.sqrt(t.x*t.x+t.z*t.z),W=-Math.atan2(t.y,N);return this.rotationQuaternion?x.PT.RotationYawPitchRollToRef(G+K,W+D,a,this.rotationQuaternion):(this.rotation.x=W+D,this.rotation.y=G+K,this.rotation.z=a),this}setPivotPoint(t,K=0){0==this.getScene().getRenderId()&&this.computeWorldMatrix(!0);const D=this.getWorldMatrix();if(1==K){const K=x.AA.Matrix[0];D.invertToRef(K),t=x.Pq.TransformCoordinates(t,K)}return this.setPivotMatrix(x.uq.Translation(-t.x,-t.y,-t.z),!0)}getPivotPoint(){const t=x.Pq.Zero();return this.getPivotPointToRef(t),t}getPivotPointToRef(t){return t.x=-this._pivotMatrix.m[12],t.y=-this._pivotMatrix.m[13],t.z=-this._pivotMatrix.m[14],this}getAbsolutePivotPoint(){const t=x.Pq.Zero();return this.getAbsolutePivotPointToRef(t),t}getAbsolutePivotPointToRef(t){return this.getPivotPointToRef(t),x.Pq.TransformCoordinatesToRef(t,this.getWorldMatrix(),t),this}markAsDirty(t){if(this._isDirty)return this;if(this._children)for(const K of this._children)K.markAsDirty(t);return super.markAsDirty(t)}setParent(t,K=!1,D=!1){if(!t&&!this.parent)return this;const a=x.AA.Quaternion[0],G=x.AA.Vector3[0],N=x.AA.Vector3[1],W=x.AA.Matrix[1];x.uq.IdentityToRef(W);const b=x.AA.Matrix[0];this.computeWorldMatrix(!0);let n=this.rotationQuaternion;return n||(n=i._TmpRotation,x.PT.RotationYawPitchRollToRef(this._rotation.y,this._rotation.x,this._rotation.z,n)),x.uq.ComposeToRef(this.scaling,n,this.position,b),this.parent&&b.multiplyToRef(this.parent.computeWorldMatrix(!0),b),t&&(t.computeWorldMatrix(!0).invertToRef(W),b.multiplyToRef(W,b)),b.decompose(N,a,G,K?this:void 0),this.rotationQuaternion?this.rotationQuaternion.copyFrom(a):a.toEulerAnglesToRef(this.rotation),this.scaling.copyFrom(N),this.position.copyFrom(G),this.parent=t,D&&this.setPivotMatrix(x.uq.Identity()),this}addChild(t,K=!1){return t.setParent(this,K),this}removeChild(t,K=!1){return t.setParent(null,K),this}get nonUniformScaling(){return this._nonUniformScaling}_updateNonUniformScalingState(t){return this._nonUniformScaling!==t&&(this._nonUniformScaling=t,!0)}attachToBone(t,K){return this._currentParentWhenAttachingToBone=this.parent,this._transformToBoneReferal=K,this.parent=t,t.getSkeleton().prepare(!0),t.getFinalMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this}detachFromBone(t=!1){return this.parent?(this.parent.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this._transformToBoneReferal=null,this.parent=t?this._currentParentWhenAttachingToBone:null,this):(t&&(this.parent=this._currentParentWhenAttachingToBone),this)}rotate(t,K,D){let a;if(t.normalize(),this.rotationQuaternion||(this.rotationQuaternion=this.rotation.toQuaternion(),this.rotation.setAll(0)),D&&0!==D){if(this.parent){const D=this.parent.getWorldMatrix(),a=x.AA.Matrix[0];D.invertToRef(a),t=x.Pq.TransformNormal(t,a),D.determinant()<0&&(K*=-1)}a=x.PT.RotationAxisToRef(t,K,i._RotationAxisCache),a.multiplyToRef(this.rotationQuaternion,this.rotationQuaternion)}else a=x.PT.RotationAxisToRef(t,K,i._RotationAxisCache),this.rotationQuaternion.multiplyToRef(a,this.rotationQuaternion);return this}rotateAround(t,K,D){K.normalize(),this.rotationQuaternion||(this.rotationQuaternion=x.PT.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z),this.rotation.setAll(0));const a=x.AA.Vector3[0],G=x.AA.Vector3[1],N=x.AA.Vector3[2],W=x.AA.Quaternion[0],b=x.AA.Matrix[0],n=x.AA.Matrix[1],e=x.AA.Matrix[2],i=x.AA.Matrix[3];return t.subtractToRef(this.position,a),x.uq.TranslationToRef(a.x,a.y,a.z,b),x.uq.TranslationToRef(-a.x,-a.y,-a.z,n),x.uq.RotationAxisToRef(K,D,e),n.multiplyToRef(e,i),i.multiplyToRef(b,i),i.decompose(G,W,N),this.position.addInPlace(N),W.multiplyToRef(this.rotationQuaternion,this.rotationQuaternion),this}translate(t,K,D){const a=t.scale(K);if(D&&0!==D)this.setAbsolutePosition(this.getAbsolutePosition().add(a));else{const t=this.getPositionExpressedInLocalSpace().add(a);this.setPositionWithLocalVector(t)}return this}addRotation(t,K,D){let a;this.rotationQuaternion?a=this.rotationQuaternion:(a=x.AA.Quaternion[1],x.PT.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,a));const G=x.AA.Quaternion[0];return x.PT.RotationYawPitchRollToRef(K,t,D,G),a.multiplyInPlace(G),this.rotationQuaternion||a.toEulerAnglesToRef(this.rotation),this}_getEffectiveParent(){return this.parent}isWorldMatrixCameraDependent(){return this._infiniteDistance&&!this.parent||this._billboardMode!==i.BILLBOARDMODE_NONE&&!this.preserveParentRotationForBillboard}computeWorldMatrix(t=!1,K=null){if(this._isWorldMatrixFrozen&&!this._isDirty)return this._worldMatrix;const D=this.getScene().getRenderId();if(!this._isDirty&&!t&&(this._currentRenderId===D||this.isSynchronized()))return this._currentRenderId=D,this._worldMatrix;K=K||this.getScene().activeCamera,this._updateCache();const a=this._cache;a.pivotMatrixUpdated=!1,a.billboardMode=this.billboardMode,a.infiniteDistance=this.infiniteDistance,a.parent=this._parentNode,this._currentRenderId=D,this._childUpdateId+=1,this._isDirty=!1,this._position._isDirty=!1,this._rotation._isDirty=!1,this._scaling._isDirty=!1;const G=this._getEffectiveParent(),N=i._TmpScaling;let W,b=this._position;if(this._infiniteDistance&&!this.parent&&K){const t=K.getWorldMatrix(),D=new x.Pq(t.m[12],t.m[13],t.m[14]);b=i._TmpTranslation,b.copyFromFloats(this._position.x+D.x,this._position.y+D.y,this._position.z+D.z)}if(N.copyFromFloats(this._scaling.x*this.scalingDeterminant,this._scaling.y*this.scalingDeterminant,this._scaling.z*this.scalingDeterminant),this._rotationQuaternion?(this._rotationQuaternion._isDirty=!1,W=this._rotationQuaternion,this.reIntegrateRotationIntoRotationQuaternion&&this.rotation.lengthSquared()&&(this._rotationQuaternion.multiplyInPlace(x.PT.RotationYawPitchRoll(this._rotation.y,this._rotation.x,this._rotation.z)),this._rotation.copyFromFloats(0,0,0))):(W=i._TmpRotation,x.PT.RotationYawPitchRollToRef(this._rotation.y,this._rotation.x,this._rotation.z,W)),this._usePivotMatrix){const t=x.AA.Matrix[1];x.uq.ScalingToRef(N.x,N.y,N.z,t);const K=x.AA.Matrix[0];W.toRotationMatrix(K),this._pivotMatrix.multiplyToRef(t,x.AA.Matrix[4]),x.AA.Matrix[4].multiplyToRef(K,this._localMatrix),this._postMultiplyPivotMatrix&&this._localMatrix.multiplyToRef(this._pivotMatrixInverse,this._localMatrix),this._localMatrix.addTranslationFromFloats(b.x,b.y,b.z)}else x.uq.ComposeToRef(N,W,b,this._localMatrix);if(G&&G.getWorldMatrix){if(t&&G.computeWorldMatrix(t),a.useBillboardPath){if(this._transformToBoneReferal){const t=this.parent;t.getSkeleton().prepare(),t.getFinalMatrix().multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),x.AA.Matrix[7])}else x.AA.Matrix[7].copyFrom(G.getWorldMatrix());const t=x.AA.Vector3[5],K=x.AA.Vector3[6],D=x.AA.Quaternion[0];x.AA.Matrix[7].decompose(K,D,t),x.uq.ScalingToRef(K.x,K.y,K.z,x.AA.Matrix[7]),x.AA.Matrix[7].setTranslation(t),i.BillboardUseParentOrientation&&(this._position.applyRotationQuaternionToRef(D,t),this._localMatrix.setTranslation(t)),this._localMatrix.multiplyToRef(x.AA.Matrix[7],this._worldMatrix)}else if(this._transformToBoneReferal){const t=this.parent;t.getSkeleton().prepare(),this._localMatrix.multiplyToRef(t.getFinalMatrix(),x.AA.Matrix[6]),x.AA.Matrix[6].multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),this._worldMatrix)}else this._localMatrix.multiplyToRef(G.getWorldMatrix(),this._worldMatrix);this._markSyncedWithParent()}else this._worldMatrix.copyFrom(this._localMatrix);if(a.useBillboardPath&&K&&this.billboardMode&&!a.useBillboardPosition){const t=x.AA.Vector3[0];if(this._worldMatrix.getTranslationToRef(t),x.AA.Matrix[1].copyFrom(K.getViewMatrix()),this._scene.useRightHandedSystem&&x.AA.Matrix[1].multiplyToRef(e,x.AA.Matrix[1]),x.AA.Matrix[1].setTranslationFromFloats(0,0,0),x.AA.Matrix[1].invertToRef(x.AA.Matrix[0]),(this.billboardMode&i.BILLBOARDMODE_ALL)!==i.BILLBOARDMODE_ALL){x.AA.Matrix[0].decompose(void 0,x.AA.Quaternion[0],void 0);const t=x.AA.Vector3[1];x.AA.Quaternion[0].toEulerAnglesToRef(t),(this.billboardMode&i.BILLBOARDMODE_X)!==i.BILLBOARDMODE_X&&(t.x=0),(this.billboardMode&i.BILLBOARDMODE_Y)!==i.BILLBOARDMODE_Y&&(t.y=0),(this.billboardMode&i.BILLBOARDMODE_Z)!==i.BILLBOARDMODE_Z&&(t.z=0),x.uq.RotationYawPitchRollToRef(t.y,t.x,t.z,x.AA.Matrix[0])}this._worldMatrix.setTranslationFromFloats(0,0,0),this._worldMatrix.multiplyToRef(x.AA.Matrix[0],this._worldMatrix),this._worldMatrix.setTranslation(x.AA.Vector3[0])}else if(a.useBillboardPath&&K&&a.useBillboardPosition){const t=x.AA.Vector3[0];this._worldMatrix.getTranslationToRef(t);const D=K.globalPosition;this._worldMatrix.invertToRef(x.AA.Matrix[1]);const a=x.AA.Vector3[1];x.Pq.TransformCoordinatesToRef(D,x.AA.Matrix[1],a),a.normalize();const G=-Math.atan2(a.z,a.x)+Math.PI/2,N=Math.sqrt(a.x*a.x+a.z*a.z),W=-Math.atan2(a.y,N);if(x.PT.RotationYawPitchRollToRef(G,W,0,x.AA.Quaternion[0]),(this.billboardMode&i.BILLBOARDMODE_ALL)!==i.BILLBOARDMODE_ALL){const t=x.AA.Vector3[1];x.AA.Quaternion[0].toEulerAnglesToRef(t),(this.billboardMode&i.BILLBOARDMODE_X)!==i.BILLBOARDMODE_X&&(t.x=0),(this.billboardMode&i.BILLBOARDMODE_Y)!==i.BILLBOARDMODE_Y&&(t.y=0),(this.billboardMode&i.BILLBOARDMODE_Z)!==i.BILLBOARDMODE_Z&&(t.z=0),x.uq.RotationYawPitchRollToRef(t.y,t.x,t.z,x.AA.Matrix[0])}else x.uq.FromQuaternionToRef(x.AA.Quaternion[0],x.AA.Matrix[0]);this._worldMatrix.setTranslationFromFloats(0,0,0),this._worldMatrix.multiplyToRef(x.AA.Matrix[0],this._worldMatrix),this._worldMatrix.setTranslation(x.AA.Vector3[0])}return this.ignoreNonUniformScaling?this._updateNonUniformScalingState(!1):this._scaling.isNonUniformWithinEpsilon(1e-6)?this._updateNonUniformScalingState(!0):G&&G._nonUniformScaling?this._updateNonUniformScalingState(G._nonUniformScaling):this._updateNonUniformScalingState(!1),this._afterComputeWorldMatrix(),this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this._isAbsoluteSynced=!1,this.onAfterWorldMatrixUpdateObservable.notifyObservers(this),this._poseMatrix||(this._poseMatrix=x.uq.Invert(this._worldMatrix)),this._worldMatrixDeterminantIsDirty=!0,this._worldMatrix}resetLocalMatrix(t=!0){if(this.computeWorldMatrix(),t){const t=this.getChildren();for(let K=0;K<t.length;++K){const D=t[K];if(D){D.computeWorldMatrix();const t=x.AA.Matrix[0];D._localMatrix.multiplyToRef(this._localMatrix,t);const K=x.AA.Quaternion[0];t.decompose(D.scaling,K,D.position),D.rotationQuaternion?D.rotationQuaternion.copyFrom(K):K.toEulerAnglesToRef(D.rotation)}}}this.scaling.copyFromFloats(1,1,1),this.position.copyFromFloats(0,0,0),this.rotation.copyFromFloats(0,0,0),this.rotationQuaternion&&(this.rotationQuaternion=x.PT.Identity()),this._worldMatrix=x.uq.Identity()}_afterComputeWorldMatrix(){}registerAfterWorldMatrixUpdate(t){return this.onAfterWorldMatrixUpdateObservable.add(t),this}unregisterAfterWorldMatrixUpdate(t){return this.onAfterWorldMatrixUpdateObservable.removeCallback(t),this}getPositionInCameraSpace(t=null){return t||(t=this.getScene().activeCamera),x.Pq.TransformCoordinates(this.getAbsolutePosition(),t.getViewMatrix())}getDistanceToCamera(t=null){return t||(t=this.getScene().activeCamera),this.getAbsolutePosition().subtract(t.globalPosition).length()}clone(t,K,D){const a=N.p.Clone((()=>new i(t,this.getScene())),this);if(a.name=t,a.id=t,K&&(a.parent=K),!D){const K=this.getDescendants(!0);for(let D=0;D<K.length;D++){const G=K[D];G.clone&&G.clone(t+"."+G.name,a)}}return a}serialize(t){const K=N.p.Serialize(this,t);return K.type=this.getClassName(),K.uniqueId=this.uniqueId,this.parent&&this.parent._serializeAsParent(K),K.localMatrix=this.getPivotMatrix().asArray(),K.isEnabled=this.isEnabled(),N.p.AppendSerializedAnimations(this,K),K.ranges=this.serializeAnimationRanges(),K}static Parse(t,K,D){const a=N.p.Parse((()=>new i(t.name,K)),t,K,D);if(t.localMatrix?a.setPreTransformMatrix(x.uq.FromArray(t.localMatrix)):t.pivotMatrix&&a.setPivotMatrix(x.uq.FromArray(t.pivotMatrix)),a.setEnabled(t.isEnabled),a._waitingParsedUniqueId=t.uniqueId,void 0!==t.parentId&&(a._waitingParentId=t.parentId),void 0!==t.parentInstanceIndex&&(a._waitingParentInstanceIndex=t.parentInstanceIndex),t.animations){for(let K=0;K<t.animations.length;K++){const D=t.animations[K],G=n.n9("BABYLON.Animation");G&&a.animations.push(G.Parse(D))}b.b.ParseAnimationRanges(a,t,K)}return t.autoAnimate&&K.beginAnimation(a,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,t.autoAnimateSpeed||1),a}getChildTransformNodes(t,K){const D=[];return this._getDescendants(D,t,(t=>(!K||K(t))&&t instanceof i)),D}dispose(t,K=!1){if(this.getScene().stopAnimation(this),this.getScene().removeTransformNode(this),this._parentContainer){const t=this._parentContainer.transformNodes.indexOf(this);t>-1&&this._parentContainer.transformNodes.splice(t,1),this._parentContainer=null}if(this.onAfterWorldMatrixUpdateObservable.clear(),t){const t=this.getChildTransformNodes(!0);for(const K of t)K.parent=null,K.computeWorldMatrix(!0)}super.dispose(t,K)}normalizeToUnitCube(t=!0,K=!1,D){let a=null,G=null;K&&(this.rotationQuaternion?(G=this.rotationQuaternion.clone(),this.rotationQuaternion.copyFromFloats(0,0,0,1)):this.rotation&&(a=this.rotation.clone(),this.rotation.copyFromFloats(0,0,0)));const N=this.getHierarchyBoundingVectors(t,D),W=N.max.subtract(N.min),x=Math.max(W.x,W.y,W.z);if(0===x)return this;const b=1/x;return this.scaling.scaleInPlace(b),K&&(this.rotationQuaternion&&G?this.rotationQuaternion.copyFrom(G):this.rotation&&a&&this.rotation.copyFrom(a)),this}_syncAbsoluteScalingAndRotation(){this._isAbsoluteSynced||(this._worldMatrix.decompose(this._absoluteScaling,this._absoluteRotationQuaternion),this._isAbsoluteSynced=!0)}}i.BILLBOARDMODE_NONE=0,i.BILLBOARDMODE_X=1,i.BILLBOARDMODE_Y=2,i.BILLBOARDMODE_Z=4,i.BILLBOARDMODE_ALL=7,i.BILLBOARDMODE_USE_POSITION=128,i.BillboardUseParentOrientation=!1,i._TmpRotation=x.PT.Zero(),i._TmpScaling=x.Pq.Zero(),i._TmpTranslation=x.Pq.Zero(),i._LookAtVectorCache=new x.Pq(0,0,0),i._RotationAxisCache=new x.PT,a.Cg([G.P_("position")],i.prototype,"_position",void 0),a.Cg([G.P_("rotation")],i.prototype,"_rotation",void 0),a.Cg([G.bR("rotationQuaternion")],i.prototype,"_rotationQuaternion",void 0),a.Cg([G.P_("scaling")],i.prototype,"_scaling",void 0),a.Cg([G.lK("billboardMode")],i.prototype,"_billboardMode",void 0),a.Cg([G.lK()],i.prototype,"scalingDeterminant",void 0),a.Cg([G.lK("infiniteDistance")],i.prototype,"_infiniteDistance",void 0),a.Cg([G.lK()],i.prototype,"ignoreNonUniformScaling",void 0),a.Cg([G.lK()],i.prototype,"reIntegrateRotationIntoRotationQuaternion",void 0)},906264:(t,K,D)=>{D.d(K,{d:()=>n});var a=D(604910),G=D(615473),N=D(562756),W=D(779908),x=D(332290);class b{constructor(t,K,D,a){this.name=t,this.worldAxisForNormal=K,this.worldAxisForFileX=D,this.worldAxisForFileY=a}}class n{static ConvertCubeMapTextureToSphericalPolynomial(t){var K;if(!t.isCube)return null;null===(K=t.getScene())||void 0===K||K.getEngine().flushFramebuffer();const D=t.getSize().width,a=t.readPixels(0,void 0,void 0,!1),G=t.readPixels(1,void 0,void 0,!1);let N,W;t.isRenderTarget?(N=t.readPixels(3,void 0,void 0,!1),W=t.readPixels(2,void 0,void 0,!1)):(N=t.readPixels(2,void 0,void 0,!1),W=t.readPixels(3,void 0,void 0,!1));const x=t.readPixels(4,void 0,void 0,!1),b=t.readPixels(5,void 0,void 0,!1),n=t.gammaSpace,e=5;let i=0;return 1!=t.textureType&&2!=t.textureType||(i=1),new Promise((t=>{Promise.all([G,a,N,W,x,b]).then((([K,a,G,N,W,x])=>{const b={size:D,right:a,left:K,up:G,down:N,front:W,back:x,format:e,type:i,gammaSpace:n};t(this.ConvertCubeMapToSphericalPolynomial(b))}))}))}static _AreaElement(t,K){return Math.atan2(t*K,Math.sqrt(t*t+K*K+1))}static ConvertCubeMapToSphericalPolynomial(t){const K=new N.O;let D=0;const a=2/t.size,b=a,n=.5*a,e=n-1;for(let N=0;N<6;N++){const i=this._FileFaces[N],z=t[i.name];let I=e;const Z=5===t.format?4:3;for(let N=0;N<t.size;N++){let w=e;for(let b=0;b<t.size;b++){const e=i.worldAxisForFileX.scale(w).add(i.worldAxisForFileY.scale(I)).add(i.worldAxisForNormal);e.normalize();const m=this._AreaElement(w-n,I-n)-this._AreaElement(w-n,I+n)-this._AreaElement(w+n,I-n)+this._AreaElement(w+n,I+n);let u=z[N*t.size*Z+b*Z+0],d=z[N*t.size*Z+b*Z+1],E=z[N*t.size*Z+b*Z+2];isNaN(u)&&(u=0),isNaN(d)&&(d=0),isNaN(E)&&(E=0),0===t.type&&(u/=255,d/=255,E/=255),t.gammaSpace&&(u=Math.pow(G.X.Clamp(u),W.tk),d=Math.pow(G.X.Clamp(d),W.tk),E=Math.pow(G.X.Clamp(E),W.tk));const l=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const t=Math.max(u,d,E);if(t>l){const K=l/t;u*=K,d*=K,E*=K}}else u=G.X.Clamp(u,0,l),d=G.X.Clamp(d,0,l),E=G.X.Clamp(E,0,l);const Q=new x.v9(u,d,E);K.addLight(e,Q,m),D+=m,w+=a}I+=b}}const i=6*(4*Math.PI)/6/D;return K.scaleInPlace(i),K.convertIncidentRadianceToIrradiance(),K.convertIrradianceToLambertianRadiance(),N.Q.FromHarmonics(K)}}n._FileFaces=[new b("right",new a.Pq(1,0,0),new a.Pq(0,0,-1),new a.Pq(0,-1,0)),new b("left",new a.Pq(-1,0,0),new a.Pq(0,0,1),new a.Pq(0,-1,0)),new b("up",new a.Pq(0,1,0),new a.Pq(1,0,0),new a.Pq(0,0,1)),new b("down",new a.Pq(0,-1,0),new a.Pq(1,0,0),new a.Pq(0,0,-1)),new b("front",new a.Pq(0,0,1),new a.Pq(1,0,0),new a.Pq(0,-1,0)),new b("back",new a.Pq(0,0,-1),new a.Pq(-1,0,0),new a.Pq(0,-1,0))],n.MAX_HDRI_VALUE=4096,n.PRESERVE_CLAMPED_COLORS=!1},843019:(t,K,D)=>{D.d(K,{LT:()=>b,NK:()=>W,VH:()=>x});var a=D(171482);function G(t,K,D,a,G,N){G>0?(G=function(t,K){return K>1023?t*Math.pow(2,1023)*Math.pow(2,K-1023):K<-1074?t*Math.pow(2,-1074)*Math.pow(2,K+1074):t*Math.pow(2,K)}(1,G-(128+8)),t[N+0]=K*G,t[N+1]=D*G,t[N+2]=a*G):(t[N+0]=0,t[N+1]=0,t[N+2]=0)}function N(t,K){let D="",a="";for(let G=K;G<t.length-K&&(a=String.fromCharCode(t[G]),"\n"!=a);G++)D+=a;return D}function W(t){let K=0,D=0,a=N(t,0);if("#"!=a[0]||"?"!=a[1])throw"Bad HDR Format.";let G=!1,W=!1,x=0;do{x+=a.length+1,a=N(t,x),"FORMAT=32-bit_rle_rgbe"==a?W=!0:0==a.length&&(G=!0)}while(!G);if(!W)throw"HDR Bad header format, unsupported FORMAT";x+=a.length+1,a=N(t,x);const b=/^-Y (.*) \+X (.*)$/g.exec(a);if(!b||b.length<3)throw"HDR Bad header format, no size";if(D=parseInt(b[2]),K=parseInt(b[1]),D<8||D>32767)throw"HDR Bad header format, unsupported size";return x+=a.length+1,{height:K,width:D,dataPosition:x}}function x(t,K,D=!1){const G=new Uint8Array(t),N=W(G),x=b(G,N);return a.D.ConvertPanoramaToCubemap(x,N.width,N.height,K,D)}function b(t,K){return function(t,K){let D=K.height;const a=K.width;let N,W,x,b,e,i=K.dataPosition,z=0,I=0,Z=0;const w=new ArrayBuffer(4*a),m=new Uint8Array(w),u=new ArrayBuffer(K.width*K.height*4*3),d=new Float32Array(u);for(;D>0;){if(N=t[i++],W=t[i++],x=t[i++],b=t[i++],2!=N||2!=W||128&x||K.width<8||K.width>32767)return n(t,K);if((x<<8|b)!=a)throw"HDR Bad header format, wrong scan line width";for(z=0,Z=0;Z<4;Z++)for(I=(Z+1)*a;z<I;)if(N=t[i++],W=t[i++],N>128){if(e=N-128,0==e||e>I-z)throw"HDR Bad Format, bad scanline data (run)";for(;e-- >0;)m[z++]=W}else{if(e=N,0==e||e>I-z)throw"HDR Bad Format, bad scanline data (non-run)";if(m[z++]=W,--e>0)for(let K=0;K<e;K++)m[z++]=t[i++]}for(Z=0;Z<a;Z++)N=m[Z],W=m[Z+a],x=m[Z+2*a],b=m[Z+3*a],G(d,N,W,x,b,(K.height-D)*a*3+3*Z);D--}return d}(t,K)}function n(t,K){let D=K.height;const a=K.width;let N,W,x,b,n,e=K.dataPosition;const i=new ArrayBuffer(K.width*K.height*4*3),z=new Float32Array(i);for(;D>0;){for(n=0;n<K.width;n++)N=t[e++],W=t[e++],x=t[e++],b=t[e++],G(z,N,W,x,b,(K.height-D)*a*3+3*n);D--}return z}},171482:(t,K,D)=>{D.d(K,{D:()=>G});var a=D(604910);class G{static ConvertPanoramaToCubemap(t,K,D,a,G=!1){if(!t)throw"ConvertPanoramaToCubemap: input cannot be null";if(t.length!=K*D*3)throw"ConvertPanoramaToCubemap: input size is wrong";return{front:this.CreateCubemapTexture(a,this.FACE_FRONT,t,K,D,G),back:this.CreateCubemapTexture(a,this.FACE_BACK,t,K,D,G),left:this.CreateCubemapTexture(a,this.FACE_LEFT,t,K,D,G),right:this.CreateCubemapTexture(a,this.FACE_RIGHT,t,K,D,G),up:this.CreateCubemapTexture(a,this.FACE_UP,t,K,D,G),down:this.CreateCubemapTexture(a,this.FACE_DOWN,t,K,D,G),size:a,type:1,format:4,gammaSpace:!1}}static CreateCubemapTexture(t,K,D,a,G,N=!1){const W=new ArrayBuffer(t*t*4*3),x=new Float32Array(W),b=N?Math.max(1,Math.round(a/4/t)):1,n=1/b,e=n*n,i=K[1].subtract(K[0]).scale(n/t),z=K[3].subtract(K[2]).scale(n/t),I=1/t;let Z=0;for(let N=0;N<t;N++)for(let W=0;W<b;W++){let W=K[0],w=K[2];for(let K=0;K<t;K++)for(let n=0;n<b;n++){const b=w.subtract(W).scale(Z).add(W);b.normalize();const n=this.CalcProjectionSpherical(b,D,a,G);x[N*t*3+3*K+0]+=n.r*e,x[N*t*3+3*K+1]+=n.g*e,x[N*t*3+3*K+2]+=n.b*e,W=W.add(i),w=w.add(z)}Z+=I*n}return x}static CalcProjectionSpherical(t,K,D,a){let G=Math.atan2(t.z,t.x);const N=Math.acos(t.y);for(;G<-Math.PI;)G+=2*Math.PI;for(;G>Math.PI;)G-=2*Math.PI;let W=G/Math.PI;const x=N/Math.PI;W=.5*W+.5;let b=Math.round(W*D);b<0?b=0:b>=D&&(b=D-1);let n=Math.round(x*a);n<0?n=0:n>=a&&(n=a-1);const e=a-n-1;return{r:K[e*D*3+3*b+0],g:K[e*D*3+3*b+1],b:K[e*D*3+3*b+2]}}}G.FACE_LEFT=[new a.Pq(-1,-1,-1),new a.Pq(1,-1,-1),new a.Pq(-1,1,-1),new a.Pq(1,1,-1)],G.FACE_RIGHT=[new a.Pq(1,-1,1),new a.Pq(-1,-1,1),new a.Pq(1,1,1),new a.Pq(-1,1,1)],G.FACE_FRONT=[new a.Pq(1,-1,-1),new a.Pq(1,-1,1),new a.Pq(1,1,-1),new a.Pq(1,1,1)],G.FACE_BACK=[new a.Pq(-1,-1,1),new a.Pq(-1,-1,-1),new a.Pq(-1,1,1),new a.Pq(-1,1,-1)],G.FACE_DOWN=[new a.Pq(1,1,-1),new a.Pq(1,1,1),new a.Pq(-1,1,-1),new a.Pq(-1,1,1)],G.FACE_UP=[new a.Pq(-1,-1,-1),new a.Pq(-1,-1,1),new a.Pq(1,-1,-1),new a.Pq(1,-1,1)]},161892:(t,K,D)=>{D.d(K,{Z:()=>a});class a{static Eval(t,K){return"true"===(t=t.match(/\([^()]*\)/g)?t.replace(/\([^()]*\)/g,(t=>(t=t.slice(1,t.length-1),a._HandleParenthesisContent(t,K)))):a._HandleParenthesisContent(t,K))||"false"!==t&&a.Eval(t,K)}static _HandleParenthesisContent(t,K){let D;K=K||(t=>"true"===t);const G=t.split("||");for(const t in G)if(Object.prototype.hasOwnProperty.call(G,t)){let N=a._SimplifyNegation(G[t].trim());const W=N.split("&&");if(W.length>1)for(let t=0;t<W.length;++t){const G=a._SimplifyNegation(W[t].trim());if(D="true"!==G&&"false"!==G?"!"===G[0]?!K(G.substring(1)):K(G):"true"===G,!D){N="false";break}}if(D||"true"===N){D=!0;break}D="true"!==N&&"false"!==N?"!"===N[0]?!K(N.substring(1)):K(N):"true"===N}return D?"true":"false"}static _SimplifyNegation(t){return"!true"===(t=(t=t.replace(/^[\s!]+/,(t=>(t=t.replace(/[\s]/g,(()=>""))).length%2?"!":""))).trim())?t="false":"!false"===t&&(t="true"),t}}},967872:(t,K,D)=>{function a(t,K){const D=[];for(let a=0;a<t;++a)D.push(K());return D}function G(t,K){return a(t,K)}D.d(K,{lL:()=>W,ln:()=>G,mI:()=>a});const N=["push","splice","pop","shift","unshift"];function W(t,K){const D=N.map((D=>function(t,K,D){const a=t[K];if("function"!=typeof a)return null;const G=function(){const a=t.length,N=G.previous.apply(t,arguments);return D(K,a),N};return a.next=G,G.previous=a,t[K]=G,()=>{const D=G.previous;if(!D)return;const a=G.next;a?(D.next=a,a.previous=D):(D.next=void 0,t[K]=D),G.next=void 0,G.previous=void 0}}(t,D,K)));return()=>{D.forEach((t=>{null==t||t()}))}}},393518:(t,K,D)=>{function a(t,K,D=!1){const a=K.width,G=K.height;if(t instanceof Float32Array){let K=t.byteLength/t.BYTES_PER_ELEMENT;const D=new Uint8Array(K);for(;--K>=0;){let a=t[K];a<0?a=0:a>1&&(a=1),D[K]=255*a}t=D}const N=document.createElement("canvas");N.width=a,N.height=G;const W=N.getContext("2d");if(!W)return null;const x=W.createImageData(a,G);if(x.data.set(t),W.putImageData(x,0,0),D){const t=document.createElement("canvas");t.width=a,t.height=G;const K=t.getContext("2d");return K?(K.translate(0,G),K.scale(1,-1),K.drawImage(N,0,0),t.toDataURL("image/png")):null}return N.toDataURL("image/png")}function G(t,K=0,D=0){const G=t.getInternalTexture();if(!G)return null;const N=t._readPixelsSync(K,D);return N?a(N,t.getSize(),G.invertY):null}async function N(t,K=0,D=0){const G=t.getInternalTexture();if(!G)return null;const N=await t.readPixels(K,D);return N?a(N,t.getSize(),G.invertY):null}D.d(K,{lP:()=>G,nh:()=>N})},378480:(t,K,D)=>{function a(t,K,D){try{const a=t.next();a.done?K(a):a.value?a.value.then((()=>{a.value=void 0,K(a)}),D):K(a)}catch(t){D(t)}}function G(t=25){let K;return(D,G,N)=>{const W=performance.now();void 0===K||W-K>t?(K=W,setTimeout((()=>{a(D,G,N)}),0)):a(D,G,N)}}function N(t,K,D,a,G){const N=()=>{let W;const x=t=>{t.done?D(t.value):void 0===W?W=!0:N()};do{W=void 0,G&&G.aborted?a(new Error("Aborted")):K(t,x,a),void 0===W&&(W=!1)}while(W)};N()}function W(t,K){let D;return N(t,a,(t=>D=t),(t=>{throw t}),K),D}function x(t,K,D){return new Promise(((a,G)=>{N(t,K,a,G,D)}))}function b(t,K){return(...D)=>W(t(...D),K)}D.d(K,{Aj:()=>b,V1:()=>W,VP:()=>G,kj:()=>x})},684911:(t,K,D)=>{D.d(K,{D:()=>R});var a=D(615473),G=D(706400),N=D(906264),W=D(484573);D(757634),D(109050);const x=542327876,b=131072,n=512,e=4,i=64,z=131072;function I(t){return t.charCodeAt(0)+(t.charCodeAt(1)<<8)+(t.charCodeAt(2)<<16)+(t.charCodeAt(3)<<24)}const Z=I("DXT1"),w=I("DXT3"),m=I("DXT5"),u=I("DX10"),d=113,E=116,l=2,Q=10,P=88,y=31,q=0,X=1,h=2,J=3,T=4,_=7,C=20,H=21,o=22,U=23,V=24,s=25,F=26,c=28,g=32;class R{static GetDDSInfo(t){const K=new Int32Array(t.buffer,t.byteOffset,y),D=new Int32Array(t.buffer,t.byteOffset,y+4);let a=1;K[h]&b&&(a=Math.max(1,K[_]));const G=K[H],N=G===u?D[g]:0;let W=0;switch(G){case d:W=2;break;case E:W=1;break;case u:if(N===Q){W=2;break}if(N===l){W=1;break}}return{width:K[T],height:K[J],mipmapCount:a,isFourCC:(K[C]&e)===e,isRGB:(K[C]&i)===i,isLuminance:(K[C]&z)===z,isCube:(K[c]&n)===n,isCompressed:G===Z||G===w||G===m,dxgiFormat:N,textureType:W}}static _GetHalfFloatAsFloatRGBAArrayBuffer(t,K,D,a,G,N){const x=new Float32Array(a),b=new Uint16Array(G,D);let n=0;for(let D=0;D<K;D++)for(let K=0;K<t;K++){const a=4*(K+D*t);x[n]=W.SX(b[a]),x[n+1]=W.SX(b[a+1]),x[n+2]=W.SX(b[a+2]),R.StoreLODInAlphaChannel?x[n+3]=N:x[n+3]=W.SX(b[a+3]),n+=4}return x}static _GetHalfFloatRGBAArrayBuffer(t,K,D,a,G,N){if(R.StoreLODInAlphaChannel){const x=new Uint16Array(a),b=new Uint16Array(G,D);let n=0;for(let D=0;D<K;D++)for(let K=0;K<t;K++){const a=4*(K+D*t);x[n]=b[a],x[n+1]=b[a+1],x[n+2]=b[a+2],x[n+3]=W.LZ(N),n+=4}return x}return new Uint16Array(G,D,a)}static _GetFloatRGBAArrayBuffer(t,K,D,a,G,N){if(R.StoreLODInAlphaChannel){const W=new Float32Array(a),x=new Float32Array(G,D);let b=0;for(let D=0;D<K;D++)for(let K=0;K<t;K++){const a=4*(K+D*t);W[b]=x[a],W[b+1]=x[a+1],W[b+2]=x[a+2],W[b+3]=N,b+=4}return W}return new Float32Array(G,D,a)}static _GetFloatAsHalfFloatRGBAArrayBuffer(t,K,D,a,G,N){const x=new Uint16Array(a),b=new Float32Array(G,D);let n=0;for(let D=0;D<K;D++)for(let K=0;K<t;K++)x[n]=W.LZ(b[n]),x[n+1]=W.LZ(b[n+1]),x[n+2]=W.LZ(b[n+2]),R.StoreLODInAlphaChannel?x[n+3]=W.LZ(N):x[n+3]=W.LZ(b[n+3]),n+=4;return x}static _GetFloatAsUIntRGBAArrayBuffer(t,K,D,G,N,W){const x=new Uint8Array(G),b=new Float32Array(N,D);let n=0;for(let D=0;D<K;D++)for(let K=0;K<t;K++){const G=4*(K+D*t);x[n]=255*a.X.Clamp(b[G]),x[n+1]=255*a.X.Clamp(b[G+1]),x[n+2]=255*a.X.Clamp(b[G+2]),R.StoreLODInAlphaChannel?x[n+3]=W:x[n+3]=255*a.X.Clamp(b[G+3]),n+=4}return x}static _GetHalfFloatAsUIntRGBAArrayBuffer(t,K,D,G,N,x){const b=new Uint8Array(G),n=new Uint16Array(N,D);let e=0;for(let D=0;D<K;D++)for(let K=0;K<t;K++){const G=4*(K+D*t);b[e]=255*a.X.Clamp(W.SX(n[G])),b[e+1]=255*a.X.Clamp(W.SX(n[G+1])),b[e+2]=255*a.X.Clamp(W.SX(n[G+2])),R.StoreLODInAlphaChannel?b[e+3]=x:b[e+3]=255*a.X.Clamp(W.SX(n[G+3])),e+=4}return b}static _GetRGBAArrayBuffer(t,K,D,a,G,N,W,x,b){const n=new Uint8Array(a),e=new Uint8Array(G,D);let i=0;for(let D=0;D<K;D++)for(let K=0;K<t;K++){const a=4*(K+D*t);n[i]=e[a+N],n[i+1]=e[a+W],n[i+2]=e[a+x],n[i+3]=e[a+b],i+=4}return n}static _ExtractLongWordOrder(t){return 0===t||255===t||-16777216===t?0:1+R._ExtractLongWordOrder(t>>8)}static _GetRGBArrayBuffer(t,K,D,a,G,N,W,x){const b=new Uint8Array(a),n=new Uint8Array(G,D);let e=0;for(let D=0;D<K;D++)for(let K=0;K<t;K++){const a=3*(K+D*t);b[e]=n[a+N],b[e+1]=n[a+W],b[e+2]=n[a+x],e+=3}return b}static _GetLuminanceArrayBuffer(t,K,D,a,G){const N=new Uint8Array(a),W=new Uint8Array(G,D);let x=0;for(let D=0;D<K;D++)for(let K=0;K<t;K++){const a=K+D*t;N[x]=W[a],x++}return N}static UploadDDSLevels(t,K,D,a,W,n,e=-1,i,z=!0){let I=null;a.sphericalPolynomial&&(I=[]);const C=!!t.getCaps().s3tc;K.generateMipMaps=W;const c=new Int32Array(D.buffer,D.byteOffset,y);let g,A,Y,L,S,f,$,B=0,O=0,v=1;if(c[q]!==x)return void G.V.Error("Invalid magic number in DDS header");if(!a.isFourCC&&!a.isRGB&&!a.isLuminance)return void G.V.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(a.isCompressed&&!C)return void G.V.Error("Compressed textures are not supported on this platform.");let p=c[o];L=c[X]+4;let j=!1;if(a.isFourCC)switch(g=c[H],g){case Z:v=8,O=33777;break;case w:v=16,O=33778;break;case m:v=16,O=33779;break;case d:j=!0,p=64;break;case E:j=!0,p=128;break;case u:{L+=5*4;let t=!1;switch(a.dxgiFormat){case Q:j=!0,p=64,t=!0;break;case l:j=!0,p=128,t=!0;break;case P:a.isRGB=!0,a.isFourCC=!1,p=32,t=!0}if(t)break}default:return void G.V.Error(["Unsupported FourCC code:",(r=g,String.fromCharCode(255&r,r>>8&255,r>>16&255,r>>24&255))])}var r;const M=R._ExtractLongWordOrder(c[U]),k=R._ExtractLongWordOrder(c[V]),tt=R._ExtractLongWordOrder(c[s]),Kt=R._ExtractLongWordOrder(c[F]);j&&(O=t._getRGBABufferInternalSizedFormat(a.textureType)),f=1,c[h]&b&&!1!==W&&(f=Math.max(1,c[_]));const Dt=i||0,at=t.getCaps();for(let G=Dt;G<n;G++){for(A=c[T],Y=c[J],$=0;$<f;++$){if(-1===e||e===$){const N=-1===e?$:0;if(!a.isCompressed&&a.isFourCC){K.format=5,B=A*Y*4;let a=null;if(t._badOS||t._badDesktopOS||!at.textureHalfFloat&&!at.textureFloat)128===p?(a=R._GetFloatAsUIntRGBAArrayBuffer(A,Y,D.byteOffset+L,B,D.buffer,N),I&&0==N&&I.push(R._GetFloatRGBAArrayBuffer(A,Y,D.byteOffset+L,B,D.buffer,N))):64===p&&(a=R._GetHalfFloatAsUIntRGBAArrayBuffer(A,Y,D.byteOffset+L,B,D.buffer,N),I&&0==N&&I.push(R._GetHalfFloatAsFloatRGBAArrayBuffer(A,Y,D.byteOffset+L,B,D.buffer,N))),K.type=0;else{const t=at.textureFloat&&(z&&at.textureFloatLinearFiltering||!z),G=at.textureHalfFloat&&(z&&at.textureHalfFloatLinearFiltering||!z),W=(128===p||64===p&&!G)&&t?1:(64===p||128===p&&!t)&&G?2:0;let x,b=null;if(128===p)switch(W){case 1:x=R._GetFloatRGBAArrayBuffer,b=null;break;case 2:x=R._GetFloatAsHalfFloatRGBAArrayBuffer,b=R._GetFloatRGBAArrayBuffer;break;case 0:x=R._GetFloatAsUIntRGBAArrayBuffer,b=R._GetFloatRGBAArrayBuffer}else switch(W){case 1:x=R._GetHalfFloatAsFloatRGBAArrayBuffer,b=null;break;case 2:x=R._GetHalfFloatRGBAArrayBuffer,b=R._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:x=R._GetHalfFloatAsUIntRGBAArrayBuffer,b=R._GetHalfFloatAsFloatRGBAArrayBuffer}K.type=W,a=x(A,Y,D.byteOffset+L,B,D.buffer,N),I&&0==N&&I.push(b?b(A,Y,D.byteOffset+L,B,D.buffer,N):a)}a&&t._uploadDataToTextureDirectly(K,a,G,N)}else if(a.isRGB)K.type=0,24===p?(K.format=4,B=A*Y*3,S=R._GetRGBArrayBuffer(A,Y,D.byteOffset+L,B,D.buffer,M,k,tt),t._uploadDataToTextureDirectly(K,S,G,N)):(K.format=5,B=A*Y*4,S=R._GetRGBAArrayBuffer(A,Y,D.byteOffset+L,B,D.buffer,M,k,tt,Kt),t._uploadDataToTextureDirectly(K,S,G,N));else if(a.isLuminance){const a=t._getUnpackAlignement(),W=A;B=Math.floor((A+a-1)/a)*a*(Y-1)+W,S=R._GetLuminanceArrayBuffer(A,Y,D.byteOffset+L,B,D.buffer),K.format=1,K.type=0,t._uploadDataToTextureDirectly(K,S,G,N)}else B=Math.max(4,A)/4*Math.max(4,Y)/4*v,S=new Uint8Array(D.buffer,D.byteOffset+L,B),K.type=0,t._uploadCompressedDataToTextureDirectly(K,O,A,Y,S,G,N)}L+=p?A*Y*(p/8):B,A*=.5,Y*=.5,A=Math.max(1,A),Y=Math.max(1,Y)}if(void 0!==i)break}I&&I.length>0?a.sphericalPolynomial=N.d.ConvertCubeMapToSphericalPolynomial({size:c[T],right:I[0],left:I[1],up:I[2],down:I[3],front:I[4],back:I[5],format:5,type:1,gammaSpace:!1}):a.sphericalPolynomial=void 0}}R.StoreLODInAlphaChannel=!1},644973:(t,K,D)=>{D.d(K,{B:()=>N,K:()=>W});const a={},G={};function N(t){const K=t.getClassName();return G[K]||(G[K]={}),G[K]}function W(t){const K=t.getClassName();if(a[K])return a[K];a[K]={};const D=a[K];let N=t,W=K;for(;W;){const t=G[W];for(const K in t)D[K]=t[K];let K,a=!1;do{if(K=Object.getPrototypeOf(N),!K.getClassName){a=!0;break}if(K.getClassName()!==W)break;N=K}while(K);if(a)break;W=K.getClassName(),N=K}return D}},760998:(t,K,D)=>{D.d(K,{$z:()=>N,Cx:()=>d,GG:()=>u,P_:()=>i,WM:()=>e,Y9:()=>n,bR:()=>m,jT:()=>b,lK:()=>W,n1:()=>w,qK:()=>Z,uM:()=>x,wL:()=>I,xG:()=>z});var a=D(644973);function G(t,K){return(D,G)=>{const N=a.B(D);N[G]||(N[G]={type:t,sourceName:K})}}function N(t,K=null){return function(t,K=null){return(D,a)=>{const G=K||"_"+a;Object.defineProperty(D,a,{get:function(){return this[G]},set:function(K){"function"==typeof this.equals&&this.equals(K)||this[G]!==K&&(this[G]=K,D[t].apply(this))},enumerable:!0,configurable:!0})}}(t,K)}function W(t){return G(0,t)}function x(t){return G(1,t)}function b(t){return G(2,t)}function n(t){return G(3,t)}function e(t){return G(4,t)}function i(t){return G(5,t)}function z(t){return G(6,t)}function I(t){return G(7,t)}function Z(t){return G(8,t)}function w(t){return G(9,t)}function m(t){return G(10,t)}function u(t){return G(12,t)}function d(t,K,D,a){const G=D.value;D.value=(...D)=>{let N=G;if("undefined"!=typeof _native&&_native[K]){const t=_native[K];N=a?(...K)=>a(...K)?t(...K):G(...K):t}return t[K]=N,N(...D)}}d.filter=function(t){return(K,D,a)=>d(K,D,a,t)}},337776:(t,K,D)=>{D.d(K,{p:()=>n});var a=D(554014),G=D(443401),N=D(332290),W=D(604910),x=D(644973);const b=function(t,K,D,a={}){const N=t();G.Y&&G.Y.HasTags(K)&&G.Y.AddTagsTo(N,G.Y.GetTags(K,!0));const W=x.K(N),b={};for(const t in W){const G=W[t],x=K[t],e=G.type;if(null!=x&&("uniqueId"!==t||n.AllowLoadingUniqueId))switch(e){case 0:case 6:case 11:N[t]=x;break;case 1:a.cloneTexturesOnlyOnce&&b[x.uniqueId]?N[t]=b[x.uniqueId]:(N[t]=D||x.isRenderTarget?x:x.clone(),b[x.uniqueId]=N[t]);break;case 2:case 3:case 4:case 5:case 7:case 10:case 12:N[t]=D?x:x.clone()}}return N};class n{static AppendSerializedAnimations(t,K){if(t.animations){K.animations=[];for(let D=0;D<t.animations.length;D++){const a=t.animations[D];K.animations.push(a.serialize())}}}static Serialize(t,K){K||(K={}),G.Y&&(K.tags=G.Y.GetTags(t));const D=x.K(t);for(const a in D){const G=D[a],N=G.sourceName||a,W=G.type,x=t[a];if(null!=x&&("uniqueId"!==a||n.AllowLoadingUniqueId))switch(W){case 0:K[N]=x;break;case 1:case 3:case 7:case 9:K[N]=x.serialize();break;case 2:case 4:case 5:case 8:case 10:case 12:K[N]=x.asArray();break;case 6:case 11:K[N]=x.id}}return K}static ParseProperties(t,K,D,a){a||(a="");const G=x.K(K);for(const x in G){const b=G[x],e=t[b.sourceName||x],i=b.type;if(null!=e&&("uniqueId"!==x||n.AllowLoadingUniqueId)){const t=K;switch(i){case 0:t[x]=e;break;case 1:D&&(t[x]=n._TextureParser(e,D,a));break;case 2:t[x]=N.v9.FromArray(e);break;case 3:t[x]=n._FresnelParametersParser(e);break;case 4:t[x]=W.I9.FromArray(e);break;case 5:t[x]=W.Pq.FromArray(e);break;case 6:D&&(t[x]=D.getLastMeshById(e));break;case 7:t[x]=n._ColorCurvesParser(e);break;case 8:t[x]=N.ov.FromArray(e);break;case 9:t[x]=n._ImageProcessingConfigurationParser(e);break;case 10:t[x]=W.PT.FromArray(e);break;case 11:D&&(t[x]=D.getCameraById(e));break;case 12:t[x]=W.uq.FromArray(e)}}}}static Parse(t,K,D,a=null){const N=t();return G.Y&&G.Y.AddTagsTo(N,K.tags),n.ParseProperties(K,N,D,a),N}static Clone(t,K,D={}){return b(t,K,!1,D)}static Instanciate(t,K){return b(t,K,!0)}}n.AllowLoadingUniqueId=!1,n._ImageProcessingConfigurationParser=t=>{throw a.n("ImageProcessingConfiguration")},n._FresnelParametersParser=t=>{throw a.n("FresnelParameters")},n._ColorCurvesParser=t=>{throw a.n("ColorCurves")},n._TextureParser=(t,K,D)=>{throw a.n("Texture")}},607552:(t,K,D)=>{D.d(K,{r:()=>N});var a=D(706400);const G=(t,K,D)=>t?t.getClassName&&"Mesh"===t.getClassName()?null:!t.getClassName||"SubMesh"!==t.getClassName()&&"PhysicsBody"!==t.getClassName()?t.clone?t.clone():Array.isArray(t)?t.slice():D&&"object"==typeof t?{...t}:null:t.clone(K):null;class N{static DeepCopy(t,K,D,N,W=!1){const x=function(t){const K=[];do{Object.getOwnPropertyNames(t).forEach((function(t){-1===K.indexOf(t)&&K.push(t)}))}while(t=Object.getPrototypeOf(t));return K}(t);for(const b of x){if("_"===b[0]&&(!N||-1===N.indexOf(b)))continue;if(b.endsWith("Observable"))continue;if(D&&-1!==D.indexOf(b))continue;const x=t[b],n=typeof x;if("function"!==n)try{if("object"===n)if(x instanceof Uint8Array)K[b]=Uint8Array.from(x);else if(x instanceof Array){if(K[b]=[],x.length>0)if("object"==typeof x[0])for(let t=0;t<x.length;t++){const D=G(x[t],K,W);-1===K[b].indexOf(D)&&K[b].push(D)}else K[b]=x.slice(0)}else K[b]=G(x,K,W);else K[b]=x}catch(t){a.V.Warn(t.message)}}}}},472295:(t,K,D)=>{D.d(K,{k:()=>N});var a=D(636544),G=D(245710);class N extends G.R{get depthRenderer(){return this._depthRenderer}constructor(t){super(t)}setDepthRenderer(t=null,K=2,D=!0){const G=this._camera.getScene();this._depthRenderer&&(delete G._depthRenderer[this._depthRendererId],this._depthRenderer.dispose(),this._depthRenderer=null),null===t&&(G._depthRenderer||(G._depthRenderer={}),(t=this._depthRenderer=new a.d(G,K,this._camera,!1,1)).enabled=!1,this._depthRendererId="minmax"+this._camera.id,G._depthRenderer[this._depthRendererId]=t),super.setSourceTexture(t.getDepthMap(),!0,K,D)}setSourceTexture(t,K,D=2,a=!0){super.setSourceTexture(t,K,D,a)}activate(){this._depthRenderer&&(this._depthRenderer.enabled=!0),super.activate()}deactivate(){super.deactivate(),this._depthRenderer&&(this._depthRenderer.enabled=!1)}dispose(t=!0){if(super.dispose(t),this._depthRenderer&&t){const t=this._depthRenderer.getDepthMap().getScene();t&&delete t._depthRenderer[this._depthRendererId],this._depthRenderer.dispose(),this._depthRenderer=null}}}},554014:(t,K,D)=>{D.d(K,{n:()=>G});const a={};function G(t,K=!1){if(!K||!a[t])return a[t]=!0,`${t} needs to be imported before as it contains a side-effect required by your code.`}},394501:(t,K,D)=>{function a(){return"undefined"!=typeof window}function G(){return"undefined"!=typeof navigator}function N(){return"undefined"!=typeof document}function W(t){let K="",D=t.firstChild;for(;D;)3===D.nodeType&&(K+=D.textContent),D=D.nextSibling;return K}D.d(K,{BA:()=>a,Nf:()=>N,XD:()=>G,Zl:()=>W})},827627:(t,K,D)=>{D.d(K,{dq:()=>i,yp:()=>e});var a=D(499251),G=D(101032),N=D(898973),W=D(330153),x=D(615473),b=D(395726);let n;async function e(t,K,D,a,G="image/png",N,W){const x=await D.readPixels(0,0,t,K);z(t,K,new Uint8Array(x.buffer),a,G,N,!0,void 0,W)}function i(t,K,D,a="image/png",G,N=!1,W=!1,x){return new Promise((b=>{z(t,K,D,(t=>b(t)),a,G,N,W,x)}))}function z(t,K,D,e,i="image/png",z,I=!1,Z=!1,w){const m=function(){if(!n){let t,K=null;const D={preserveDrawingBuffer:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};try{t=new OffscreenCanvas(100,100),K=new a.w(t,!1,D)}catch(G){t=document.createElement("canvas"),K=new a.w(t,!1,D)}b.q.Instances.pop(),b.q.OnEnginesDisposedObservable.add((t=>{K&&t!==K&&!K.isDisposed&&0===b.q.Instances.length&&(n&&(n.wrapper.dispose(),n.renderer.dispose(),n.engine.dispose()),n=null)})),K.getCaps().parallelShaderCompile=void 0;const N=new G.J(K),x=new G.$({engine:K,name:W.passPixelShader.name,fragmentShader:W.passPixelShader.shader,samplerNames:["textureSampler"]});n={canvas:t,engine:K,renderer:N,wrapper:x}}return n}();if(m.engine.setSize(t,K,!0),D instanceof Float32Array){const t=new Uint8Array(D.length);let K=D.length;for(;K--;){const a=D[K];t[K]=Math.round(255*x.X.Clamp(a))}D=t}const u=m.engine.createRawTexture(D,t,K,5,!1,!I,1);m.renderer.setViewport(),m.renderer.applyEffectWrapper(m.wrapper),m.wrapper.effect._bindTexture("textureSampler",u),m.renderer.draw(),Z?N.S0.ToBlob(m.canvas,(t=>{const K=new FileReader;K.onload=t=>{const K=t.target.result;e&&e(K)},K.readAsArrayBuffer(t)}),i,w):N.S0.EncodeScreenshotCanvasData(m.canvas,e,i,z,w),u.dispose()}N.S0.DumpData=z,N.S0.DumpDataAsync=i,N.S0.DumpFramebuffer=e},879808:(t,K,D)=>{D.d(K,{Cf:()=>a,bu:()=>N,tG:()=>G});class a extends Error{}a._setPrototypeOf=Object.setPrototypeOf||((t,K)=>(t.__proto__=K,t));const G={MeshInvalidPositionsError:0,UnsupportedTextureError:1e3,GLTFLoaderUnexpectedMagicError:2e3,SceneLoaderError:3e3,LoadFileError:4e3,RequestFileError:4001,ReadFileError:4002};class N extends a{constructor(t,K,D){super(t),this.errorCode=K,this.innerError=D,this.name="RuntimeError",a._setPrototypeOf(this,N.prototype)}}},435683:(t,K,D)=>{D.d(K,{M1:()=>Q,NJ:()=>q,W$:()=>y,eC:()=>l,f2:()=>T,rz:()=>C,sh:()=>h,zU:()=>X});var a=D(732259),G=D(394501),N=D(638113),W=D(705124),x=D(546793),b=D(879808),n=D(711210),e=D(867967),i=D(395726),z=D(706400),I=D(602187),Z=D(45410),w=D(33321);const m=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i);class u extends b.bu{constructor(t,K){super(t,b.tG.LoadFileError),this.name="LoadFileError",b.Cf._setPrototypeOf(this,u.prototype),K instanceof a.u?this.request=K:this.file=K}}class d extends b.bu{constructor(t,K){super(t,b.tG.RequestFileError),this.request=K,this.name="RequestFileError",b.Cf._setPrototypeOf(this,d.prototype)}}class E extends b.bu{constructor(t,K){super(t,b.tG.ReadFileError),this.file=K,this.name="ReadFileError",b.Cf._setPrototypeOf(this,E.prototype)}}const l={DefaultRetryStrategy:x.a.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:t=>t,ScriptBaseUrl:"",ScriptPreprocessUrl:t=>t,CleanUrl:t=>t.replace(/#/gm,"%23")},Q=(t,K)=>{if((!t||0!==t.indexOf("data:"))&&l.CorsBehavior)if("string"==typeof l.CorsBehavior||l.CorsBehavior instanceof String)K.crossOrigin=l.CorsBehavior;else{const D=l.CorsBehavior(t);D&&(K.crossOrigin=D)}},P={getRequiredSize:null},y=(t,K,D,G,N="",x)=>{const b=i.q.LastCreatedEngine;if("undefined"==typeof HTMLImageElement&&!(null==b?void 0:b._features.forceBitmapOverHTMLImageElement))return D("LoadImage is only supported in web or BabylonNative environments."),null;let e,z=!1;t instanceof ArrayBuffer||ArrayBuffer.isView(t)?"undefined"!=typeof Blob&&"undefined"!=typeof URL?(e=URL.createObjectURL(new Blob([t],{type:N})),z=!0):e=`data:${N};base64,`+n.EL(t):t instanceof Blob?(e=URL.createObjectURL(t),z=!0):(e=l.CleanUrl(t),e=l.PreprocessUrl(e));const I=K=>{if(D){const a=e||t.toString();D(`Error while trying to load image: ${0===a.indexOf("http")||a.length<=128?a:a.slice(0,128)+"..."}`,K)}};if(null==b?void 0:b._features.forceBitmapOverHTMLImageElement)return X(e,(a=>{b.createImageBitmap(new Blob([a],{type:N}),{premultiplyAlpha:"none",...x}).then((t=>{K(t),z&&URL.revokeObjectURL(e)})).catch((K=>{D&&D("Error while trying to load image: "+t,K)}))}),void 0,G||void 0,!0,((t,K)=>{I(K)})),null;const Z=new Image;if(P.getRequiredSize){const K=P.getRequiredSize(t);K.width&&(Z.width=K.width),K.height&&(Z.height=K.height)}Q(e,Z);const w=[],m=()=>{w.forEach((t=>{t.target.removeEventListener(t.name,t.handler)})),w.length=0};w.push({target:Z,name:"load",handler:()=>{m(),K(Z),z&&Z.src&&URL.revokeObjectURL(Z.src)}}),w.push({target:Z,name:"error",handler:t=>{m(),I(t),z&&Z.src&&URL.revokeObjectURL(Z.src)}}),w.push({target:document,name:"securitypolicyviolation",handler:t=>{if(t.blockedURI!==Z.src||"report"===t.disposition)return;m();const K=new Error(`CSP violation of policy ${t.effectiveDirective} ${t.blockedURI}. Current policy is ${t.originalPolicy}`);i.q.UseFallbackTexture=!1,I(K),z&&Z.src&&URL.revokeObjectURL(Z.src),Z.src=""}}),w.forEach((t=>{t.target.addEventListener(t.name,t.handler)}));const u="blob:"===e.substring(0,5),d="data:"===e.substring(0,5),E=()=>{u||d||!a.u.IsCustomRequestAvailable?Z.src=e:X(e,((t,K,D)=>{const a=new Blob([t],{type:!N&&D?D:N}),G=URL.createObjectURL(a);z=!0,Z.src=G}),void 0,G||void 0,!0,((t,K)=>{I(K)}))};if(!u&&!d&&G&&G.enableTexturesOffline)G.open((()=>{G&&G.loadImage(e,Z)}),E);else{if(-1!==e.indexOf("file:")){const t=decodeURIComponent(e.substring(5).toLowerCase());if(W.T.FilesToLoad[t]&&"undefined"!=typeof URL){try{let K;try{K=URL.createObjectURL(W.T.FilesToLoad[t])}catch(D){K=URL.createObjectURL(W.T.FilesToLoad[t])}Z.src=K,z=!0}catch(t){Z.src=""}return Z}}E()}return Z},q=(t,K,D,a,G)=>{const W=new FileReader,x={onCompleteObservable:new N.cP,abort:()=>W.abort()};return W.onloadend=()=>x.onCompleteObservable.notifyObservers(x),G&&(W.onerror=()=>{G(new E(`Unable to read ${t.name}`,t))}),W.onload=t=>{K(t.target["result"])},D&&(W.onprogress=D),a?W.readAsArrayBuffer(t):W.readAsText(t),x},X=(t,K,D,a,G,x,b)=>{if(t.name)return q(t,K,D,G,x?t=>{x(void 0,t)}:void 0);const n=t;if(-1!==n.indexOf("file:")){let t=decodeURIComponent(n.substring(5).toLowerCase());0===t.indexOf("./")&&(t=t.substring(2));const a=W.T.FilesToLoad[t];if(a)return q(a,K,D,G,x?t=>x(void 0,new u(t.message,t.file)):void 0)}const{match:e,type:i}=_(n);if(e){const t={onCompleteObservable:new N.cP,abort:()=>()=>{}};try{const t=G?C(n):H(n);K(t,void 0,i)}catch(t){x?x(void 0,t):z.V.Error(t.message||"Failed to parse the Data URL")}return I._.SetImmediate((()=>{t.onCompleteObservable.notifyObservers(t)})),t}return h(n,((t,D)=>{K(t,null==D?void 0:D.responseURL,null==D?void 0:D.getResponseHeader("content-type"))}),D,a,G,x?t=>{x(t.request,new u(t.message,t.request))}:void 0,b)},h=(t,K,D,W,x,b,n)=>{t=l.CleanUrl(t),t=l.PreprocessUrl(t);const e=l.BaseUrl+t;let i=!1;const I={onCompleteObservable:new N.cP,abort:()=>i=!0},Z=()=>{let t,N=new a.u,W=null;const Z=()=>{N&&(D&&N.removeEventListener("progress",D),t&&N.removeEventListener("readystatechange",t),N.removeEventListener("loadend",w))};let w=()=>{Z(),I.onCompleteObservable.notifyObservers(I),I.onCompleteObservable.clear(),D=void 0,t=null,w=null,b=void 0,n=void 0,K=void 0};I.abort=()=>{i=!0,w&&w(),N&&N.readyState!==(XMLHttpRequest.DONE||4)&&N.abort(),null!==W&&(clearTimeout(W),W=null),N=null};const m=t=>{const K=t.message||"Unknown error";b&&N?b(new d(K,N)):z.V.Error(K)},u=z=>{if(N){if(N.open("GET",e),n)try{n(N)}catch(t){return void m(t)}x&&(N.responseType="arraybuffer"),D&&N.addEventListener("progress",D),w&&N.addEventListener("loadend",w),t=()=>{if(!i&&N&&N.readyState===(XMLHttpRequest.DONE||4)){if(t&&N.removeEventListener("readystatechange",t),N.status>=200&&N.status<300||0===N.status&&(!G.BA()||J())){try{K&&K(x?N.response:N.responseText,N)}catch(t){m(t)}return}const D=l.DefaultRetryStrategy;if(D){const t=D(e,N,z);if(-1!==t)return Z(),N=new a.u,void(W=setTimeout((()=>u(z+1)),t))}const n=new d("Error status: "+N.status+" "+N.statusText+" - Unable to load "+e,N);b&&b(n)}},N.addEventListener("readystatechange",t),N.send()}};u(0)};if(W&&W.enableSceneOffline){const a=t=>{t&&t.status>400?b&&b(t):Z()},G=()=>{W&&W.loadFile(l.BaseUrl+t,(t=>{!i&&K&&K(t),I.onCompleteObservable.notifyObservers(I)}),D?t=>{!i&&D&&D(t)}:void 0,a,x)};W.open(G,a)}else Z();return I},J=()=>"undefined"!=typeof location&&"file:"===location.protocol,T=t=>m.test(t),_=t=>{const K=m.exec(t);return null===K||0===K.length?{match:!1,type:""}:{match:!0,type:K[0].replace("data:","").replace("base64,","")}};function C(t){return n.yS(t.split(",")[1])}const H=t=>n.AV(t.split(",")[1]);let o;w.$._FileToolsLoadImage=y,Z.sg.loadFile=X,e.J.loadFile=X,((t,K,D,a,G,N,W,x,b,n)=>{o={DecodeBase64UrlToBinary:t,DecodeBase64UrlToString:K,DefaultRetryStrategy:D.DefaultRetryStrategy,BaseUrl:D.BaseUrl,CorsBehavior:D.CorsBehavior,PreprocessUrl:D.PreprocessUrl,IsBase64DataUrl:a,IsFileURL:G,LoadFile:N,LoadImage:W,ReadFile:x,RequestFile:b,SetCorsBehavior:n},Object.defineProperty(o,"DefaultRetryStrategy",{get:function(){return D.DefaultRetryStrategy},set:function(t){D.DefaultRetryStrategy=t}}),Object.defineProperty(o,"BaseUrl",{get:function(){return D.BaseUrl},set:function(t){D.BaseUrl=t}}),Object.defineProperty(o,"PreprocessUrl",{get:function(){return D.PreprocessUrl},set:function(t){D.PreprocessUrl=t}}),Object.defineProperty(o,"CorsBehavior",{get:function(){return D.CorsBehavior},set:function(t){D.CorsBehavior=t}})})(C,H,l,T,J,X,y,q,h,Q)},705124:(t,K,D)=>{D.d(K,{T:()=>a});class a{}a.FilesToLoad={}},977041:(t,K,D)=>{function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const K=16*Math.random()|0;return("x"===t?K:3&K|8).toString(16)}))}D.d(K,{z:()=>a})},862e3:(t,K,D)=>{D.d(K,{n:()=>N});var a=D(706400),G=D(310035);class N{static Instantiate(t){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[t])return this.RegisteredExternalClasses[t];const K=G.n9(t);if(K)return K;a.V.Warn(t+" not found, you may have missed an import.");const D=t.split(".");let N=window||this;for(let t=0,K=D.length;t<K;t++)N=N[D[t]];return"function"!=typeof N?null:N}}N.RegisteredExternalClasses={}},706400:(t,K,D)=>{D.d(K,{V:()=>a});class a{static _CheckLimit(t,K){let D=a._LogLimitOutputs[t];return D?D.current++:(D={limit:K,current:1},a._LogLimitOutputs[t]=D),D.current<=D.limit}static _GenerateLimitMessage(t,K=1){var D;const G=a._LogLimitOutputs[t];if(!G||!a.MessageLimitReached)return;const N=this._Levels[K];G.current===G.limit&&a[N.name](a.MessageLimitReached.replace(/%LIMIT%/g,""+G.limit).replace(/%TYPE%/g,null!==(D=N.name)&&void 0!==D?D:""))}static _AddLogEntry(t){a._LogCache=t+a._LogCache,a.OnNewCacheEntry&&a.OnNewCacheEntry(t)}static _FormatMessage(t){const K=t=>t<10?"0"+t:""+t,D=new Date;return"["+K(D.getHours())+":"+K(D.getMinutes())+":"+K(D.getSeconds())+"]: "+t}static _LogDisabled(t,K){}static _LogEnabled(t=1,K,D){const G=Array.isArray(K)?K[0]:K;if(void 0!==D&&!a._CheckLimit(G,D))return;const N=a._FormatMessage(G),W=this._Levels[t],x=Array.isArray(K)?K.slice(1):[];W.logFunc&&W.logFunc("BJS - "+N,...x);const b=`<div style='color:${W.color}'>${N}</div><br>`;a._AddLogEntry(b),a._GenerateLimitMessage(G,t)}static get LogCache(){return a._LogCache}static ClearLogCache(){a._LogCache="",a._LogLimitOutputs={},a.errorsCount=0}static set LogLevels(t){a.Log=a._LogDisabled,a.Warn=a._LogDisabled,a.Error=a._LogDisabled,[a.MessageLogLevel,a.WarningLogLevel,a.ErrorLogLevel].forEach((K=>{if((t&K)===K){const t=this._Levels[K];a[t.name]=a._LogEnabled.bind(a,K)}}))}}a.NoneLogLevel=0,a.MessageLogLevel=1,a.WarningLogLevel=2,a.ErrorLogLevel=4,a.AllLogLevel=7,a.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",a._LogCache="",a._LogLimitOutputs={},a._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],a.errorsCount=0,a.Log=a._LogEnabled.bind(a,a.MessageLogLevel),a.Warn=a._LogEnabled.bind(a,a.WarningLogLevel),a.Error=a._LogEnabled.bind(a,a.ErrorLogLevel)},245710:(t,K,D)=>{D.d(K,{R:()=>x});var a=D(638113),G=D(850034),N=D(848287);D(269673);const W=`varying vec2 vUV;uniform sampler2D textureSampler;\n#if defined(INITIAL)\nuniform sampler2D sourceTexture;uniform vec2 texSize;void main(void)\n{ivec2 coord=ivec2(vUV*(texSize-1.0));float f1=texelFetch(sourceTexture,coord,0).r;float f2=texelFetch(sourceTexture,coord+ivec2(1,0),0).r;float f3=texelFetch(sourceTexture,coord+ivec2(1,1),0).r;float f4=texelFetch(sourceTexture,coord+ivec2(0,1),0).r;float minz=min(min(min(f1,f2),f3),f4);\n#ifdef DEPTH_REDUX\nfloat maxz=max(max(max(sign(1.0-f1)*f1,sign(1.0-f2)*f2),sign(1.0-f3)*f3),sign(1.0-f4)*f4);\n#else\nfloat maxz=max(max(max(f1,f2),f3),f4);\n#endif\nglFragColor=vec4(minz,maxz,0.,0.);}\n#elif defined(MAIN)\nuniform vec2 texSize;void main(void)\n{ivec2 coord=ivec2(vUV*(texSize-1.0));vec2 f1=texelFetch(textureSampler,coord,0).rg;vec2 f2=texelFetch(textureSampler,coord+ivec2(1,0),0).rg;vec2 f3=texelFetch(textureSampler,coord+ivec2(1,1),0).rg;vec2 f4=texelFetch(textureSampler,coord+ivec2(0,1),0).rg;float minz=min(min(min(f1.x,f2.x),f3.x),f4.x);float maxz=max(max(max(f1.y,f2.y),f3.y),f4.y);glFragColor=vec4(minz,maxz,0.,0.);}\n#elif defined(ONEBEFORELAST)\nuniform ivec2 texSize;void main(void)\n{ivec2 coord=ivec2(vUV*vec2(texSize-1));vec2 f1=texelFetch(textureSampler,coord % texSize,0).rg;vec2 f2=texelFetch(textureSampler,(coord+ivec2(1,0)) % texSize,0).rg;vec2 f3=texelFetch(textureSampler,(coord+ivec2(1,1)) % texSize,0).rg;vec2 f4=texelFetch(textureSampler,(coord+ivec2(0,1)) % texSize,0).rg;float minz=min(f1.x,f2.x);float maxz=max(f1.y,f2.y);glFragColor=vec4(minz,maxz,0.,0.);}\n#elif defined(LAST)\nvoid main(void)\n{glFragColor=vec4(0.);if (true) { \ndiscard;}}\n#endif\n`;D(395879).l.ShadersStore["minmaxReduxPixelShader"]=W;class x{constructor(t){this.onAfterReductionPerformed=new a.cP,this._forceFullscreenViewport=!0,this._activated=!1,this._camera=t,this._postProcessManager=new N.X(t.getScene()),this._onContextRestoredObserver=t.getEngine().onContextRestoredObservable.add((()=>{this._postProcessManager._rebuild()}))}get sourceTexture(){return this._sourceTexture}setSourceTexture(t,K,D=2,a=!0){if(t===this._sourceTexture)return;this.dispose(!1),this._sourceTexture=t,this._reductionSteps=[],this._forceFullscreenViewport=a;const N=this._camera.getScene(),W=new G.w("Initial reduction phase","minmaxRedux",["texSize"],["sourceTexture"],1,null,1,N.getEngine(),!1,"#define INITIAL"+(K?"\n#define DEPTH_REDUX":""),D,void 0,void 0,void 0,7);W.autoClear=!1,W.forceFullscreenViewport=a;let x=this._sourceTexture.getRenderWidth(),b=this._sourceTexture.getRenderHeight();W.onApply=((t,K)=>D=>{D.setTexture("sourceTexture",this._sourceTexture),D.setFloat2("texSize",t,K)})(x,b),this._reductionSteps.push(W);let n=1;for(;x>1||b>1;){x=Math.max(Math.round(x/2),1),b=Math.max(Math.round(b/2),1);const t=new G.w("Reduction phase "+n,"minmaxRedux",["texSize"],null,{width:x,height:b},null,1,N.getEngine(),!1,"#define "+(1==x&&1==b?"LAST":1==x||1==b?"ONEBEFORELAST":"MAIN"),D,void 0,void 0,void 0,7);if(t.autoClear=!1,t.forceFullscreenViewport=a,t.onApply=((t,K)=>D=>{1==t||1==K?D.setInt2("texSize",t,K):D.setFloat2("texSize",t,K)})(x,b),this._reductionSteps.push(t),n++,1==x&&1==b){const K=(t,K,D)=>{const a=new Float32Array(4*t*K),G={min:0,max:0};return()=>{N.getEngine()._readTexturePixels(D.inputTexture.texture,t,K,-1,0,a,!1),G.min=a[0],G.max=a[1],this.onAfterReductionPerformed.notifyObservers(G)}};t.onAfterRenderObservable.add(K(x,b,t))}}}get refreshRate(){return this._sourceTexture?this._sourceTexture.refreshRate:-1}set refreshRate(t){this._sourceTexture&&(this._sourceTexture.refreshRate=t)}get activated(){return this._activated}activate(){!this._onAfterUnbindObserver&&this._sourceTexture&&(this._onAfterUnbindObserver=this._sourceTexture.onAfterUnbindObservable.add((()=>{var t,K;const D=this._camera.getScene().getEngine();null===(t=D._debugPushGroup)||void 0===t||t.call(D,`min max reduction`,1),this._reductionSteps[0].activate(this._camera),this._postProcessManager.directRender(this._reductionSteps,this._reductionSteps[0].inputTexture,this._forceFullscreenViewport),D.unBindFramebuffer(this._reductionSteps[0].inputTexture,!1),null===(K=D._debugPopGroup)||void 0===K||K.call(D,1)})),this._activated=!0)}deactivate(){this._onAfterUnbindObserver&&this._sourceTexture&&(this._sourceTexture.onAfterUnbindObservable.remove(this._onAfterUnbindObserver),this._onAfterUnbindObserver=null,this._activated=!1)}dispose(t=!0){if(t&&(this.onAfterReductionPerformed.clear(),this._onContextRestoredObserver&&(this._camera.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null)),this.deactivate(),this._reductionSteps){for(let t=0;t<this._reductionSteps.length;++t)this._reductionSteps[t].dispose();this._reductionSteps=null}this._postProcessManager&&t&&this._postProcessManager.dispose(),this._sourceTexture=null}}},638113:(t,K,D)=>{D.d(K,{cP:()=>N});class a{constructor(t,K=!1,D,a){this.initialize(t,K,D,a)}initialize(t,K=!1,D,a){return this.mask=t,this.skipNextObservers=K,this.target=D,this.currentTarget=a,this}}class G{constructor(t,K,D=null){this.callback=t,this.mask=K,this.scope=D,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){this._remove&&this._remove()}}class N{static FromPromise(t,K){const D=new N;return t.then((t=>{D.notifyObservers(t)})).catch((t=>{if(!K)throw t;K.notifyObservers(t)})),D}get observers(){return this._observers}constructor(t,K=!1){this.notifyIfTriggered=K,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new a(0),t&&(this._onObserverAdded=t)}add(t,K=-1,D=!1,a=null,N=!1){if(!t)return null;const W=new G(t,K,a);return W.unregisterOnNextCall=N,D?this._observers.unshift(W):this._observers.push(W),this._onObserverAdded&&this._onObserverAdded(W),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(W,this._lastNotifiedValue),W._remove=()=>{this.remove(W)},W}addOnce(t){return this.add(t,void 0,void 0,void 0,!0)}remove(t){return!!t&&(t._remove=null,-1!==this._observers.indexOf(t)&&(this._deferUnregister(t),!0))}removeCallback(t,K){for(let D=0;D<this._observers.length;D++){const a=this._observers[D];if(!(a._willBeUnregistered||a.callback!==t||K&&K!==a.scope))return this._deferUnregister(a),!0}return!1}_deferUnregister(t){t._willBeUnregistered||(this._numObserversMarkedAsDeleted++,t.unregisterOnNextCall=!1,t._willBeUnregistered=!0,setTimeout((()=>{this._remove(t)}),0))}_remove(t,K=!0){if(!t)return!1;const D=this._observers.indexOf(t);return-1!==D&&(K&&this._numObserversMarkedAsDeleted--,this._observers.splice(D,1),!0)}makeObserverTopPriority(t){this._remove(t,!1),this._observers.unshift(t)}makeObserverBottomPriority(t){this._remove(t,!1),this._observers.push(t)}notifyObservers(t,K=-1,D,a,G){if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=t),!this._observers.length)return!0;const N=this._eventState;N.mask=K,N.target=D,N.currentTarget=a,N.skipNextObservers=!1,N.lastReturnValue=t,N.userInfo=G;for(const D of this._observers)if(!D._willBeUnregistered&&(D.mask&K&&(D.unregisterOnNextCall&&this._deferUnregister(D),D.scope?N.lastReturnValue=D.callback.apply(D.scope,[t,N]):N.lastReturnValue=D.callback(t,N)),N.skipNextObservers))return!1;return!0}notifyObserver(t,K,D=-1){if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=K),t._willBeUnregistered)return;const a=this._eventState;a.mask=D,a.skipNextObservers=!1,t.unregisterOnNextCall&&this._deferUnregister(t),t.callback(K,a)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const t=this._observers.pop();t&&(t._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const t=new N;return t._observers=this._observers.slice(0),t}hasSpecificMask(t=-1){for(const K of this._observers)if(K.mask&t||K.mask===t)return!0;return!1}}},850327:(t,K,D)=>{D.d(K,{A:()=>G});var a=D(488354);class G{get min(){return this._min}get max(){return this._max}get average(){return this._average}get lastSecAverage(){return this._lastSecAverage}get current(){return this._current}get total(){return this._totalAccumulated}get count(){return this._totalValueCount}constructor(){this._startMonitoringTime=0,this._min=0,this._max=0,this._average=0,this._lastSecAverage=0,this._current=0,this._totalValueCount=0,this._totalAccumulated=0,this._lastSecAccumulated=0,this._lastSecTime=0,this._lastSecValueCount=0}fetchNewFrame(){this._totalValueCount++,this._current=0,this._lastSecValueCount++}addCount(t,K){G.Enabled&&(this._current+=t,K&&this._fetchResult())}beginMonitoring(){G.Enabled&&(this._startMonitoringTime=a.j.Now)}endMonitoring(t=!0){if(!G.Enabled)return;t&&this.fetchNewFrame();const K=a.j.Now;this._current=K-this._startMonitoringTime,t&&this._fetchResult()}endFrame(){this._fetchResult()}_fetchResult(){this._totalAccumulated+=this._current,this._lastSecAccumulated+=this._current,this._min=Math.min(this._min,this._current),this._max=Math.max(this._max,this._current),this._average=this._totalAccumulated/this._totalValueCount;const t=a.j.Now;t-this._lastSecTime>1e3&&(this._lastSecAverage=this._lastSecAccumulated/this._lastSecValueCount,this._lastSecTime=t,this._lastSecAccumulated=0,this._lastSecValueCount=0)}}G.Enabled=!0},636828:(t,K,D)=>{D.d(K,{r:()=>G});var a=D(488354);class G{constructor(t=30){this._enabled=!0,this._rollingFrameTime=new N(t)}sampleFrame(t=a.j.Now){if(this._enabled){if(null!=this._lastFrameTimeMs){const K=t-this._lastFrameTimeMs;this._rollingFrameTime.add(K)}this._lastFrameTimeMs=t}}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){const t=this._rollingFrameTime.history(0);return 0===t?0:1e3/t}get isSaturated(){return this._rollingFrameTime.isSaturated()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}get isEnabled(){return this._enabled}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}}class N{constructor(t){this._samples=new Array(t),this.reset()}add(t){let K;if(this.isSaturated()){const t=this._samples[this._pos];K=t-this.average,this.average-=K/(this._sampleCount-1),this._m2-=K*(t-this.average)}else this._sampleCount++;K=t-this.average,this.average+=K/this._sampleCount,this._m2+=K*(t-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=t,this._pos++,this._pos%=this._samples.length}history(t){if(t>=this._sampleCount||t>=this._samples.length)return 0;const K=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(K-t)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(t){const K=this._samples.length;return(t%K+K)%K}}},488354:(t,K,D)=>{D.d(K,{j:()=>G});var a=D(394501);class G{static get Now(){return a.BA()&&window.performance&&window.performance.now?window.performance.now():Date.now()}}},546793:(t,K,D)=>{D.d(K,{a:()=>a});class a{static ExponentialBackoff(t=3,K=500){return(D,a,G)=>0!==a.status||G>=t||-1!==D.indexOf("file:")?-1:Math.pow(2,G)*K}}},374603:(t,K,D)=>{D.d(K,{G:()=>N});var a=D(850034),G=(D(68561),D(484573));class N{static ExpandRGBDTexture(t){const K=t._texture;if(!K||!t.isRGBD)return;const G=K.getEngine(),N=G.getCaps(),W=K.isReady;let x=!1;N.textureHalfFloatRender&&N.textureHalfFloatLinearFiltering?(x=!0,K.type=2):N.textureFloatRender&&N.textureFloatLinearFiltering&&(x=!0,K.type=1),x&&(K.isReady=!1,K._isRGBD=!1,K.invertY=!1);const b=async()=>{const N=G.isWebGPU,W=N?1:0;K.isReady=!1,this._ShaderImported||(this._ShaderImported=!0,N?await Promise.all([D.e(57758).then(D.bind(D,857758)),D.e(18674).then(D.bind(D,918674))]):await Promise.all([D.e(70775).then(D.bind(D,270775)),D.e(57151).then(D.bind(D,757151))]));const x=new a.w("rgbdDecode","rgbdDecode",null,null,1,null,3,G,!1,void 0,K.type,void 0,null,!1,void 0,W);x.externalTextureSamplerBinding=!0;const b=G.createRenderTargetTexture(K.width,{generateDepthBuffer:!1,generateMipMaps:!1,generateStencilBuffer:!1,samplingMode:K.samplingMode,type:K.type,format:5});x.onEffectCreatedObservable.addOnce((D=>{D.executeWhenCompiled((()=>{x.onApply=t=>{t._bindTexture("textureSampler",K),t.setFloat2("scale",1,1)},t.getScene().postProcessManager.directRender([x],b,!0),G.restoreDefaultFramebuffer(),G._releaseTexture(K),x&&x.dispose(),b._swapAndDie(K),K.isReady=!0}))}))};x&&(W?b():t.onLoadObservable.addOnce(b))}static EncodeTextureToRGBD(t,K,D=0){return G.Qs("rgbdEncode",t,K,D,1,5)}}N._ShaderImported=!1},293506:(t,K,D)=>{D.d(K,{L:()=>a,b:()=>G});class a{constructor(t){this.length=0,this.data=new Array(t),this._id=a._GlobalId++}push(t){this.data[this.length++]=t,this.length>this.data.length&&(this.data.length*=2)}forEach(t){for(let K=0;K<this.length;K++)t(this.data[K])}sort(t){this.data.sort(t)}reset(){this.length=0}dispose(){this.reset(),this.data&&(this.data.length=0)}concat(t){if(0!==t.length){this.length+t.length>this.data.length&&(this.data.length=2*(this.length+t.length));for(let K=0;K<t.length;K++)this.data[this.length++]=(t.data||t)[K]}}indexOf(t){const K=this.data.indexOf(t);return K>=this.length?-1:K}contains(t){return-1!==this.indexOf(t)}}a._GlobalId=0;class G extends a{constructor(){super(...arguments),this._duplicateId=0}push(t){super.push(t),t.__smartArrayFlags||(t.__smartArrayFlags={}),t.__smartArrayFlags[this._id]=this._duplicateId}pushNoDuplicate(t){return!(t.__smartArrayFlags&&t.__smartArrayFlags[this._id]===this._duplicateId||(this.push(t),0))}reset(){super.reset(),this._duplicateId++}concatWithNoDuplicate(t){if(0!==t.length){this.length+t.length>this.data.length&&(this.data.length=2*(this.length+t.length));for(let K=0;K<t.length;K++){const D=(t.data||t)[K];this.pushNoDuplicate(D)}}}}},867741:(t,K,D)=>{D.d(K,{w:()=>a});class a{constructor(){this._count=0,this._data={}}copyFrom(t){this.clear(),t.forEach(((t,K)=>this.add(t,K)))}get(t){const K=this._data[t];if(void 0!==K)return K}getOrAddWithFactory(t,K){let D=this.get(t);return void 0!==D||(D=K(t),D&&this.add(t,D)),D}getOrAdd(t,K){const D=this.get(t);return void 0!==D?D:(this.add(t,K),K)}contains(t){return void 0!==this._data[t]}add(t,K){return void 0===this._data[t]&&(this._data[t]=K,++this._count,!0)}set(t,K){return void 0!==this._data[t]&&(this._data[t]=K,!0)}getAndRemove(t){const K=this.get(t);return void 0!==K?(delete this._data[t],--this._count,K):null}remove(t){return!!this.contains(t)&&(delete this._data[t],--this._count,!0)}clear(){this._data={},this._count=0}get count(){return this._count}forEach(t){for(const K in this._data)t(K,this._data[K])}first(t){for(const K in this._data){const D=t(K,this._data[K]);if(D)return D}return null}}},711210:(t,K,D)=>{D.d(K,{AV:()=>G,EL:()=>a,yS:()=>N});const a=t=>{const K="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let D,a,G,N,W,x,b,n="",e=0;const i=ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t);for(;e<i.length;)D=i[e++],a=e<i.length?i[e++]:Number.NaN,G=e<i.length?i[e++]:Number.NaN,N=D>>2,W=(3&D)<<4|a>>4,x=(15&a)<<2|G>>6,b=63&G,isNaN(a)?x=b=64:isNaN(G)&&(b=64),n+=K.charAt(N)+K.charAt(W)+K.charAt(x)+K.charAt(b);return n},G=t=>atob(t),N=t=>{const K=G(t),D=K.length,a=new Uint8Array(new ArrayBuffer(D));for(let t=0;t<D;t++)a[t]=K.charCodeAt(t);return a.buffer}},443401:(t,K,D)=>{D.d(K,{Y:()=>G});var a=D(161892);class G{static EnableFor(t){t._tags=t._tags||{},t.hasTags=()=>G.HasTags(t),t.addTags=K=>G.AddTagsTo(t,K),t.removeTags=K=>G.RemoveTagsFrom(t,K),t.matchesTagsQuery=K=>G.MatchesQuery(t,K)}static DisableFor(t){delete t._tags,delete t.hasTags,delete t.addTags,delete t.removeTags,delete t.matchesTagsQuery}static HasTags(t){if(!t._tags)return!1;const K=t._tags;for(const t in K)if(Object.prototype.hasOwnProperty.call(K,t))return!0;return!1}static GetTags(t,K=!0){if(!t._tags)return null;if(K){const K=[];for(const D in t._tags)Object.prototype.hasOwnProperty.call(t._tags,D)&&!0===t._tags[D]&&K.push(D);return K.join(" ")}return t._tags}static AddTagsTo(t,K){K&&"string"==typeof K&&K.split(" ").forEach((function(K){G._AddTagTo(t,K)}))}static _AddTagTo(t,K){""!==(K=K.trim())&&"true"!==K&&"false"!==K&&(K.match(/[\s]/)||K.match(/^([!]|([|]|[&]){2})/)||(G.EnableFor(t),t._tags[K]=!0))}static RemoveTagsFrom(t,K){if(!G.HasTags(t))return;const D=K.split(" ");for(const K in D)G._RemoveTagFrom(t,D[K])}static _RemoveTagFrom(t,K){delete t._tags[K]}static MatchesQuery(t,K){return void 0===K||(""===K?G.HasTags(t):a.Z.Eval(K,(K=>G.HasTags(t)&&t._tags[K])))}}},484573:(t,K,D)=>{D.d(K,{Qs:()=>x,SX:()=>i,LZ:()=>e}),D(432050),D(888413),D(882621);var a=D(850034),G=D(395879);const N=`#extension GL_EXT_shader_texture_lod : enable\nprecision highp float;const float GammaEncodePowerApprox=1.0/2.2;varying vec2 vUV;uniform sampler2D textureSampler;uniform float lod;uniform vec2 texSize;uniform bool gamma;void main(void)\n{gl_FragColor=textureLod(textureSampler,vUV,lod);if (!gamma) {gl_FragColor.rgb=pow(gl_FragColor.rgb,vec3(GammaEncodePowerApprox));}}\n`;G.l.ShadersStore["lodPixelShader"]=N;const W=`precision highp float;const float GammaEncodePowerApprox=1.0/2.2;varying vec2 vUV;uniform samplerCube textureSampler;uniform float lod;uniform bool gamma;void main(void)\n{vec2 uv=vUV*2.0-1.0;\n#ifdef POSITIVEX\ngl_FragColor=textureCube(textureSampler,vec3(1.001,uv.y,uv.x),lod);\n#endif\n#ifdef NEGATIVEX\ngl_FragColor=textureCube(textureSampler,vec3(-1.001,uv.y,uv.x),lod);\n#endif\n#ifdef POSITIVEY\ngl_FragColor=textureCube(textureSampler,vec3(uv.y,1.001,uv.x),lod);\n#endif\n#ifdef NEGATIVEY\ngl_FragColor=textureCube(textureSampler,vec3(uv.y,-1.001,uv.x),lod);\n#endif\n#ifdef POSITIVEZ\ngl_FragColor=textureCube(textureSampler,vec3(uv,1.001),lod);\n#endif\n#ifdef NEGATIVEZ\ngl_FragColor=textureCube(textureSampler,vec3(uv,-1.001),lod);\n#endif\nif (!gamma) {gl_FragColor.rgb=pow(gl_FragColor.rgb,vec3(GammaEncodePowerApprox));}}\n`;function x(t,K,D,G,N,W,x,b){const n=K.getEngine();return K.isReady=!1,N=null!=N?N:K.samplingMode,G=null!=G?G:K.type,W=null!=W?W:K.format,x=null!=x?x:K.width,b=null!=b?b:K.height,-1===G&&(G=0),new Promise((e=>{const i=new a.w("postprocess",t,null,null,1,null,N,n,!1,void 0,G,void 0,null,!1,W);i.externalTextureSamplerBinding=!0;const z=n.createRenderTargetTexture({width:x,height:b},{generateDepthBuffer:!1,generateMipMaps:!1,generateStencilBuffer:!1,samplingMode:N,type:G,format:W});i.onEffectCreatedObservable.addOnce((t=>{t.executeWhenCompiled((()=>{i.onApply=t=>{t._bindTexture("textureSampler",K),t.setFloat2("scale",1,1)},D.postProcessManager.directRender([i],z,!0),n.restoreDefaultFramebuffer(),n._releaseTexture(K),i&&i.dispose(),z._swapAndDie(K),K.type=G,K.format=5,K.isReady=!0,e(K)}))}))}))}let b,n;function e(t){b||(b=new Float32Array(1),n=new Int32Array(b.buffer)),b[0]=t;const K=n[0];let D=K>>16&32768,a=K>>12&2047;const G=K>>23&255;return G<103?D:G>142?(D|=31744,D|=(255==G?0:1)&&8388607&K,D):G<113?(a|=2048,D|=(a>>114-G)+(a>>113-G&1),D):(D|=G-112<<10|a>>1,D+=1&a,D)}function i(t){const K=(32768&t)>>15,D=(31744&t)>>10,a=1023&t;return 0===D?(K?-1:1)*Math.pow(2,-14)*(a/Math.pow(2,10)):31==D?a?NaN:(K?-1:1)*(1/0):(K?-1:1)*Math.pow(2,D-15)*(1+a/Math.pow(2,10))}G.l.ShadersStore["lodCubePixelShader"]=W},602187:(t,K,D)=>{D.d(K,{_:()=>G});var a=D(394501);class G{static SetImmediate(t){a.BA()&&window.setImmediate?window.setImmediate(t):setTimeout(t,1)}}},104270:(t,K,D)=>{function a(t){let K=1;do{K*=2}while(K<t);return K===t}function G(t,K,D){return t*(1-D)+K*D}function N(t){const K=W(t),D=x(t);return K-t>t-D?D:K}function W(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function x(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)-(t>>1)}function b(t,K,D=2){let a;switch(D){case 1:a=x(t);break;case 2:a=N(t);break;default:a=W(t)}return Math.min(a,K)}D.d(K,{C4:()=>x,L8:()=>a,OG:()=>N,R:()=>b,zF:()=>G})},898973:(t,K,D)=>{D.d(K,{LV:()=>u,S0:()=>m});var a=D(638113),G=D(394501),N=D(706400),W=D(607552),x=D(488354),b=D(554014),n=D(732259),e=D(395726),i=D(435683),z=D(602187),I=D(862e3),Z=D(977041),w=D(104270);class m{static get BaseUrl(){return i.eC.BaseUrl}static set BaseUrl(t){i.eC.BaseUrl=t}static get CleanUrl(){return i.eC.CleanUrl}static set CleanUrl(t){i.eC.CleanUrl=t}static IsAbsoluteUrl(t){return 0===t.indexOf("//")||-1!==t.indexOf("://")&&-1!==t.indexOf(".")&&-1!==t.indexOf("/")&&!(t.indexOf(":")>t.indexOf("/"))&&(t.indexOf("://")<t.indexOf(".")||0===t.indexOf("data:")||0===t.indexOf("blob:"))}static set ScriptBaseUrl(t){i.eC.ScriptBaseUrl=t}static get ScriptBaseUrl(){return i.eC.ScriptBaseUrl}static set ScriptPreprocessUrl(t){i.eC.ScriptPreprocessUrl=t}static get ScriptPreprocessUrl(){return i.eC.ScriptPreprocessUrl}static get DefaultRetryStrategy(){return i.eC.DefaultRetryStrategy}static set DefaultRetryStrategy(t){i.eC.DefaultRetryStrategy=t}static get CorsBehavior(){return i.eC.CorsBehavior}static set CorsBehavior(t){i.eC.CorsBehavior=t}static get UseFallbackTexture(){return e.q.UseFallbackTexture}static set UseFallbackTexture(t){e.q.UseFallbackTexture=t}static get RegisteredExternalClasses(){return I.n.RegisteredExternalClasses}static set RegisteredExternalClasses(t){I.n.RegisteredExternalClasses=t}static get fallbackTexture(){return e.q.FallbackTexture}static set fallbackTexture(t){e.q.FallbackTexture=t}static FetchToRef(t,K,D,a,G,N){const W=4*((Math.abs(t)*D%D|0)+(Math.abs(K)*a%a|0)*D);N.r=G[W]/255,N.g=G[W+1]/255,N.b=G[W+2]/255,N.a=G[W+3]/255}static Mix(t,K,D){return 0}static Instantiate(t){return I.n.Instantiate(t)}static SetImmediate(t){z._.SetImmediate(t)}static IsExponentOfTwo(t){return!0}static FloatRound(t){return Math.fround(t)}static GetFilename(t){const K=t.lastIndexOf("/");return K<0?t:t.substring(K+1)}static GetFolderPath(t,K=!1){const D=t.lastIndexOf("/");return D<0?K?t:"":t.substring(0,D+1)}static ToDegrees(t){return 180*t/Math.PI}static ToRadians(t){return t*Math.PI/180}static SmoothAngleChange(t,K,D=.9){const a=this.ToRadians(t),G=this.ToRadians(K);return this.ToDegrees(Math.atan2((1-D)*Math.sin(G)+D*Math.sin(a),(1-D)*Math.cos(G)+D*Math.cos(a)))}static MakeArray(t,K){return!0===K||void 0!==t&&null!=t?Array.isArray(t)?t:[t]:null}static GetPointerPrefix(t){let K="pointer";return G.BA()&&!window.PointerEvent&&(K="mouse"),!t._badDesktopOS||t._badOS||document&&"ontouchend"in document||(K="mouse"),K}static SetCorsBehavior(t,K){i.M1(t,K)}static SetReferrerPolicyBehavior(t,K){K.referrerPolicy=t}static get PreprocessUrl(){return i.eC.PreprocessUrl}static set PreprocessUrl(t){i.eC.PreprocessUrl=t}static LoadImage(t,K,D,a,G,N){return i.W$(t,K,D,a,G,N)}static LoadFile(t,K,D,a,G,N){return i.zU(t,K,D,a,G,N)}static LoadFileAsync(t,K=!0){return new Promise(((D,a)=>{i.zU(t,(t=>{D(t)}),void 0,void 0,K,((t,K)=>{a(K)}))}))}static GetBabylonScriptURL(t,K){if(!t)return"";if(m.ScriptBaseUrl&&t.startsWith(m._DefaultCdnUrl)){const K="/"===m.ScriptBaseUrl[m.ScriptBaseUrl.length-1]?m.ScriptBaseUrl.substring(0,m.ScriptBaseUrl.length-1):m.ScriptBaseUrl;t=t.replace(m._DefaultCdnUrl,K)}return t=m.ScriptPreprocessUrl(t),K&&(t=m.GetAbsoluteUrl(t)),t}static LoadBabylonScript(t,K,D,a){t=m.GetBabylonScriptURL(t),m.LoadScript(t,K,D)}static LoadBabylonScriptAsync(t){return t=m.GetBabylonScriptURL(t),m.LoadScriptAsync(t)}static LoadScript(t,K,D,a){if("function"==typeof importScripts){try{importScripts(t),K()}catch(K){null==D||D(`Unable to load script '${t}' in worker`,K)}return}if(!G.BA())return void(null==D||D(`Cannot load script '${t}' outside of a window or a worker`));const N=document.getElementsByTagName("head")[0],W=document.createElement("script");W.setAttribute("type","text/javascript"),W.setAttribute("src",t),a&&(W.id=a),W.onload=()=>{K&&K()},W.onerror=K=>{D&&D(`Unable to load script '${t}'`,K)},N.appendChild(W)}static LoadScriptAsync(t,K){return new Promise(((D,a)=>{this.LoadScript(t,(()=>{D()}),((t,K)=>{a(K||new Error(t))}),K)}))}static ReadFileAsDataURL(t,K,D){const G=new FileReader,N={onCompleteObservable:new a.cP,abort:()=>G.abort()};return G.onloadend=()=>{N.onCompleteObservable.notifyObservers(N)},G.onload=t=>{K(t.target["result"])},G.onprogress=D,G.readAsDataURL(t),N}static ReadFile(t,K,D,a,G){return i.NJ(t,K,D,a,G)}static FileAsURL(t){const K=new Blob([t]);return window.URL.createObjectURL(K)}static Format(t,K=2){return t.toFixed(K)}static DeepCopy(t,K,D,a){W.r.DeepCopy(t,K,D,a)}static IsEmpty(t){for(const K in t)if(Object.prototype.hasOwnProperty.call(t,K))return!1;return!0}static RegisterTopRootEvents(t,K){for(let D=0;D<K.length;D++){const a=K[D];t.addEventListener(a.name,a.handler,!1);try{window.parent&&window.parent.addEventListener(a.name,a.handler,!1)}catch(t){}}}static UnregisterTopRootEvents(t,K){for(let D=0;D<K.length;D++){const a=K[D];t.removeEventListener(a.name,a.handler);try{t.parent&&t.parent.removeEventListener(a.name,a.handler)}catch(t){}}}static async DumpFramebuffer(t,K,D,a,G="image/png",N,W){throw b.n("DumpTools")}static DumpData(t,K,D,a,G="image/png",N,W=!1,x=!1,n){throw b.n("DumpTools")}static DumpDataAsync(t,K,D,a="image/png",G,N=!1,W=!1,x){throw b.n("DumpTools")}static _IsOffScreenCanvas(t){return void 0!==t.convertToBlob}static ToBlob(t,K,D="image/png",a){m._IsOffScreenCanvas(t)||t.toBlob||(t.toBlob=function(t,K,D){setTimeout((()=>{const a=atob(this.toDataURL(K,D).split(",")[1]),G=a.length,N=new Uint8Array(G);for(let t=0;t<G;t++)N[t]=a.charCodeAt(t);t(new Blob([N]))}))}),m._IsOffScreenCanvas(t)?t.convertToBlob({type:D,quality:a}).then((t=>K(t))):t.toBlob((function(t){K(t)}),D,a)}static DownloadBlob(t,K){if("download"in document.createElement("a")){if(!K){const t=new Date;K="screenshot_"+(t.getFullYear()+"-"+(t.getMonth()+1)).slice(2)+"-"+t.getDate()+"_"+t.getHours()+"-"+("0"+t.getMinutes()).slice(-2)+".png"}m.Download(t,K)}else if(t&&"undefined"!=typeof URL){const K=URL.createObjectURL(t),D=window.open("");if(!D)return;const a=D.document.createElement("img");a.onload=function(){URL.revokeObjectURL(K)},a.src=K,D.document.body.appendChild(a)}}static EncodeScreenshotCanvasData(t,K,D="image/png",a,G){if("string"!=typeof a&&K){if(K){if(m._IsOffScreenCanvas(t))return void t.convertToBlob({type:D,quality:G}).then((t=>{const D=new FileReader;D.readAsDataURL(t),D.onloadend=()=>{const t=D.result;K(t)}}));const a=t.toDataURL(D,G);K(a)}}else this.ToBlob(t,(function(t){t&&m.DownloadBlob(t,a),K&&K("")}),D,G)}static Download(t,K){if("undefined"==typeof URL)return;const D=window.URL.createObjectURL(t),a=document.createElement("a");document.body.appendChild(a),a.style.display="none",a.href=D,a.download=K,a.addEventListener("click",(()=>{a.parentElement&&a.parentElement.removeChild(a)})),a.click(),window.URL.revokeObjectURL(D)}static BackCompatCameraNoPreventDefault(t){return"boolean"==typeof t[0]?t[0]:"boolean"==typeof t[1]&&t[1]}static CreateScreenshot(t,K,D,a,G="image/png",N=!1,W){throw b.n("ScreenshotTools")}static CreateScreenshotAsync(t,K,D,a="image/png",G){throw b.n("ScreenshotTools")}static CreateScreenshotUsingRenderTarget(t,K,D,a,G="image/png",N=1,W=!1,x,n=!1,e=!1,i=!0,z){throw b.n("ScreenshotTools")}static CreateScreenshotUsingRenderTargetAsync(t,K,D,a="image/png",G=1,N=!1,W,x=!1,n=!1,e=!0,i){throw b.n("ScreenshotTools")}static RandomId(){return Z.z()}static IsBase64(t){return i.f2(t)}static DecodeBase64(t){return i.rz(t)}static get errorsCount(){return N.V.errorsCount}static Log(t){N.V.Log(t)}static Warn(t){N.V.Warn(t)}static Error(t){N.V.Error(t)}static get LogCache(){return N.V.LogCache}static ClearLogCache(){N.V.ClearLogCache()}static set LogLevels(t){N.V.LogLevels=t}static set PerformanceLogLevel(t){return(t&m.PerformanceUserMarkLogLevel)===m.PerformanceUserMarkLogLevel?(m.StartPerformanceCounter=m._StartUserMark,void(m.EndPerformanceCounter=m._EndUserMark)):(t&m.PerformanceConsoleLogLevel)===m.PerformanceConsoleLogLevel?(m.StartPerformanceCounter=m._StartPerformanceConsole,void(m.EndPerformanceCounter=m._EndPerformanceConsole)):(m.StartPerformanceCounter=m._StartPerformanceCounterDisabled,void(m.EndPerformanceCounter=m._EndPerformanceCounterDisabled))}static _StartPerformanceCounterDisabled(t,K){}static _EndPerformanceCounterDisabled(t,K){}static _StartUserMark(t,K=!0){if(!m._Performance){if(!G.BA())return;m._Performance=window.performance}K&&m._Performance.mark&&m._Performance.mark(t+"-Begin")}static _EndUserMark(t,K=!0){K&&m._Performance.mark&&(m._Performance.mark(t+"-End"),m._Performance.measure(t,t+"-Begin",t+"-End"))}static _StartPerformanceConsole(t,K=!0){K&&(m._StartUserMark(t,K),console.time&&console.time(t))}static _EndPerformanceConsole(t,K=!0){K&&(m._EndUserMark(t,K),console.timeEnd(t))}static get Now(){return x.j.Now}static GetClassName(t,K=!1){let D=null;return!K&&t.getClassName?D=t.getClassName():(t instanceof Object&&(D=(K?t:Object.getPrototypeOf(t)).constructor["__bjsclassName__"]),D||(D=typeof t)),D}static First(t,K){for(const D of t)if(K(D))return D;return null}static getFullClassName(t,K=!1){let D=null,a=null;if(!K&&t.getClassName)D=t.getClassName();else{if(t instanceof Object){const G=K?t:Object.getPrototypeOf(t);D=G.constructor["__bjsclassName__"],a=G.constructor["__bjsmoduleName__"]}D||(D=typeof t)}return D?(null!=a?a+".":"")+D:null}static DelayAsync(t){return new Promise((K=>{setTimeout((()=>{K()}),t)}))}static IsSafari(){return!!G.XD()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}m.UseCustomRequestHeaders=!1,m.CustomRequestHeaders=n.u.CustomRequestHeaders,m.GetDOMTextContent=G.Zl,m._DefaultCdnUrl="https://cdn.babylonjs.com",m.GetAbsoluteUrl="object"==typeof document?t=>{const K=document.createElement("a");return K.href=t,K.href}:"function"==typeof URL&&"object"==typeof location?t=>new URL(t,location.origin).href:()=>{throw new Error("Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.")},m.NoneLogLevel=N.V.NoneLogLevel,m.MessageLogLevel=N.V.MessageLogLevel,m.WarningLogLevel=N.V.WarningLogLevel,m.ErrorLogLevel=N.V.ErrorLogLevel,m.AllLogLevel=N.V.AllLogLevel,m.IsWindowObjectExist=G.BA,m.PerformanceNoneLogLevel=0,m.PerformanceUserMarkLogLevel=1,m.PerformanceConsoleLogLevel=2,m.StartPerformanceCounter=m._StartPerformanceCounterDisabled,m.EndPerformanceCounter=m._EndPerformanceCounterDisabled;class u{constructor(t,K,D,a=0){this.iterations=t,this.index=a-1,this._done=!1,this._fn=K,this._successCallback=D}executeNext(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())}breakLoop(){this._done=!0,this._successCallback()}static Run(t,K,D,a=0){const G=new u(t,K,D,a);return G.executeNext(),G}static SyncAsyncForLoop(t,K,D,a,G,N=0){return u.Run(Math.ceil(t/K),(a=>{G&&G()?a.breakLoop():setTimeout((()=>{for(let N=0;N<K;++N){const W=a.index*K+N;if(W>=t)break;if(D(W),G&&G()){a.breakLoop();break}}a.executeNext()}),N)}),a)}}m.Mix=w.zF,m.IsExponentOfTwo=w.L8,e.q.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z"},310035:(t,K,D)=>{D.d(K,{Y5:()=>G,n9:()=>N});const a={};function G(t,K){a[t]=K}function N(t){return a[t]}},233637:(t,K,D)=>{D.d(K,{K:()=>a});class a{static get UniqueId(){const t=this._UniqueIdCounter;return this._UniqueIdCounter++,t}}a._UniqueIdCounter=1},732259:(t,K,D)=>{D.d(K,{u:()=>a});class a{constructor(){this._xhr="undefined"!=typeof _native&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest,this._requestURL=""}static get IsCustomRequestAvailable(){return Object.keys(a.CustomRequestHeaders).length>0||a.CustomRequestModifiers.length>0}_injectCustomRequestHeaders(){if(!this._shouldSkipRequestModifications(this._requestURL))for(const t in a.CustomRequestHeaders){const K=a.CustomRequestHeaders[t];K&&this._xhr.setRequestHeader(t,K)}}_shouldSkipRequestModifications(t){return a.SkipRequestModificationForBabylonCDN&&(t.includes("preview.babylonjs.com")||t.includes("cdn.babylonjs.com"))}get onprogress(){return this._xhr.onprogress}set onprogress(t){this._xhr.onprogress=t}get readyState(){return this._xhr.readyState}get status(){return this._xhr.status}get statusText(){return this._xhr.statusText}get response(){return this._xhr.response}get responseURL(){return this._xhr.responseURL}get responseText(){return this._xhr.responseText}get responseType(){return this._xhr.responseType}set responseType(t){this._xhr.responseType=t}get timeout(){return this._xhr.timeout}set timeout(t){this._xhr.timeout=t}addEventListener(t,K,D){this._xhr.addEventListener(t,K,D)}removeEventListener(t,K,D){this._xhr.removeEventListener(t,K,D)}abort(){this._xhr.abort()}send(t){a.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(t)}open(t,K){for(const t of a.CustomRequestModifiers){if(this._shouldSkipRequestModifications(K))return;t(this._xhr,K)}K=(K=K.replace("file:http:","http:")).replace("file:https:","https:"),this._requestURL=K,this._xhr.open(t,K,!0)}setRequestHeader(t,K){this._xhr.setRequestHeader(t,K)}getResponseHeader(t){return this._xhr.getResponseHeader(t)}}a.CustomRequestHeaders={},a.CustomRequestModifiers=new Array,a.SkipRequestModificationForBabylonCDN=!0},958413:(t,K,D)=>{D.d(K,{j:()=>n});var a=D(297809),G=D(850034),N=D(432050),W=D(310035),x=D(760998),b=D(337776);class n extends G.w{set kernel(t){this._idealKernel!==t&&(t=Math.max(t,1),this._idealKernel=t,this._kernel=this._nearestBestKernel(t),this._blockCompilation||this._updateParameters())}get kernel(){return this._idealKernel}set packedFloat(t){this._packedFloat!==t&&(this._packedFloat=t,this._blockCompilation||this._updateParameters())}get packedFloat(){return this._packedFloat}getClassName(){return"BlurPostProcess"}constructor(t,K,D,a,G,W=N.g.BILINEAR_SAMPLINGMODE,x,b,n=0,e="",i=!1,z=5){super(t,"kernelBlur",["delta","direction"],["circleOfConfusionSampler"],a,G,W,x,b,null,n,"kernelBlur",{varyingCount:0,depCount:0},!0,z),this._blockCompilation=i,this._packedFloat=!1,this._staticDefines="",this._staticDefines=e,this.direction=K,this.onApplyObservable.add((t=>{this._outputTexture?t.setFloat2("delta",1/this._outputTexture.width*this.direction.x,1/this._outputTexture.height*this.direction.y):t.setFloat2("delta",1/this.width*this.direction.x,1/this.height*this.direction.y)})),this.kernel=D}_gatherImports(t,K){t?(this._webGPUReady=!0,K.push(Promise.all([D.e(14855).then(D.bind(D,314855)),D.e(74706).then(D.bind(D,74706))]))):K.push(Promise.all([D.e(18680).then(D.bind(D,718680)),D.e(61681).then(D.bind(D,661681))])),super._gatherImports(t,K)}updateEffect(t=null,K=null,D=null,a,G,N){this._updateParameters(G,N)}_updateParameters(t,K){const D=this._kernel,a=(D-1)/2;let G=[],N=[],W=0;for(let t=0;t<D;t++){const K=t/(D-1),x=this._gaussianWeight(2*K-1);G[t]=t-a,N[t]=x,W+=x}for(let t=0;t<N.length;t++)N[t]/=W;const x=[],b=[],n=[];for(let t=0;t<=a;t+=2){const K=Math.min(t+1,Math.floor(a));if(t===K)n.push({o:G[t],w:N[t]});else{const D=K===a,W=N[t]+N[K]*(D?.5:1),x=G[t]+1/(1+N[t]/N[K]);0===x?(n.push({o:G[t],w:N[t]}),n.push({o:G[t+1],w:N[t+1]})):(n.push({o:x,w:W}),n.push({o:-x,w:W}))}}for(let t=0;t<n.length;t++)b[t]=n[t].o,x[t]=n[t].w;G=b,N=x;const e=this.getEngine().getCaps().maxVaryingVectors-(1===this.shaderLanguage?1:0),i=Math.max(e,0)-1;let z=Math.min(G.length,i),I="";I+=this._staticDefines,-1!=this._staticDefines.indexOf("DOF")&&(I+=`#define CENTER_WEIGHT ${this._glslFloat(N[z-1])}\n`,z--);for(let t=0;t<z;t++)I+=`#define KERNEL_OFFSET${t} ${this._glslFloat(G[t])}\n`,I+=`#define KERNEL_WEIGHT${t} ${this._glslFloat(N[t])}\n`;let Z=0;for(let t=i;t<G.length;t++)I+=`#define KERNEL_DEP_OFFSET${Z} ${this._glslFloat(G[t])}\n`,I+=`#define KERNEL_DEP_WEIGHT${Z} ${this._glslFloat(N[t])}\n`,Z++;this.packedFloat&&(I+=`#define PACKEDFLOAT 1`),this._blockCompilation=!1,super.updateEffect(I,null,null,{varyingCount:z,depCount:Z},t,K)}_nearestBestKernel(t){const K=Math.round(t);for(const t of[K,K-1,K+1,K-2,K+2])if(t%2!=0&&Math.floor(t/2)%2==0&&t>0)return Math.max(t,3);return Math.max(K,3)}_gaussianWeight(t){const K=1/3,D=-t*t/(2*K*K);return 1/(Math.sqrt(2*Math.PI)*K)*Math.exp(D)}_glslFloat(t,K=8){return t.toFixed(K).replace(/0+$/,"")}static _Parse(t,K,D,a){return b.p.Parse((()=>new n(t.name,t.direction,t.kernel,t.options,K,t.renderTargetSamplingMode,D.getEngine(),t.reusable,t.textureType,void 0,!1)),t,D,a)}}a.Cg([x.lK("kernel")],n.prototype,"_kernel",void 0),a.Cg([x.lK("packedFloat")],n.prototype,"_packedFloat",void 0),a.Cg([x.WM()],n.prototype,"direction",void 0),W.Y5("BABYLON.BlurPostProcess",n)},882621:(t,K,D)=>{D.d(K,{v:()=>x});var a=D(850034),G=D(33321),N=D(310035),W=D(337776);class x extends a.w{getClassName(){return"PassPostProcess"}constructor(t,K,D=null,a,G,N,W=0,x=!1){super(t,"pass",null,null,K,D,a,G,N,void 0,W,void 0,null,x)}_gatherImports(t,K){t?(this._webGPUReady=!0,K.push(Promise.all([D.e(49920).then(D.bind(D,649920))]))):K.push(Promise.all([Promise.resolve().then(D.bind(D,330153))])),super._gatherImports(t,K)}static _Parse(t,K,D,a){return W.p.Parse((()=>new x(t.name,t.options,K,t.renderTargetSamplingMode,t._engine,t.reusable)),t,D,a)}}N.Y5("BABYLON.PassPostProcess",x),a.w,G.$._RescalePostProcessFactory=t=>new x("rescale",1,null,2,t,!1,0)},850034:(t,K,D)=>{D.d(K,{w:()=>Z});var a=D(297809),G=D(293506),N=D(638113),W=D(604910),x=D(498083),b=(D(310839),D(68561),D(760998)),n=D(337776),e=D(310035),i=D(964061),z=D(33321),I=D(104270);z.$.prototype.setTextureFromPostProcess=function(t,K,D){var a;let G=null;K&&(K._forcedOutputTexture?G=K._forcedOutputTexture:K._textures.data[K._currentRenderTextureInd]&&(G=K._textures.data[K._currentRenderTextureInd])),this._bindTexture(t,null!==(a=null==G?void 0:G.texture)&&void 0!==a?a:null,D)},z.$.prototype.setTextureFromPostProcessOutput=function(t,K,D){var a,G;this._bindTexture(t,null!==(G=null===(a=null==K?void 0:K._outputTexture)||void 0===a?void 0:a.texture)&&void 0!==G?G:null,D)},x.M.prototype.setTextureFromPostProcess=function(t,K){this._engine.setTextureFromPostProcess(this._samplers[t],K,t)},x.M.prototype.setTextureFromPostProcessOutput=function(t,K){this._engine.setTextureFromPostProcessOutput(this._samplers[t],K,t)};class Z{static RegisterShaderCodeProcessing(t,K){K?Z._CustomShaderCodeProcessing[null!=t?t:""]=K:delete Z._CustomShaderCodeProcessing[null!=t?t:""]}static _GetShaderCodeProcessing(t){var K;return null!==(K=Z._CustomShaderCodeProcessing[t])&&void 0!==K?K:Z._CustomShaderCodeProcessing[""]}get samples(){return this._samples}set samples(t){this._samples=Math.min(t,this._engine.getCaps().maxMSAASamples),this._textures.forEach((t=>{t.setSamples(this._samples)}))}get shaderLanguage(){return this._shaderLanguage}getEffectName(){return this._fragmentUrl}set onActivate(t){this._onActivateObserver&&this.onActivateObservable.remove(this._onActivateObserver),t&&(this._onActivateObserver=this.onActivateObservable.add(t))}set onSizeChanged(t){this._onSizeChangedObserver&&this.onSizeChangedObservable.remove(this._onSizeChangedObserver),this._onSizeChangedObserver=this.onSizeChangedObservable.add(t)}set onApply(t){this._onApplyObserver&&this.onApplyObservable.remove(this._onApplyObserver),this._onApplyObserver=this.onApplyObservable.add(t)}set onBeforeRender(t){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(t)}set onAfterRender(t){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),this._onAfterRenderObserver=this.onAfterRenderObservable.add(t)}get inputTexture(){return this._textures.data[this._currentRenderTextureInd]}set inputTexture(t){this._forcedOutputTexture=t}restoreDefaultInputTexture(){this._forcedOutputTexture&&(this._forcedOutputTexture=null,this.markTextureDirty())}getCamera(){return this._camera}get texelSize(){return this._shareOutputWithPostProcess?this._shareOutputWithPostProcess.texelSize:(this._forcedOutputTexture&&this._texelSize.copyFromFloats(1/this._forcedOutputTexture.width,1/this._forcedOutputTexture.height),this._texelSize)}constructor(t,K,D,a,x,b,n=1,e,z,I=null,Z=0,w="postprocess",m,u=!1,d=5,E,l){var Q,P,y,q,X,h,J,T,_,C,H,o;this._parentContainer=null,this.width=-1,this.height=-1,this.nodeMaterialSource=null,this._outputTexture=null,this.autoClear=!0,this.forceAutoClearInAlphaMode=!1,this.alphaMode=0,this.animations=[],this.enablePixelPerfectMode=!1,this.forceFullscreenViewport=!0,this.scaleMode=1,this.alwaysForcePOT=!1,this._samples=1,this.adaptScaleToCurrentViewport=!1,this._shadersLoaded=!1,this._webGPUReady=!1,this._reusable=!1,this._renderId=0,this.externalTextureSamplerBinding=!1,this._textures=new G.L(2),this._textureCache=[],this._currentRenderTextureInd=0,this._scaleRatio=new W.I9(1,1),this._texelSize=W.I9.Zero(),this.onEffectCreatedObservable=new N.cP(void 0,!0),this.onActivateObservable=new N.cP,this.onSizeChangedObservable=new N.cP,this.onApplyObservable=new N.cP,this.onBeforeRenderObservable=new N.cP,this.onAfterRenderObservable=new N.cP,this._importPromises=[],this.name=t;let U=1,V=null;if(D&&!Array.isArray(D)){const t=D;D=null!==(Q=t.uniforms)&&void 0!==Q?Q:null,a=null!==(P=t.samplers)&&void 0!==P?P:null,U=null!==(y=t.size)&&void 0!==y?y:1,b=null!==(q=t.camera)&&void 0!==q?q:null,n=null!==(X=t.samplingMode)&&void 0!==X?X:1,e=t.engine,z=t.reusable,I=null!==(h=t.defines)&&void 0!==h?h:null,Z=null!==(J=t.textureType)&&void 0!==J?J:0,w=null!==(T=t.vertexUrl)&&void 0!==T?T:"postprocess",m=t.indexParameters,u=null!==(_=t.blockCompilation)&&void 0!==_&&_,d=null!==(C=t.textureFormat)&&void 0!==C?C:5,E=null!==(H=t.shaderLanguage)&&void 0!==H?H:0,V=null!==(o=t.uniformBuffers)&&void 0!==o?o:null}else x&&(U="number"==typeof x?x:{width:x.width,height:x.height});null!=b?(this._camera=b,this._scene=b.getScene(),b.attachPostProcess(this),this._engine=this._scene.getEngine(),this._scene.postProcesses.push(this),this.uniqueId=this._scene.getUniqueId()):e&&(this._engine=e,this._engine.postProcesses.push(this)),this._options=U,this.renderTargetSamplingMode=n||1,this._reusable=z||!1,this._textureType=Z,this._textureFormat=d,this._shaderLanguage=E||0,this._samplers=a||[],this._samplers.push("textureSampler"),this._fragmentUrl=K,this._vertexUrl=w,this._parameters=D||[],this._parameters.push("scale"),this._uniformBuffers=V||[],this._indexParameters=m,this._drawWrapper=new i.E(this._engine),this._webGPUReady=1===this._shaderLanguage,this._postConstructor(u,I,l)}_gatherImports(t=!1,K){t&&this._webGPUReady?K.push(Promise.all([D.e(39920).then(D.bind(D,439920))])):K.push(Promise.all([Promise.resolve().then(D.bind(D,310839))]))}_postConstructor(t,K=null,D){const a=this.getEngine().isWebGPU&&!Z.ForceGLSL;this._gatherImports(a,this._importPromises),D&&D(a,this._importPromises),a&&this._webGPUReady&&(this._shaderLanguage=1),t||this.updateEffect(K)}getClassName(){return"PostProcess"}getEngine(){return this._engine}getEffect(){return this._drawWrapper.effect}shareOutputWith(t){return this._disposeTextures(),this._shareOutputWithPostProcess=t,this}useOwnOutput(){0==this._textures.length&&(this._textures=new G.L(2)),this._shareOutputWithPostProcess=null}updateEffect(t=null,K=null,D=null,a,G,N,W,x){var b,n;const e=Z._GetShaderCodeProcessing(this.name);if(null==e?void 0:e.defineCustomBindings){const a=null!==(b=null==K?void 0:K.slice())&&void 0!==b?b:[];a.push(...this._parameters);const G=null!==(n=null==D?void 0:D.slice())&&void 0!==n?n:[];G.push(...this._samplers),t=e.defineCustomBindings(this.name,t,a,G),K=a,D=G}this._postProcessDefines=t,this._drawWrapper.effect=this._engine.createEffect({vertex:null!=W?W:this._vertexUrl,fragment:null!=x?x:this._fragmentUrl},{attributes:["position"],uniformsNames:K||this._parameters,uniformBuffersNames:this._uniformBuffers,samplers:D||this._samplers,defines:null!==t?t:"",fallbacks:null,onCompiled:null!=G?G:null,onError:null!=N?N:null,indexParameters:a||this._indexParameters,processCodeAfterIncludes:(null==e?void 0:e.processCodeAfterIncludes)?(t,K)=>e.processCodeAfterIncludes(this.name,t,K):null,processFinalCode:(null==e?void 0:e.processFinalCode)?(t,K)=>e.processFinalCode(this.name,t,K):null,shaderLanguage:this._shaderLanguage,extraInitializationsAsync:this._shadersLoaded?void 0:async()=>{await Promise.all(this._importPromises),this._shadersLoaded=!0}},this._engine),this.onEffectCreatedObservable.notifyObservers(this._drawWrapper.effect)}isReusable(){return this._reusable}markTextureDirty(){this.width=-1}_createRenderTargetTexture(t,K,D=0){for(let a=0;a<this._textureCache.length;a++)if(this._textureCache[a].texture.width===t.width&&this._textureCache[a].texture.height===t.height&&this._textureCache[a].postProcessChannel===D&&this._textureCache[a].texture._generateDepthBuffer===K.generateDepthBuffer&&this._textureCache[a].texture.samples===K.samples)return this._textureCache[a].texture;const a=this._engine.createRenderTargetTexture(t,K);return this._textureCache.push({texture:a,postProcessChannel:D,lastUsedRenderId:-1}),a}_flushTextureCache(){const t=this._renderId;for(let K=this._textureCache.length-1;K>=0;K--)if(t-this._textureCache[K].lastUsedRenderId>100){let t=!1;for(let D=0;D<this._textures.length;D++)if(this._textures.data[D]===this._textureCache[K].texture){t=!0;break}t||(this._textureCache[K].texture.dispose(),this._textureCache.splice(K,1))}}resize(t,K,D=null,a=!1,G=!1){this._textures.length>0&&this._textures.reset(),this.width=t,this.height=K;let N=null;if(D)for(let t=0;t<D._postProcesses.length;t++)if(null!==D._postProcesses[t]){N=D._postProcesses[t];break}const W={width:this.width,height:this.height},x={generateMipMaps:a,generateDepthBuffer:G||N===this,generateStencilBuffer:(G||N===this)&&this._engine.isStencilEnable,samplingMode:this.renderTargetSamplingMode,type:this._textureType,format:this._textureFormat,samples:this._samples,label:"PostProcessRTT-"+this.name};this._textures.push(this._createRenderTargetTexture(W,x,0)),this._reusable&&this._textures.push(this._createRenderTargetTexture(W,x,1)),this._texelSize.copyFromFloats(1/this.width,1/this.height),this.onSizeChangedObservable.notifyObservers(this)}_getTarget(){let t;if(this._shareOutputWithPostProcess)t=this._shareOutputWithPostProcess.inputTexture;else if(this._forcedOutputTexture)t=this._forcedOutputTexture,this.width=this._forcedOutputTexture.width,this.height=this._forcedOutputTexture.height;else{let K;t=this.inputTexture;for(let D=0;D<this._textureCache.length;D++)if(this._textureCache[D].texture===t){K=this._textureCache[D];break}K&&(K.lastUsedRenderId=this._renderId)}return t}activate(t,K=null,D){var a,G;const N=(t=t||this._camera).getScene(),W=N.getEngine(),x=W.getCaps().maxTextureSize,b=(K?K.width:this._engine.getRenderWidth(!0))*this._options|0,n=(K?K.height:this._engine.getRenderHeight(!0))*this._options|0;let e=this._options.width||b,i=this._options.height||n;const z=7!==this.renderTargetSamplingMode&&1!==this.renderTargetSamplingMode&&2!==this.renderTargetSamplingMode;let Z=null;if(!this._shareOutputWithPostProcess&&!this._forcedOutputTexture){if(this.adaptScaleToCurrentViewport){const t=W.currentViewport;t&&(e*=t.width,i*=t.height)}(z||this.alwaysForcePOT)&&(this._options.width||(e=W.needPOTTextures?I.R(e,x,this.scaleMode):e),this._options.height||(i=W.needPOTTextures?I.R(i,x,this.scaleMode):i)),this.width===e&&this.height===i&&(Z=this._getTarget())||this.resize(e,i,t,z,D),this._textures.forEach((t=>{t.samples!==this.samples&&this._engine.updateRenderTargetTextureSampleCount(t,this.samples)})),this._flushTextureCache(),this._renderId++}return Z||(Z=this._getTarget()),this.enablePixelPerfectMode?(this._scaleRatio.copyFromFloats(b/e,n/i),this._engine.bindFramebuffer(Z,0,b,n,this.forceFullscreenViewport)):(this._scaleRatio.copyFromFloats(1,1),this._engine.bindFramebuffer(Z,0,void 0,void 0,this.forceFullscreenViewport)),null===(G=(a=this._engine)._debugInsertMarker)||void 0===G||G.call(a,`post process ${this.name} input`),this.onActivateObservable.notifyObservers(t),this.autoClear&&(0===this.alphaMode||this.forceAutoClearInAlphaMode)&&this._engine.clear(this.clearColor?this.clearColor:N.clearColor,N._allowPostProcessClearColor,!0,!0),this._reusable&&(this._currentRenderTextureInd=(this._currentRenderTextureInd+1)%2),Z}get isSupported(){return this._drawWrapper.effect.isSupported}get aspectRatio(){return this._shareOutputWithPostProcess?this._shareOutputWithPostProcess.aspectRatio:this._forcedOutputTexture?this._forcedOutputTexture.width/this._forcedOutputTexture.height:this.width/this.height}isReady(){var t,K;return null!==(K=null===(t=this._drawWrapper.effect)||void 0===t?void 0:t.isReady())&&void 0!==K&&K}apply(){var t,K,D;if(!(null===(t=this._drawWrapper.effect)||void 0===t?void 0:t.isReady()))return null;let a;return this._engine.enableEffect(this._drawWrapper),this._engine.setState(!1),this._engine.setDepthBuffer(!1),this._engine.setDepthWrite(!1),this._engine.setAlphaMode(this.alphaMode),this.alphaConstants&&this.getEngine().setAlphaConstants(this.alphaConstants.r,this.alphaConstants.g,this.alphaConstants.b,this.alphaConstants.a),a=this._shareOutputWithPostProcess?this._shareOutputWithPostProcess.inputTexture:this._forcedOutputTexture?this._forcedOutputTexture:this.inputTexture,this.externalTextureSamplerBinding||this._drawWrapper.effect._bindTexture("textureSampler",null==a?void 0:a.texture),this._drawWrapper.effect.setVector2("scale",this._scaleRatio),this.onApplyObservable.notifyObservers(this._drawWrapper.effect),null===(D=null===(K=Z._GetShaderCodeProcessing(this.name))||void 0===K?void 0:K.bindCustomBindings)||void 0===D||D.call(K,this.name,this._drawWrapper.effect),this._drawWrapper.effect}_disposeTextures(){this._shareOutputWithPostProcess||this._forcedOutputTexture?this._disposeTextureCache():(this._disposeTextureCache(),this._textures.dispose())}_disposeTextureCache(){for(let t=this._textureCache.length-1;t>=0;t--)this._textureCache[t].texture.dispose();this._textureCache.length=0}setPrePassRenderer(t){return!!this._prePassEffectConfiguration&&(this._prePassEffectConfiguration=t.addEffectConfiguration(this._prePassEffectConfiguration),this._prePassEffectConfiguration.enabled=!0,!0)}dispose(t){let K;if(t=t||this._camera,this._disposeTextures(),this._scene&&(K=this._scene.postProcesses.indexOf(this),-1!==K&&this._scene.postProcesses.splice(K,1)),this._parentContainer){const t=this._parentContainer.postProcesses.indexOf(this);t>-1&&this._parentContainer.postProcesses.splice(t,1),this._parentContainer=null}if(K=this._engine.postProcesses.indexOf(this),-1!==K&&this._engine.postProcesses.splice(K,1),t){if(t.detachPostProcess(this),K=t._postProcesses.indexOf(this),0===K&&t._postProcesses.length>0){const t=this._camera._getFirstPostProcess();t&&t.markTextureDirty()}this.onActivateObservable.clear(),this.onAfterRenderObservable.clear(),this.onApplyObservable.clear(),this.onBeforeRenderObservable.clear(),this.onSizeChangedObservable.clear(),this.onEffectCreatedObservable.clear()}}serialize(){const t=n.p.Serialize(this),K=this.getCamera()||this._scene&&this._scene.activeCamera;return t.customType="BABYLON."+this.getClassName(),t.cameraId=K?K.id:null,t.reusable=this._reusable,t.textureType=this._textureType,t.fragmentUrl=this._fragmentUrl,t.parameters=this._parameters,t.samplers=this._samplers,t.options=this._options,t.defines=this._postProcessDefines,t.textureFormat=this._textureFormat,t.vertexUrl=this._vertexUrl,t.indexParameters=this._indexParameters,t}clone(){const t=this.serialize();t._engine=this._engine,t.cameraId=null;const K=Z.Parse(t,this._scene,"");return K?(K.onActivateObservable=this.onActivateObservable.clone(),K.onSizeChangedObservable=this.onSizeChangedObservable.clone(),K.onApplyObservable=this.onApplyObservable.clone(),K.onBeforeRenderObservable=this.onBeforeRenderObservable.clone(),K.onAfterRenderObservable=this.onAfterRenderObservable.clone(),K._prePassEffectConfiguration=this._prePassEffectConfiguration,K):null}static Parse(t,K,D){const a=e.n9(t.customType);if(!a||!a._Parse)return null;const G=K?K.getCameraById(t.cameraId):null;return a._Parse(t,G,K,D)}static _Parse(t,K,D,a){return n.p.Parse((()=>new Z(t.name,t.fragmentUrl,t.parameters,t.samplers,t.options,K,t.renderTargetSamplingMode,t._engine,t.reusable,t.defines,t.textureType,t.vertexUrl,t.indexParameters,!1,t.textureFormat)),t,D,a)}}Z.ForceGLSL=!1,Z._CustomShaderCodeProcessing={},a.Cg([b.lK()],Z.prototype,"uniqueId",void 0),a.Cg([b.lK()],Z.prototype,"name",void 0),a.Cg([b.lK()],Z.prototype,"width",void 0),a.Cg([b.lK()],Z.prototype,"height",void 0),a.Cg([b.lK()],Z.prototype,"renderTargetSamplingMode",void 0),a.Cg([b.qK()],Z.prototype,"clearColor",void 0),a.Cg([b.lK()],Z.prototype,"autoClear",void 0),a.Cg([b.lK()],Z.prototype,"forceAutoClearInAlphaMode",void 0),a.Cg([b.lK()],Z.prototype,"alphaMode",void 0),a.Cg([b.lK()],Z.prototype,"alphaConstants",void 0),a.Cg([b.lK()],Z.prototype,"enablePixelPerfectMode",void 0),a.Cg([b.lK()],Z.prototype,"forceFullscreenViewport",void 0),a.Cg([b.lK()],Z.prototype,"scaleMode",void 0),a.Cg([b.lK()],Z.prototype,"alwaysForcePOT",void 0),a.Cg([b.lK("samples")],Z.prototype,"_samples",void 0),a.Cg([b.lK()],Z.prototype,"adaptScaleToCurrentViewport",void 0),e.Y5("BABYLON.PostProcess",Z)},848287:(t,K,D)=>{D.d(K,{X:()=>N});var a=D(23987),G=D(638113);class N{constructor(t){this._vertexBuffers={},this.onBeforeRenderObservable=new G.cP,this._scene=t}_prepareBuffers(){if(this._vertexBuffers[a.R.PositionKind])return;const t=[];t.push(1,1),t.push(-1,1),t.push(-1,-1),t.push(1,-1),this._vertexBuffers[a.R.PositionKind]=new a.R(this._scene.getEngine(),t,a.R.PositionKind,!1,!1,2),this._buildIndexBuffer()}_buildIndexBuffer(){const t=[];t.push(0),t.push(1),t.push(2),t.push(0),t.push(2),t.push(3),this._indexBuffer=this._scene.getEngine().createIndexBuffer(t)}_rebuild(){const t=this._vertexBuffers[a.R.PositionKind];t&&(t._rebuild(),this._buildIndexBuffer())}_prepareFrame(t=null,K=null){const D=this._scene.activeCamera;return!(!D||!(K=K||D._postProcesses.filter((t=>null!=t)))||0===K.length||!this._scene.postProcessesEnabled||(K[0].activate(D,t,null!=K),0))}directRender(t,K=null,D=!1,a=0,G=0,N=!1){var W;const x=this._scene.getEngine();for(let b=0;b<t.length;b++){b<t.length-1?t[b+1].activate(this._scene.activeCamera,null==K?void 0:K.texture):(K?x.bindFramebuffer(K,a,void 0,void 0,D,G):N||x.restoreDefaultFramebuffer(),null===(W=x._debugInsertMarker)||void 0===W||W.call(x,`post process ${t[b].name} output`));const n=t[b],e=n.apply();e&&(n.onBeforeRenderObservable.notifyObservers(e),this._prepareBuffers(),x.bindBuffers(this._vertexBuffers,this._indexBuffer,e),x.drawElementsType(0,0,6),n.onAfterRenderObservable.notifyObservers(e))}x.setDepthBuffer(!0),x.setDepthWrite(!0)}_finalizeFrame(t,K,D,a,G=!1){var N;const W=this._scene.activeCamera;if(!W)return;if(this.onBeforeRenderObservable.notifyObservers(this),0===(a=a||W._postProcesses.filter((t=>null!=t))).length||!this._scene.postProcessesEnabled)return;const x=this._scene.getEngine();for(let b=0,n=a.length;b<n;b++){const e=a[b];if(b<n-1?e._outputTexture=a[b+1].activate(W,null==K?void 0:K.texture):(K?(x.bindFramebuffer(K,D,void 0,void 0,G),e._outputTexture=K):(x.restoreDefaultFramebuffer(),e._outputTexture=null),null===(N=x._debugInsertMarker)||void 0===N||N.call(x,`post process ${a[b].name} output`)),t)break;const i=e.apply();i&&(e.onBeforeRenderObservable.notifyObservers(i),this._prepareBuffers(),x.bindBuffers(this._vertexBuffers,this._indexBuffer,i),x.drawElementsType(0,0,6),e.onAfterRenderObservable.notifyObservers(i))}x.setDepthBuffer(!0),x.setDepthWrite(!0),x.setAlphaMode(0)}dispose(){const t=this._vertexBuffers[a.R.PositionKind];t&&(t.dispose(),this._vertexBuffers[a.R.PositionKind]=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null)}}},636544:(t,K,D)=>{D.d(K,{d:()=>z});var a=D(332290),G=D(23987),N=D(432050),W=D(888413),x=D(564135),b=(D(823143),D(506740),D(554014)),n=D(651577),e=D(855300),i=D(522208);class z{get shaderLanguage(){return this._shaderLanguage}setMaterialForRendering(t,K){this._depthMap.setMaterialForRendering(t,K)}constructor(t,K=1,D=null,G=!1,b=N.g.TRILINEAR_SAMPLINGMODE,i=!1,I){this._shaderLanguage=0,this.enabled=!0,this.forceDepthWriteTransparentMeshes=!1,this.useOnlyInActiveCamera=!1,this.reverseCulling=!1,this._shadersLoaded=!1,this._scene=t,this._storeNonLinearDepth=G,this._storeCameraSpaceZ=i,this.isPacked=0===K,this.isPacked?this.clearColor=new a.ov(1,1,1,1):this.clearColor=new a.ov(i?1e8:1,0,0,1),this._initShaderSourceAsync(),z._SceneComponentInitialization(this._scene);const Z=t.getEngine();this._camera=D,b!==N.g.NEAREST_SAMPLINGMODE&&(1!==K||Z._caps.textureFloatLinearFiltering||(b=N.g.NEAREST_SAMPLINGMODE),2!==K||Z._caps.textureHalfFloatLinearFiltering||(b=N.g.NEAREST_SAMPLINGMODE));const w=this.isPacked||!Z._features.supportExtendedTextureFormats?5:6;this._depthMap=new W.$(null!=I?I:"DepthRenderer",{width:Z.getRenderWidth(),height:Z.getRenderHeight()},this._scene,!1,!0,K,!1,b,void 0,void 0,void 0,w),this._depthMap.wrapU=N.g.CLAMP_ADDRESSMODE,this._depthMap.wrapV=N.g.CLAMP_ADDRESSMODE,this._depthMap.refreshRate=1,this._depthMap.renderParticles=!1,this._depthMap.renderList=null,this._depthMap.noPrePassRenderer=!0,this._depthMap.activeCamera=this._camera,this._depthMap.ignoreCameraViewport=!0,this._depthMap.useCameraPostProcesses=!1,this._depthMap.onClearObservable.add((t=>{t.clear(this.clearColor,!0,!0,!0)})),this._depthMap.onBeforeBindObservable.add((()=>{var t;null===(t=Z._debugPushGroup)||void 0===t||t.call(Z,"depth renderer",1)})),this._depthMap.onAfterUnbindObservable.add((()=>{var t;null===(t=Z._debugPopGroup)||void 0===t||t.call(Z,1)})),this._depthMap.customIsReadyFunction=(t,K,D)=>{if((D||0===K)&&t.subMeshes)for(let K=0;K<t.subMeshes.length;++K){const D=t.subMeshes[K],a=D.getRenderingMesh(),G=a._getInstancesRenderList(D._id,!!D.getReplacementMesh()),N=Z.getCaps().instancedArrays&&(null!==G.visibleInstances[D._id]&&void 0!==G.visibleInstances[D._id]||a.hasThinInstances);if(!this.isReady(D,N))return!1}return!0};const m=t=>{var K;const D=t.getRenderingMesh(),a=t.getEffectiveMesh(),G=this._scene,N=G.getEngine(),W=t.getMaterial();if(a._internalAbstractMeshDataInfo._isActiveIntermediate=!1,!W||a.infiniteDistance||W.disableDepthWrite||0===t.verticesCount||t._renderId===G.getRenderId())return;const b=a._getWorldMatrixDeterminant()<0;let i=W._getEffectiveOrientation(D);b&&(i=0===i?1:0);const z=0===i;N.setState(W.backFaceCulling,0,!1,z,this.reverseCulling?!W.cullBackFaces:W.cullBackFaces);const I=D._getInstancesRenderList(t._id,!!t.getReplacementMesh());if(I.mustReturn)return;const Z=N.getCaps().instancedArrays&&(null!==I.visibleInstances[t._id]&&void 0!==I.visibleInstances[t._id]||D.hasThinInstances),w=this._camera||G.activeCamera;if(this.isReady(t,Z)&&w){t._renderId=G.getRenderId();const b=null===(K=a._internalAbstractMeshDataInfo._materialForRenderPass)||void 0===K?void 0:K[N.currentRenderPassId];let i=t._getDrawWrapper();!i&&b&&(i=b._getDrawWrapper());const z=w.mode===x.i.ORTHOGRAPHIC_CAMERA;if(!i)return;const m=i.effect;let u,d;if(N.enableEffect(i),Z||D._bind(t,m,W.fillMode),b?b.bindForSubMesh(a.getWorldMatrix(),a,t):(m.setMatrix("viewProjection",G.getTransformMatrix()),m.setMatrix("world",a.getWorldMatrix()),this._storeCameraSpaceZ&&m.setMatrix("view",G.getViewMatrix())),z?(u=!N.useReverseDepthBuffer&&N.isNDCHalfZRange?0:1,d=N.useReverseDepthBuffer&&N.isNDCHalfZRange?0:1):(u=N.useReverseDepthBuffer&&N.isNDCHalfZRange?w.minZ:N.isNDCHalfZRange?0:w.minZ,d=N.useReverseDepthBuffer&&N.isNDCHalfZRange?0:w.maxZ),m.setFloat2("depthValues",u,u+d),!b){if(W.needAlphaTesting()){const t=W.getAlphaTestTexture();t&&(m.setTexture("diffuseSampler",t),m.setMatrix("diffuseMatrix",t.getTextureMatrix()))}e.f$(D,m),n.gS(m,W,G),e.nR(D,m),D.morphTargetManager&&D.morphTargetManager.isUsingTextureForTargets&&D.morphTargetManager._bind(m);const K=t.getMesh().bakedVertexAnimationManager;K&&K.isEnabled&&K.bind(m,Z),W.pointsCloud&&m.setFloat("pointSize",W.pointSize)}D._processRendering(a,t,m,W.fillMode,I,Z,((t,K)=>m.setMatrix("world",K)))}};this._depthMap.customRenderFunction=(t,K,D,a)=>{let G;if(a.length)for(G=0;G<a.length;G++)m(a.data[G]);for(G=0;G<t.length;G++)m(t.data[G]);for(G=0;G<K.length;G++)m(K.data[G]);if(this.forceDepthWriteTransparentMeshes)for(G=0;G<D.length;G++)m(D.data[G]);else for(G=0;G<D.length;G++)D.data[G].getEffectiveMesh()._internalAbstractMeshDataInfo._isActiveIntermediate=!1}}async _initShaderSourceAsync(t=!1){!this._scene.getEngine().isWebGPU||t||z.ForceGLSL?await Promise.all([Promise.resolve().then(D.bind(D,506740)),Promise.resolve().then(D.bind(D,823143))]):(this._shaderLanguage=1,await Promise.all([D.e(96838).then(D.bind(D,196838)),D.e(76488).then(D.bind(D,176488))])),this._shadersLoaded=!0}isReady(t,K){var D;if(!this._shadersLoaded)return!1;const a=this._scene.getEngine(),N=t.getMesh(),W=N.getScene(),x=null===(D=N._internalAbstractMeshDataInfo._materialForRenderPass)||void 0===D?void 0:D[a.currentRenderPassId];if(x)return x.isReadyForSubMesh(N,t,K);const b=t.getMaterial();if(!b||b.disableDepthWrite)return!1;const z=[],I=[G.R.PositionKind];b.needAlphaTesting()&&b.getAlphaTestTexture()&&(z.push("#define ALPHATEST"),N.isVerticesDataPresent(G.R.UVKind)&&(I.push(G.R.UVKind),z.push("#define UV1")),N.isVerticesDataPresent(G.R.UV2Kind)&&(I.push(G.R.UV2Kind),z.push("#define UV2")));const Z=new i.J;if(N.useBones&&N.computeBonesUsingShaders&&N.skeleton){I.push(G.R.MatricesIndicesKind),I.push(G.R.MatricesWeightsKind),N.numBoneInfluencers>4&&(I.push(G.R.MatricesIndicesExtraKind),I.push(G.R.MatricesWeightsExtraKind)),z.push("#define NUM_BONE_INFLUENCERS "+N.numBoneInfluencers),N.numBoneInfluencers>0&&Z.addCPUSkinningFallback(0,N);const t=N.skeleton;t.isUsingTextureForMatrices?z.push("#define BONETEXTURE"):z.push("#define BonesPerMesh "+(t.bones.length+1))}else z.push("#define NUM_BONE_INFLUENCERS 0");const w=N.morphTargetManager;let m=0;w&&(m=w.numMaxInfluencers||w.numInfluencers,m>0&&(z.push("#define MORPHTARGETS"),z.push("#define NUM_MORPH_INFLUENCERS "+m),w.isUsingTextureForTargets&&z.push("#define MORPHTARGETS_TEXTURE"),e.MF(I,N,m))),b.pointsCloud&&z.push("#define POINTSIZE"),K&&(z.push("#define INSTANCES"),e.te(I),t.getRenderingMesh().hasThinInstances&&z.push("#define THIN_INSTANCES"));const u=N.bakedVertexAnimationManager;u&&u.isEnabled&&(z.push("#define BAKED_VERTEX_ANIMATION_TEXTURE"),K&&I.push("bakedVertexAnimationSettingsInstanced")),this._storeNonLinearDepth&&z.push("#define NONLINEARDEPTH"),this._storeCameraSpaceZ&&z.push("#define STORE_CAMERASPACE_Z"),this.isPacked&&z.push("#define PACKED"),n.tv(b,W,z);const d=t._getDrawWrapper(void 0,!0),E=d.defines,l=z.join("\n");if(E!==l){const t=["world","mBones","boneTextureWidth","pointSize","viewProjection","view","diffuseMatrix","depthValues","morphTargetInfluences","morphTargetCount","morphTargetTextureInfo","morphTargetTextureIndices","bakedVertexAnimationSettings","bakedVertexAnimationTextureSizeInverted","bakedVertexAnimationTime","bakedVertexAnimationTexture"],K=["diffuseSampler","morphTargets","boneSampler","bakedVertexAnimationTexture"];n.TV(t),d.setEffect(a.createEffect("depth",{attributes:I,uniformsNames:t,uniformBuffersNames:[],samplers:K,defines:l,fallbacks:Z,onCompiled:null,onError:null,indexParameters:{maxSimultaneousMorphTargets:m},shaderLanguage:this._shaderLanguage},a))}return d.effect.isReady()}getDepthMap(){return this._depthMap}dispose(){const t=[];for(const K in this._scene._depthRenderer)this._scene._depthRenderer[K]===this&&t.push(K);if(t.length>0){this._depthMap.dispose();for(const K of t)delete this._scene._depthRenderer[K]}}}z.ForceGLSL=!1,z._SceneComponentInitialization=t=>{throw b.n("DepthRendererSceneComponent")}},267255:(t,K,D)=>{D.d(K,{U:()=>N});var a=D(293506),G=D(604910);class N{set opaqueSortCompareFn(t){this._opaqueSortCompareFn=t||N.PainterSortCompare,this._renderOpaque=this._renderOpaqueSorted}set alphaTestSortCompareFn(t){this._alphaTestSortCompareFn=t||N.PainterSortCompare,this._renderAlphaTest=this._renderAlphaTestSorted}set transparentSortCompareFn(t){this._transparentSortCompareFn=t||N.defaultTransparentSortCompare,this._renderTransparent=this._renderTransparentSorted}constructor(t,K,D=null,G=null,N=null){this.index=t,this._opaqueSubMeshes=new a.L(256),this._transparentSubMeshes=new a.L(256),this._alphaTestSubMeshes=new a.L(256),this._depthOnlySubMeshes=new a.L(256),this._particleSystems=new a.L(256),this._spriteManagers=new a.L(256),this._empty=!0,this._edgesRenderers=new a.b(16),this._scene=K,this.opaqueSortCompareFn=D,this.alphaTestSortCompareFn=G,this.transparentSortCompareFn=N}render(t,K,D,a){if(t)return void t(this._opaqueSubMeshes,this._alphaTestSubMeshes,this._transparentSubMeshes,this._depthOnlySubMeshes);const G=this._scene.getEngine();0!==this._depthOnlySubMeshes.length&&(G.setColorWrite(!1),this._renderAlphaTest(this._depthOnlySubMeshes),G.setColorWrite(!0)),0!==this._opaqueSubMeshes.length&&this._renderOpaque(this._opaqueSubMeshes),0!==this._alphaTestSubMeshes.length&&this._renderAlphaTest(this._alphaTestSubMeshes);const N=G.getStencilBuffer();if(G.setStencilBuffer(!1),K&&this._renderSprites(),D&&this._renderParticles(a),this.onBeforeTransparentRendering&&this.onBeforeTransparentRendering(),0!==this._transparentSubMeshes.length||this._scene.useOrderIndependentTransparency){if(G.setStencilBuffer(N),this._scene.useOrderIndependentTransparency){const t=this._scene.depthPeelingRenderer.render(this._transparentSubMeshes);t.length&&this._renderTransparent(t)}else this._renderTransparent(this._transparentSubMeshes);G.setAlphaMode(0)}if(G.setStencilBuffer(!1),this._edgesRenderers.length){for(let t=0;t<this._edgesRenderers.length;t++)this._edgesRenderers.data[t].render();G.setAlphaMode(0)}G.setStencilBuffer(N)}_renderOpaqueSorted(t){N._RenderSorted(t,this._opaqueSortCompareFn,this._scene.activeCamera,!1)}_renderAlphaTestSorted(t){N._RenderSorted(t,this._alphaTestSortCompareFn,this._scene.activeCamera,!1)}_renderTransparentSorted(t){N._RenderSorted(t,this._transparentSortCompareFn,this._scene.activeCamera,!0)}static _RenderSorted(t,K,D,a){let W,x=0;const b=D?D.globalPosition:N._ZeroVector;if(a)for(;x<t.length;x++)W=t.data[x],W._alphaIndex=W.getMesh().alphaIndex,W._distanceToCamera=G.Pq.Distance(W.getBoundingInfo().boundingSphere.centerWorld,b);const n=t.length===t.data.length?t.data:t.data.slice(0,t.length);K&&n.sort(K);const e=n[0].getMesh().getScene();for(x=0;x<n.length;x++)if(W=n[x],!e._activeMeshesFrozenButKeepClipping||W.isInFrustum(e._frustumPlanes)){if(a){const t=W.getMaterial();if(t&&t.needDepthPrePass){const K=t.getScene().getEngine();K.setColorWrite(!1),K.setAlphaMode(0),W.render(!1),K.setColorWrite(!0)}}W.render(a)}}static defaultTransparentSortCompare(t,K){return t._alphaIndex>K._alphaIndex?1:t._alphaIndex<K._alphaIndex?-1:N.backToFrontSortCompare(t,K)}static backToFrontSortCompare(t,K){return t._distanceToCamera<K._distanceToCamera?1:t._distanceToCamera>K._distanceToCamera?-1:0}static frontToBackSortCompare(t,K){return t._distanceToCamera<K._distanceToCamera?-1:t._distanceToCamera>K._distanceToCamera?1:0}static PainterSortCompare(t,K){const D=t.getMesh(),a=K.getMesh();return D.material&&a.material?D.material.uniqueId-a.material.uniqueId:D.uniqueId-a.uniqueId}prepare(){this._opaqueSubMeshes.reset(),this._transparentSubMeshes.reset(),this._alphaTestSubMeshes.reset(),this._depthOnlySubMeshes.reset(),this._particleSystems.reset(),this.prepareSprites(),this._edgesRenderers.reset(),this._empty=!0}prepareSprites(){this._spriteManagers.reset()}dispose(){this._opaqueSubMeshes.dispose(),this._transparentSubMeshes.dispose(),this._alphaTestSubMeshes.dispose(),this._depthOnlySubMeshes.dispose(),this._particleSystems.dispose(),this._spriteManagers.dispose(),this._edgesRenderers.dispose()}dispatch(t,K,D){void 0===K&&(K=t.getMesh()),void 0===D&&(D=t.getMaterial()),null!=D&&(D.needAlphaBlendingForMesh(K)?this._transparentSubMeshes.push(t):D.needAlphaTesting()?(D.needDepthPrePass&&this._depthOnlySubMeshes.push(t),this._alphaTestSubMeshes.push(t)):(D.needDepthPrePass&&this._depthOnlySubMeshes.push(t),this._opaqueSubMeshes.push(t)),K._renderingGroup=this,K._edgesRenderer&&K.isEnabled()&&K.isVisible&&K._edgesRenderer.isEnabled&&this._edgesRenderers.pushNoDuplicate(K._edgesRenderer),this._empty=!1)}dispatchSprites(t){this._spriteManagers.push(t),this._empty=!1}dispatchParticles(t){this._particleSystems.push(t),this._empty=!1}_renderParticles(t){if(0===this._particleSystems.length)return;const K=this._scene.activeCamera;this._scene.onBeforeParticlesRenderingObservable.notifyObservers(this._scene);for(let D=0;D<this._particleSystems.length;D++){const a=this._particleSystems.data[D];if(0===(K&&K.layerMask&a.layerMask))continue;const G=a.emitter;G.position&&t&&-1===t.indexOf(G)||this._scene._activeParticles.addCount(a.render(),!1)}this._scene.onAfterParticlesRenderingObservable.notifyObservers(this._scene)}_renderSprites(){if(!this._scene.spritesEnabled||0===this._spriteManagers.length)return;const t=this._scene.activeCamera;this._scene.onBeforeSpritesRenderingObservable.notifyObservers(this._scene);for(let K=0;K<this._spriteManagers.length;K++){const D=this._spriteManagers.data[K];0!==(t&&t.layerMask&D.layerMask)&&D.render()}this._scene.onAfterSpritesRenderingObservable.notifyObservers(this._scene)}}N._ZeroVector=G.Pq.Zero()},809319:(t,K,D)=>{D.d(K,{m:()=>N});var a=D(267255);class G{}class N{get maintainStateBetweenFrames(){return this._maintainStateBetweenFrames}set maintainStateBetweenFrames(t){t!==this._maintainStateBetweenFrames&&(this._maintainStateBetweenFrames=t,this._maintainStateBetweenFrames||this.restoreDispachedFlags())}restoreDispachedFlags(){for(const t of this._scene.meshes)if(t.subMeshes)for(const K of t.subMeshes)K._wasDispatched=!1;if(this._scene.spriteManagers)for(const t of this._scene.spriteManagers)t._wasDispatched=!1;for(const t of this._scene.particleSystems)t._wasDispatched=!1}constructor(t){this._useSceneAutoClearSetup=!1,this._renderingGroups=new Array,this._autoClearDepthStencil={},this._customOpaqueSortCompareFn={},this._customAlphaTestSortCompareFn={},this._customTransparentSortCompareFn={},this._renderingGroupInfo=new G,this._maintainStateBetweenFrames=!1,this._scene=t;for(let t=N.MIN_RENDERINGGROUPS;t<N.MAX_RENDERINGGROUPS;t++)this._autoClearDepthStencil[t]={autoClear:!0,depth:!0,stencil:!0}}getRenderingGroup(t){const K=t||0;return this._prepareRenderingGroup(K),this._renderingGroups[K]}_clearDepthStencilBuffer(t=!0,K=!0){this._depthStencilBufferAlreadyCleaned||(this._scene.getEngine().clear(null,!1,t,K),this._depthStencilBufferAlreadyCleaned=!0)}render(t,K,D,a){const G=this._renderingGroupInfo;if(G.scene=this._scene,G.camera=this._scene.activeCamera,this._scene.spriteManagers&&a)for(let t=0;t<this._scene.spriteManagers.length;t++){const K=this._scene.spriteManagers[t];this.dispatchSprites(K)}for(let W=N.MIN_RENDERINGGROUPS;W<N.MAX_RENDERINGGROUPS;W++){this._depthStencilBufferAlreadyCleaned=W===N.MIN_RENDERINGGROUPS;const x=this._renderingGroups[W];if(!x||x._empty)continue;const b=1<<W;if(G.renderingGroupId=W,this._scene.onBeforeRenderingGroupObservable.notifyObservers(G,b),N.AUTOCLEAR){const t=this._useSceneAutoClearSetup?this._scene.getAutoClearDepthStencilSetup(W):this._autoClearDepthStencil[W];t&&t.autoClear&&this._clearDepthStencilBuffer(t.depth,t.stencil)}for(const t of this._scene._beforeRenderingGroupDrawStage)t.action(W);x.render(t,a,D,K);for(const t of this._scene._afterRenderingGroupDrawStage)t.action(W);this._scene.onAfterRenderingGroupObservable.notifyObservers(G,b)}}reset(){if(!this.maintainStateBetweenFrames)for(let t=N.MIN_RENDERINGGROUPS;t<N.MAX_RENDERINGGROUPS;t++){const K=this._renderingGroups[t];K&&K.prepare()}}resetSprites(){if(!this.maintainStateBetweenFrames)for(let t=N.MIN_RENDERINGGROUPS;t<N.MAX_RENDERINGGROUPS;t++){const K=this._renderingGroups[t];K&&K.prepareSprites()}}dispose(){this.freeRenderingGroups(),this._renderingGroups.length=0,this._renderingGroupInfo=null}freeRenderingGroups(){for(let t=N.MIN_RENDERINGGROUPS;t<N.MAX_RENDERINGGROUPS;t++){const K=this._renderingGroups[t];K&&K.dispose()}}_prepareRenderingGroup(t){void 0===this._renderingGroups[t]&&(this._renderingGroups[t]=new a.U(t,this._scene,this._customOpaqueSortCompareFn[t],this._customAlphaTestSortCompareFn[t],this._customTransparentSortCompareFn[t]))}dispatchSprites(t){this.maintainStateBetweenFrames&&t._wasDispatched||(t._wasDispatched=!0,this.getRenderingGroup(t.renderingGroupId).dispatchSprites(t))}dispatchParticles(t){this.maintainStateBetweenFrames&&t._wasDispatched||(t._wasDispatched=!0,this.getRenderingGroup(t.renderingGroupId).dispatchParticles(t))}dispatch(t,K,D){void 0===K&&(K=t.getMesh()),this.maintainStateBetweenFrames&&t._wasDispatched||(t._wasDispatched=!0,this.getRenderingGroup(K.renderingGroupId).dispatch(t,K,D))}setRenderingOrder(t,K=null,D=null,a=null){if(this._customOpaqueSortCompareFn[t]=K,this._customAlphaTestSortCompareFn[t]=D,this._customTransparentSortCompareFn[t]=a,this._renderingGroups[t]){const K=this._renderingGroups[t];K.opaqueSortCompareFn=this._customOpaqueSortCompareFn[t],K.alphaTestSortCompareFn=this._customAlphaTestSortCompareFn[t],K.transparentSortCompareFn=this._customTransparentSortCompareFn[t]}}setRenderingAutoClearDepthStencil(t,K,D=!0,a=!0){this._autoClearDepthStencil[t]={autoClear:K,depth:D,stencil:a}}getAutoClearDepthStencilSetup(t){return this._autoClearDepthStencil[t]}}N.MAX_RENDERINGGROUPS=4,N.MIN_RENDERINGGROUPS=0,N.AUTOCLEAR=!0},243806:(t,K,D)=>{const a=`#ifdef BAKED_VERTEX_ANIMATION_TEXTURE\n{\n#ifdef INSTANCES\n#define BVASNAME bakedVertexAnimationSettingsInstanced\n#else\n#define BVASNAME bakedVertexAnimationSettings\n#endif\nfloat VATStartFrame=BVASNAME.x;float VATEndFrame=BVASNAME.y;float VATOffsetFrame=BVASNAME.z;float VATSpeed=BVASNAME.w;float totalFrames=VATEndFrame-VATStartFrame+1.0;float time=bakedVertexAnimationTime*VATSpeed/totalFrames;float frameCorrection=time<1.0 ? 0.0 : 1.0;float numOfFrames=totalFrames-frameCorrection;float VATFrameNum=fract(time)*numOfFrames;VATFrameNum=mod(VATFrameNum+VATOffsetFrame,numOfFrames);VATFrameNum=floor(VATFrameNum);VATFrameNum+=VATStartFrame+frameCorrection;mat4 VATInfluence;VATInfluence=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[0],VATFrameNum)*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[1],VATFrameNum)*matricesWeights[1];\n#endif\n#if NUM_BONE_INFLUENCERS>2\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[2],VATFrameNum)*matricesWeights[2];\n#endif\n#if NUM_BONE_INFLUENCERS>3\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[3],VATFrameNum)*matricesWeights[3];\n#endif\n#if NUM_BONE_INFLUENCERS>4\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[0],VATFrameNum)*matricesWeightsExtra[0];\n#endif\n#if NUM_BONE_INFLUENCERS>5\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[1],VATFrameNum)*matricesWeightsExtra[1];\n#endif\n#if NUM_BONE_INFLUENCERS>6\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[2],VATFrameNum)*matricesWeightsExtra[2];\n#endif\n#if NUM_BONE_INFLUENCERS>7\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[3],VATFrameNum)*matricesWeightsExtra[3];\n#endif\nfinalWorld=finalWorld*VATInfluence;}\n#endif\n`;D(395879).l.IncludesShadersStore["bakedVertexAnimation"]=a},191544:(t,K,D)=>{const a=`#ifdef BAKED_VERTEX_ANIMATION_TEXTURE\nuniform float bakedVertexAnimationTime;uniform vec2 bakedVertexAnimationTextureSizeInverted;uniform vec4 bakedVertexAnimationSettings;uniform sampler2D bakedVertexAnimationTexture;\n#ifdef INSTANCES\nattribute vec4 bakedVertexAnimationSettingsInstanced;\n#endif\n#define inline\nmat4 readMatrixFromRawSamplerVAT(sampler2D smp,float index,float frame)\n{float offset=index*4.0;float frameUV=(frame+0.5)*bakedVertexAnimationTextureSizeInverted.y;float dx=bakedVertexAnimationTextureSizeInverted.x;vec4 m0=texture2D(smp,vec2(dx*(offset+0.5),frameUV));vec4 m1=texture2D(smp,vec2(dx*(offset+1.5),frameUV));vec4 m2=texture2D(smp,vec2(dx*(offset+2.5),frameUV));vec4 m3=texture2D(smp,vec2(dx*(offset+3.5),frameUV));return mat4(m0,m1,m2,m3);}\n#endif\n`;D(395879).l.IncludesShadersStore["bakedVertexAnimationDeclaration"]=a},17106:(t,K,D)=>{const a=`#if NUM_BONE_INFLUENCERS>0\nattribute vec4 matricesIndices;attribute vec4 matricesWeights;\n#if NUM_BONE_INFLUENCERS>4\nattribute vec4 matricesIndicesExtra;attribute vec4 matricesWeightsExtra;\n#endif\n#ifndef BAKED_VERTEX_ANIMATION_TEXTURE\n#ifdef BONETEXTURE\nuniform highp sampler2D boneSampler;uniform float boneTextureWidth;\n#else\nuniform mat4 mBones[BonesPerMesh];\n#endif\n#ifdef BONES_VELOCITY_ENABLED\nuniform mat4 mPreviousBones[BonesPerMesh];\n#endif\n#ifdef BONETEXTURE\n#define inline\nmat4 readMatrixFromRawSampler(sampler2D smp,float index)\n{float offset=index *4.0;float dx=1.0/boneTextureWidth;vec4 m0=texture2D(smp,vec2(dx*(offset+0.5),0.));vec4 m1=texture2D(smp,vec2(dx*(offset+1.5),0.));vec4 m2=texture2D(smp,vec2(dx*(offset+2.5),0.));vec4 m3=texture2D(smp,vec2(dx*(offset+3.5),0.));return mat4(m0,m1,m2,m3);}\n#endif\n#endif\n#endif\n`;D(395879).l.IncludesShadersStore["bonesDeclaration"]=a},132434:(t,K,D)=>{const a=`#ifndef BAKED_VERTEX_ANIMATION_TEXTURE\n#if NUM_BONE_INFLUENCERS>0\nmat4 influence;\n#ifdef BONETEXTURE\ninfluence=readMatrixFromRawSampler(boneSampler,matricesIndices[0])*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndices[1])*matricesWeights[1];\n#endif\n#if NUM_BONE_INFLUENCERS>2\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndices[2])*matricesWeights[2];\n#endif\n#if NUM_BONE_INFLUENCERS>3\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndices[3])*matricesWeights[3];\n#endif\n#if NUM_BONE_INFLUENCERS>4\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[0])*matricesWeightsExtra[0];\n#endif\n#if NUM_BONE_INFLUENCERS>5\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[1])*matricesWeightsExtra[1];\n#endif\n#if NUM_BONE_INFLUENCERS>6\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[2])*matricesWeightsExtra[2];\n#endif\n#if NUM_BONE_INFLUENCERS>7\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[3])*matricesWeightsExtra[3];\n#endif\n#else\ninfluence=mBones[int(matricesIndices[0])]*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\ninfluence+=mBones[int(matricesIndices[1])]*matricesWeights[1];\n#endif\n#if NUM_BONE_INFLUENCERS>2\ninfluence+=mBones[int(matricesIndices[2])]*matricesWeights[2];\n#endif\n#if NUM_BONE_INFLUENCERS>3\ninfluence+=mBones[int(matricesIndices[3])]*matricesWeights[3];\n#endif\n#if NUM_BONE_INFLUENCERS>4\ninfluence+=mBones[int(matricesIndicesExtra[0])]*matricesWeightsExtra[0];\n#endif\n#if NUM_BONE_INFLUENCERS>5\ninfluence+=mBones[int(matricesIndicesExtra[1])]*matricesWeightsExtra[1];\n#endif\n#if NUM_BONE_INFLUENCERS>6\ninfluence+=mBones[int(matricesIndicesExtra[2])]*matricesWeightsExtra[2];\n#endif\n#if NUM_BONE_INFLUENCERS>7\ninfluence+=mBones[int(matricesIndicesExtra[3])]*matricesWeightsExtra[3];\n#endif\n#endif\nfinalWorld=finalWorld*influence;\n#endif\n#endif\n`;D(395879).l.IncludesShadersStore["bonesVertex"]=a},215327:(t,K,D)=>{const a=`#if defined(CLIPPLANE) || defined(CLIPPLANE2) || defined(CLIPPLANE3) || defined(CLIPPLANE4) || defined(CLIPPLANE5) || defined(CLIPPLANE6)\nif (false) {}\n#endif\n#ifdef CLIPPLANE\nelse if (fClipDistance>0.0)\n{discard;}\n#endif\n#ifdef CLIPPLANE2\nelse if (fClipDistance2>0.0)\n{discard;}\n#endif\n#ifdef CLIPPLANE3\nelse if (fClipDistance3>0.0)\n{discard;}\n#endif\n#ifdef CLIPPLANE4\nelse if (fClipDistance4>0.0)\n{discard;}\n#endif\n#ifdef CLIPPLANE5\nelse if (fClipDistance5>0.0)\n{discard;}\n#endif\n#ifdef CLIPPLANE6\nelse if (fClipDistance6>0.0)\n{discard;}\n#endif\n`;D(395879).l.IncludesShadersStore["clipPlaneFragment"]=a},733251:(t,K,D)=>{const a=`#ifdef CLIPPLANE\nvarying float fClipDistance;\n#endif\n#ifdef CLIPPLANE2\nvarying float fClipDistance2;\n#endif\n#ifdef CLIPPLANE3\nvarying float fClipDistance3;\n#endif\n#ifdef CLIPPLANE4\nvarying float fClipDistance4;\n#endif\n#ifdef CLIPPLANE5\nvarying float fClipDistance5;\n#endif\n#ifdef CLIPPLANE6\nvarying float fClipDistance6;\n#endif\n`;D(395879).l.IncludesShadersStore["clipPlaneFragmentDeclaration"]=a},929801:(t,K,D)=>{const a=`#ifdef CLIPPLANE\nfClipDistance=dot(worldPos,vClipPlane);\n#endif\n#ifdef CLIPPLANE2\nfClipDistance2=dot(worldPos,vClipPlane2);\n#endif\n#ifdef CLIPPLANE3\nfClipDistance3=dot(worldPos,vClipPlane3);\n#endif\n#ifdef CLIPPLANE4\nfClipDistance4=dot(worldPos,vClipPlane4);\n#endif\n#ifdef CLIPPLANE5\nfClipDistance5=dot(worldPos,vClipPlane5);\n#endif\n#ifdef CLIPPLANE6\nfClipDistance6=dot(worldPos,vClipPlane6);\n#endif\n`;D(395879).l.IncludesShadersStore["clipPlaneVertex"]=a},602105:(t,K,D)=>{const a=`#ifdef CLIPPLANE\nuniform vec4 vClipPlane;varying float fClipDistance;\n#endif\n#ifdef CLIPPLANE2\nuniform vec4 vClipPlane2;varying float fClipDistance2;\n#endif\n#ifdef CLIPPLANE3\nuniform vec4 vClipPlane3;varying float fClipDistance3;\n#endif\n#ifdef CLIPPLANE4\nuniform vec4 vClipPlane4;varying float fClipDistance4;\n#endif\n#ifdef CLIPPLANE5\nuniform vec4 vClipPlane5;varying float fClipDistance5;\n#endif\n#ifdef CLIPPLANE6\nuniform vec4 vClipPlane6;varying float fClipDistance6;\n#endif\n`;D(395879).l.IncludesShadersStore["clipPlaneVertexDeclaration"]=a},489974:(t,K,D)=>{const a=`#ifdef NUM_SAMPLES\n#if NUM_SAMPLES>0\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\nfloat radicalInverse_VdC(uint bits) \n{bits=(bits<<16u) | (bits>>16u);bits=((bits & 0x55555555u)<<1u) | ((bits & 0xAAAAAAAAu)>>1u);bits=((bits & 0x33333333u)<<2u) | ((bits & 0xCCCCCCCCu)>>2u);bits=((bits & 0x0F0F0F0Fu)<<4u) | ((bits & 0xF0F0F0F0u)>>4u);bits=((bits & 0x00FF00FFu)<<8u) | ((bits & 0xFF00FF00u)>>8u);return float(bits)*2.3283064365386963e-10; }\nvec2 hammersley(uint i,uint N)\n{return vec2(float(i)/float(N),radicalInverse_VdC(i));}\n#else\nfloat vanDerCorpus(int n,int base)\n{float invBase=1.0/float(base);float denom =1.0;float result =0.0;for(int i=0; i<32; ++i)\n{if(n>0)\n{denom =mod(float(n),2.0);result+=denom*invBase;invBase=invBase/2.0;n =int(float(n)/2.0);}}\nreturn result;}\nvec2 hammersley(int i,int N)\n{return vec2(float(i)/float(N),vanDerCorpus(i,2));}\n#endif\nfloat log4(float x) {return log2(x)/2.;}\nconst float NUM_SAMPLES_FLOAT=float(NUM_SAMPLES);const float NUM_SAMPLES_FLOAT_INVERSED=1./NUM_SAMPLES_FLOAT;const float K=4.;\n#define inline\nvec3 irradiance(samplerCube inputTexture,vec3 inputN,vec2 filteringInfo)\n{vec3 n=normalize(inputN);vec3 result=vec3(0.0);vec3 tangent=abs(n.z)<0.999 ? vec3(0.,0.,1.) : vec3(1.,0.,0.);tangent=normalize(cross(tangent,n));vec3 bitangent=cross(n,tangent);mat3 tbn=mat3(tangent,bitangent,n);float maxLevel=filteringInfo.y;float dim0=filteringInfo.x;float omegaP=(4.*PI)/(6.*dim0*dim0);\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\nfor(uint i=0u; i<NUM_SAMPLES; ++i)\n#else\nfor(int i=0; i<NUM_SAMPLES; ++i)\n#endif\n{vec2 Xi=hammersley(i,NUM_SAMPLES);vec3 Ls=hemisphereCosSample(Xi);Ls=normalize(Ls);vec3 Ns=vec3(0.,0.,1.);float NoL=dot(Ns,Ls);if (NoL>0.) {float pdf_inversed=PI/NoL;float omegaS=NUM_SAMPLES_FLOAT_INVERSED*pdf_inversed;float l=log4(omegaS)-log4(omegaP)+log4(K);float mipLevel=clamp(l,0.0,maxLevel);vec3 c=textureCubeLodEXT(inputTexture,tbn*Ls,mipLevel).rgb;\n#ifdef GAMMA_INPUT\nc=toLinearSpace(c);\n#endif\nresult+=c;}}\nresult=result*NUM_SAMPLES_FLOAT_INVERSED;return result;}\n#define inline\nvec3 radiance(float alphaG,samplerCube inputTexture,vec3 inputN,vec2 filteringInfo)\n{vec3 n=normalize(inputN);vec3 c=textureCube(inputTexture,n).rgb; \nif (alphaG==0.) {\n#ifdef GAMMA_INPUT\nc=toLinearSpace(c);\n#endif\nreturn c;} else {vec3 result=vec3(0.);vec3 tangent=abs(n.z)<0.999 ? vec3(0.,0.,1.) : vec3(1.,0.,0.);tangent=normalize(cross(tangent,n));vec3 bitangent=cross(n,tangent);mat3 tbn=mat3(tangent,bitangent,n);float maxLevel=filteringInfo.y;float dim0=filteringInfo.x;float omegaP=(4.*PI)/(6.*dim0*dim0);float weight=0.;\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\nfor(uint i=0u; i<NUM_SAMPLES; ++i)\n#else\nfor(int i=0; i<NUM_SAMPLES; ++i)\n#endif\n{vec2 Xi=hammersley(i,NUM_SAMPLES);vec3 H=hemisphereImportanceSampleDggx(Xi,alphaG);float NoV=1.;float NoH=H.z;float NoH2=H.z*H.z;float NoL=2.*NoH2-1.;vec3 L=vec3(2.*NoH*H.x,2.*NoH*H.y,NoL);L=normalize(L);if (NoL>0.) {float pdf_inversed=4./normalDistributionFunction_TrowbridgeReitzGGX(NoH,alphaG);float omegaS=NUM_SAMPLES_FLOAT_INVERSED*pdf_inversed;float l=log4(omegaS)-log4(omegaP)+log4(K);float mipLevel=clamp(float(l),0.0,maxLevel);weight+=NoL;vec3 c=textureCubeLodEXT(inputTexture,tbn*L,mipLevel).rgb;\n#ifdef GAMMA_INPUT\nc=toLinearSpace(c);\n#endif\nresult+=c*NoL;}}\nresult=result/weight;return result;}}\n#endif\n#endif\n`;D(395879).l.IncludesShadersStore["hdrFilteringFunctions"]=a},485914:(t,K,D)=>{const a=`const float PI=3.1415926535897932384626433832795;const float RECIPROCAL_PI=0.3183098861837907;const float RECIPROCAL_PI2=0.15915494309189535;const float HALF_MIN=5.96046448e-08; \nconst float LinearEncodePowerApprox=2.2;const float GammaEncodePowerApprox=1.0/LinearEncodePowerApprox;const vec3 LuminanceEncodeApprox=vec3(0.2126,0.7152,0.0722);const float Epsilon=0.0000001;\n#define saturate(x) clamp(x,0.0,1.0)\n#define absEps(x) abs(x)+Epsilon\n#define maxEps(x) max(x,Epsilon)\n#define saturateEps(x) clamp(x,Epsilon,1.0)\nmat3 transposeMat3(mat3 inMatrix) {vec3 i0=inMatrix[0];vec3 i1=inMatrix[1];vec3 i2=inMatrix[2];mat3 outMatrix=mat3(\nvec3(i0.x,i1.x,i2.x),\nvec3(i0.y,i1.y,i2.y),\nvec3(i0.z,i1.z,i2.z)\n);return outMatrix;}\nmat3 inverseMat3(mat3 inMatrix) {float a00=inMatrix[0][0],a01=inMatrix[0][1],a02=inMatrix[0][2];float a10=inMatrix[1][0],a11=inMatrix[1][1],a12=inMatrix[1][2];float a20=inMatrix[2][0],a21=inMatrix[2][1],a22=inMatrix[2][2];float b01=a22*a11-a12*a21;float b11=-a22*a10+a12*a20;float b21=a21*a10-a11*a20;float det=a00*b01+a01*b11+a02*b21;return mat3(b01,(-a22*a01+a02*a21),(a12*a01-a02*a11),\nb11,(a22*a00-a02*a20),(-a12*a00+a02*a10),\nb21,(-a21*a00+a01*a20),(a11*a00-a01*a10))/det;}\n#if USE_EXACT_SRGB_CONVERSIONS\nvec3 toLinearSpaceExact(vec3 color)\n{vec3 nearZeroSection=0.0773993808*color;vec3 remainingSection=pow(0.947867299*(color+vec3(0.055)),vec3(2.4));\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\nreturn mix(remainingSection,nearZeroSection,lessThanEqual(color,vec3(0.04045)));\n#else\nreturn\nvec3(\ncolor.r<=0.04045 ? nearZeroSection.r : remainingSection.r,\ncolor.g<=0.04045 ? nearZeroSection.g : remainingSection.g,\ncolor.b<=0.04045 ? nearZeroSection.b : remainingSection.b);\n#endif\n}\nvec3 toGammaSpaceExact(vec3 color)\n{vec3 nearZeroSection=12.92*color;vec3 remainingSection=1.055*pow(color,vec3(0.41666))-vec3(0.055);\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\nreturn mix(remainingSection,nearZeroSection,lessThanEqual(color,vec3(0.0031308)));\n#else\nreturn\nvec3(\ncolor.r<=0.0031308 ? nearZeroSection.r : remainingSection.r,\ncolor.g<=0.0031308 ? nearZeroSection.g : remainingSection.g,\ncolor.b<=0.0031308 ? nearZeroSection.b : remainingSection.b);\n#endif\n}\n#endif\nfloat toLinearSpace(float color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nfloat nearZeroSection=0.0773993808*color;float remainingSection=pow(0.947867299*(color+0.055),2.4);return color<=0.04045 ? nearZeroSection : remainingSection;\n#else\nreturn pow(color,LinearEncodePowerApprox);\n#endif\n}\nvec3 toLinearSpace(vec3 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn toLinearSpaceExact(color);\n#else\nreturn pow(color,vec3(LinearEncodePowerApprox));\n#endif\n}\nvec4 toLinearSpace(vec4 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn vec4(toLinearSpaceExact(color.rgb),color.a);\n#else\nreturn vec4(pow(color.rgb,vec3(LinearEncodePowerApprox)),color.a);\n#endif\n}\nfloat toGammaSpace(float color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nfloat nearZeroSection=12.92*color;float remainingSection=1.055*pow(color,0.41666)-0.055;return color<=0.0031308 ? nearZeroSection : remainingSection;\n#else\nreturn pow(color,GammaEncodePowerApprox);\n#endif\n}\nvec3 toGammaSpace(vec3 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn toGammaSpaceExact(color);\n#else\nreturn pow(color,vec3(GammaEncodePowerApprox));\n#endif\n}\nvec4 toGammaSpace(vec4 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn vec4(toGammaSpaceExact(color.rgb),color.a);\n#else\nreturn vec4(pow(color.rgb,vec3(GammaEncodePowerApprox)),color.a);\n#endif\n}\nfloat square(float value)\n{return value*value;}\nvec3 square(vec3 value)\n{return value*value;}\nfloat pow5(float value) {float sq=value*value;return sq*sq*value;}\nfloat getLuminance(vec3 color)\n{return clamp(dot(color,LuminanceEncodeApprox),0.,1.);}\nfloat getRand(vec2 seed) {return fract(sin(dot(seed.xy ,vec2(12.9898,78.233)))*43758.5453);}\nfloat dither(vec2 seed,float varianceAmount) {float rand=getRand(seed);float normVariance=varianceAmount/255.0;float dither=mix(-normVariance,normVariance,rand);return dither;}\nconst float rgbdMaxRange=255.0;vec4 toRGBD(vec3 color) {float maxRGB=maxEps(max(color.r,max(color.g,color.b)));float D =max(rgbdMaxRange/maxRGB,1.);D =clamp(floor(D)/255.0,0.,1.);vec3 rgb=color.rgb*D;rgb=toGammaSpace(rgb);return vec4(clamp(rgb,0.,1.),D); }\nvec3 fromRGBD(vec4 rgbd) {rgbd.rgb=toLinearSpace(rgbd.rgb);return rgbd.rgb/rgbd.a;}\nvec3 parallaxCorrectNormal( vec3 vertexPos,vec3 origVec,vec3 cubeSize,vec3 cubePos ) {vec3 invOrigVec=vec3(1.0,1.0,1.0)/origVec;vec3 halfSize=cubeSize*0.5;vec3 intersecAtMaxPlane=(cubePos+halfSize-vertexPos)*invOrigVec;vec3 intersecAtMinPlane=(cubePos-halfSize-vertexPos)*invOrigVec;vec3 largestIntersec=max(intersecAtMaxPlane,intersecAtMinPlane);float distance=min(min(largestIntersec.x,largestIntersec.y),largestIntersec.z);vec3 intersectPositionWS=vertexPos+origVec*distance;return intersectPositionWS-cubePos;}\n`;D(395879).l.IncludesShadersStore["helperFunctions"]=a},368668:(t,K,D)=>{const a=`vec3 hemisphereCosSample(vec2 u) {float phi=2.*PI*u.x;float cosTheta2=1.-u.y;float cosTheta=sqrt(cosTheta2);float sinTheta=sqrt(1.-cosTheta2);return vec3(sinTheta*cos(phi),sinTheta*sin(phi),cosTheta);}\nvec3 hemisphereImportanceSampleDggx(vec2 u,float a) {float phi=2.*PI*u.x;float cosTheta2=(1.-u.y)/(1.+(a+1.)*((a-1.)*u.y));float cosTheta=sqrt(cosTheta2);float sinTheta=sqrt(1.-cosTheta2);return vec3(sinTheta*cos(phi),sinTheta*sin(phi),cosTheta);}\nvec3 hemisphereImportanceSampleDCharlie(vec2 u,float a) { \nfloat phi=2.*PI*u.x;float sinTheta=pow(u.y,a/(2.*a+1.));float cosTheta=sqrt(1.-sinTheta*sinTheta);return vec3(sinTheta*cos(phi),sinTheta*sin(phi),cosTheta);}`;D(395879).l.IncludesShadersStore["importanceSampling"]=a},427139:(t,K,D)=>{const a=`#ifdef INSTANCES\nattribute vec4 world0;attribute vec4 world1;attribute vec4 world2;attribute vec4 world3;\n#ifdef INSTANCESCOLOR\nattribute vec4 instanceColor;\n#endif\n#if defined(THIN_INSTANCES) && !defined(WORLD_UBO)\nuniform mat4 world;\n#endif\n#if defined(VELOCITY) || defined(PREPASS_VELOCITY) || defined(PREPASS_VELOCITY_LINEAR)\nattribute vec4 previousWorld0;attribute vec4 previousWorld1;attribute vec4 previousWorld2;attribute vec4 previousWorld3;\n#ifdef THIN_INSTANCES\nuniform mat4 previousWorld;\n#endif\n#endif\n#else\n#if !defined(WORLD_UBO)\nuniform mat4 world;\n#endif\n#if defined(VELOCITY) || defined(PREPASS_VELOCITY) || defined(PREPASS_VELOCITY_LINEAR)\nuniform mat4 previousWorld;\n#endif\n#endif\n`;D(395879).l.IncludesShadersStore["instancesDeclaration"]=a},216313:(t,K,D)=>{const a=`#ifdef INSTANCES\nmat4 finalWorld=mat4(world0,world1,world2,world3);\n#if defined(PREPASS_VELOCITY) || defined(VELOCITY) || defined(PREPASS_VELOCITY_LINEAR)\nmat4 finalPreviousWorld=mat4(previousWorld0,previousWorld1,\npreviousWorld2,previousWorld3);\n#endif\n#ifdef THIN_INSTANCES\nfinalWorld=world*finalWorld;\n#if defined(PREPASS_VELOCITY) || defined(VELOCITY) || defined(PREPASS_VELOCITY_LINEAR)\nfinalPreviousWorld=previousWorld*finalPreviousWorld;\n#endif\n#endif\n#else\nmat4 finalWorld=world;\n#if defined(PREPASS_VELOCITY) || defined(VELOCITY) || defined(PREPASS_VELOCITY_LINEAR)\nmat4 finalPreviousWorld=previousWorld;\n#endif\n#endif\n`;D(395879).l.IncludesShadersStore["instancesVertex"]=a},265917:(t,K,D)=>{const a=`#ifdef MORPHTARGETS\n#ifdef MORPHTARGETS_TEXTURE\n#if {X}==0\nfor (int i=0; i<NUM_MORPH_INFLUENCERS; i++) {if (i>=morphTargetCount) break;vertexID=float(gl_VertexID)*morphTargetTextureInfo.x;positionUpdated+=(readVector3FromRawSampler(i,vertexID)-position)*morphTargetInfluences[i];vertexID+=1.0;\n#ifdef MORPHTARGETS_NORMAL\nnormalUpdated+=(readVector3FromRawSampler(i,vertexID) -normal)*morphTargetInfluences[i];vertexID+=1.0;\n#endif\n#ifdef MORPHTARGETS_UV\nuvUpdated+=(readVector3FromRawSampler(i,vertexID).xy-uv)*morphTargetInfluences[i];vertexID+=1.0;\n#endif\n#ifdef MORPHTARGETS_TANGENT\ntangentUpdated.xyz+=(readVector3FromRawSampler(i,vertexID) -tangent.xyz)*morphTargetInfluences[i];\n#endif\n}\n#endif\n#else\npositionUpdated+=(position{X}-position)*morphTargetInfluences[{X}];\n#ifdef MORPHTARGETS_NORMAL\nnormalUpdated+=(normal{X}-normal)*morphTargetInfluences[{X}];\n#endif\n#ifdef MORPHTARGETS_TANGENT\ntangentUpdated.xyz+=(tangent{X}-tangent.xyz)*morphTargetInfluences[{X}];\n#endif\n#ifdef MORPHTARGETS_UV\nuvUpdated+=(uv_{X}-uv)*morphTargetInfluences[{X}];\n#endif\n#endif\n#endif\n`;D(395879).l.IncludesShadersStore["morphTargetsVertex"]=a},419765:(t,K,D)=>{const a=`#ifdef MORPHTARGETS\n#ifndef MORPHTARGETS_TEXTURE\nattribute vec3 position{X};\n#ifdef MORPHTARGETS_NORMAL\nattribute vec3 normal{X};\n#endif\n#ifdef MORPHTARGETS_TANGENT\nattribute vec3 tangent{X};\n#endif\n#ifdef MORPHTARGETS_UV\nattribute vec2 uv_{X};\n#endif\n#elif {X}==0\nuniform int morphTargetCount;\n#endif\n#endif\n`;D(395879).l.IncludesShadersStore["morphTargetsVertexDeclaration"]=a},699110:(t,K,D)=>{const a=`#ifdef MORPHTARGETS\n#ifdef MORPHTARGETS_TEXTURE\nfloat vertexID;\n#endif\n#endif\n`;D(395879).l.IncludesShadersStore["morphTargetsVertexGlobal"]=a},467760:(t,K,D)=>{const a=`#ifdef MORPHTARGETS\nuniform float morphTargetInfluences[NUM_MORPH_INFLUENCERS];\n#ifdef MORPHTARGETS_TEXTURE \nuniform float morphTargetTextureIndices[NUM_MORPH_INFLUENCERS];uniform vec3 morphTargetTextureInfo;uniform highp sampler2DArray morphTargets;vec3 readVector3FromRawSampler(int targetIndex,float vertexIndex)\n{ \nfloat y=floor(vertexIndex/morphTargetTextureInfo.y);float x=vertexIndex-y*morphTargetTextureInfo.y;vec3 textureUV=vec3((x+0.5)/morphTargetTextureInfo.y,(y+0.5)/morphTargetTextureInfo.z,morphTargetTextureIndices[targetIndex]);return texture(morphTargets,textureUV).xyz;}\n#endif\n#endif\n`;D(395879).l.IncludesShadersStore["morphTargetsVertexGlobalDeclaration"]=a},728939:(t,K,D)=>{const a=`vec4 pack(float depth)\n{const vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const vec4 bit_mask=vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\nfloat unpack(vec4 color)\n{const vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(color,bit_shift);}`;D(395879).l.IncludesShadersStore["packingFunctions"]=a},950544:(t,K,D)=>{const a=`#define FRESNEL_MAXIMUM_ON_ROUGH 0.25\n#ifdef MS_BRDF_ENERGY_CONSERVATION\nvec3 getEnergyConservationFactor(const vec3 specularEnvironmentR0,const vec3 environmentBrdf) {return 1.0+specularEnvironmentR0*(1.0/environmentBrdf.y-1.0);}\n#endif\n#ifdef ENVIRONMENTBRDF\nvec3 getBRDFLookup(float NdotV,float perceptualRoughness) {vec2 UV=vec2(NdotV,perceptualRoughness);vec4 brdfLookup=texture2D(environmentBrdfSampler,UV);\n#ifdef ENVIRONMENTBRDF_RGBD\nbrdfLookup.rgb=fromRGBD(brdfLookup.rgba);\n#endif\nreturn brdfLookup.rgb;}\nvec3 getReflectanceFromBRDFLookup(const vec3 specularEnvironmentR0,const vec3 specularEnvironmentR90,const vec3 environmentBrdf) {\n#ifdef BRDF_V_HEIGHT_CORRELATED\nvec3 reflectance=(specularEnvironmentR90-specularEnvironmentR0)*environmentBrdf.x+specularEnvironmentR0*environmentBrdf.y;\n#else\nvec3 reflectance=specularEnvironmentR0*environmentBrdf.x+specularEnvironmentR90*environmentBrdf.y;\n#endif\nreturn reflectance;}\nvec3 getReflectanceFromBRDFLookup(const vec3 specularEnvironmentR0,const vec3 environmentBrdf) {\n#ifdef BRDF_V_HEIGHT_CORRELATED\nvec3 reflectance=mix(environmentBrdf.xxx,environmentBrdf.yyy,specularEnvironmentR0);\n#else\nvec3 reflectance=specularEnvironmentR0*environmentBrdf.x+environmentBrdf.y;\n#endif\nreturn reflectance;}\n#endif\n/* NOT USED\n#if defined(SHEEN) && defined(SHEEN_SOFTER)\nfloat getBRDFLookupCharlieSheen(float NdotV,float perceptualRoughness)\n{float c=1.0-NdotV;float c3=c*c*c;return 0.65584461*c3+1.0/(4.16526551+exp(-7.97291361*perceptualRoughness+6.33516894));}\n#endif\n*/\n#if !defined(ENVIRONMENTBRDF) || defined(REFLECTIONMAP_SKYBOX) || defined(ALPHAFRESNEL)\nvec3 getReflectanceFromAnalyticalBRDFLookup_Jones(float VdotN,vec3 reflectance0,vec3 reflectance90,float smoothness)\n{float weight=mix(FRESNEL_MAXIMUM_ON_ROUGH,1.0,smoothness);return reflectance0+weight*(reflectance90-reflectance0)*pow5(saturate(1.0-VdotN));}\n#endif\n#if defined(SHEEN) && defined(ENVIRONMENTBRDF)\n/**\n* The sheen BRDF not containing F can be easily stored in the blue channel of the BRDF texture.\n* The blue channel contains DCharlie*VAshikhmin*NdotL as a lokkup table\n*/\nvec3 getSheenReflectanceFromBRDFLookup(const vec3 reflectance0,const vec3 environmentBrdf) {vec3 sheenEnvironmentReflectance=reflectance0*environmentBrdf.b;return sheenEnvironmentReflectance;}\n#endif\nvec3 fresnelSchlickGGX(float VdotH,vec3 reflectance0,vec3 reflectance90)\n{return reflectance0+(reflectance90-reflectance0)*pow5(1.0-VdotH);}\nfloat fresnelSchlickGGX(float VdotH,float reflectance0,float reflectance90)\n{return reflectance0+(reflectance90-reflectance0)*pow5(1.0-VdotH);}\n#ifdef CLEARCOAT\nvec3 getR0RemappedForClearCoat(vec3 f0) {\n#ifdef CLEARCOAT_DEFAULTIOR\n#ifdef MOBILE\nreturn saturate(f0*(f0*0.526868+0.529324)-0.0482256);\n#else\nreturn saturate(f0*(f0*(0.941892-0.263008*f0)+0.346479)-0.0285998);\n#endif\n#else\nvec3 s=sqrt(f0);vec3 t=(vClearCoatRefractionParams.z+vClearCoatRefractionParams.w*s)/(vClearCoatRefractionParams.w+vClearCoatRefractionParams.z*s);return square(t);\n#endif\n}\n#endif\n#ifdef IRIDESCENCE\nconst mat3 XYZ_TO_REC709=mat3(\n3.2404542,-0.9692660, 0.0556434,\n-1.5371385, 1.8760108,-0.2040259,\n-0.4985314, 0.0415560, 1.0572252\n);vec3 getIORTfromAirToSurfaceR0(vec3 f0) {vec3 sqrtF0=sqrt(f0);return (1.+sqrtF0)/(1.-sqrtF0);}\nvec3 getR0fromIORs(vec3 iorT,float iorI) {return square((iorT-vec3(iorI))/(iorT+vec3(iorI)));}\nfloat getR0fromIORs(float iorT,float iorI) {return square((iorT-iorI)/(iorT+iorI));}\nvec3 evalSensitivity(float opd,vec3 shift) {float phase=2.0*PI*opd*1.0e-9;const vec3 val=vec3(5.4856e-13,4.4201e-13,5.2481e-13);const vec3 pos=vec3(1.6810e+06,1.7953e+06,2.2084e+06);const vec3 var=vec3(4.3278e+09,9.3046e+09,6.6121e+09);vec3 xyz=val*sqrt(2.0*PI*var)*cos(pos*phase+shift)*exp(-square(phase)*var);xyz.x+=9.7470e-14*sqrt(2.0*PI*4.5282e+09)*cos(2.2399e+06*phase+shift[0])*exp(-4.5282e+09*square(phase));xyz/=1.0685e-7;vec3 srgb=XYZ_TO_REC709*xyz;return srgb;}\nvec3 evalIridescence(float outsideIOR,float eta2,float cosTheta1,float thinFilmThickness,vec3 baseF0) {vec3 I=vec3(1.0);float iridescenceIOR=mix(outsideIOR,eta2,smoothstep(0.0,0.03,thinFilmThickness));float sinTheta2Sq=square(outsideIOR/iridescenceIOR)*(1.0-square(cosTheta1));float cosTheta2Sq=1.0-sinTheta2Sq;if (cosTheta2Sq<0.0) {return I;}\nfloat cosTheta2=sqrt(cosTheta2Sq);float R0=getR0fromIORs(iridescenceIOR,outsideIOR);float R12=fresnelSchlickGGX(cosTheta1,R0,1.);float R21=R12;float T121=1.0-R12;float phi12=0.0;if (iridescenceIOR<outsideIOR) phi12=PI;float phi21=PI-phi12;vec3 baseIOR=getIORTfromAirToSurfaceR0(clamp(baseF0,0.0,0.9999)); \nvec3 R1=getR0fromIORs(baseIOR,iridescenceIOR);vec3 R23=fresnelSchlickGGX(cosTheta2,R1,vec3(1.));vec3 phi23=vec3(0.0);if (baseIOR[0]<iridescenceIOR) phi23[0]=PI;if (baseIOR[1]<iridescenceIOR) phi23[1]=PI;if (baseIOR[2]<iridescenceIOR) phi23[2]=PI;float opd=2.0*iridescenceIOR*thinFilmThickness*cosTheta2;vec3 phi=vec3(phi21)+phi23;vec3 R123=clamp(R12*R23,1e-5,0.9999);vec3 r123=sqrt(R123);vec3 Rs=square(T121)*R23/(vec3(1.0)-R123);vec3 C0=R12+Rs;I=C0;vec3 Cm=Rs-T121;for (int m=1; m<=2; ++m)\n{Cm*=r123;vec3 Sm=2.0*evalSensitivity(float(m)*opd,float(m)*phi);I+=Cm*Sm;}\nreturn max(I,vec3(0.0));}\n#endif\nfloat normalDistributionFunction_TrowbridgeReitzGGX(float NdotH,float alphaG)\n{float a2=square(alphaG);float d=NdotH*NdotH*(a2-1.0)+1.0;return a2/(PI*d*d);}\n#ifdef SHEEN\nfloat normalDistributionFunction_CharlieSheen(float NdotH,float alphaG)\n{float invR=1./alphaG;float cos2h=NdotH*NdotH;float sin2h=1.-cos2h;return (2.+invR)*pow(sin2h,invR*.5)/(2.*PI);}\n#endif\n#ifdef ANISOTROPIC\nfloat normalDistributionFunction_BurleyGGX_Anisotropic(float NdotH,float TdotH,float BdotH,const vec2 alphaTB) {float a2=alphaTB.x*alphaTB.y;vec3 v=vec3(alphaTB.y*TdotH,alphaTB.x *BdotH,a2*NdotH);float v2=dot(v,v);float w2=a2/v2;return a2*w2*w2*RECIPROCAL_PI;}\n#endif\n#ifdef BRDF_V_HEIGHT_CORRELATED\nfloat smithVisibility_GGXCorrelated(float NdotL,float NdotV,float alphaG) {\n#ifdef MOBILE\nfloat GGXV=NdotL*(NdotV*(1.0-alphaG)+alphaG);float GGXL=NdotV*(NdotL*(1.0-alphaG)+alphaG);return 0.5/(GGXV+GGXL);\n#else\nfloat a2=alphaG*alphaG;float GGXV=NdotL*sqrt(NdotV*(NdotV-a2*NdotV)+a2);float GGXL=NdotV*sqrt(NdotL*(NdotL-a2*NdotL)+a2);return 0.5/(GGXV+GGXL);\n#endif\n}\n#else\nfloat smithVisibilityG1_TrowbridgeReitzGGXFast(float dot,float alphaG)\n{\n#ifdef MOBILE\nreturn 1.0/(dot+alphaG+(1.0-alphaG)*dot ));\n#else\nfloat alphaSquared=alphaG*alphaG;return 1.0/(dot+sqrt(alphaSquared+(1.0-alphaSquared)*dot*dot));\n#endif\n}\nfloat smithVisibility_TrowbridgeReitzGGXFast(float NdotL,float NdotV,float alphaG)\n{float visibility=smithVisibilityG1_TrowbridgeReitzGGXFast(NdotL,alphaG)*smithVisibilityG1_TrowbridgeReitzGGXFast(NdotV,alphaG);return visibility;}\n#endif\n#ifdef ANISOTROPIC\nfloat smithVisibility_GGXCorrelated_Anisotropic(float NdotL,float NdotV,float TdotV,float BdotV,float TdotL,float BdotL,const vec2 alphaTB) {float lambdaV=NdotL*length(vec3(alphaTB.x*TdotV,alphaTB.y*BdotV,NdotV));float lambdaL=NdotV*length(vec3(alphaTB.x*TdotL,alphaTB.y*BdotL,NdotL));float v=0.5/(lambdaV+lambdaL);return v;}\n#endif\n#ifdef CLEARCOAT\nfloat visibility_Kelemen(float VdotH) {return 0.25/(VdotH*VdotH); }\n#endif\n#ifdef SHEEN\nfloat visibility_Ashikhmin(float NdotL,float NdotV)\n{return 1./(4.*(NdotL+NdotV-NdotL*NdotV));}\n/* NOT USED\n#ifdef SHEEN_SOFTER\nfloat l(float x,float alphaG)\n{float oneMinusAlphaSq=(1.0-alphaG)*(1.0-alphaG);float a=mix(21.5473,25.3245,oneMinusAlphaSq);float b=mix(3.82987,3.32435,oneMinusAlphaSq);float c=mix(0.19823,0.16801,oneMinusAlphaSq);float d=mix(-1.97760,-1.27393,oneMinusAlphaSq);float e=mix(-4.32054,-4.85967,oneMinusAlphaSq);return a/(1.0+b*pow(x,c))+d*x+e;}\nfloat lambdaSheen(float cosTheta,float alphaG)\n{return abs(cosTheta)<0.5 ? exp(l(cosTheta,alphaG)) : exp(2.0*l(0.5,alphaG)-l(1.0-cosTheta,alphaG));}\nfloat visibility_CharlieSheen(float NdotL,float NdotV,float alphaG)\n{float G=1.0/(1.0+lambdaSheen(NdotV,alphaG)+lambdaSheen(NdotL,alphaG));return G/(4.0*NdotV*NdotL);}\n#endif\n*/\n#endif\nfloat diffuseBRDF_Burley(float NdotL,float NdotV,float VdotH,float roughness) {float diffuseFresnelNV=pow5(saturateEps(1.0-NdotL));float diffuseFresnelNL=pow5(saturateEps(1.0-NdotV));float diffuseFresnel90=0.5+2.0*VdotH*VdotH*roughness;float fresnel =\n(1.0+(diffuseFresnel90-1.0)*diffuseFresnelNL) *\n(1.0+(diffuseFresnel90-1.0)*diffuseFresnelNV);return fresnel/PI;}\n#ifdef SS_TRANSLUCENCY\nvec3 transmittanceBRDF_Burley(const vec3 tintColor,const vec3 diffusionDistance,float thickness) {vec3 S=1./maxEps(diffusionDistance);vec3 temp=exp((-0.333333333*thickness)*S);return tintColor.rgb*0.25*(temp*temp*temp+3.0*temp);}\nfloat computeWrappedDiffuseNdotL(float NdotL,float w) {float t=1.0+w;float invt2=1.0/square(t);return saturate((NdotL+w)*invt2);}\n#endif\n`;D(395879).l.IncludesShadersStore["pbrBRDFFunctions"]=a},875438:(t,K,D)=>{const a=`#if defined(POINTSIZE) && !defined(WEBGPU)\ngl_PointSize=pointSize;\n#endif\n`;D(395879).l.IncludesShadersStore["pointCloudVertex"]=a},823143:(t,K,D)=>{D.r(K),D.d(K,{depthPixelShader:()=>W});var a=D(395879);D(733251),D(728939),D(215327);const G="depthPixelShader",N=`#ifdef ALPHATEST\nvarying vec2 vUV;uniform sampler2D diffuseSampler;\n#endif\n#include<clipPlaneFragmentDeclaration>\nvarying float vDepthMetric;\n#ifdef PACKED\n#include<packingFunctions>\n#endif\n#ifdef STORE_CAMERASPACE_Z\nvarying vec4 vViewPos;\n#endif\n#define CUSTOM_FRAGMENT_DEFINITIONS\nvoid main(void)\n{\n#include<clipPlaneFragment>\n#ifdef ALPHATEST\nif (texture2D(diffuseSampler,vUV).a<0.4)\ndiscard;\n#endif\n#ifdef STORE_CAMERASPACE_Z\n#ifdef PACKED\ngl_FragColor=pack(vViewPos.z);\n#else\ngl_FragColor=vec4(vViewPos.z,0.0,0.0,1.0);\n#endif\n#else\n#ifdef NONLINEARDEPTH\n#ifdef PACKED\ngl_FragColor=pack(gl_FragCoord.z);\n#else\ngl_FragColor=vec4(gl_FragCoord.z,0.0,0.0,0.0);\n#endif\n#else\n#ifdef PACKED\ngl_FragColor=pack(vDepthMetric);\n#else\ngl_FragColor=vec4(vDepthMetric,0.0,0.0,1.0);\n#endif\n#endif\n#endif\n}`;a.l.ShadersStore[G]=N;const W={name:G,shader:N}},506740:(t,K,D)=>{D.r(K),D.d(K,{depthVertexShader:()=>x});var a=D(395879);D(17106),D(191544),D(467760),D(419765),D(602105),D(427139);const G=`#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n`;a.l.IncludesShadersStore["pointCloudVertexDeclaration"]=G,D(699110),D(265917),D(216313),D(132434),D(243806),D(929801),D(875438);const N="depthVertexShader",W=`attribute vec3 position;\n#include<bonesDeclaration>\n#include<bakedVertexAnimationDeclaration>\n#include<morphTargetsVertexGlobalDeclaration>\n#include<morphTargetsVertexDeclaration>[0..maxSimultaneousMorphTargets]\n#include<clipPlaneVertexDeclaration>\n#include<instancesDeclaration>\nuniform mat4 viewProjection;uniform vec2 depthValues;\n#if defined(ALPHATEST) || defined(NEED_UV)\nvarying vec2 vUV;uniform mat4 diffuseMatrix;\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#ifdef UV2\nattribute vec2 uv2;\n#endif\n#endif\n#ifdef STORE_CAMERASPACE_Z\nuniform mat4 view;varying vec4 vViewPos;\n#endif\n#include<pointCloudVertexDeclaration>\nvarying float vDepthMetric;\n#define CUSTOM_VERTEX_DEFINITIONS\nvoid main(void)\n{vec3 positionUpdated=position;\n#ifdef UV1\nvec2 uvUpdated=uv;\n#endif\n#include<morphTargetsVertexGlobal>\n#include<morphTargetsVertex>[0..maxSimultaneousMorphTargets]\n#include<instancesVertex>\n#include<bonesVertex>\n#include<bakedVertexAnimation>\nvec4 worldPos=finalWorld*vec4(positionUpdated,1.0);\n#include<clipPlaneVertex>\ngl_Position=viewProjection*worldPos;\n#ifdef STORE_CAMERASPACE_Z\nvViewPos=view*worldPos;\n#else\n#ifdef USE_REVERSE_DEPTHBUFFER\nvDepthMetric=((-gl_Position.z+depthValues.x)/(depthValues.y));\n#else\nvDepthMetric=((gl_Position.z+depthValues.x)/(depthValues.y));\n#endif\n#endif\n#if defined(ALPHATEST) || defined(BASIC_RENDER)\n#ifdef UV1\nvUV=vec2(diffuseMatrix*vec4(uvUpdated,1.0,0.0));\n#endif\n#ifdef UV2\nvUV=vec2(diffuseMatrix*vec4(uv2,1.0,0.0));\n#endif\n#endif\n#include<pointCloudVertex>\n}\n`;a.l.ShadersStore[N]=W;const x={name:N,shader:W}},330153:(t,K,D)=>{D.r(K),D.d(K,{passPixelShader:()=>N});const a="passPixelShader",G=`varying vec2 vUV;uniform sampler2D textureSampler;\n#define CUSTOM_FRAGMENT_DEFINITIONS\nvoid main(void) \n{gl_FragColor=texture2D(textureSampler,vUV);}`;D(395879).l.ShadersStore[a]=G;const N={name:a,shader:G}},310839:(t,K,D)=>{D.r(K),D.d(K,{postprocessVertexShader:()=>N});const a="postprocessVertexShader",G=`attribute vec2 position;uniform vec2 scale;varying vec2 vUV;const vec2 madd=vec2(0.5,0.5);\n#define CUSTOM_VERTEX_DEFINITIONS\nvoid main(void) {\n#define CUSTOM_VERTEX_MAIN_BEGIN\nvUV=(position*madd+madd)*scale;gl_Position=vec4(position,0.0,1.0);\n#define CUSTOM_VERTEX_MAIN_END\n}`;D(395879).l.ShadersStore[a]=G;const N={name:a,shader:G}},822133:(t,K,D)=>{D.d(K,{i:()=>a});class a{constructor(){this._blendFunctionParameters=new Array(4),this._blendEquationParameters=new Array(2),this._blendConstants=new Array(4),this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this.reset()}get isDirty(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty||this._isBlendEquationParametersDirty}get alphaBlend(){return this._alphaBlend}set alphaBlend(t){this._alphaBlend!==t&&(this._alphaBlend=t,this._isAlphaBlendDirty=!0)}setAlphaBlendConstants(t,K,D,a){this._blendConstants[0]===t&&this._blendConstants[1]===K&&this._blendConstants[2]===D&&this._blendConstants[3]===a||(this._blendConstants[0]=t,this._blendConstants[1]=K,this._blendConstants[2]=D,this._blendConstants[3]=a,this._isBlendConstantsDirty=!0)}setAlphaBlendFunctionParameters(t,K,D,a){this._blendFunctionParameters[0]===t&&this._blendFunctionParameters[1]===K&&this._blendFunctionParameters[2]===D&&this._blendFunctionParameters[3]===a||(this._blendFunctionParameters[0]=t,this._blendFunctionParameters[1]=K,this._blendFunctionParameters[2]=D,this._blendFunctionParameters[3]=a,this._isBlendFunctionParametersDirty=!0)}setAlphaEquationParameters(t,K){this._blendEquationParameters[0]===t&&this._blendEquationParameters[1]===K||(this._blendEquationParameters[0]=t,this._blendEquationParameters[1]=K,this._isBlendEquationParametersDirty=!0)}reset(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1}apply(t){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?t.enable(t.BLEND):t.disable(t.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(t.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(t.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(t.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))}}},460976:(t,K,D)=>{D.d(K,{N:()=>a});class a{constructor(t=!0){this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,t&&this.reset()}get isDirty(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty}get zOffset(){return this._zOffset}set zOffset(t){this._zOffset!==t&&(this._zOffset=t,this._isZOffsetDirty=!0)}get zOffsetUnits(){return this._zOffsetUnits}set zOffsetUnits(t){this._zOffsetUnits!==t&&(this._zOffsetUnits=t,this._isZOffsetDirty=!0)}get cullFace(){return this._cullFace}set cullFace(t){this._cullFace!==t&&(this._cullFace=t,this._isCullFaceDirty=!0)}get cull(){return this._cull}set cull(t){this._cull!==t&&(this._cull=t,this._isCullDirty=!0)}get depthFunc(){return this._depthFunc}set depthFunc(t){this._depthFunc!==t&&(this._depthFunc=t,this._isDepthFuncDirty=!0)}get depthMask(){return this._depthMask}set depthMask(t){this._depthMask!==t&&(this._depthMask=t,this._isDepthMaskDirty=!0)}get depthTest(){return this._depthTest}set depthTest(t){this._depthTest!==t&&(this._depthTest=t,this._isDepthTestDirty=!0)}get frontFace(){return this._frontFace}set frontFace(t){this._frontFace!==t&&(this._frontFace=t,this._isFrontFaceDirty=!0)}reset(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._zOffsetUnits=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!0,this._isFrontFaceDirty=!1}apply(t){this.isDirty&&(this._isCullDirty&&(this.cull?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(t.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(t.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(t.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset||this.zOffsetUnits?(t.enable(t.POLYGON_OFFSET_FILL),t.polygonOffset(this.zOffset,this.zOffsetUnits)):t.disable(t.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(t.frontFace(this.frontFace),this._isFrontFaceDirty=!1))}}},56291:(t,K,D)=>{D.d(K,{K:()=>a});class a{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=a.ALWAYS,this.funcRef=1,this.funcMask=255,this.opStencilFail=a.KEEP,this.opDepthFail=a.KEEP,this.opStencilDepthPass=a.REPLACE}get stencilFunc(){return this.func}set stencilFunc(t){this.func=t}get stencilFuncRef(){return this.funcRef}set stencilFuncRef(t){this.funcRef=t}get stencilFuncMask(){return this.funcMask}set stencilFuncMask(t){this.funcMask=t}get stencilOpStencilFail(){return this.opStencilFail}set stencilOpStencilFail(t){this.opStencilFail=t}get stencilOpDepthFail(){return this.opDepthFail}set stencilOpDepthFail(t){this.opDepthFail=t}get stencilOpStencilDepthPass(){return this.opStencilDepthPass}set stencilOpStencilDepthPass(t){this.opStencilDepthPass=t}get stencilMask(){return this.mask}set stencilMask(t){this.mask=t}get stencilTest(){return this.enabled}set stencilTest(t){this.enabled=t}}a.ALWAYS=519,a.KEEP=7680,a.REPLACE=7681},762945:(t,K,D)=>{D.d(K,{u:()=>a});class a{get isDirty(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty}get func(){return this._func}set func(t){this._func!==t&&(this._func=t,this._isStencilFuncDirty=!0)}get funcRef(){return this._funcRef}set funcRef(t){this._funcRef!==t&&(this._funcRef=t,this._isStencilFuncDirty=!0)}get funcMask(){return this._funcMask}set funcMask(t){this._funcMask!==t&&(this._funcMask=t,this._isStencilFuncDirty=!0)}get opStencilFail(){return this._opStencilFail}set opStencilFail(t){this._opStencilFail!==t&&(this._opStencilFail=t,this._isStencilOpDirty=!0)}get opDepthFail(){return this._opDepthFail}set opDepthFail(t){this._opDepthFail!==t&&(this._opDepthFail=t,this._isStencilOpDirty=!0)}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(t){this._opStencilDepthPass!==t&&(this._opStencilDepthPass=t,this._isStencilOpDirty=!0)}get mask(){return this._mask}set mask(t){this._mask!==t&&(this._mask=t,this._isStencilMaskDirty=!0)}get enabled(){return this._enabled}set enabled(t){this._enabled!==t&&(this._enabled=t,this._isStencilTestDirty=!0)}constructor(t=!0){this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.useStencilGlobalOnly=!1,t&&this.reset()}reset(){var t;this.stencilMaterial=void 0,null===(t=this.stencilGlobal)||void 0===t||t.reset(),this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0}apply(t){var K;if(!t)return;const D=!this.useStencilGlobalOnly&&!!(null===(K=this.stencilMaterial)||void 0===K?void 0:K.enabled);this.enabled=D?this.stencilMaterial.enabled:this.stencilGlobal.enabled,this.func=D?this.stencilMaterial.func:this.stencilGlobal.func,this.funcRef=D?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef,this.funcMask=D?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask,this.opStencilFail=D?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail,this.opDepthFail=D?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail,this.opStencilDepthPass=D?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass,this.mask=D?this.stencilMaterial.mask:this.stencilGlobal.mask,this.isDirty&&(this._isStencilTestDirty&&(this.enabled?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(t.stencilMask(this.mask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(t.stencilFunc(this.func,this.funcRef,this.funcMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(t.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass),this._isStencilOpDirty=!1))}}},837475:(t,K,D)=>{D.d(K,{d:()=>G});var a=D(310035);class G{constructor(){this.rootNodes=[],this.cameras=[],this.lights=[],this.meshes=[],this.skeletons=[],this.particleSystems=[],this.animations=[],this.animationGroups=[],this.multiMaterials=[],this.materials=[],this.morphTargetManagers=[],this.geometries=[],this.transformNodes=[],this.actionManagers=[],this.textures=[],this._environmentTexture=null,this.postProcesses=[]}static AddParser(t,K){this._BabylonFileParsers[t]=K}static GetParser(t){return this._BabylonFileParsers[t]?this._BabylonFileParsers[t]:null}static AddIndividualParser(t,K){this._IndividualBabylonFileParsers[t]=K}static GetIndividualParser(t){return this._IndividualBabylonFileParsers[t]?this._IndividualBabylonFileParsers[t]:null}static Parse(t,K,D,a){for(const G in this._BabylonFileParsers)Object.prototype.hasOwnProperty.call(this._BabylonFileParsers,G)&&this._BabylonFileParsers[G](t,K,D,a)}get environmentTexture(){return this._environmentTexture}set environmentTexture(t){this._environmentTexture=t}getNodes(){let t=[];return t=t.concat(this.meshes),t=t.concat(this.lights),t=t.concat(this.cameras),t=t.concat(this.transformNodes),this.skeletons.forEach((K=>t=t.concat(K.bones))),t}}G._BabylonFileParsers={},G._IndividualBabylonFileParsers={},a.Y5("BABYLON.AbstractScene",G)},869581:(t,K,D)=>{D.d(K,{b:()=>i});var a=D(297809),G=D(604910),N=D(760998),W=D(638113),x=D(395726),b=D(554014),n=D(337776);class e{constructor(){this._doNotSerialize=!1,this._isDisposed=!1,this._sceneRootNodesIndex=-1,this._isEnabled=!0,this._isParentEnabled=!0,this._isReady=!0,this._onEnabledStateChangedObservable=new W.cP,this._onClonedObservable=new W.cP}}class i{static AddNodeConstructor(t,K){this._NodeConstructors[t]=K}static Construct(t,K,D,a){const G=this._NodeConstructors[t];return G?G(K,D,a):null}set accessibilityTag(t){this._accessibilityTag=t,this.onAccessibilityTagChangedObservable.notifyObservers(t)}get accessibilityTag(){return this._accessibilityTag}get doNotSerialize(){return!!this._nodeDataStorage._doNotSerialize||!!this._parentNode&&this._parentNode.doNotSerialize}set doNotSerialize(t){this._nodeDataStorage._doNotSerialize=t}isDisposed(){return this._nodeDataStorage._isDisposed}set parent(t){if(this._parentNode===t)return;const K=this._parentNode;if(this._parentNode&&void 0!==this._parentNode._children&&null!==this._parentNode._children){const K=this._parentNode._children.indexOf(this);-1!==K&&this._parentNode._children.splice(K,1),t||this._nodeDataStorage._isDisposed||this._addToSceneRootNodes()}this._parentNode=t,this._isDirty=!0,this._parentNode&&(void 0!==this._parentNode._children&&null!==this._parentNode._children||(this._parentNode._children=new Array),this._parentNode._children.push(this),K||this._removeFromSceneRootNodes()),this._syncParentEnabledState()}get parent(){return this._parentNode}_serializeAsParent(t){t.parentId=this.uniqueId}_addToSceneRootNodes(){-1===this._nodeDataStorage._sceneRootNodesIndex&&(this._nodeDataStorage._sceneRootNodesIndex=this._scene.rootNodes.length,this._scene.rootNodes.push(this))}_removeFromSceneRootNodes(){if(-1!==this._nodeDataStorage._sceneRootNodesIndex){const t=this._scene.rootNodes,K=t.length-1;t[this._nodeDataStorage._sceneRootNodesIndex]=t[K],t[this._nodeDataStorage._sceneRootNodesIndex]._nodeDataStorage._sceneRootNodesIndex=this._nodeDataStorage._sceneRootNodesIndex,this._scene.rootNodes.pop(),this._nodeDataStorage._sceneRootNodesIndex=-1}}get animationPropertiesOverride(){return this._animationPropertiesOverride?this._animationPropertiesOverride:this._scene.animationPropertiesOverride}set animationPropertiesOverride(t){this._animationPropertiesOverride=t}getClassName(){return"Node"}set onDispose(t){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(t)}get onEnabledStateChangedObservable(){return this._nodeDataStorage._onEnabledStateChangedObservable}get onClonedObservable(){return this._nodeDataStorage._onClonedObservable}constructor(t,K=null,D=!0){this._isDirty=!1,this._nodeDataStorage=new e,this.state="",this.metadata=null,this.reservedDataStore=null,this._accessibilityTag=null,this.onAccessibilityTagChangedObservable=new W.cP,this._parentContainer=null,this.animations=[],this._ranges={},this.onReady=null,this._currentRenderId=-1,this._parentUpdateId=-1,this._childUpdateId=-1,this._waitingParentId=null,this._waitingParentInstanceIndex=null,this._waitingParsedUniqueId=null,this._cache={},this._parentNode=null,this._children=null,this._worldMatrix=G.uq.Identity(),this._worldMatrixDeterminant=0,this._worldMatrixDeterminantIsDirty=!0,this._animationPropertiesOverride=null,this._isNode=!0,this.onDisposeObservable=new W.cP,this._onDisposeObserver=null,this._behaviors=new Array,this.name=t,this.id=t,this._scene=K||x.q.LastCreatedScene,this.uniqueId=this._scene.getUniqueId(),this._initCache(),D&&this._addToSceneRootNodes()}getScene(){return this._scene}getEngine(){return this._scene.getEngine()}addBehavior(t,K=!1){return-1!==this._behaviors.indexOf(t)||(t.init(),this._scene.isLoading&&!K?this._scene.onDataLoadedObservable.addOnce((()=>{t.attach(this)})):t.attach(this),this._behaviors.push(t)),this}removeBehavior(t){const K=this._behaviors.indexOf(t);return-1===K||(this._behaviors[K].detach(),this._behaviors.splice(K,1)),this}get behaviors(){return this._behaviors}getBehaviorByName(t){for(const K of this._behaviors)if(K.name===t)return K;return null}getWorldMatrix(){return this._currentRenderId!==this._scene.getRenderId()&&this.computeWorldMatrix(),this._worldMatrix}_getWorldMatrixDeterminant(){return this._worldMatrixDeterminantIsDirty&&(this._worldMatrixDeterminantIsDirty=!1,this._worldMatrixDeterminant=this._worldMatrix.determinant()),this._worldMatrixDeterminant}get worldMatrixFromCache(){return this._worldMatrix}_initCache(){this._cache={}}updateCache(t){!t&&this.isSynchronized()||this._updateCache()}_getActionManagerForTrigger(t,K=!0){return this.parent?this.parent._getActionManagerForTrigger(t,!1):null}_updateCache(t){}_isSynchronized(){return!0}_markSyncedWithParent(){this._parentNode&&(this._parentUpdateId=this._parentNode._childUpdateId)}isSynchronizedWithParent(){return!this._parentNode||!this._parentNode._isDirty&&this._parentUpdateId===this._parentNode._childUpdateId&&this._parentNode.isSynchronized()}isSynchronized(){return!(this._parentNode&&!this.isSynchronizedWithParent())&&this._isSynchronized()}isReady(t=!1){return this._nodeDataStorage._isReady}markAsDirty(t){return this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this}isEnabled(t=!0){return!1===t?this._nodeDataStorage._isEnabled:!!this._nodeDataStorage._isEnabled&&this._nodeDataStorage._isParentEnabled}_syncParentEnabledState(){this._nodeDataStorage._isParentEnabled=!this._parentNode||this._parentNode.isEnabled(),this._children&&this._children.forEach((t=>{t._syncParentEnabledState()}))}setEnabled(t){this._nodeDataStorage._isEnabled!==t&&(this._nodeDataStorage._isEnabled=t,this._syncParentEnabledState(),this._nodeDataStorage._onEnabledStateChangedObservable.notifyObservers(t))}isDescendantOf(t){return!!this.parent&&(this.parent===t||this.parent.isDescendantOf(t))}_getDescendants(t,K=!1,D){if(this._children)for(let a=0;a<this._children.length;a++){const G=this._children[a];D&&!D(G)||t.push(G),K||G._getDescendants(t,!1,D)}}getDescendants(t,K){const D=[];return this._getDescendants(D,t,K),D}getChildMeshes(t,K){const D=[];return this._getDescendants(D,t,(t=>(!K||K(t))&&void 0!==t.cullingStrategy)),D}getChildren(t,K=!0){return this.getDescendants(K,t)}_setReady(t){t!==this._nodeDataStorage._isReady&&(t?(this.onReady&&this.onReady(this),this._nodeDataStorage._isReady=!0):this._nodeDataStorage._isReady=!1)}getAnimationByName(t){for(let K=0;K<this.animations.length;K++){const D=this.animations[K];if(D.name===t)return D}return null}createAnimationRange(t,K,D){if(!this._ranges[t]){this._ranges[t]=i._AnimationRangeFactory(t,K,D);for(let a=0,G=this.animations.length;a<G;a++)this.animations[a]&&this.animations[a].createRange(t,K,D)}}deleteAnimationRange(t,K=!0){for(let D=0,a=this.animations.length;D<a;D++)this.animations[D]&&this.animations[D].deleteRange(t,K);this._ranges[t]=null}getAnimationRange(t){return this._ranges[t]||null}clone(t,K,D){const a=n.p.Clone((()=>new i(t,this.getScene())),this);if(K&&(a.parent=K),!D){const K=this.getDescendants(!0);for(let D=0;D<K.length;D++){const G=K[D];G.clone(t+"."+G.name,a)}}return a}getAnimationRanges(){const t=[];let K;for(K in this._ranges)t.push(this._ranges[K]);return t}beginAnimation(t,K,D,a){const G=this.getAnimationRange(t);return G?this._scene.beginAnimation(this,G.from,G.to,K,D,a):null}serializeAnimationRanges(){const t=[];for(const K in this._ranges){const D=this._ranges[K];if(!D)continue;const a={};a.name=K,a.from=D.from,a.to=D.to,t.push(a)}return t}computeWorldMatrix(t){return this._worldMatrix||(this._worldMatrix=G.uq.Identity()),this._worldMatrix}dispose(t,K=!1){if(this._nodeDataStorage._isDisposed=!0,!t){const D=this.getDescendants(!0);for(const a of D)a.dispose(t,K)}this.parent?this.parent=null:this._removeFromSceneRootNodes(),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onEnabledStateChangedObservable.clear(),this.onClonedObservable.clear();for(const t of this._behaviors)t.detach();this._behaviors.length=0,this.metadata=null}static ParseAnimationRanges(t,K,D){if(K.ranges)for(let D=0;D<K.ranges.length;D++){const a=K.ranges[D];t.createAnimationRange(a.name,a.from,a.to)}}getHierarchyBoundingVectors(t=!0,K=null){let D,a;this.getScene().incrementRenderId(),this.computeWorldMatrix(!0);const N=this;if(N.getBoundingInfo&&N.subMeshes){const t=N.getBoundingInfo();D=t.boundingBox.minimumWorld.clone(),a=t.boundingBox.maximumWorld.clone()}else D=new G.Pq(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new G.Pq(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);if(t){const t=this.getDescendants(!1);for(const N of t){const t=N;if(t.computeWorldMatrix(!0),K&&!K(t))continue;if(!t.getBoundingInfo||0===t.getTotalVertices())continue;const W=t.getBoundingInfo().boundingBox,x=W.minimumWorld,b=W.maximumWorld;G.Pq.CheckExtends(x,D,a),G.Pq.CheckExtends(b,D,a)}}return{min:D,max:a}}}i._AnimationRangeFactory=(t,K,D)=>{throw b.n("AnimationRange")},i._NodeConstructors={},a.Cg([N.lK()],i.prototype,"name",void 0),a.Cg([N.lK()],i.prototype,"id",void 0),a.Cg([N.lK()],i.prototype,"uniqueId",void 0),a.Cg([N.lK()],i.prototype,"state",void 0),a.Cg([N.lK()],i.prototype,"metadata",void 0)},889460:(t,K,D)=>{D.d(K,{Z:()=>R});var a=D(898973),G=D(488354),N=D(638113),W=D(293506),x=D(867741),b=D(443401),n=D(604910),e=D(837475),i=D(239590),z=D(384898),I=D(79160),Z=D(35259),w=D(848287),m=D(809319),u=D(122030),d=D(394501),E=D(395726),l=D(554014),Q=D(706211),P=D(806630),y=D(834255),q=D(725378),X=D(276759);class h{constructor(){this._singleClick=!1,this._doubleClick=!1,this._hasSwiped=!1,this._ignore=!1}get singleClick(){return this._singleClick}get doubleClick(){return this._doubleClick}get hasSwiped(){return this._hasSwiped}get ignore(){return this._ignore}set singleClick(t){this._singleClick=t}set doubleClick(t){this._doubleClick=t}set hasSwiped(t){this._hasSwiped=t}set ignore(t){this._ignore=t}}class J{constructor(t){this._alreadyAttached=!1,this._meshPickProceed=!1,this._currentPickResult=null,this._previousPickResult=null,this._totalPointersPressed=0,this._doubleClickOccured=!1,this._isSwiping=!1,this._swipeButtonPressed=-1,this._skipPointerTap=!1,this._isMultiTouchGesture=!1,this._pointerX=0,this._pointerY=0,this._startingPointerPosition=new n.I9(0,0),this._previousStartingPointerPosition=new n.I9(0,0),this._startingPointerTime=0,this._previousStartingPointerTime=0,this._pointerCaptures={},this._meshUnderPointerId={},this._movePointerInfo=null,this._cameraObserverCount=0,this._delayedClicks=[null,null,null,null,null],this._deviceSourceManager=null,this._scene=t||E.q.LastCreatedScene,this._scene}get meshUnderPointer(){return this._movePointerInfo&&(this._movePointerInfo._generatePickInfo(),this._movePointerInfo=null),this._pointerOverMesh}getMeshUnderPointerByPointerId(t){return this._meshUnderPointerId[t]||null}get unTranslatedPointer(){return new n.I9(this._unTranslatedPointerX,this._unTranslatedPointerY)}get pointerX(){return this._pointerX}set pointerX(t){this._pointerX=t}get pointerY(){return this._pointerY}set pointerY(t){this._pointerY=t}_updatePointerPosition(t){const K=this._scene.getEngine().getInputElementClientRect();K&&(this._pointerX=t.clientX-K.left,this._pointerY=t.clientY-K.top,this._unTranslatedPointerX=this._pointerX,this._unTranslatedPointerY=this._pointerY)}_processPointerMove(t,K){const D=this._scene,a=D.getEngine(),G=a.getInputElement();G&&(G.tabIndex=a.canvasTabIndex,D.doNotHandleCursors||(G.style.cursor=D.defaultCursor)),this._setCursorAndPointerOverMesh(t,K,D);for(const a of D._pointerMoveStage){const D=!!(null==(t=t||this._pickMove(K))?void 0:t.pickedMesh);t=a.action(this._unTranslatedPointerX,this._unTranslatedPointerY,t,D,G)}const N=K.inputIndex>=q.ST.MouseWheelX&&K.inputIndex<=q.ST.MouseWheelZ?Q.Zp.POINTERWHEEL:Q.Zp.POINTERMOVE;let W;D.onPointerMove&&(t=t||this._pickMove(K),D.onPointerMove(K,t,N)),t?(W=new Q.mx(N,K,t),this._setRayOnPointerInfo(t,K)):(W=new Q.mx(N,K,null,this),this._movePointerInfo=W),D.onPointerObservable.hasObservers()&&D.onPointerObservable.notifyObservers(W,N)}_setRayOnPointerInfo(t,K){const D=this._scene;t&&D._pickingAvailable&&(t.ray||(t.ray=D.createPickingRay(K.offsetX,K.offsetY,n.uq.Identity(),D.activeCamera)))}_addCameraPointerObserver(t,K){return this._cameraObserverCount++,this._scene.onPointerObservable.add(t,K)}_removeCameraPointerObserver(t){return this._cameraObserverCount--,this._scene.onPointerObservable.remove(t)}_checkForPicking(){return!!(this._scene.onPointerObservable.observers.length>this._cameraObserverCount||this._scene.onPointerPick)}_checkPrePointerObservable(t,K,D){const a=this._scene,G=new Q.tT(D,K,this._unTranslatedPointerX,this._unTranslatedPointerY);return t&&(G.originalPickingInfo=t,G.ray=t.ray,"xr-near"===K.pointerType&&t.originMesh&&(G.nearInteractionPickingInfo=t)),a.onPrePointerObservable.notifyObservers(G,D),!!G.skipOnPointerObservable}_pickMove(t){const K=this._scene,D=K.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,K.pointerMovePredicate,K.pointerMoveFastCheck,K.cameraToUseForPointers,K.pointerMoveTrianglePredicate);return this._setCursorAndPointerOverMesh(D,t,K),D}_setCursorAndPointerOverMesh(t,K,D){const a=D.getEngine().getInputElement();if(null==t?void 0:t.pickedMesh){if(this.setPointerOverMesh(t.pickedMesh,K.pointerId,t,K),!D.doNotHandleCursors&&a&&this._pointerOverMesh){const t=this._pointerOverMesh._getActionManagerForTrigger();t&&t.hasPointerTriggers&&(a.style.cursor=t.hoverCursor||D.hoverCursor)}}else this.setPointerOverMesh(null,K.pointerId,t,K)}simulatePointerMove(t,K){const D=new PointerEvent("pointermove",K);D.inputIndex=q.ST.Move,this._checkPrePointerObservable(t,D,Q.Zp.POINTERMOVE)||this._processPointerMove(t,D)}simulatePointerDown(t,K){const D=new PointerEvent("pointerdown",K);D.inputIndex=D.button+2,this._checkPrePointerObservable(t,D,Q.Zp.POINTERDOWN)||this._processPointerDown(t,D)}_processPointerDown(t,K){const D=this._scene;if(null==t?void 0:t.pickedMesh){this._pickedDownMesh=t.pickedMesh;const a=t.pickedMesh._getActionManagerForTrigger();if(a){if(a.hasPickTriggers)switch(a.processTrigger(5,Z.X.CreateNew(t.pickedMesh,K,t)),K.button){case 0:a.processTrigger(2,Z.X.CreateNew(t.pickedMesh,K,t));break;case 1:a.processTrigger(4,Z.X.CreateNew(t.pickedMesh,K,t));break;case 2:a.processTrigger(3,Z.X.CreateNew(t.pickedMesh,K,t))}a.hasSpecificTrigger(8)&&window.setTimeout((()=>{const t=D.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,(t=>t.isPickable&&t.isVisible&&t.isReady()&&t.actionManager&&t.actionManager.hasSpecificTrigger(8)&&t===this._pickedDownMesh),!1,D.cameraToUseForPointers);(null==t?void 0:t.pickedMesh)&&a&&0!==this._totalPointersPressed&&Date.now()-this._startingPointerTime>J.LongPressDelay&&!this._isPointerSwiping()&&(this._startingPointerTime=0,a.processTrigger(8,Z.X.CreateNew(t.pickedMesh,K)))}),J.LongPressDelay)}}else for(const a of D._pointerDownStage)t=a.action(this._unTranslatedPointerX,this._unTranslatedPointerY,t,K,!1);let a;const G=Q.Zp.POINTERDOWN;t?(D.onPointerDown&&D.onPointerDown(K,t,G),a=new Q.mx(G,K,t),this._setRayOnPointerInfo(t,K)):a=new Q.mx(G,K,null,this),D.onPointerObservable.hasObservers()&&D.onPointerObservable.notifyObservers(a,G)}_isPointerSwiping(){return this._isSwiping}simulatePointerUp(t,K,D){const a=new PointerEvent("pointerup",K);a.inputIndex=q.ST.Move;const G=new h;D?G.doubleClick=!0:G.singleClick=!0,this._checkPrePointerObservable(t,a,Q.Zp.POINTERUP)||this._processPointerUp(t,a,G)}_processPointerUp(t,K,D){const a=this._scene;if(null==t?void 0:t.pickedMesh){if(this._pickedUpMesh=t.pickedMesh,this._pickedDownMesh===this._pickedUpMesh&&(a.onPointerPick&&a.onPointerPick(K,t),D.singleClick&&!D.ignore&&a.onPointerObservable.observers.length>this._cameraObserverCount)){const D=Q.Zp.POINTERPICK,G=new Q.mx(D,K,t);this._setRayOnPointerInfo(t,K),a.onPointerObservable.notifyObservers(G,D)}const G=t.pickedMesh._getActionManagerForTrigger();if(G&&!D.ignore){G.processTrigger(7,Z.X.CreateNew(t.pickedMesh,K,t)),!D.hasSwiped&&D.singleClick&&G.processTrigger(1,Z.X.CreateNew(t.pickedMesh,K,t));const a=t.pickedMesh._getActionManagerForTrigger(6);D.doubleClick&&a&&a.processTrigger(6,Z.X.CreateNew(t.pickedMesh,K,t))}}else if(!D.ignore)for(const G of a._pointerUpStage)t=G.action(this._unTranslatedPointerX,this._unTranslatedPointerY,t,K,D.doubleClick);if(this._pickedDownMesh&&this._pickedDownMesh!==this._pickedUpMesh){const t=this._pickedDownMesh._getActionManagerForTrigger(16);t&&t.processTrigger(16,Z.X.CreateNew(this._pickedDownMesh,K))}if(!D.ignore){const G=new Q.mx(Q.Zp.POINTERUP,K,t);if(this._setRayOnPointerInfo(t,K),a.onPointerObservable.notifyObservers(G,Q.Zp.POINTERUP),a.onPointerUp&&a.onPointerUp(K,t,Q.Zp.POINTERUP),!D.hasSwiped&&!this._skipPointerTap&&!this._isMultiTouchGesture){let G=0;if(D.singleClick?G=Q.Zp.POINTERTAP:D.doubleClick&&(G=Q.Zp.POINTERDOUBLETAP),G){const D=new Q.mx(G,K,t);a.onPointerObservable.hasObservers()&&a.onPointerObservable.hasSpecificMask(G)&&a.onPointerObservable.notifyObservers(D,G)}}}}isPointerCaptured(t=0){return this._pointerCaptures[t]}attachControl(t=!0,K=!0,D=!0,a=null){const G=this._scene,N=G.getEngine();a||(a=N.getInputElement()),this._alreadyAttached&&this.detachControl(),a&&(this._alreadyAttachedTo=a),this._deviceSourceManager=new X.Z(N),this._initActionManager=t=>{if(!this._meshPickProceed){const K=G.skipPointerUpPicking||0===G._registeredActions&&!this._checkForPicking()&&!G.onPointerUp?null:G.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,G.pointerUpPredicate,G.pointerUpFastCheck,G.cameraToUseForPointers,G.pointerUpTrianglePredicate);this._currentPickResult=K,K&&(t=K.hit&&K.pickedMesh?K.pickedMesh._getActionManagerForTrigger():null),this._meshPickProceed=!0}return t},this._delayedSimpleClick=(t,K,D)=>{if((Date.now()-this._previousStartingPointerTime>J.DoubleClickDelay&&!this._doubleClickOccured||t!==this._previousButtonPressed)&&(this._doubleClickOccured=!1,K.singleClick=!0,K.ignore=!1,this._delayedClicks[t])){const K=this._delayedClicks[t].evt,D=Q.Zp.POINTERTAP,a=new Q.mx(D,K,this._currentPickResult);G.onPointerObservable.hasObservers()&&G.onPointerObservable.hasSpecificMask(D)&&G.onPointerObservable.notifyObservers(a,D),this._delayedClicks[t]=null}},this._initClickEvent=(t,K,D,a)=>{var G,N;const W=new h;this._currentPickResult=null;let x=null,b=t.hasSpecificMask(Q.Zp.POINTERPICK)||K.hasSpecificMask(Q.Zp.POINTERPICK)||t.hasSpecificMask(Q.Zp.POINTERTAP)||K.hasSpecificMask(Q.Zp.POINTERTAP)||t.hasSpecificMask(Q.Zp.POINTERDOUBLETAP)||K.hasSpecificMask(Q.Zp.POINTERDOUBLETAP);!b&&P.G&&(x=this._initActionManager(x,W),x&&(b=x.hasPickTriggers));let n=!1;if(b){const b=D.button;if(W.hasSwiped=this._isPointerSwiping(),!W.hasSwiped){let e=!J.ExclusiveDoubleClickMode;if(e||(e=!t.hasSpecificMask(Q.Zp.POINTERDOUBLETAP)&&!K.hasSpecificMask(Q.Zp.POINTERDOUBLETAP),e&&!P.G.HasSpecificTrigger(6)&&(x=this._initActionManager(x,W),x&&(e=!x.hasSpecificTrigger(6)))),e)(Date.now()-this._previousStartingPointerTime>J.DoubleClickDelay||b!==this._previousButtonPressed)&&(W.singleClick=!0,a(W,this._currentPickResult),n=!0);else{const t={evt:D,clickInfo:W,timeoutId:window.setTimeout(this._delayedSimpleClick.bind(this,b,W,a),J.DoubleClickDelay)};this._delayedClicks[b]=t}let i=t.hasSpecificMask(Q.Zp.POINTERDOUBLETAP)||K.hasSpecificMask(Q.Zp.POINTERDOUBLETAP);!i&&P.G.HasSpecificTrigger(6)&&(x=this._initActionManager(x,W),x&&(i=x.hasSpecificTrigger(6))),i&&(b===this._previousButtonPressed&&Date.now()-this._previousStartingPointerTime<J.DoubleClickDelay&&!this._doubleClickOccured?(W.hasSwiped||this._isPointerSwiping()?(this._doubleClickOccured=!1,this._previousStartingPointerTime=this._startingPointerTime,this._previousStartingPointerPosition.x=this._startingPointerPosition.x,this._previousStartingPointerPosition.y=this._startingPointerPosition.y,this._previousButtonPressed=b,J.ExclusiveDoubleClickMode?(this._delayedClicks[b]&&(clearTimeout(null===(N=this._delayedClicks[b])||void 0===N?void 0:N.timeoutId),this._delayedClicks[b]=null),a(W,this._previousPickResult)):a(W,this._currentPickResult)):(this._previousStartingPointerTime=0,this._doubleClickOccured=!0,W.doubleClick=!0,W.ignore=!1,J.ExclusiveDoubleClickMode&&this._delayedClicks[b]&&(clearTimeout(null===(G=this._delayedClicks[b])||void 0===G?void 0:G.timeoutId),this._delayedClicks[b]=null),a(W,this._currentPickResult)),n=!0):(this._doubleClickOccured=!1,this._previousStartingPointerTime=this._startingPointerTime,this._previousStartingPointerPosition.x=this._startingPointerPosition.x,this._previousStartingPointerPosition.y=this._startingPointerPosition.y,this._previousButtonPressed=b))}}n||a(W,this._currentPickResult)},this._onPointerMove=t=>{if(this._updatePointerPosition(t),this._isSwiping||-1===this._swipeButtonPressed||(this._isSwiping=Math.abs(this._startingPointerPosition.x-this._pointerX)>J.DragMovementThreshold||Math.abs(this._startingPointerPosition.y-this._pointerY)>J.DragMovementThreshold),N.isPointerLock&&N._verifyPointerLock(),this._checkPrePointerObservable(null,t,t.inputIndex>=q.ST.MouseWheelX&&t.inputIndex<=q.ST.MouseWheelZ?Q.Zp.POINTERWHEEL:Q.Zp.POINTERMOVE))return;if(!G.cameraToUseForPointers&&!G.activeCamera)return;if(G.skipPointerMovePicking)return void this._processPointerMove(new I.G,t);G.pointerMovePredicate||(G.pointerMovePredicate=t=>t.isPickable&&t.isVisible&&t.isReady()&&t.isEnabled()&&(t.enablePointerMoveEvents||G.constantlyUpdateMeshUnderPointer||null!==t._getActionManagerForTrigger())&&(!G.cameraToUseForPointers||!!(G.cameraToUseForPointers.layerMask&t.layerMask)));const K=G._registeredActions>0||G.constantlyUpdateMeshUnderPointer?this._pickMove(t):null;this._processPointerMove(K,t)},this._onPointerDown=t=>{var K;if(this._totalPointersPressed++,this._pickedDownMesh=null,this._meshPickProceed=!1,J.ExclusiveDoubleClickMode)for(let D=0;D<this._delayedClicks.length;D++)if(this._delayedClicks[D])if(t.button===D)clearTimeout(null===(K=this._delayedClicks[D])||void 0===K?void 0:K.timeoutId);else{const t=this._delayedClicks[D].clickInfo;this._doubleClickOccured=!1,t.singleClick=!0,t.ignore=!1;const K=this._delayedClicks[D].evt,a=Q.Zp.POINTERTAP,N=new Q.mx(a,K,this._currentPickResult);G.onPointerObservable.hasObservers()&&G.onPointerObservable.hasSpecificMask(a)&&G.onPointerObservable.notifyObservers(N,a),this._delayedClicks[D]=null}if(this._updatePointerPosition(t),-1===this._swipeButtonPressed&&(this._swipeButtonPressed=t.button),G.preventDefaultOnPointerDown&&a&&(t.preventDefault(),a.focus()),this._startingPointerPosition.x=this._pointerX,this._startingPointerPosition.y=this._pointerY,this._startingPointerTime=Date.now(),this._checkPrePointerObservable(null,t,Q.Zp.POINTERDOWN))return;if(!G.cameraToUseForPointers&&!G.activeCamera)return;let D;this._pointerCaptures[t.pointerId]=!0,G.pointerDownPredicate||(G.pointerDownPredicate=t=>t.isPickable&&t.isVisible&&t.isReady()&&t.isEnabled()&&(!G.cameraToUseForPointers||!!(G.cameraToUseForPointers.layerMask&t.layerMask))),this._pickedDownMesh=null,D=G.skipPointerDownPicking||0===G._registeredActions&&!this._checkForPicking()&&!G.onPointerDown?new I.G:G.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,G.pointerDownPredicate,G.pointerDownFastCheck,G.cameraToUseForPointers,G.pointerDownTrianglePredicate),this._processPointerDown(D,t)},this._onPointerUp=t=>{0!==this._totalPointersPressed&&(this._totalPointersPressed--,this._pickedUpMesh=null,this._meshPickProceed=!1,this._updatePointerPosition(t),G.preventDefaultOnPointerUp&&a&&(t.preventDefault(),a.focus()),this._initClickEvent(G.onPrePointerObservable,G.onPointerObservable,t,((K,D)=>{if(G.onPrePointerObservable.hasObservers()&&(this._skipPointerTap=!1,!K.ignore)){if(this._checkPrePointerObservable(null,t,Q.Zp.POINTERUP))return this._swipeButtonPressed===t.button&&(this._isSwiping=!1,this._swipeButtonPressed=-1),void(0===t.buttons&&(this._pointerCaptures[t.pointerId]=!1));K.hasSwiped||(K.singleClick&&G.onPrePointerObservable.hasSpecificMask(Q.Zp.POINTERTAP)&&this._checkPrePointerObservable(null,t,Q.Zp.POINTERTAP)&&(this._skipPointerTap=!0),K.doubleClick&&G.onPrePointerObservable.hasSpecificMask(Q.Zp.POINTERDOUBLETAP)&&this._checkPrePointerObservable(null,t,Q.Zp.POINTERDOUBLETAP)&&(this._skipPointerTap=!0))}this._pointerCaptures[t.pointerId]?(0===t.buttons&&(this._pointerCaptures[t.pointerId]=!1),(G.cameraToUseForPointers||G.activeCamera)&&(G.pointerUpPredicate||(G.pointerUpPredicate=t=>t.isPickable&&t.isVisible&&t.isReady()&&t.isEnabled()&&(!G.cameraToUseForPointers||!!(G.cameraToUseForPointers.layerMask&t.layerMask))),!this._meshPickProceed&&(P.G&&P.G.HasTriggers||this._checkForPicking()||G.onPointerUp)&&this._initActionManager(null,K),D||(D=this._currentPickResult),this._processPointerUp(D,t,K),this._previousPickResult=this._currentPickResult,this._swipeButtonPressed===t.button&&(this._isSwiping=!1,this._swipeButtonPressed=-1))):this._swipeButtonPressed===t.button&&(this._isSwiping=!1,this._swipeButtonPressed=-1)})))},this._onKeyDown=t=>{const K=y.TB.KEYDOWN;if(G.onPreKeyboardObservable.hasObservers()){const D=new y.Bu(K,t);if(G.onPreKeyboardObservable.notifyObservers(D,K),D.skipOnKeyboardObservable)return}if(G.onKeyboardObservable.hasObservers()){const D=new y.W0(K,t);G.onKeyboardObservable.notifyObservers(D,K)}G.actionManager&&G.actionManager.processTrigger(14,Z.X.CreateNewFromScene(G,t))},this._onKeyUp=t=>{const K=y.TB.KEYUP;if(G.onPreKeyboardObservable.hasObservers()){const D=new y.Bu(K,t);if(G.onPreKeyboardObservable.notifyObservers(D,K),D.skipOnKeyboardObservable)return}if(G.onKeyboardObservable.hasObservers()){const D=new y.W0(K,t);G.onKeyboardObservable.notifyObservers(D,K)}G.actionManager&&G.actionManager.processTrigger(15,Z.X.CreateNewFromScene(G,t))},this._deviceSourceManager.onDeviceConnectedObservable.add((a=>{a.deviceType===q.bq.Mouse?a.onInputChangedObservable.add((G=>{this._originMouseEvent=G,G.inputIndex===q.ST.LeftClick||G.inputIndex===q.ST.MiddleClick||G.inputIndex===q.ST.RightClick||G.inputIndex===q.ST.BrowserBack||G.inputIndex===q.ST.BrowserForward?K&&1===a.getInput(G.inputIndex)?this._onPointerDown(G):t&&0===a.getInput(G.inputIndex)&&this._onPointerUp(G):D&&(G.inputIndex===q.ST.Move?this._onPointerMove(G):G.inputIndex!==q.ST.MouseWheelX&&G.inputIndex!==q.ST.MouseWheelY&&G.inputIndex!==q.ST.MouseWheelZ||this._onPointerMove(G))})):a.deviceType===q.bq.Touch?a.onInputChangedObservable.add((G=>{G.inputIndex===q.ST.LeftClick&&(K&&1===a.getInput(G.inputIndex)?(this._onPointerDown(G),this._totalPointersPressed>1&&(this._isMultiTouchGesture=!0)):t&&0===a.getInput(G.inputIndex)&&(this._onPointerUp(G),0===this._totalPointersPressed&&(this._isMultiTouchGesture=!1))),D&&G.inputIndex===q.ST.Move&&this._onPointerMove(G)})):a.deviceType===q.bq.Keyboard&&a.onInputChangedObservable.add((t=>{"keydown"===t.type?this._onKeyDown(t):"keyup"===t.type&&this._onKeyUp(t)}))})),this._alreadyAttached=!0}detachControl(){this._alreadyAttached&&(this._deviceSourceManager.dispose(),this._deviceSourceManager=null,this._alreadyAttachedTo&&!this._scene.doNotHandleCursors&&(this._alreadyAttachedTo.style.cursor=this._scene.defaultCursor),this._alreadyAttached=!1,this._alreadyAttachedTo=null)}setPointerOverMesh(t,K=0,D,a){if(!(this._meshUnderPointerId[K]!==t||t&&t._internalAbstractMeshDataInfo._pointerOverDisableMeshTesting))return;const G=this._meshUnderPointerId[K];let N;G&&(N=G._getActionManagerForTrigger(10),N&&N.processTrigger(10,Z.X.CreateNew(G,a,{pointerId:K}))),t?(this._meshUnderPointerId[K]=t,this._pointerOverMesh=t,N=t._getActionManagerForTrigger(9),N&&N.processTrigger(9,Z.X.CreateNew(t,a,{pointerId:K,pickResult:D}))):(delete this._meshUnderPointerId[K],this._pointerOverMesh=null)}getPointerOverMesh(){return this.meshUnderPointer}_invalidateMesh(t){this._pointerOverMesh===t&&(this._pointerOverMesh=null),this._pickedDownMesh===t&&(this._pickedDownMesh=null),this._pickedUpMesh===t&&(this._pickedUpMesh=null);for(const K in this._meshUnderPointerId)this._meshUnderPointerId[K]===t&&delete this._meshUnderPointerId[K]}}J.DragMovementThreshold=10,J.LongPressDelay=500,J.DoubleClickDelay=300,J.ExclusiveDoubleClickMode=!1;var T=D(850327),_=D(332290),C=D(993739),H=D(233637),o=D(435683),U=D(875830),V=D(967872);class s{constructor(){this.pointerDownFastCheck=!1,this.pointerUpFastCheck=!1,this.pointerMoveFastCheck=!1,this.skipPointerMovePicking=!1,this.skipPointerDownPicking=!1,this.skipPointerUpPicking=!1}}var F,c=D(706400),g=D(310035);(function(t){t[t["BackwardCompatible"]=0]="BackwardCompatible",t[t["Intermediate"]=1]="Intermediate",t[t["Aggressive"]=2]="Aggressive"})(F||(F={}));class R extends e.d{static DefaultMaterialFactory(t){throw l.n("StandardMaterial")}static CollisionCoordinatorFactory(){throw l.n("DefaultCollisionCoordinator")}get environmentTexture(){return this._environmentTexture}set environmentTexture(t){this._environmentTexture!==t&&(this._environmentTexture=t,this.markAllMaterialsAsDirty(1))}get imageProcessingConfiguration(){return this._imageProcessingConfiguration}get performancePriority(){return this._performancePriority}set performancePriority(t){if(t!==this._performancePriority){switch(this._performancePriority=t,t){case 0:this.skipFrustumClipping=!1,this._renderingManager.maintainStateBetweenFrames=!1,this.skipPointerMovePicking=!1,this.autoClear=!0;break;case 1:this.skipFrustumClipping=!1,this._renderingManager.maintainStateBetweenFrames=!1,this.skipPointerMovePicking=!0,this.autoClear=!1;break;case 2:this.skipFrustumClipping=!0,this._renderingManager.maintainStateBetweenFrames=!0,this.skipPointerMovePicking=!0,this.autoClear=!1}this.onScenePerformancePriorityChangedObservable.notifyObservers(t)}}set forceWireframe(t){this._forceWireframe!==t&&(this._forceWireframe=t,this.markAllMaterialsAsDirty(16))}get forceWireframe(){return this._forceWireframe}set skipFrustumClipping(t){this._skipFrustumClipping!==t&&(this._skipFrustumClipping=t)}get skipFrustumClipping(){return this._skipFrustumClipping}set forcePointsCloud(t){this._forcePointsCloud!==t&&(this._forcePointsCloud=t,this.markAllMaterialsAsDirty(16))}get forcePointsCloud(){return this._forcePointsCloud}get animationPropertiesOverride(){return this._animationPropertiesOverride}set animationPropertiesOverride(t){this._animationPropertiesOverride=t}set onDispose(t){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(t)}set beforeRender(t){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),t&&(this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(t))}set afterRender(t){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),t&&(this._onAfterRenderObserver=this.onAfterRenderObservable.add(t))}set beforeCameraRender(t){this._onBeforeCameraRenderObserver&&this.onBeforeCameraRenderObservable.remove(this._onBeforeCameraRenderObserver),this._onBeforeCameraRenderObserver=this.onBeforeCameraRenderObservable.add(t)}set afterCameraRender(t){this._onAfterCameraRenderObserver&&this.onAfterCameraRenderObservable.remove(this._onAfterCameraRenderObserver),this._onAfterCameraRenderObserver=this.onAfterCameraRenderObservable.add(t)}get pointerDownPredicate(){return this._pointerPickingConfiguration.pointerDownPredicate}set pointerDownPredicate(t){this._pointerPickingConfiguration.pointerDownPredicate=t}get pointerUpPredicate(){return this._pointerPickingConfiguration.pointerUpPredicate}set pointerUpPredicate(t){this._pointerPickingConfiguration.pointerUpPredicate=t}get pointerMovePredicate(){return this._pointerPickingConfiguration.pointerMovePredicate}set pointerMovePredicate(t){this._pointerPickingConfiguration.pointerMovePredicate=t}get pointerDownFastCheck(){return this._pointerPickingConfiguration.pointerDownFastCheck}set pointerDownFastCheck(t){this._pointerPickingConfiguration.pointerDownFastCheck=t}get pointerUpFastCheck(){return this._pointerPickingConfiguration.pointerUpFastCheck}set pointerUpFastCheck(t){this._pointerPickingConfiguration.pointerUpFastCheck=t}get pointerMoveFastCheck(){return this._pointerPickingConfiguration.pointerMoveFastCheck}set pointerMoveFastCheck(t){this._pointerPickingConfiguration.pointerMoveFastCheck=t}get skipPointerMovePicking(){return this._pointerPickingConfiguration.skipPointerMovePicking}set skipPointerMovePicking(t){this._pointerPickingConfiguration.skipPointerMovePicking=t}get skipPointerDownPicking(){return this._pointerPickingConfiguration.skipPointerDownPicking}set skipPointerDownPicking(t){this._pointerPickingConfiguration.skipPointerDownPicking=t}get skipPointerUpPicking(){return this._pointerPickingConfiguration.skipPointerUpPicking}set skipPointerUpPicking(t){this._pointerPickingConfiguration.skipPointerUpPicking=t}get unTranslatedPointer(){return this._inputManager.unTranslatedPointer}static get DragMovementThreshold(){return J.DragMovementThreshold}static set DragMovementThreshold(t){J.DragMovementThreshold=t}static get LongPressDelay(){return J.LongPressDelay}static set LongPressDelay(t){J.LongPressDelay=t}static get DoubleClickDelay(){return J.DoubleClickDelay}static set DoubleClickDelay(t){J.DoubleClickDelay=t}static get ExclusiveDoubleClickMode(){return J.ExclusiveDoubleClickMode}static set ExclusiveDoubleClickMode(t){J.ExclusiveDoubleClickMode=t}bindEyePosition(t,K="vEyePosition",D=!1){const a=this._forcedViewPosition?this._forcedViewPosition:this._mirroredCameraPosition?this._mirroredCameraPosition:this.activeCamera.globalPosition,G=this.useRightHandedSystem===(null!=this._mirroredCameraPosition);return n.AA.Vector4[0].set(a.x,a.y,a.z,G?-1:1),t&&(D?t.setFloat3(K,n.AA.Vector4[0].x,n.AA.Vector4[0].y,n.AA.Vector4[0].z):t.setVector4(K,n.AA.Vector4[0])),n.AA.Vector4[0]}finalizeSceneUbo(){const t=this.getSceneUniformBuffer(),K=this.bindEyePosition(null);return t.updateFloat4("vEyePosition",K.x,K.y,K.z,K.w),t.update(),t}set useRightHandedSystem(t){this._useRightHandedSystem!==t&&(this._useRightHandedSystem=t,this.markAllMaterialsAsDirty(16))}get useRightHandedSystem(){return this._useRightHandedSystem}setStepId(t){this._currentStepId=t}getStepId(){return this._currentStepId}getInternalStep(){return this._currentInternalStep}set fogEnabled(t){this._fogEnabled!==t&&(this._fogEnabled=t,this.markAllMaterialsAsDirty(16))}get fogEnabled(){return this._fogEnabled}set fogMode(t){this._fogMode!==t&&(this._fogMode=t,this.markAllMaterialsAsDirty(16))}get fogMode(){return this._fogMode}get prePass(){return!!this.prePassRenderer&&this.prePassRenderer.defaultRT.enabled}set shadowsEnabled(t){this._shadowsEnabled!==t&&(this._shadowsEnabled=t,this.markAllMaterialsAsDirty(2))}get shadowsEnabled(){return this._shadowsEnabled}set lightsEnabled(t){this._lightsEnabled!==t&&(this._lightsEnabled=t,this.markAllMaterialsAsDirty(2))}get lightsEnabled(){return this._lightsEnabled}get activeCameras(){return this._activeCameras}set activeCameras(t){this._unObserveActiveCameras&&(this._unObserveActiveCameras(),this._unObserveActiveCameras=null),t&&(this._unObserveActiveCameras=V.lL(t,(()=>{this.onActiveCamerasChanged.notifyObservers(this)}))),this._activeCameras=t}get activeCamera(){return this._activeCamera}set activeCamera(t){t!==this._activeCamera&&(this._activeCamera=t,this.onActiveCameraChanged.notifyObservers(this))}get defaultMaterial(){return this._defaultMaterial||(this._defaultMaterial=R.DefaultMaterialFactory(this)),this._defaultMaterial}set defaultMaterial(t){this._defaultMaterial=t}set texturesEnabled(t){this._texturesEnabled!==t&&(this._texturesEnabled=t,this.markAllMaterialsAsDirty(1))}get texturesEnabled(){return this._texturesEnabled}set skeletonsEnabled(t){this._skeletonsEnabled!==t&&(this._skeletonsEnabled=t,this.markAllMaterialsAsDirty(8))}get skeletonsEnabled(){return this._skeletonsEnabled}get collisionCoordinator(){return this._collisionCoordinator||(this._collisionCoordinator=R.CollisionCoordinatorFactory(),this._collisionCoordinator.init(this)),this._collisionCoordinator}get renderingManager(){return this._renderingManager}get frustumPlanes(){return this._frustumPlanes}_registerTransientComponents(){if(this._transientComponents.length>0){for(const t of this._transientComponents)t.register();this._transientComponents.length=0}}_addComponent(t){this._components.push(t),this._transientComponents.push(t);const K=t;K.addFromContainer&&K.serialize&&this._serializableComponents.push(K)}_getComponent(t){for(const K of this._components)if(K.name===t)return K;return null}constructor(t,K){super(),this._inputManager=new J(this),this.cameraToUseForPointers=null,this._isScene=!0,this._blockEntityCollection=!1,this.autoClear=!0,this.autoClearDepthAndStencil=!0,this.clearColor=new _.ov(.2,.2,.3,1),this.ambientColor=new _.v9(0,0,0),this.environmentIntensity=1,this._performancePriority=0,this.onScenePerformancePriorityChangedObservable=new N.cP,this._forceWireframe=!1,this._skipFrustumClipping=!1,this._forcePointsCloud=!1,this.animationsEnabled=!0,this._animationPropertiesOverride=null,this.useConstantAnimationDeltaTime=!1,this.constantlyUpdateMeshUnderPointer=!1,this.hoverCursor="pointer",this.defaultCursor="",this.doNotHandleCursors=!1,this.preventDefaultOnPointerDown=!0,this.preventDefaultOnPointerUp=!0,this.metadata=null,this.reservedDataStore=null,this.disableOfflineSupportExceptionRules=[],this.onDisposeObservable=new N.cP,this._onDisposeObserver=null,this.onBeforeRenderObservable=new N.cP,this._onBeforeRenderObserver=null,this.onAfterRenderObservable=new N.cP,this.onAfterRenderCameraObservable=new N.cP,this._onAfterRenderObserver=null,this.onBeforeAnimationsObservable=new N.cP,this.onAfterAnimationsObservable=new N.cP,this.onBeforeDrawPhaseObservable=new N.cP,this.onAfterDrawPhaseObservable=new N.cP,this.onReadyObservable=new N.cP,this.onBeforeCameraRenderObservable=new N.cP,this._onBeforeCameraRenderObserver=null,this.onAfterCameraRenderObservable=new N.cP,this._onAfterCameraRenderObserver=null,this.onBeforeActiveMeshesEvaluationObservable=new N.cP,this.onAfterActiveMeshesEvaluationObservable=new N.cP,this.onBeforeParticlesRenderingObservable=new N.cP,this.onAfterParticlesRenderingObservable=new N.cP,this.onDataLoadedObservable=new N.cP,this.onNewCameraAddedObservable=new N.cP,this.onCameraRemovedObservable=new N.cP,this.onNewLightAddedObservable=new N.cP,this.onLightRemovedObservable=new N.cP,this.onNewGeometryAddedObservable=new N.cP,this.onGeometryRemovedObservable=new N.cP,this.onNewTransformNodeAddedObservable=new N.cP,this.onTransformNodeRemovedObservable=new N.cP,this.onNewMeshAddedObservable=new N.cP,this.onMeshRemovedObservable=new N.cP,this.onNewSkeletonAddedObservable=new N.cP,this.onSkeletonRemovedObservable=new N.cP,this.onNewMaterialAddedObservable=new N.cP,this.onNewMultiMaterialAddedObservable=new N.cP,this.onMaterialRemovedObservable=new N.cP,this.onMultiMaterialRemovedObservable=new N.cP,this.onNewTextureAddedObservable=new N.cP,this.onTextureRemovedObservable=new N.cP,this.onBeforeRenderTargetsRenderObservable=new N.cP,this.onAfterRenderTargetsRenderObservable=new N.cP,this.onBeforeStepObservable=new N.cP,this.onAfterStepObservable=new N.cP,this.onActiveCameraChanged=new N.cP,this.onActiveCamerasChanged=new N.cP,this.onBeforeRenderingGroupObservable=new N.cP,this.onAfterRenderingGroupObservable=new N.cP,this.onMeshImportedObservable=new N.cP,this.onAnimationFileImportedObservable=new N.cP,this._registeredForLateAnimationBindings=new W.b(256),this._pointerPickingConfiguration=new s,this.onPrePointerObservable=new N.cP,this.onPointerObservable=new N.cP,this.onPreKeyboardObservable=new N.cP,this.onKeyboardObservable=new N.cP,this._useRightHandedSystem=!1,this._timeAccumulator=0,this._currentStepId=0,this._currentInternalStep=0,this._fogEnabled=!0,this._fogMode=R.FOGMODE_NONE,this.fogColor=new _.v9(.2,.2,.3),this.fogDensity=.1,this.fogStart=0,this.fogEnd=1e3,this.needsPreviousWorldMatrices=!1,this._shadowsEnabled=!0,this._lightsEnabled=!0,this._unObserveActiveCameras=null,this._texturesEnabled=!0,this.physicsEnabled=!0,this.particlesEnabled=!0,this.spritesEnabled=!0,this._skeletonsEnabled=!0,this.lensFlaresEnabled=!0,this.collisionsEnabled=!0,this.gravity=new n.Pq(0,-9.807,0),this.postProcessesEnabled=!0,this.renderTargetsEnabled=!0,this.dumpNextRenderTargets=!1,this.customRenderTargets=[],this.importedMeshesFiles=[],this.probesEnabled=!0,this._meshesForIntersections=new W.b(256),this.proceduralTexturesEnabled=!0,this._totalVertices=new T.A,this._activeIndices=new T.A,this._activeParticles=new T.A,this._activeBones=new T.A,this._animationTime=0,this.animationTimeScale=1,this._renderId=0,this._frameId=0,this._executeWhenReadyTimeoutId=null,this._intermediateRendering=!1,this._defaultFrameBufferCleared=!1,this._viewUpdateFlag=-1,this._projectionUpdateFlag=-1,this._toBeDisposed=new Array(256),this._activeRequests=new Array,this._pendingData=new Array,this._isDisposed=!1,this.dispatchAllSubMeshesOfActiveMeshes=!1,this._activeMeshes=new W.L(256),this._processedMaterials=new W.L(256),this._renderTargets=new W.b(256),this._materialsRenderTargets=new W.b(256),this._activeParticleSystems=new W.L(256),this._activeSkeletons=new W.b(32),this._softwareSkinnedMeshes=new W.b(32),this._activeAnimatables=new Array,this._transformMatrix=n.uq.Zero(),this.requireLightSorting=!1,this._components=[],this._serializableComponents=[],this._transientComponents=[],this._beforeCameraUpdateStage=u.B.Create(),this._beforeClearStage=u.B.Create(),this._beforeRenderTargetClearStage=u.B.Create(),this._gatherRenderTargetsStage=u.B.Create(),this._gatherActiveCameraRenderTargetsStage=u.B.Create(),this._isReadyForMeshStage=u.B.Create(),this._beforeEvaluateActiveMeshStage=u.B.Create(),this._evaluateSubMeshStage=u.B.Create(),this._preActiveMeshStage=u.B.Create(),this._cameraDrawRenderTargetStage=u.B.Create(),this._beforeCameraDrawStage=u.B.Create(),this._beforeRenderTargetDrawStage=u.B.Create(),this._beforeRenderingGroupDrawStage=u.B.Create(),this._beforeRenderingMeshStage=u.B.Create(),this._afterRenderingMeshStage=u.B.Create(),this._afterRenderingGroupDrawStage=u.B.Create(),this._afterCameraDrawStage=u.B.Create(),this._afterCameraPostProcessStage=u.B.Create(),this._afterRenderTargetDrawStage=u.B.Create(),this._afterRenderTargetPostProcessStage=u.B.Create(),this._afterRenderStage=u.B.Create(),this._pointerMoveStage=u.B.Create(),this._pointerDownStage=u.B.Create(),this._pointerUpStage=u.B.Create(),this._geometriesByUniqueId=null,this._defaultMeshCandidates={data:[],length:0},this._defaultSubMeshCandidates={data:[],length:0},this._preventFreeActiveMeshesAndRenderingGroups=!1,this._activeMeshesFrozen=!1,this._activeMeshesFrozenButKeepClipping=!1,this._skipEvaluateActiveMeshesCompletely=!1,this._allowPostProcessClearColor=!0,this.getDeterministicFrameTime=()=>this._engine.getTimeStep(),this._registeredActions=0,this._blockMaterialDirtyMechanism=!1,this._perfCollector=null,this.activeCameras=[];const D={useGeometryUniqueIdsMap:!0,useMaterialMeshMap:!0,useClonedMeshMap:!0,virtual:!1,...K};t=this._engine=t||E.q.LastCreatedEngine,D.virtual?t._virtualScenes.push(this):(E.q._LastCreatedScene=this,t.scenes.push(this)),this._uid=null,this._renderingManager=new m.m(this),w.X&&(this.postProcessManager=new w.X(this)),d.BA()&&this.attachControl(),this._createUbo(),i.p&&(this._imageProcessingConfiguration=new i.p),this.setDefaultCandidateProviders(),D.useGeometryUniqueIdsMap&&(this._geometriesByUniqueId={}),this.useMaterialMeshMap=D.useMaterialMeshMap,this.useClonedMeshMap=D.useClonedMeshMap,K&&K.virtual||t.onNewSceneAddedObservable.notifyObservers(this)}getClassName(){return"Scene"}_getDefaultMeshCandidates(){return this._defaultMeshCandidates.data=this.meshes,this._defaultMeshCandidates.length=this.meshes.length,this._defaultMeshCandidates}_getDefaultSubMeshCandidates(t){return this._defaultSubMeshCandidates.data=t.subMeshes,this._defaultSubMeshCandidates.length=t.subMeshes.length,this._defaultSubMeshCandidates}setDefaultCandidateProviders(){this.getActiveMeshCandidates=()=>this._getDefaultMeshCandidates(),this.getActiveSubMeshCandidates=t=>this._getDefaultSubMeshCandidates(t),this.getIntersectingSubMeshCandidates=(t,K)=>this._getDefaultSubMeshCandidates(t),this.getCollidingSubMeshCandidates=(t,K)=>this._getDefaultSubMeshCandidates(t)}get meshUnderPointer(){return this._inputManager.meshUnderPointer}get pointerX(){return this._inputManager.pointerX}set pointerX(t){this._inputManager.pointerX=t}get pointerY(){return this._inputManager.pointerY}set pointerY(t){this._inputManager.pointerY=t}getCachedMaterial(){return this._cachedMaterial}getCachedEffect(){return this._cachedEffect}getCachedVisibility(){return this._cachedVisibility}isCachedMaterialInvalid(t,K,D=1){return this._cachedEffect!==K||this._cachedMaterial!==t||this._cachedVisibility!==D}getEngine(){return this._engine}getTotalVertices(){return this._totalVertices.current}get totalVerticesPerfCounter(){return this._totalVertices}getActiveIndices(){return this._activeIndices.current}get totalActiveIndicesPerfCounter(){return this._activeIndices}getActiveParticles(){return this._activeParticles.current}get activeParticlesPerfCounter(){return this._activeParticles}getActiveBones(){return this._activeBones.current}get activeBonesPerfCounter(){return this._activeBones}getActiveMeshes(){return this._activeMeshes}getAnimationRatio(){return void 0!==this._animationRatio?this._animationRatio:1}getRenderId(){return this._renderId}getFrameId(){return this._frameId}incrementRenderId(){this._renderId++}_createUbo(){this.setSceneUniformBuffer(this.createSceneUniformBuffer())}simulatePointerMove(t,K){return this._inputManager.simulatePointerMove(t,K),this}simulatePointerDown(t,K){return this._inputManager.simulatePointerDown(t,K),this}simulatePointerUp(t,K,D){return this._inputManager.simulatePointerUp(t,K,D),this}isPointerCaptured(t=0){return this._inputManager.isPointerCaptured(t)}attachControl(t=!0,K=!0,D=!0){this._inputManager.attachControl(t,K,D)}detachControl(){this._inputManager.detachControl()}isReady(t=!0){var K,D,a;if(this._isDisposed)return!1;let G;const N=this.getEngine(),W=N.currentRenderPassId;N.currentRenderPassId=null!==(D=null===(K=this.activeCamera)||void 0===K?void 0:K.renderPassId)&&void 0!==D?D:W;let x=!0;for(this._pendingData.length>0&&(x=!1),null===(a=this.prePassRenderer)||void 0===a||a.update(),this.useOrderIndependentTransparency&&this.depthPeelingRenderer&&x&&(x=this.depthPeelingRenderer.isReady()),t&&(this._processedMaterials.reset(),this._materialsRenderTargets.reset()),G=0;G<this.meshes.length;G++){const K=this.meshes[G];if(!K.subMeshes||0===K.subMeshes.length)continue;if(!K.isReady(!0)){x=!1;continue}const D=K.hasThinInstances||"InstancedMesh"===K.getClassName()||"InstancedLinesMesh"===K.getClassName()||N.getCaps().instancedArrays&&K.instances.length>0;for(const t of this._isReadyForMeshStage)t.action(K,D)||(x=!1);if(!t)continue;const a=K.material||this.defaultMaterial;if(a)if(a._storeEffectOnSubMeshes)for(const t of K.subMeshes){const K=t.getMaterial();K&&K.hasRenderTargetTextures&&null!=K.getRenderTargetTextures&&-1===this._processedMaterials.indexOf(K)&&(this._processedMaterials.push(K),this._materialsRenderTargets.concatWithNoDuplicate(K.getRenderTargetTextures()))}else a.hasRenderTargetTextures&&null!=a.getRenderTargetTextures&&-1===this._processedMaterials.indexOf(a)&&(this._processedMaterials.push(a),this._materialsRenderTargets.concatWithNoDuplicate(a.getRenderTargetTextures()))}if(t)for(G=0;G<this._materialsRenderTargets.length;++G)this._materialsRenderTargets.data[G].isReadyForRendering()||(x=!1);for(G=0;G<this.geometries.length;G++)2===this.geometries[G].delayLoadState&&(x=!1);if(this.activeCameras&&this.activeCameras.length>0)for(const t of this.activeCameras)t.isReady(!0)||(x=!1);else this.activeCamera&&(this.activeCamera.isReady(!0)||(x=!1));for(const t of this.particleSystems)t.isReady()||(x=!1);if(this.layers)for(const t of this.layers)t.isReady()||(x=!1);return N.areAllEffectsReady()||(x=!1),N.currentRenderPassId=W,x}resetCachedMaterial(){this._cachedMaterial=null,this._cachedEffect=null,this._cachedVisibility=null}registerBeforeRender(t){this.onBeforeRenderObservable.add(t)}unregisterBeforeRender(t){this.onBeforeRenderObservable.removeCallback(t)}registerAfterRender(t){this.onAfterRenderObservable.add(t)}unregisterAfterRender(t){this.onAfterRenderObservable.removeCallback(t)}_executeOnceBeforeRender(t){const K=()=>{t(),setTimeout((()=>{this.unregisterBeforeRender(K)}))};this.registerBeforeRender(K)}executeOnceBeforeRender(t,K){void 0!==K?setTimeout((()=>{this._executeOnceBeforeRender(t)}),K):this._executeOnceBeforeRender(t)}addPendingData(t){this._pendingData.push(t)}removePendingData(t){const K=this.isLoading,D=this._pendingData.indexOf(t);-1!==D&&this._pendingData.splice(D,1),K&&!this.isLoading&&this.onDataLoadedObservable.notifyObservers(this)}getWaitingItemsCount(){return this._pendingData.length}get isLoading(){return this._pendingData.length>0}executeWhenReady(t,K=!1){this.onReadyObservable.addOnce(t),null===this._executeWhenReadyTimeoutId&&this._checkIsReady(K)}whenReadyAsync(t=!1){return new Promise((K=>{this.executeWhenReady((()=>{K()}),t)}))}_checkIsReady(t=!1){return this._registerTransientComponents(),this.isReady(t)?(this.onReadyObservable.notifyObservers(this),this.onReadyObservable.clear(),void(this._executeWhenReadyTimeoutId=null)):this._isDisposed?(this.onReadyObservable.clear(),void(this._executeWhenReadyTimeoutId=null)):void(this._executeWhenReadyTimeoutId=setTimeout((()=>{this.incrementRenderId(),this._checkIsReady(t)}),100))}get animatables(){return this._activeAnimatables}resetLastAnimationTimeFrame(){this._animationTimeLast=G.j.Now}getViewMatrix(){return this._viewMatrix}getProjectionMatrix(){return this._projectionMatrix}getTransformMatrix(){return this._transformMatrix}setTransformMatrix(t,K,D,a){D||a||!this._multiviewSceneUbo||(this._multiviewSceneUbo.dispose(),this._multiviewSceneUbo=null),this._viewUpdateFlag===t.updateFlag&&this._projectionUpdateFlag===K.updateFlag||(this._viewUpdateFlag=t.updateFlag,this._projectionUpdateFlag=K.updateFlag,this._viewMatrix=t,this._projectionMatrix=K,this._viewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix),this._frustumPlanes?C.P.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=C.P.GetPlanes(this._transformMatrix),this._multiviewSceneUbo&&this._multiviewSceneUbo.useUbo?this._updateMultiviewUbo(D,a):this._sceneUbo.useUbo&&(this._sceneUbo.updateMatrix("viewProjection",this._transformMatrix),this._sceneUbo.updateMatrix("view",this._viewMatrix),this._sceneUbo.updateMatrix("projection",this._projectionMatrix)))}getSceneUniformBuffer(){return this._multiviewSceneUbo?this._multiviewSceneUbo:this._sceneUbo}createSceneUniformBuffer(t){const K=new z.D(this._engine,void 0,!1,null!=t?t:"scene");return K.addUniform("viewProjection",16),K.addUniform("view",16),K.addUniform("projection",16),K.addUniform("vEyePosition",4),K}setSceneUniformBuffer(t){this._sceneUbo=t,this._viewUpdateFlag=-1,this._projectionUpdateFlag=-1}getUniqueId(){return H.K.UniqueId}addMesh(t,K=!1){this._blockEntityCollection||(this.meshes.push(t),t._resyncLightSources(),t.parent||t._addToSceneRootNodes(),this.onNewMeshAddedObservable.notifyObservers(t),K&&t.getChildMeshes().forEach((t=>{this.addMesh(t)})))}removeMesh(t,K=!1){const D=this.meshes.indexOf(t);return-1!==D&&(this.meshes.splice(D,1),t.parent||t._removeFromSceneRootNodes()),this._inputManager._invalidateMesh(t),this.onMeshRemovedObservable.notifyObservers(t),K&&t.getChildMeshes().forEach((t=>{this.removeMesh(t)})),D}addTransformNode(t){this._blockEntityCollection||t.getScene()===this&&-1!==t._indexInSceneTransformNodesArray||(t._indexInSceneTransformNodesArray=this.transformNodes.length,this.transformNodes.push(t),t.parent||t._addToSceneRootNodes(),this.onNewTransformNodeAddedObservable.notifyObservers(t))}removeTransformNode(t){const K=t._indexInSceneTransformNodesArray;if(-1!==K){if(K!==this.transformNodes.length-1){const t=this.transformNodes[this.transformNodes.length-1];this.transformNodes[K]=t,t._indexInSceneTransformNodesArray=K}t._indexInSceneTransformNodesArray=-1,this.transformNodes.pop(),t.parent||t._removeFromSceneRootNodes()}return this.onTransformNodeRemovedObservable.notifyObservers(t),K}removeSkeleton(t){const K=this.skeletons.indexOf(t);return-1!==K&&(this.skeletons.splice(K,1),this.onSkeletonRemovedObservable.notifyObservers(t),this._executeActiveContainerCleanup(this._activeSkeletons)),K}removeMorphTargetManager(t){const K=this.morphTargetManagers.indexOf(t);return-1!==K&&this.morphTargetManagers.splice(K,1),K}removeLight(t){const K=this.lights.indexOf(t);if(-1!==K){for(const K of this.meshes)K._removeLightSource(t,!1);this.lights.splice(K,1),this.sortLightsByPriority(),t.parent||t._removeFromSceneRootNodes()}return this.onLightRemovedObservable.notifyObservers(t),K}removeCamera(t){const K=this.cameras.indexOf(t);if(-1!==K&&(this.cameras.splice(K,1),t.parent||t._removeFromSceneRootNodes()),this.activeCameras){const K=this.activeCameras.indexOf(t);-1!==K&&this.activeCameras.splice(K,1)}return this.activeCamera===t&&(this.cameras.length>0?this.activeCamera=this.cameras[0]:this.activeCamera=null),this.onCameraRemovedObservable.notifyObservers(t),K}removeParticleSystem(t){const K=this.particleSystems.indexOf(t);return-1!==K&&(this.particleSystems.splice(K,1),this._executeActiveContainerCleanup(this._activeParticleSystems)),K}removeAnimation(t){const K=this.animations.indexOf(t);return-1!==K&&this.animations.splice(K,1),K}stopAnimation(t,K,D){}removeAnimationGroup(t){const K=this.animationGroups.indexOf(t);return-1!==K&&this.animationGroups.splice(K,1),K}removeMultiMaterial(t){const K=this.multiMaterials.indexOf(t);return-1!==K&&this.multiMaterials.splice(K,1),this.onMultiMaterialRemovedObservable.notifyObservers(t),K}removeMaterial(t){const K=t._indexInSceneMaterialArray;if(-1!==K&&K<this.materials.length){if(K!==this.materials.length-1){const t=this.materials[this.materials.length-1];this.materials[K]=t,t._indexInSceneMaterialArray=K}t._indexInSceneMaterialArray=-1,this.materials.pop()}return this.onMaterialRemovedObservable.notifyObservers(t),K}removeActionManager(t){const K=this.actionManagers.indexOf(t);return-1!==K&&this.actionManagers.splice(K,1),K}removeTexture(t){const K=this.textures.indexOf(t);return-1!==K&&this.textures.splice(K,1),this.onTextureRemovedObservable.notifyObservers(t),K}addLight(t){if(!this._blockEntityCollection){this.lights.push(t),this.sortLightsByPriority(),t.parent||t._addToSceneRootNodes();for(const K of this.meshes)-1===K.lightSources.indexOf(t)&&(K.lightSources.push(t),K._resyncLightSources());this.onNewLightAddedObservable.notifyObservers(t)}}sortLightsByPriority(){this.requireLightSorting&&this.lights.sort(U.c.CompareLightsPriority)}addCamera(t){this._blockEntityCollection||(this.cameras.push(t),this.onNewCameraAddedObservable.notifyObservers(t),t.parent||t._addToSceneRootNodes())}addSkeleton(t){this._blockEntityCollection||(this.skeletons.push(t),this.onNewSkeletonAddedObservable.notifyObservers(t))}addParticleSystem(t){this._blockEntityCollection||this.particleSystems.push(t)}addAnimation(t){this._blockEntityCollection||this.animations.push(t)}addAnimationGroup(t){this._blockEntityCollection||this.animationGroups.push(t)}addMultiMaterial(t){this._blockEntityCollection||(this.multiMaterials.push(t),this.onNewMultiMaterialAddedObservable.notifyObservers(t))}addMaterial(t){this._blockEntityCollection||t.getScene()===this&&-1!==t._indexInSceneMaterialArray||(t._indexInSceneMaterialArray=this.materials.length,this.materials.push(t),this.onNewMaterialAddedObservable.notifyObservers(t))}addMorphTargetManager(t){this._blockEntityCollection||this.morphTargetManagers.push(t)}addGeometry(t){this._blockEntityCollection||(this._geometriesByUniqueId&&(this._geometriesByUniqueId[t.uniqueId]=this.geometries.length),this.geometries.push(t))}addActionManager(t){this.actionManagers.push(t)}addTexture(t){this._blockEntityCollection||(this.textures.push(t),this.onNewTextureAddedObservable.notifyObservers(t))}switchActiveCamera(t,K=!0){this._engine.getInputElement()&&(this.activeCamera&&this.activeCamera.detachControl(),this.activeCamera=t,K&&t.attachControl())}setActiveCameraById(t){const K=this.getCameraById(t);return K?(this.activeCamera=K,K):null}setActiveCameraByName(t){const K=this.getCameraByName(t);return K?(this.activeCamera=K,K):null}getAnimationGroupByName(t){for(let K=0;K<this.animationGroups.length;K++)if(this.animationGroups[K].name===t)return this.animationGroups[K];return null}_getMaterial(t,K){for(let t=0;t<this.materials.length;t++){const D=this.materials[t];if(K(D))return D}if(t)for(let t=0;t<this.multiMaterials.length;t++){const D=this.multiMaterials[t];if(K(D))return D}return null}getMaterialByUniqueID(t,K=!1){return this._getMaterial(K,(K=>K.uniqueId===t))}getMaterialById(t,K=!1){return this._getMaterial(K,(K=>K.id===t))}getMaterialByName(t,K=!1){return this._getMaterial(K,(K=>K.name===t))}getLastMaterialById(t,K=!1){for(let K=this.materials.length-1;K>=0;K--)if(this.materials[K].id===t)return this.materials[K];if(K)for(let K=this.multiMaterials.length-1;K>=0;K--)if(this.multiMaterials[K].id===t)return this.multiMaterials[K];return null}getTextureByUniqueId(t){for(let K=0;K<this.textures.length;K++)if(this.textures[K].uniqueId===t)return this.textures[K];return null}getTextureByName(t){for(let K=0;K<this.textures.length;K++)if(this.textures[K].name===t)return this.textures[K];return null}getCameraById(t){for(let K=0;K<this.cameras.length;K++)if(this.cameras[K].id===t)return this.cameras[K];return null}getCameraByUniqueId(t){for(let K=0;K<this.cameras.length;K++)if(this.cameras[K].uniqueId===t)return this.cameras[K];return null}getCameraByName(t){for(let K=0;K<this.cameras.length;K++)if(this.cameras[K].name===t)return this.cameras[K];return null}getBoneById(t){for(let K=0;K<this.skeletons.length;K++){const D=this.skeletons[K];for(let K=0;K<D.bones.length;K++)if(D.bones[K].id===t)return D.bones[K]}return null}getBoneByName(t){for(let K=0;K<this.skeletons.length;K++){const D=this.skeletons[K];for(let K=0;K<D.bones.length;K++)if(D.bones[K].name===t)return D.bones[K]}return null}getLightByName(t){for(let K=0;K<this.lights.length;K++)if(this.lights[K].name===t)return this.lights[K];return null}getLightById(t){for(let K=0;K<this.lights.length;K++)if(this.lights[K].id===t)return this.lights[K];return null}getLightByUniqueId(t){for(let K=0;K<this.lights.length;K++)if(this.lights[K].uniqueId===t)return this.lights[K];return null}getParticleSystemById(t){for(let K=0;K<this.particleSystems.length;K++)if(this.particleSystems[K].id===t)return this.particleSystems[K];return null}getGeometryById(t){for(let K=0;K<this.geometries.length;K++)if(this.geometries[K].id===t)return this.geometries[K];return null}_getGeometryByUniqueId(t){if(this._geometriesByUniqueId){const K=this._geometriesByUniqueId[t];if(void 0!==K)return this.geometries[K]}else for(let K=0;K<this.geometries.length;K++)if(this.geometries[K].uniqueId===t)return this.geometries[K];return null}pushGeometry(t,K){return!(!K&&this._getGeometryByUniqueId(t.uniqueId)||(this.addGeometry(t),this.onNewGeometryAddedObservable.notifyObservers(t),0))}removeGeometry(t){let K;if(this._geometriesByUniqueId){if(K=this._geometriesByUniqueId[t.uniqueId],void 0===K)return!1}else if(K=this.geometries.indexOf(t),K<0)return!1;if(K!==this.geometries.length-1){const t=this.geometries[this.geometries.length-1];t&&(this.geometries[K]=t,this._geometriesByUniqueId&&(this._geometriesByUniqueId[t.uniqueId]=K))}return this._geometriesByUniqueId&&(this._geometriesByUniqueId[t.uniqueId]=void 0),this.geometries.pop(),this.onGeometryRemovedObservable.notifyObservers(t),!0}getGeometries(){return this.geometries}getMeshById(t){for(let K=0;K<this.meshes.length;K++)if(this.meshes[K].id===t)return this.meshes[K];return null}getMeshesById(t){return this.meshes.filter((function(K){return K.id===t}))}getTransformNodeById(t){for(let K=0;K<this.transformNodes.length;K++)if(this.transformNodes[K].id===t)return this.transformNodes[K];return null}getTransformNodeByUniqueId(t){for(let K=0;K<this.transformNodes.length;K++)if(this.transformNodes[K].uniqueId===t)return this.transformNodes[K];return null}getTransformNodesById(t){return this.transformNodes.filter((function(K){return K.id===t}))}getMeshByUniqueId(t){for(let K=0;K<this.meshes.length;K++)if(this.meshes[K].uniqueId===t)return this.meshes[K];return null}getLastMeshById(t){for(let K=this.meshes.length-1;K>=0;K--)if(this.meshes[K].id===t)return this.meshes[K];return null}getLastTransformNodeById(t){for(let K=this.transformNodes.length-1;K>=0;K--)if(this.transformNodes[K].id===t)return this.transformNodes[K];return null}getLastEntryById(t){let K;for(K=this.meshes.length-1;K>=0;K--)if(this.meshes[K].id===t)return this.meshes[K];for(K=this.transformNodes.length-1;K>=0;K--)if(this.transformNodes[K].id===t)return this.transformNodes[K];for(K=this.cameras.length-1;K>=0;K--)if(this.cameras[K].id===t)return this.cameras[K];for(K=this.lights.length-1;K>=0;K--)if(this.lights[K].id===t)return this.lights[K];return null}getNodeById(t){const K=this.getMeshById(t);if(K)return K;const D=this.getTransformNodeById(t);if(D)return D;const a=this.getLightById(t);if(a)return a;const G=this.getCameraById(t);if(G)return G;return this.getBoneById(t)||null}getNodeByName(t){const K=this.getMeshByName(t);if(K)return K;const D=this.getTransformNodeByName(t);if(D)return D;const a=this.getLightByName(t);if(a)return a;const G=this.getCameraByName(t);if(G)return G;return this.getBoneByName(t)||null}getMeshByName(t){for(let K=0;K<this.meshes.length;K++)if(this.meshes[K].name===t)return this.meshes[K];return null}getTransformNodeByName(t){for(let K=0;K<this.transformNodes.length;K++)if(this.transformNodes[K].name===t)return this.transformNodes[K];return null}getLastSkeletonById(t){for(let K=this.skeletons.length-1;K>=0;K--)if(this.skeletons[K].id===t)return this.skeletons[K];return null}getSkeletonByUniqueId(t){for(let K=0;K<this.skeletons.length;K++)if(this.skeletons[K].uniqueId===t)return this.skeletons[K];return null}getSkeletonById(t){for(let K=0;K<this.skeletons.length;K++)if(this.skeletons[K].id===t)return this.skeletons[K];return null}getSkeletonByName(t){for(let K=0;K<this.skeletons.length;K++)if(this.skeletons[K].name===t)return this.skeletons[K];return null}getMorphTargetManagerById(t){for(let K=0;K<this.morphTargetManagers.length;K++)if(this.morphTargetManagers[K].uniqueId===t)return this.morphTargetManagers[K];return null}getMorphTargetById(t){for(let K=0;K<this.morphTargetManagers.length;++K){const D=this.morphTargetManagers[K];for(let K=0;K<D.numTargets;++K){const a=D.getTarget(K);if(a.id===t)return a}}return null}getMorphTargetByName(t){for(let K=0;K<this.morphTargetManagers.length;++K){const D=this.morphTargetManagers[K];for(let K=0;K<D.numTargets;++K){const a=D.getTarget(K);if(a.name===t)return a}}return null}getPostProcessByName(t){for(let K=0;K<this.postProcesses.length;++K){const D=this.postProcesses[K];if(D.name===t)return D}return null}isActiveMesh(t){return-1!==this._activeMeshes.indexOf(t)}get uid(){return this._uid||(this._uid=a.S0.RandomId()),this._uid}addExternalData(t,K){return this._externalData||(this._externalData=new x.w),this._externalData.add(t,K)}getExternalData(t){return this._externalData?this._externalData.get(t):null}getOrAddExternalDataWithFactory(t,K){return this._externalData||(this._externalData=new x.w),this._externalData.getOrAddWithFactory(t,K)}removeExternalData(t){return this._externalData.remove(t)}_evaluateSubMesh(t,K,D,a){if(a||t.isInFrustum(this._frustumPlanes)){for(const D of this._evaluateSubMeshStage)D.action(K,t);const D=t.getMaterial();null!=D&&(D.hasRenderTargetTextures&&null!=D.getRenderTargetTextures&&-1===this._processedMaterials.indexOf(D)&&(this._processedMaterials.push(D),this._materialsRenderTargets.concatWithNoDuplicate(D.getRenderTargetTextures())),this._renderingManager.dispatch(t,K,D))}}freeProcessedMaterials(){this._processedMaterials.dispose()}get blockfreeActiveMeshesAndRenderingGroups(){return this._preventFreeActiveMeshesAndRenderingGroups}set blockfreeActiveMeshesAndRenderingGroups(t){this._preventFreeActiveMeshesAndRenderingGroups!==t&&(t&&(this.freeActiveMeshes(),this.freeRenderingGroups()),this._preventFreeActiveMeshesAndRenderingGroups=t)}freeActiveMeshes(){if(!this.blockfreeActiveMeshesAndRenderingGroups&&(this._activeMeshes.dispose(),this.activeCamera&&this.activeCamera._activeMeshes&&this.activeCamera._activeMeshes.dispose(),this.activeCameras))for(let t=0;t<this.activeCameras.length;t++){const K=this.activeCameras[t];K&&K._activeMeshes&&K._activeMeshes.dispose()}}freeRenderingGroups(){if(!this.blockfreeActiveMeshesAndRenderingGroups&&(this._renderingManager&&this._renderingManager.freeRenderingGroups(),this.textures))for(let t=0;t<this.textures.length;t++){const K=this.textures[t];K&&K.renderList&&K.freeRenderingGroups()}}_isInIntermediateRendering(){return this._intermediateRendering}freezeActiveMeshes(t=!1,K,D,a=!0,G=!1){return this.executeWhenReady((()=>{if(this.activeCamera){if(this._frustumPlanes||this.updateTransformMatrix(),this._evaluateActiveMeshes(),this._activeMeshesFrozen=!0,this._activeMeshesFrozenButKeepClipping=G,this._skipEvaluateActiveMeshesCompletely=t,a)for(let t=0;t<this._activeMeshes.length;t++)this._activeMeshes.data[t]._freeze();K&&K()}else D&&D("No active camera found")})),this}unfreezeActiveMeshes(){for(let t=0;t<this.meshes.length;t++){const K=this.meshes[t];K._internalAbstractMeshDataInfo&&(K._internalAbstractMeshDataInfo._isActive=!1)}for(let t=0;t<this._activeMeshes.length;t++)this._activeMeshes.data[t]._unFreeze();return this._activeMeshesFrozen=!1,this}_executeActiveContainerCleanup(t){(!this._engine.snapshotRendering||1!==this._engine.snapshotRenderingMode)&&this._activeMeshesFrozen&&this._activeMeshes.length||this.onBeforeRenderObservable.addOnce((()=>t.dispose()))}_evaluateActiveMeshes(){var t;if(this._engine.snapshotRendering&&1===this._engine.snapshotRenderingMode)return void(this._activeMeshes.length>0&&(null===(t=this.activeCamera)||void 0===t||t._activeMeshes.reset(),this._activeMeshes.reset(),this._renderingManager.reset(),this._processedMaterials.reset(),this._activeParticleSystems.reset(),this._activeSkeletons.reset(),this._softwareSkinnedMeshes.reset()));if(this._activeMeshesFrozen&&this._activeMeshes.length){if(!this._skipEvaluateActiveMeshesCompletely){const t=this._activeMeshes.length;for(let K=0;K<t;K++)this._activeMeshes.data[K].computeWorldMatrix()}if(this._activeParticleSystems){const t=this._activeParticleSystems.length;for(let K=0;K<t;K++)this._activeParticleSystems.data[K].animate()}return void this._renderingManager.resetSprites()}if(!this.activeCamera)return;this.onBeforeActiveMeshesEvaluationObservable.notifyObservers(this),this.activeCamera._activeMeshes.reset(),this._activeMeshes.reset(),this._renderingManager.reset(),this._processedMaterials.reset(),this._activeParticleSystems.reset(),this._activeSkeletons.reset(),this._softwareSkinnedMeshes.reset(),this._materialsRenderTargets.reset();for(const t of this._beforeEvaluateActiveMeshStage)t.action();const K=this.getActiveMeshCandidates(),D=K.length;for(let t=0;t<D;t++){const D=K.data[t];if(D._internalAbstractMeshDataInfo._currentLODIsUpToDate=!1,D.isBlocked)continue;if(this._totalVertices.addCount(D.getTotalVertices(),!1),!D.isReady()||!D.isEnabled()||D.scaling.hasAZeroComponent)continue;D.computeWorldMatrix(),D.actionManager&&D.actionManager.hasSpecificTriggers2(12,13)&&this._meshesForIntersections.pushNoDuplicate(D);let a=this.customLODSelector?this.customLODSelector(D,this.activeCamera):D.getLOD(this.activeCamera);if(D._internalAbstractMeshDataInfo._currentLOD=a,D._internalAbstractMeshDataInfo._currentLODIsUpToDate=!0,null!=a&&(a!==D&&0!==a.billboardMode&&a.computeWorldMatrix(),D._preActivate(),D.isVisible&&D.visibility>0&&D.layerMask&this.activeCamera.layerMask&&(this._skipFrustumClipping||D.alwaysSelectAsActiveMesh||D.isInFrustum(this._frustumPlanes)))){this._activeMeshes.push(D),this.activeCamera._activeMeshes.push(D),a!==D&&a._activate(this._renderId,!1);for(const t of this._preActiveMeshStage)t.action(D);D._activate(this._renderId,!1)&&(D.isAnInstance?D._internalAbstractMeshDataInfo._actAsRegularMesh&&(a=D):a._internalAbstractMeshDataInfo._onlyForInstances=!1,a._internalAbstractMeshDataInfo._isActive=!0,this._activeMesh(D,a)),D._postActivate()}}if(this.onAfterActiveMeshesEvaluationObservable.notifyObservers(this),this.particlesEnabled){this.onBeforeParticlesRenderingObservable.notifyObservers(this);for(let t=0;t<this.particleSystems.length;t++){const K=this.particleSystems[t];if(!K.isStarted()||!K.emitter)continue;const D=K.emitter;D.position&&!D.isEnabled()||(this._activeParticleSystems.push(K),K.animate(),this._renderingManager.dispatchParticles(K))}this.onAfterParticlesRenderingObservable.notifyObservers(this)}}_activeMesh(t,K){this._skeletonsEnabled&&null!==K.skeleton&&void 0!==K.skeleton&&(this._activeSkeletons.pushNoDuplicate(K.skeleton)&&(K.skeleton.prepare(),this._activeBones.addCount(K.skeleton.bones.length,!1)),K.computeBonesUsingShaders||this._softwareSkinnedMeshes.pushNoDuplicate(K));let D=t.hasInstances||t.isAnInstance||this.dispatchAllSubMeshesOfActiveMeshes||this._skipFrustumClipping||K.alwaysSelectAsActiveMesh;if(K&&K.subMeshes&&K.subMeshes.length>0){const a=this.getActiveSubMeshCandidates(K),G=a.length;D=D||1===G;for(let N=0;N<G;N++){const G=a.data[N];this._evaluateSubMesh(G,K,t,D)}}}updateTransformMatrix(t){const K=this.activeCamera;if(K)if(K._renderingMultiview){const D=K._rigCameras[0],a=K._rigCameras[1];this.setTransformMatrix(D.getViewMatrix(),D.getProjectionMatrix(t),a.getViewMatrix(),a.getProjectionMatrix(t))}else this.setTransformMatrix(K.getViewMatrix(),K.getProjectionMatrix(t))}_bindFrameBuffer(t,K=!0){t&&t._multiviewTexture?t._multiviewTexture._bindFrameBuffer():t&&t.outputRenderTarget?t.outputRenderTarget._bindFrameBuffer():this._engine._currentFrameBufferIsDefaultFrameBuffer()||this._engine.restoreDefaultFramebuffer(),K&&this._clearFrameBuffer(t)}_clearFrameBuffer(t){if(t&&t._multiviewTexture);else if(t&&t.outputRenderTarget&&!t._renderingMultiview){const K=t.outputRenderTarget;K.onClearObservable.hasObservers()?K.onClearObservable.notifyObservers(this._engine):K.skipInitialClear||t.isRightCamera||(this.autoClear&&this._engine.clear(K.clearColor||this.clearColor,!K._cleared,!0,!0),K._cleared=!0)}else this._defaultFrameBufferCleared?this._engine.clear(null,!1,!0,!0):(this._defaultFrameBufferCleared=!0,this._clear())}_renderForCamera(t,K,D=!0){var G,N,W;if(t&&t._skipRendering)return;const x=this._engine;if(this._activeCamera=t,!this.activeCamera)throw new Error("Active camera not set");if(x.setViewport(this.activeCamera.viewport),this.resetCachedMaterial(),this._renderId++,!this.prePass&&D){let K=!0;t._renderingMultiview&&t.outputRenderTarget&&(K=t.outputRenderTarget.skipInitialClear,this.autoClear&&(this._defaultFrameBufferCleared=!1,t.outputRenderTarget.skipInitialClear=!1)),this._bindFrameBuffer(this._activeCamera),t._renderingMultiview&&t.outputRenderTarget&&(t.outputRenderTarget.skipInitialClear=K)}this.updateTransformMatrix(),this.onBeforeCameraRenderObservable.notifyObservers(this.activeCamera),this._evaluateActiveMeshes();for(let t=0;t<this._softwareSkinnedMeshes.length;t++){const K=this._softwareSkinnedMeshes.data[t];K.applySkeleton(K.skeleton)}this.onBeforeRenderTargetsRenderObservable.notifyObservers(this),this._renderTargets.concatWithNoDuplicate(this._materialsRenderTargets),t.customRenderTargets&&t.customRenderTargets.length>0&&this._renderTargets.concatWithNoDuplicate(t.customRenderTargets),K&&K.customRenderTargets&&K.customRenderTargets.length>0&&this._renderTargets.concatWithNoDuplicate(K.customRenderTargets),this.environmentTexture&&this.environmentTexture.isRenderTarget&&this._renderTargets.pushNoDuplicate(this.environmentTexture);for(const t of this._gatherActiveCameraRenderTargetsStage)t.action(this._renderTargets);let b=!1;if(this.renderTargetsEnabled){if(this._intermediateRendering=!0,this._renderTargets.length>0){a.S0.StartPerformanceCounter("Render targets",this._renderTargets.length>0);for(let t=0;t<this._renderTargets.length;t++){const K=this._renderTargets.data[t];if(K._shouldRender()){this._renderId++;const t=K.activeCamera&&K.activeCamera!==this.activeCamera;K.render(t,this.dumpNextRenderTargets),b=!0}}a.S0.EndPerformanceCounter("Render targets",this._renderTargets.length>0),this._renderId++}for(const t of this._cameraDrawRenderTargetStage)b=t.action(this.activeCamera)||b;this._intermediateRendering=!1}this._engine.currentRenderPassId=null!==(W=null!==(N=null===(G=t.outputRenderTarget)||void 0===G?void 0:G.renderPassId)&&void 0!==N?N:t.renderPassId)&&void 0!==W?W:0,b&&!this.prePass&&(this._bindFrameBuffer(this._activeCamera,!1),this.updateTransformMatrix()),this.onAfterRenderTargetsRenderObservable.notifyObservers(this),!this.postProcessManager||t._multiviewTexture||this.prePass||this.postProcessManager._prepareFrame();for(const t of this._beforeCameraDrawStage)t.action(this.activeCamera);this.onBeforeDrawPhaseObservable.notifyObservers(this),x.snapshotRendering&&1===x.snapshotRenderingMode&&this.finalizeSceneUbo(),this._renderingManager.render(null,null,!0,!0),this.onAfterDrawPhaseObservable.notifyObservers(this);for(const t of this._afterCameraDrawStage)t.action(this.activeCamera);if(this.postProcessManager&&!t._multiviewTexture){const K=t.outputRenderTarget?t.outputRenderTarget.renderTarget:void 0;this.postProcessManager._finalizeFrame(t.isIntermediate,K)}for(const t of this._afterCameraPostProcessStage)t.action(this.activeCamera);this._renderTargets.reset(),this.onAfterCameraRenderObservable.notifyObservers(this.activeCamera)}_processSubCameras(t,K=!0){if(0===t.cameraRigMode||t._renderingMultiview)return t._renderingMultiview&&!this._multiviewSceneUbo&&this._createMultiviewUbo(),this._renderForCamera(t,void 0,K),void this.onAfterRenderCameraObservable.notifyObservers(t);if(t._useMultiviewToSingleView)this._renderMultiviewToSingleView(t);else{this.onBeforeCameraRenderObservable.notifyObservers(t);for(let K=0;K<t._rigCameras.length;K++)this._renderForCamera(t._rigCameras[K],t)}this._activeCamera=t,this.updateTransformMatrix(),this.onAfterRenderCameraObservable.notifyObservers(t)}_checkIntersections(){for(let t=0;t<this._meshesForIntersections.length;t++){const K=this._meshesForIntersections.data[t];if(K.actionManager)for(let t=0;K.actionManager&&t<K.actionManager.actions.length;t++){const D=K.actionManager.actions[t];if(12===D.trigger||13===D.trigger){const t=D.getTriggerParameter(),a=t.mesh?t.mesh:t,G=a.intersectsMesh(K,t.usePreciseIntersection),N=K._intersectionsInProgress.indexOf(a);G&&-1===N?12===D.trigger?(D._executeCurrent(Z.X.CreateNew(K,void 0,a)),K._intersectionsInProgress.push(a)):13===D.trigger&&K._intersectionsInProgress.push(a):!G&&N>-1&&(13===D.trigger&&D._executeCurrent(Z.X.CreateNew(K,void 0,a)),K.actionManager.hasSpecificTrigger(13,(t=>{const K=t.mesh?t.mesh:t;return a===K}))&&13!==D.trigger||K._intersectionsInProgress.splice(N,1))}}}}_advancePhysicsEngineStep(t){}_animate(t){}animate(){if(this._engine.isDeterministicLockStep()){let t=Math.max(R.MinDeltaTime,Math.min(this._engine.getDeltaTime(),R.MaxDeltaTime))+this._timeAccumulator;const K=this._engine.getTimeStep(),D=1e3/K/1e3;let a=0;const G=this._engine.getLockstepMaxSteps();let N=Math.floor(t/K);for(N=Math.min(N,G);t>0&&a<N;)this.onBeforeStepObservable.notifyObservers(this),this._animationRatio=K*D,this._animate(K),this.onAfterAnimationsObservable.notifyObservers(this),this.physicsEnabled&&this._advancePhysicsEngineStep(K),this.onAfterStepObservable.notifyObservers(this),this._currentStepId++,a++,t-=K;this._timeAccumulator=t<0?0:t}else{const t=this.useConstantAnimationDeltaTime?16:Math.max(R.MinDeltaTime,Math.min(this._engine.getDeltaTime(),R.MaxDeltaTime));this._animationRatio=t*(60/1e3),this._animate(),this.onAfterAnimationsObservable.notifyObservers(this),this.physicsEnabled&&this._advancePhysicsEngineStep(t)}}_clear(){(this.autoClearDepthAndStencil||this.autoClear)&&this._engine.clear(this.clearColor,this.autoClear||this.forceWireframe||this.forcePointsCloud,this.autoClearDepthAndStencil,this.autoClearDepthAndStencil)}_checkCameraRenderTarget(t){var K;if((null==t?void 0:t.outputRenderTarget)&&!(null==t?void 0:t.isRigCamera)&&(t.outputRenderTarget._cleared=!1),null===(K=null==t?void 0:t.rigCameras)||void 0===K?void 0:K.length)for(let K=0;K<t.rigCameras.length;++K){const D=t.rigCameras[K].outputRenderTarget;D&&(D._cleared=!1)}}resetDrawCache(t){if(this.meshes)for(const K of this.meshes)K.resetDrawCache(t)}render(t=!0,K=!1){var D,G,N;if(this.isDisposed)return;this.onReadyObservable.hasObservers()&&null===this._executeWhenReadyTimeoutId&&this._checkIsReady(),this._frameId++,this._defaultFrameBufferCleared=!1,this._checkCameraRenderTarget(this.activeCamera),(null===(D=this.activeCameras)||void 0===D?void 0:D.length)&&this.activeCameras.forEach(this._checkCameraRenderTarget),this._registerTransientComponents(),this._activeParticles.fetchNewFrame(),this._totalVertices.fetchNewFrame(),this._activeIndices.fetchNewFrame(),this._activeBones.fetchNewFrame(),this._meshesForIntersections.reset(),this.resetCachedMaterial(),this.onBeforeAnimationsObservable.notifyObservers(this),this.actionManager&&this.actionManager.processTrigger(11),K||this.animate();for(const t of this._beforeCameraUpdateStage)t.action();if(t)if(this.activeCameras&&this.activeCameras.length>0)for(let t=0;t<this.activeCameras.length;t++){const K=this.activeCameras[t];if(K.update(),0!==K.cameraRigMode)for(let t=0;t<K._rigCameras.length;t++)K._rigCameras[t].update()}else if(this.activeCamera&&(this.activeCamera.update(),0!==this.activeCamera.cameraRigMode))for(let t=0;t<this.activeCamera._rigCameras.length;t++)this.activeCamera._rigCameras[t].update();this.onBeforeRenderObservable.notifyObservers(this);const W=this.getEngine();this.onBeforeRenderTargetsRenderObservable.notifyObservers(this);const x=(null===(G=this.activeCameras)||void 0===G?void 0:G.length)?this.activeCameras[0]:this.activeCamera;if(this.renderTargetsEnabled){a.S0.StartPerformanceCounter("Custom render targets",this.customRenderTargets.length>0),this._intermediateRendering=!0;for(let t=0;t<this.customRenderTargets.length;t++){const K=this.customRenderTargets[t];if(K._shouldRender()){if(this._renderId++,this.activeCamera=K.activeCamera||this.activeCamera,!this.activeCamera)throw new Error("Active camera not set");W.setViewport(this.activeCamera.viewport),this.updateTransformMatrix(),K.render(x!==this.activeCamera,this.dumpNextRenderTargets)}}a.S0.EndPerformanceCounter("Custom render targets",this.customRenderTargets.length>0),this._intermediateRendering=!1,this._renderId++}this._engine.currentRenderPassId=null!==(N=null==x?void 0:x.renderPassId)&&void 0!==N?N:0,this.activeCamera=x,this._activeCamera&&22!==this._activeCamera.cameraRigMode&&!this.prePass&&this._bindFrameBuffer(this._activeCamera,!1),this.onAfterRenderTargetsRenderObservable.notifyObservers(this);for(const t of this._beforeClearStage)t.action();this._clearFrameBuffer(this.activeCamera);for(const t of this._gatherRenderTargetsStage)t.action(this._renderTargets);if(this.activeCameras&&this.activeCameras.length>0)for(let t=0;t<this.activeCameras.length;t++)this._processSubCameras(this.activeCameras[t],t>0);else{if(!this.activeCamera)throw new Error("No camera defined");this._processSubCameras(this.activeCamera,!!this.activeCamera.outputRenderTarget)}this._checkIntersections();for(const t of this._afterRenderStage)t.action();if(this.afterRender&&this.afterRender(),this.onAfterRenderObservable.notifyObservers(this),this._toBeDisposed.length){for(let t=0;t<this._toBeDisposed.length;t++){const K=this._toBeDisposed[t];K&&K.dispose()}this._toBeDisposed.length=0}this.dumpNextRenderTargets&&(this.dumpNextRenderTargets=!1),this._activeBones.addCount(0,!0),this._activeIndices.addCount(0,!0),this._activeParticles.addCount(0,!0),this._engine.restoreDefaultFramebuffer()}freezeMaterials(){for(let t=0;t<this.materials.length;t++)this.materials[t].freeze()}unfreezeMaterials(){for(let t=0;t<this.materials.length;t++)this.materials[t].unfreeze()}dispose(){if(this.isDisposed)return;this.beforeRender=null,this.afterRender=null,this.metadata=null,this.skeletons.length=0,this.morphTargetManagers.length=0,this._transientComponents.length=0,this._isReadyForMeshStage.clear(),this._beforeEvaluateActiveMeshStage.clear(),this._evaluateSubMeshStage.clear(),this._preActiveMeshStage.clear(),this._cameraDrawRenderTargetStage.clear(),this._beforeCameraDrawStage.clear(),this._beforeRenderTargetDrawStage.clear(),this._beforeRenderingGroupDrawStage.clear(),this._beforeRenderingMeshStage.clear(),this._afterRenderingMeshStage.clear(),this._afterRenderingGroupDrawStage.clear(),this._afterCameraDrawStage.clear(),this._afterRenderTargetDrawStage.clear(),this._afterRenderStage.clear(),this._beforeCameraUpdateStage.clear(),this._beforeClearStage.clear(),this._gatherRenderTargetsStage.clear(),this._gatherActiveCameraRenderTargetsStage.clear(),this._pointerMoveStage.clear(),this._pointerDownStage.clear(),this._pointerUpStage.clear(),this.importedMeshesFiles=[],this.stopAllAnimations&&(this._activeAnimatables.forEach((t=>{t.onAnimationEndObservable.clear(),t.onAnimationEnd=null})),this.stopAllAnimations()),this.resetCachedMaterial(),this.activeCamera&&(this.activeCamera._activeMeshes.dispose(),this.activeCamera=null),this.activeCameras=null,this._activeMeshes.dispose(),this._renderingManager.dispose(),this._processedMaterials.dispose(),this._activeParticleSystems.dispose(),this._activeSkeletons.dispose(),this._softwareSkinnedMeshes.dispose(),this._renderTargets.dispose(),this._materialsRenderTargets.dispose(),this._registeredForLateAnimationBindings.dispose(),this._meshesForIntersections.dispose(),this._toBeDisposed.length=0;const t=this._activeRequests.slice();for(const K of t)K.abort();this._activeRequests.length=0;try{this.onDisposeObservable.notifyObservers(this)}catch(t){c.V.Error("An error occurred while calling onDisposeObservable!",t)}if(this.detachControl(),this._engine.getInputElement())for(let t=0;t<this.cameras.length;t++)this.cameras[t].detachControl();this._disposeList(this.animationGroups),this._disposeList(this.lights),this._disposeList(this.meshes,(t=>t.dispose(!0))),this._disposeList(this.transformNodes,(t=>t.dispose(!0)));const K=this.cameras;this._disposeList(K),this._defaultMaterial&&this._defaultMaterial.dispose(),this._disposeList(this.multiMaterials),this._disposeList(this.materials),this._disposeList(this.particleSystems),this._disposeList(this.postProcesses),this._disposeList(this.textures),this._disposeList(this.morphTargetManagers),this._sceneUbo.dispose(),this._multiviewSceneUbo&&this._multiviewSceneUbo.dispose(),this.postProcessManager.dispose(),this._disposeList(this._components);let D=this._engine.scenes.indexOf(this);D>-1&&this._engine.scenes.splice(D,1),E.q._LastCreatedScene===this&&(this._engine.scenes.length>0?E.q._LastCreatedScene=this._engine.scenes[this._engine.scenes.length-1]:E.q._LastCreatedScene=null),D=this._engine._virtualScenes.indexOf(this),D>-1&&this._engine._virtualScenes.splice(D,1),this._engine.wipeCaches(!0),this.onDisposeObservable.clear(),this.onBeforeRenderObservable.clear(),this.onAfterRenderObservable.clear(),this.onBeforeRenderTargetsRenderObservable.clear(),this.onAfterRenderTargetsRenderObservable.clear(),this.onAfterStepObservable.clear(),this.onBeforeStepObservable.clear(),this.onBeforeActiveMeshesEvaluationObservable.clear(),this.onAfterActiveMeshesEvaluationObservable.clear(),this.onBeforeParticlesRenderingObservable.clear(),this.onAfterParticlesRenderingObservable.clear(),this.onBeforeDrawPhaseObservable.clear(),this.onAfterDrawPhaseObservable.clear(),this.onBeforeAnimationsObservable.clear(),this.onAfterAnimationsObservable.clear(),this.onDataLoadedObservable.clear(),this.onBeforeRenderingGroupObservable.clear(),this.onAfterRenderingGroupObservable.clear(),this.onMeshImportedObservable.clear(),this.onBeforeCameraRenderObservable.clear(),this.onAfterCameraRenderObservable.clear(),this.onAfterRenderCameraObservable.clear(),this.onReadyObservable.clear(),this.onNewCameraAddedObservable.clear(),this.onCameraRemovedObservable.clear(),this.onNewLightAddedObservable.clear(),this.onLightRemovedObservable.clear(),this.onNewGeometryAddedObservable.clear(),this.onGeometryRemovedObservable.clear(),this.onNewTransformNodeAddedObservable.clear(),this.onTransformNodeRemovedObservable.clear(),this.onNewMeshAddedObservable.clear(),this.onMeshRemovedObservable.clear(),this.onNewSkeletonAddedObservable.clear(),this.onSkeletonRemovedObservable.clear(),this.onNewMaterialAddedObservable.clear(),this.onNewMultiMaterialAddedObservable.clear(),this.onMaterialRemovedObservable.clear(),this.onMultiMaterialRemovedObservable.clear(),this.onNewTextureAddedObservable.clear(),this.onTextureRemovedObservable.clear(),this.onPrePointerObservable.clear(),this.onPointerObservable.clear(),this.onPreKeyboardObservable.clear(),this.onKeyboardObservable.clear(),this.onActiveCameraChanged.clear(),this.onScenePerformancePriorityChangedObservable.clear(),this._isDisposed=!0}_disposeList(t,K){const D=t.slice(0);K=null!=K?K:t=>t.dispose();for(const t of D)K(t);t.length=0}get isDisposed(){return this._isDisposed}clearCachedVertexData(){for(let t=0;t<this.meshes.length;t++){const K=this.meshes[t].geometry;K&&K.clearCachedData()}}cleanCachedTextureBuffer(){for(const t of this.textures)t._buffer&&(t._buffer=null)}getWorldExtends(t){const K=new n.Pq(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),D=new n.Pq(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return t=t||(()=>!0),this.meshes.filter(t).forEach((t=>{if(t.computeWorldMatrix(!0),!t.subMeshes||0===t.subMeshes.length||t.infiniteDistance)return;const a=t.getBoundingInfo(),G=a.boundingBox.minimumWorld,N=a.boundingBox.maximumWorld;n.Pq.CheckExtends(G,K,D),n.Pq.CheckExtends(N,K,D)})),{min:K,max:D}}createPickingRay(t,K,D,a,G=!1){throw l.n("Ray")}createPickingRayToRef(t,K,D,a,G,N=!1,W=!1){throw l.n("Ray")}createPickingRayInCameraSpace(t,K,D){throw l.n("Ray")}createPickingRayInCameraSpaceToRef(t,K,D,a){throw l.n("Ray")}get _pickingAvailable(){return!1}pick(t,K,D,a,G,N){const W=l.n("Ray",!0);return W&&c.V.Warn(W),new I.G}pickWithBoundingInfo(t,K,D,a,G){const N=l.n("Ray",!0);return N&&c.V.Warn(N),new I.G}pickWithRay(t,K,D,a){throw l.n("Ray")}multiPick(t,K,D,a,G){throw l.n("Ray")}multiPickWithRay(t,K,D){throw l.n("Ray")}setPointerOverMesh(t,K,D){this._inputManager.setPointerOverMesh(t,K,D)}getPointerOverMesh(){return this._inputManager.getPointerOverMesh()}_rebuildGeometries(){for(const t of this.geometries)t._rebuild();for(const t of this.meshes)t._rebuild();this.postProcessManager&&this.postProcessManager._rebuild();for(const t of this._components)t.rebuild();for(const t of this.particleSystems)t.rebuild();if(this.spriteManagers)for(const t of this.spriteManagers)t.rebuild()}_rebuildTextures(){for(const t of this.textures)t._rebuild(!0);this.markAllMaterialsAsDirty(1)}_getByTags(t,K,D){if(void 0===K)return t;const a=[];for(const G in t){const N=t[G];b.Y&&b.Y.MatchesQuery(N,K)&&(!D||D(N))&&a.push(N)}return a}getMeshesByTags(t,K){return this._getByTags(this.meshes,t,K)}getCamerasByTags(t,K){return this._getByTags(this.cameras,t,K)}getLightsByTags(t,K){return this._getByTags(this.lights,t,K)}getMaterialByTags(t,K){return this._getByTags(this.materials,t,K).concat(this._getByTags(this.multiMaterials,t,K))}getTransformNodesByTags(t,K){return this._getByTags(this.transformNodes,t,K)}setRenderingOrder(t,K=null,D=null,a=null){this._renderingManager.setRenderingOrder(t,K,D,a)}setRenderingAutoClearDepthStencil(t,K,D=!0,a=!0){this._renderingManager.setRenderingAutoClearDepthStencil(t,K,D,a)}getAutoClearDepthStencilSetup(t){return this._renderingManager.getAutoClearDepthStencilSetup(t)}_forceBlockMaterialDirtyMechanism(t){this._blockMaterialDirtyMechanism=t}get blockMaterialDirtyMechanism(){return this._blockMaterialDirtyMechanism}set blockMaterialDirtyMechanism(t){this._blockMaterialDirtyMechanism!==t&&(this._blockMaterialDirtyMechanism=t,t||this.markAllMaterialsAsDirty(63))}markAllMaterialsAsDirty(t,K){if(!this._blockMaterialDirtyMechanism)for(const D of this.materials)K&&!K(D)||D.markAsDirty(t)}_loadFile(t,K,D,a,G,N,W){const x=o.zU(t,K,D,a?this.offlineProvider:void 0,G,N,W);return this._activeRequests.push(x),x.onCompleteObservable.add((t=>{this._activeRequests.splice(this._activeRequests.indexOf(t),1)})),x}_loadFileAsync(t,K,D,a,G){return new Promise(((N,W)=>{this._loadFile(t,(t=>{N(t)}),K,D,a,((t,K)=>{W(K)}),G)}))}_requestFile(t,K,D,a,G,N,W){const x=o.sh(t,K,D,a?this.offlineProvider:void 0,G,N,W);return this._activeRequests.push(x),x.onCompleteObservable.add((t=>{this._activeRequests.splice(this._activeRequests.indexOf(t),1)})),x}_requestFileAsync(t,K,D,a,G){return new Promise(((N,W)=>{this._requestFile(t,(t=>{N(t)}),K,D,a,(t=>{W(t)}),G)}))}_readFile(t,K,D,a,G){const N=o.NJ(t,K,D,a,G);return this._activeRequests.push(N),N.onCompleteObservable.add((t=>{this._activeRequests.splice(this._activeRequests.indexOf(t),1)})),N}_readFileAsync(t,K,D){return new Promise(((a,G)=>{this._readFile(t,(t=>{a(t)}),K,D,(t=>{G(t)}))}))}getPerfCollector(){throw l.n("performanceViewerSceneExtension")}setActiveCameraByID(t){return this.setActiveCameraById(t)}getMaterialByID(t){return this.getMaterialById(t)}getLastMaterialByID(t){return this.getLastMaterialById(t)}getTextureByUniqueID(t){return this.getTextureByUniqueId(t)}getCameraByID(t){return this.getCameraById(t)}getCameraByUniqueID(t){return this.getCameraByUniqueId(t)}getBoneByID(t){return this.getBoneById(t)}getLightByID(t){return this.getLightById(t)}getLightByUniqueID(t){return this.getLightByUniqueId(t)}getParticleSystemByID(t){return this.getParticleSystemById(t)}getGeometryByID(t){return this.getGeometryById(t)}getMeshByID(t){return this.getMeshById(t)}getMeshByUniqueID(t){return this.getMeshByUniqueId(t)}getLastMeshByID(t){return this.getLastMeshById(t)}getMeshesByID(t){return this.getMeshesById(t)}getTransformNodeByID(t){return this.getTransformNodeById(t)}getTransformNodeByUniqueID(t){return this.getTransformNodeByUniqueId(t)}getTransformNodesByID(t){return this.getTransformNodesById(t)}getNodeByID(t){return this.getNodeById(t)}getLastEntryByID(t){return this.getLastEntryById(t)}getLastSkeletonByID(t){return this.getLastSkeletonById(t)}}R.FOGMODE_NONE=0,R.FOGMODE_EXP=1,R.FOGMODE_EXP2=2,R.FOGMODE_LINEAR=3,R.MinDeltaTime=1,R.MaxDeltaTime=1e3,g.Y5("BABYLON.Scene",R)},122030:(t,K,D)=>{D.d(K,{B:()=>G,v:()=>a});class a{}a.NAME_EFFECTLAYER="EffectLayer",a.NAME_LAYER="Layer",a.NAME_LENSFLARESYSTEM="LensFlareSystem",a.NAME_BOUNDINGBOXRENDERER="BoundingBoxRenderer",a.NAME_PARTICLESYSTEM="ParticleSystem",a.NAME_GAMEPAD="Gamepad",a.NAME_SIMPLIFICATIONQUEUE="SimplificationQueue",a.NAME_GEOMETRYBUFFERRENDERER="GeometryBufferRenderer",a.NAME_PREPASSRENDERER="PrePassRenderer",a.NAME_DEPTHRENDERER="DepthRenderer",a.NAME_DEPTHPEELINGRENDERER="DepthPeelingRenderer",a.NAME_IBLSHADOWSRENDERER="IblShadowsRenderer",a.NAME_POSTPROCESSRENDERPIPELINEMANAGER="PostProcessRenderPipelineManager",a.NAME_SPRITE="Sprite",a.NAME_SUBSURFACE="SubSurface",a.NAME_OUTLINERENDERER="Outline",a.NAME_PROCEDURALTEXTURE="ProceduralTexture",a.NAME_SHADOWGENERATOR="ShadowGenerator",a.NAME_OCTREE="Octree",a.NAME_PHYSICSENGINE="PhysicsEngine",a.NAME_AUDIO="Audio",a.NAME_FLUIDRENDERER="FluidRenderer",a.STEP_ISREADYFORMESH_EFFECTLAYER=0,a.STEP_BEFOREEVALUATEACTIVEMESH_BOUNDINGBOXRENDERER=0,a.STEP_EVALUATESUBMESH_BOUNDINGBOXRENDERER=0,a.STEP_PREACTIVEMESH_BOUNDINGBOXRENDERER=0,a.STEP_CAMERADRAWRENDERTARGET_EFFECTLAYER=1,a.STEP_BEFORECAMERADRAW_PREPASS=0,a.STEP_BEFORECAMERADRAW_EFFECTLAYER=1,a.STEP_BEFORECAMERADRAW_LAYER=2,a.STEP_BEFORERENDERTARGETDRAW_PREPASS=0,a.STEP_BEFORERENDERTARGETDRAW_LAYER=1,a.STEP_BEFORERENDERINGMESH_PREPASS=0,a.STEP_BEFORERENDERINGMESH_OUTLINE=1,a.STEP_AFTERRENDERINGMESH_PREPASS=0,a.STEP_AFTERRENDERINGMESH_OUTLINE=1,a.STEP_AFTERRENDERINGGROUPDRAW_EFFECTLAYER_DRAW=0,a.STEP_AFTERRENDERINGGROUPDRAW_BOUNDINGBOXRENDERER=1,a.STEP_BEFORECAMERAUPDATE_SIMPLIFICATIONQUEUE=0,a.STEP_BEFORECAMERAUPDATE_GAMEPAD=1,a.STEP_BEFORECLEAR_PROCEDURALTEXTURE=0,a.STEP_BEFORECLEAR_PREPASS=1,a.STEP_BEFORERENDERTARGETCLEAR_PREPASS=0,a.STEP_AFTERRENDERTARGETDRAW_PREPASS=0,a.STEP_AFTERRENDERTARGETDRAW_LAYER=1,a.STEP_AFTERCAMERADRAW_PREPASS=0,a.STEP_AFTERCAMERADRAW_EFFECTLAYER=1,a.STEP_AFTERCAMERADRAW_LENSFLARESYSTEM=2,a.STEP_AFTERCAMERADRAW_EFFECTLAYER_DRAW=3,a.STEP_AFTERCAMERADRAW_LAYER=4,a.STEP_AFTERCAMERADRAW_FLUIDRENDERER=5,a.STEP_AFTERCAMERAPOSTPROCESS_LAYER=0,a.STEP_AFTERRENDERTARGETPOSTPROCESS_LAYER=0,a.STEP_AFTERRENDER_AUDIO=0,a.STEP_GATHERRENDERTARGETS_DEPTHRENDERER=0,a.STEP_GATHERRENDERTARGETS_GEOMETRYBUFFERRENDERER=1,a.STEP_GATHERRENDERTARGETS_SHADOWGENERATOR=2,a.STEP_GATHERRENDERTARGETS_POSTPROCESSRENDERPIPELINEMANAGER=3,a.STEP_GATHERACTIVECAMERARENDERTARGETS_DEPTHRENDERER=0,a.STEP_GATHERACTIVECAMERARENDERTARGETS_FLUIDRENDERER=1,a.STEP_POINTERMOVE_SPRITE=0,a.STEP_POINTERDOWN_SPRITE=0,a.STEP_POINTERUP_SPRITE=0;class G extends Array{constructor(t){super(...t)}static Create(){return Object.create(G.prototype)}registerStep(t,K,D){let a=0,G=Number.MAX_VALUE;for(;a<this.length&&(G=this[a].index,!(t<G));a++);this.splice(a,0,{index:t,component:K,action:D.bind(K)})}clear(){this.length=0}}},297809:(t,K,D)=>{function a(t,K,D,a){var G,N=arguments.length,W=N<3?K:null===a?a=Object.getOwnPropertyDescriptor(K,D):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)W=Reflect.decorate(t,K,D,a);else for(var x=t.length-1;x>=0;x--)(G=t[x])&&(W=(N<3?G(W):N>3?G(K,D,W):G(K,D))||W);return N>3&&W&&Object.defineProperty(K,D,W),W}D.d(K,{Cg:()=>a}),Object.create,Object.create}},b={};function n(t){var K=b[t];if(void 0!==K)return K.exports;var D=b[t]={id:t,loaded:!1,exports:{}};return x[t].call(D.exports,D,D.exports,n),D.loaded=!0,D.exports}n.m=x,t=[],n.O=(K,D,a,G)=>{if(!D){var N=1/0;for(e=0;e<t.length;e++){for(var[D,a,G]=t[e],W=!0,x=0;x<D.length;x++)(!1&G||N>=G)&&Object.keys(n.O).every((t=>n.O[t](D[x])))?D.splice(x--,1):(W=!1,G<N&&(N=G));if(W){t.splice(e--,1);var b=a();void 0!==b&&(K=b)}}return K}G=G||0;for(var e=t.length;e>0&&t[e-1][2]>G;e--)t[e]=t[e-1];t[e]=[D,a,G]},n.n=t=>{var K=t&&t.__esModule?()=>t["default"]:()=>t;return n.d(K,{a:K}),K},D=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,n.t=function(t,a){if(1&a&&(t=this(t)),8&a)return t;if("object"==typeof t&&t){if(4&a&&t.__esModule)return t;if(16&a&&"function"==typeof t.then)return t}var G=Object.create(null);n.r(G);var N={};K=K||[null,D({}),D([]),D(D)];for(var W=2&a&&t;"object"==typeof W&&!~K.indexOf(W);W=D(W))Object.getOwnPropertyNames(W).forEach((K=>N[K]=()=>t[K]));return N["default"]=()=>t,n.d(G,N),G},n.d=(t,K)=>{for(var D in K)n.o(K,D)&&!n.o(t,D)&&Object.defineProperty(t,D,{enumerable:!0,get:K[D]})},n.f={},n.e=t=>Promise.all(Object.keys(n.f).reduce(((K,D)=>(n.f[D](t,K),K)),[])),n.u=t=>"js/"+({3474:"evo-promotions.SpinGiftsFrame",3863:"testTools",17474:"evo-game.mobileChat",22421:"testTools.PixiDevToolsPlugin",24622:"evo-promotions.SpinGiftsWheelAnimation",30164:"game-client-history-round-info",36302:"evo-promotions.SpinGiftsCampaignRules",39340:"history.roundView",44806:"gameTestToolsPlugins",47290:"evo-promotions.SpinGiftsTermsConditions",50967:"help.common",54504:"evo-promotions.cashGifts",59760:"evo-game.chat",66703:"gameTestToolsSafeAreaPlugin",66885:"native-utilities",73375:"evo-promotions.spinGifts",73460:"evo-promotions.giftsWheel",77821:"evo-game.emojiMenu",80616:"video-lib-local",83841:"help.dealnodeal",85687:"testTools.why-did-you-render"}[t]||t)+"."+{3474:"1a89cdcf",3863:"c68406f1",5310:"a4eb3e49",7075:"5fafa4e8",8873:"370c17c7",10036:"49f00cff",10228:"2c4ae3c0",10306:"a97cff13",11300:"ba52e1b8",12235:"5fddbd18",14291:"2f77c6ae",14855:"512ae6f6",17474:"36703dd7",18674:"df2a9114",18680:"f9a60ee2",22421:"0fea869a",23197:"e6aba045",23998:"0da5bd06",24622:"c19aa584",26089:"76d45190",27171:"d86d5013",27672:"21b8bdb0",28276:"b062ce9d",29251:"9be939bb",30164:"81c32c92",32184:"a21bca64",35214:"3cb54832",36302:"63c3f631",37927:"b03e4e3d",38410:"a6cb3863",39340:"87393490",39920:"0952ac21",40310:"9ec0fe1d",42447:"0fe47cec",44639:"689fa1f7",44806:"0741de9d",44830:"ad207c2b",45444:"ef538133",47290:"25d266d1",49920:"321c7b92",50883:"5b6a2dad",50967:"2b6414a9",51871:"e5213593",53566:"6c66d06a",54504:"de8d33cf",56926:"449679f9",57151:"9ab72021",57758:"294d08bd",58047:"bdb2d050",59603:"a0e07762",59760:"c5c3f75e",60079:"528459c9",61681:"5b09874a",66691:"4564fa54",66703:"d22f8b42",66885:"cf7c7b01",67412:"62e79ea2",70775:"9dfc379c",71635:"a805e905",72923:"a34d72a9",73375:"74edf8f6",73460:"b312a388",74706:"920d2620",76488:"e1d1ceb4",77821:"cadc9005",80616:"10095eb7",82689:"8ce7f80b",82933:"e060bfa0",83841:"4a802677",84531:"5ba37660",85687:"8dab9d33",86341:"5d410614",88918:"ffb24211",92838:"9df31eff",96838:"b7583272",98180:"59d717d2",99697:"83fb1ab8"}[t]+".js",n.miniCssF=t=>3863===t?"styles/testtools.c68406f1.css":36302===t?"styles/evopromoti.spingiftsc.63c3f631.css":47290===t?"styles/evopromoti.spingiftst.25d266d1.css":50967===t?"styles/help.common.2b6414a9.css":30164===t?"styles/gameclient.81c32c92.css":39340===t?"styles/history.roundview.87393490.css":17474===t?"styles/evogame.mobilechat.36703dd7.css":59760===t?"styles/evogame.chat.c5c3f75e.css":54504===t?"styles/evopromoti.cashgifts.de8d33cf.css":73375===t?"styles/evopromoti.spingifts.74edf8f6.css":77821===t?"styles/evogame.emojimenu.cadc9005.css":44806===t?"styles/gametestto.0741de9d.css":22421===t?"styles/testtools.pixidevtoo.0fea869a.css":83841===t?"styles/help.dealnodeal.4a802677.css":73460===t?"styles/evopromoti.giftswheel.b312a388.css":24622===t?"styles/evopromoti.spingiftsw.c19aa584.css":3474===t?"styles/evopromoti.spingiftsf.1a89cdcf.css":66703===t?"styles/gametestto.d22f8b42.css":void 0,n.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),n.o=(t,K)=>Object.prototype.hasOwnProperty.call(t,K),a={},G="/frontend/evo/r2/:",n.l=(t,K,D,N)=>{if(a[t])a[t].push(K);else{var W,x;if(void 0!==D)for(var b=document.getElementsByTagName("script"),e=0;e<b.length;e++){var i=b[e];if(i.getAttribute("src")==t||i.getAttribute("data-webpack")==G+D){W=i;break}}W||(x=!0,(W=document.createElement("script")).charset="utf-8",W.timeout=NaN,n.nc&&W.setAttribute("nonce",n.nc),W.setAttribute("data-webpack",G+D),W.src=t),a[t]=[K];var z=(K,D)=>{W.onerror=W.onload=null,clearTimeout(I);var G=a[t];if(delete a[t],W.parentNode&&W.parentNode.removeChild(W),G&&G.forEach((t=>t(D))),K)return K(D)},I=setTimeout(z.bind(null,void 0,{type:"timeout",target:W}),window.EVO_CDN?15e3:6e4);W.onerror=z.bind(null,W.onerror),W.onload=z.bind(null,W.onload),x&&document.head.appendChild(W)}},n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),n.j=28714,n.p=(globalThis.EVO_CDN||"")+"/frontend/evo/r2/",N=t=>new Promise(((K,D)=>{var a=n.miniCssF(t),G=n.p+a;if(((t,K)=>{for(var D=document.getElementsByTagName("link"),a=0;a<D.length;a++){var G=(W=D[a]).getAttribute("data-href")||W.getAttribute("href");if("stylesheet"===W.rel&&(G===t||G===K))return W}var N=document.getElementsByTagName("style");for(a=0;a<N.length;a++){var W;if((G=(W=N[a]).getAttribute("data-href"))===t||G===K)return W}})(a,G))return K();((t,K,D,a)=>{var G=document.createElement("link");G.setAttribute("data-sandbox","ignore"),G.rel="stylesheet",G.type="text/css",G.onerror=G.onload=N=>{if(G.onerror=G.onload=null,"load"===N.type)D();else{var W=N&&("load"===N.type?"missing":N.type),x=N&&N.target&&N.target.href||K,b=new Error("Loading CSS chunk "+t+" failed.\n("+x+")");b.code="CSS_CHUNK_LOAD_FAILED",b.type=W,b.request=x,G.parentNode.removeChild(G),a(b)}},G.href=K,document.head.appendChild(G)})(t,G,K,D)})),W={28714:0},n.f.miniCss=(t,K)=>{W[t]?K.push(W[t]):0!==W[t]&&{3474:1,3863:1,17474:1,22421:1,24622:1,30164:1,36302:1,39340:1,44806:1,47290:1,50967:1,54504:1,59760:1,66703:1,73375:1,73460:1,77821:1,83841:1}[t]&&K.push(W[t]=N(t).then((()=>{W[t]=0}),(K=>{throw delete W[t],K})))},(()=>{var t={28714:0};n.f.j=(K,D)=>{var a=n.o(t,K)?t[K]:void 0;if(0!==a)if(a)D.push(a[2]);else if(1){var G=new Promise(((D,G)=>a=t[K]=[D,G]));D.push(a[2]=G);var N=n.p+n.u(K),W=new Error;n.l(N,(D=>{if(n.o(t,K)&&(0!==(a=t[K])&&(t[K]=void 0),a)){var G=D&&("load"===D.type?"missing":D.type),N=D&&D.target&&D.target.src;W.message="Loading chunk "+K+" failed.\n("+G+": "+N+")",W.name="ChunkLoadError",W.type=G,W.request=N,a[1](W)}}),"chunk-"+K,K)}},n.O.j=K=>0===t[K];var K=(K,D)=>{var a,G,[N,W,x]=D,b=0;if(N.some((K=>0!==t[K]))){for(a in W)n.o(W,a)&&(n.m[a]=W[a]);if(x)var e=x(n)}for(K&&K(D);b<N.length;b++)G=N[b],n.o(t,G)&&t[G]&&t[G][0](),t[G]=0;return n.O(e)},D=self["webpackChunk_frontend_evo_r2_"]=self["webpackChunk_frontend_evo_r2_"]||[];D.forEach(K.bind(null,0)),D.push=K.bind(null,D.push.bind(D))})(),n.O(void 0,[35375,79949],(()=>n(515924))),n.O(void 0,[35375,79949],(()=>n(610262)));var e=n.O(void 0,[35375,79949],(()=>n(259726)));e=n.O(e)})();
//# sourceMappingURL=https://sourcemaps.egcdn.com/frontend/evo/r2/js/liveslotde.b1919db6.js.map