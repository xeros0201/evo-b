"use strict";(()=>{var t,V,X,K,k,A,$,I={32991:(t,V,X)=>{X.d(V,{A:()=>K});const K={svg:"svg--c8f9e",isHidden:"isHidden--3f361",animate:"animate--265bb",fadeInKeyframes:"fadeInKeyframes--e8a33",pulsing:"pulsing--39b17",pulsingKeyframes:"pulsingKeyframes--03bc4"}},78886:(t,V,X)=>{X.d(V,{j:()=>S,c:()=>c});var K=X(64922),k=X(699695),A=X(377810),$=X(414646),I=X(462566),C=X(891527),n=X(403414);const q="showing--c8dbf",R="hiding--f0ae8",F="effects--f6681",s="tooltip--c9c35",S=({feePercentage:t,feeAmount:V,currency:X,animation:I,dimensions:S,isVisible:c,onFeeEffect:N,onPointerLeave:m,onPointerEnter:v,onPointerUp:W,tooltipComponent:Z,Effects:D,role:y,theme:E,animationDelay:_,animationDuration:p,disappearingDelay:L,feeThemes:O,registerReference:r,isFeeAnimationDelayed:z,withAnimation:w=!0})=>{let b,a,u=1,j="100%",x="100%";!function(t){return"string"!=typeof t}(S)?(a=S,b=S):(u=S.scale,j=S.scaledWidth,b=S.scaledHeight,x=S.absoluteWidth,a=S.absoluteHeight);const e=A.useMemo((()=>D&&K.jsx("div",{className:F,children:K.jsx(D,{animation:I,onAnimation:N})})),[I,N,D]),Y=function(t,V){const[X,K]=A.useState(!t&&0===V),k=A.useRef(0),$=()=>{k.current&&window.clearTimeout(k.current)};return A.useEffect((()=>($(),t?K(!1):k.current=window.setTimeout((()=>{K(!0)}),V),()=>{$(),K(!t)})),[t,V]),X}(c,null!=L?L:p),H=C.Q(V,z?0:$.c);return Y||!c&&!w?null:K.jsxs("div",{style:{width:j,height:b},onPointerLeave:m,onPointerEnter:v,onPointerUp:W,className:s,children:[Z,K.jsx(n.g,{style:{transform:`scale(${u})`,width:x,height:a,fontSize:n._(a),animationDelay:`${c?0:_}ms`,animationDuration:`${p}ms`},className:k.A({[q]:c&&w,[R]:!c&&w}),role:y,theme:E,feePercentage:t,feeAmount:H,currency:X,effects:e,feeThemes:O,registerReference:r})]})},c=I.u(S)},403414:(t,V,X)=>{X.d(V,{g:()=>Z,_:()=>W});var K=X(64922),k=X(699695),A=X(912986),$=X(377810),I=X(732319),C=X(929758),n=X(801399),q=X(50649);const R="fee--2df1e",F="background--8e9c4",s="statusText--379fc",S="feeBackground--9a910",c="fill--982a1",N="borderTop--6f369",m="borderBottom--5a90d",v=.6;function W(t){return"number"==typeof t?`${t*v}px`:`calc(${t} * ${v})`}const Z=({feePercentage:t,feeAmount:V,currency:X,role:v,style:W,className:Z,effects:D,feeThemes:y,registerReference:E=A.A,theme:_=q.m.Regular})=>{const p=$.useMemo((()=>({...q.e,...y}[_]||q.e[q.m.Regular])),[y,_]),L=I.v(E,C.B.Fee),O=$.useMemo((()=>({lightning:null==p?void 0:p.multiplierText,shadow:null==p?void 0:p.textShadow})),[null==p?void 0:p.multiplierText,null==p?void 0:p.textShadow]);return K.jsxs("div",{style:W,className:k.A(R,Z),"data-role":v,ref:L,children:[K.jsx("div",{className:F,children:K.jsxs("div",{className:S,children:[K.jsx("div",{className:k.A(N,null==p?void 0:p.borderTop)}),K.jsx("div",{className:k.A(c,null==p?void 0:p.fill)}),K.jsx("div",{className:k.A(m,null==p?void 0:p.borderBottom)})]})}),K.jsx("div",{className:s,children:K.jsx(n.g,{feePercentage:t,feeAmount:V,currency:X,className:null==p?void 0:p.statusTextContainer,theme:O})}),D]})}},414646:(t,V,X)=>{X.d(V,{c:()=>K});const K=800},801399:(t,V,X)=>{X.d(V,{g:()=>q});var K=X(64922),k=X(699695),A=X(377810),$=X(184787),I=X(587698),C=X(346160);const n="statusTextContainer--1edd5",q=A.memo((({feePercentage:t,feeAmount:V,currency:X,className:A,theme:q})=>{const R=V>0?I.ej(V,{currencySymbol:X}):`${C.Tl("percent_fee",{percent:t})}`;return K.jsx("div",{className:k.A(n,A),children:K.jsx($.L,{text:R,theme:q})})}))},496904:(t,V,X)=>{X.d(V,{t:()=>C});const K="borderTop--2efdb",k="borderBottom--50446",A="multiplierText--565ae",$="textShadow--c4804";var I;(function(t){t["Red"]="red",t["RedStrikeTime"]="redStrikeTime"})(I||(I={}));const C={[I.Red]:{borderTop:K,borderBottom:k,fill:"fill--5950a",multiplierText:A,textShadow:$},[I.RedStrikeTime]:{borderTop:K,borderBottom:k,fill:"fillStrikeTime--c5e4f",multiplierText:A,textShadow:$}}},50649:(t,V,X)=>{X.d(V,{m:()=>K,e:()=>k});var K;(function(t){t["Regular"]="regular",t["GoldenLine"]="goldenLine"})(K||(K={}));const k={[K.Regular]:{borderTop:"borderTop--505aa",borderBottom:"borderBottom--e5b20",fill:"fill--415e7"},[K.GoldenLine]:{borderTop:"borderTop--88cdd",borderBottom:"borderBottom--615a3",fill:"fill--9fffe"}}},261504:(t,V,X)=>{X.d(V,{u:()=>p,H:()=>_});var K=X(64922),k=X(699695),A=X(266600),$=X(377810),I=X(462566);const C="svgGameStatistics--acd83",n="darkFont--b144f",q="itemWrapper--98ad7",R="item--92c48",F="phone--fe7e7",s="brightTheme--10344",S="isDesktop--dd104",c="largeIcons--23ec6",N="tablet--8ef78",m="faceLiftBright--0f3a4",v="landscape--42da8",W="count--ae30a",Z="baccaratV4Mode--69fa4",D="value--fa5ef",y="smallIcons--c830c",E=I.u((({item:t,count:V,itemStyle:X,countStyle:k,showTooltips:A,onPointerEnter:$,onPointerLeave:I,tooltipComponent:C})=>K.jsxs("div",{className:q,onPointerEnter:$,onPointerLeave:I,children:[K.jsx("div",{className:X,children:t}),K.jsx("div",{className:k,children:V}),A&&C]})));var _;(function(t){t["Bright"]="Bright",t["FaceLiftBright"]="FaceLiftBright"})(_||(_={}));class p extends $.Component{shouldComponentUpdate(t){return!A.A(t,this.props)}render(){const{showTooltips:t,statistics:V,roadPredictionTheme:X,isDesktop:A=!1,largeIcons:$=!1,isBaccaratV4Mode:I=!1,tooltipPositionVertical:q,isPhone:p=!1,isTablet:L=!1,isLandscape:O=!1,isSmallIcons:r=!1,isDarkFont:z=!1,fontScale:w}=this.props;return K.jsx("div",{className:k.A(C,{[s]:X===_.Bright,[m]:X===_.FaceLiftBright,[S]:A,[F]:p,[N]:L,[v]:O,[Z]:I,[c]:$,[y]:r,[n]:z}),style:{"--font-scale":w},children:Object.keys(V).map((X=>{const $=V[X];return K.jsx(E,{item:$.icon,count:K.jsx("div",{"data-role":X,className:k.A({[D]:I}),children:$.value}),itemStyle:k.A(R,{[S]:A,[N]:L}),countStyle:k.A(W,{[S]:A,[N]:L}),showTooltips:t,tooltip:$.tooltipLabel,tooltipPositionVertical:q},X)}))})}}},71665:(t,V,X)=>{X.d(V,{Ot:()=>s,mW:()=>c});var K=X(64922),k=X(752490),A=X(730460),$=X(277082);const I=K.jsx("div",{children:"#"}),C=(t,V)=>K.jsx($.RoadItemBaccarat,{roadType:$.RoadType.Bead,winnerType:$.WinnerTypeBaccarat.Banker,symbol:t,isLive:V},t),n=(t,V)=>K.jsx($.RoadItemBaccarat,{roadType:$.RoadType.Bead,winnerType:$.WinnerTypeBaccarat.Player,symbol:t,isLive:V},t),q=(t,V)=>K.jsx($.RoadItemBaccarat,{roadType:$.RoadType.Bead,winnerType:$.WinnerTypeBaccarat.Tie,symbol:t,isLive:V},t),R=t=>K.jsx($.RoadItemBaccarat,{roadType:$.RoadType.Bead,winnerType:$.WinnerTypeBaccarat.Legend,additionalType:$.AdditionalTypeBaccarat.Banker,isLive:t}),F=t=>K.jsx($.RoadItemBaccarat,{roadType:$.RoadType.Bead,winnerType:$.WinnerTypeBaccarat.Legend,additionalType:$.AdditionalTypeBaccarat.Player,isLive:t});function s(t,V){switch(t){case A.I.Chinese:return k.Iq[V].ch;case A.I.Korean:return k.Iq[V].ko;default:return k.Iq[V].en}}function S(t,V,X){return{playerWins:{icon:n(s(V,$.WinnerTypeBaccarat.Player),X),tooltipLabel:"tooltip.player",value:t.playerWins},bankerWins:{icon:C(s(V,$.WinnerTypeBaccarat.Banker),X),tooltipLabel:"tooltip.banker",value:t.bankerWins},ties:{icon:q(s(V,$.WinnerTypeBaccarat.Tie),X),tooltipLabel:"tooltip.tie",value:t.ties}}}function c(t,V,X,K){const k={gameCount:{icon:I,tooltipLabel:"tooltip.totalNumberOfRounds",value:t.gameCount},...S(t,V,K)};return X&&(k.playerPairs={icon:F(K),tooltipLabel:"tooltip.playerPair",value:t.playerPairs},k.bankerPairs={icon:R(K),tooltipLabel:"tooltip.bankerPair",value:t.bankerPairs}),k}},891527:(t,V,X)=>{X.d(V,{Q:()=>$});var K=X(377810),k=X(414646),A=X(876759);function $(t,V=k.c){const X=K.useRef(t),$=K.useMemo((()=>{const K=t>X.current?V:0;return X.current=t,K}),[t]);return function(t,V=0,X=!1){return function(t,V=0,X=!1){const k=K.useRef(t),A=K.useRef(new Set),[$,I]=K.useState(t);return K.useEffect((()=>()=>{for(const t of A.current)window.clearTimeout(t);A.current.clear()}),[]),K.useEffect((()=>{if(X){for(const t of A.current)window.clearTimeout(t);return A.current.clear(),I(t),void(k.current=t)}if(t!==k.current){const X=window.setTimeout((()=>{I(t),A.current.delete(X)}),V);A.current.add(X),k.current=t}}),[t,V,X]),$}(t,A.I()?0:V,X)}(t,$,0===$)}},184787:(t,V,X)=>{X.d(V,{L:()=>v});var K=X(64922),k=X(699695),A=X(95772),$=X(377810),I=X(837557);const C="textContainer--1a1ac",n="text--68a0b",q="placeholder--6cec6",R="base--b286e",F="textBackground--cded2",s="lightning--2aac5",S="shadow--551ae";var c;(function(t){t["Base"]="multiplierBase"})(c||(c={}));const N=$.memo((({text:t,fontSize:V,theme:X,withShadow:A})=>{const $=function(t,V){return{fontSize:null!=t?t:"",WebkitTextStrokeWidth:V?"0.01px":void 0}}(V,I.DS.IS_FIREFOX),C=I.DS.IS_FIREFOX?{...$,opacity:.85}:$;return K.jsxs(K.Fragment,{children:[(null==X?void 0:X.textShadow)&&K.jsx("span",{className:k.A(n,null==X?void 0:X.textShadow),children:t}),K.jsx("span",{className:k.A(n,R,null==X?void 0:X.base),style:$,"data-role":c.Base,children:t}),A&&K.jsx("span",{className:k.A(n,S),style:$,children:t}),K.jsx("span",{className:k.A(n,F,(null==X?void 0:X.lightning)||s),style:C,children:t})]})}));var m;(function(t){t["Left"]="flex-start",t["Center"]="center",t["Right"]="flex-end"})(m||(m={}));const v=({text:t,theme:V,align:X=m.Center,isStatic:I=!1,withShadow:R=!0})=>{const F=$.useRef(null),s=$.useRef(null),S=$.useRef(void 0),[c,v]=$.useState({value:I?t:"",fontSize:void 0}),{value:W,fontSize:Z}=c,D={justifyContent:X},y=k.A(C,null==V?void 0:V.textContainer),E=$.useCallback((()=>{const V=F.current,X=s.current;if(!V||!X)return;const K=V.getBoundingClientRect().width,k=X.getBoundingClientRect().width,$=window.getComputedStyle(V).fontSize,I=K<k?A.A(K/k,4):1;v({fontSize:1!==I?`calc(${$}*${I})`:void 0,value:t})}),[t]);return $.useEffect((()=>(0||(S.current=requestAnimationFrame(E)),()=>{S.current&&cancelAnimationFrame(S.current)})),[E]),K.jsxs("span",{className:y,ref:F,style:D,children:[K.jsx("span",{className:k.A(n,q),ref:s,children:t}),K.jsx(N,{text:W,fontSize:Z,theme:V,withShadow:R})]})}},941691:(t,V,X)=>{var K;X.d(V,{V:()=>K}),function(t){t["None"]="None",t["WinnerMultiplier"]="WinnerMultiplier",t["BetPlaced"]="BetPlaced",t["AnimationStart"]="AnimationStart"}(K||(K={}))},118812:(t,V,X)=>{X.d(V,{s:()=>s,P:()=>S});var K=X(64922),k=X(699695),A=X(912986),$=X(377810),I=X(732319),C=X(277082),n=X(462566),q=X(261504);const R={icons:"icons--f4e38",brightTheme:"brightTheme--c1e55",faceLiftBright:"faceLiftBright--80399",wideButton:"wideButton--c3d67",item:"item--8df89",shortConvex:"shortConvex--3f76d",lastItem:"lastItem--89af0",isDesktop:"isDesktop--72c6f",tablet:"tablet--c47ba",prediction:"prediction--9877c",Player:"Player--d3a01",Banker:"Banker--84cf1",noSpacing:"noSpacing--42fa2",backgroundBorder:"backgroundBorder--49c52",borderBefore:"borderBefore--925a0",borderAfter:"borderAfter--0ce41",active:"active--8bbe2",phone:"phone--1043d",simpleSymbol:"simpleSymbol--f3e7d",simpleSvgSymbol:"simpleSvgSymbol--14682",small:"small--7fc43",rounded:"rounded--90c01"},F={[q.H.Bright]:R.brightTheme,[q.H.FaceLiftBright]:R.faceLiftBright},s=t=>{const{winnerType:V,probe:X,withTooltip:n,mapColorToWinnerType:s,RoadItem:S,symbol:v,isDesktop:W,isTablet:Z,isSmall:D,isShortConvex:y,roadPredictionTheme:E,tooltipComponent:_,registerRef:p=A.A,ignoreButtonSpacing:L,wideButton:O,probesWinner:r,scorecardTheme:z,onInteraction:w,setProbesWinner:b,onPointerEnter:a,onPointerLeave:u,onPointerUp:j}=t,x=I.v(p,V),e=!!E,Y=C.getScorecardTheme(z),H=$.useMemo((()=>e?{backgroundColor:"transparent",borderColor:"transparent"}:{backgroundColor:Y.predictionBackground||Y.fill,borderColor:Y.predictionBackground||Y.fill}),[e,Y.fill,Y.predictionBackground]),h=$.useCallback((()=>{null==w||w(),b(r&&r===V?void 0:V)}),[w,r,b,V]),T=$.useCallback((t=>{h(),null==j||j(t)}),[h,j]),P=$.useCallback((t=>{b(),null==u||u(t)}),[u,b]),Q=$.useMemo((()=>W?{onMouseDown:h,onPointerLeave:P}:{onPointerUp:T}),[h,T,P,W]),J=$.useMemo((()=>{return y?R.shortConvex:E?(t=E,Array.isArray(t)?t.map((t=>F[t])):F[t]):void 0;var t}),[y,E]);return K.jsxs(K.Fragment,{children:[K.jsxs("div",{className:k.A(R.prediction,R.rounded,R[V],J,{[R.isDesktop]:W,[R.noSpacing]:!!L,[R.tablet]:Z,[R.phone]:!W&&!Z,[R.wideButton]:W&&O,[R.active]:V===r,[R.small]:D}),ref:x,"data-role":V,...Q,onPointerEnter:a,children:[E===q.H.FaceLiftBright&&K.jsxs(K.Fragment,{children:[K.jsx("div",{className:k.A(R.backgroundBorder,R.borderBefore)}),K.jsx("div",{className:k.A(R.backgroundBorder,R.borderAfter)})]}),y&&!W?N(v):c(v,!y),K.jsxs("div",{className:k.A(R.icons,J),style:H,children:[m(S,s,C.RoadType.BigEye,X.bigEye,E),m(S,s,C.RoadType.Small,X.small,E),m(S,s,C.RoadType.Cockroach,X.cockroach,E)]})]}),n&&_]})},S=n.u(s);function c(t,V=!0){return K.jsxs("div",{className:R.simpleSymbol,children:[t,V?"?":""]})}function N(t){return K.jsx("div",{className:R.simpleSvgSymbol,children:K.jsx("svg",{width:"100%",height:"75%",viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg",children:K.jsx("text",{x:"0",y:"5",fill:"#fff",dominantBaseline:"central",children:t})})})}function m(t,V,X,A,$){if(null==A?void 0:A.color){const I={roadType:X,winnerType:V(A.color),isLive:$===q.H.FaceLiftBright};return K.jsx("div",{className:k.A(R.item,{[R.lastItem]:X===C.RoadType.Cockroach}),"data-role":C.RoadType[X],children:K.jsx(t,{...I})})}}},819101:(t,V,X)=>{X.d(V,{K0:()=>n});var K=X(730460),k=X(277082);const A={[k.WinnerTypeBaccarat.Player]:{en:"P",ch:"闲",ko:"플"},[k.WinnerTypeBaccarat.Banker]:{en:"B",ch:"庄",ko:"뱅"},[k.WinnerTypeBaccarat.Tie]:{en:"T",ch:"和",ko:"무"}};function $(t,V){const X=V.winner;switch(t){case K.I.Number:const t=X===k.WinnerTypeBaccarat.Player?V.playerScore:V.bankerScore;return void 0!==t?t:"";case K.I.Chinese:return A[X].ch;case K.I.Korean:return A[X].ko;default:return A[X].en}}const I=t=>({bankerPair:!1,bankerScore:0,natural:!1,playerPair:!1,playerScore:0,winner:t===k.WinnerTypeBaccarat.Banker?k.WinnerTypeBaccarat.Banker:k.WinnerTypeBaccarat.Player,isProbe:!0}),C=(t,V)=>({roadType:k.RoadType.Bead,winnerType:k.WinnerTypeBaccarat[t.winner],additionalType:k.getAdditionalTypeBaccarat(t.bankerPair,t.playerPair),symbol:$(V,t),animate:t.isProbe,lightning:t.lightning,multiplier:t.multiplier});function n(t,V,X,K,k,A){const $=[...X];if(void 0!==A){const t=I(A);$.push(t)}const n=k?$:$.slice(-function(t,V,X){const K=t*V;if(X<=K)return 0;const k=X%t;return K-t+(0===k?t:k)}(V,t,$.length));let q=0,R=0;return n.map((t=>{const X=C(t,K),k={x:R,y:q,props:X};return++q===V&&(q=0,++R),k}))}},752490:(t,V,X)=>{X.d(V,{DC:()=>$,G6:()=>C,Iq:()=>q,LH:()=>A,W2:()=>I,iG:()=>n});var K=X(277082),k=X(586234);const A=[K.ScorecardThemeNames.WhiteSolid,K.ScorecardThemeNames.BlackDot],$=[K.ScorecardThemeNames.BlackDot,K.ScorecardThemeNames.WhiteSolid],I=[k.K8.Player,k.K8.Banker,k.K8.Tie],C=new Set(I),n="chipstack",q={[K.WinnerTypeBaccarat.Player]:{en:"P",ch:"闲",ko:"플"},[K.WinnerTypeBaccarat.Banker]:{en:"B",ch:"庄",ko:"뱅"},[K.WinnerTypeBaccarat.Tie]:{en:"T",ch:"和",ko:"무"}}},731675:(t,V,X)=>{X.d(V,{Pj:()=>I,jU:()=>$});var K=X(64922),k=X(377810);const A=k.createContext(null);function $(t,V){return K.jsx(A.Provider,{value:t,children:K.jsx(V,{})})}function I(){const t=k.useContext(A);if(!t)throw new Error("Store should be provided to StoreContext");return t}},246250:(t,V,X)=>{var K;X.d(V,{F:()=>K}),function(t){t["SuperSix"]="super_six_main_bet_coefficient_reductions",t["PerfectPair"]="perfect_pair_main_bet_coefficient_reductions",t["EitherPair"]="either_pair_main_bet_coefficient_reductions",t["PlayerBonus"]="player_bonus_main_bet_coefficient_reductions",t["PlayerPair"]="player_pair_main_bet_coefficient_reductions",t["BankerBonus"]="banker_bonus_main_bet_coefficient_reductions",t["BankerPair"]="banker_pair_main_bet_coefficient_reductions"}(K||(K={}))},929758:(t,V,X)=>{var K;X.d(V,{B:()=>K}),function(t){t["Fee"]="fee"}(K||(K={}))},732319:(t,V,X)=>{X.d(V,{v:()=>k});var K=X(377810);function k(t,V){const X=K.useRef(null);return K.useLayoutEffect((()=>(t(V,X.current),()=>{t(V,null)})),[V,t]),X}},588974:(t,V,X)=>{var K;X.d(V,{C:()=>K}),function(t){t["V1"]="v1",t["V2"]="v2"}(K||(K={}))},730460:(t,V,X)=>{var K,k;X.d(V,{I:()=>K,u:()=>k}),function(t){t["Normal"]="en",t["Number"]="sc",t["Chinese"]="ch",t["Korean"]="ko"}(K||(K={})),function(t){t["P"]="P",t["B"]="B"}(k||(k={}))},586234:(t,V,X)=>{var K,k,A,$,I,C,n,q;X.d(V,{K8:()=>k,Qc:()=>A,ZF:()=>n,Zp:()=>K,uB:()=>$,uu:()=>I}),function(t){t["UnknownCard"]="XX",t["Clubs2"]="2C",t["Clubs3"]="3C",t["Clubs4"]="4C",t["Clubs5"]="5C",t["Clubs6"]="6C",t["Clubs7"]="7C",t["Clubs8"]="8C",t["Clubs9"]="9C",t["Clubs10"]="TC",t["ClubsJack"]="JC",t["ClubsQueen"]="QC",t["ClubsKing"]="KC",t["ClubsAce"]="AC",t["Diamonds2"]="2D",t["Diamonds3"]="3D",t["Diamonds4"]="4D",t["Diamonds5"]="5D",t["Diamonds6"]="6D",t["Diamonds7"]="7D",t["Diamonds8"]="8D",t["Diamonds9"]="9D",t["Diamonds10"]="TD",t["DiamondsJack"]="JD",t["DiamondsQueen"]="QD",t["DiamondsKing"]="KD",t["DiamondsAce"]="AD",t["Hearts2"]="2H",t["Hearts3"]="3H",t["Hearts4"]="4H",t["Hearts5"]="5H",t["Hearts6"]="6H",t["Hearts7"]="7H",t["Hearts8"]="8H",t["Hearts9"]="9H",t["Hearts10"]="TH",t["HeartsJack"]="JH",t["HeartsQueen"]="QH",t["HeartsKing"]="KH",t["HeartsAce"]="AH",t["Spades2"]="2S",t["Spades3"]="3S",t["Spades4"]="4S",t["Spades5"]="5S",t["Spades6"]="6S",t["Spades7"]="7S",t["Spades8"]="8S",t["Spades9"]="9S",t["Spades10"]="TS",t["SpadesJack"]="JS",t["SpadesQueen"]="QS",t["SpadesKing"]="KS",t["SpadesAce"]="AS",t["Eight"]="BAC8"}(K||(K={})),function(t){t["Banker"]="Banker",t["Player"]="Player",t["Tie"]="Tie",t["BankerBonus"]="BankerBonus",t["BankerPair"]="BankerPair",t["EitherPair"]="EitherPair",t["SuperSix"]="SuperSix",t["PlayerBonus"]="PlayerBonus",t["PlayerPair"]="PlayerPair",t["PerfectPair"]="PerfectPair"}(k||(k={})),function(t){t["NewGame"]="newGame",t["BetsOpen"]="betsOpen",t["BetsClosed"]="betsClosed",t["Dealing"]="dealing",t["Revealing"]="revealing",t["Resolved"]="resolved",t["Cancelled"]="cancelled"}(A||(A={})),function(t){t["Betting"]="Betting",t["Accepted"]="Accepted",t["BetsAccepted"]="Accepted",t["Rejected"]="Rejected",t["BetsRejected"]="Rejected",t["Cancelled"]="Cancelled",t["Idle"]="Idle"}($||($={})),function(t){t["Chip"]="Chip",t["Double"]="Double",t["Repeat"]="Repeat",t["Undo"]="Undo",t["UndoAll"]="UndoAll",t["Move"]="Move",t["Remove"]="Remove"}(I||(I={})),function(t){t["MainAndPairs"]="MainAndPairs",t["MainOnly"]="MainOnly",t["AllBets"]="AllBets"}(C||(C={})),function(t){t["Baccarat"]="baccarat"}(n||(n={})),function(t){t["Spade"]="S",t["Heart"]="H",t["Diamond"]="D",t["Club"]="C"}(q||(q={}))},795192:(t,V,X)=>{function K(t,V=2){const X=10**V;return Math.round(t*X)/X}function k(t,V=2){const X=10**V;return Math.floor(t*X)/X}X.d(V,{eS:()=>K,yv:()=>k})},403562:(t,V,X)=>{var K=X(794140),k=X(340155),A=X(277082),$=X(64922),I=X(731675),C=X(752490),n=X(588974),q=X(346160),R=X(730460);const F=[R.I.Normal,R.I.Chinese,R.I.Korean,R.I.Number],s={[A.WinnerTypeBaccarat.Player]:R.u.P,[A.WinnerTypeBaccarat.Banker]:R.u.B};function S(t){return"string"==typeof t}function c(t){return"boolean"==typeof t}function N(t){if(t)switch(typeof t){case"number":return t;case"string":return Number(t)}}function m(t,V){return t===n.C.V2?n.C.V2:V.default}function v(t){const V="immersive_logo",X=`${V}_${q.lr().iso}`;return t[X]?t[X]:t[V]}function W(t,V){switch(t){case"true":return!0;case"false":return!1;default:return V.default}}function Z(t){return F.includes(t)}function D(t){return S(t)?t.split(",").filter(Z):[]}function y(t){return S(t)&&C.LH.includes(t)}const E={min:0,max:0};function _(t){const V=t.rawConfig,X={min:N(V.table_bet_min_limit)||0,max:N(V.table_bet_max_limit)||0},K=0!==X.min&&0!==X.max;return{tiePays9to1:W(V.tie_pays_9_to_1,{default:!1}),tableLimits:K?X:E,tableLogo:v(V),excludedBeadRoadModes:D(V.excluded_bead_road_modes),scorecardTheme:(k=V.roads_background,y(k)?k:void 0),mainBetsOnly:W(V.main_bets_only,{default:!1}),isFrozenSprites:W(V.isFrozenSprites,{default:!1}),isAllSideBetsEnabled:W(V.all_side_bets,{default:!0}),redEnvelopeMath:m(V.red_envelope_math,{default:n.C.V1}),isRedEnvelope:W(V.red_envelope,{default:!1}),volatility:W(t.rawConfig["regulatory.volatility_index_in_help_required"],{default:!1})};var k}function p(t){const V=t.rawConfig;return{..._(t),slowNetworkSpeed:V.slow_network_speed?Number(V.slow_network_speed):void 0,freeHandLimit:void 0!==V.free_hand_limit?Number(V.free_hand_limit):void 0,skipAnimations:void 0===V.skipAnimations?void 0:"true"===V.skipAnimations,gameSpeedMode:V.game_speed_mode,beadRoadMode:V.bead_road_mode,decor:V.decor,hasNoCommissionTableTexture:"false"!==V.hasNoCommissionTableTexture}}function L(t){const V=t.rawConfig;return{...p(t),isNoMaxPayoutLimitInfo:W(V.noMaxPayoutLimitInfo,{default:!1}),isRtpProbabilityV2:W(V.help_RTP_probability_v2,{default:!1})}}var O;(function(t){t["Background"]="background",t["AllSideBets"]="allSideBets",t["BettingGridBubbleShownTimes"]="bettingGridBubbleShownTimes",t["WelcomeBubbleShownTimes"]="welcomeBubbleShownTimes"})(O||(O={}));const r="baccarat.common.";var z;(function(t){t["MultiplierBubbleShownTimes"]="multiplierBubbleShownTimes"})(z||(z={}));const w="baccarat-rng-common";function b(t,V){const X=((t,V)=>({[O.AllSideBets]:{storageKey:r+O.AllSideBets,isValidValue:c,getDefaultValue:()=>t.isAllSideBetsEnabled},[O.Background]:{storageKey:r+O.Background,isValidValue:y,getDefaultValue:()=>A.ScorecardThemeNames.WhiteSolid},[O.BettingGridBubbleShownTimes]:{storageKey:V+O.BettingGridBubbleShownTimes,isValidValue:Number.isFinite,getDefaultValue:()=>0},[O.WelcomeBubbleShownTimes]:{storageKey:V+O.WelcomeBubbleShownTimes,isValidValue:Number.isFinite,getDefaultValue:()=>0}}))(t,V);return{[O.BettingGridBubbleShownTimes]:X.bettingGridBubbleShownTimes,[O.WelcomeBubbleShownTimes]:X.welcomeBubbleShownTimes,[O.AllSideBets]:X.allSideBets,[O.Background]:{...X.background,getDefaultValue:()=>A.ScorecardThemeNames.BlackDot},[z.MultiplierBubbleShownTimes]:{storageKey:V+z.MultiplierBubbleShownTimes,isValidValue:Number.isFinite,getDefaultValue:()=>0}}}var a,u;(function(t){t["SceneRerenderEnd"]="CommonMessageFrom3D.SceneRerenderEnd",t["UpdateTableStateDone"]="CommonMessageFrom3D.UpdateTableStateDone",t["CameraFlewToTable"]="CommonMessageFrom3D.CameraFlewToTable",t["CutCardsDone"]="CommonMessageFrom3D.CutCardsDone",t["BetSpotPressed"]="CommonMessageFrom3D.BetSpotPressed",t["SelectChip"]="CommonMessageFrom3D.SelectChip",t["MoveBetStart"]="CommonMessageFrom3D.MoveBetStart",t["MoveBetDone"]="CommonMessageFrom3D.MoveBetDone",t["HideTooltip"]="CommonMessageFrom3D.HideTooltip",t["CutCardDealt"]="CommonMessageFrom3D.CutCardDealt",t["CardsRemoved"]="CommonMessageFrom3D.CardsRemoved",t["CardOpen"]="CommonMessageFrom3D.CardOpen",t["CardDealt"]="CommonMessageFrom3D.CardDealt",t["CardDealtOpen"]="CommonMessageFrom3D.CardDealtOpen",t["CameraFlewToDealView"]="CommonMessageFrom3D.CameraFlewToDealView",t["SpeedRatioUpdated"]="CommonMessageFrom3D.SpeedRatioUpdated",t["HighlightSpotDone"]="CommonMessageFrom3D.HighlightSpotDone",t["BreakDownChipAnimationEnd"]="CommonMessageFrom3D.BreakDownChipAnimationEnd",t["SelectChipAnimationEnd"]="CommonMessageFrom3D.SelectChipAnimationEnd",t["PlaceChipsOnTableDone"]="CommonMessageFrom3D.PlaceChipsOnTableDone",t["PlaceBetDone"]="CommonMessageFrom3D.PlaceBetDone",t["UpdateBetsDone"]="CommonMessageFrom3D.UpdateBetsDone",t["BalanceUpdateDone"]="CommonMessageFrom3D.BalanceUpdateDone",t["ChangeBettingGridTypeDone"]="CommonMessageFrom3D.ChangeBettingGridTypeDone",t["FlyingChipAnimationDone"]="CommonMessageFrom3D.FlyingChipAnimationDone",t["HoverSpotDone"]="CommonMessageFrom3D.HoverSpotDone",t["BurnCardsDone"]="CommonMessageFrom3D.BurnCardsDone",t["ShuffleCardsDone"]="CommonMessageFrom3D.ShuffleCardsDone",t["GoLiveReady"]="CommonMessageFrom3D.GoLiveReady",t["CutCardsWaitForInput"]="CommonMessageFrom3D.CutCardsWaitForInput",t["CutCardsAquirePosition"]="CommonMessageFrom3D.CutCardsAquirePosition",t["CutCardsStart"]="CommonMessageFrom3D.CutCardsStart",t["CutCardsCancelled"]="CommonMessageFrom3D.CutCardsCancelled",t["CutCardMove"]="CommonMessageFrom3D.CutCardMove",t["IdleAnimationStopped"]="CommonMessageFrom3D.IdleAnimationStopped",t["CameraFlewToTableWin"]="CameraFlewToTableWin",t["SetResumeGame"]="SetResumeGame"})(a||(a={})),function(t){t["SceneRerenderStart"]="CommonMessageTo3D.SceneRerenderStart",t["UpdateTableState"]="CommonMessageTo3D.UpdateTableState",t["ShowTableLight"]="CommonMessageTo3D.ShowTableLight",t["HideTableLight"]="CommonMessageTo3D.HideTableLight",t["FlyToTable"]="CommonMessageTo3D.SelectTable",t["RegisterToken"]="CommonMessageTo3D.RegisterToken",t["Cancel"]="CommonMessageTo3D.Cancel",t["CutCards"]="CommonMessageTo3D.CutCards",t["CutCardsAtPosition"]="CommonMessageTo3D.CutCardsAtPosition",t["MoveCutCard"]="CommonMessageTo3D.MoveCutCard",t["TableReady"]="CommonMessageTo3D.SelectedTableReady",t["SetBettingOpen"]="CommonMessageTo3D.SetBettingOpen",t["ChangeCursor"]="CommonMessageTo3D.ChangeCursor",t["UpdateBets"]="CommonMessageTo3D.UpdateBets",t["PlaceBet"]="CommonMessageTo3D.PlaceBet",t["UpdateLockedSpots"]="CommonMessageTo3D.UpdateLockedSpots",t["AddTooltip"]="CommonMessageTo3D.AddTooltip",t["ShowTooltip"]="CommonMessageTo3D.ShowTooltip",t["ChangeBettingGridType"]="CommonMessageTo3D.ChangeBettingGridType",t["DealCutCard"]="CommonMessageTo3D.DealCutCard",t["DealCard"]="CommonMessageTo3D.DealCard",t["DealOpenCard"]="CommonMessageTo3D.DealOpenCard",t["OpenCard"]="CommonMessageTo3D.OpenCard",t["SetSpeedRatio"]="CommonMessageTo3D.SetSpeedRatio",t["FlyToDealView"]="CommonMessageTo3D.FlyToDealView",t["HighlightHand"]="CommonMessageTo3D.HighlightHand",t["DimHand"]="CommonMessageTo3D.DimHand",t["PulseWinning"]="CommonMessageTo3D.PulseWinning",t["RemoveCards"]="CommonMessageTo3D.RemoveCards",t["HighlightSpotStart"]="CommonMessageTo3D.HighlightSpotStart",t["BalanceUpdate"]="CommonMessageTo3D.BalanceUpdate",t["ChangeOrientation"]="CommonMessageTo3D.ChangeOrientation",t["SelectChip"]="CommonMessageTo3D.SelectChip",t["PlaceChipsOnTable"]="CommonMessageTo3D.PlaceChipsOnTable",t["BreakDownChipAnimationStart"]="CommonMessageTo3D.BreakDownChipAnimationStart",t["SelectChipAnimationStart"]="CommonMessageTo3D.SelectChipAnimationStart",t["FlyingChipAnimationStart"]="CommonMessageTo3D.FlyingChipAnimationStart",t["HoverSpotStart"]="CommonMessageTo3D.HoverSpotStart",t["MoveBetStart"]="CommonMessageTo3D.MoveBetStart",t["BurnCards"]="CommonMessageTo3D.BurnCards",t["ShuffleCards"]="CommonMessageTo3D.ShuffleCards",t["AutoCut"]="CommonMessageTo3D.AutoCut",t["GoLive"]="CommonMessageTo3D.GoLive",t["StartFlyCamera"]="CommonMessageTo3D.StartFlyCamera",t["StopFlyCamera"]="CommonMessageTo3D.StopFlyCamera",t["UploadMesh"]="CommonMessageTo3D.UploadMesh",t["LinkMesh"]="CommonMessageTo3D.LinkMesh",t["StartIdleAnimation"]="CommonMessageTo3D.StartIdleAnimation",t["StopIdleAnimation"]="CommonMessageTo3D.StopIdleAnimation",t["DealingPhaseStart"]="DealingPhaseStart",t["FlyToWinView"]="FlyToWinView",t["HighlightTableTag"]="HighlightTableTag",t["DimRoom"]="DimRoom",t["SetPaused"]="SetPaused",t["SetResumeGame"]="SetResumeGame"}(u||(u={}));const j={[u.FlyToWinView]:a.CameraFlewToTableWin,[u.DealCard]:a.CardDealt,[u.FlyToDealView]:a.CameraFlewToDealView,[u.OpenCard]:a.CardOpen,[u.RemoveCards]:a.CardsRemoved,[u.FlyToTable]:a.CameraFlewToTable,[u.SetSpeedRatio]:a.SpeedRatioUpdated,[u.UpdateTableState]:a.UpdateTableStateDone};var x=X(432050),e=X(83193),Y=X(320148),H=X(484802),h=X(718113);class T{constructor(t){this.preloadRaw={},this.props=t,t.condition()&&t.bundle.preLoad&&(this.preloadRaw=t.bundle.preLoad,this.init())}postLoad(t){var V;if(!this.postLoadData)return;const X=new Set,K=e.createAssetsManager(t);for(const V of Object.keys(this.postLoadData)){const k=t.getMaterialByName(V);if(!k)continue;const A=this.postLoadData[V];for(const t of Object.keys(A)){const $=H.L.unwrap(A[t]);if(!$)continue;let I,C;if(Y.A($)){const{path:t,...V}=$;I=H.L.unwrap(t),Object.keys(V).length&&(C=V)}else I=H.L.unwrap($),A[t]instanceof H.L&&A[t].subscribe((V=>{h.Aw({material:k,prop:t,value:new x.g(V)})}),!1);void 0!==I&&(K.addTextureTask(`${V}|${t}`,I).onSuccess=V=>{C&&h.YE(V.texture,C);const K={material:k,prop:t,value:V.texture};h.Aw(K)&&X.add(k)})}}null===(V=this.props.options)||void 0===V||V.beforeLoad(),K.loadAsync().then((()=>{var t;for(const t of X.values())t.isFrozen&&t.markDirty();null===(t=this.props.options)||void 0===t||t.afterLoad()}))}init(){this.postLoadData=function(t,V){const X={};for(const k of Object.keys(t)){const A=t[k];if((K=A)&&K.constructor===Object&&"materials"in K)for(const t of Object.keys(A.materials)){if(!V[t])continue;const K=A.materials[t],k=Object.keys(A.materials[t]).filter(h.Zg);for(const A of k){const k=H.L.unwrap(K[A]),$=V[t][A];if($)if(X[t]||(X[t]={}),"string"==typeof k){const V=new H.L(k);X[t][A]=V,K[A]instanceof H.L&&K[A].subscribe((t=>{V.value=t})),K[A]=$}else if(void 0!==k){X[t][A]={...k};const V="string"==typeof $?$:$ instanceof H.L?$.value:$.path;k instanceof H.L?k.value=V:k.path=V}}}}var K;return X}(this.props.bundle,this.preloadRaw)}}const P={...e.createDefaultSceneFeatures(),animationsEnabled:!1,lightsEnabled:!1,texturesEnabled:!1};function Q(t){const V={};return Object.keys(P).forEach((X=>{const K=t[X];void 0!==K&&(V[X]=!0===K||"true"===K)})),V}var J=X(32138);const U={...e.createDefaultMaterialFeatures(),DiffuseTextureEnabled:!1,EmissiveTextureEnabled:!1,BumpTextureEnabled:!1,OpacityTextureEnabled:!1};function l(t){const V={};return Object.keys(U).forEach((X=>{const K=t[X];void 0!==K&&(V[X]=!0===K||"true"===K)})),V}var i=X(121669),G=X(948733),d=X(204771),M=X(898973),B=X(872017);let o={},f={};function g(){f={},o={}}var tt,Vt,Xt,Kt,kt=X(357117),At=X(157355);(function(t){t["Glow"]="table_glow"})(tt||(tt={})),function(t){t["FloorPrefix"]="floor_",t["TableLogo"]="table_logo"}(Vt||(Vt={})),function(t){t["RoomFocus"]="roomFocus",t["TableFocus"]="tableFocus",t["TableDealing"]="tableDealing",t["TableIdle"]="tableIdle",t["TableWin"]="tableWin"}(Xt||(Xt={})),function(t){t["HorizontalScale"]="horizontalScale",t["BorderSize"]="borderSize"}(Kt||(Kt={}));const $t={"2C":{x:0,y:0,width:184,height:256},"2D":{x:184,y:0,width:184,height:256},"2H":{x:0,y:256,width:184,height:256},"2S":{x:184,y:256,width:184,height:256},"3C":{x:368,y:0,width:184,height:256},"3D":{x:368,y:256,width:184,height:256},"3H":{x:0,y:512,width:184,height:256},"3S":{x:184,y:512,width:184,height:256},"4C":{x:552,y:0,width:184,height:256},"4D":{x:552,y:256,width:184,height:256},"4H":{x:368,y:512,width:184,height:256},"4S":{x:736,y:0,width:184,height:256},"5C":{x:552,y:512,width:184,height:256},"5D":{x:0,y:768,width:184,height:256},"5H":{x:736,y:256,width:184,height:256},"5S":{x:184,y:768,width:184,height:256},"6C":{x:368,y:768,width:184,height:256},"6D":{x:736,y:512,width:184,height:256},"6H":{x:920,y:0,width:184,height:256},"6S":{x:552,y:768,width:184,height:256},"7C":{x:920,y:256,width:184,height:256},"7D":{x:0,y:1024,width:184,height:256},"7H":{x:184,y:1024,width:184,height:256},"7S":{x:920,y:512,width:184,height:256},"8C":{x:736,y:768,width:184,height:256},"8D":{x:368,y:1024,width:184,height:256},"8H":{x:1104,y:0,width:184,height:256},"8S":{x:1104,y:256,width:184,height:256},"9C":{x:552,y:1024,width:184,height:256},"9D":{x:920,y:768,width:184,height:256},"9H":{x:1104,y:512,width:184,height:256},"9S":{x:736,y:1024,width:184,height:256},AC:{x:0,y:1280,width:184,height:256},AD:{x:1288,y:0,width:184,height:256},AH:{x:184,y:1280,width:184,height:256},AS:{x:1288,y:256,width:184,height:256},JC:{x:1104,y:768,width:184,height:256},JD:{x:920,y:1024,width:184,height:256},JH:{x:1288,y:512,width:184,height:256},JS:{x:552,y:1280,width:184,height:256},KC:{x:1472,y:0,width:184,height:256},KD:{x:736,y:1280,width:184,height:256},KH:{x:1472,y:256,width:184,height:256},KS:{x:1288,y:768,width:184,height:256},QC:{x:1104,y:1024,width:184,height:256},QD:{x:0,y:1536,width:184,height:256},QH:{x:184,y:1536,width:184,height:256},QS:{x:1472,y:512,width:184,height:256},TC:{x:920,y:1280,width:184,height:256},TD:{x:368,y:1536,width:184,height:256},TH:{x:552,y:1536,width:184,height:256},TS:{x:1288,y:1024,width:184,height:256},Back:{x:368,y:1280,width:184,height:256},XX:{x:368,y:1280,width:184,height:256},BAC8:{x:368,y:1280,width:184,height:256}};var It,Ct,nt=X(436794);(function(t){t["ChineseNY"]="chinese_ny"})(It||(It={})),function(t){t["PlaceHolderPrefix"]="position-decor",t["LeftPartPrefix"]="decor_l",t["RightPartPrefix"]="decor_r",t["Coin1Prefix"]="coin1_",t["Coin2Prefix"]="coin2_",t["Coin3Prefix"]="coin3_"}(Ct||(Ct={}));const qt=t=>t.ds.IS_DESKTOP,Rt=t=>t.decor===It.ChineseNY,Ft=X.p+"models/default.33dd9d1f.env",st=X.p+"models/cardholder.11158379.babylon";X(212275);const St=X.p+"models/cardshoe.15b06a69.babylon",ct=X.p+"models/card.66dd9601.babylon",Nt=X.p+"images/cards.e9c110a7.jpg",mt=X.p+"models/chipstackg.4355d397.babylon",vt=X.p+"models/chip.b75698dd.babylon",Wt=X.p+"images/chipdhq.c6089ca8.webp",Zt=X.p+"models/cutcard.ad4cadc7.babylon",Dt=X.p+"models/riffledeck.fa92daae.babylon",yt=X.p+"models/deckstraig.48a8ba2d.babylon",Et=X.p+"models/tabledecor.7c1e1798.babylon",_t=X.p+"models/cameraidle.ae38caf9.babylon",pt=X.p+"models/plaque.18310964.babylon",Lt=X.p+"images/plaquehq.0e22ba1b.jpg",Ot=X.p+"images/tablecloth.5250ff3b.jpg";var rt;(function(t){t["RimLowerMobileL"]="rim_lower_mobile_L",t["RimLowerMobileR"]="rim_lower_mobile_R",t["RimLowerDesktopL"]="rim_lower_desktop_L",t["RimLowerDesktopR"]="rim_lower_desktop_R",t["PositionChipstackDesktop"]="position_chipstack_desktop",t["PositionChipstackMobile"]="position_chipstack_mobile"})(rt||(rt={}));var zt=X(170877);const wt=X.p+"models/grid.79bc5c46.babylon",bt=X.p+"models/bowl.12aa3555.babylon",at=JSON.parse('{"J":{"glow":{"x":212,"y":0,"width":130,"height":169},"gold":{"x":0,"y":0,"width":211,"height":250},"noise":{"x":0,"y":251,"width":100,"height":100},"normal1":{"x":288,"y":271,"width":75,"height":100},"normal2":{"x":288,"y":170,"width":75,"height":100},"normal3":{"x":101,"y":251,"width":75,"height":100},"normal4":{"x":212,"y":170,"width":75,"height":100},"normal5":{"x":212,"y":271,"width":75,"height":100}},"m":{"E":{"height":372,"width":364}}}'),ut=X.p+"images/cardeffect.5861db9d.webp",jt=JSON.parse('{"frames":{"2C":{"x":896,"y":178,"width":128,"height":178},"2D":{"x":384,"y":712,"width":128,"height":178},"2H":{"x":640,"y":356,"width":128,"height":178},"2S":{"x":768,"y":178,"width":128,"height":178},"3C":{"x":256,"y":712,"width":128,"height":178},"3D":{"x":512,"y":712,"width":128,"height":178},"3H":{"x":640,"y":0,"width":128,"height":178},"3S":{"x":768,"y":356,"width":128,"height":178},"4C":{"x":0,"y":1068,"width":128,"height":178},"4D":{"x":896,"y":356,"width":128,"height":178},"4H":{"x":0,"y":534,"width":128,"height":178},"4S":{"x":768,"y":534,"width":128,"height":178},"5C":{"x":896,"y":534,"width":128,"height":178},"5D":{"x":512,"y":1068,"width":128,"height":178},"5H":{"x":128,"y":0,"width":128,"height":178},"5S":{"x":768,"y":890,"width":128,"height":178},"6C":{"x":256,"y":356,"width":128,"height":178},"6D":{"x":0,"y":0,"width":128,"height":178},"6H":{"x":896,"y":712,"width":128,"height":178},"6S":{"x":0,"y":178,"width":128,"height":178},"7C":{"x":256,"y":178,"width":128,"height":178},"7D":{"x":512,"y":0,"width":128,"height":178},"7H":{"x":640,"y":712,"width":128,"height":178},"7S":{"x":384,"y":356,"width":128,"height":178},"8C":{"x":640,"y":1068,"width":128,"height":178},"8D":{"x":512,"y":890,"width":128,"height":178},"8H":{"x":384,"y":178,"width":128,"height":178},"8S":{"x":384,"y":890,"width":128,"height":178},"9C":{"x":256,"y":890,"width":128,"height":178},"9D":{"x":256,"y":1068,"width":128,"height":178},"9H":{"x":384,"y":0,"width":128,"height":178},"9S":{"x":640,"y":890,"width":128,"height":178},"AC":{"x":512,"y":178,"width":128,"height":178},"AD":{"x":128,"y":356,"width":128,"height":178},"AH":{"x":128,"y":1068,"width":128,"height":178},"AS":{"x":0,"y":356,"width":128,"height":178},"Back":{"x":384,"y":1068,"width":128,"height":178},"JC":{"x":512,"y":356,"width":128,"height":178},"JD":{"x":128,"y":712,"width":128,"height":178},"JH":{"x":768,"y":0,"width":128,"height":178},"JS":{"x":0,"y":712,"width":128,"height":178},"KC":{"x":512,"y":534,"width":128,"height":178},"KD":{"x":640,"y":178,"width":128,"height":178},"KH":{"x":0,"y":890,"width":128,"height":178},"KS":{"x":384,"y":534,"width":128,"height":178},"QC":{"x":640,"y":534,"width":128,"height":178},"QD":{"x":128,"y":890,"width":128,"height":178},"QH":{"x":256,"y":534,"width":128,"height":178},"QS":{"x":896,"y":0,"width":128,"height":178},"TC":{"x":128,"y":534,"width":128,"height":178},"TD":{"x":128,"y":178,"width":128,"height":178},"TH":{"x":768,"y":712,"width":128,"height":178},"TS":{"x":256,"y":0,"width":128,"height":178}},"meta":{"size":{"height":2048,"width":1024}}}'),xt=X.p+"images/cards.200826a9.webp",et=X.p+"models/card.c6a28aae.babylon",Yt=X.p+"models/coin.dd17602c.babylon",Ht=X.p+"models/cameraidle.7bd3981f.babylon",ht=X.p+"models/multiplier.8fd61066.babylon",Tt=X.p+"images/multiplier.d4327a05.jpg",Pt=X.p+"images/multiplier.89138791.jpg",Qt=X.p+"models/room.incrementa.e85227eb.babylon",Jt=X.p+"images/roomgolive.de10dc4f.jpg",Ut=X.p+"images/roomgolive.6b20c5c4.jpg",lt=X.p+"images/roomhq.24c03bf7.jpg",it=X.p+"images/roomlq.53f27fed.jpg",Gt=X.p+"models/table.incrementa.735c1bab.babylon",dt=X.p+"images/tablehq.d9159919.jpg",Mt=X.p+"images/tablelq.bd8690c1.jpg",Bt=X.p+"images/tagbanker.974f52b9.jpg",ot=X.p+"images/tagplayer.18e1dba3.jpg",ft=X.p+"models/common.tombstone.503dcdf0.babylon";function gt(t){t.dispose()}function tV(t){return V=>!t||!t.some((t=>t.test(V.name)))}function VV(t){return t?Object.keys(t).filter((V=>t[V])):[]}var XV=X(637596),KV=X(704184),kV=X(570627);const AV=.99999;function $V(t){t&&(t instanceof J.F?t.alpha=AV:t instanceof kV.d&&(t.alpha=AV,t.transparencyMode=2))}function IV(t){t&&(t instanceof J.F?t.alpha=1:t instanceof kV.d&&(t.alpha=1,t.transparencyMode=1))}function CV(t,V){return`${t}-${V}`}var nV,qV,RV,FV,sV,SV,cV,NV,mV,vV,WV,ZV,DV,yV,EV;(function(t){t["Prefix"]="bac_table",t["ClothPrefix"]="bac_cloth",t["Logo"]="table_logo",t["SkipCutButtons"]="skip_cut_buttons",t["PivotPrefix"]="table_pivot"})(nV||(nV={})),qV||(qV={}),function(t){t["Prefix"]="grid",t["PlaceHolderPrefix"]="position-grid",t["PlaqueMeshNamePrefix"]="high-stakes-card",t["SkipCutButtons"]="skip_cut_buttons",t["SkipShuffleButton"]="skip-shuffle-button",t["TagPrefix"]="tag",t["WinMessage"]="win_message"}(RV||(RV={})),function(t){t["Prefix"]="cardshoe",t["CardStartPrefix"]="card_deck_position",t["CardEndPrefix"]="card_ontable_position",t["DeckPrefix"]="cardshoe_inside",t["DeckCardPrefix"]="card_deck_position",t["SliderPrefix"]="cardshoe_mechanism",t["SliderStartPositionPrefix"]="black_part_low_position",t["SliderHighPositionPrefix"]="black_part_high_position",t["PlaceHolderPrefix"]="position-cardshoe"}(FV||(FV={})),function(t){t["Prefix"]="cardholder",t["DeckPlaceholderPrefix"]="card_position",t["DeckPrefix"]="cardholder_deck",t["PlaceHolderPrefix"]="position-cardholder"}(sV||(sV={})),function(t){t["Prefix"]="riffle_deck",t["AnimationPrefix"]="riffle_deck_mesh",t["ClonePrefix"]="riffle-straight-"}(SV||(SV={})),function(t){t["Prefix"]="deck-straight",t["ClonePrefix"]="deck-straight-",t["TopPartPrefix"]="deck-straight-top-part"}(cV||(cV={})),function(t){t["Prefix"]="card",t["ContainerPrefix"]="card-container",t["DiscardPilePrefix"]="card_gather",t["BackPrefix"]="card_static_rear",t["FrontPrefix"]="card_static_number",t["ElasticPostfix"]="_elastic"}(NV||(NV={})),function(t){t["RightPlaceholderPrefix"]="position-deck-part-right",t["LeftPlaceholderPrefix"]="position-deck-part-left",t["SplitRightPlaceholderPrefix"]="position-riffle-split-right",t["SplitLeftPlaceholderPrefix"]="position-riffle-split-left",t["ShuffleRightPlaceholderPrefix"]="position-riffle-shufle-right",t["ShuffleLeftPlaceholderPrefix"]="position-riffle-shufle-left",t["AssemblePlaceholderPrefix"]="position-deck-assemble",t["CutAnimationButton"]="cutAnimationButton"}(mV||(mV={})),function(t){t["Prefix"]="cutcard",t["FrontPrefix"]="front-cutcard",t["BackPrefix"]="back-cutcard",t["FrontPlaceholderPrefix"]="position-cutcard-1",t["BackPlaceholderPrefix"]="position-cutcard-2",t["Slider"]="cut-cards-slider"}(vV||(vV={})),function(t){t["ChipPrefix"]="chip",t["PlaceholderPrefix"]="position_chipstack"}(WV||(WV={})),function(t){t["PayoutPrefix"]="payout",t["NamePrefix"]="name",t["HighlightPrefix"]="highlight",t["ChipStackOnSpotPlaceholder"]="chips-position"}(ZV||(ZV={})),function(t){t["LeftScorePortrait"]="left_score_portrait",t["LeftScoreLandscape"]="left_score_landscape",t["LeftScoreLandscapeMobile"]="left_score_landscape_mobile",t["RightScorePortrait"]="right_score_portrait",t["RightScoreLandscape"]="right_score_landscape",t["RightScoreLandscapeMobile"]="right_score_landscape_mobile"}(DV||(DV={})),function(t){t["Label"]="player_tag",t["PlaceHolderPrefix"]="card_player_00"}(yV||(yV={})),function(t){t["Label"]="banker_tag",t["PlaceHolderPrefix"]="card_banker_00"}(EV||(EV={}));var _V,pV=X(540362);function LV(t,V,X,K,k,A){for(let $=0;$<X;$++){const X=CV(V,$),I=0===$?t:OV(t,X,k,A);I.position.set(0,0,0),I.rotation.set(0,0,0),I.name=X,e.changeVisibility(I,!1,!0),e.addMeshToShadowGenerator(I,K)}}function OV(t,V,X,K){const k=t.clone(V,null);if(X){const X=t.material;X&&(k.material=X.clone(`${V}${X.name}`))}if(K){const t=K.clone(V,V);for(const V of k.getChildMeshes())V.skeleton=t}return k}(function(t){t["Main"]="Light.Main",t["Shadow"]="Light.Shadow"})(_V||(_V={}));var rV=X(412067),zV=X(631567);const wV="shadowOnlyMaterial";function bV({scene:t,mainLightName:V,shadowLightName:X,mesh:K,parent:k,alpha:A=.2}){const $=t.getLightByName(X),I=t.getLightByName(V);if(!$||!I)return;K.parent=k,K.rotation.x=Math.PI/2,K.receiveShadows=!0;const C=t.getMaterialByName(`${wV}-${A}`);K.material=C||new zV.w(wV,t),K.material.alpha=A,K.material.alphaMode=rV.N.ALPHA_PREMULTIPLIED,$.canAffectMesh(K),I.excludedMeshes.push(K)}function aV(t){const V=t.getMeshByName(nV.ClothPrefix),X=t.getMeshByName(RV.PlaceHolderPrefix);if(!V||!X||!V.parent)return;const K=e.getMeshSize(V,!0),k=d.QX.CreatePlane("planeShadow",{height:K.z,width:K.x},t);k.position.y=X.position.y,bV({scene:t,mesh:k,parent:V.parent,shadowLightName:_V.Shadow,mainLightName:_V.Main})}const uV=`${nV.PivotPrefix}_001`;var jV;function xV(t){return pV.U({taskName:"createSceneTask",execute:(V,X)=>{const K=function(t,V){const X=e.createScene(t,V);return void 0!==V.renderTargetsEnabled&&(X.renderTargetsEnabled=V.renderTargetsEnabled),void 0!==V.animationsEnabled&&(X.animationsEnabled=V.animationsEnabled),void 0!==V.lightsEnabled&&(X.lightsEnabled=V.lightsEnabled),void 0!==V.texturesEnabled&&(X.texturesEnabled=V.texturesEnabled),X}(V.engine,t);X({scene:K})}})}function eV(t){return pV.U({taskName:"setupCameraTask",execute:(V,X)=>{const K=new e.ArcCamera(V.scene,{fov:null==t?void 0:t.fov});(null==t?void 0:t.minZ)&&K.setMinZ(t.minZ),X({camera:K})}})}function YV(t){const V=HV(t.cameras[0].animations),X=HV(t.meshes[0].animations);return{fov:t.cameras[0].fov,camera:V,target:X,targetPosition:new G.Pq(...t.meshes[0].position),cameraPosition:new G.Pq(...t.cameras[0].position)}}function HV(t){return t.map((t=>({...t,keys:t.keys.map((V=>{return{frame:V.frame,value:(X=V.values,K=t.property,"rotationQuaternion"===K?new G.PT(...X):new G.Pq(...X))};var X,K}))})))}(function(t){t["Prefix"]="tombstone",t["CardName"]="tombstone_card",t["TextName"]="tombstone_text",t["PlaceHolderPrefix"]="position_tombstone",t["Numbers"]="numbers",t["Holder"]="tombstone_holder"})(jV||(jV={}));var hV=X(714806);var TV=X(497224),PV=X(675100),QV=X(216471);function JV(t){const V=t.getMeshByName(nV.ClothPrefix),X=t.getMeshByName(RV.PlaceHolderPrefix);if(!V||!X||!V.parent)return;const K=e.getMeshSize(V,!0),k=d.QX.CreatePlane("planeShadow",{height:K.z,width:K.x},t);k.position.y=X.position.y,bV({scene:t,mesh:k,parent:V.parent,shadowLightName:_V.Shadow,mainLightName:_V.Main})}function UV({pcfFilter:t,setupTableShadows:V=JV}){return pV.U({taskName:"setupLightsTask",execute:(X,K)=>{(function(t){const V=new TV.g(_V.Main,new G.Pq(0,1,-1.1),t);V.groundColor=new G.v9(0,0,0),V.intensity=1,V.shadowEnabled=!1})(X.scene),function(t,V){const X=new QV.n(_V.Shadow,G.Pq.Zero(),G.Pq.Zero(),M.S0.ToRadians(35),0,t);X.specular=new G.v9(0,0,0),X.intensity=0;const K=new PV.o(1024,X);K.transparencyShadow=!0,V&&t.getEngine().webGLVersion>1?K.filter=PV.o.FILTER_PCF:K.filter=PV.o.FILTER_BLUREXPONENTIALSHADOWMAP;const k=K.getShadowMap();k&&(k.refreshRate=0),e.enableManualShadowRender(_V.Shadow)}(X.scene,t),V(X.scene),K()}})}var lV=X(465636),iV=X(586234);const GV=[iV.K8.Player,iV.K8.Banker,iV.K8.Tie],dV=new Set(GV),MV=[iV.K8.BankerPair,iV.K8.BankerBonus,iV.K8.EitherPair,iV.K8.PlayerPair,iV.K8.PlayerBonus,iV.K8.PerfectPair],BV=[iV.K8.BankerPair,iV.K8.PlayerPair],oV=[iV.K8.PlayerBonus,iV.K8.BankerBonus,iV.K8.SuperSix,iV.K8.PerfectPair],fV=[iV.K8.PlayerBonus,iV.K8.BankerBonus,iV.K8.EitherPair];function gV(t){return dV.has(t)?2:1}function tX(){return q.vL()["spotsSettings.regular"]}function VX(t){const V=q.vL()[t];return{...tX(),...V}}const XX=512,KX=1.8;var kX;(function(t){t["Bold"]="bold",t["Normal"]="normal",t["SemiBold"]="600"})(kX||(kX={}));const AX=.14,$X=.2;function IX(t,V){const{id:X,text:K,shadow:k,gradient:A,container:$,meshWidth:I,meshRatio:C,alpha:n=1,separator:q=" ",color:R="#ffffff",width:F=XX,fontFamily:s="Georgia",disableLighting:S=!1,threshold:c=KX,fontWeight:N=kX.Normal}=V,m=function(t){const{scene:V,name:X,width:K,ratio:k}=t;return d.QX.CreatePlane(X+M.S0.RandomId(),{width:K,height:K/k},V)}({scene:t,width:I,name:X,ratio:C});m.isPickable=!1,$&&(m.parent=$);const v=F/C,{texture:W,isNew:Z}=function(t){const{id:V,width:X,height:K,scene:k}=t;if(o[V])return{texture:o[V],isNew:!1};const A=new i.R(V,{width:X,height:K},k,!0);return A.hasAlpha=!0,A.getAlphaFromRGB=!0,o[V]=A,{texture:A,isNew:!0}}({id:X,width:F,height:v,scene:t});if(Z){const t=W.getContext(),{parts:V,fontSize:X}=function(t){const{text:V,fontSize:X,fontWeight:K,fontFamily:k,ctx:A,width:$,separator:I=" ",threshold:C=1}=t;return A.font=`${K} ${X}px ${k}`,A.measureText(V).width/$>C?function(t){const{fontWeight:V,fontSize:X,fontFamily:K,ctx:k,width:A,separator:$,parts:I}=t;let C=[],n=1,q=!0,R=[];if(""===$){k.font=`${V} ${X/n}px ${K}`;const t=k.measureText(I.join($));if(n=Math.ceil(Math.sqrt(t.width/A)),n>1){const t=B.A(I,Math.ceil(I.length/n));k.font=`${V} ${X/n}px ${K}`;for(const V of t){const t=V.join($);R.push(k.measureText(t).width),C.push(t)}}}else for(;q;){q=!1,C=[],R=[],k.font=`${V} ${X/n}px ${K}`;for(const t of I){const V=C.length>0?k.measureText(C[C.length-1]+$+t):k.measureText(t);if(0!==C.length)if(V.width<A)C[C.length-1]=C[C.length-1]+$+t,R[R.length-1]=V.width;else{if(C.length+1>n){q=!0,n++;break}C.push(t);const V=k.measureText(t);R.push(V.width)}else R.push(V.width),C.push(t)}}const F=R.length>0?Math.max(...R):A,s=X/n,S=n>C.length||R.some((t=>t>A))?A/F:1;return{fontSize:s*S,parts:C}}({width:$*Math.min(C,1),fontWeight:K,fontSize:X,fontFamily:k,ctx:A,parts:V.split(I),separator:I}):{parts:[V],fontSize:X}}({ctx:t,width:F,fontFamily:s,fontSize:v,fontWeight:N,text:K,separator:q,threshold:c}),$=X-X*$X,I=v/V.length,C=$*AX,n=A?function(t,V){const X=t.canvas.width,K=t.canvas.height,[k,A,$,I]=V.position,C=X*k/100,n=K*A/100,q=X*$/100,R=K*I/100,F=t.createLinearGradient(C,n,q,R);for(const[t,X]of V.waypoints)F.addColorStop(t,X);return F}(t,A):R;if(k){const V=Math.floor(X/10);t.shadowOffsetX=.9*V,t.shadowOffsetY=.9*V,t.shadowColor="rgba(38,21,0,0.4)",t.shadowBlur=V}const S=(I-$)/2;for(const[t,X]of Array.from(V.entries()))W.drawText(X,null,I*(t+1)-C-S,`${N} ${$}px ${s}`,n,0!==t||k?"":"#000000",!0,!0)}return m.material=function(t){const{scene:V,name:X,texture:K,alpha:k,color:A="#ffffff",useOpacityTexture:$=!0,disableLighting:I=!1}=t;if(f[X])return f[X];const C=new J.F(`${X}-mat`,V);return C.alpha=k,$?(C.alphaMode=7,C.opacityTexture=K,C.opacityTexture.hasAlpha=!0,C.emissiveColor=G.v9.FromHexString(A)):(C.disableLighting=!0,C.disableDepthWrite=!0,C.emissiveColor=G.v9.White(),C.alphaMode=2,C.diffuseTexture=K,C.diffuseTexture.hasAlpha=!0,C.useAlphaFromDiffuseTexture=!0),I&&(C.disableLighting=!0),f[X]=C,C}({name:X,scene:t,texture:W,alpha:n,color:R,useOpacityTexture:!k&&!A,disableLighting:S}),m}function CX(t,V){const X=t.substr(t.lastIndexOf(" ")+1);return X.substr(X.lastIndexOf(".")+1).startsWith(V)}const nX={[iV.K8.Player]:new G.Pq(.035,0,0),[iV.K8.Banker]:new G.Pq(-.035,0,0),[iV.K8.PlayerPair]:new G.Pq(.06,0,0),[iV.K8.BankerPair]:new G.Pq(-.06,0,0)};function qX(t,V,X){return function(t){const V=t.IS_IOS15&&t.IS_SAFARI&&t.IS_IN_NON_MW_IFRAME,X=t.IS_SAFARI&&t.IS_IOS15_4_TILL_16;return V||X}(t)?X-1.4*e.getMeshSize(V).z:X+e.getMeshSize(V,!0).z}var RX=X(889460);function FX(t,V,X=!0){if(t instanceof RX.Z){for(const X of t.meshes)if(V(X.name))return X;for(const X of t.transformNodes)if(V(X.name))return X}else{const K=t.getChildMeshes(X,(t=>V(t.name)));if(K.length>0)return K[0];const k=t.getChildTransformNodes(X,(t=>V(t.name)));if(k.length>0)return k[0]}throw new Error("getChildByName: could not find child")}const sX=[`${yV.PlaceHolderPrefix}1`,`${yV.PlaceHolderPrefix}2`,`${yV.PlaceHolderPrefix}3`],SX=[`${EV.PlaceHolderPrefix}1`,`${EV.PlaceHolderPrefix}2`,`${EV.PlaceHolderPrefix}3`];var cX,NX=X(697971);function mX(t){return NX.mJ((()=>t.bubble.isWelcomeBubbleVisible),(V=>{V?t.bubble.showWelcome():t.bubble.autoHideBubble(cX.Welcome)}),{fireImmediately:!0})}function vX(t){return NX.mJ((()=>t.preferences.showOnboardingGameHints),((V,X)=>{for(const[,K]of t.bubble.preferencesOnGameHintChange)!X&&V&&t.preferences.updatePreferenceValue(K,0)}))}function WX(t){let V=0,X=0;const K=NX.mJ((()=>({isDesktopClassic:t.layout.isDesktopClassic,dimensions:t.device.dimensions})),(({isDesktopClassic:K,dimensions:k},{isDesktopClassic:A,dimensions:$})=>{const I=K!==A;k!==$?(window.clearTimeout(V),window.cancelAnimationFrame(X),V=window.setTimeout((()=>{X=window.requestAnimationFrame((()=>t.bubble.resize()))}),150)):I&&(window.clearTimeout(V),V=setTimeout((()=>{t.bubble.resize()}),1e3))}));return()=>{window.clearTimeout(V),K()}}function ZX(t){return NX.mJ((()=>({bets:t.bets.bets,isBetting:t.gamePhase.isBetsOpen})),(({bets:V,isBetting:X})=>{const K=function(t){return Object.values(t).reduce(((t,V)=>V?t+V:t),0)}(V),k=t.fee.getAmountWithFee(K),A=k-K;t.fee.set(A),X&&(t.ag.actions.balance.reserveBet(k),t.ag.actions.balance.setTotalBet(k))}))}(function(t){t["Betting"]="Betting",t["Welcome"]="Welcome"})(cX||(cX={}));var DX,yX,EX,_X,pX,LX=X(515200);function OX(t){let V=0;for(const X in t)if(Object.prototype.hasOwnProperty.call(t,X)){const K=t[X];"number"==typeof K&&(V+=K)}return V}function rX(t){return C.W2.reduce(((V,X)=>{var K;return V+(null!==(K=t[X])&&void 0!==K?K:0)}),0)}function zX(t,V){const X={};return Object.keys({...t,...V}).forEach((K=>{var k,A;const $=(null!==(k=V[K])&&void 0!==k?k:0)-(null!==(A=t[K])&&void 0!==A?A:0);0!==$&&(X[K]=$)})),X}function wX(t){const V=t.bets.bets,X=t.betSpot.lockedBetSpots,K=t.gamePhase.value,k=t.lastBets.bets;return{bets:t.betProcessor.currentBetSpotAmounts,locked:X,winning:K===iV.Qc.Resolved?LX.A(V,((t,V)=>t-(k?k[V]:0))):{}}}(function(t){t["ChipMoveInProgress"]="chipMoveInProgressValidator",t["BalanceTooLowBet"]="balanceTooLowBetValidator",t["BettingTime"]="bettingTimeValidator",t["BettingRestriction"]="bettingRestrictionValidator",t["MinTableValueBet"]="minTableValueBetValidator",t["MaxTableValueBet"]="maxTableValueBetValidator",t["MoveBetCoefficientReduction"]="moveBetCoefficientReductionValidator",t["BetCoefficientReduction"]="betCoefficientReductionValidator",t["MaxBetSpotValueBet"]="maxBetSpotValueBetValidator",t["MinBetSpotValueBet"]="minBetSpotValueBetValidator",t["NotEnoughMoneyBet"]="notEnoughMoneyBetValidator",t["CanPlaceBetOnlyOnAvailableSpot"]="canPlaceBetOnlyOnAvailableSpot"})(DX||(DX={})),function(t){t["MoveBetToFeeBetSpotInsufficientFund"]="moveBetToFeeBetSpotInsufficientFundValidator",t["FeeBetInsufficientFund"]="feeBetInsufficientFund"}(yX||(yX={})),function(t){t[t["Fatal"]=0]="Fatal",t[t["Warning"]=1]="Warning"}(EX||(EX={})),function(t){t["WaitingForNextGame"]="WaitingForNextGame",t["NotEnoughMoney"]="NotEnoughMoney",t["BalanceTooLow"]="BalanceTooLow",t["MaxBetSpotValue"]="MaxBetSpotValue",t["MinBetSpotValue"]="MinBetSpotValue",t["MaxTableValue"]="MaxTableValue",t["MinTableValue"]="MinTableValue",t["LowRiskOppositeBettingRestriction"]="LowRiskOppositeBettingRestriction",t["ChipMoveInProgress"]="ChipMoveInProgress",t["BetToMainBetsPercent"]="BetToMainBetsPercent",t["PlaceMainBetFirst"]="PlaceMainBetFirst",t["CanPlaceBetOnlyOnAvailableSpot"]="CanPlaceBetOnlyOnAvailableSpot",t["FeeBetInsufficientFund"]="FeeBetInsufficientFundValidator"}(_X||(_X={})),function(t){t["NotEnoughMoneyWithFee"]="NotEnoughMoneyWithFee",t["FeeBetInsufficientFund"]="FeeBetInsufficientFundValidator"}(pX||(pX={}));var bX,aX=X(609835),uX=X(693),jX=X(795192),xX=X(523737);function eX(t,V,X){const K=[1,.5].includes(t),k=xX.J0.multiply(t,100),A=`${V}.superSixCannotExceed${K?k:"X"}${X?"Crop":""}`;return q.Tl(A,{percent:k})}(function(t){t["LimitPlate"]="limitPlate",t["Tooltip"]="tooltip"})(bX||(bX={}));var YX=X(142130),HX=X(587698);const hX=[iV.K8.SuperSix,iV.K8.PerfectPair,iV.K8.EitherPair,iV.K8.PlayerBonus,iV.K8.PlayerPair,iV.K8.BankerBonus,iV.K8.BankerPair],TX=({coefficientReductions:t,isErrorMessageCropped:V})=>({bet:X,bets:K,betSpot:k})=>{var A;const $=t[k];if(!$)return;const I=k===C.iG?0:null!==(A=K[k])&&void 0!==A?A:0,n=rX(K);if(!hX.includes(k))return;if(0===n)return{type:EX.Fatal,code:_X.PlaceMainBetFirst,translatedMessage:q.Tl("tooltip.placeMainBetFirst")};const R=xX.J0.multiply(n,$);return I+X>R?{resultBet:YX.ur(Math.min(X,R-I)),type:I===R?EX.Fatal:EX.Warning,code:_X.BetToMainBetsPercent,translatedMessage:eX($,bX.Tooltip,V)}:void 0},PX=({coefficientReductions:t})=>({betSpot:V,betSpotFrom:X,bets:K})=>{if(void 0===X)return;if(!C.G6.has(X))return;if(C.G6.has(V))return;const k=K,A=hX.filter((t=>k[t]));for(const V of A){const X=TX({coefficientReductions:t,isErrorMessageCropped:!0})({betSpot:V,bet:0,bets:K});if(void 0!==X)return X}},QX=[iV.K8.Banker,iV.K8.Player],JX=({isLowRisk:t})=>({bets:V,betSpot:X})=>{const K={[iV.K8.Banker]:q.Tl(`betSpot.${iV.K8.Banker}`),[iV.K8.Player]:q.Tl(`betSpot.${iV.K8.Player}`)};if(t){const t=Object.keys(V).filter((t=>{const X=V[t];return aX.A(X)&&X>0})),[k,A]=QX;if(t.includes(k)&&X===A||t.includes(A)&&X===k)return{type:EX.Fatal,code:_X.LowRiskOppositeBettingRestriction,translatedMessage:q.Tl("tooltip.oppositeBettingRestriction",{spotA:K[k]||k,spotB:K[A]||A})}}},UX=({betSpots:t})=>({betSpot:V})=>{if(V!==C.iG)return t.includes(V)?void 0:{type:EX.Fatal,code:_X.CanPlaceBetOnlyOnAvailableSpot,translatedMessage:_X.CanPlaceBetOnlyOnAvailableSpot}},lX=({isBettingTime:t,tooltipKey:V})=>({bets:X})=>{if(t)return;const K=V||(uX.A(X)?"tooltip.waitForNextGame":"tooltip.betsClosed");return{type:EX.Fatal,code:_X.WaitingForNextGame,translatedMessage:q.Tl(K)}},iX=({maxBetSpotValues:t,allowTruncateBet:V=!0})=>({bet:X,bets:K,betSpot:k})=>{var A,$;const I=k===C.iG?Number.MAX_VALUE:null!==(A=t[k])&&void 0!==A?A:Number.MAX_VALUE,n=k===C.iG?0:null!==($=K[k])&&void 0!==$?$:0;if(n+X>I){const t=I-n;return{type:I<=n||!V?EX.Fatal:EX.Warning,code:_X.MaxBetSpotValue,resultBet:V?YX.ur(Math.min(X,t)):void 0,translatedMessage:q.Tl("tooltip.maxBetIs",{amount:HX.ej(I)})}}},GX=({minBetSpotValues:t})=>({bet:V,betSpot:X,bets:K})=>{var k,A;const $=X===C.iG?0:null!==(k=t[X])&&void 0!==k?k:0;if((X===C.iG?0:null!==(A=K[X])&&void 0!==A?A:0)+V<$)return{type:EX.Warning,code:_X.MinBetSpotValue,translatedMessage:q.Tl("tooltip.minBetIs",{amount:HX.ej($)})}},dX=({maxTableValue:t})=>({bet:V,bets:X,betSpot:K})=>{if(K===C.iG)return;if(0===t)return;const k=OX(X);if(k+V>t){const X=t-k;return{type:k>=t?EX.Fatal:EX.Warning,code:_X.MaxTableValue,resultBet:YX.ur(Math.min(V,X)),translatedMessage:q.Tl("tooltip.maxTableBetIs",{amount:HX.ej(t)})}}},MX=({minTableValue:t})=>({bet:V,betSpot:X,bets:K})=>{if(X!==C.iG&&0!==t)return OX(K)+V<t?{type:EX.Warning,code:_X.MinTableValue,translatedMessage:q.Tl("tooltip.minTableBetIs",{amount:HX.ej(t)})}:void 0},BX=({availableBalance:t})=>({bet:V,betSpotFrom:X})=>{if(t<V&&!X)return{type:EX.Fatal,code:_X.NotEnoughMoney,translatedMessage:q.Tl("tooltip.balanceTooLow")}},oX=({availableBalance:t,minBetSpotValues:V})=>({betSpotFrom:X,bet:K,bets:k,betSpot:A})=>{var $,I;const n=A===C.iG?0:null!==($=V[A])&&void 0!==$?$:0,R=A===C.iG?0:null!==(I=k[A])&&void 0!==I?I:0;if(!(X&&t+K>=n))return 0===R&&n>t?{type:EX.Fatal,code:_X.BalanceTooLow,translatedMessage:q.Tl("tooltip.balanceTooLow")}:void 0};var fX,gX,tK=X(267520);class VK{constructor(t){this.props=t,this.undo=()=>{const{ag:t,bets:V}=this.props.root,X=V.history.slice(),K=X.pop();if(K){const k=zX(V.bets,K),A=function(t,V){return OX(V)-OX(t)}(V.bets,K),$=this.calculateTotalBetsAmount(K);t.actions.balance.reserveBet($),t.actions.balance.setTotalBet($),V.setBets(K),V.setHistory(X),this.onUndoSuccess(k,A)}},this.undoAll=()=>{const{bets:t,ag:V,log:X}=this.props.root;V.actions.balance.reserveBet(0),V.actions.balance.setTotalBet(0),t.setBets({}),t.setHistory([]),this.onProcessBetsSuccess(),X.clientBetChip({type:iV.uu.UndoAll,amount:0,bets:{}})},this.repeat=()=>{const{ag:t,bets:V,sounds:X}=this.props.root,K=this.getRepeatableBets();if(!K)return;const k=this.calculateTotalBetsAmount(K);V.setBets(K),V.setHistory([{}]),X.playRepeatBetSound(),t.actions.balance.reserveBet(k),t.actions.balance.setTotalBet(k),this.onRepeatSuccess(K)},this.double=()=>{const{ag:t,bets:V}=this.props.root,X={},K={...V.bets},k=[...V.history,{...V.bets}];Object.keys(V.bets).sort(((t,V)=>gV?gV(V)-gV(t):1)).forEach((t=>{const A=K[t];if(A){const $=this.validate({betSpot:t,bets:V.bets,bet:A,onError:this.onError});if(void 0===$)return;K[t]=jX.eS(A+$),X[t]=$,V.setBets(K),V.setHistory(k)}}));const A=this.calculateTotalBetsAmount(K);t.actions.balance.reserveBet(A),t.actions.balance.setTotalBet(A),this.onDoubleSuccess(X)},this.move=(t,V)=>{const{ag:X,bets:K,sounds:k}=this.props.root;if(t===V)return;const A={...{...K.bets}},$=[...K.history,{...K.bets}],I=+(A[t]||0);A[t]=void 0;const n=this.validate({bet:I,bets:A,betSpotFrom:t,betSpot:V,onError:this.onError});if(void 0===n||n<0)return;const q={},R={};if(V!==C.iG){const X=+(A[V]||0);q[V]=n,R[t]=n,A[V]=jX.eS(X+n)}else R[t]=n;const F=zX(K.bets,A),s=this.calculateTotalBetsAmount(A);X.actions.balance.reserveBet(s),X.actions.balance.setTotalBet(s),K.updateBetsState({bets:{...A},history:$}),k.playPlaceBetSound(),this.onMoveSuccess(V,F,n)},NX.Gn(this,{placeChip:NX.XI.bound,undo:NX.XI.bound,reset:NX.XI.bound,undoAll:NX.XI.bound,repeat:NX.XI.bound,double:NX.XI.bound,move:NX.XI.bound,validate:NX.XI.bound,onError:NX.XI.bound,isUndoEnabled:NX.EW,isRepeatEnabled:NX.EW,isDoubleEnabled:NX.EW,currentBetSpotAmounts:NX.EW,hasValidBets:NX.EW,repeatDisabledReason:NX.EW,isEnoughBalanceToRepeat:NX.EW,validators:NX.EW})}placeChip(t,V){const{ag:X,bets:K,chips:k,sounds:A}=this.props.root,$=V||k.currentChip,I=K.bets[t]||0,C=this.validate({bet:$,bets:K.bets,betSpot:t,onError:this.onError});if(void 0===C)return;const n=K.bets,q={...n,[t]:jX.eS(I+C)},R=[...K.history,n],F=this.calculateTotalBetsAmount(q);X.actions.balance.reserveBet(F),X.actions.balance.setTotalBet(F),K.setBets(q),K.setHistory(R),A.playPlaceBetSound(),this.onPlaceChipSuccess(t,C)}updateBetsState(t){this.props.root.bets.updateBetsState(t),this.onProcessBetsSuccess()}get currentBetSpotAmounts(){return this.props.root.bets.bets}get isUndoEnabled(){const{gamePhase:t,bets:V,animation:X}=this.props.root;return t.isBetsOpen&&V.history.length>0&&!X.isAnyAnimationActive?{enabled:!0}:{enabled:!1,reason:tK.x9.Other}}get isRepeatEnabled(){const{gamePhase:t,bets:V,animation:X}=this.props.root;return t.isBetsOpen&&0===V.history.length&&this.isEnoughBalanceToRepeat&&!X.isAnyAnimationActive?{enabled:!0}:{enabled:!1,reason:this.repeatDisabledReason}}get isDoubleEnabled(){const{bets:t,ag:V,betSpot:X,animation:K}=this.props.root;if(K.isAnyAnimationActive)return{enabled:!1,reason:tK.x9.Other};if(V.values.balanceTotalBet>0){const K=t.bets,k=V.values.balanceAvailable,A=this.props.root.settings.tableLimits.max;let $=!1;const I=Object.keys(K).reduce(((V,k)=>{const A=t.getBetSpotValue(k),I=X.getMaxBetSpotValue(k);return(K[k]||0)<I&&($=!0),V[k]=Math.min(K[k]||0,I-A),V}),{}),C=Object.keys(K).reduce(((V,X)=>(V[X]=t.getBetSpotValue(X),V)),{}),n=this.calculateTotalBetsAmount(I),q=this.calculateTotalBetsAmount(C);return k<n?{enabled:!1,reason:tK.x9.LowBalance}:!$||0!==A&&2*q>A?{enabled:!1,reason:tK.x9.MaxTableOrBetLimitReached}:{enabled:!0}}return{enabled:!1,reason:tK.x9.NoBetsPlaced}}get repeatDisabledReason(){const{history:t,repeat:V}=this.props.root.bets;if(0===t.length){if(!V)return tK.x9.NoBetsPlaced;if(!this.isEnoughBalanceToRepeat)return tK.x9.LowBalance}return tK.x9.Other}validate(t){const{bet:V,betSpotFrom:X,betSpot:K,onError:k,validators:A=this.validators,orderValidators:$=this.orderValidators,bets:I}=t;let C=V;for(const t of $){const $=A[t]({betSpot:K,bets:I,bet:C||V,betSpotFrom:X});if($){if(k(K,$),$.type===EX.Fatal){C=void 0;break}if(void 0!==$.resultBet){if($.resultBet<0){C=void 0;break}C=$.resultBet}}}return C}get validators(){const{gamePhase:t,settings:V,ag:X,betSpot:K}=this.props.root,k=t.isBetsOpen,A=V.isLowRisk,$=X.availableBalance;return{[DX.BalanceTooLowBet]:oX({minBetSpotValues:K.minBetSpotValues,availableBalance:$}),[DX.BettingTime]:lX({isBettingTime:k,tooltipKey:"tooltip.betsClosed"}),[DX.BettingRestriction]:JX({isLowRisk:A}),[DX.MinTableValueBet]:MX({minTableValue:this.props.root.settings.tableLimits.min}),[DX.MaxTableValueBet]:dX({maxTableValue:this.props.root.settings.tableLimits.max}),[DX.MoveBetCoefficientReduction]:PX({coefficientReductions:this.coefficientReductions}),[DX.BetCoefficientReduction]:TX({coefficientReductions:this.coefficientReductions,isErrorMessageCropped:!0}),[DX.MaxBetSpotValueBet]:iX({maxBetSpotValues:K.maxBetSpotValues,allowTruncateBet:!0}),[DX.MinBetSpotValueBet]:GX({minBetSpotValues:K.minBetSpotValues}),[DX.NotEnoughMoneyBet]:BX({availableBalance:$}),[DX.CanPlaceBetOnlyOnAvailableSpot]:UX({betSpots:K.availableBetSpots})}}get orderValidators(){return[DX.BalanceTooLowBet,DX.BettingTime,DX.BettingRestriction,DX.MinTableValueBet,DX.MaxTableValueBet,DX.MoveBetCoefficientReduction,DX.BetCoefficientReduction,DX.MaxBetSpotValueBet,DX.MinBetSpotValueBet,DX.NotEnoughMoneyBet,DX.CanPlaceBetOnlyOnAvailableSpot]}calculateTotalBetsAmount(t){return OX(t)}get hasValidBets(){const t=this.currentValidBets;return Boolean(Object.values(t).find((t=>t&&t>0)))}processBetsToSend(){const{ag:t,bets:V}=this.props.root,X=this.currentValidBets;V.setHistory([...V.history,{...V.bets}]),V.setBets(X);const K=this.calculateTotalBetsAmount(X);t.actions.balance.reserveBet(K),t.actions.balance.setTotalBet(K),this.onProcessBetsSuccess();const k=[];return Object.keys(X).forEach((t=>{const V=X[t];V&&k.push({spot:t,amount:V})})),k}reset(){this.props.root.bets.reset()}onPlaceChipSuccess(t,V){const X={[t]:V};this.onProcessBetsSuccess(),this.onPlaceChipSuccessLog(X)}onPlaceChipSuccessLog(t){this.props.root.log.clientBetChip({type:iV.uu.Chip,bets:t,amount:this.calculateTotalBetsAmount(t)})}onDoubleSuccess(t){this.onProcessBetsSuccess(),this.onDoubleSuccessLog(t)}onDoubleSuccessLog(t){this.props.root.log.clientBetChip({type:iV.uu.Double,bets:t,amount:this.calculateTotalBetsAmount(t)})}onRepeatSuccess(t){this.onProcessBetsSuccess(),this.onRepeatSuccessLog(t)}onRepeatSuccessLog(t){this.props.root.log.clientBetChip({type:iV.uu.Repeat,bets:t,amount:this.calculateTotalBetsAmount(t)})}onUndoSuccess(t,V){this.onProcessBetsSuccess(),this.onUndoSuccessLog(t,V)}onUndoSuccessLog(t,V){this.props.root.log.clientBetChip({type:iV.uu.Undo,bets:t,amount:V})}onMoveSuccess(t,V,X){this.onProcessBetsSuccess(),this.onMoveSuccessLog(t,V,X)}onMoveSuccessLog(t,V,X){this.props.root.log.clientBetChip({type:t!==C.iG?iV.uu.Move:iV.uu.Remove,bets:V,amount:X})}onProcessBetsSuccess(){}get coefficientReductions(){return{}}get isEnoughBalanceToRepeat(){const{bets:t,ag:V}=this.props.root,X=t.repeat;return void 0!==X&&V.values.balanceAvailable>=this.calculateTotalBetsAmount(X)}onError(t,V){const{suppressed:X,translatedMessage:K}=V;if(X)return;const{tooltip:k,log:A}=this.props.root;V.code===_X.WaitingForNextGame&&A.clientPressedOnBetsOutOfBettingTime(),k.add3dSpotTooltip({betSpot:t,text:K||""}),this.props.root.sounds.playClickingFailSound()}get maxTableLimit(){return this.props.root.settings.maxTableLimit}get minTableLimit(){return this.props.root.settings.minTableLimit}get currentValidBets(){const t=this.props.root.bets,V={...t.bets};return Object.keys(t.bets).sort(((t,V)=>gV(V)-gV(t))).forEach((t=>{const X=V[t];if(X){const K=this.validate({betSpot:t,bets:V,bet:0,onError:(K,k)=>{k.resultBet?V[t]=X-Math.abs(k.resultBet):delete V[t]}});if(!K)return;V[t]=jX.eS(K)}})),V}getRepeatableBets(){const{bets:t}=this.props.root,V=t.repeat,X={};if(V)return Object.keys(V).sort(((t,V)=>gV(V)-gV(t))).forEach((K=>{const k=V[K];if(k){const V=this.validate({betSpot:K,bets:t.bets,bet:k,onError:this.onError});if(void 0===V)return;X[K]=V,t.setBets(X),t.setHistory([{}])}})),X}}(function(t){t["BankerLightning"]="BankerLightning",t["PlayerLightning"]="PlayerLightning",t["TieLightning"]="TieLightning",t["BankerPairLightning"]="BankerPairLightning",t["PlayerPairLightning"]="PlayerPairLightning"})(fX||(fX={})),function(t){t["BankerFee"]="BankerFee",t["PlayerFee"]="PlayerFee",t["TieFee"]="TieFee",t["BankerPairFee"]="BankerPairFee",t["PlayerPairFee"]="PlayerPairFee"}(gX||(gX={}));const XK=[fX.BankerLightning,fX.PlayerLightning,fX.TieLightning,fX.BankerPairLightning,fX.PlayerPairLightning],KK=new Map([[iV.K8.Player,fX.PlayerLightning],[iV.K8.Banker,fX.BankerLightning],[iV.K8.Tie,fX.TieLightning],[iV.K8.PlayerPair,fX.PlayerPairLightning],[iV.K8.BankerPair,fX.BankerPairLightning]]),kK=[gX.BankerFee,gX.PlayerFee,gX.TieFee,gX.BankerPairFee,gX.PlayerPairFee],AK=new Map([[iV.K8.Player,gX.PlayerFee],[iV.K8.Banker,gX.BankerFee],[iV.K8.Tie,gX.TieFee],[iV.K8.PlayerPair,gX.PlayerPairFee],[iV.K8.BankerPair,gX.BankerPairFee]]);class $K extends VK{constructor(t){super(t),this.props=t,this.feeBetSpots=kK,this.feeBetSpotMap=AK}get currentBetSpotAmounts(){const t=this.props.root,V=t.bets.bets,X=t.gamePhase.value,K=t.lastBets.bets,k=X===iV.Qc.Resolved?LX.A(V,((t,V)=>K?K[V]:0)):V;return this.calculateUpdatedBets(k)}calculateTotalBetsAmount(t){return super.calculateTotalBetsAmount(this.calculateUpdatedBets(t))}reset(){super.reset(),this.props.root.bets.setRepeat(void 0),this.props.root.messageSender3d.to.update3dBets(wX(this.props.root))}calculateUpdatedBets(t){return Object.keys(t).reduce(((V,X)=>{if(!this.feeBetSpots.includes(X)){V[X]=t[X];const K=this.feeBetSpotMap.get(X);K&&(V[K]=this.props.root.fee.getFeeAmount(t[X]||0))}return V}),{})}onPlaceChipSuccess(t,V){this.props.root.messageSender3d.to.placeBet({bets:this.currentBetSpotAmounts,locked:this.props.root.betSpot.lockedBetSpots}),this.props.root.messageSender3d.to.betsAmountChanged({[t]:V}),super.onPlaceChipSuccess(t,V)}onRepeatSuccess(t){this.props.root.messageSender3d.to.betsAmountChanged(t),super.onRepeatSuccess(t)}onDoubleSuccess(t){this.props.root.messageSender3d.to.betsAmountChanged(t),super.onDoubleSuccess(t)}onPlaceChipSuccessLog(t){const V=this.calculateUpdatedBets(t),X=super.calculateTotalBetsAmount(V);this.props.root.log.clientBetChip({type:iV.uu.Chip,bets:V,amount:X})}onDoubleSuccessLog(t){const V=this.calculateUpdatedBets(t),X=super.calculateTotalBetsAmount(V);this.props.root.log.clientBetChip({type:iV.uu.Double,bets:V,amount:X})}onRepeatSuccessLog(t){const V=this.calculateUpdatedBets(t),X=super.calculateTotalBetsAmount(V);this.props.root.log.clientBetChip({type:iV.uu.Repeat,bets:V,amount:X})}onUndoSuccessLog(t){const V=this.calculateUpdatedBets(t),X=super.calculateTotalBetsAmount(V);this.props.root.log.clientBetChip({type:iV.uu.Undo,bets:V,amount:X})}onMoveSuccessLog(t,V){const X=this.calculateUpdatedBets(V),K=t===C.iG?super.calculateTotalBetsAmount(X):super.calculateTotalBetsAmount((k=X,Object.keys(k).filter((t=>{const V=k[t];return void 0!==V&&V>0})).reduce(((t,V)=>(t[V]=k[V],t)),{})));var k;this.props.root.log.clientBetChip({type:t!==C.iG?iV.uu.Move:iV.uu.Remove,bets:X,amount:K})}onProcessBetsSuccess(){this.props.root.messageSender3d.to.update3dBets(wX(this.props.root))}get coefficientReductions(){var t,V;return null!==(V=null===(t=this.props.root.tableConfig.config)||void 0===t?void 0:t.coefficientReductions)&&void 0!==V?V:{}}get maxTableLimit(){return this.props.root.tableConfig.tableConfigMaxLimit}get minTableLimit(){return this.props.root.tableConfig.tableConfigMinLimit}}class IK extends $K{constructor(){super(...arguments),this.feeBetSpots=XK,this.feeBetSpotMap=KK}}var CK,nK,qK,RK,FK=X(223377),sK=X(156256);function SK(t){return t.replace(/(?:^|\.?)([A-Z])/g,((t,V)=>`_${V.toLowerCase()}`)).replace(/^[0_]/g,"")}function cK(t,V){return Object.prototype.hasOwnProperty.call(t,V)}X(893903),function(t){t["Pointer"]="pointer",t["Default"]="default"}(CK||(CK={}));class NK{constructor(t){this.props=t,NX.Gn(this,{availableBetSpots:NX.EW,sideBetSpots:NX.EW,cursorsBetSpots:NX.EW,lockedBetSpots:NX.EW})}get tiePayout(){return this.spotsSettings[`${iV.K8.Tie}.payouts`]}get availableBetSpots(){const{isMainBetsOnly:t}=this.props.root.settings;return t?GV:[...GV,...this.sideBetSpots]}get lockedBetSpots(){const t=this.availableBetSpots,V=FK.A(Object.values(iV.K8),t),X=this.props.root.bets.bets;if(rX(X)<=0)for(const t of oV)V.includes(t)||V.push(t);return this.props.root.settings.isLowRisk&&(X[iV.K8.Player]||X[iV.K8.Banker])&&V.push(X[iV.K8.Player]?iV.K8.Banker:iV.K8.Player),V}get sideBetSpots(){return(this.props.root.preferences.isAllSideBetsEnabled?MV:BV).filter((t=>this.isSpotConfigured(t)))}get cursorsBetSpots(){const t=this.availableBetSpots,V=this.lockedBetSpots,X=this.props.root.gamePhase.isBetsOpen;return t.reduce(((t,K)=>(t[K]=X?V.includes(K)?CK.Default:CK.Pointer:CK.Default,t)),{})}isSpotConfigured(t){return!!this.isSpotEnabled(t)&&this.getSettingMaxBetSpotValue(t)>0&&this.getSettingMinBetSpotValue(t)>0}get minBetSpotValues(){return Object.values(iV.K8).reduce(((t,V)=>{const X=this.getMinBetSpotValue(V);return aX.A(X)&&Number.isFinite(X)?{...t,[V]:X}:t}),{})}get maxBetSpotValues(){return Object.values(iV.K8).reduce(((t,V)=>{const X=this.getMaxBetSpotValue(V);return aX.A(X)&&Number.isFinite(X)?{...t,[V]:X}:t}),{})}get minBetSpotValue(){const t=Object.values(this.minBetSpotValues);return t.length?Math.min(...t):0}getMaxBetSpotValue(t){return this.getSettingMaxBetSpotValue(t)}getMinBetSpotValue(t){return this.getSettingMinBetSpotValue(t)}getSettingMaxBetSpotValue(t,V){var X;const{rawConfig:K}=this.props.root.settings;return null!==(X=K[`${null!=V?V:this.limitsPrefix}.${sK.A(t)}_max_bet`])&&void 0!==X?X:0}getSettingMinBetSpotValue(t,V){var X;const K=null!=V?V:this.limitsPrefix,{rawConfig:k}=this.props.root.settings;return null!==(X=k[`${K}.${sK.A(t)}_min_bet`])&&void 0!==X?X:0}isSpotEnabled(t){const{rawConfig:V}=this.props.root.settings;return t===iV.K8.PerfectPair&&fV.reduce(((t,X)=>{const K=SK(X);return t&&W(V[`${K}_enabled`],{default:!0})}),!0)?W(V[`${SK(t)}_enabled`],{default:!0}):fV.includes(t)?fV.reduce(((t,X)=>{const K=SK(X);return t&&W(V[`${K}_enabled`],{default:!0})}),!0):W(V[`${SK(t)}_enabled`],{default:!0})}get limitsPrefix(){return this.props.root.settings.limitsPrefix}get spotsSettings(){return tX()}}(function(t){t["Min"]="min",t["Max"]="max"})(nK||(nK={})),function(t){t["Commission"]="commission",t["NoCommission"]="no_commission"}(qK||(qK={})),function(t){t["Normal"]="normal",t["Turbo"]="turbo"}(RK||(RK={}));class mK extends NK{constructor(t){super(t),this.props=t}getMaxBetSpotValue(t){return this.getBetSpotLimit(t,nK.Max)}getMinBetSpotValue(t){return this.getBetSpotLimit(t,nK.Min)}isCurrentTableSpotConfigured(t){return Boolean(this.getMaxBetSpotValue(t)&&this.getMinBetSpotValue(t))}get spotsSettings(){return VX(this.props.spotSettingKey)}getBetSpotLimit(t,V){var X,K,k;const A=this.props.root.tableConfig.config;return A&&null!==(k=null===(K=null===(X=A.limits)||void 0===X?void 0:X[t])||void 0===K?void 0:K[V])&&void 0!==k?k:0}}var vK=X(284824),WK=X(822381);const ZK="onboarding.bubbleBetting",DK="onboarding.bubbleBettingTitle",yK="onboarding.bubbleIntro",EK=WK.eI(40),_K=WK.eI(30);function pK({percentage:t=20}={}){return{[cX.Welcome]:{id:cX.Welcome,timesToShow:1,contentTranslationKey:yK,layoutPosition:{}},[cX.Betting]:{id:cX.Betting,titleTranslationKey:DK,contentTranslationKey:ZK,contentTranslationMapping:{percentage:t},withArrow:!0,layoutPosition:{desktop:{anchorPosition:"TopCenter",bubblePosition:"TopCenter",bubbleWidth:EK},desktopClassic:{anchorPosition:"TopCenter",bubblePosition:"TopCenter",bubbleWidth:EK},landscape:{anchorPosition:"BottomCenter",bubblePosition:"BottomCenter",bubbleWidth:_K},portrait:{anchorPosition:"TopCenter",bubblePosition:"TopCenter",bubbleWidth:_K}},timesToShow:2}}}const LK={[cX.Betting]:O.BettingGridBubbleShownTimes,[cX.Welcome]:O.WelcomeBubbleShownTimes},OK=[[cX.Betting,O.BettingGridBubbleShownTimes],[cX.Welcome,O.WelcomeBubbleShownTimes]];var rK,zK,wK,bK;(function(t){t["BettingGrid"]="bettingGrid"})(rK||(rK={}));class aK{constructor(t){this.props=t,this.current=null,this.timeToLiveId=0,NX.Gn(this,{current:NX.sH,showBubble:NX.XI.bound,showWelcome:NX.XI.bound,hideBubble:NX.XI.bound,hideAllBubbles:NX.XI.bound,autoHideBubble:NX.XI.bound,resize:NX.XI.bound,isGridBubbleVisible:NX.EW,isWelcomeBubbleVisible:NX.EW})}show(t,V=!1){const X=this.getRef(t);this.showBubble(t,X,V)}showBubble(t,V,X=!1){var K;if(!V||(null===(K=this.current)||void 0===K?void 0:K.id)===t&&!X||t===cX.Welcome)return;this.current={id:t,ref:V};const k=this.bubbles[t],A=this.getBubbleLayoutOptions(k);this.props.root.ag.actions.onboardingBubbles.addOrUpdate({id:k.id,element:V,anchorPosition:A.anchorPosition,bubbleData:{position:A.bubblePosition,showHintsOption:void 0===k.showHintsOption||k.showHintsOption,width:A.bubbleWidth,withArrow:k.withArrow,titleTranslationKey:k.titleTranslationKey,contentTranslationKey:k.contentTranslationKey,rootOffset:A.offsetBubble,contentTranslationMapping:k.contentTranslationMapping,onClose:this.hideBubble.bind(this),hintsButtonCallback:this.hideAllBubbles.bind(this)}}),k.timeToLive&&(clearTimeout(this.timeToLiveId),this.timeToLiveId=setTimeout((()=>{var t;(null===(t=this.current)||void 0===t?void 0:t.id)===k.id&&this.autoHideBubble(this.current.id)}),k.timeToLive))}showWelcome(){var t;(null===(t=this.current)||void 0===t?void 0:t.id)!==cX.Welcome&&(this.current={id:cX.Welcome},this.props.root.ag.actions.onboardingBubbles.addWelcomeBubble({contentTranslationKey:this.bubbles[cX.Welcome].contentTranslationKey,onClose:this.hideBubble.bind(this)}))}hideBubble(){if(!this.current)return;this.current.id===cX.Welcome?this.props.root.ag.actions.onboardingBubbles.removeWelcomeBubble():this.props.root.ag.actions.onboardingBubbles.remove(this.current.id);const t=this.current.id;this.props.root.preferences.updatePreferenceValue(this.bubblePreferences[t],this.bubbles[t].timesToShow),this.current=null,clearTimeout(this.timeToLiveId)}autoHideBubble(t){if(this.current&&this.current.id===t){if(t===cX.Welcome)this.props.root.ag.actions.onboardingBubbles.removeWelcomeBubble();else{this.props.root.ag.actions.onboardingBubbles.remove(t);const V=t,X=this.props.root.preferences.getValue(this.bubblePreferences[V]);this.props.root.preferences.updatePreferenceValue(this.bubblePreferences[V],X+1)}this.current=null,clearTimeout(this.timeToLiveId)}}hideAllBubbles(){this.current&&(this.props.root.ag.actions.onboardingBubbles.remove(this.current.id),this.props.root.preferences.updatePreferenceValue(vK.bR,!1),this.current=null,clearTimeout(this.timeToLiveId))}resize(){this.current&&this.show(this.current.id,!0)}get isWelcomeBubbleVisible(){return!1}get isGridBubbleVisible(){const{ag:t,gamePhase:V,preferences:X}=this.props.root,{showOnboardingGameHints:K,bettingGridBubbleShownTimes:k}=X;return!this.isWelcomeBubbleVisible&&k<this.bubbles[cX.Betting].timesToShow&&!!this.gridRef&&0===t.balanceTotalBet&&V.isBetsOpen&&K}get bubblePreferences(){return LK}get preferencesOnGameHintChange(){return OK}getRef(t){var V;return t===cX.Betting?this.gridRef:null===(V=this.current)||void 0===V?void 0:V.ref}getBubbleLayoutOptions(t){return this.props.root.layout.isDesktopImmersive?t.layoutPosition.desktop:this.props.root.layout.isDesktopClassic?t.layoutPosition.desktopClassic:this.props.root.device.isTablet&&t.layoutPosition.tablet?t.layoutPosition.tablet:this.props.root.device.isLandscape?t.layoutPosition.landscape:t.layoutPosition.portrait}get gridRef(){return this.props.root.reference.bubble.all[rK.BettingGrid]}get bubbles(){return pK()}}(function(t){t["Player"]="Player",t["Banker"]="Banker"})(zK||(zK={})),function(t){t["Multiplier"]="Multiplier"}(wK||(wK={})),function(t){t["MultiplierCards"]="multiplierCards"}(bK||(bK={}));const uK={...LK,[wK.Multiplier]:z.MultiplierBubbleShownTimes},jK=[...OK,[wK.Multiplier,z.MultiplierBubbleShownTimes]];class xK extends aK{constructor(t){super(t),this.props=t,this.areMultipliersCard=!1,NX.Gn(this,{isMultiplierBubbleVisible:NX.EW,setHideCallback:NX.XI.bound,setMultipliersCardExist:NX.XI.bound,areMultipliersCard:NX.sH})}get isWelcomeBubbleVisible(){if(this.props.root.animation.idleAnimationActive)return!1;const{isLoaded:t,showOnboardingGameHints:V,welcomeBubbleShownTimes:X}=this.props.root.preferences;return t&&V&&!X}get isMultiplierBubbleVisible(){if(this.props.root.animation.idleAnimationActive)return!1;const{preferences:t}=this.props.root,{showOnboardingGameHints:V,multiplierBubbleShownTimes:X}=t;return!this.isWelcomeBubbleVisible&&!!this.multiplierRef&&this.areMultipliersCard&&X<this.bubbles[wK.Multiplier].timesToShow&&V}get isGridBubbleVisible(){return!this.props.root.animation.idleAnimationActive&&super.isGridBubbleVisible}get bubblePreferences(){return uK}get preferencesOnGameHintChange(){return jK}setHideCallback(t){this.hideCallback=t}setHandFirstMultiplier(t){this.getHandFirstMultiplier=t}setMultipliersCardExist(t){this.areMultipliersCard=t}hideBubble(){var t;super.hideBubble(),null===(t=this.hideCallback)||void 0===t||t.call(this)}autoHideBubble(t){var V;super.autoHideBubble(t),null===(V=this.hideCallback)||void 0===V||V.call(this)}hideAllBubbles(){var t;super.hideAllBubbles(),null===(t=this.hideCallback)||void 0===t||t.call(this)}get bubbles(){var t,V,X,K;return V=this.props.feePercentage,X=null===(t=this.getHandFirstMultiplier)||void 0===t?void 0:t.call(this),K=this.props.multiplierTranslationKey,{...pK({percentage:V}),...K?{[wK.Multiplier]:{id:wK.Multiplier,contentTranslationKey:K,withArrow:!0,layoutPosition:{desktop:{anchorPosition:"TopCenter",bubblePosition:"TopCenter",bubbleWidth:EK,offsetBubble:"34px"},desktopClassic:{anchorPosition:"BottomCenter",bubblePosition:"BottomCenter",bubbleWidth:EK,offsetBubble:"5px"},landscape:{anchorPosition:"TopCenter",bubblePosition:"TopCenter",bubbleWidth:EK,offsetBubble:"30px"},portrait:{anchorPosition:"TopCenter",bubblePosition:X===zK.Player?"TopLeft":"TopRight",bubbleWidth:"usesize(26)",offsetBubble:"28px"}},timesToShow:1}}:{}}}getRef(t){return t===wK.Multiplier?this.multiplierRef:super.getRef(t)}get multiplierRef(){return this.props.root.reference.bubble.all[bK.MultiplierCards]}}function eK(t){return NX.mJ((()=>t.bubble.isMultiplierBubbleVisible),(V=>{V?t.bubble.show(wK.Multiplier):t.bubble.autoHideBubble(wK.Multiplier)}))}function YK(t){let V=0;const X=NX.mJ((()=>t.bubble.isGridBubbleVisible),(X=>{if(!X)return t.bubble.autoHideBubble(cX.Betting),void window.clearTimeout(V);window.clearTimeout(V),V=setTimeout((()=>{t.bubble.show(cX.Betting)}),100)}));return()=>{window.clearTimeout(V),X()}}class HK{constructor(){this.isLongBetting=!1,this.phase=iV.Qc.NewGame,NX.Gn(this,{phase:NX.sH,isLongBetting:NX.sH,setPhase:NX.XI,setIsLongBetting:NX.XI,isGameResolved:NX.EW,isBetsOpen:NX.EW,isDealing:NX.EW})}get isBetsOpen(){return this.phase===iV.Qc.BetsOpen}get isDealing(){return this.phase===iV.Qc.Dealing}get value(){return this.phase}setPhase(t){this.phase=t}setIsLongBetting(t){this.isLongBetting=t}get isGameResolved(){return this.value===iV.Qc.Resolved}get isBetsClosed(){return this.value===iV.Qc.BetsClosed}}var hK,TK;(function(t){t["Lightning"]="Lightning"})(hK||(hK={}));class PK extends HK{constructor(){super(),NX.Gn(this,{isLightning:NX.EW})}get value(){return super.value}get isLightning(){return this.value===hK.Lightning}}class QK{constructor(t){this.props=t,this.bets=void 0,NX.Gn(this,{bets:NX.sH,setLastBets:NX.XI.bound})}setLastBets(t){this.bets=t}}class JK{constructor(t){this.props=t,NX.Gn(this,{footnotes:NX.EW,betLimitsRows:NX.EW})}get footnotes(){return[]}get betLimitsRows(){return[]}}(function(t){t["Player"]="player",t["Banker"]="banker",t["Tie"]="tie",t["BankerPair"]="banker_pair",t["PlayerPair"]="player_pair"})(TK||(TK={}));const UK=[TK.Player,TK.Banker,TK.Tie],lK=[TK.PlayerPair,TK.BankerPair],iK={[TK.Banker]:iV.K8.Banker,[TK.PlayerPair]:iV.K8.PlayerPair,[TK.BankerPair]:iV.K8.BankerPair};var GK;(function(t){t["LimitPlate"]="limitPlate",t["Tooltip"]="tooltip"})(GK||(GK={}));const dK="tableLimits";class MK extends JK{constructor(t){super(t),this.props=t,NX.Gn(this,{mainBetLimits:NX.EW,sideBetLimits:NX.EW})}get footnotes(){var t,V;const X=this.props.root.tableConfig.config;if(!X)return[];const K=[];this.addMainBetLimitFootnote(K);const k=null===(t=null==X?void 0:X.coefficientReductions)||void 0===t?void 0:t[iV.K8.PlayerPair],A=null===(V=null==X?void 0:X.coefficientReductions)||void 0===V?void 0:V[iV.K8.BankerPair];return k?this.addSideBetLimitFootnote(K,"**",k):A&&this.addSideBetLimitFootnote(K,"**",A),K}get betLimitsRows(){const{isDesktop:t}=this.props.root.device,{min:V,max:X}=this.props.root.tableConfig.tableLimitsSettings,K=this.mainBetLimits;var k,A,$,I;return K.push(...this.sideBetLimits),this.props.root.settings.displayTableLimit&&V>0&&X>0&&t&&K.push(...(k=V,A=X,$=!t,I=this.props.root.settings.currencySymbol,[{},{betKey:dK,betTitle:q.Tl(dK),min:k,max:A,isMobile:$,currencySymbol:I}])),K}addMainBetLimitFootnote(t){const{payoutLimit:V,currencySymbol:X}=this.props.root.settings,K=q.Tl(`limitPlate.${iV.K8.Banker.toLocaleLowerCase()}LightningFeeInfo`);t.push(`* ${K}`);const k=HX.ej(V,{currencySymbol:X}),A=q.Tl("limitPlate.payoutLimit"),$=q.Tl("limitPlate.plusInitialBet");t.push(`${A} ${k} ${$}`)}addSideBetLimitFootnote(t,V,X){const K=function(t,V){const X=[1,.5].includes(t),K=xX.J0.multiply(t,100),k=`${V}.superSixCannotExceed${X?K:"X"}${void 0?"Crop":""}`;return q.Tl(k,{percent:K})}(X,GK.LimitPlate);t.push(`${V} ${K}`)}get mainBetLimits(){return UK.map((t=>{const V=this.createLimitRowProps(t);if(t===TK.Banker&&(V.betTitle+="*"),t===TK.Tie)if(this.props.root.settings.isNoMaxPayoutLimitInfo)V.payout=q.Tl("limitPlate.short");else{const{payoutLimit:t,currencySymbol:X}=this.props.root.settings,K=HX.ej(t,{currencySymbol:X});V.payout=q.Tl(this.props.upToKey?this.props.upToKey:"limitPlate.upTo.new",{payoutLimit:K})}return V}))}get sideBetLimits(){const t=[{isMobile:!this.props.root.device.isDesktop}];return lK.forEach((V=>{var X,K;const k=this.createLimitRowProps(V),A=iK[V];(null===(K=null===(X=this.props.root.tableConfig.config)||void 0===X?void 0:X.coefficientReductions)||void 0===K?void 0:K[A])&&(k.betTitle+="**"),t.push(k)})),t}createLimitRowProps(t){const{currencySymbol:V}=this.props.root.settings,{betSpot:X,labelTranslationId:K,payoutTranslationId:k}=this.props.betLimitConfig[t];return{betKey:t,betTitle:q.Tl(K),min:this.props.root.betSpot.getMinBetSpotValue(X),max:this.props.root.betSpot.getMaxBetSpotValue(X),payout:k?q.Tl(k):"",isMobile:!this.props.root.device.isDesktop,currencySymbol:V}}}var BK,oK,fK,gK,tk,Vk;function Xk(t){return V=>({...V,...t()})}(function(t){t["PressedSettings"]="CLIENT_PRESSED_SETTINGS",t["FourRoads"]="CLIENT_TAP_ROADS2",t["Prediction"]="CLIENT_PRESSED_PROB",t["BeadRoad"]="CLIENT_BEAD_ROAD",t["RedEnvelopePayoutDisplayed"]="CLIENT_BACCARAT_REDENVELOPE_PAYOUT_DISPLAYED",t["ClientReceivedBetResponse"]="CLIENT_RECEIVED_BET_RESPONSE",t["PressedButton"]="CLIENT_PRESSED_BUTTON"})(BK||(BK={})),function(t){t["Bets"]="bets",t["GameType"]="gameType",t["GameTime"]="gameTime",t["UserAgent"]="userAgent",t["Balance"]="balance",t["Currency"]="currency",t["ChipStack"]="chipStack",t["TableLimits"]="tableLimits",t["GameId"]="gameId",t["ShoeName"]="shoeName"}(oK||(oK={})),function(t){t["PeekControl"]="Peek",t["ChipStack"]="Chipstack"}(fK||(fK={})),function(t){t["Big"]="BigRoad",t["BigEye"]="BigEyeRoad",t["Cockroach"]="CockroachRoad",t["SmallEye"]="SmallEyeRoad"}(gK||(gK={})),function(t){t["Enlarged"]="Enlarged",t["Original"]="Original"}(tk||(tk={})),function(t){t["SoundMute"]="soundMute",t["SoundUnmute"]="soundUnmute"}(Vk||(Vk={}));var Kk=X(456647),kk=X(254545);const Ak=[oK.Bets,oK.GameType,oK.GameTime,oK.UserAgent,oK.Balance,oK.Currency],$k=[oK.Bets,oK.GameType,oK.GameTime,oK.Currency,oK.ChipStack,oK.TableLimits,oK.Balance];function Ik(t){return{[iV.K8.Banker]:"BAC_Banker",[iV.K8.Player]:"BAC_Player",[iV.K8.Tie]:t.tiePays9to1?"BAC_Tie9to1":"BAC_Tie",[iV.K8.BankerBonus]:"BAC_BankerBonus",[iV.K8.BankerPair]:"BAC_BankerPair",[iV.K8.EitherPair]:"BAC_EitherPair",[iV.K8.SuperSix]:"BAC_SuperSix",[iV.K8.PlayerBonus]:"BAC_PlayerBonus",[iV.K8.PlayerPair]:"BAC_PlayerPair",[iV.K8.PerfectPair]:"BAC_PerfectPair"}}class Ck{constructor(t){this.props=t}getCustomEnhancers(){return{[oK.Bets]:Xk((()=>({bets:NX.HO(this.props.root.bets.bets)}))),[oK.GameType]:Xk((()=>({gameType:iV.ZF.Baccarat}))),[oK.UserAgent]:Xk((()=>({userAgent:this.props.root.device.DS.userAgent})))}}clientPressedSetting(t,V){this.commonLog({type:BK.PressedSettings,payload:{settingName:t,newValue:V}})}clientPressedButton(t,V){this.commonLog({type:BK.PressedButton,payload:{buttonName:t,...V}})}clientFourRoad(t,V){this.commonLog({type:BK.FourRoads,payload:{mode:t,type:V}})}clientPrediction(t){this.commonLog({type:BK.Prediction,payload:{mode:t}})}clientBeadRoad(t){this.commonLog({type:BK.BeadRoad,payload:{mode:t}})}clientRedEnvelopePayoutDisplayed(t){this.commonLog({type:BK.RedEnvelopePayoutDisplayed,payload:{bonus:t}})}clientBetChip(t){const V={},X=this.getBetExternalIds();Object.keys(t.bets).forEach((K=>{const k=X[K];k&&(V[k]=t.bets[K])}));const K={type:t.type,amount:t.amount,codes:V,currentBets:t.currentBets,currentSpotValue:t.currentSpotValue,balanceBeforeBet:t.balanceBeforeBet};this.log(Kk.Fv(K,this.betChipLogEnhancers))}clientPressedOnBetsOutOfBettingTime(){this.commonLog({type:kk.L.PressedOnBetsOutOfBettingTime})}clientBetResponse(t){this.commonLog({type:BK.ClientReceivedBetResponse,payload:t})}get defaultLogEnhancers(){return Ak}get betChipLogEnhancers(){return $k}commonLog(t){this.log({...t,enhancers:this.defaultLogEnhancers})}log(t){this.props.root.ag.actions.log(t)}getBetExternalIds(){const{tiePays9to1:t,useRedEnvelopePayouts:V}=this.props.root.settings;return Ik({tiePays9to1:!V&&t})}}const nk=[oK.Bets,oK.GameType,oK.UserAgent,oK.Balance,oK.Currency,oK.GameId,oK.ShoeName],qk=[...nk,oK.ChipStack,oK.TableLimits,oK.GameId],Rk=[oK.Bets,oK.GameType,oK.Currency,oK.ChipStack,oK.TableLimits,oK.ShoeName];var Fk,sk,Sk,ck;(function(t){t["PressedButton"]="CLIENT_PRESSED_BUTTON",t["ClientGameAction"]="CLIENT_GAME_ACTION",t["GamePaused"]="CLIENT_GAME_PAUSED",t["GameUpPaused"]="CLIENT_GAME_UNPAUSED"})(Fk||(Fk={})),function(t){t["BetsOpened"]="BetsOpened",t["ShuffleStarted"]="ShuffleStarted",t["FreeHandDealt"]="FreeHandDealt",t["UpdateGameId"]="updateGameId",t["SetGameVisibility"]="setVisibility",t["Reconnecting"]="reconnecting"}(sk||(sk={})),function(t){t["Deal"]="Deal",t["Rebet"]="Rebet",t["CutTheDeck"]="CutTheDeck",t["SkipShuffle"]="SkipShuffle",t["FreeGame"]="FreeGame",t["ClearTable"]="ClearTable"}(Sk||(Sk={})),function(t){t["FaceUp"]="FaceUp",t["FaceDown"]="FaceDown"}(ck||(ck={}));class Nk extends Ck{constructor(t){super(t),this.props=t}getCustomEnhancers(){return{...super.getCustomEnhancers(),[oK.GameType]:Xk((()=>({gameType:"rng-baccarat"}))),[oK.GameId]:Xk((()=>({gameId:this.props.root.ag.values.gameRoundId}))),[oK.ShoeName]:Xk((()=>({})))}}betsOpenGameAction(){this.commonLog({type:Fk.ClientGameAction,payload:{action:sk.BetsOpened}})}gamePaused(){this.log({type:Fk.GamePaused})}gameUnPaused(){this.log({type:Fk.GameUpPaused})}shuffleStartedGameAction(){this.commonLog({type:Fk.ClientGameAction,payload:{action:sk.ShuffleStarted}})}updateGameIdGameAction(t){this.commonLog({type:Fk.ClientGameAction,payload:{action:sk.UpdateGameId,processingGameId:t}})}freeHandGameAction(t){this.commonLog({type:Fk.ClientGameAction,payload:{action:sk.FreeHandDealt,distributionType:t?ck.FaceUp:ck.FaceDown}})}reconnectingGameAction(t){this.commonLog({type:Fk.ClientGameAction,payload:{action:sk.Reconnecting,processingGameId:t}})}setGameVisibilityGameAction(t){this.commonLog({type:Fk.ClientGameAction,payload:{action:sk.SetGameVisibility,processingGameId:t}})}dealPressed(){this.buttonPressed(Sk.Deal)}freeGamePressed(){this.buttonPressed(Sk.FreeGame)}skipShufflePressed(){this.buttonPressed(Sk.SkipShuffle)}clearTablePressed(){this.buttonPressed(Sk.ClearTable)}cutPressed(){this.buttonPressed(Sk.CutTheDeck)}clientBetAcceptedRejected(t){const{ag:V}=this.props.root;let X,K;const k=t.acceptedBets;if(k)for(const t of Object.keys(k)){const V=k[t];V&&(K||(K={}),K[t]=V.amount)}if(t.originalBets)X=t.originalBets;else{X={...K||{}};const V=t.rejectedBets;if(V)for(const t of Object.keys(V)){const K=V[t];K&&(X[t]=K.amount)}}const A={originalBet:X,confirmed:K,rejected:t.rejectedBets,layout:V.values.layoutCurrent,repeat:t.repeat,status:t.status,balance:t.balance,latency:V.values.networkLatency};let $=kk.L.ClientBetAccepted;A.confirmed&&A.rejected?$=kk.L.ClientBetAcceptedPartial:A.rejected&&($=kk.L.ClientBetRejected),this.betLog({type:$,payload:A})}get defaultLogEnhancers(){return nk}get betChipLogEnhancers(){return Rk}get betLogEnhancers(){return qk}buttonPressed(t){this.commonLog({type:Fk.PressedButton,payload:{buttonName:t}})}betLog(t){this.log({...t,enhancers:this.betLogEnhancers})}}class mk extends Nk{constructor(t){super(t),this.props=t}getCustomEnhancers(){const{betProcessor:t,bets:V}=this.props.root;return{...super.getCustomEnhancers(),[oK.Bets]:Xk((()=>({bets:t.calculateUpdatedBets(NX.HO(V.bets))}))),[oK.GameId]:Xk((()=>({gameId:this.props.root.table.table.nextGameId}))),[oK.ShoeName]:Xk((()=>({shoeName:this.props.root.table.table.shoeId})))}}shuffleStartedMultiGameAction(t){this.commonLog({type:Fk.ClientGameAction,payload:{shoeNames:t,action:sk.ShuffleStarted}})}getBetExternalIds(){const{tiePays9to1:t}=this.props.root.settings;return{...Ik({tiePays9to1:t}),[gX.PlayerFee]:"BAC_Player_Fee",[gX.PlayerPairFee]:"BAC_PlayerPair_Fee",[gX.BankerFee]:"BAC_Banker_Fee",[gX.BankerPairFee]:"BAC_BankerPair_Fee",[gX.TieFee]:"BAC_Tie_Fee"}}}class vk extends mk{getBetExternalIds(){const{tiePays9to1:t}=this.props.root.settings;return{...Ik({tiePays9to1:t}),[fX.PlayerLightning]:"BAC_Player_Lightning",[fX.PlayerPairLightning]:"BAC_PlayerPair_Lightning",[fX.BankerLightning]:"BAC_Banker_Lightning",[fX.BankerPairLightning]:"BAC_BankerPair_Lightning",[fX.TieLightning]:"BAC_Tie_Lightning"}}}var Wk,Zk=X(405215),Dk=X.n(Zk);(function(t){t["Player0"]="player0",t["Player1"]="player1",t["Player2"]="player2",t["Banker0"]="banker0",t["Banker1"]="banker1",t["Banker2"]="banker2"})(Wk||(Wk={}));const yk=[Wk.Player0,Wk.Banker0,Wk.Player1,Wk.Banker1,Wk.Player2,Wk.Banker2];class Ek{constructor(t){this.props=t,this.values=[],this.mapValues=NX.sH.map(),this.potentialMultipliers={},this.cardsVisible=!1,NX.Gn(this,{values:NX.sH.ref,mapValues:NX.sH,potentialMultipliers:NX.sH,setMultipliers:NX.XI.bound,setPotentialMultipliers:NX.XI.bound,reset:NX.XI.bound,multiplierCardsExist:NX.EW,multipliersCards:NX.EW,matchedCards:NX.EW,multiplierCardsDealtCount:NX.EW,cardsVisible:NX.sH,setCardsVisible:NX.XI.bound})}setMultipliers(t){if(!Dk()(t,this.values)){this.values=t,this.mapValues.clear();for(const V of t)this.mapValues.set(V.card,V.value);0===t.length&&(this.cardsVisible=!1)}}setPotentialMultipliers(t){this.potentialMultipliers=t}get multiplierCardsDealtCount(){const{Banker:t,Player:V}=this.matchedCards;return t.length+V.length}getBetSpotMultiplier(t){return this.potentialMultipliers[t]||0}reset(){this.values=[],this.potentialMultipliers={},this.mapValues.clear(),this.cardsVisible=!1}get multipliersCards(){const{dealtCards:t}=this.props.cards;return this.values.map((V=>({card:V.card,multiplier:V.value,isDealt:t.includes(V.card),baseTime:this.props.baseTime||0,cardTime:this.props.cardTime||0})))}get multiplierCardsExist(){return this.values.length>0}checkIfCardMatched(t,V,X){const K=this.props.gameResult.winner,k=this.mapValues.has(t);return K?(K===iV.K8.Tie||K===V||X<2&&V===zK.Banker&&this.getBetSpotMultiplier(iV.K8.BankerPair)>1||X<2&&V===zK.Player&&this.getBetSpotMultiplier(iV.K8.PlayerPair)>1)&&k:k}get matchedCards(){return{[zK.Player]:this.getMatchedCardsByHand(zK.Player),[zK.Banker]:this.getMatchedCardsByHand(zK.Banker)}}get dealtCardMultiplier(){var t;const V=this.props.cards.dealtOrderedCards,X={};for(let K=0;K<yk.length;K++)X[yk[K]]=V.length>K&&null!==(t=this.mapValues.get(V[K]))&&void 0!==t?t:0;return X}setCardsVisible(){this.cardsVisible=!0}getMatchedCardsByHand(t){return this.props.cards.hands[t].cards.filter(((V,X)=>this.checkIfCardMatched(V,t,X)))}}function _k(t,V,X,K,k){V.includes(t)&&K.filter((t=>X.includes(t))).forEach((V=>{k.cards.has(V)||k.cards.set(V,new Set);const X=k.cards.get(V);X&&X.add(t)}))}function pk(t,V){const X=t.find((t=>t.card===V));return X?X.multiplier:1}function Lk(t,V){return V.reduce(((V,X)=>V*pk(t,X)),1)}function Ok(t,V){return(V.length>=2?[V[0],V[1]]:V).reduce(((V,X)=>V*pk(t,X)),1)}class rk extends Ek{constructor(t){super(t),this.props=t,NX.Gn(this,{spotsMultipliers:NX.EW,lightStrikeSpots:NX.EW,winTotalMultiplier:NX.EW})}get spotsMultipliers(){const t={[iV.K8.Banker]:1,[iV.K8.Player]:1,[iV.K8.PlayerPair]:1,[iV.K8.BankerPair]:1,[iV.K8.Tie]:1};if(this.props.root.gamePhase.value===iV.Qc.Resolved){const V=t;return Object.keys(this.potentialMultipliers).forEach((t=>{const X=this.potentialMultipliers[t];X&&(V[t]=X)})),V}const V=this.props.cards.hands.Banker.cards,X=this.props.cards.hands.Player.cards;if(this.props.root.gamePhase.value===iV.Qc.Revealing){const K=V.length>=2&&("XX"===V[1]||V[0]===V[1]),k=X.length>=2&&("XX"===X[1]||X[0]===X[1]),A=this.props.defaultTieSideSpotsMap,$=Lk(this.multipliersCards,X),I=Lk(this.multipliersCards,V),C=Ok(this.multipliersCards,V),n=Ok(this.multipliersCards,X);if(n>1&&(t[iV.K8.Player]*=n,k&&(t[iV.K8.PlayerPair]*=n*A[iV.K8.PlayerPair])),C>1&&(t[iV.K8.Banker]*=C,K&&(t[iV.K8.BankerPair]*=C*A[iV.K8.BankerPair])),I*$>1){const V=t[iV.K8.Tie]*I*$*A[iV.K8.Tie];t[iV.K8.Tie]=Math.round(100*(V+Number.EPSILON))/100}}return t}get lightStrikeSpots(){const t=[iV.K8.Player,iV.K8.PlayerPair,iV.K8.Tie],V=[iV.K8.Banker,iV.K8.BankerPair,iV.K8.Tie],X=this.values.map((t=>t.card)),K={cards:new Map,potentialMultipliers:this.spotsMultipliers},k=this.props.cards.hands.Player.cards,A=this.props.cards.hands.Banker.cards;return Object.keys(this.spotsMultipliers).forEach(($=>{const I=this.spotsMultipliers[$];I&&I>1&&Object.keys(this.props.root.bets.bets).includes($)&&(_k($,t,k,X,K),_k($,V,A,X,K))})),K}get winTotalMultiplier(){return this.props.root.gameResult.winningBetSpots.map((t=>this.props.root.bets.bets[t]?this.getBetSpotMultiplier(t):0)).sort(((t,V)=>V-t)).shift()||0}}var zk=X(36195),wk=X(712011),bk=X(625678);const ak=[bk.Z.RNGBaccarat];class uk{constructor(t){this.props=t,this.getMinBetSpotValue=this.getMinBetSpotValue.bind(this),this.getMaxBetSpotValue=this.getMaxBetSpotValue.bind(this)}get currencyCode(){return this.props.settings.getCurrencyCode()}get currencySymbol(){return this.props.settings.getCurrencySymbol()}get redEnvelopeMath(){return this.props.settings.redEnvelopeMath}get currencyDecimals(){return this.props.settings.getCurrencyDecimals()}get tableName(){return this.props.settings.getTableName()}get betsClosingTime(){return this.props.settings.betsClosingTime()}get displayTableLimit(){return this.props.settings.displayTableLimit()}get tableLimits(){return this.props.settings.tableLimits}get tiePays9to1(){return this.props.settings.tiePays9to1}get tableLogo(){const t=this.props.settings.tableLogo;return wk.d(t)||""}get excludedBeadRoadModes(){return this.props.settings.excludedBeadRoadModes}get scorecardTheme(){return this.props.settings.scorecardTheme||A.ScorecardThemeNames.WhiteSolid}get isMainBetsOnly(){return this.props.settings.mainBetsOnly}get isRng(){return ak.includes(this.props.settings.getGameType())}get prefixMinMax(){return this.props.settings.getPrefixMinMax()}get postfixMin(){return this.props.settings.getPostfixMin()}get postfixMax(){return this.props.settings.getPostfixMax()}get rawConfig(){return this.props.settings.rawConfig}get isFrozenSprites(){return this.props.settings.isFrozenSprites}get minTableLimit(){const{max:t,min:V}=this.props.settings.tableLimits;return V&&t?V:0}get maxTableLimit(){const{max:t,min:V}=this.props.settings.tableLimits;return t&&V?t:0}get payoutLimit(){return this.props.settings.payoutLimit()||0}getMinBetSpotValue(t){const{rawConfig:V}=this.props.settings;return+V[`${this.prefixMinMax}${SK(t)}_${this.postfixMin}`]}getMaxBetSpotValue(t){const{rawConfig:V}=this.props.settings;return+V[`${this.prefixMinMax}${SK(t)}_${this.postfixMax}`]}get useRedEnvelopePayouts(){return this.props.settings.isRedEnvelope}get sessionId(){return this.props.settings.sessionId()}get tableId(){return this.props.settings.getTableId()}get virtualTableId(){return this.props.settings.getVirtualTableId()}get volatility(){return this.props.settings.volatility}get hideYouWinOnLowCelebration(){return this.props.settings.hideYouWinOnLowCelebration()}}var jk=X(876759),xk=X(163095),ek=X(246250),Yk=X(933233);const Hk=0?0:xk.A((()=>Yk.w(window.location.href).getParam("branding"))),hk=[ek.F.SuperSix,ek.F.PerfectPair,ek.F.BankerBonus,ek.F.PlayerBonus];class Tk extends uk{constructor(t){super(t),this.props=t}get chipAmounts(){return this.props.settings.getChipAmounts()}get isRng(){return!0}get scorecardTheme(){return this.props.settings.scorecardTheme||A.ScorecardThemeNames.BlackDot}get hasNoCommissionTableTexture(){return this.props.settings.hasNoCommissionTableTexture||!1}get superSixMainBetsPercentage(){const{parsedTableConfig:t}=this.props.settings;return t.super_six_main_bets_percentage||100}get excludedBeadRoadModes(){const t=this.props.settings.excludedBeadRoadModes;return 0===this.freeHandLimit&&t.push(R.I.Number),this.props.settings.excludedBeadRoadModes}get coefficientReductionLimitMap(){return t=this.rawConfig,V=this.superSixMainBetsPercentage,X=this.bonusToMainBetsPercentage,Object.values(ek.F).reduce(function(t,V,X){return(K,k)=>{const A=function(t,V,X,K){const k=t[V];if(hk.includes(V)&&!k){const t=V===ek.F.SuperSix;return`0:${xX.J0.divide(t?X:K,100)}`}return k}(t,k,V,X);return A&&(K[k]=function(t){return t.split(";").filter(Boolean).reduce(((t,V)=>{const[X,K]=V.split(":");return t[X]=Number(K),t}),{})}(A)),function(t,V){var X;hk.includes(V)&&(t[V]?t[V]&&!(null===(X=t[V])||void 0===X?void 0:X[0])&&(t[V]={0:1,...t[V]}):t[V]={0:1})}(K,k),K}}(t,V,X),{});var t,V,X}get isMultiTable(){return!1}get bonusToMainBetsPercentage(){const{parsedTableConfig:t}=this.props.settings;return t.bonus_main_bets_percentage||100}get isLowRisk(){const{parsedTableConfig:t}=this.props.settings;return!0===t.low_risk}get limitsPrefix(){return qK.Commission}get tableLimits(){return{min:N(this.rawConfig[`${this.limitsPrefix}.table_bet_min_limit`])||0,max:N(this.rawConfig[`${this.limitsPrefix}.table_bet_max_limit`])||0}}get goLiveUrl(){var t;return null!==(t=this.props.settings.getRngGoLiveUrl())&&void 0!==t?t:""}get appVersion(){return this.props.settings.getAppVersion()}get slowNetworkSpeed(){return this.props.settings.slowNetworkSpeed}get freeHandLimit(){return this.props.settings.freeHandLimit}get isNetworkSpeedSlow(){const t=navigator.connection;return!(void 0===t||!this.slowNetworkSpeed)&&t.downlink<=this.slowNetworkSpeed}get gameSpeedMode(){return this.props.settings.gameSpeedMode}get gameSpeedModeSettings(){if(!this.gameSpeedMode)return;const t=this.props.settings.rawConfig[`game_speed_mode_settings_${this.gameSpeedMode}`];return t?t.split(";").map((t=>Number(t))):void 0}get defaultBeadRoadMode(){return this.props.settings.beadRoadMode}get skipAnimations(){let t=!1;return jk.I()&&(t=!0),void 0!==this.props.settings.skipAnimations&&(t=this.props.settings.skipAnimations),t}get branding(){var t;let V=zk.M.Standard;const X=null===(t=this.props.settings.style.config.rng)||void 0===t?void 0:t.branding,K=this.props.settings.branding();for(const t of[X,K,Hk()])t&&Y.KD(t)&&(V=t);return V}get decor(){return this.props.settings.decor}get voiceLanguage(){const{voiceSoundLanguage:t}=q.vL();return t}}class Pk extends Tk{constructor(t){super(t),this.props=t}get isNoMaxPayoutLimitInfo(){return this.props.settings.isNoMaxPayoutLimitInfo}get isRtpProbabilityV2(){return this.props.settings.isRtpProbabilityV2}}class Qk{constructor(t){this.props=t,this.config=void 0,NX.Gn(this,{config:NX.sH,tableConfigMinLimit:NX.EW,tableConfigMaxLimit:NX.EW,tableLimitsSettings:NX.EW,setConfig:NX.XI.bound,setTableLimits:NX.XI.bound,setCoefficientReductions:NX.XI.bound})}setConfig(t){this.config=t}setCoefficientReductions(t){this.config&&(this.config={...this.config,coefficientReductions:t})}setTableLimits(t){this.config&&(this.config={...this.config,limits:t})}get tableConfigMinLimit(){return this.getTableConfigLimit(nK.Min)}get tableConfigMaxLimit(){return this.getTableConfigLimit(nK.Max)}get tableLimitsSettings(){var t,V;const X=qK.Commission;return{min:Number(null!==(t=this.props.root.settings.rawConfig[`${X}.table_bet_min_limit`])&&void 0!==t?t:0),max:Number(null!==(V=this.props.root.settings.rawConfig[`${X}.table_bet_max_limit`])&&void 0!==V?V:0)}}getTableConfigLimit(t){const V=[iV.K8.Player,iV.K8.Banker],X=this.config;if(!X)return Math.min(...V.map((V=>this.getLimitFromAll(V,t))));const K=V.map((V=>{var K,k,A;return null!==(A=null===(k=null===(K=null==X?void 0:X.limits)||void 0===K?void 0:K[V])||void 0===k?void 0:k[t])&&void 0!==A?A:0})),[k,A]=K;return k||A?Math.min(...K):Math.min(...V.map((V=>this.getLimitFromAll(V,t))))}getLimitFromAll(t,V){return this.config?(X=>{var K,k,A;return null!==(A=null===(k=null===(K=null==X?void 0:X.limits)||void 0===K?void 0:K[t])||void 0===k?void 0:k[V])&&void 0!==A?A:0})(this.config):0}}var Jk;function Uk(t){return{type:Jk.ShuffleShoeMulti,details:{table:{tableId:t.tableId,virtualTableId:t.virtualTableId},shoeNames:t.shoeNames}}}(function(t){t["GetState"]="GetState",t["ShuffleShoe"]="ShuffleShoe",t["BurnCards"]="BurnCards",t["CutShoe"]="CutShoe",t["SendBets"]="PlayGame",t["PlayFreeGame"]="PlayFreeGame",t["GetGame"]="GetGame",t["ShuffleShoeMulti"]="ShuffleShoeMulti"})(Jk||(Jk={}));class lk{constructor(t){this.props=t,this.recipient="rng-baccarat"}getGameState(t){this.sendMessage(function(t){return{type:Jk.GetState,details:{table:{tableId:t.tableId,virtualTableId:t.virtualTableId}}}}(t))}burnCards(t){this.sendMessage(function(t){return{type:Jk.BurnCards,details:{table:{tableId:t.tableId,virtualTableId:t.virtualTableId},shoeName:t.shoeName}}}(t))}sendBets(t,V,X){this.sendMessage(function(t,V,X){return{type:Jk.SendBets,details:{bets:V,table:{tableId:t.tableId,virtualTableId:t.virtualTableId},shoeName:t.shoeName,tags:X}}}(t,V,X))}shuffleShoe(t){this.sendMessage(Uk({tableId:t.tableId,virtualTableId:t.virtualTableId,shoeNames:[t.shoeName]}))}shuffleShoeMulti(t){this.sendMessage(Uk(t))}cutShoe(t,V){this.sendMessage(function(t,V){return{type:Jk.CutShoe,details:{position:V,table:{tableId:t.tableId,virtualTableId:t.virtualTableId},shoeName:t.shoeName}}}(t,V))}playFreeGame(t){this.sendMessage(function(t){return{type:Jk.PlayFreeGame,details:{table:{tableId:t.tableId,virtualTableId:t.virtualTableId},shoeName:t.shoeName}}}(t))}getGame(t){this.sendMessage(function(t){return{type:Jk.GetGame,details:{gameId:t}}}(t))}pauseTransport(){this.props.gameTransport.pause()}resumeTransport(){this.props.gameTransport.resume()}sendMessage(t){this.props.gameTransport.sendStandardMessageAndWaitForReply(this.recipient,t).then((t=>{this.props.messageHandler(t)})).catch((()=>{}))}}class ik extends lk{constructor(t){super(t)}}function Gk(t){t.cutCardsSlider.showSlider(!1),t.cutCardsSlider.resetCutCardsPosition()}function dk(t){t.cutCardsSlider.showSlider(!0)}function Mk(t){return V=>function(t,V){switch(t.type){case a.CutCardsWaitForInput:dk(V);break;case a.CutCardsAquirePosition:break;case a.CutCardsCancelled:Gk(V);break;default:(function(t,V){switch(t.type){case a.BetSpotPressed:(function(t,V){t.animation.isDeckShuffleProcedureActive||t.animation.isDragAndDropActive||t.betProcessor.placeChip(V.payload.betSpot)})(V,t);break;case a.MoveBetDone:(function(t,V){t.betProcessor.move(V.payload.betSpotFrom,V.payload.betSpotTo)})(V,t);break;case a.MoveBetStart:(function(t,V){const X=V.payload.betSpotFrom;if(X===iV.K8.Player||X===iV.K8.Banker){const V=t.betSpot.lockedBetSpots.filter((t=>t!==iV.K8.Player&&t!==iV.K8.Banker));t.messageSender3d.to.updateLockedSpots({locked:V})}})(V,t);break;case a.SelectChip:(function(t,V){t.ag.actions.betAmounts.selectBetAmount(V.payload.chipValue,V.payload.withoutSave)})(V,t);break;case a.CutCardsWaitForInput:dk(V);break;case a.CutCardMove:(function(t,V){t.cutCardsSlider.setCutCardsSliderPosition(V.payload.position)})(V,t);break;case a.CutCardsStart:(function(t){t.cutCardsSlider.showSlider(!1)})(V);break;case a.CutCardsDone:(function(t){t.cutCardsSlider.resetCutCardsPosition()})(V);break;case a.CutCardsCancelled:Gk(V)}})(t,V)}}(V,t)}function Bk(t){return NX.mJ((()=>t.gamePhase.isBetsClosed),(V=>{V&&t.ag.actions.betting.setHasValidBets(t.ag.values.balanceTotalBet>0)}))}function ok(t){return NX.mJ((()=>({amount:t.gameResult.amount,hasBets:Object.keys(t.bets.bets).length>0})),(({amount:V,hasBets:X})=>{(0!==V||X)&&t.ag.actions.gameResult.setAmount(V)}))}function fk(t,V,X){let K=!1;if(V!==X&&V!==iV.Qc.NewGame)switch(K=!0,V){case iV.Qc.BetsOpen:t.ag.actions.lifecycle.openBets();break;case iV.Qc.BetsClosed:t.ag.actions.lifecycle.closeBets();break;case iV.Qc.Resolved:t.ag.actions.lifecycle.resolveGame()}return K}function gk(t){return NX.mJ((()=>t.gamePhase.value),((V,X)=>fk(t,V,X)))}const tA=(t,V)=>[ok(t),Bk(t),...V?[gk(t)]:[]];var VA=X(332635);class XA{constructor(t){this.api=t.ag,this.values=function(t){const V={gamePaused:(X=t).gamePaused.state,orientation:X.orientation,isInFullscreen:X.fullscreen.isInFullscreen,isGoingLive:X.isGoingLive,gameDimensions:X.gameDimensions,preferences:X.preferences.values,gameRoundId:X.gameRoundId,playMode:X.playMode,isPageVisible:X.isPageVisible,chipstackHidden:X.chipstack.hidden,betAmountsLastSelectedAmount:X.betAmounts.lastSelectedAmount,chipstackChipColors:X.chipstack.chipColors,betAmounts:X.betAmounts.amounts,lifecycleCurrent:X.lifecycle.current,networkLatency:X.network.latency,decisionTimerHidden:X.decisionTimer.hidden,decisionTimerSecondsRemaining:X.decisionTimer.secondsRemaining,bettingTags:X.betting.tags,betModifier:X.betAmounts.betModifier,tooltipsCurrent:X.tooltips.current,gameNumber:X.gameNumber,tableName:X.tableName,layoutCurrent:X.layout.current,layoutImmersiveFooterCollapsed:X.layout.immersive.footer.collapsed,layoutClassicVideoIsExpanded:X.layout.classic.video.expanded,layoutOpenMobileDrawerId:X.layout.drawer.mobile.current,layoutDesktopDrawerCurrentOpenId:X.layout.drawer.desktop.current,menuOpenScreenId:X.menu.openScreenId,menuIsOpen:X.menu.isOpen,videoIsPlaying:X.video.isPlaying,videoQuality:X.video.quality,videoPlayerName:X.video.playerName,videoStreamForCurrentLayout:X.video.streamForCurrentLayout,videoMobileScale:X.video.mobile.scale,videoMobileScalingContainerHtmlElement:X.video.mobile.scalingContainerHtmlElement,videoInfoVisible:X.video.info.visible,gameResultAmount:X.gameResult.amount,statusBarProps:X.statusBar.props,statusBarOverlayProps:X.statusBar.overlayProps,balanceAvailable:X.balance.available,balanceReserved:X.balance.reserved,balanceReservedTip:X.balance.reservedTip,balanceServer:X.balance.server,balanceActiveId:X.balance.activeId,balanceTotalBet:X.balance.totalBet,balanceIsLow:X.balance.isLow,balanceIsPaused:X.balance.isPaused,winnersListHidden:X.winnersList.hidden,autoplayUIIsSettingsWindowOpen:X.autoplayUI.isSettingsWindowOpen,autoplayUIIsPreviousTotalBetVisible:X.autoplayUI.isPreviousTotalBetVisible,onboardingCurrent:X.onboardingBubbles.current,activeWallet:X.promotionsUI.activeWallet,currencyCode:X.currency.code,currencySymbol:X.currencySymbol,gameTheme:X.gameTheme,globalStylesCustomizableButton:X.globalStyles.current.customizableButton,tableLimitsMin:X.tableLimits.min,tableLimitsMax:X.tableLimits.max,tableLimitsPinned:X.tableLimits.ui.panel.isPinned,popupCurrent:X.popups.current,rootSize:X.rootSize};var X;return Object.keys(V).reduce(((t,X)=>{let K;const k=V[X],A=NX.MN(X,(()=>{K=k.subscribe((()=>{A.reportChanged()}))}),(()=>null==K?void 0:K()));return 0||Object.defineProperty(t,X,{get:()=>(A.reportObserved(),k.value)}),t}),{})}(t.ag)}get actions(){return this.api}get availableBalance(){return this.values.balanceAvailable}get lastSelectedChip(){return this.values.betAmountsLastSelectedAmount}get platform(){return this.api.platform}get balanceTotalBet(){return this.values.balanceTotalBet}get betAmounts(){return this.actions.betAmounts.amounts.value}get currentLayout(){return this.values.layoutCurrent}get gameTheme(){return this.values.gameTheme}}class KA{constructor(){this.bets={},this.rejectedBets=void 0,this.status=iV.uB.Idle,this.repeat=void 0,this.history=[],NX.Gn(this,{bets:NX.sH,rejectedBets:NX.sH,status:NX.sH,repeat:NX.sH,history:NX.sH,hasBets:NX.EW,updateBetsState:NX.XI.bound,reset:NX.XI.bound,setStatus:NX.XI.bound,setRepeat:NX.XI.bound,setBets:NX.XI.bound}),this.getBetSpotValue=this.getBetSpotValue.bind(this)}setBets(t){this.bets=this.removeZeroes(t)}setHistory(t){this.history=t}setStatus(t){this.status=t}setRejectedBets(t){this.rejectedBets=t}setRepeat(t){this.repeat=t}updateBetsState(t){t.bets&&this.setBets(t.bets),t.history&&this.setHistory(t.history),t.status&&this.setStatus(t.status),cK(t,"rejectedBets")&&this.setRejectedBets(t.rejectedBets),cK(t,"repeat")&&this.setRepeat(t.repeat)}getBetSpotValue(t){const V=this.bets[t];return"number"==typeof V?V:0}reset(){this.bets={},this.status=iV.uB.Idle,this.history=[]}get hasHistory(){return!!this.history.length}get hasBets(){return!uX.A(this.bets)}removeZeroes(t){return Object.keys(t).reduce(((V,X)=>(t[X]&&(V[X]=t[X]),V)),{})}}function kA(){const t={cards:[],score:0};return{[zK.Banker]:t,[zK.Player]:t}}class AA{constructor(){this.hands=kA(),this.cleared=!1,this.dealSoon=!1,NX.Gn(this,{hands:NX.sH,cleared:NX.sH,dealSoon:NX.sH,setHands:NX.XI,setCleared:NX.XI,setDealSoon:NX.XI,dealtCards:NX.EW,resetHands:NX.XI})}setHands(t){this.hands=t}getCards(t){return this.hands[t].cards}hasOpenCard(t){return this.getCards(t).some((t=>t!==iV.Zp.UnknownCard))}getScore(t){return this.hasOpenCard(t)?this.hands[t].score:void 0}get dealtCards(){const t=this.getCards(zK.Player),V=this.getCards(zK.Banker);return t.concat(V)}get dealtOrderedCards(){const t=this.getCards(zK.Player),V=this.getCards(zK.Banker),X=[];for(let K=0;K<3&&!(t.length<=K)&&(X.push(t[K]),!(V.length<=K));K++)X.push(V[K]);return X}resetHands(){this.setHands(kA())}setCleared(t){this.cleared=t}setDealSoon(t){this.dealSoon=t}}const $A=1.85,IA=320,CA=600,nA=812;class qA{constructor(t){this.props=t,NX.Gn(this,{isDesktop:NX.EW,isTablet:NX.EW,isPhone:NX.EW,isPortrait:NX.EW,isLandscape:NX.EW,dimensions:NX.EW,aspectRatio:NX.EW,isBigDeviceDimensions:NX.EW,platform:NX.EW,orientation:NX.EW,isSmallDevice:NX.EW,isSmallDeviceHeight:NX.EW,isLargeDevice:NX.EW,gameContainerDimensions:NX.EW,rootSize:NX.EW})}get isDesktop(){return this.props.root.ag.platform===zt.OD.Desktop}get DS(){return this.props.DS}get isTablet(){return this.platform===zt.OD.Tablet}get isPhone(){return this.platform===zt.OD.Phone}get orientation(){return this.props.root.ag.values.orientation}get platform(){return this.props.root.ag.platform}get isPortrait(){return this.orientation===nt.t.Portrait}get isLandscape(){return this.orientation===nt.t.Landscape}get dimensions(){return this.props.root.ag.values.gameDimensions}get rootSize(){return this.props.root.ag.values.rootSize}get aspectRatio(){const t=this.dimensions.containerWidth,V=this.dimensions.containerHeight;return Math.min(t,V)?Math.max(t,V)/Math.min(t,V):0}get isLowPerformanceDevice(){return this.DS.IS_ANDROID&&!this.DS.IS_ANDROID6_0_0_PLUS||this.DS.IS_IN_ANDROID_WEB_VIEW}get isBigDeviceDimensions(){return this.aspectRatio>$A}get isFF(){return this.props.DS.IS_FIREFOX}get isSmallDevice(){const{width:t,height:V}=this.dimensions;return(this.isPortrait?t:V)<=IA}get isSmallDeviceHeight(){const{width:t,height:V}=this.dimensions;return(this.isPortrait?V:t)<=CA}get isLargeDevice(){const{width:t,height:V}=this.dimensions;return(this.isPortrait?V:t)>=nA}get isNarrowScreenPhonePortrait(){const{height:t,width:V}=this.dimensions;return t>V&&V>=320&&V/t<=1e3/1900}get gameContainerDimensions(){const{boxWidth:t,boxHeight:V}=this.dimensions,X=this.dimensions.reverseScale||1;return{width:t/X,height:V/X,reverseScale:this.dimensions.reverseScale}}}var RA,FA,sA,SA=X(981298);class cA{constructor(){this.winner=void 0,this.winningBetSpots=[],this.betsAcceptedBetSpots=[],this.amount=0,this.acceptedBetsAmount=0,this.winType=SA.R.None,this.withEffect=!1,NX.Gn(this,{winner:NX.sH,winningBetSpots:NX.sH,betsAcceptedBetSpots:NX.sH,amount:NX.sH,winType:NX.sH,withEffect:NX.sH,color:NX.EW,resultLabel:NX.EW,setGameResultData:NX.XI,reset:NX.XI,setWithEffect:NX.XI})}get color(){switch(this.winner){case iV.K8.Banker:return"255,15,15";case iV.K8.Player:return"0,150,255";case iV.K8.Tie:return"0,255,0";default:return""}}get resultLabel(){return this.winner?q.Tl(this.winner.toLowerCase()):""}setWithEffect(t){this.withEffect=t}setGameResultData({winner:t,winningBetSpots:V,betsAcceptedBetSpots:X,amount:K,winType:k,acceptedBetsAmount:A}){this.winner=t,this.winningBetSpots=V,this.betsAcceptedBetSpots=null!=X?X:[],this.amount=K,this.acceptedBetsAmount=A,this.winType=k}reset(){this.winner=void 0,this.winningBetSpots=[],this.betsAcceptedBetSpots=[],this.amount=0,this.acceptedBetsAmount=0,this.winType=SA.R.None,this.setWithEffect(!1)}}(function(t){t["Desktop"]="ComponentLayout.Desktop",t["DesktopClassic"]="ComponentLayout.DesktopClassic",t["MobilePortrait"]="ComponentLayout.MobilePortrait",t["MobileLandscape"]="ComponentLayout.MobileLandscape",t["Tablet"]="ComponentLayout.Tablet"})(RA||(RA={})),function(t){t["DesktopImmersive"]="DesktopImmersive",t["DesktopClassic"]="DesktopClassic",t["TabletLive"]="TabletLive",t["PhonePortraitLive"]="PhonePortraitLive",t["PhoneLandscapeLive"]="PhoneLandscapeLive",t["ExtraLargeLandscape"]="ExtraLargeLandscape",t["LargeLandscape"]="LargeLandscape",t["SmallLandscape"]="SmallLandscape",t["PhonePortrait"]="PhonePortrait"}(FA||(FA={})),function(t){t[t["ThreeLines"]=0]="ThreeLines",t[t["TwoLinesPortrait"]=1]="TwoLinesPortrait",t[t["TwoLinesDesktopClassic"]=2]="TwoLinesDesktopClassic",t[t["TwoLinesDesktopImmersiveV2"]=3]="TwoLinesDesktopImmersiveV2",t[t["FourLinesDesktopClassic"]=4]="FourLinesDesktopClassic",t[t["Desktop"]=5]="Desktop",t[t["SixLinesPhoneV2"]=6]="SixLinesPhoneV2",t[t["Multiplay"]=7]="Multiplay"}(sA||(sA={}));class NA{constructor(t){this.props=t,NX.Gn(this,{componentLayout:NX.EW,isDesktopClassic:NX.EW,isDesktopImmersive:NX.EW})}get componentLayout(){return this.props.root.device.isDesktop?this.isDesktopClassic?RA.DesktopClassic:RA.Desktop:this.props.root.device.isTablet?RA.Tablet:this.props.root.device.isLandscape?RA.MobileLandscape:RA.MobilePortrait}get isDesktopClassic(){return this.props.root.ag.values.layoutCurrent===A.LayoutType.Classic}get isDesktopImmersive(){return this.componentLayout===RA.Desktop}get roadsDisplayMode(){const{isDesktopClassic:t,isDesktopImmersive:V}=this,{isPortrait:X,isTablet:K,isPhone:k}=this.props.root.device;return X?sA.TwoLinesPortrait:K||k?sA.SixLinesPhoneV2:t?sA.FourLinesDesktopClassic:V?sA.TwoLinesDesktopImmersiveV2:sA.ThreeLines}get beadRoadDisplayMode(){const{isDesktopClassic:t,isDesktopImmersive:V}=this,{isTablet:X,isPortrait:K,isBigDeviceDimensions:k}=this.props.root.device;return t||K&&k?FA.DesktopClassic:V?FA.DesktopImmersive:X?FA.TabletLive:K?FA.PhonePortraitLive:FA.PhoneLandscapeLive}get useInnerDimensions(){return[FA.DesktopImmersive,FA.DesktopClassic,FA.TabletLive].includes(this.beadRoadDisplayMode)}get hideYouWin(){return this.props.root.settings.hideYouWinOnLowCelebration&&this.props.root.gameResult.amount<=this.props.root.gameResult.acceptedBetsAmount}}class mA{constructor(){this.winner=void 0,NX.Gn(this,{winner:NX.sH,setPrediction:NX.XI,resetPrediction:NX.XI})}setPrediction(t){this.winner=t}resetPrediction(){this.winner=void 0}}class vA{constructor(){this.references=NX.sH.map(),NX.Gn(this,{set:NX.XI.bound,all:NX.EW,dispose:NX.XI.bound,references:NX.sH}),this.get=this.get.bind(this)}get all(){const t={};for(const[V,X]of this.references)t[V]=X;return t}set(t,V){this.references.set(t,V)}get(t){return this.references.get(t)}dispose(){this.references.clear()}}class WA{constructor(){this.common=new vA,this.bubble=new vA}dispose(){this.common.dispose(),this.bubble.dispose()}}class ZA{constructor(){this.history=[]}parse(t){this.history=this.formatHistoryPayload(t.history_v2);const{list:V,weight:X}=this.calculateBigRoad(this.history,!0),{list:K,weight:k}=this.calculateBigEyeRoad(V),{list:$,weight:I}=this.calculateSmallRoad(V),{list:C,weight:n}=this.calculateCockroachRoad(V),q=this.mapHistoryToPattern(this.history);return{stats:t.stats,history:this.history,roads:{[A.RoadType.Big]:V,[A.RoadType.BigEye]:K,[A.RoadType.Small]:$,[A.RoadType.Cockroach]:C,probes:this.probes},weight:{[A.RoadType.Big]:X,[A.RoadType.BigEye]:k,[A.RoadType.Small]:I,[A.RoadType.Cockroach]:n},pattern:q}}formatHistoryPayload(t){return t.map((t=>({bankerPair:t.bankerPair||!1,bankerScore:t.bankerScore||0,natural:t.natural||!1,playerPair:t.playerPair||!1,playerScore:t.playerScore||0,winner:t.winner,multiplier:t.multiplier})))}calculateBigRoad(t,V=!1){const X=A.calculateRoadBaccarat(t,V);return A.orderRoadBaccarat(X)}calculateBigEyeRoad(t){const V=A.getDerivedRoadBaccarat(t,1);return A.orderRoadBaccarat(V)}calculateSmallRoad(t){const V=A.getDerivedRoadBaccarat(t,2);return A.orderRoadBaccarat(V)}calculateCockroachRoad(t){const V=A.getDerivedRoadBaccarat(t,3);return A.orderRoadBaccarat(V)}calculateProbeRoad(t){return{row:t.row||0,col:t.col||0,color:t.color}}calculateLocation(t){return t?this.calculateProbeRoad(t):void 0}calculateProbes(t){const V={winner:t,bankerPair:!1,playerPair:!1,natural:!1,bankerScore:0,playerScore:0},X=this.history.concat(V),K=this.calculateBigRoad(X).list,k=this.calculateBigEyeRoad(K).list,A=this.calculateSmallRoad(K).list,$=this.calculateCockroachRoad(K).list;return{big:this.calculateLocation(K[K.length-1]),bigEye:this.calculateLocation(k[k.length-1]),small:this.calculateLocation(A[A.length-1]),cockroach:this.calculateLocation($[$.length-1])}}mapHistoryToPattern(t){const V=[];return t.forEach((t=>{const X=t.winner;X!==A.WinnerTypeBaccarat.Player&&X!==A.WinnerTypeBaccarat.Banker||(0!==V.length&&V[V.length-1].key===X?V[V.length-1].val++:V.push({key:X,val:1}))})),V.map((t=>s[t.key]+t.val)).join("|")}get probes(){return{[A.WinnerTypeBaccarat.Player]:{...this.calculateProbes(A.WinnerTypeBaccarat.Player)},[A.WinnerTypeBaccarat.Banker]:{...this.calculateProbes(A.WinnerTypeBaccarat.Banker)}}}}class DA{constructor(t){this.props=t,this.beadRoadMode=R.I.Normal,this.zoomedRoad=void 0,this.roads={probes:{Banker:{},Player:{}},[A.RoadType.Big]:[],[A.RoadType.BigEye]:[],[A.RoadType.Small]:[],[A.RoadType.Cockroach]:[]},this.stats={gameCount:0,playerWins:0,bankerWins:0,ties:0,playerPairs:0,bankerPairs:0},this.history=[],this.weight={[A.RoadType.Big]:0,[A.RoadType.BigEye]:0,[A.RoadType.Small]:0,[A.RoadType.Cockroach]:0},this.decoder=new ZA,NX.Gn(this,{beadRoadMode:NX.sH,zoomedRoad:NX.sH,roads:NX.sH,stats:NX.sH,history:NX.sH,excludedBeadRoadModes:NX.EW,availableBeadRoadModes:NX.EW,setShoeData:NX.XI,updateShoeData:NX.XI,setZoomedRoad:NX.XI,setBeadRoadMode:NX.XI})}setShoeData(t){const{roads:V,stats:X,history:K,pattern:k,weight:A}=this.decoder.parse(t);this.roads=V,this.stats=X,this.history=K,this.pattern=k,this.weight=A}updateShoeData(t){this.roads=t.roads,this.stats=t.stats,this.history=t.history,this.pattern=t.pattern}setBeadRoadMode(t){this.beadRoadMode=t}get excludedBeadRoadModes(){const t=new Set,{excludingBeadRoadMode:V}=q.vL();return V?t.add(R.I.Chinese):t.add(R.I.Korean),this.props.root.settings.excludedBeadRoadModes.forEach((V=>{t.add(V)})),t}get availableBeadRoadModes(){return F.filter((t=>!this.excludedBeadRoadModes.has(t)))}getRoadItems(t){return this.roads[t]}resolveMultiplierTheme(t){return A.lightningTheme}setZoomedRoad(t){this.zoomedRoad=t}}var yA,EA,_A=X(843717),pA=X(764522);class LA{constructor(){this.playPlaceBetSound=()=>{this.fireSoundEvent(_A.Wo.PlaceChip)},this.playClickingFailSound=()=>{this.fireSoundEvent(_A.Wo.ClickingFail)},this.playClickButtonSound=()=>{this.fireSoundEvent(_A.Wo.ClickUIButton)},this.playChipStackSound=()=>{this.fireSoundEvent(_A.Wo.Chipstack)},this.playUndoSound=()=>{this.fireSoundEvent(_A.Wo.Undo)},this.playRepeatBetSound=()=>{this.fireSoundEvent(_A.Wo.RepeatDouble)}}fireSoundEvent(t,...V){pA.triggerEvent(t,...V)}}NX.jK({enforceActions:"always"});class OA{constructor(t){this.disposeBagCallbacks=[],this.isDebug=null!==Yk.w(window.location.href).getParam("debug"),this.disposeBag=new VA.C,this.ag=function(t){return new XA(t)}({ag:t.ag}),this.device=function(t){return new qA(t)}({root:this,DS:t.DS}),this.reference=new WA,this.layout=function(t){return new NA(t)}({root:this}),this.gamePhase=new HK,this.cards=new AA,this.shoe=function(t){return new DA(t)}({root:this}),this.gameResult=new cA,this.bets=new KA,this.prediction=new mA,this.log=function(t){return new Ck(t)}({root:this}),this.bubble=function(t){return new aK(t)}({root:this}),this.sounds=new LA,this.isDebug&&(window.__store=this)}dispose(){this.disposeBag.dispose()}initDisposables(t,V=!0){this.disposeBag.addDisposables([this.reference,...tA(this,V),...this.disposeBagCallbacks.map((t=>t()))])}}(function(t){t["DeckShuffleProcedure"]="GameAnimations.DeckShuffleProcedure",t["ShuffleCards"]="GameAnimations.ShuffleCards",t["CutCards"]="GameAnimations.CutCards",t["BurnCards"]="GameAnimations.BurnCards",t["CameraMovement"]="GameAnimations.CameraMovement",t["IntroTableHighlight"]="GameAnimations.IntroTableHighlight",t["Dealing"]="GameAnimations.Dealing",t["GoLive"]="GameAnimations.GoLive",t["DragAndDrop"]="GameAnimations.DragAndDrop"})(yA||(yA={}));class rA{constructor(){this.gameActiveAnimations=new Map([]),this.idleAnimationActive=!1,this.whiteList=[yA.DeckShuffleProcedure,yA.DragAndDrop],NX.Gn(this,{idleAnimationActive:NX.sH,gameActiveAnimations:NX.sH,setIdleAnimationActive:NX.XI.bound,setActiveAnimation:NX.XI.bound,isDeckShuffleProcedureActive:NX.EW,isShuffleCardsActive:NX.EW,isCutCardsActive:NX.EW,isBurnCardsActive:NX.EW,isCameraMovementActive:NX.EW,isIntroTableHighlightActive:NX.EW,isGoLiveActive:NX.EW,isAnyAnimationActive:NX.EW,isDealingActive:NX.EW,isDragAndDropActive:NX.EW,skipOnActiveAnimation:NX.EW})}setIdleAnimationActive(t){this.idleAnimationActive=t}setActiveAnimation(t,V){this.gameActiveAnimations.set(t,V)}get skipOnActiveAnimation(){return Boolean(Object.values(yA).find((t=>this.gameActiveAnimations.get(t)&&!this.whiteList.includes(t))))}get isDeckShuffleProcedureActive(){return Boolean(this.gameActiveAnimations.get(yA.DeckShuffleProcedure))}get isAnyAnimationActive(){return Boolean(Object.values(yA).find((t=>this.gameActiveAnimations.get(t))))}get isShuffleCardsActive(){return Boolean(this.gameActiveAnimations.get(yA.ShuffleCards))}get isCutCardsActive(){return Boolean(this.gameActiveAnimations.get(yA.CutCards))}get isBurnCardsActive(){return Boolean(this.gameActiveAnimations.get(yA.BurnCards))}get isCameraMovementActive(){return Boolean(this.gameActiveAnimations.get(yA.CameraMovement))}get isIntroTableHighlightActive(){return Boolean(this.gameActiveAnimations.get(yA.IntroTableHighlight))}get isDealingActive(){return Boolean(this.gameActiveAnimations.get(yA.Dealing))}get isGoLiveActive(){return Boolean(this.gameActiveAnimations.get(yA.GoLive))}get isDragAndDropActive(){return Boolean(this.gameActiveAnimations.get(yA.DragAndDrop))}}class zA{constructor(t){this.props=t,NX.Gn(this,{isLowBalance:NX.EW})}get isLowBalance(){const{betSpot:t,settings:V,ag:X,bets:K,betProcessor:k}=this.props.root,A=t.minBetSpotValues,$=Math.min(...V.chipAmounts),I=X.availableBalance,C=k.calculateTotalBetsAmount(K.bets);return Object.keys(A).length>0&&void 0!==I&&!C&&(this.isBalanceLowerMinBet||I<$)}get isBalanceLowerMinBet(){const{betSpot:t,ag:V}=this.props.root;return V.availableBalance<t.minBetSpotValue}}(function(t){t["ThreeSpots"]="ThreeSpots",t["ThreeSpotsNC"]="ThreeSpots_NC",t["FourSpots"]="FourSpots",t["FiveSpots"]="FiveSpots",t["FiveSpotsNC"]="FiveSpots_NC",t["SixSpots"]="SixSpots",t["SevenSpots"]="SevenSpots",t["EightSpots"]="EightSpots",t["NineSpots"]="NineSpots",t["NineSpotsNC"]="NineSpots_NC",t["TenSpots"]="TenSpots"})(EA||(EA={}));class wA{constructor(t){this.props=t,NX.Gn(this,{gridType:NX.EW})}get gridType(){return function(t,V){switch(t.length){case 3:return V?EA.ThreeSpotsNC:EA.ThreeSpots;case 4:return EA.FourSpots;case 5:return V?EA.FiveSpotsNC:EA.FiveSpots;case 6:return EA.SixSpots;case 9:return V?EA.NineSpotsNC:EA.NineSpots;case 8:return EA.EightSpots;case 10:return EA.TenSpots;default:return EA.ThreeSpots}}(this.props.root.betSpot.availableBetSpots,!1)}}class bA{constructor(t){this.props=t,this.initLastSelectedChipData=null,NX.Gn(this,{setInitLastSelectedChip:NX.XI.bound,initLastSelectedChipData:NX.sH,currentChip:NX.EW})}setInitLastSelectedChip(t){this.initLastSelectedChipData=t}get currentChip(){return this.props.root.ag.lastSelectedChip}}const aA=.5,uA=15;class jA{constructor(t){this.props=t,this.isSliderShown=!1,this.timeLeft=uA,this.position=aA,this.lastTimeLeft=uA,NX.Gn(this,{showSlider:NX.XI.bound,changeCutCardTimeout:NX.XI.bound,setCutCardsSliderPosition:NX.XI.bound,resumeSliderTimer:NX.XI.bound,resetCutCardsPosition:NX.XI.bound,stopSliderTimer:NX.XI.bound,isSliderShown:NX.sH,timeLeft:NX.sH,position:NX.sH})}moveCutCard(t){this.props.root.messageSender3d.to.moveCutCard({position:t})}cutCards(){this.props.root.log.cutPressed(),this.showSlider(!1),this.props.root.messageSender3d.to.cutCardsAtPosition({position:this.position})}showSlider(t){this.isSliderShown=t;const V=this.props.root.lobby.isVisible;t?V||this.startTimer():this.stopSliderTimer()}resetCutCardsPosition(){this.position=aA}changeCutCardTimeout(t){this.timeLeft=t}setCutCardsSliderPosition(t){this.position=t,this.startTimer()}stopSliderTimer(){this.timerId&&(clearInterval(this.timerId),this.timerId=void 0)}resumeSliderTimer(){const t=!!this.props.root.ag.values.onboardingCurrent;this.isSliderShown&&!t&&!this.props.root.lobby.isVisible&&this.startTimer()}startTimer(){this.changeCutCardTimeout(uA),this.timerId&&clearInterval(this.timerId);const t=Date.now();this.lastTimeLeft=uA,this.timerId=setInterval((()=>{const V=Date.now()-t,X=uA-Math.floor(V/1e3);X<=0?(this.stopSliderTimer(),this.changeCutCardTimeout(0),this.showSlider(!1),this.autoCut()):this.timeLeft<this.lastTimeLeft&&(this.lastTimeLeft=X,this.changeCutCardTimeout(X))}),100)}autoCut(){this.props.root.log.cutPressed(),this.props.root.messageSender3d.to.autoCut()}}var xA=X(864442);class eA{constructor(t){this.props=t,this.isDeal=!1,this.isDealHotKeyEnabled=!1,NX.Gn(this,{isDeal:NX.sH,isDealHotKeyEnabled:NX.sH,setDeal:NX.XI.bound,isDealAllowed:NX.EW,isButtonHidden:NX.EW,gameBetTags:NX.EW,tooltipTranslationKey:NX.EW})}get isDealAllowed(){const t=this.props.root.ag.balanceTotalBet>0,V=this.props.root.animation.isAnyAnimationActive,X=this.props.root.balance.isLowBalance;return t&&!V&&!X&&this.props.root.betProcessor.hasValidBets}get isButtonHidden(){return this.props.root.ag.values.chipstackHidden&&this.props.root.device.isPortrait}get gameBetTags(){return{...xA.y(),orientation:this.props.root.device.orientation,appVersion:this.props.root.settings.appVersion,viewType:"3D"}}get tooltipTranslationKey(){const t=this.props.root,V=t.betProcessor.isRepeatEnabled.enabled;return this.isDealAllowed||V?t.device.isDesktop?V?"tooltip.repeatLastBets":"tooltip.deal":void 0:"tooltip.placeBets"}setDeal(t){this.isDeal=t}setDealHotKeyEnabled(t){this.isDealHotKeyEnabled=t}}class YA{constructor(t){this.props=t,NX.Gn(this,{isAvailable:NX.EW,isButtonEnabled:NX.EW})}get isAvailable(){return this.props.root.gamePhase.isBetsOpen&&!this.props.root.animation.isDeckShuffleProcedureActive}get isButtonEnabled(){return!this.props.root.goLive.isGoingLive&&!this.props.root.animation.isDeckShuffleProcedureActive}}function HA(t){kt.ZQ()&&X.e(26203).then(X.bind(X,959426)).then((V=>V.createPanels(t)))}class hA{constructor(t){this.props=t,this.gameSetupReceived=!1,this.app3dLoaded=!1,this.gameStarted=!1,this.initialized=!1,NX.Gn(this,{setInitialized:NX.XI.bound,setGameSetupReceived:NX.XI.bound,setStartGame:NX.XI.bound,setApp3dLoaded:NX.XI.bound,gameSetupReceived:NX.sH,gameStarted:NX.sH,initialized:NX.sH,app3dLoaded:NX.sH,canStartGame:NX.EW}),this.props.root.ag.actions.app3d.loaded.then(NX.XI((()=>{this.setApp3dLoaded(!0),HA(this.props.root)})))}setGameSetupReceived(t){this.gameSetupReceived=t}setInitialized(t){this.initialized=t}setApp3dLoaded(t){this.app3dLoaded=t}get canStartGame(){return this.initialized&&this.app3dLoaded&&!this.gameStarted}setStartGame(t){this.gameStarted=t}}class TA{constructor(t){this.props=t,NX.Gn(this,{isAvailable:NX.EW,isGoingLive:NX.EW,goLiveUrl:NX.EW}),t.root.ag.actions.rngDynamicConfiguration.goLive.animation.setCallback((async()=>{await this.props.root.messageSender3d.to.flyToGoLive()}))}get isAvailable(){return!!this.goLiveUrl&&[iV.Qc.NewGame,iV.Qc.BetsOpen].includes(this.props.root.gamePhase.value)&&!this.props.root.animation.isAnyAnimationActive}get goLiveUrl(){return this.props.root.settings.goLiveUrl}get isGoingLive(){return this.props.root.ag.values.isGoingLive}}var PA=X(236042),QA=X(346653);class JA{get isScreenSaverActive(){return this.props.root.gamePhase.value===iV.Qc.BetsOpen&&!this.props.root.goLive.isGoingLive}get isIdleTimerActive(){return this.props.root.gamePhase.value===iV.Qc.NewGame||this.props.root.gamePhase.value===iV.Qc.BetsOpen}constructor(t){this.props=t,this.screenSaverRunning=!1,this.isInit=!0,this.onWake=PA.A((()=>this.resetTimer()),QA.S5),NX.Gn(this,{isScreenSaverActive:NX.EW,isIdleTimerActive:NX.EW})}start(){this.bindReactions()}dispose(){this.clearTimers(),this.removeWakeListeners(),this.stopRunningScreenSaver()}onStartScreenSaverTimer(){this.props.root.animation.setIdleAnimationActive(!0),this.props.root.messageSender3d.to.startIdleAnimation({cameraTarget:Xt.TableIdle})}onStopScreenSaverTimer(){this.props.root.messageSender3d.to.stopIdleAnimation(),this.props.root.animation.setIdleAnimationActive(!1)}bindReactions(){this.props.root.disposeBag.addDisposables([NX.mJ((()=>this.isScreenSaverActive),(t=>{this.props.root.ag.values.gamePaused||(t?this.startScreenSaverTimer():(this.clearScreenSaverTimer(),this.stopRunningScreenSaver()))})),NX.mJ((()=>this.isIdleTimerActive),(t=>{this.props.root.ag.values.gamePaused||(t?this.startIdleTimer():this.clearIdleTimer())})),NX.mJ((()=>this.props.root.ag.values.gamePaused),(t=>{t?(this.clearTimers(),this.removeWakeListeners(),this.stopRunningScreenSaver()):(this.isInit?this.isInit=!1:this.resumeGameIdle(),this.addWakeListeners(),this.startTimers())}),{fireImmediately:!0})])}addWakeListeners(){this.removeWakeListeners(),this.getWakeEvents().forEach((({target:t,eventType:V})=>{t.addEventListener(V,this.onWake)}))}removeWakeListeners(){this.getWakeEvents().forEach((({target:t,eventType:V})=>{t.removeEventListener(V,this.onWake)}))}getWakeEvents(){return[...this.props.root.device.isDesktop?QA.IG:QA.mN,{target:window,eventType:"resize"}]}startIdleTimer(){const t=this.props.root.settings.rawConfig.idleGameTimeout;void 0!==t&&t>0&&(this.clearIdleTimer(),this.inactivityTimerId=window.setTimeout((()=>{this.inactivityTimerId=void 0,this.setGameIdle()}),t))}clearIdleTimer(){this.inactivityTimerId&&(window.clearTimeout(this.inactivityTimerId),this.inactivityTimerId=void 0)}startScreenSaverTimer(){const t=this.props.root.settings.rawConfig.screenSaverTimeout;this.props.root.device.isDesktop&&void 0!==t&&t>0&&(this.clearScreenSaverTimer(),this.screenSaverTimerId=window.setTimeout((()=>{this.screenSaverRunning=!0,this.screenSaverTimerId=void 0,this.onStartScreenSaverTimer()}),t))}clearScreenSaverTimer(){window.clearTimeout(this.screenSaverTimerId),this.screenSaverTimerId=void 0}startTimers(){this.isScreenSaverActive&&this.startScreenSaverTimer(),this.isIdleTimerActive&&this.startIdleTimer()}clearTimers(){this.clearScreenSaverTimer(),this.clearIdleTimer()}stopRunningScreenSaver(){this.screenSaverRunning&&(this.screenSaverRunning=!1,this.onStopScreenSaverTimer())}resetTimer(){this.stopRunningScreenSaver(),this.clearTimers(),this.startTimers()}setGameIdle(){this.props.root.log.gamePaused(),this.props.root.messageSender.pauseTransport(),NX.h5((()=>{this.props.root.ag.actions.setGamePaused(!0)}))}resumeGameIdle(){this.props.root.messageSender.resumeTransport(),this.props.root.log.gameUnPaused(),NX.h5((()=>{this.props.root.ag.actions.setGamePaused(!1)}))}}class UA extends NA{constructor(t){super(t),this.props=t}get beadRoadDisplayMode(){const{isDesktop:t,isTablet:V,isPortrait:X}=this.props.root.device;return t?FA.ExtraLargeLandscape:V?FA.LargeLandscape:X?FA.PhonePortrait:FA.SmallLandscape}}class lA{constructor(){this.isVisible=!1,NX.Gn(this,{isVisible:NX.sH,setIsVisible:NX.XI.bound})}setIsVisible(t){this.isVisible=t}}class iA{constructor(t){this.props=t,this._ignoredField=null,this.isLoaded=!1,this.preferences={},NX.Gn(this,{isLoaded:NX.sH,preferences:NX.sH,setPreferences:NX.XI,scorecardTheme:NX.EW,isWhiteScorecardTheme:NX.EW,isAllSideBetsEnabled:NX.EW,showOnboardingGameHints:NX.EW,welcomeBubbleShownTimes:NX.EW,bettingGridBubbleShownTimes:NX.EW,volumeMusic:NX.EW}),this.props.root.disposeBag.addDisposable(this.props.root.ag.actions.preferences.values.subscribe(NX.XI((t=>{t.preferencesAreLoaded&&!this.isLoaded&&(this.isLoaded=t.preferencesAreLoaded),this.setPreferences(t)}))))}getValue(t){return this.preferences[t]}updatePreferenceValue(t,V){this.props.root.ag.actions.preferences.setPreferences({key:t,value:V})}setPreferences(t){this.preferences=t}get scorecardTheme(){return this.preferences.background||this.props.root.settings.scorecardTheme}get isWhiteScorecardTheme(){return this.scorecardTheme===A.ScorecardThemeNames.WhiteSolid}get isAllSideBetsEnabled(){return this.preferences.allSideBets}get showOnboardingGameHints(){return this.preferences[vK.bR]}get welcomeBubbleShownTimes(){return this.preferences.welcomeBubbleShownTimes}get bettingGridBubbleShownTimes(){return this.preferences.bettingGridBubbleShownTimes}get volumeMusic(){return this.preferences.volumeMusic}}class GA extends iA{constructor(t){super(t),this.props=t}get isAllSideBetsEnabled(){return!1}get multiplierBubbleShownTimes(){return this.preferences.multiplierBubbleShownTimes}get lastSelectedChip(){return this.preferences.lastSelectedChips[bk.Z.RNGBaccarat]}}function dA(t){return NX.mJ((()=>t.balance.isLowBalance),(V=>{const X=t.ag.actions.balance;return V?X.setLow():X.setEnough()}),{fireImmediately:!0})}function MA(t){return NX.mJ((()=>t.ag.availableBalance),(V=>{t.messageSender3d.to.balanceUpdate({balance:V})}),{fireImmediately:!0})}const BA=t=>[MA(t),dA(t)];function oA(t){return NX.mJ((()=>t.gamePhase.isBetsOpen),(V=>{V?t.ag.actions.chipstack.show():t.ag.actions.chipstack.hide()}),{fireImmediately:!0})}function fA(t){return NX.mJ((()=>t.betProcessor.isUndoEnabled),(V=>{V.enabled?t.ag.actions.betting.undo.enable():t.ag.actions.betting.undo.disable()}),{fireImmediately:!0})}function gA(t){return NX.mJ((()=>t.betProcessor.isDoubleEnabled),(V=>{V.enabled?t.ag.actions.betting.double.enable():t.ag.actions.betting.double.disable(V.reason)}),{fireImmediately:!0})}const t$=t=>[t.ag.actions.betting.undo.subscribe(t.betProcessor.undo),t.ag.actions.betting.undoAll.subscribe(t.betProcessor.undoAll),t.ag.actions.betting.repeat.subscribe(t.betProcessor.repeat),t.ag.actions.betting.double.subscribe(t.betProcessor.double),oA(t),fA(t),gA(t)];function V$(t){return NX.mJ((()=>t.bettingGrid.gridType),(V=>{t.messageSender3d.to.changeBettingGridType({gridType:V})}),{fireImmediately:!0})}const X$=t=>[V$(t)];function K$(t){return NX.mJ((()=>t.chips.initLastSelectedChipData),(V=>{if(V){const X=Math.max(V.chip,V.minLimit);if(t.ag.values.betAmounts.find((({value:t,enabled:V})=>V&&t===X)))return void t.ag.actions.betAmounts.selectBetAmount(X);const K=t.ag.values.betAmounts.map((t=>t.value));let k=-1,A=1e9;for(const t of K)t>k&&t<=X?k=t:t<A&&t>X&&(A=t);if(k>0)return void t.ag.actions.betAmounts.selectBetAmount(X);A<1e9&&t.ag.actions.betAmounts.selectBetAmount(X)}}))}const k$=t=>[K$(t)];function A$(t){return NX.mJ((()=>t.device.orientation),(V=>{t.messageSender3d.to.changeOrientation(V)}),{fireImmediately:!0})}const $$=t=>[A$(t)];function I$(t){return NX.mJ((()=>t.gamePhase.value),(V=>{t.messageSender3d.to.setBettingOpen({isBettingOpen:V===iV.Qc.BetsOpen}),t.messageSender3d.to.changeCursors({spots:t.betSpot.cursorsBetSpots})}))}const C$=t=>[I$(t)];function n$(t){return NX.mJ((()=>t.gameResult.winningBetSpots),(V=>{V.length>0&&(t.messageSender3d.to.pulseWinning({winningBetSpots:V}),t.ag.actions.balance.resumeBalanceUpdate(),t.ag.actions.balance.setTotalBet(0),t.ag.actions.balance.reserveBet(0))}))}const q$=t=>[n$(t)];function R$(t){return NX.mJ((()=>t.lobby.isVisible),(V=>{V?t.cutCardsSlider.stopSliderTimer():t.cutCardsSlider.resumeSliderTimer()}))}const F$=t=>[R$(t)];function s$(t){return NX.mJ((()=>t.ag.values.gameRoundId),(V=>{t.log.updateGameIdGameAction(V)}),{fireImmediately:!0})}const S$=t=>[s$(t),t.ag.actions.network.status.subscribe(t.resume.setNetworkStatus.bind(t.resume)),t.ag.actions.network.latency.subscribe(t.resume.handleLatency.bind(t.resume)),t.ag.actions.isPageVisible.subscribe(t.resume.handleIsPageVisible.bind(t.resume))];function c$(t){return NX.mJ((()=>({gamePhase:t.gamePhase.value,app3dLoaded:t.gameInfo.app3dLoaded,isGoingLive:t.goLive.isGoingLive})),((V,X)=>function(t,V,X){const K=fk(t,V.gamePhase,X.gamePhase);if(!K){if(V.app3dLoaded&&V.app3dLoaded!==X.app3dLoaded)return t.ag.actions.lifecycle.openInteraction(),!K;if(V.gamePhase===iV.Qc.NewGame&&V.gamePhase!==X.gamePhase||V.isGoingLive&&V.isGoingLive!==X.isGoingLive)return t.ag.actions.lifecycle.closeInteraction(),!K}return K}(t,V,X)))}var N$=X(926610);class m${constructor(t){this.props=t,this.isPageVisible=!0,this.networkStatus=N$.XW.Connected,NX.Gn(this,{setNetworkStatus:NX.XI.bound,isPageVisible:NX.sH,handleIsPageVisible:NX.sH,networkStatus:NX.sH})}setNetworkStatus(t){this.networkStatus=t}handleIsPageVisible(t){!this.isPageVisible&&t&&(this.props.root.log.setGameVisibilityGameAction(this.props.root.ag.values.gameRoundId),this.getGame()),this.isPageVisible=t}handleLatency(){this.networkStatus===N$.XW.Reconnecting&&(this.props.root.log.reconnectingGameAction(this.props.root.ag.values.gameRoundId),this.getGame()),this.setNetworkStatus(N$.XW.Connected)}getGame(){this.props.root.messageSender.getGame(this.props.root.ag.values.gameRoundId)}}var v$,W$,Z$,D$,y$=X(629474);class E$ extends DA{constructor(t){super(t),this.props=t,this.state=y$.y.Shuffled,this.cardsLeft=0,NX.Gn(this,{state:NX.sH,cardsLeft:NX.sH,setShoeState:NX.XI,setShoeCardCount:NX.XI,resetShoeData:NX.XI});const V=this.props.root.settings.defaultBeadRoadMode;if(V&&this.availableBeadRoadModes.includes(V))this.setBeadRoadMode(V);else{const{defaultBeadRoadMode:t}=q.vL();this.setBeadRoadMode(t)}}setShoeState(t){this.state=t}setShoeCardCount(t){this.cardsLeft=t}resetShoeData(){this.setShoeData(KV.KM)}}(function(t){t["CardFlip"]="cardFlip",t["SlideCardFromShoe"]="slideCardFromShoe",t["DeckDropOnCloth"]="deckDropOnCloth",t["DeckDropOnDeck"]="deckDropOnDeck",t["Riffle"]="riffle",t["CutCardOutOfDeck"]="cutCardOutOfDeck",t["CutCardInDeck"]="cutCardInDeck",t["ShoeSlider"]="shoeSlider",t["DeckOutOfShow"]="deckOutOfShoe",t["DeckInShoe"]="deckInShoe",t["MoveDeck"]="moveDeck",t["MoveDeckShort"]="moveDeckShort",t["GameResult"]="gameResult",t["BetsOpen"]="betsOpen",t["CardsInHolder"]="cardsInHolder",t["DealNow"]="dealNow",t["ChangeVoiceLanguage"]="language_"})(v$||(v$={})),function(t){t[t["SliderOut"]=0]="SliderOut",t[t["SliderInEmptyShoe"]=1]="SliderInEmptyShoe",t[t["SliderInDeck"]=2]="SliderInDeck"}(W$||(W$={}));class _$ extends LA{constructor(){super(),this.hasIntroSoundPlayed=!1,this.winnerToWinEventArgMap={[iV.K8.Player]:0,[iV.K8.Banker]:1,[iV.K8.Tie]:2},this.playCardFlipSound=this.playCardFlipSound.bind(this),this.playSlideCardFromShoeSound=this.playSlideCardFromShoeSound.bind(this),this.playDeckDropOnClothSound=this.playDeckDropOnClothSound.bind(this),this.playDeckDropOnDeckSound=this.playDeckDropOnDeckSound.bind(this),this.playRiffleSound=this.playRiffleSound.bind(this),this.playCutCardOutOfDeckSound=this.playCutCardOutOfDeckSound.bind(this),this.playCutCardInDeckSound=this.playCutCardInDeckSound.bind(this),this.playShoeSliderSound=this.playShoeSliderSound.bind(this),this.playDeckOutOfShoeSound=this.playDeckOutOfShoeSound.bind(this),this.playDeckInShoeSound=this.playDeckInShoeSound.bind(this),this.playMoveDeckSound=this.playMoveDeckSound.bind(this),this.playMoveDeckShortSound=this.playMoveDeckShortSound.bind(this),this.playBetsOpenSound=this.playBetsOpenSound.bind(this),this.playCardsInHolderSound=this.playCardsInHolderSound.bind(this),this.playIntroSound=this.playIntroSound.bind(this),this.playGameResultSound=this.playGameResultSound.bind(this),this.playDealNowSound=this.playDealNowSound.bind(this)}playCardFlipSound(){this.fireSoundEvent(v$.CardFlip)}playSlideCardFromShoeSound(){this.fireSoundEvent(v$.SlideCardFromShoe)}playDeckDropOnClothSound(){this.fireSoundEvent(v$.DeckDropOnCloth)}playDeckDropOnDeckSound(){this.fireSoundEvent(v$.DeckDropOnDeck)}playRiffleSound(){this.fireSoundEvent(v$.Riffle)}playCutCardOutOfDeckSound(){this.fireSoundEvent(v$.CutCardOutOfDeck)}playCutCardInDeckSound(){this.fireSoundEvent(v$.CutCardInDeck)}playShoeSliderSound(t){this.fireSoundEvent(v$.ShoeSlider,t)}playDeckOutOfShoeSound(){this.fireSoundEvent(v$.DeckOutOfShow)}playDeckInShoeSound(){this.fireSoundEvent(v$.DeckInShoe)}playMoveDeckSound(){this.fireSoundEvent(v$.MoveDeckShort)}playMoveDeckShortSound(){this.fireSoundEvent(v$.MoveDeckShort)}playBetsOpenSound(){this.fireSoundEvent(v$.BetsOpen)}playDealNowSound(){this.fireSoundEvent(v$.DealNow)}playGameResultSound(t){this.fireSoundEvent(v$.GameResult,this.winnerToWinEventArgMap[t])}setVoiceLanguage(t){this.fireSoundEvent(`${v$.ChangeVoiceLanguage}${t}`)}playCardsInHolderSound(){this.fireSoundEvent(v$.CardsInHolder)}playIntroSound(t){this.hasIntroSoundPlayed||(t(),this.hasIntroSoundPlayed=!0)}}(function(t){t["Show"]="Show",t["Hide"]="Hide",t["Empty"]="Empty"})(Z$||(Z$={}));class p${constructor(t){this.props=t,this.cardsState=Z$.Empty,this.table={shoeId:"",nextGameId:""},this.tableSelectionDone=!1,NX.Gn(this,{setCardsState:NX.XI.bound,cardsState:NX.sH,cardsNotEmpty:NX.EW,table:NX.sH,tableSelectionDone:NX.sH,setNextGameId:NX.XI.bound,setTableSelectionDone:NX.XI.bound})}setCardsState(t){this.cardsState=t}get cardsNotEmpty(){return this.cardsState!==Z$.Empty}setTable(t){this.table=t}setNextGameId(t){this.table.nextGameId=t}setTableSelectionDone(t){this.tableSelectionDone=t}}(function(t){t["RoadGrid"]="RoadGrid",t["BeadRoadGrid"]="BeadRoadGrid"})(D$||(D$={}));class L${constructor(t){this.props=t}add3dSpotTooltip(t){this.props.root.messageSender3d.to.addTooltip({type:t.betSpot,label:t.text})}showRoadGridTooltip(t,V){this.showTooltip(t,V,D$.RoadGrid)}hideRoadGridTooltip(){this.props.root.ag.actions.tooltips.hideByType(D$.RoadGrid)}showBeadRoadTooltip(t,V){this.showTooltip(t,V,D$.BeadRoadGrid)}hideBeadRoadTooltip(){this.props.root.ag.actions.tooltips.hideByType(D$.BeadRoadGrid)}showTooltip(t,V,X){const{gameDimensions:K}=this.props.root.ag.values,k=K.reverseScale||1;this.props.root.ag.actions.tooltips.hideAll(),this.props.root.ag.actions.tooltips.add({labelTranslationId:t,type:X,left:Math.round(V.left+V.width/2-K.left),top:Math.round(V.top+6*k-K.top),hasAnchor:!0,dataType:X})}}class O$ extends OA{constructor(t){super(t),this.props=t,this.settings=function(t){return new Tk(t)}({settings:t.settings}),this.gameInfo=function(t){return new hA(t)}({root:this}),this.betSpot=function(t){return new NK(t)}({root:this}),this.layout=function(t){return new UA(t)}({root:this}),this.shoe=function(t){return new E$(t)}({root:this}),this.limits=function(t){return new JK(t)}({root:this}),this.lobby=new lA,this.freeGame=function(t){return new YA(t)}({root:this}),this.idleTimer=function(t){return new JA(t)}({root:this}),this.log=function(t){return new Nk(t)}({root:this}),this.resume=function(t){return new m$(t)}({root:this}),this.goLive=function(t){return new TA(t)}({root:this}),this.bettingGrid=function(t){return new wA(t)}({root:this}),this.deal=function(t){return new eA(t)}({root:this}),this.balance=function(t){return new zA(t)}({root:this}),this.chips=function(t){return new bA(t)}({root:this}),this.tooltip=function(t){return new L$(t)}({root:this}),this.table=function(t){return new p$(t)}({root:this}),this.cutCardsSlider=function(t){return new jA(t)}({root:this}),this.betProcessor=function(t){return new VK(t)}({root:this}),this.preferences=function(t){return new GA(t)}({root:this}),this.animation=new rA,this.sounds=new _$,this.sounds.setVoiceLanguage(this.settings.voiceLanguage)}dispose(){super.dispose(),this.idleTimer.dispose()}initDisposables(t,V=!0){super.initDisposables(t,!1),this.disposeBag.addDisposables(((t,V)=>[...q$(t),...t$(t),...k$(t),...C$(t),...S$(t),...$$(t),...BA(t),...X$(t),...F$(t),...V?[c$(t)]:[]])(this,V))}initGame(){const{settings:t}=this.props;this.props.transport.onConnected((()=>this.messageSender.getGameState({tableId:t.getTableId(),virtualTableId:t.getVirtualTableId()||null}))),this.initTimeoutId||(this.initTimeoutId=setTimeout((()=>{clearTimeout(this.initTimeoutId),this.initTimeoutId=void 0,this.gameInfo.gameSetupReceived||this.initGame()}),5e3))}}var r$=X(138059);const z$={[TK.Player]:{labelTranslationId:"limitPlate.player_uppercase",betSpot:iV.K8.Player,payoutTranslationId:`lightning.limitPlate.${TK.Player}.payout`},[TK.Banker]:{labelTranslationId:"limitPlate.banker_uppercase",betSpot:iV.K8.Banker,payoutTranslationId:`lightning.limitPlate.${TK.Banker}.payout`},[TK.Tie]:{betSpot:iV.K8.Tie,labelTranslationId:"limitPlate.tie_uppercase"},[TK.PlayerPair]:{labelTranslationId:"limitPlate.playerPair_uppercase",payoutTranslationId:`lightning.limitPlate.${TK.PlayerPair}.payout`,betSpot:iV.K8.PlayerPair,requiredBetSpots:[iV.K8.PlayerPair]},[TK.BankerPair]:{betSpot:iV.K8.BankerPair,labelTranslationId:"limitPlate.bankerPair_uppercase",payoutTranslationId:`lightning.limitPlate.${TK.BankerPair}.payout`,requiredBetSpots:[iV.K8.BankerPair]}};var w$,b$=X(167005),a$=X(947548);(function(t){t["GameSetup"]="GameSetup",t["ShoeShuffled"]="ShoeShuffled",t["CardBurnDone"]="CardsBurned",t["GameResult"]="GameResult",t["ShoeCut"]="ShoeCut",t["ShoeShuffledMulti"]="ShoeShuffledMulti",t["FreeGameResult"]="FreeGameResult",t["Error"]="Error"})(w$||(w$={}));const u$={[ek.F.SuperSix]:iV.K8.SuperSix,[ek.F.EitherPair]:iV.K8.EitherPair,[ek.F.PerfectPair]:iV.K8.PerfectPair,[ek.F.BankerBonus]:iV.K8.BankerBonus,[ek.F.BankerPair]:iV.K8.BankerPair,[ek.F.PlayerBonus]:iV.K8.PlayerBonus,[ek.F.PlayerPair]:iV.K8.PlayerPair};function j$(t,V){const X=t.settings.coefficientReductionLimitMap,K=Object.keys(X);return K.length?function(t,V,X,K){return V.reduce(((V,k)=>{const A=t[k];if(!A)return V;const $=Object.keys(A).map((t=>parseInt(t,10))).sort(((t,V)=>V-t)),I=$.findIndex((t=>K>=t));if(-1!==I){const t=X[k],K=$[I];V[t]=A[K]}return V}),{})}(X,K,u$,KV.pP-V):function(t,V){const X=xX.J0.divide(t,100),K=xX.J0.divide(V,100);return{[iV.K8.SuperSix]:X,[iV.K8.PerfectPair]:K,[iV.K8.PlayerBonus]:K,[iV.K8.BankerBonus]:K}}(t.settings.superSixMainBetsPercentage,t.settings.bonusToMainBetsPercentage)}var x$=X(757712),e$=X(991922);function Y$(t){t.ag.balanceTotalBet>0&&t.betProcessor.undoAll(),t.gamePhase.setPhase(iV.Qc.BetsClosed),t.messageSender.shuffleShoe({tableId:t.settings.tableId,virtualTableId:t.settings.virtualTableId,shoeName:t.table.table.shoeId})}function H$(t){t.log.betsOpenGameAction(),t.gamePhase.setPhase(iV.Qc.BetsOpen),t.bets.setStatus(iV.uB.Betting);const V=t.lastBets.bets;!t.bets.repeat&&V&&t.bets.setRepeat(V),t.sounds.playIntroSound(t.sounds.playBetsOpenSound)}function h$(t){const V=t.shoe.state,X=t.shoe.cardsLeft,K=V===y$.y.Shuffled?0:KV.pP-X;return{cardsInShoe:V===y$.y.Shuffled?0:X,cardsInCardHolder:K}}async function T$(t,V){const{table:X,settings:K,device:k}=t,{isAnimated:A}=V,$={shoeName:X.table.shoeId,tableId:K.tableId,virtualTableId:K.virtualTableId||null},I=h$(t);if(A?await t.messageSender3d.to.flyToTable({instant:!1}):k.isDesktop||(I&&t.messageSender3d.to.updateTableState(I),t.messageSender3d.to.showLightsOnTable({instant:!0})),function(t){t.ag.actions.tableLimits.setMax(t.tableConfig.tableConfigMaxLimit),t.ag.actions.tableLimits.setMin(t.tableConfig.tableConfigMinLimit),t.ag.actions.tableLimits.ui.panel.show();const V=t.tableConfig.config;if(!V)return;const{nextGameId:X=""}=t.table.table;t.ag.actions.setTableName(V.tableName),t.ag.actions.setGameRoundId(X)}(t),t.table.setTableSelectionDone(!0),t.shoe.state===y$.y.Finished)k.isDesktop||t.gamePhase.setPhase(iV.Qc.NewGame),t.messageSender.shuffleShoe($);else if(t.shoe.state===y$.y.Shuffled){let V;const X=x$.Ti();await e$.U(X,t.messageSender3d).addStep((async()=>{V=await t.messageSender3d.to.cutCards({token:X})})).addStep((()=>{void 0!==V&&t.messageSender.cutShoe($,Math.floor(KV.pP*V))})).onCancel((()=>{void 0!==V&&t.messageSender.cutShoe($,Math.floor(KV.pP*V))})).execute()}else t.shoe.state===y$.y.Cut?t.messageSender.burnCards($):A?H$(t):(t.gamePhase.setPhase(iV.Qc.BetsOpen),t.sounds.playIntroSound(t.sounds.playBetsOpenSound))}function P$(t,V){const X=V.shoe.cardsLeft,K=t.payload.results.map((t=>t.shoeName));V.log.shuffleStartedMultiGameAction(K);for(const X of t.payload.results){const{nextBetLimits:t}=X;V.shoe.resetShoeData(),t&&V.tableConfig.setTableLimits(t),X.nextCoefficientReductions?V.tableConfig.setCoefficientReductions(X.nextCoefficientReductions):V.tableConfig.setCoefficientReductions(j$(V,KV.pP)),V.shoe.setShoeState(y$.y.Finished),V.shoe.setShoeCardCount(KV.Ay)}const k=function(t){return h$(t)||void 0}(V);k&&V.messageSender3d.to.updateTableState(k),async function(t,V,X=!1){const K=t.shoe.state,k={shoeName:V,tableId:t.settings.tableId,virtualTableId:t.settings.virtualTableId||null};if(K===y$.y.Finished)await async function(t,V,X=!1){const K={shoeName:V,tableId:t.settings.tableId,virtualTableId:t.settings.virtualTableId||null};t.messageSender3d.to.sendShuffleStarted(!0);const k=x$.Gr();await e$.U(k,t.messageSender3d).addStep((async()=>{await t.messageSender3d.to.shuffleCards({shortShuffle:X,token:k})})).addStep((async()=>{t.shoe.setShoeState(y$.y.Shuffled)})).onCancel((()=>{t.shoe.setShoeState(y$.y.Shuffled)})).execute();const A=x$.Ti();let $;await e$.U(A,t.messageSender3d).addStep((async()=>{$=await t.messageSender3d.to.cutCards({token:A})})).addStep((()=>{void 0!==$&&t.messageSender.cutShoe(K,Math.floor(KV.pP*$))})).onCancel((()=>{void 0!==$&&t.messageSender.cutShoe(K,Math.floor(KV.pP*$))})).execute(),t.messageSender3d.to.sendShuffleStarted(!1)}(t,V,X);else if(K===y$.y.Shuffled){let V;const X=x$.Ti();await e$.U(X,t.messageSender3d).addStep((async()=>{V=await t.messageSender3d.to.cutCards({token:X})})).addStep((()=>{void 0!==V&&t.messageSender.cutShoe(k,Math.floor(KV.pP*V))})).onCancel((()=>{void 0!==V&&t.messageSender.cutShoe(k,Math.floor(KV.pP*V))})).execute()}else K===y$.y.Cut&&t.messageSender.burnCards(k)}(V,V.table.table.shoeId,X>=KV.Qo)}function Q$(t){t.gameResult.reset(),t.betProcessor.reset(),t.cards.resetHands(),t.gamePhase.setPhase(iV.Qc.NewGame)}var J$=X(885537);function U$(t){return Object.keys(t).reduce(((V,X)=>{const K=t[X];return void 0===K||(V[X]={amount:K,error:""}),V}),{})}function l$(t,V){switch(t.type){case w$.GameSetup:(function(t,V){if(V.animation.isDeckShuffleProcedureActive)return;V.gameInfo.setStartGame(!1),V.gameInfo.setGameSetupReceived(!0),function(t,V){uX.A(V.payload.commissionSetup.shoes["A"].coefficientReductions)&&(V.payload.commissionSetup.shoes["A"].coefficientReductions=j$(t,V.payload.commissionSetup.shoes["A"].shoe.cardsLeft))}(V,t),V.table.setTable({nextGameId:t.payload.commissionSetup.shoes["A"].nextGameId,shoeId:"A"});const X=function(t){const V=t.commissionSetup.shoes["A"].shoe;return{state:V.state,cardsLeft:V.cardsLeft,data:V.data}}(t.payload);V.shoe.setShoeData(X.data),V.shoe.setShoeState(X.state),V.shoe.setShoeCardCount(X.cardsLeft),V.tableConfig.setConfig(function(t,V){const X=t.commissionSetup.shoes["A"];return{limits:X.betLimits,coefficientReductions:X.coefficientReductions,goLiveUrl:t.commissionSetup.goLiveURL,tableName:V}}(t.payload,V.settings.tableName)),V.gameInfo.setInitialized(!0);const K=V.preferences.lastSelectedChip;K!==V.ag.lastSelectedChip&&V.chips.setInitLastSelectedChip({chip:null!=K?K:V.ag.lastSelectedChip,minLimit:V.tableConfig.tableLimitsSettings.min})})(t,V);break;case w$.ShoeShuffledMulti:P$(t,V);break;case w$.ShoeCut:(function(t,V){V.shoe.setShoeState(y$.y.Cut),V.messageSender.burnCards({tableId:V.settings.tableId,virtualTableId:V.settings.virtualTableId,shoeName:V.table.table.shoeId})})(0,V);break;case w$.CardBurnDone:(async function(t,V){V.shoe.setShoeState(y$.y.Burned),V.shoe.setShoeCardCount(KV.pP-t.payload.burned),await V.messageSender3d.to.burnCards({burned:t.payload.burned,first:t.payload.first}),V.messageSender3d.to.sendBurnDone(),H$(V)})(t,V);break;case w$.Error:(function(t,V){V.gamePhase.setPhase(iV.Qc.BetsClosed),function(t){const V=t.bets.bets,X=t.ag.availableBalance,K=t.ag.values.balanceTotalBet,k=t.bets.history,A=($=V,Object.values($).reduce(((t,V)=>t+(void 0!==V?V:0)),0));var $;void 0!==X&&(t.ag.actions.balance.reserveBet(0),t.ag.actions.balance.setServerBalance(X+A));const I=K-A;t.ag.actions.balance.setTotalBet(I),t.bets.updateBetsState({bets:{},rejectedBets:U$(V),history:k?[{},...k]:[],status:iV.uB.Rejected})}(V),V.ag.actions.balance.resumeBalanceUpdate(),V.messageSender3d.to.update3dBets(wX(V)),Q$(V),H$(V),J$.O4[t.payload.errorCode]&&V.ag.actions.handleError({errorId:`error_${t.payload.errorCode}`})})(t,V);break;default:(function(t,V){if(!V.animation.skipOnActiveAnimation)switch(t.type){case b$.s.PlainError:case b$.s.UnknownError:V.ag.actions.popups.open(a$.Mc({callback:()=>{window.location.reload()}}))}})(t,V)}}var i$=X(266600),G$=X(787134),d$=X(663025);var M$,B$=X(73816),o$=X(294851);function f$(t={}){return Object.values(t).reduce(((t,V)=>t+((null==V?void 0:V.amount)||0)),0)}function g$(t){return t?Object.keys(t).reduce(((V,X)=>(function(t){return t in iV.K8}(X)&&(V[X]=t[X]),V)),{}):{}}function tI(t,V){(function(t,V){const{status:X,rejectedBets:K,history:k,bets:A,repeat:$,log:I}=V,C=X===iV.uB.Cancelled;X===iV.uB.BetsRejected&&K&&function(t,V){for(const X of Object.keys(V)){const K=V[X];if(K){const V=+K.error;J$.O4[V]&&t.ag.actions.handleError({errorId:`error_${V}`});break}}}(t,K),t.log.clientBetAcceptedRejected({...V,...I}),t.betProcessor.updateBetsState({history:k,bets:C?{}:A,status:X,rejectedBets:K,repeat:$})})(t,function(t){const V=t.canRepeat.AllBets&&Object.keys(t.originalBets).length;return{history:t.chipHistory?t.chipHistory.map(g$).reverse():[],balance:B$.l2(t),balances:t.balances,originalBets:t.originalBets,acceptedBets:Object.keys(t.acceptedBets).length?t.acceptedBets:void 0,rejectedBets:Object.keys(t.rejectedBets).length?t.rejectedBets:void 0,totalAmount:t.totalAmount,bets:g$(t.currentChips),status:t.status||iV.uB.Idle,repeat:V?g$(t.originalBets):void 0,log:{repeat:V?t.originalBets:void 0}}}(V))}(function(t){t["Standard"]="DealType.Standard",t["Free"]="DealType.Free",t["FreeHidden"]="DealType.FreeHidden"})(M$||(M$={}));const VI=1;function XI(t,V){return t?2:(null==V?void 0:V[0])?V[0]:1}const KI=[{start:u.SceneRerenderStart,stop:a.SceneRerenderEnd},{start:u.UpdateTableState,stop:a.UpdateTableStateDone},{start:u.ShowTooltip,stop:a.HideTooltip},{start:u.FlyToTable,stop:a.CameraFlewToTable},{start:u.CutCards,stop:a.CutCardsDone},{start:u.FlyingChipAnimationStart,stop:a.FlyingChipAnimationDone},{start:u.ChangeBettingGridType,stop:a.ChangeBettingGridTypeDone},{start:u.BreakDownChipAnimationStart,stop:a.BreakDownChipAnimationEnd},{start:u.SelectChipAnimationStart,stop:a.SelectChipAnimationEnd},{start:u.BalanceUpdate,stop:a.BalanceUpdateDone},{start:u.HoverSpotStart,stop:a.HoverSpotDone},{start:u.HighlightSpotStart,stop:a.HighlightSpotDone},{start:u.PlaceBet,stop:a.PlaceBetDone},{start:u.UpdateBets,stop:a.UpdateBetsDone},{start:u.MoveBetStart,stop:a.MoveBetDone},{start:u.GoLive,stop:a.GoLiveReady},{start:u.StartIdleAnimation,stop:a.IdleAnimationStopped},{start:u.BurnCards,stop:a.BurnCardsDone},{start:u.ShuffleCards,stop:a.ShuffleCardsDone},{start:u.PlaceChipsOnTable,stop:a.PlaceChipsOnTableDone},{forceOn:a.SelectChip}];var kI,AI;function $I(t,V){let X;return X="number"==typeof V?V:V.getValue(),X<=0?0:t/X}(function(t){t["Deal"]="RenderTask.Deal",t["InfiniteLettersAnimation"]="RenderTask.InfiniteLettersAnimation"})(kI||(kI={})),function(t){t["Deal"]="CommonSpeedRatios.Deal"}(AI||(AI={}));class II{constructor(t){this.props=t,this.isCutCardDealt=!1,this.cardsHands=Object.keys(this.props.cards).reduce(((t,V)=>(t[V]={cards:[],score:0},t)),{}),this.cardCount=this.props.cardCount}async dealCard(t,V){this.cardCount===KV.Qo&&(this.isCutCardDealt=!0,await this.dealCutCard()),this.cardCount--,await this.sendDealCard(t,V),this.cardsHands[t].cards=this.cardsHands[t].cards.concat(iV.Zp.UnknownCard),this.updateCardHands()}async openCard(t,V){await this.sendOpenCard(t,V);const X=this.props.cards[t][V];this.cardsHands[t].cards=this.cardsHands[t].cards.slice(0),this.cardsHands[t].cards[V]=X.card,this.cardsHands[t].score=e.roundTo((this.cardsHands[t].score+X.score)%10,0),this.updateCardHands()}async dealOpenCard(t,V){this.cardCount===KV.Qo&&(this.isCutCardDealt=!0,await this.dealCutCard()),this.cardCount--,await this.sendDealOpenCard(t,V),this.cardsHands[t].cards=this.cardsHands[t].cards.concat(iV.Zp.UnknownCard),this.updateCardHands()}async dealCutCard(){await this.props.store.messageSender3d.to.dealCutCard()}updateCardHands(){this.props.store.cards.setHands(this.cardsHands)}async sendDealCard(t,V){await this.props.store.messageSender3d.to.dealCard({card:this.props.cards[t][V].card,placeHolder:t,cardsInShoe:this.cardCount})}async sendOpenCard(t,V){await this.props.store.messageSender3d.to.openCard({cardPlace:V,placeHolder:t})}async sendDealOpenCard(t,V){await this.props.store.messageSender3d.to.dealOpenCard({card:this.props.cards[t][V].card,placeHolder:t,cardsInShoe:this.cardCount,cardPlace:V})}}async function CI(){window.__storyGameAPI__.renderer.willRender&&await new Promise((t=>{let V;e.waitRenderFrames(window.__storyGameAPI__.babylonScene,(()=>{t(),clearTimeout(V)}),2),V=setTimeout((()=>{window.__storyGameAPI__.renderer.willRender||(t(),clearTimeout(V))}),500)}))}function nI(t){const V=jk.I()&&999999!==t?0:t;return new Promise((t=>{window.setTimeout(t,V)}))}let qI=null;async function RI(t,V,X){var K;qI&&(clearTimeout(qI),G$.W(t.transport3d,kI.Deal),qI=null);const k=function(t){return t===M$.Free||t===M$.FreeHidden}(X),A=X===M$.FreeHidden,{playerHand:$,bankerHand:I}=V.cardHands,{winner:C}=V.gameResult.result,n=t.settings.gameSpeedModeSettings,R=V.shoe,F=V.playedCards,s=FI(t,V);if(!k){const V=function(t,V){if(!t||!V)return;const X=Object.keys(t).reduce(((X,K)=>{const k=t[K],A=V[K];return k&&!A&&(X[K]={amount:k,error:`${J$.O4.UnknownError}`}),X}),{});return Object.keys(X).length>0?X:void 0}(s.originalBets,s.acceptedBets);V&&(s.rejectedBets=V,function(t,V){for(const X of Object.keys(V)){const K=V[X];if(K){const V=+K.error;t.ag.actions.toasts.show({id:`error_${V}`,type:o$.C.GenericToast,props:{description:q.Tl("trafficlight.acceptedAmount.new",{amount:HX.ej(t.ag.balanceTotalBet,{currencySymbol:t.settings.currencySymbol})}),title:q.Tl("betsPartiallyAccepted")}});break}}}(t,V))}t.animation.setActiveAnimation(yA.Dealing,!0),t.messageSender3d.to.setSpeedRatio({speedRatioType:AI.Deal,ratio:XI(k,n)}),t.gamePhase.setPhase(iV.Qc.Dealing),d$.T(t.transport3d,kI.Deal),t.table.setCardsState(Z$.Hide);const S=V.potentialMultipliers;V.cardHands.lightningMultipliers&&t.multipliers.setMultipliers(V.cardHands.lightningMultipliers),S&&t.multipliers.setPotentialMultipliers(S);const c=null===(K=V.cardHands.lightningMultipliers)||void 0===K?void 0:K.map((V=>({...V,active:t.cards.dealtCards.includes(V.card)})));c&&(await t.messageSender3d.to.waitSetBowlState(!0),await t.messageSender3d.to.showLightningTombstones(c),t.messageSender3d.to.setBowlState(!1),jk.I()&&window.__storyGameAPI__.pauseGameOnTombstone&&(await window.__storyGameAPI__.babylonScene.whenReadyAsync(),G$.W(t.transport3d,kI.Deal),await CI(),await CI(),window.__storyGameAPI__.gamePausedTombstones=!0,await nI(999999)));const N=function(t){return new II(t)}({store:t,cardCount:R.cardsLeft+F.Player.length+F.Banker.length,cards:F}),m=V.cardHands.lightningMultipliers;let v=!1;if(m&&$.cards.concat(I.cards).some((t=>m.some((V=>V.card===t))))&&(t.bubble.setMultipliersCardExist(!0),v=!0),X===M$.Standard?(await async function(t,V,X,K,k){await async function(t){const{cardDealer:V,zoom:X,flyToDeal:K,playerHand:k,bankerHand:A,setPhase:$,flyToWinState:I,setCardsState:C}=t;X?await(null==K?void 0:K()):null==K||K(),await V.dealCard(zK.Player,0),await V.dealCard(zK.Banker,0),await V.dealCard(zK.Player,1),await V.dealCard(zK.Banker,1),$(iV.Qc.Revealing),C(Z$.Show),await V.openCard(zK.Player,0),await V.openCard(zK.Player,1),await V.openCard(zK.Banker,0),await V.openCard(zK.Banker,1),X&&(k.cards.length>2||A.cards.length>2?I():await I()),k.cards.length>2&&await V.dealCard(zK.Player,2),A.cards.length>2&&await V.dealCard(zK.Banker,2),k.cards.length>2&&await V.openCard(zK.Player,2),A.cards.length>2&&await V.openCard(zK.Banker,2)}({cardDealer:V,setPhase:V=>t.gamePhase.setPhase(V),setCardsState:V=>t.table.setCardsState(V),playerHand:X,bankerHand:K,flyToDeal:async()=>await t.messageSender3d.to.flyToDeal(),flyToWinState:async()=>await t.messageSender3d.to.flyToWin(),zoom:k})}(t,N,$,I,t.device.isPhone),await t.messageSender3d.to.sendAllCardsDealt()):X===M$.Free?(t.log.freeHandGameAction(!0),await async function(t,V,X,K,k){await async function(t){const{cardDealer:V,flyToDeal:X,playerHand:K,bankerHand:k,setPhase:A}=t;X&&X(),A(iV.Qc.Revealing),await V.dealOpenCard(zK.Player,0),await V.dealOpenCard(zK.Banker,0),await V.dealOpenCard(zK.Player,1),await V.dealOpenCard(zK.Banker,1),K.cards.length>2&&await V.dealOpenCard(zK.Player,2),k.cards.length>2&&await V.dealOpenCard(zK.Banker,2)}({cardDealer:V,setPhase:V=>t.gamePhase.setPhase(V),playerHand:X,bankerHand:K,flyToDeal:k})}(t,N,$,I)):(t.log.freeHandGameAction(!1),await async function(t,V,X,K,k){await async function(t){const{cardDealer:V,flyToDeal:X,playerHand:K,bankerHand:k,setPhase:A}=t;X&&X(),A(iV.Qc.Revealing),await V.dealCard(zK.Player,0),await V.dealCard(zK.Banker,0),await V.dealCard(zK.Player,1),await V.dealCard(zK.Banker,1),K.cards.length>2&&await V.dealCard(zK.Player,2),k.cards.length>2&&await V.dealCard(zK.Banker,2)}({cardDealer:V,setPhase:V=>t.gamePhase.setPhase(V),playerHand:X,bankerHand:K,flyToDeal:k})}(t,N,$,I)),t.device.isDesktop&&v){t.reference.bubble.all[bK.MultiplierCards]||await t.messageSender3d.from.multiplierAdded();const{isMultiplierBubbleVisible:V}=t.bubble||{};V&&await t.messageSender3d.to.pauseResumeWait({pause:!0})}A||function(t,V){V===iV.K8.Player?(t.messageSender3d.to.highlightHand({hand:zK.Player}),t.messageSender3d.to.dimHand({hand:zK.Banker})):V===iV.K8.Banker?(t.messageSender3d.to.highlightHand({hand:zK.Banker}),t.messageSender3d.to.dimHand({hand:zK.Player})):(t.messageSender3d.to.highlightHand({hand:zK.Player}),t.messageSender3d.to.highlightHand({hand:zK.Banker}))}(t,C);const W=function(t){var V,X;const K=(null===(V=t.bets)||void 0===V?void 0:V.acceptedBets)||{};return{winner:t.result.winner||"",winningBetSpots:t.winningSpots||[],amount:(k=K,Object.keys(k).reduce(((t,V)=>{const X=k[V];return void 0!==X?t+(X.payoff||0):t}),0)),acceptedBetsAmount:f$(K),winType:(null===(X=t.bets)||void 0===X?void 0:X.winType)||SA.R.None,betsAcceptedBetSpots:Object.keys(K)};var k}({...V.gameResult,bets:s});k||t.sounds.playGameResultSound(C),t.gamePhase.setPhase(iV.Qc.Resolved),c&&t.messageSender3d.to.highlightTombstoneCardsPromise(),A||t.cards.setHands({[zK.Player]:$,[zK.Banker]:I}),k||tI(t,(t=>{return{...t,currentChips:(V=t.acceptedBets,Object.keys(V).reduce(((t,X)=>{const K=V[X];return void 0!==K&&(t[X]=K.payoff),t}),{}))};var V})(s));const Z=function(t,V){return t?2:(null==V?void 0:V[1])?V[1]:VI}(k,n);!k&&n&&t.messageSender3d.to.setSpeedRatio({speedRatioType:AI.Deal,ratio:Z}),t.gameResult.setGameResultData(W);const D=window.__storyGameAPI__;if(jk.I()&&D.pauseGameOnWinResult&&(G$.W(t.transport3d,kI.Deal),await D.babylonScene.whenReadyAsync(),await CI(),await CI(),D.gamePausedWinResult=!0,await nI(999999)),await nI($I(1800,Z)),t.table.setCardsState(Z$.Empty),t.messageSender3d.to.hideTombstones(),v){await t.messageSender3d.to.waitSetBowlState(!0);const{gameResult:V,multipliers:X}=t,K=V.winningBetSpots.some((t=>V.betsAcceptedBetSpots.includes(t))),k=V.winningBetSpots.some((t=>!!X.getBetSpotMultiplier(t)));V.amount>0&&k&&K&&!t.layout.hideYouWin?await t.messageSender3d.to.waitRunWinningCoins():t.messageSender3d.to.setBowlState(!1)}await t.messageSender3d.to.removeMultipliers(!k),function(t){t.messageSender3d.to.dimRoom(!1),t.messageSender3d.to.highlightTableTag(!1)}(t),await Promise.all([k?void 0:t.messageSender3d.to.flyToTable({}),t.messageSender3d.to.removeCards({flip:!A})]),t.bubble.setMultipliersCardExist(!1),t.shoe.setShoeData(R.data),t.shoe.setShoeCardCount(R.cardsLeft),N.isCutCardDealt&&t.shoe.setShoeState(y$.y.Finished),qI=setTimeout((()=>{G$.W(t.transport3d,kI.Deal)}),jk.I()?0:700),t.messageSender3d.to.setSpeedRatio({speedRatioType:AI.Deal,ratio:1}),t.animation.setActiveAnimation(yA.Dealing,!1),function(t,V,X=!1){t.table.setNextGameId(V),Q$(t),t.multipliers.reset(),t.messageSender3d.to.update3dBets(wX(t)),X?t.messageSender.shuffleShoe({tableId:t.settings.tableId,virtualTableId:t.settings.virtualTableId,shoeName:t.table.table.shoeId}):H$(t)}(t,V.gameResult.gameId,N.isCutCardDealt)}const FI=(t,V)=>function(t,V,X){const K=t.bets.bets,k=t.bets.rejectedBets;let A=K;if(k){const t=Object.keys(k).reduce(((t,V)=>{var X;return t[V]=null===(X=k[V])||void 0===X?void 0:X.amount,t}),{});A={...t,...K}}return{originalBets:X,acceptedBets:V.result||{},rejectedBets:t.bets.rejectedBets||{},currentChips:K,balance:V.balance,chipHistory:t.bets.history,lastGameChips:A,totalAmount:t.ag.balanceTotalBet,status:iV.uB.Accepted,canRepeat:{AllBets:!0},winType:V.winType}}(t,V,t.lastBets.bets);function sI(t,V){const X=t=>{for(const X of V)if(X.spot===t)return X.amount};return Object.keys(t).reduce(((V,K)=>{var k;return V[K]={amount:null!==(k=t[K])&&void 0!==k?k:0,payoff:X(K)},V}),{})}function SI(t){return"playerCards"in t&&"bankerCards"in t}async function cI(t,V){const X=V.table.table.nextGameId;if(t.payload.nextGameId===X)return;const K=function(t,V){var X,K;const k=function(t){if(!SI(t))return t;const V={playerScore:0,bankerScore:0,playerPair:!1,bankerPair:!1,natural:!1,winner:t.winner,cardsDealt:{P1:{card:iV.Zp.UnknownCard,score:0},P2:{card:iV.Zp.UnknownCard,score:0},B1:{card:iV.Zp.UnknownCard,score:0},B2:{card:iV.Zp.UnknownCard,score:0}},winningSpots:[]};return t.playerCards>2&&(V.cardsDealt.P3={card:iV.Zp.UnknownCard,score:0}),t.bankerCards>2&&(V.cardsDealt.B3={card:iV.Zp.UnknownCard,score:0}),V}(t.result),A={playerHand:{cards:[k.cardsDealt.P1.card,k.cardsDealt.P2.card],score:k.playerScore},bankerHand:{cards:[k.cardsDealt.B1.card,k.cardsDealt.B2.card],score:k.bankerScore},winningSpots:k.winningSpots,result:{bankerPair:k.bankerPair,bankerScore:k.bankerScore,natural:k.natural,playerPair:k.playerPair,playerScore:k.playerScore,winner:k.winner}};k.lightningMultipliers&&(A.lightningMultipliers=k.lightningMultipliers.cards);const $={[iV.K8.Banker]:[k.cardsDealt.B1,k.cardsDealt.B2],[iV.K8.Player]:[k.cardsDealt.P1,k.cardsDealt.P2]};k.cardsDealt.P3&&(A.playerHand.cards.push(k.cardsDealt.P3.card),$.Player.push(k.cardsDealt.P3)),k.cardsDealt.B3&&(A.bankerHand.cards.push(k.cardsDealt.B3.card),$.Banker.push(k.cardsDealt.B3));const I={gameId:null!==(X=t.nextGameId)&&void 0!==X?X:"",version:0,result:A.result,winningSpots:A.winningSpots||[]};return{result:t.payouts?sI(V,t.payouts):void 0,playedCards:$,balance:t.balance,cardHands:A,gameResult:I,shoe:t.shoe,winType:t.winType,shoeName:t.shoeName,potentialMultipliers:null===(K=null==k?void 0:k.lightningMultipliers)||void 0===K?void 0:K.potential}}(t.payload,V.betProcessor.calculateUpdatedBets(V.bets.bets));await RI(V,K,function(t){return SI(t.result)?M$.FreeHidden:t.payouts?M$.Standard:M$.Free}(t.payload)),t.payload.nextGameId&&V.ag.actions.setGameRoundId(t.payload.nextGameId),t.payload.nextBetLimits&&function(t,V,X){var K;const k=null===(K=t.tableConfig.config)||void 0===K?void 0:K.limits;i$.A(k,X)||(t.tableConfig.setTableLimits(X),t.ag.actions.popups.open(a$.W6({message:q.Tl("message.betLimitsChanges"),buttonIds:["Ok"]})))}(V,t.payload.shoeName,t.payload.nextBetLimits),t.payload.nextCoefficientReductions?V.tableConfig.setCoefficientReductions(t.payload.nextCoefficientReductions):V.tableConfig.setCoefficientReductions(j$(V,t.payload.shoe.cardsLeft))}class NI{constructor(t){this.props=t;const{from:V,to:X}=t;this.from=V,this.to=X}}class mI{constructor(t){this.props=t}balanceUpdateDone(){this.props.transport3d.sendFrom3dWorld({type:a.BalanceUpdateDone,payload:void 0})}betSpotPressed(t){this.props.transport3d.sendFrom3dWorld({type:a.BetSpotPressed,payload:t})}breakDownChipAnimationEnd(){this.props.transport3d.sendFrom3dWorld({type:a.BreakDownChipAnimationEnd,payload:void 0})}burnCardsDone(){this.props.transport3d.sendFrom3dWorld({type:a.BurnCardsDone,payload:void 0})}cameraFlewToDealView(){this.props.transport3d.sendFrom3dWorld({type:a.CameraFlewToDealView,payload:void 0})}cameraFlewToTableView(){this.props.transport3d.sendFrom3dWorld({type:a.CameraFlewToTable,payload:void 0})}cameraFlewToWinView(){this.props.transport3d.sendFrom3dWorld({type:a.CameraFlewToTableWin,payload:void 0})}cardDealtOpen(t){this.props.transport3d.sendFrom3dWorld({type:a.CardDealtOpen,payload:t})}cardOpen(t){this.props.transport3d.sendFrom3dWorld({type:a.CardOpen,payload:t})}cardsRemoved(){this.props.transport3d.sendFrom3dWorld({type:a.CardsRemoved,payload:void 0})}cardDealt(t){this.props.transport3d.sendFrom3dWorld({type:a.CardDealt,payload:t})}changeBettingGridTypeDone(){this.props.transport3d.sendFrom3dWorld({type:a.ChangeBettingGridTypeDone,payload:void 0})}cutCardDealt(){this.props.transport3d.sendFrom3dWorld({type:a.CutCardDealt,payload:void 0})}cutCardMove(t){this.props.transport3d.sendFrom3dWorld({type:a.CutCardMove,payload:t})}cutCardsAquirePosition(t){this.props.transport3d.sendFrom3dWorld({type:a.CutCardsAquirePosition,payload:t})}cutCardsCancelled(){this.props.transport3d.sendFrom3dWorld({type:a.CutCardsCancelled,payload:void 0})}cutCardsDone(t){this.props.transport3d.sendFrom3dWorld({type:a.CutCardsDone,payload:t})}cutCardsStart(){this.props.transport3d.sendFrom3dWorld({type:a.CutCardsStart,payload:void 0})}cutCardsWaitForInput(){this.props.transport3d.sendFrom3dWorld({type:a.CutCardsWaitForInput,payload:void 0})}endSceneRender(){return()=>{this.props.transport3d.sendFrom3dWorld({type:a.SceneRerenderEnd,payload:void 0})}}flyingChipAnimationDone(){this.props.transport3d.sendFrom3dWorld({type:a.FlyingChipAnimationDone,payload:void 0})}goLiveReady(){this.props.transport3d.sendFrom3dWorld({type:a.GoLiveReady,payload:void 0})}highlightSpotDone(){this.props.transport3d.sendFrom3dWorld({type:a.HighlightSpotDone,payload:void 0})}hoverSpotDone(){this.props.transport3d.sendFrom3dWorld({type:a.HoverSpotDone,payload:void 0})}idleAnimationStopped(){this.props.transport3d.sendFrom3dWorld({type:a.IdleAnimationStopped,payload:void 0})}moveBetStarted(t){this.props.transport3d.sendFrom3dWorld({type:a.MoveBetStart,payload:t})}moveBetDone(t){this.props.transport3d.sendFrom3dWorld({type:a.MoveBetDone,payload:t})}placeBetDone(){this.props.transport3d.sendFrom3dWorld({type:a.PlaceBetDone,payload:void 0})}placeChipsOnTableDone(){this.props.transport3d.sendFrom3dWorld({type:a.PlaceChipsOnTableDone,payload:void 0})}selectedChip(t){this.props.transport3d.sendFrom3dWorld({type:a.SelectChip,payload:t})}selectChipAnimationEnd(){this.props.transport3d.sendFrom3dWorld({type:a.SelectChipAnimationEnd,payload:void 0})}setResumeGame(){this.props.transport3d.sendFrom3dWorld({type:a.SetResumeGame,payload:void 0})}shuffleCardsDone(){this.props.transport3d.sendFrom3dWorld({type:a.ShuffleCardsDone,payload:void 0})}speedRatioUpdated(t){this.props.transport3d.sendFrom3dWorld({type:a.SpeedRatioUpdated,payload:t})}hideTooltip(){this.props.transport3d.sendFrom3dWorld({type:a.HideTooltip,payload:void 0})}updateBetsDone(){this.props.transport3d.sendFrom3dWorld({type:a.UpdateBetsDone,payload:void 0})}}var vI,WI,ZI;(function(t){t["MultiplierAdded"]="MultiplierAdded",t["MultipliersRemoved"]="MultipliersRemoved",t["ShowTombstonesDone"]="ShowTombstonesDone",t["MultiplierCardsMatchAnimationsDone"]="MultiplierCardsMatchAnimationsDone",t["TombstoneAnimationDone"]="TombstoneAnimationDone",t["CommonAnimationDone"]="CommonAnimationDone"})(vI||(vI={}));class DI extends mI{constructor(t){super(t),this.props=t}commonAnimationDone(){this.props.transport3d.sendFrom3dWorld({type:vI.CommonAnimationDone,payload:void 0})}multiplierCardsMatchAnimationsDone(){this.props.transport3d.sendFrom3dWorld({type:vI.MultiplierCardsMatchAnimationsDone,payload:void 0})}multiplierAdded(){this.props.transport3d.sendFrom3dWorld({type:vI.MultiplierAdded,payload:void 0})}multipliersRemoved(){this.props.transport3d.sendFrom3dWorld({type:vI.MultipliersRemoved,payload:void 0})}showTombstonesDone(){this.props.transport3d.sendFrom3dWorld({type:vI.ShowTombstonesDone,payload:void 0})}tombstoneAnimationDone(){this.props.transport3d.sendFrom3dWorld({type:vI.TombstoneAnimationDone,payload:void 0})}updateTableStateDone(){this.props.transport3d.sendFrom3dWorld({type:a.UpdateTableStateDone,payload:void 0})}}(function(t){t["SetBowlStateDone"]="SetBowlStateDone",t["SetBowlVisibilityDone"]="SetBowlVisibilityDone",t["WinningCoinsDone"]="WinningCoinsDone"})(WI||(WI={}));class yI extends DI{constructor(t){super(t),this.props=t}winningCoinsDone(){this.props.transport3d.sendFrom3dWorld({type:WI.WinningCoinsDone,payload:void 0})}}(function(t){t["LightningStrikeBettedSpots"]="LightningStrikeBettedSpots",t["ShowTombstones"]="ShowTombstones",t["HideTombstones"]="HideTombstones",t["MultipliersRemove"]="MultipliersRemove",t["SetMultipliers"]="SetMultipliers",t["AllCardsDealt"]="AllCardsDealt",t["TombstoneAnimationStart"]="TombstoneAnimationStart",t["HighlightTombstoneCards"]="HighlightTombstoneCards",t["SetSpotsMultipliers"]="SetSpotsMultipliers",t["BetsAmountChanged"]="BetsAmountChanged",t["CommonAnimationStart"]="CommonAnimationStart",t["SetShuffleStarted"]="SetShuffleStarted",t["SendBurnDone"]="SendBurnDone"})(ZI||(ZI={}));var EI=X(676330);const _I=EI._(),pI=EI._();class LI{constructor(t){this.props=t,this.flyToDeal=this.flyToDeal.bind(this)}async flyToDeal(){await this.fly({type:u.FlyToDealView,payload:void 0},a.CameraFlewToDealView)}async flyToWin(){await this.fly({type:u.FlyToWinView,payload:void 0},a.CameraFlewToTableWin)}async flyToGoLive(){await this.fly({type:u.GoLive,payload:void 0},a.GoLiveReady)}async burnCards(t){await pI(this.props.transport3d,{type:u.BurnCards,payload:t},(t=>t.type===a.BurnCardsDone))}autoCut(){this.props.transport3d.sendTo3dWorld({type:u.AutoCut,payload:void 0})}balanceUpdate(t){this.props.transport3d.sendTo3dWorld({type:u.BalanceUpdate,payload:t})}breakDownChipAnimationStart(){this.props.transport3d.sendTo3dWorld({type:u.BreakDownChipAnimationStart,payload:void 0})}cancelToken(t){this.props.transport3d.sendTo3dWorld({type:u.Cancel,payload:t})}changeBettingGridType(t){this.props.transport3d.sendTo3dWorld({type:u.ChangeBettingGridType,payload:t})}changeCursors(t){this.props.transport3d.sendTo3dWorld({type:u.ChangeCursor,payload:t})}changeOrientation(t){this.props.transport3d.sendTo3dWorld({type:u.ChangeOrientation,payload:t})}async cutCards(t){var V;return(await pI(this.props.transport3d,{type:u.CutCards,payload:{token:null!==(V=t.token)&&void 0!==V?V:x$.Ti(),deckTangents:t.deckTangents}},(t=>t.type===a.CutCardsDone))).payload.position}cutCardsAtPosition(t){this.props.transport3d.sendTo3dWorld({type:u.CutCardsAtPosition,payload:t})}async dealCard(t){await pI(this.props.transport3d,{type:u.DealCard,payload:t},(V=>V.type===a.CardDealt&&V.payload.card===t.card&&V.payload.placeHolder===t.placeHolder))}async dealCutCard(){await pI(this.props.transport3d,{type:u.DealCutCard,payload:void 0},(t=>t.type===a.CutCardDealt))}dealingPhaseStart(){this.props.transport3d.sendTo3dWorld({type:u.DealingPhaseStart,payload:void 0})}async dealOpenCard(t){await pI(this.props.transport3d,{type:u.DealOpenCard,payload:t},(V=>V.type===a.CardDealtOpen&&V.payload.card===t.card&&V.payload.cardPlace===t.cardPlace&&V.payload.placeHolder===t.placeHolder))}dimHand(t){this.props.transport3d.sendTo3dWorld({type:u.DimHand,payload:t})}highlightHand(t){this.props.transport3d.sendTo3dWorld({type:u.HighlightHand,payload:t})}dimRoom(t){this.props.transport3d.sendTo3dWorld({type:u.DimRoom,payload:t})}startFlyCamera(t){this.props.transport3d.sendTo3dWorld({type:u.StartFlyCamera,payload:t})}stopFlyCamera(){this.props.transport3d.sendTo3dWorld({type:u.StopFlyCamera,payload:void 0})}flyingChipAnimationStart(){this.props.transport3d.sendTo3dWorld({type:u.FlyingChipAnimationStart,payload:void 0})}hideLightsOnTable(){this.props.transport3d.sendTo3dWorld({type:u.HideTableLight,payload:void 0})}highlightSpotStart(){this.props.transport3d.sendTo3dWorld({type:u.HighlightSpotStart,payload:void 0})}highlightTableTag(t){this.props.transport3d.sendTo3dWorld({type:u.HighlightTableTag,payload:t})}hoverSpotStart(){this.props.transport3d.sendTo3dWorld({type:u.HoverSpotStart,payload:void 0})}startIdleAnimation(t){this.props.transport3d.sendTo3dWorld({type:u.StartIdleAnimation,payload:t})}stopIdleAnimation(){this.props.transport3d.sendTo3dWorld({type:u.StopIdleAnimation,payload:void 0})}moveBetStart(t){this.props.transport3d.sendTo3dWorld({type:u.MoveBetStart,payload:t})}moveCutCard(t){this.props.transport3d.sendTo3dWorld({type:u.MoveCutCard,payload:t})}async openCard(t){await pI(this.props.transport3d,{type:u.OpenCard,payload:t},(V=>V.type===a.CardOpen&&V.payload.cardPlace===t.cardPlace&&V.payload.placeHolder===t.placeHolder))}placeBet(t){this.props.transport3d.sendTo3dWorld({type:u.PlaceBet,payload:t})}placeChipsOnTable(){this.props.transport3d.sendTo3dWorld({type:u.PlaceChipsOnTable,payload:void 0})}pulseWinning(t){this.props.transport3d.sendTo3dWorld({type:u.PulseWinning,payload:t})}registerToken(t){this.props.transport3d.sendTo3dWorld({type:u.RegisterToken,payload:t})}async removeCards(t){await pI(this.props.transport3d,{type:u.RemoveCards,payload:t},(t=>t.type===a.CardsRemoved))}selectChip(t){this.props.transport3d.sendTo3dWorld({type:u.SelectChip,payload:t})}selectChipAnimationStart(){this.props.transport3d.sendTo3dWorld({type:u.SelectChipAnimationStart,payload:void 0})}setBettingOpen(t){this.props.transport3d.sendTo3dWorld({type:u.SetBettingOpen,payload:t})}setPausedGame(t){this.props.transport3d.sendTo3dWorld({type:u.SetPaused,payload:t})}async pauseResumeWait(t){await pI(this.props.transport3d,{type:u.SetPaused,payload:t},(t=>t.type===a.SetResumeGame))}setSpeedRatio(t){this.props.transport3d.sendTo3dWorld({type:u.SetSpeedRatio,payload:t})}async shuffleCards(t){var V;await pI(this.props.transport3d,{type:u.ShuffleCards,payload:{shortShuffle:t.shortShuffle,token:null!==(V=t.token)&&void 0!==V?V:x$.Gr()}},(t=>t.type===a.ShuffleCardsDone))}startSceneRender(){return()=>{this.props.transport3d.sendTo3dWorld({type:u.SceneRerenderStart,payload:void 0})}}addTooltip(t){this.props.transport3d.sendTo3dWorld({type:u.AddTooltip,payload:t})}showTooltip(){this.props.transport3d.sendTo3dWorld({type:u.ShowTooltip,payload:void 0})}updateLockedSpots(t){this.props.transport3d.sendTo3dWorld({type:u.UpdateLockedSpots,payload:t})}uploadMesh(t){this.props.transport3d.sendTo3dWorld({type:u.UploadMesh,payload:t})}linkMesh(t){this.props.transport3d.sendTo3dWorld({type:u.LinkMesh,payload:t})}async fly(t,V){await pI(this.props.transport3d,t,(t=>t.type===V))}}class OI extends LI{constructor(t){super(t),this.props=t}betsAmountChanged(t){this.props.transport3d.sendTo3dWorld({type:ZI.BetsAmountChanged,payload:t})}commonAnimationStart(){this.props.transport3d.sendTo3dWorld({type:ZI.CommonAnimationStart,payload:void 0})}showLightsOnTable(t){this.props.transport3d.sendTo3dWorld({type:u.ShowTableLight,payload:t})}async flyToTable(t){this.showLightsOnTable({}),await this.flyTo({type:u.FlyToTable,payload:t},a.CameraFlewToTable)}hideTombstones(){this.props.transport3d.sendTo3dWorld({type:ZI.HideTombstones,payload:void 0})}highlightTombstoneCardsPromise(){this.props.transport3d.sendTo3dWorld({type:ZI.HighlightTombstoneCards,payload:void 0})}async removeMultipliers(t){const V={type:ZI.MultipliersRemove,payload:t};await _I(this.props.transport3d,V,(t=>t.type===vI.MultipliersRemoved))}setLightningStrikesSpots(t){this.props.transport3d.sendTo3dWorld({type:ZI.LightningStrikeBettedSpots,payload:t})}setMultipliers(t){this.props.transport3d.sendTo3dWorld({type:ZI.SetMultipliers,payload:t})}setSpotsMultipliers(t){this.props.transport3d.sendTo3dWorld({type:ZI.SetSpotsMultipliers,payload:t})}selectedTableReady(t){this.props.transport3d.sendTo3dWorld({type:u.TableReady,payload:t})}tombstoneAnimationStart(){this.props.transport3d.sendTo3dWorld({type:ZI.TombstoneAnimationStart,payload:void 0})}update3dBets(t){this.props.transport3d.sendTo3dWorld({type:u.UpdateBets,payload:t})}updateTableState(t){this.props.transport3d.sendTo3dWorld({type:u.UpdateTableState,payload:t})}sendShuffleStarted(t){this.props.transport3d.sendTo3dWorld({type:ZI.SetShuffleStarted,payload:t})}sendBurnDone(){this.props.transport3d.sendTo3dWorld({type:ZI.SendBurnDone,payload:void 0})}async sendAllCardsDealt(){const t={type:ZI.AllCardsDealt,payload:void 0};return this.props.transport3d.sendTo3dWorld(t),Promise.resolve()}async flyTo(t,V){await _I(this.props.transport3d,t,(t=>t.type===V))}}var rI;(function(t){t["WinningCoinsStart"]="WinningCoinsStart",t["SetBowlState"]="SetBowlState",t["SetBowlVisibility"]="SetBowlVisibility"})(rI||(rI={}));const zI=EI._();class wI extends OI{constructor(t){super(t),this.props=t}async sendAllCardsDealt(){await _I(this.props.transport3d,{type:ZI.AllCardsDealt,payload:void 0},(t=>t.type===vI.MultiplierCardsMatchAnimationsDone))}async showLightningTombstones(t){await _I(this.props.transport3d,{type:ZI.ShowTombstones,payload:t},(t=>t.type===vI.ShowTombstonesDone))}setBowlState(t){this.props.transport3d.sendTo3dWorld({type:rI.SetBowlState,payload:t})}async waitSetBowlState(t){await zI(this.props.transport3d,{type:rI.SetBowlState,payload:t},(t=>t.type===WI.SetBowlStateDone))}async waitRunWinningCoins(){await zI(this.props.transport3d,{type:rI.WinningCoinsStart,payload:void 0},(t=>t.type===WI.WinningCoinsDone))}}var bI=X(941691);class aI{constructor(t){this.props=t,this.value=0,this.previousValue=0,this.percentage=t.percentage,NX.Gn(this,{value:NX.sH,set:NX.XI.bound,getAmountWithFee:NX.XI.bound,getAmountWithoutFee:NX.XI.bound})}set(t){const V=this.value;this.value=t,V!==this.previousValue&&(this.previousValue=V)}getFeeAmount(t){return jX.eS(t*this.percentage/100,3)}getAmountWithFee(t){return jX.eS(t*(100+this.percentage)/100,3)}getAmountWithoutFee(t){return jX.yv(100*t/(100+this.percentage))}}class uI extends aI{constructor(t){super(t),this.props=t,NX.Gn(this,{tooltipText:NX.EW})}get tooltipText(){return this.value>0?{key:"tooltip.feeAdded",mappings:{percentage:this.percentage}}:this.props.root.device.isPhone?{key:"onboarding.feeAddedShort",mappings:{percentage:this.percentage}}:{key:"onboarding.feeAdded",mappings:{percentage:this.percentage}}}}class jI extends uI{constructor(t){super(t),this.props=t,NX.Gn(this,{animation:NX.EW})}get animation(){const t=this.props.root.gamePhase.value,V=this.value>0;switch(!0){case t===iV.Qc.BetsOpen&&V:case t===iV.Qc.BetsClosed&&V:return bI.V.BetPlaced;default:return bI.V.None}}}class xI extends jI{get animation(){const t=this.props.root.gamePhase.value,V=this.value>0;switch(!0){case t===iV.Qc.BetsClosed&&V:case t===iV.Qc.Dealing&&V:return bI.V.AnimationStart;case t===iV.Qc.BetsOpen&&V:return bI.V.BetPlaced;default:return bI.V.None}}}function eI(t){return NX.mJ((()=>t.deal.isDeal),(V=>{if(V){t.sounds.playDealNowSound(),t.log.dealPressed(),t.messageSender3d.to.dealingPhaseStart();const V=t.bets.bets;t.lastBets.setLastBets(V);const X=t.betProcessor.processBetsToSend();t.gamePhase.setPhase(iV.Qc.BetsClosed);const K=t.deal.gameBetTags;t.ag.actions.balance.pauseBalanceUpdate(),t.deal.setDeal(!1),t.messageSender.sendBets({tableId:t.settings.tableId,virtualTableId:t.settings.virtualTableId,shoeName:t.table.table.shoeId},X,K)}}))}const YI=t=>[eI(t)];var HI=X(996496);const hI={[yA.DeckShuffleProcedure]:{start:[u.ShuffleCards,u.CutCards,u.BurnCards],stop:[a.BurnCardsDone]},[yA.ShuffleCards]:{start:[u.ShuffleCards],stop:[a.ShuffleCardsDone]},[yA.CutCards]:{start:[u.CutCards],stop:[a.CutCardsDone,a.CutCardsCancelled]},[yA.BurnCards]:{start:[u.BurnCards],stop:[a.BurnCardsDone]},[yA.CameraMovement]:{start:[u.GoLive,u.FlyToTable],stop:[a.CameraFlewToTable,a.GoLiveReady]},[yA.GoLive]:{start:[u.GoLive],stop:[a.GoLiveReady]},[yA.DragAndDrop]:{start:[u.MoveBetStart],stop:[a.MoveBetDone]}},TI={[HI.b.ShuffleCards]:[yA.ShuffleCards],[HI.b.CutCards]:[yA.DeckShuffleProcedure,yA.CutCards]};var PI,QI,JI,UI;const lI={...hI,[yA.CameraMovement]:{start:[...null!==(QI=null===(PI=null==hI?void 0:hI[yA.CameraMovement])||void 0===PI?void 0:PI.start)&&void 0!==QI?QI:[]],stop:[...null!==(UI=null===(JI=null==hI?void 0:hI[yA.CameraMovement])||void 0===JI?void 0:JI.stop)&&void 0!==UI?UI:[]]}},iI=TI;function GI(t){return NX.mJ((()=>t.gameInfo.canStartGame),(async V=>{if(V){t.ag.actions.tableLimits.setMax(t.tableConfig.tableConfigMaxLimit),t.ag.actions.tableLimits.setMin(t.tableConfig.tableConfigMinLimit);const V=h$(t);V&&t.messageSender3d.to.updateTableState(V),t.table.tableSelectionDone?NX.h5((()=>{t.table.setTableSelectionDone(!0)})):t.device.isDesktop?await async function(t){t.animation.setActiveAnimation(yA.CameraMovement,!0),await T$(t,{isAnimated:!0}),t.animation.setActiveAnimation(yA.CameraMovement,!1)}(t):await T$(t,{isAnimated:!1})}}))}function dI(t){return NX.mJ((()=>t.gameInfo.app3dLoaded),(V=>{V&&(t.idleTimer.start(),function(t,V,X={}){const K=Object.keys(V),k=Object.keys(X);t.transport3d.onMessageTo3dWorld((A=>{var $;if(A.type===u.RegisterToken)for(const V of k)A.payload.token.groups.includes(V)&&A.payload.token.onCancel((()=>{var K;const k=null!==(K=X[V])&&void 0!==K?K:[];for(const V of k)t.animation.setActiveAnimation(V,!1)}));else for(const X of K)(null===($=V[X])||void 0===$?void 0:$.start.includes(A.type))&&(t.animation.gameActiveAnimations.get(X)||t.animation.setActiveAnimation(X,!0))})),t.transport3d.onMessageFrom3dWorld((X=>{var k;for(const A of K)(null===(k=V[A])||void 0===k?void 0:k.stop.includes(X.type))&&t.animation.setActiveAnimation(A,!1)}))}(t,lI,iI),HA(t),jk.I()&&(window.__storyGameAPI__.shuffleShoe=()=>{Y$(t)}))}))}const MI=t=>[GI(t),dI(t)];function BI(t){return NX.mJ((()=>t.multipliers.values),(V=>{t.messageSender3d.to.setMultipliers(V)}),{fireImmediately:!0})}function oI(t){return NX.mJ((()=>t.multipliers.spotsMultipliers),(V=>{t.messageSender3d.to.setSpotsMultipliers(V)}),{fireImmediately:!0})}function fI(t){return NX.mJ((()=>t.multipliers.lightStrikeSpots),(V=>{t.messageSender3d.to.setLightningStrikesSpots(V)}),{fireImmediately:!0})}const gI=t=>[BI(t),oI(t),fI(t)];function tC(t){return NX.mJ((()=>({scorecardTheme:t.preferences.scorecardTheme,min:t.ag.values.tableLimitsMin,max:t.ag.values.tableLimitsMax})),(()=>{t.ag.actions.setHelpCustomConfig(function(t){const{settings:V,preferences:X}=t;return{isNoMaxPayoutLimitInfo:t.settings.isNoMaxPayoutLimitInfo,minLimit:t.ag.values.tableLimitsMin,maxLimit:t.ag.values.tableLimitsMax,freeHandLimit:Number(V.freeHandLimit),scorecardTheme:X.scorecardTheme,coefficientReductionsConfig:V.coefficientReductionLimitMap,isRtpProbabilityV2:V.isRtpProbabilityV2,volatility:V.volatility}}(t))}),{fireImmediately:!0})}const VC=t=>[tC(t)];function XC(t){return NX.mJ((()=>({tableSelectionDone:t.table.tableSelectionDone,gameStarted:t.gameInfo.gameStarted})),(async({tableSelectionDone:V,gameStarted:X})=>{V&&!X&&(await nI(0),t.gameInfo.setStartGame(!0))}))}function KC(t){return NX.mJ((()=>t.table.tableSelectionDone),(()=>{const V=t.chips.currentChip,X=t.ag.availableBalance;t.messageSender3d.to.selectedTableReady({chipValue:V,balance:X}),t.messageSender3d.to.update3dBets(wX(t))}))}const kC=t=>[KC(t),XC(t)];function AC(t){return NX.mJ((()=>t.goLive.isAvailable),(V=>{V?t.ag.actions.goLiveButton.enable():t.ag.actions.goLiveButton.hide()}),{fireImmediately:!0})}function $C(t){return NX.mJ((()=>t.goLive.goLiveUrl),(V=>{t.ag.actions.goLiveButton.setUrl(V)}),{fireImmediately:!0})}const IC=t=>[AC(t),$C(t)];function CC(t){return NX.mJ((()=>t.gamePhase.value),(V=>{t.messageSender3d.to.setBowlState(V===iV.Qc.BetsOpen)}))}const nC=t=>[CC(t)],qC=t=>[...YI(t),...MI(t),...VC(t),...kC(t),...IC(t),...gI(t),...nC(t)];var RC,FC;(function(t){t["MultiplierAppear"]="multiplierAppear",t["MultiplierMatch"]="multiplierMatch",t["FeeFly"]="feeFly",t["WinCounterLoopStart"]="winCounterLoopStart",t["WinCounterLoopEnd"]="winCounterLoopEnd"})(RC||(RC={}));class sC extends _${constructor(){super(),this.playMultiplierAppear=this.playMultiplierAppear.bind(this),this.playCardMatch=this.playCardMatch.bind(this),this.playFeeFly=this.playFeeFly.bind(this),this.playWinCountUpLoopStart=this.playWinCountUpLoopStart.bind(this),this.playWinCountUpLoopEnd=this.playWinCountUpLoopEnd.bind(this)}playMultiplierAppear(){this.fireSoundEvent(RC.MultiplierAppear)}playCardMatch(){this.fireSoundEvent(RC.MultiplierMatch)}playFeeFly(t=1){this.fireSoundEvent(RC.FeeFly,t)}playWinCountUpLoopStart(){this.fireSoundEvent(RC.WinCounterLoopStart)}playWinCountUpLoopEnd(){this.fireSoundEvent(RC.WinCounterLoopEnd)}}(function(t){t["OpenBowl"]="openBowl",t["MultipliersAppear"]="multipliersAppear",t["ParticlesFly"]="particlesFly"})(FC||(FC={}));class SC extends sC{constructor(){super(),this.playOpenBowl=this.playOpenBowl.bind(this),this.playParticlesFly=this.playParticlesFly.bind(this),this.playMultipliersAppear=this.playMultipliersAppear.bind(this)}playParticlesFly(){this.fireSoundEvent(FC.ParticlesFly)}playOpenBowl(){this.fireSoundEvent(FC.OpenBowl)}playMultipliersAppear(){this.fireSoundEvent(FC.MultipliersAppear)}}const cC="spotsSettings.lightning";class NC extends O${constructor(t){super(t);const V=Mk(this);t.transport3d.onMessageFrom3dWorld(V),this.transport3d=t.transport3d,this.messageSender3d=function(t){return new NI({from:new yI(t),to:new wI(t)})}(t);const X=(K=this,t=>{K.animation.skipOnActiveAnimation||function(t,V){switch(t.type){case w$.GameResult:case w$.FreeGameResult:cI(t,V);break;default:l$(t,V)}}(t,K)});var K;this.props.transport.incomingMessages.onValue(X),this.messageSender=function(t){return new ik(t)}({messageHandler:X,gameTransport:t.transport}),this.multipliers=function(t){return new rk(t)}({cards:this.cards,gameResult:this.gameResult,root:this,defaultTieSideSpotsMap:{[iV.K8.Tie]:5,[iV.K8.PlayerPair]:9,[iV.K8.BankerPair]:9}}),this.settings=function(t){return new Pk(t)}({settings:t.settings}),this.gamePhase=new PK,this.fee=function(t){return new xI(t)}({root:this,percentage:r$.d}),this.limits=function(t){return new MK(t)}({root:this,betLimitConfig:z$}),this.log=function(t){return new vk(t)}({root:this}),this.betSpot=function(t){return new mK(t)}({root:this,spotSettingKey:cC}),this.tableConfig=function(t){return new Qk(t)}({root:this}),this.lastBets=function(t){return new QK(t)}({root:this}),this.betProcessor=function(t){return new IK(t)}({root:this}),this.sounds=new SC,this.bubble=function(t){return new xK(t)}({root:this,feePercentage:r$.d,multiplierTranslationKey:"lightning.onboarding.bubbleMultiplier"}),this.initDisposables(t.bubblesEnabled),this.initGame()}initDisposables(t){super.initDisposables(t);const V=t?[(X=this,NX.mJ((()=>X.bubble.current),((t,V)=>{null!==V&&null===t&&X.messageSender3d.to.setPausedGame({pause:!1})}))),eK(this),YK(this),mX(this),WX(this),vX(this)]:[];var X;this.disposeBag.addDisposables([...V,ZX(this),...qC(this)])}}var mC;function vC(t,V,X){const K=.9,k=V.IS_PHONE||V.IS_TABLET;return pV.U({taskName:"setupRoomTask",execute:(A,$)=>{const{scene:I}=A,C=e.getMeshByName(nV.Prefix,I),n=e.getMeshByName(cV.Prefix,I),R=e.getMeshByName(FV.Prefix,I),F=e.getMeshByName(sV.Prefix,I),s=I.getMeshByName(RV.Prefix)||void 0,S=I.getMeshByName(mC.Prefix)||void 0,c=I.getMeshByName(RV.PlaqueMeshNamePrefix)||void 0,N=n.clone(sV.DeckPrefix,F),m=FX(F,(t=>t===sV.DeckPlaceholderPrefix));N.position.copyFrom(m.position),N.rotation.copyFrom(m.rotation),FX(N,(t=>t.includes(cV.TopPartPrefix))).alphaIndex=999.5,e.getMeshByName(yV.Label,I).alphaIndex=0,e.getMeshByName(EV.Label,I).alphaIndex=0,s&&function(t,V,X,K,k){const A=VX(k),$=V.getChildMeshes(!0);for(const V of $){const k=V.getChildMeshes(!0);for(const V of k){const k=V.name,$=V.getChildMeshes(!0,(t=>CX(t.name,ZV.NamePrefix))),I=V.getChildMeshes(!0,(t=>CX(t.name,ZV.PayoutPrefix))),C=null==nX?void 0:nX[k];if($.length>0&&(X&&C&&$[0].position.addInPlace(C),$[0].rotation.x+=Math.PI/2,IX(t,{id:`betSpot.${k}`,text:q.Tl(`betSpot.${k}`),container:$[0],fontFamily:"Palatino",fontWeight:kX.Bold,color:"#e9e9e9",alpha:.7,meshWidth:A[`${k}.meshWidth`],meshRatio:A[`${k}.meshRatio`],threshold:A[`${k}.threshold`],separator:A[`${k}.separator`]})),I.length>0){X&&C&&I[0].position.addInPlace(C);const V=k===iV.K8.Tie?K:A[`${k}.payouts`];I[0].rotation.x+=Math.PI/2,IX(t,{id:`payouts.${V}`,text:`${V}`,container:I[0],fontWeight:kX.Bold,fontFamily:"Palatino",color:"#e9e9e9",alpha:.4,meshWidth:.135,meshRatio:4})}}}}(I,s,k,X,cC),S.parent=FX(C,(t=>t===mC.PlaceHolderPrefix));const v=e.getMeshByName(nV.Logo,I),W=e.getMeshByName(sX[1],I),Z=e.getMeshByName(SX[0],I),D=G.Pq.Center(W.position,Z.position);v.position.x=D.x,v.position.z=k?D.z-.2:D.z;const y=function(t,V,X){const K=[];if(V){const k=V.name;X.forEach(((X,A)=>{const $=t.getMeshByName(X);if($){const t=`${k}${A+1}`,X=0===A?V:V.instantiateHierarchy();X&&(X.name=t,X.parent=$,X.rotationQuaternion=null,X.rotation.set(0,0,0),X.position.set(0,0,0),K.push(X))}}))}return K}(I,C,[t]),E=y[0],_=FX(E,(t=>t.endsWith(FV.PlaceHolderPrefix))),p=FX(E,(t=>t.endsWith(sV.PlaceHolderPrefix))),L=F,O=R;O.parent=_.parent,O.position.copyFrom(_.position),O.rotation.copyFrom(_.rotation),L.parent=p.parent,L.position.copyFrom(p.position),L.rotation.copyFrom(p.rotation),p.setEnabled(!1),_.setEnabled(!1);const r=FX(E,(t=>t.endsWith(RV.PlaceHolderPrefix))),z=s;if(z.getChildMeshes(!1,(t=>t.name.endsWith(ZV.HighlightPrefix))).forEach((t=>{e.makeMeshDisable(t)})),z.parent=r.parent,z.position.copyFrom(r.position),z.rotation.copyFrom(r.rotation),k){(function(t,V){const X=e.getMeshSize(t);t.scaling.x=V,t.scaling.z=V,t.position.z-=X.z*(1-V)})(z,K);const t=FX(C,(t=>t.endsWith(yV.Label))),X=FX(C,(t=>t.endsWith(EV.Label)));t.scaling=new G.Pq(.75,1,.75),t.position.x+=.06,X.scaling=new G.Pq(.75,1,.75),X.position.x-=.06;const k=FX(C,(t=>t.endsWith(DV.RightScorePortrait))),A=FX(C,(t=>t.endsWith(DV.LeftScorePortrait)));A.position.copyFrom(t.position),A.position.z=qX(V,t,A.position.z),k.position.copyFrom(X.position),k.position.z=qX(V,X,k.position.z)}c.parent=r.parent,FX(E,(t=>CX(t,WV.PlaceholderPrefix))).isVisible=!1,$({table:E})}})}(function(t){t["Prefix"]="bowl",t["TopName"]="bowl_top",t["TopContainerName"]="bowl_top_dummy",t["BottomName"]="bowl_bottom",t["PlaceHolderPrefix"]="position-bowl"})(mC||(mC={}));var WC=X(371020),ZC=X(654550);const DC=new G.Pq(0,-.005,0),yC=G.Pq.Zero(),EC=5;class _C{constructor(t){this.elements={},this.props=t}dispose(){for(const t of Object.values(this.elements))t.dispose()}addElement(t,V){const X=this.props.createMultiplierBubble({id:t});X.mesh.parent=V,X.show(),this.elements[t]=X}}class pC extends e.HTMLMesh{getPositionOnScreen(){const t=super.getPositionOnScreen(),V=A.getReverseScale();return new G.Pq(t.x/V,t.y/V,t.z)}}class LC extends pC{getNamePrefix(){return"MultiplierBubbleMesh"}}function OC(t,V){return t.parent=V.node.parent,t.rotation.copyFrom(V.rotation),t.position.copyFrom(V.position),t.scaling.copyFrom(V.scaling),t.computeWorldMatrix(!0),t}const rC={easingFunc:new WC.vm,easingMode:WC.KA.EASINGMODE_EASEINOUT};function zC(t,V,X,K={}){return function(t,V,X,K={}){const k={position:V.position};return V.rotation&&(k.rotation=V.rotation),e.tweenToPromise({target:t,props:k},X,K)}(t,V,X,{...rC,...K})}var wC=X(633727);const bC="container";function aC(t){return new wC.V(`${bC}-${t}`)}const uC=new G.Pq(0,-Math.PI,0),jC=new G.Pq(0,Math.PI,0),xC=new G.Pq(0,.5*Math.PI,0),eC=new G.Pq(0,.5*-Math.PI,0),YC=.3,HC=.5;class hC{constructor(t){this.props=t,this.inTangentRiffleMove=new G.Pq(0,.1,0),this.rightRiffleOffsetY=new G.Pq(0,.001,0),this.deckRotationForCutting=new G.Pq(.5*-Math.PI,.5*Math.PI,0),this.canceled=!1,this.riffleDecksAnimations=[],this.bottomPartContainer=aC("shuffle_decks_bottom"),this.topPartContainer=aC("shuffle_decks_top"),this.discardContainer=aC("shuffle_discard"),this.centralRiffleDeckTop=new G.Pq(0,this.props.riffleDecks[0].size.y,0),this.deckPositionForCutting=new G.Pq(.5*this.props.straightDecks.total.fullDeckSize.y,.5*this.props.straightDecks.total.fullDeckSize.z,0)}async playShuffleAnimation(t){this.canceled=!1;const V=this.props.riffleDecks[0],X=V.size,{centre:K,riffleSplit:k,riffle:A,cutCardsPositions:$}=this.props.placeholders,{shoe:I,holder:C}=this.props,{cutCards:n}=this.props;if(this.positionAssembleStraightDecks(),I.detachFrontCutCard(),OC(n.front,$.front),e.changeVisibility(n.front,!0,!0),t)I.setCardCount(0),C.setCardCount(0),I.detachBackCutCard(),OC(n.back,$.back),e.changeVisibility(n.back,!0,!0),this.topPartContainer.parent=A.left.node.parent,this.topPartContainer.position.copyFrom(A.left.position),this.topPartContainer.rotation.copyFrom(A.left.rotation),this.bottomPartContainer.parent=A.right.node.parent,this.bottomPartContainer.position.copyFrom(A.right.position),this.bottomPartContainer.rotation.copyFrom(A.right.rotation.add(eC)),this.attachRiffleDecksToSplitContainers(),await nI(500);else{if(this.topPartContainer.parent=K.node.parent,this.bottomPartContainer.parent=K.node.parent,this.topPartContainer.position.copyFrom(K.position),this.topPartContainer.rotation.set(0,0,0),this.bottomPartContainer.position.copyFrom(K.position),this.bottomPartContainer.rotation.set(0,0,0),this.topPartContainer.position.y+=X.y*this.props.riffleDecks.length*.5,this.discardContainer.parent=K.node.parent,this.discardContainer.setAbsolutePosition(this.props.holder.absoluteDeckPosition),this.discardContainer.rotation.copyFrom(this.props.holder.holderRotation),this.addDecksInDiscardContainer(this.props.riffleDecks,X),await C.setCardCount(0),await I.flyOutDeck(e.localToGlobal(K.position,K.node.parent),K.rotation),this.props.sounds.playDeckDropOnCloth(),this.positionFirstRiffleDeck(V.deck,K,X),await Promise.all([zC(V.deck,{position:K.position},.1),I.hideDeck()]),this.canceled)return;if(I.detachBackCutCard(),OC(n.back,$.back),n.back.position.copyFrom(K.position),n.back.isVisible=!0,await zC(n.back,{position:$.back.position},.4,{onStart:this.props.sounds.playCuttingCardOut}),await zC(this.discardContainer,{position:K.position.add(this.centralRiffleDeckTop),rotation:K.rotation},.5,{onComplete:this.props.sounds.playDeckDropOnDeck}),this.canceled)return;this.attachRiffleDecksToSplitContainers(),await(q=this.topPartContainer,R=this.bottomPartContainer,F=k,s=YC,S={onStart:this.props.sounds.playMoveDeckShort},Promise.all([zC(q,{position:F.left.position},s,S),zC(R,{position:F.right.position},s)])),await Promise.all([zC(this.topPartContainer,{position:A.left.position,rotation:A.left.rotation},YC,{onStart:this.props.sounds.playMoveDeckShort}),zC(this.bottomPartContainer,{position:A.right.position,rotation:A.right.rotation.add(eC)},YC)])}var q,R,F,s,S;const c=.5*this.props.riffleDecks.length,N=this.props.riffleDecks.length-1,m=c-1;for(let t=0;t<c&&!this.canceled;t++)await this.shuffleRiffleDecks(this.props.riffleDecks[N-t],this.props.riffleDecks[m-t],0===t);this.canceled||(await zC(this.props.straightDecks.total,{position:K.position,rotation:K.rotation.add(xC)},YC,{onStart:this.props.sounds.playMoveDeckShort}),await zC(this.props.straightDecks.total,{position:K.position.add(this.deckPositionForCutting),rotation:this.deckRotationForCutting},HC,{onStart:this.props.sounds.playMoveDeck,onComplete:this.props.sounds.playDeckDropOnCloth}))}cancel(){this.canceled=!0,this.resetRiffleDecksAnimations();for(const t of this.props.riffleDecks)e.stopAnimationFor(t.deck,!1),e.stopAnimationFor(t.animation,!1),e.changeVisibility(t.deck,!1,!0);if(void 0!==this.runningTweensWithDelay){for(const t of this.runningTweensWithDelay)t.stop();this.runningTweensWithDelay=void 0}e.stopAnimationFor(this.props.straightDecks.total,!1),e.stopAnimationFor(this.props.straightDecks.right,!1),e.stopAnimationFor(this.props.straightDecks.left,!1),e.stopAnimationFor(this.props.cutCards.front,!1),e.stopAnimationFor(this.props.cutCards.back,!1),e.stopAnimationFor(this.topPartContainer,!1),e.stopAnimationFor(this.bottomPartContainer,!1),e.changeVisibility(this.props.straightDecks.total,!1,!0),e.changeVisibility(this.props.straightDecks.right,!1,!0),e.changeVisibility(this.props.straightDecks.left,!1,!0),e.changeVisibility(this.props.cutCards.front,!1,!0),e.changeVisibility(this.props.cutCards.back,!1,!0),this.props.shoe.attachFrontCutCard(this.props.cutCards.front)}addDecksInDiscardContainer(t,V){for(let X=1;X<t.length;X++){const{deck:K}=t[X];K.parent=this.discardContainer,K.position.set(0,V.y*(X-1),0),K.rotation.copyFrom(eC),e.changeVisibility(K,!0)}}positionAssembleStraightDecks(){const{deckAssemble:t}=this.props.placeholders,V=this.props.straightDecks.total;V.deckHeight=0,V.parent=t.node.parent,V.position.copyFrom(t.position),V.rotation.copyFrom(t.rotation),V.show()}positionSideStraightDecks(){const{riffleShuffle:t}=this.props.placeholders,V=this.props.straightDecks.left,X=this.props.straightDecks.right;V.parent=t.left.node.parent,V.position.copyFrom(t.left.position),V.rotation.copyFrom(t.left.rotation.add(jC)),X.parent=t.right.node.parent,X.position.copyFrom(t.right.position),X.rotation.copyFrom(t.right.rotation),V.deckHeight=0,X.deckHeight=0,X.show(),V.show()}positionFirstRiffleDeck(t,V,X){this.canceled||(t.parent=V.node.parent,t.position.copyFrom(V.position),t.position.y-=.5*X.y,t.rotation.copyFrom(eC),e.changeVisibility(t,!0))}attachRiffleDecksToSplitContainers(){const{riffleDecks:t}=this.props,V=.5*this.props.riffleDecks.length,X=this.props.riffleDecks.length-1,K=V-1;for(let k=0;k<V;k++){const A=K-k,$=t[X-k],I=t[A];$.deck.parent=this.topPartContainer,I.deck.parent=this.bottomPartContainer,$.deck.position.set(0,$.size.y*(V-k-1),0),I.deck.position.set(0,I.size.y*(V-k-1),0),$.deck.rotation.copyFrom(eC),I.deck.rotation.copyFrom(eC),e.changeVisibility($.deck,!0),e.changeVisibility(I.deck,!0)}}async shuffleRiffleDecks(t,V,X){const{straightDecks:K}=this.props,{centre:k,riffleSplit:A,riffleShuffle:$,deckAssemble:I}=this.props.placeholders;t.deck.setParent(A.left.node.parent),V.deck.setParent(A.right.node.parent),e.roundVectorTo(t.deck.scaling,3),e.roundVectorTo(V.deck.scaling,3),this.positionSideStraightDecks(),zC(t.deck,{position:A.left.position,rotation:G.Pq.ZeroReadOnly},YC),await zC(V.deck,{position:A.right.position,rotation:uC},YC,{onStart:this.props.sounds.playMoveDeckShort}),zC(t.deck,{position:$.left.position,rotation:$.left.rotation},YC,{inTangent:this.inTangentRiffleMove}),await zC(V.deck,{position:$.right.position,rotation:$.right.rotation.add(uC)},YC,{inTangent:this.inTangentRiffleMove,onStart:this.props.sounds.playMoveDeckShort});const C=t.size.y,n=2*C;this.props.sounds.playRiffle(),this.playSkeletonAnimation(t.animation,V.animation),await new Promise((X=>{this.runningTweensWithDelay=[e.tweenTo({target:t.deck,props:{position:$.left.position.add(new G.Pq(0,C,0))}},.4,{delay:YC}),e.tweenTo({target:V.deck,props:{position:$.right.position.add(new G.Pq(0,C,0))}},.4,{delay:YC}),e.tweenTo({target:K.left,props:{deckHeight:n}},.4,{delay:YC}),e.tweenTo({target:K.right,props:{deckHeight:n}},.4,{delay:YC,onComplete:()=>{this.runningTweensWithDelay=void 0,X(void 0)}})]})),e.changeVisibility(t.deck,!1),e.changeVisibility(V.deck,!1),zC(K.left,{position:k.position,rotation:k.rotation.add(jC)},HC),await zC(K.right,{position:k.position.add(this.rightRiffleOffsetY),rotation:k.rotation},HC,{onStart:this.props.sounds.playMoveDeck}),K.left.hide();const q=X?{onStart:this.props.sounds.playMoveDeck}:{inTangent:new G.Pq(0,-.02,0),outTangent:G.Pq.Zero(),onComplete:this.props.sounds.playDeckDropOnDeck};await zC(K.right,{position:I.position.add(new G.Pq(0,K.total.deckHeight,0)),rotation:I.rotation},HC,q),K.right.hide(),K.total.addToHeight(K.right.deckHeight)}playSkeletonAnimation(t,V){this.riffleDecksAnimations=[t.getScene().beginAnimation(t,0,e.getSkeletonAnimationLength(t)),V.getScene().beginAnimation(V,0,e.getSkeletonAnimationLength(V))]}resetRiffleDecksAnimations(){this.riffleDecksAnimations.forEach((t=>{t.goToFrame(0)})),this.riffleDecksAnimations=[]}}function TC(t){const V=[];for(let X=0;X<KV.cr;X++){const K=e.getMeshByName(CV(SV.ClonePrefix,X),t),k=FX(K,(t=>t.endsWith(SV.AnimationPrefix))).skeleton;k&&V.push({deck:K,size:e.getMeshSize(K,!0),animation:k})}return V}function PC(t){return{node:t,position:t.position.clone(),rotation:t.rotation.clone(),scaling:t.scaling.clone()}}function QC(t,V){const X=FX(V,(t=>CX(t,nV.Prefix))),K=FX(X,(t=>CX(t,NV.DiscardPilePrefix))),k=FX(X,(t=>t.endsWith(vV.FrontPrefix))),A=FX(X,(t=>t.endsWith(vV.BackPrefix))),$=FX(X,(t=>t.endsWith(vV.BackPlaceholderPrefix))),I=PC(FX(X,(t=>t.endsWith(vV.FrontPlaceholderPrefix)))),C=PC($);return C.position=C.position.add(new G.Pq(0,-.004,0)),{cutCards:{front:k,back:A},placeholders:{deckAssemble:(n=FX(X,(t=>t.endsWith(mV.AssemblePlaceholderPrefix))),{node:n,position:n.position,rotation:n.rotation,scaling:n.scaling}),riffleShuffle:{left:PC(FX(X,(t=>t.endsWith(mV.ShuffleLeftPlaceholderPrefix)))),right:PC(FX(X,(t=>t.endsWith(mV.ShuffleRightPlaceholderPrefix))))},riffleSplit:{left:PC(FX(X,(t=>t.endsWith(mV.SplitLeftPlaceholderPrefix)))),right:PC(FX(X,(t=>t.endsWith(mV.SplitRightPlaceholderPrefix))))},riffle:{left:PC(FX(X,(t=>t.endsWith(mV.LeftPlaceholderPrefix)))),right:PC(FX(X,(t=>t.endsWith(mV.RightPlaceholderPrefix))))},centre:PC(K),cutCardsPositions:{front:I,back:C}}};var n}var JC,UC=X(615473);class lC extends wC.V{constructor(t,V=Math.PI/2,X){super(`cardDeck:${t.name}`),this.deckMesh=t,this.visible=!0,this.updateClipPlane=()=>{this.clipPlane=G.Zc.FromPositionAndNormal(e.localToGlobal(this.cutPosition,this),G.Pq.TransformNormal(G.Pq.Down(),this.getWorldMatrix()))},this.setPlane=()=>{this.deckSelectAsActiveMeshState=this.deckMesh.alwaysSelectAsActiveMesh,this.deckSelectAsActiveMeshState&&(this.deckMesh._unFreeze(),this.deckMesh.alwaysSelectAsActiveMesh=!1),this.getScene().clipPlane=this.clipPlane},this.removePlane=()=>{this.getScene().clipPlane=null,void 0!==this.deckSelectAsActiveMeshState&&this.deckSelectAsActiveMeshState!==this.deckMesh.alwaysSelectAsActiveMesh&&(this.deckMesh.alwaysSelectAsActiveMesh=this.deckSelectAsActiveMeshState)},t.computeWorldMatrix(!0),e.copyInfoFromMesh(t,this),this.deckMesh.parent=this,this.deckMesh.rotation.set(0,V,0),this.deckMesh.scaling.set(1,1,1),this.deckMesh.position.set(0,0,0),this.onAfterWorldMatrixUpdateObservable.add(this.updateClipPlane),this.deckMesh.onBeforeRenderObservable.add(this.setPlane),this.deckMesh.onAfterRenderObservable.add(this.removePlane),this.cutPosition=G.Pq.Zero(),this.deckSize=e.getMeshSize(t,!0),this.maxDeckHeight=UC.X.Clamp(X||this.deckSize.y,0,this.deckSize.y),this.currentDeckHeight=this.maxDeckHeight}addToHeight(t){this.deckHeight=this.currentDeckHeight+t}setHeightByPercent(t){this.deckHeight=this.maxDeckHeight*t}get deckHeight(){return this.currentDeckHeight}set deckHeight(t){this.currentDeckHeight=UC.X.Clamp(t,0,this.maxDeckHeight),this.updateClipPlane(),this.deckMesh.position.y=this.currentDeckHeight-this.deckSize.y,this.visible&&e.changeVisibility(this,0!==this.currentDeckHeight,!0)}get fullDeckSize(){return this.deckSize}get deck(){return this.deckMesh}show(){this.visible=!0,e.changeVisibility(this,0!==this.currentDeckHeight,!0)}hide(){this.visible=!1,e.changeVisibility(this,!1,!0)}}function iC(t){return{left:new lC(e.getMeshByName(CV(cV.ClonePrefix,0),t)),total:new lC(e.getMeshByName(CV(cV.ClonePrefix,1),t)),right:new lC(e.getMeshByName(CV(cV.ClonePrefix,2),t))}}class GC{constructor(t){this.props=t;const V=iC(t.scene);this.straightDecks=V;const X=TC(t.scene),K=t.tableInfo,k=QC(t.scene,K.table);K.shoe.attachFrontCutCard(k.cutCards.front),K.shoe.attachBackCutCard(k.cutCards.back),this.shuffleBurnData=k,this.deckShuffleAnimation=new hC({shoe:K.shoe,holder:K.cardHolder,straightDecks:V,riffleDecks:X,sounds:{playRiffle:this.props.sounds.playRiffleSound,playCuttingCardOut:t.sounds.playCutCardOutOfDeckSound,playDeckDropOnCloth:t.sounds.playCutCardOutOfDeckSound,playDeckDropOnDeck:t.sounds.playDeckDropOnDeckSound,playMoveDeck:t.sounds.playMoveDeckSound,playMoveDeckShort:t.sounds.playMoveDeckShortSound},...k}),this.deckCutAnimationData={shoe:K.shoe,holder:K.cardHolder,straightDecks:V,...k}}}class dC{constructor(t){this.props=t;const V=iC(t.scene);this.straightDecks=V;const X=TC(t.scene),K=t.tableManager.table,k=QC(t.scene,K.table);K.shoe.attachFrontCutCard(k.cutCards.front),K.shoe.attachBackCutCard(k.cutCards.back),this.dataByTables={shuffleBurnData:k,deckShuffleAnimation:new hC({shoe:K.shoe,holder:K.cardHolder,straightDecks:V,riffleDecks:X,sounds:{playRiffle:t.sounds.playRiffleSound,playCuttingCardOut:t.sounds.playCutCardOutOfDeckSound,playDeckDropOnCloth:t.sounds.playCutCardOutOfDeckSound,playDeckDropOnDeck:t.sounds.playDeckDropOnDeckSound,playMoveDeck:t.sounds.playMoveDeckSound,playMoveDeckShort:t.sounds.playMoveDeckShortSound},...k}),deckCutAnimationData:{shoe:K.shoe,holder:K.cardHolder,straightDecks:V,...k}}}get shuffleBurnData(){return this.dataByTables.shuffleBurnData}get deckShuffleAnimation(){return this.dataByTables.deckShuffleAnimation}get deckCutAnimationData(){return this.dataByTables.deckCutAnimationData}}(function(t){t["Table01"]="table01"})(JC||(JC={}));var MC=X(10783);const BC="selected-stack-cylinder",oC="chipstack_glow",fC=5;class gC extends MC.pl{updatePosition(t){this.ring.position=t,this.ring.position.y+=.001}show(){this.ring.isVisible=!0}hide(){this.ring.isVisible=!1}initMesh(t,V,X){if(this.ring)return;const K=FX(V.getScene(),(t=>t===oC)).clone();K.name=`${X}.${BC}`,K.scaling.setAll(155),K.isVisible=!1;const k=K.material;k.diffuseColor=G.v9.Black(),k.emissiveColor=G.v9.FromInts(252,226,86),k.opacityTexture&&(k.opacityTexture.level=1.5),K.parent=V,this.ring=K}updateHighlightHeight(t,V){const X=230/t*Math.max(V,fC);this.ring.scaling.y!==X&&(this.ring.scaling.y=X)}}function tn(t,V={}){const X=Math.min(...Object.keys(t).map((t=>Number(t))));return async(K,k,A)=>{await Promise.all(k.reverse().map(((k,$)=>{var I;return async function(t,V,X){const K=e.globalToLocal(V,t.mesh.parent).subtract(t.mesh.position);await e.tweenToPromise({target:t.mesh,props:{position:t.mesh.position.add(K),rotation:Vn},settings:{easingFunc:new WC.fA,easingMode:WC.KA.EASINGMODE_EASEIN,inTangent:kn,outTangent:An}},Xn,X)}(K[$],null!==(I=t[k])&&void 0!==I?I:t[X],{...V,onComplete:()=>{A&&A(),V.onComplete&&V.onComplete()}})})))}}const Vn=new G.Pq(0,e.FullCircle,0),Xn=.5,Kn=.003/Xn,kn=new G.Pq(0,-Kn,0),An=new G.Pq(0,Kn,0);class $n extends e.ChipStack{constructor(t){t.group=e.ChipGroup.Moving,super(t),this.props=t,this.renderingGroupId=1}async moveToChipStack(t){await this.props.moveToChipStack(this.getChips(),this.getChipAmounts(),t)}}var In;(function(t){t["Winning"]="winning",t["Bet"]="bet",t["Flying"]="flying"})(In||(In={}));const Cn=t=>V=>{const{availableAmounts:X,scale:K,winningPositionOffset:k,chipSelector:A,animationSettings:$}=t,{name:I,parent:C,chipStackType:n}=V,q=new $n({name:`chipStack-${I}-${n}`,chipAmounts:X,parent:C,labels:n===In.Flying?e.ChipStackLabel.Standard:e.ChipStackLabel.TotalAmount,scale:K,moveToChipStack:tn(A.getChipStackPositions(),$)});return n===In.Winning&&(q.position=q.position.add(k)),q},nn=1,qn=165;function Rn(t){return t?.8*nn:nn}var Fn=X(938480),sn=X(635141),Sn=X(837557);const cn=.3,Nn=0,mn=.015,vn=.083;var Wn,Zn,Dn;(function(t){t["Idle"]="Idle",t["Hover"]="Hover",t["Bet"]="Bet",t["Multiplied"]="Multiplied",t["Win"]="Win"})(Wn||(Wn={})),function(t){t["Red"]="red",t["Yellow"]="yellow"}(Zn||(Zn={}));class yn{static generateVersion(){return Date.now()}constructor(t){var V;this.amount=0,this.winningAmount=0,this.locked=!1,this.lockChangeHighlight=!1,this.interactions=!1,this.flyingChipsTweens=[],this.version=yn.generateVersion(),this.onDrag=(t,V)=>{var X,K;this.dragActionCallback&&(this.stopFlyingAnimation(),t===e.DragState.Start?(null===(X=this.betSpotHighlight)||void 0===X||X.setHighlight(Wn.Hover),this.isDragHappening=!0):t===e.DragState.End&&((null==V?void 0:V.pickedMesh)===this.trigger&&(null===(K=this.betSpotHighlight)||void 0===K||K.setHighlight(Wn.Bet)),this.isDragHappening=!1),this.dragActionCallback(t,this.spotName,V))},this.updateChipAmount=(t,V)=>{(V>=this.version||0===t)&&(this.version=V,this.chips.setAmount(t))},this.props=t,this.spotName=t.spotName,this.trigger=FX(this.props.mesh,(t=>CX(t,ZV.HighlightPrefix))),this.trigger.metadata={cursor:CK.Default},this.isDragHappening=!1,this.trigger.setEnabled(!0),this.trigger.isVisible=!0,this.onTap=this.onTap.bind(this),this.onHover=this.onHover.bind(this),this.chips=this.props.createChipStack({chipStackType:In.Bet,name:this.props.spotName,parent:null!==(V=this.props.chipStackPlaceholder)&&void 0!==V?V:this.props.mesh}),this.chips.addShadowLight(this.props.shadowLightName),this.interactions=t.interaction}get mesh(){return this.props.mesh}async setAmount(t=0,V=!1){var X;const K=xX.J0.subtract(t,this.amount),k=yn.generateVersion();this.amount!==t&&(this.amount=t,V?await this.performFlyingToBetSpotIfNeeded(K,this.updateChipAmount.bind(this,t,k)):this.updateChipAmount(t,k)),this.lockChangeHighlight||null===(X=this.betSpotHighlight)||void 0===X||X.setHighlight(this.amount>0?Wn.Bet:Wn.Idle)}setLocked(t,V=!1){(t!==this.locked||V)&&(this.locked=t,this.setCursor(t?CK.Default:CK.Pointer))}setCursor(t){this.trigger.metadata&&(this.trigger.metadata.cursor=null!=t?t:CK.Default)}async setWinning(t=0,V){var X,K,k,A,$,I;if(this.winningAmount!==t&&(this.winningAmount=t,t&&(this.winningChipStack?this.winningChipStack.setAmount(t):(this.lockChangeHighlight=!0,this.winningChipStack=this.props.createChipStack({chipStackType:In.Winning,name:this.props.spotName,parent:null!==(X=this.props.chipStackPlaceholder)&&void 0!==X?X:this.props.mesh}),this.winningChipStack.setAmount(t),this.winningChipStack.addShadowLight(this.props.shadowLightName),this.winningChipStackBase=this.props.createChipStack({chipStackType:In.Bet,name:this.props.spotName,parent:null!==(K=this.props.chipStackPlaceholder)&&void 0!==K?K:this.props.mesh}),this.winningChipStackBase.setAmount(this.chips.getAmount()),this.winningChipStackBase.addShadowLight(this.props.shadowLightName),this.setAmount(0,!1)),this.winCallback=V),!t&&this.winningChipStack&&this.winningChipStackBase)){const t=this.winningChipStack.getScene();this.lockChangeHighlight=!1,e.addShadowUpdateFor(t,this.props.shadowLightName),await Promise.all([null===(k=this.winningChipStack)||void 0===k?void 0:k.moveToChipStack(this.winCallback),null===(A=this.winningChipStackBase)||void 0===A?void 0:A.moveToChipStack()]),e.removeShadowUpdateFor(t,this.props.shadowLightName),e.removeMeshFromShadowGenerator(this.winningChipStack,this.props.shadowLightName),null===($=this.winningChipStack)||void 0===$||$.dispose(),this.winningChipStack=void 0,e.removeMeshFromShadowGenerator(this.winningChipStackBase,this.props.shadowLightName),null===(I=this.winningChipStackBase)||void 0===I||I.dispose(),this.winningChipStackBase=void 0,this.winCallback=void 0,this.setAmount()}}setPulsing(t){var V;null===(V=this.betSpotHighlight)||void 0===V||V.setHighlight(t?Wn.Win:Wn.Idle)}setHighlightSpot(t,V){var X;null===(X=this.betSpotHighlight)||void 0===X||X.setHighlight(t,null==V?void 0:V.force,V)}setPickable(t){this.trigger.isPickable=t}setInteractions(t){this.interactions=t}dispose(){var t,V,X,K;this.setLocked(!1,!0),this.trigger.setEnabled(!1),this.setPickable(!1),this.trigger.isVisible=!1,null===(t=this.chips)||void 0===t||t.dispose(),null===(V=this.winningChipStack)||void 0===V||V.dispose(),null===(X=this.winningChipStackBase)||void 0===X||X.dispose(),null===(K=this.betSpotHighlight)||void 0===K||K.dispose(),this.tapAction&&(e.removeAction(this.trigger,this.tapAction),this.tapAction=void 0,this.tapActionCallback=void 0),this.hoverAction&&(e.removeAction(this.trigger,this.hoverAction),this.hoverAction.destroy(),this.hoverAction=void 0,this.hoverActionCallback=void 0),this.dragAction&&(e.removeAction(this.trigger,this.dragAction),this.dragAction.destroy(),this.dragAction=void 0,this.dragActionCallback=void 0)}addTapAction(t){this.tapActionCallback=t,this.tapAction=new sn.FH(Fn.m.OnPickUpTrigger,(()=>{this.onTap(e.TapState.End)})),e.addAction(this.trigger,this.tapAction)}addHoverAction(t){this.hoverActionCallback=t,this.hoverAction=new e.Hover({callback:this.onHover,target:this.trigger,DS:this.props.DS}),e.addAction(this.trigger,this.hoverAction)}addDragAction(t){this.dragActionCallback=t;const V=function({target:t,chipStack:V,onDrag:X,limitDraggingChipsPosition:K,hasChips:k,getDragAllowed:A}){let $,I=!1,C=!1;return(n,q,R,F)=>{if(!A())return;const s=null==R?void 0:R.ray;switch(n){case e.DragState.Start:if((null==F?void 0:F.button)!==Nn)return;I=!0,s&&($=e.getPointWhereRayIntersectsPlane(s,t.position,G.Pq.UpReadOnly));break;case e.DragState.Move:if(I){if(!C&&$&&V&&k()&&s){const V=e.getPointWhereRayIntersectsPlane(s,t.position,G.Pq.UpReadOnly);G.Pq.Distance($,V)>mn&&(C=!0,X(e.DragState.Start))}if(C&&s&&V){const X=t.getAbsolutePosition(),k=e.getPointWhereRayIntersectsPlane(s,X,G.Pq.UpReadOnly),A=K(k),$=t.getScene().cameras[0].position,I=G.Pq.Distance($,A),C=G.Pq.Lerp($,A,(I-vn)/I);V.setAbsolutePosition(C)}}break;case e.DragState.End:C&&X(e.DragState.End,R||void 0),I=!1,C=!1,V.position=G.Pq.Zero();break;case e.DragState.Cancel:C&&X(e.DragState.Cancel),I=!1,C=!1,V.position=G.Pq.Zero()}}}({target:this.trigger,chipStack:this.chips,onDrag:this.onDrag,limitDraggingChipsPosition:this.props.limitDraggingChipsPosition,hasChips:()=>this.chips.getChips().length>0||this.flyingChipsTweens.length>0,getDragAllowed:()=>this.interactions});this.dragAction=new e.TapDrag({callback:V,target:this.trigger,DS:this.props.DS}),e.addAction(this.trigger,this.dragAction)}setHighlight(t){this.betSpotHighlight=t(this.trigger)}updateOrientation(t){var V;null===(V=this.betSpotHighlight)||void 0===V||V.updateOrientation(t)}updateTooltip(t){this.props.tooltip.updateContentProps(t)}setTooltipState(t){t?this.props.tooltip.show():this.props.tooltip.hide()}getTooltipState(){return this.props.tooltip.isVisible()}onTap(t){t===e.TapState.End&&this.tapActionCallback&&this.tapActionCallback(this.props.spotName)}onHover(t){var V;this.interactions&&((0===this.amount&&Sn.DS.IS_DESKTOP||this.isDragHappening)&&(null===(V=this.betSpotHighlight)||void 0===V||V.setHighlight(t===e.HoverState.Over&&this.interactions&&!this.locked?Wn.Hover:Wn.Idle)),this.hoverActionCallback&&this.hoverActionCallback(this.props.spotName,t))}performFlyingToBetSpotIfNeeded(t,V){return new Promise((X=>{const K=t<this.props.chipAmounts[0]?this.props.chipAmounts[0]:t,k=this.getFlyingChips(K);k.length&&(this.chipHeight||(this.chipHeight=e.getMeshSize(k[0].mesh,!0).y),this.flyingChipsTweens.push(this.flyChipsToBetSpot(k,this.amount-t,(()=>{V&&V(),this.mesh.getScene().executeWhenReady((()=>{X()}))}))))}))}flyChipsToBetSpot(t,V,X){var K,k;const A=this.props.chipSelector.getChipStackTopChipsPositions(),$=new G.Pq(0,this.chipHeight,0);t.forEach((t=>{const V=t.getAmount();V&&A[String(V)]&&(t.mesh.position=A[String(V)].addInPlace($))}));const I=this.chips.getAbsolutePosition(),C=e.calculateChipsForAmount(V,this.props.chipAmounts),n=I.add(new G.Pq(0,C.length*(null!==(K=this.chipHeight)&&void 0!==K?K:0),0));return function(t,V,X,K){return e.tweenTo(t.map(((t,K)=>({target:t.mesh,props:{position:V.add(new G.Pq(0,X*(K+1),0))}}))),cn,{easingFunc:new WC.fA,easingMode:WC.KA.EASINGMODE_EASEINOUT,onComplete:K,onCancel:K})}(t,n,null!==(k=this.chipHeight)&&void 0!==k?k:0,(()=>{X(),t.forEach((t=>{t.dispose()}))}))}getFlyingChips(t){const V=this.props.createChipStack({chipStackType:In.Flying,name:this.props.spotName,parent:this.props.chipSelector.mesh});V.setAmount(t);const X=V.detachChips().reverse();return V.dispose(),X}stopFlyingAnimation(){this.flyingChipsTweens.forEach((t=>{t.stop()})),this.flyingChipsTweens=[]}}class En{constructor(t){this.activeGrid=null,this.activeGridType=null,this.interactions=!1,this.props=t,this.grids=this.props.grids.getChildMeshes(!0).reduce(((t,V)=>(t[V.name.split(".").pop()]=V,V.setEnabled(!1),t)),{})}get grid(){return this.activeGrid}get gridType(){return this.activeGridType}set gridType(t){this.activeGridType=t}getMultiplierContainer(){var t;if(null===(t=this.activeGrid)||void 0===t?void 0:t.spots)return Object.values(this.activeGrid.spots).map((t=>t.mesh))}dispose(t=!1){var V,X;if(null===(V=this.activeGrid)||void 0===V?void 0:V.spots){for(const t of Object.values(this.activeGrid.spots))t.dispose();this.activeGrid.spots=void 0}t&&(null===(X=this.activeGrid)||void 0===X||X.mesh.setEnabled(!1),this.activeGrid=null)}setInteractions(t){var V;if(this.interactions=t,null===(V=this.activeGrid)||void 0===V?void 0:V.spots)for(const t of Object.values(this.activeGrid.spots))t.setInteractions(this.interactions)}setPickable(t){var V;if(null===(V=this.activeGrid)||void 0===V?void 0:V.spots)for(const V of Object.values(this.activeGrid.spots))V.setPickable(t)}getSpots(){var t;return null===(t=this.activeGrid)||void 0===t?void 0:t.spots}setupBettingGrid(t){var V;const{type:X,options:K}=t;this.grids[X]!==(null===(V=this.activeGrid)||void 0===V?void 0:V.mesh)&&(this.dispose(!0),this.activeGrid={mesh:this.grids[X]},this.activeGridType=X,this.activeGrid.mesh.setEnabled(!0),this.props.draggingPositionLimiter.setActiveGrid(this.activeGrid.mesh),K&&this.setupBettingGridSpots(K))}setupBettingGridSpots(t){const{actions:V,tooltipManager:X,chipAnimationSettings:K,highlightMaterialFactory:k}=t;if(this.activeGrid){const t=this.activeGrid.mesh.name;this.activeGrid.spots=this.activeGrid.mesh.getChildMeshes(!0).reduce(((A,$)=>{const I=$.name.split(".").pop(),C=X.addTooltip({id:`tooltip-${t}-${I}`,parent:$,content:{label:""},autoHide:!0}),n=e.getChildByName($,`${I}.${ZV.ChipStackOnSpotPlaceholder}`),q=new yn({mesh:$,chipStackPlaceholder:n,spotName:I,createChipStack:Cn({availableAmounts:this.props.chipAmounts,scale:this.props.scale,chipSelector:this.props.chipSelector,animationSettings:K,winningPositionOffset:this.props.winningChipStackPosition[I]||this.props.winningChipStackPosition.default}),tooltip:C,DS:this.props.DS,chipSelector:this.props.chipSelector,chipAmounts:this.props.chipAmounts,shadowLightName:this.props.shadowLightName,limitDraggingChipsPosition:this.props.draggingPositionLimiter.limitPosition.bind(this.props.draggingPositionLimiter),interaction:this.interactions});return q.addHoverAction(V.hover),q.addTapAction(V.tap),q.addDragAction(V.drag),q.setHighlight(k),q.setPickable(!0),A[I]=q,A}),{})}}setHighlightMaterialFactory(t){var V;(null===(V=this.activeGrid)||void 0===V?void 0:V.spots)&&Object.keys(this.activeGrid.spots).map((V=>{var X,K,k;return null===(k=null===(K=null===(X=this.activeGrid)||void 0===X?void 0:X.spots)||void 0===K?void 0:K[V])||void 0===k?void 0:k.setHighlight(t)}))}}class _n{limitPosition(t){if(!this.gridMesh||!this.max||!this.min)return t;const V=G.Pq.Clamp(e.globalToLocal(t,this.gridMesh),this.min,this.max);return e.localToGlobal(V,this.gridMesh)}setActiveGrid(t){this.gridMesh=t,this.recomputeBoundaries()}setAdditionalOffset(t,V){this.offsetMax=t,this.offsetMin=V,this.recomputeBoundaries()}recomputeBoundaries(){if(!this.gridMesh)return;const{maximum:t,minimum:V}=this.gridMesh.getBoundingInfo();this.max=this.offsetMax?t.add(this.offsetMax):t,this.min=this.offsetMin?V.add(this.offsetMin):V}}(function(t){t["TopLeft"]="TopLeft",t["TopRight"]="TopRight",t["BottomLeft"]="BottomLeft",t["BottomRight"]="BottomRight"})(Dn||(Dn={}));const pn=.5*Math.PI,Ln=.5*Math.PI,On=Math.PI,rn=7e-4,zn=.3,wn=.4,bn=.1,an=.1,un=.2,jn=.5;class xn{constructor(t,V,X,K){this.node=t,this.playCardsInHolderSound=X,this.cardCount=0,this.pilePosition=G.Pq.Zero(),this.cards=new lC(FX(t,(t=>t.endsWith(sV.DeckPrefix))),Math.PI,V),this.cards.hide(),K&&K([t,this.cards.deck])}setCardCount(t){this.cardCount=t,this.cards.setHeightByPercent(this.cardCount>0?this.cardCount/KV.AN:0),this.cardCount>0?this.cards.show():this.cards.hide()}async animateCardsToHolder(t,V,X,K){this.pilePosition.copyFrom(this.node.position),this.pilePosition.y=this.node.position.y+this.cards.position.y+this.cards.deckHeight;const k=V*rn;await function(t,V,X,K,k=!0,A=wn){const $=k?X.add(new G.Pq(0,V,0)):X;return e.tweenToPromise({target:t,props:{position:$,"rotation.y":K.y,"rotation.x":k?Math.PI:0}},A,{easingFunc:new WC.E8,easingMode:WC.KA.EASINGMODE_EASEINOUT,inTangent:new G.Pq(0,-.03,0),outTangent:new G.Pq(0,.03,0)})}(t,k,this.pilePosition,this.node.rotation,K,X),this.playCardsInHolderSound(),this.setCardCount(this.cardCount+V)}get absoluteDeckPosition(){return e.localToGlobal(this.cards.position,this.cards.parent)}get holderRotation(){return this.node.rotation}}var en,Yn,Hn,hn=X(765198),Tn=X(384511),Pn=X(670723);(function(t){t["ClientBetChip"]="CLIENT_BET_CHIP",t["ClientShortcutDeleteUndo"]="CLIENT_SHORTCUT_DELETE_UNDO",t["ClientShortcutUndoAll"]="CLIENT_SHORTCUT_DELETE_CLEARALL",t["ClientShortcutSpaceBarStartRound"]="CLIENT_SHORTCUT_SPACEBAR_START_ROUND",t["ClientShortcutSpaceBarRebet"]="CLIENT_SHORTCUT_SPACEBAR_REBET",t["ClientShortcutSpaceBarRepeat"]="CLIENT_SHORTCUT_SPACEBAR_REPEAT",t["ClientShortcutCMDZ"]="CLIENT_SHORTCUT_CMD_Z",t["ClientShortcutCTRLZ"]="CLIENT_SHORTCUT_CTRL_Z",t["ClientShortcutChip"]="CLIENT_SHORTCUT_CHIP"})(en||(en={})),function(t){t["KeyDown"]="keydown"}(Yn||(Yn={})),function(t){t[t["One"]=49]="One",t[t["Two"]=50]="Two",t[t["Three"]=51]="Three",t[t["Four"]=52]="Four",t[t["Five"]=53]="Five",t[t["Six"]=54]="Six",t[t["Seven"]=55]="Seven",t[t["Eight"]=56]="Eight",t[t["Nine"]=57]="Nine",t[t["Backspace"]=8]="Backspace",t[t["Esc"]=27]="Esc",t[t["Space"]=32]="Space",t[t["Del"]=46]="Del",t[t["Z"]=90]="Z"}(Hn||(Hn={}));const Qn=3e3,Jn={};class Un{static hashCode(t,V){return t+"-"+(V.has("ctrl")?"1":"0")+(V.has("meta")?"1":"0")+(V.has("shift")?"1":"0")+(V.has("alt")?"1":"0")}static hashCodeFromEvent(t){return t.keyCode+"-"+(t.ctrlKey?"1":"0")+(t.metaKey?"1":"0")+(t.shiftKey?"1":"0")+(t.altKey?"1":"0")}constructor(t,V){this.listeners=[],this.keyCode=t,this.options=V,this.preventDefault=!V.has("executeDefault")}addListener(t,V,X,K){this.listeners.some((X=>X.context===V&&X.callBack===t))||this.listeners.push({callBack:t,context:V,inputEl:X,customData:K})}removeListener(t,V){let X=0;for(;X<this.listeners.length;){const K=this.listeners[X];K.context===V&&K.callBack===t?this.listeners.splice(X,1):X+=1}}withLongPress(t,V){return this.isLongPress=t,this.logLongPress=V,this}withLogPress(t,V){return this.logPress=t,this.logPressData=V,this}}function ln(t,...V){const X=new Set(V);Sn.DS.IS_MACOSX&&X.has("ctrl")&&(X.delete("ctrl"),X.add("meta")),X.has("macctrl")&&X.add("ctrl");const K=Un.hashCode(t,X);let k=Jn[K];return null==k?k=Jn[K]=new Un(t,X):k.preventDefault=!X.has("executeDefault"),k}class Gn{constructor(t){this.timeoutId=0,this.startPressTimeMS=0,this.handleKey=t=>{const V=Un.hashCodeFromEvent(t),X=Jn[V];if(!this.getBucketListeners(X).length)return;const K=new Set(["text-input-overlay-input","favorite-bets-name-input"]);let k="";t.target instanceof HTMLElement&&(k=t.target.dataset.role||""),(null==X?void 0:X.preventDefault)&&!K.has(k)&&(t.stopPropagation(),t.preventDefault()),this.startPressTimeMS||(this.startPressTimeMS=Date.now()),this.timeoutId&&(window.clearTimeout(this.timeoutId),this.currentHash&&this.currentHash!==V&&Jn[this.currentHash]&&this.handleKeyUp(Jn[this.currentHash]));const A=X.isLongPress?600:100;this.timeoutId=window.setTimeout((t=>this.handleKeyUp(t)),A,X),this.currentHash=V},this.keyPressListenerElement=t,this.logHandler=()=>{},this.clickHandler=()=>{}}dispose(){var t;null===(t=this.keyPressListenerElement)||void 0===t||t.removeEventListener(Yn.KeyDown,this.handleKey)}attachLogHandler(t){this.logHandler=t}attachClickHandler(t){this.clickHandler=t}enable(){this.keyPressListenerElement&&this.keyPressListenerElement.addEventListener(Yn.KeyDown,this.handleKey)}disable(){this.keyPressListenerElement&&this.keyPressListenerElement.removeEventListener(Yn.KeyDown,this.handleKey)}reset(){this.disable(),this.keyPressListenerElement=null,this.logHandler=()=>{},this.clickHandler=()=>{},this.timeoutId&&clearTimeout(this.timeoutId)}handleKeyUp(t){const V=this.getBucketListeners(t),X=Date.now(),K=((t,V)=>V-t>=Qn)(this.startPressTimeMS?this.startPressTimeMS:X,X),k=K&&t.logLongPress?t.logLongPress:t.logPress;this.clickHandler(),k&&this.logHandler(k,t.logPressData);for(const t of V){const{logEvent:V}=t.customData||{};V&&this.logHandler(V),t.callBack.call(t.context,{isLongPress:K,customData:t.customData}),this.startPressTimeMS=0,this.currentHash=""}}getBucketListeners(t){if(!t)return[];const V=Pn.lu();return t.listeners.filter((t=>t.inputEl||V))}}var dn;(function(t){t["Undo"]="undo",t["Rebet"]="rebet",t["SelectChip"]="selectChip",t["StartRound"]="startRound"})(dn||(dn={}));const Mn={[dn.Undo]:[ln(Hn.Z,"ctrl").withLogPress(Sn.DS.IS_MACOSX?en.ClientShortcutCMDZ:en.ClientShortcutCTRLZ).withLongPress(!0,en.ClientShortcutUndoAll),ln(Hn.Del).withLogPress(en.ClientShortcutDeleteUndo).withLongPress(!0,en.ClientShortcutUndoAll),ln(Hn.Backspace,"executeDefault").withLogPress(en.ClientShortcutDeleteUndo).withLongPress(!0,en.ClientShortcutUndoAll)],[dn.Rebet]:[ln(Hn.Space)],[dn.StartRound]:[ln(Hn.Space)],[dn.SelectChip]:[ln(Hn.One,"executeDefault").withLogPress(en.ClientShortcutChip,{key:1}),ln(Hn.Two,"executeDefault").withLogPress(en.ClientShortcutChip,{key:2}),ln(Hn.Three,"executeDefault").withLogPress(en.ClientShortcutChip,{key:3}),ln(Hn.Four,"executeDefault").withLogPress(en.ClientShortcutChip,{key:4}),ln(Hn.Five,"executeDefault").withLogPress(en.ClientShortcutChip,{key:5}),ln(Hn.Six,"executeDefault").withLogPress(en.ClientShortcutChip,{key:6}),ln(Hn.Seven,"executeDefault").withLogPress(en.ClientShortcutChip,{key:7}),ln(Hn.Eight,"executeDefault").withLogPress(en.ClientShortcutChip,{key:8}),ln(Hn.Nine,"executeDefault").withLogPress(en.ClientShortcutChip,{key:9})]},Bn=Sn.DS.IS_PHONE?-.35:-.3,on=Sn.DS.IS_DESKTOP?.06:0,fn=.23,gn=.13,tq=.2;class Vq extends e.ChipSelector{constructor(t){super(t),this.shortcuts=[],this.shadowAdded=!1,this.createUpdateUserSelect=t=>{this.userSelectedChipUpdater=t,this.pressEvent=e.addAction(this.scene,new e.Tap({callback:t,target:()=>e.pickMesh(this.scene,`${this.meshName}-button-`),DS:this.DS}))},this.getTotalAmount=()=>{const t=this.chipList.reduce(((t,V)=>xX.J0.add(t,xX.J0.multiply(V,this.chipAmountsPerChipStack[V]))),0);return xX.J0.add(this.plaqueAmount,t)},this.shortcutSelected=t=>{var V,X;const K=Number(null===(V=t.customData)||void 0===V?void 0:V.customField);K&&(this.updateSelectedChipStack(K,!1,!0),null===(X=this.userSelectedChipUpdater)||void 0===X||X.call(this,e.TapState.End))},this.correctionChipsCount=t=>{const V=this.chipList.find((V=>xX.J0.isGreaterThan(V,t)&&this.chipAmountsPerChipStack[V]>0));V&&(this.chipAmountsPerChipStack[V]--,this.renderChips())},this.DS=t.DS,this.keyController=new Gn(window),this.shadowLightName=t.shadowLightName,this.minChipValue=Math.min(...t.chipList),this.shortcuts=Mn[dn.SelectChip];const V=t.curvedChipStackOptions,X=Object.keys(this.chipStacks).length;Object.keys(this.chipStacks).map((t=>Number(t))).sort(((t,V)=>t-V)).forEach(((t,K)=>{V&&(this.buttons[t].position=this.getStackPosition(K,X,V),this.moveRingToSelectedStack())}))}disable(){this.shadowLightName&&(e.removeShadowUpdateFor(this.scene,this.shadowLightName),Object.keys(this.chipStacks).forEach((t=>this.chipStacks[t].getChips().forEach((t=>{this.shadowLightName&&e.removeMeshFromShadowGenerator(t.mesh,this.shadowLightName)}))))),this.mesh.setEnabled(!1),this.keyController.disable(),this.shortcuts.forEach((t=>Object.keys(this.buttons).forEach((V=>t.removeListener(this.shortcutSelected,this.buttons[V])))))}enable(){this.mesh.setEnabled(!0),this.keyController.enable(),Object.keys(this.chipStacks).map((t=>Number(t))).sort(((t,V)=>t-V)).forEach(((t,V)=>{var X;(null===(X=this.shortcuts)||void 0===X?void 0:X[V]).addListener(this.shortcutSelected,this.buttons[t],!1,{customField:t})}))}dispose(){var t;super.dispose(),this.shortcuts.forEach((t=>Object.keys(this.buttons).forEach((V=>t.removeListener(this.shortcutSelected,this.buttons[V]))))),this.shortcuts=[],this.keyController.dispose(),null===(t=this.pressEvent)||void 0===t||t.destroy()}async animateChipsPlacement(){this.enable(),this.chipStackHighlight.hide();const t=this.mesh,V=t.position.add(new G.Pq(0,on,Bn)),X=e.localToGlobal(V,t.parent);this.setDisabledChipsVisibility(0),this.shadowLightName&&e.addShadowUpdateFor(this.scene,this.shadowLightName);const K=hn.A(Object.keys(this.chipStacks).map((t=>this.chipStacks[t].getChips().map(((t,V)=>(this.shadowLightName&&e.addMeshToShadowGenerator(t.mesh,this.shadowLightName),Xq({mesh:t.mesh,startAbsoluteSPosition:X,delay:Kq(V),scene:this.scene})))))));this.plaque&&(this.shadowLightName&&e.addMeshToShadowGenerator(this.plaque.mesh,this.shadowLightName),K.push(Xq({mesh:this.plaque.mesh,startAbsoluteSPosition:X,duration:1.35*fn,scene:this.scene}))),await Promise.all(K),this.shadowLightName&&!this.shadowAdded&&(e.removeShadowUpdateFor(this.scene,this.shadowLightName),Object.keys(this.chipStacks).forEach((t=>this.chipStacks[t].getChips().forEach((t=>{this.shadowLightName&&e.removeMeshFromShadowGenerator(t.mesh,this.shadowLightName)})))),this.addShadowLight(this.shadowLightName),this.shadowAdded=!0),xX.J0.isGreaterThanOrEqual(this.amount,this.minChipValue)&&this.chipStackHighlight.show(),this.setDisabledChipsVisibility()}updateAmount(t,V=!1){super.updateAmount(t,V);const X=xX.J0.subtract(this.getTotalAmount(),this.amount);xX.J0.isGreaterThan(X,0)&&this.correctionChipsCount(X),this.updateHighlightHeight(),xX.J0.isLessThan(t,this.minChipValue)?this.chipStackHighlight.hide():this.chipStackHighlight.show()}moveRingToSelectedStack(){super.moveRingToSelectedStack(),this.updateHighlightHeight()}createChipHighlight(t){const V=new gC;return V.initMesh(t,this.mesh,this.mesh.name),V}getStackPosition(t,V,X){const{commonAngle:K,radius:k}=X,A=(V<=1?0:K/(V-1))*(t-(V-1)/2),$=Math.sqrt(2*k**2*(1+Math.cos(M.S0.ToRadians(A)))),I=$*Math.cos(M.S0.ToRadians(90-.5*A)),C=2*k-$*Math.sin(M.S0.ToRadians(90-.5*A));return new G.Pq(I,0,C)}updateHighlightHeight(){this.chipStackHighlight.updateHighlightHeight(e.chipStackHeightLimit,this.chipAmountsPerChipStack[this.selectedChipStack])}}function Xq({mesh:t,startAbsoluteSPosition:V,scene:X,delay:K=0,duration:k=fn}){const A=t.position.clone();return t.setAbsolutePosition(V),e.tweenToPromise({target:t,props:{position:A}},k,{easingMode:WC.KA.EASINGMODE_EASEOUT,easingFunc:new WC.E8,delay:K,constantDelta:e.getConstantDelta(X)})}function Kq(t){return Tn.U4(Math.max(gn*(t-tq),0),gn*(t+tq),3)}const kq="shadowMaterial";class Aq extends wC.V{constructor(t,V){super(`cardDeck:${t.name}`),this.deck=t,this.updateClipPlane=()=>{this.clipPlane=G.Zc.FromPositionAndNormal(e.localToGlobal(this.cutPosition,this),G.Pq.TransformNormal(this.rotationVector,this.getWorldMatrix()))},this.setPlane=()=>{this.deckSelectAsActiveMeshState=this.deck.alwaysSelectAsActiveMesh,this.deckSelectAsActiveMeshState&&(this.deck._unFreeze(),this.deck.alwaysSelectAsActiveMesh=!1),this.getScene().clipPlane=this.clipPlane},this.removePlane=()=>{this.getScene().clipPlane=null,void 0!==this.deckSelectAsActiveMeshState&&this.deckSelectAsActiveMeshState!==this.deck.alwaysSelectAsActiveMesh&&(this.deck.alwaysSelectAsActiveMesh=this.deckSelectAsActiveMeshState)},this.rotationVector=G.Pq.TransformCoordinates(G.Pq.Right(),G.uq.RotationZ(-M.S0.ToRadians(V))),t.computeWorldMatrix(!0),e.copyInfoFromMesh(t,this),this.deck.setParent(this),this.deck.rotation.set(0,0,0),this.deck.scaling.set(1,1,1),this.deck.position.set(0,0,0),this.onAfterWorldMatrixUpdateObservable.add(this.updateClipPlane),this.deck.onBeforeRenderObservable.add(this.setPlane),this.deck.onAfterRenderObservable.add(this.removePlane),this.cutPosition=G.Pq.Zero()}setCutPosition(t){this.cutPosition.copyFrom(e.globalToLocal(t,this)),this.updateClipPlane()}get deckDepth(){return this.cutPosition.x}show(){this.deck.isVisible=!0,e.changeChildVisibility(this.deck,!0)}hide(){this.deck.isVisible=!1,e.changeChildVisibility(this.deck,!1)}}const $q=.15,Iq=10,Cq=9;class nq{constructor(t){this.frontCutCard=null,this.backCutCard=null,this.cardCount=0,this.cardSlideStart=t.cardSlideStart,this.cardSlideEnd=t.cardSlideEnd,this.deck=new Aq(t.deck,35),this.slider=t.slider,this.cardSlideEnd.setEnabled(!1),this.cardSlideEnd.rotation.y=this.cardSlideStart.rotation.y,this.sliderStartPosition=t.sliderStartPosition,this.sliderMaxPosition=t.sliderMaxPosition,this.sliderCurrentPosition=this.slider.position.clone(),this.sliderEndPosition=this.slider.position.clone(),this.deckStartPosition=this.deck.position.clone(),this.playSliderOutSound=t.playSliderOutSound,this.playSliderInEmptySound=t.playSliderInEmptySound,this.playSliderInDeckSound=t.playSliderInDeckSound,this.playDeckOutOfShoeSound=t.playDeckOutOfShoeSound,this.cutCardCurrentPosition=G.Pq.Zero(),this.setCardCount(this.cardCount),t.addReflection&&t.addReflection([t.deck,t.slider,t.cardSlideStart,t.cardSlideEnd])}setCardCount(t){this.cardCount=t;const V=this.cardCount>0?this.cardCount/KV.pP:0;if(this.calculateSliderPosition(V,this.sliderCurrentPosition),this.slider.position=this.sliderCurrentPosition.clone(),this.deck.setCutPosition(this.slider.getAbsolutePosition()),0===t?(this.cardSlideStart.isVisible=!1,this.deck.hide()):(this.cardSlideStart.isVisible=!0,this.deck.show()),this.frontCutCard&&(this.frontCutCard.isVisible=0!==this.cardCount,this.frontCutCard.isVisible)){const t=this.cardCount===KV.Qo?KV.fh:KV.w7;this.setCutCardPosition(this.frontCutCard,this.cardCount,KV.Ay,t),this.needAlphaIndexUpdate()&&this.updateAlphaIndexes(this.frontCutCard,this.cardCount)}this.backCutCard&&(this.backCutCard.isVisible=0!==this.cardCount,this.backCutCard.isVisible&&this.setCutCardPosition(this.backCutCard,this.cardCount,0))}decreaseCardCount(){this.setCardCount(this.cardCount-1)}async flyOutDeck(t,V){var X;null===(X=this.backCutCard)||void 0===X||X.setParent(this.deck);const K=e.globalToLocal(t,this.containerNode);this.calculateSliderPosition(.5,this.sliderCurrentPosition),await this.animateSlider(this.sliderCurrentPosition,this.playSliderOutSound),this.calculateSliderPosition(0,this.sliderCurrentPosition),await Promise.all([this.animateSlider(this.sliderCurrentPosition,this.playSliderInEmptySound,.6),this.animateDeckOut(K.add(new G.Pq(0,this.deck.deckDepth,0)),this.calculateSliderPosition(.2),new G.Pq(0,-this.containerNode.rotation.y,-Math.PI/3))])}async hideDeck(){await this.animateDeckDown(this.deck.position.y-.4)}moveSliderToMax(){return this.animateSlider(this.sliderMaxPosition,this.playSliderOutSound)}moveSliderToDeck(){return this.animateSlider(this.sliderEndPosition,this.playSliderInDeckSound)}get containerNode(){return this.deck.parent}attachFrontCutCard(t){this.frontCutCard=t,this.frontCutCard.parent=this.slider.parent,this.frontCutCard.position.copyFrom(this.cardSlideStart.position),this.frontCutCard.rotation.copyFrom(this.cardSlideStart.rotation),this.frontCutCard.isVisible=0!==this.cardCount,this.setCutCardPosition(t,this.cardCount,KV.Ay),this.updateAlphaIndexes(this.frontCutCard,this.cardCount)}attachBackCutCard(t){this.backCutCard=t,this.backCutCard.parent=this.slider.parent,this.backCutCard.position.copyFrom(this.cardSlideStart.position),this.backCutCard.rotation.copyFrom(this.cardSlideStart.rotation),this.backCutCard.isVisible=0!==this.cardCount,this.setCutCardPosition(t,this.cardCount,0)}detachFrontCutCard(){const t=this.frontCutCard;this.frontCutCard=null,t&&IV(t.material),IV(this.cardSlideStart.material)}detachBackCutCard(){this.backCutCard&&this.backCutCard.setParent(null),this.backCutCard=null}updateAlphaIndexes(t,V){const X=V===KV.Qo;t.alphaIndex=X?Iq:Cq,this.cardSlideStart.alphaIndex=X?Cq:Iq,$V(this.cardSlideStart.material),$V(t.material)}setCutCardPosition(t,V,X,K=KV.w7){this.calculateSliderPosition((V-X)/KV.pP,this.cutCardCurrentPosition),t.position.copyFrom(this.cutCardCurrentPosition),t.position.y+=K,t.position.z-=V>KV.aI?KV.C3:0}calculateSliderPosition(t,V){const X=V||G.Pq.Zero();return G.Pq.LerpToRef(this.sliderStartPosition,this.sliderEndPosition,t,X),X}animateSlider(t,V,X){return new Promise((K=>{e.tweenTo({target:this.slider,props:{position:t}},$q,{onStart:V,onComplete:K,delay:X})}))}animateDeckOut(t,V,X){return new Promise((K=>{const k=.3,A=.1,$=k+A+.6,I=e.AnimationFrameRate*k,C=I+e.AnimationFrameRate*A,n=e.AnimationFrameRate*$,q=[{frame:0,value:this.deck.position},{frame:I,value:V},{frame:C,value:V.add(new G.Pq(0,.1,0))},{frame:n,value:t}],R=[{frame:0,value:this.deck.rotation},{frame:C,value:this.deck.rotation},{frame:n,value:X}],F=[e.createMultiStepAnimation({prop:"position",keys:q}),e.createMultiStepAnimation({prop:"rotation",keys:R})];e.addEventAt(F[0],Math.floor(I/2),(()=>{this.playDeckOutOfShoeSound()})),this.deck.getScene().beginDirectAnimation(this.deck,F,0,n,!1,1,K)}))}animateDeckDown(t){return new Promise((V=>{e.tweenTo({target:this.deck,props:{"position.y":t}},.1,{onComplete:()=>{this.deck.hide(),this.deck.position.copyFrom(this.deckStartPosition),this.deck.rotation.set(0,0,0),this.backCutCard&&(this.backCutCard.isVisible=!1),V()}})}))}needAlphaIndexUpdate(){return this.cardCount<=KV.Qo+1&&this.cardCount>=KV.Qo-1}}class qq{constructor(t){this.cutCard=null,this.cards=t.reduce(((t,V)=>(t[V]=[],t)),{})}addCardForHand(t,V){this.cards[V].push(t)}clearCards(){for(const t of Object.keys(this.cards))this.cards[t].length=0}getAllCards(){return Object.keys(this.cards).reduce(((t,V)=>t.concat(this.cards[V])),[])}getCardsForHand(t){return this.cards[t]}getCardsForHandAt(t,V){return this.cards[t][V]}addCutCard(t){this.cutCard=t}getCutCard(){return this.cutCard}}class Rq{constructor(t){this.props=t;const{tableName:V,pivotName:X,scene:K}=t;this.tableName=V;const k=e.getMeshByName(X,K);this.table=k;const A=FX(k,(t=>CX(t,nV.Prefix)));this.cardHolder=this.createCardHolder(A),this.shoe=this.createShoe(A),this.discardPile=this.createDiscardPile(A),this.cardsOnTable=this.createTableCardsHolder(),this.chipstack=this.createChipSelector(A),this.bettingGrid=this.createBettingGrid(A),this.handSpotNodes=this.createHandSpotNodes(A),this.tableCenterPosition=this.createTableCenterPosition(A,k)}createDiscardPile(t){const V=FX(t,(t=>CX(t,NV.DiscardPilePrefix)));return this.props.isMobile&&(V.position.z+=.05),PC(V)}createCardHolder(t){const V=FX(t,(t=>CX(t,sV.Prefix))),X=e.getMeshByName(CV(SV.ClonePrefix,0),this.props.scene),K=e.getMeshSize(X,!0);return new xn(V,K.y*KV.xX,this.props.playCardsInHolderSound)}createShoe(t){const V=FX(t,(t=>CX(t,FV.Prefix))),X=FX(V,(t=>t.endsWith(FV.SliderStartPositionPrefix)));X.setEnabled(!1);const K=FX(V,(t=>t.endsWith(FV.CardStartPrefix)),!1),k=FX(V,(t=>t.endsWith(FV.CardEndPrefix)),!1),A=FX(V,(t=>t.endsWith(FV.SliderHighPositionPrefix)));return new nq({cardSlideStart:K,cardSlideEnd:k,deck:FX(V,(t=>t.endsWith(FV.DeckPrefix))),slider:FX(V,(t=>t.endsWith(FV.SliderPrefix))),sliderStartPosition:X.position.clone(),sliderMaxPosition:A.position.clone(),playSliderOutSound:()=>this.props.playShoeSliderSound(W$.SliderOut),playSliderInEmptySound:()=>this.props.playShoeSliderSound(W$.SliderInEmptyShoe),playSliderInDeckSound:()=>this.props.playShoeSliderSound(W$.SliderInDeck),playDeckOutOfShoeSound:this.props.playDeckOutOfShoeSound})}createTableCardsHolder(){return new qq(Object.values(zK))}createChipSelector(t){const V=FX(t,(t=>CX(t,WV.PlaceholderPrefix))),X=function({plaqueMesh:t,amount:V,chipList:X,scene:K,namePrefix:k,DS:A,position:$,parent:I,isPlaqueEnabled:C=!0,curvedChipStackOptions:n,plaqueTransformData:q,tooltipManager:R,shadowLightName:F,shadowConfigs:s,chipsMargin:S=1.5}){const c=new Vq({tooltipManager:R,isPlaqueEnabled:C,plaqueSourceMesh:t,amount:V,chipList:X,scene:K,namePrefix:k,layout:{getChipStackPosition:(t,V,X)=>{const K=X*S,k=K*t-(V-1)/2*K;return new G.Pq(k,0,0)},plaqueTransformData:q||{position:new G.Pq(.4,0,0),rotation:G.Pq.Zero(),scaling:new G.Pq(qn,qn,qn)}},DS:A,curvedChipStackOptions:n,shadowLightName:F});if(c.mesh.setAbsolutePosition($),c.mesh.scaling.setAll(Rn(A.IS_DESKTOP)),c.mesh.parent=I,c.mesh.setEnabled(!1),s&&F){const{meshes:t,mainLightName:V,alpha:X=.4}=s;t.forEach((t=>{const k=K.getMaterialByName(kq);t.material=k||new zV.w(kq,K),t.material.alpha=X,t.receiveShadows=!0;const A=K.getLightByName(V),$=K.getLightByName(F);A&&$&&(A.excludedMeshes.push(t),$.canAffectMesh(t))}))}return c}({plaqueMesh:FX(t,(t=>CX(t,RV.PlaqueMeshNamePrefix))),amount:this.props.balance,chipList:this.props.chipAmounts,scene:this.props.scene,namePrefix:this.props.tableName,DS:this.props.DS,position:V.position,parent:t,plaqueTransformData:{rotation:G.Pq.Zero(),position:new G.Pq(.4,0,0),scaling:new G.Pq(165,165,165)},tooltipManager:this.props.tooltipManager,shadowLightName:_V.Shadow,isPlaqueEnabled:this.props.isPlaqueEnabled});return this.props.isChipSelectorShadowEnabled&&function(t,V){const{x:X,z:K}=V.mesh.getBoundingInfo().boundingBox.extendSize.scale(4),k=d.QX.CreatePlane("planeShadow",{width:3*X,height:2*K},t);k.position=new G.Pq(0,.001,-.068),bV({scene:t,parent:V.mesh,mainLightName:_V.Main,shadowLightName:_V.Shadow,mesh:k,alpha:.4})}(this.props.scene,X),X}createBettingGrid(t){return function(t){const{DS:V,grids:X,chipAmounts:K,chipSelector:k,positionsMap:A,defaultPosition:$,shadowLightName:I,offsetMax:C=G.Pq.Zero(),offsetMin:n=new G.Pq(0,0,3.8*-e.getMeshSize(t.chipSelector.mesh).z)}=t,q=1.25*e.getStandardChipDimensions(Rn(V.IS_DESKTOP)).diameter,R={[Dn.TopLeft]:new G.Pq(-q,0,q),[Dn.TopRight]:new G.Pq(q,0,q),[Dn.BottomLeft]:new G.Pq(-q,0,-q),[Dn.BottomRight]:new G.Pq(q,0,-q)},F=new _n;return F.setAdditionalOffset(C,n),new En({scale:1.5*Rn(V.IS_DESKTOP),grids:X,chipAmounts:K,chipSelector:k,DS:V,winningChipStackPosition:{default:R[null!=$?$:Dn.TopRight],...Object.keys(A).reduce(((t,V)=>{const X=A[V];return t[V]=R[X],t}),{})},shadowLightName:I,draggingPositionLimiter:F})}({grids:FX(t,(t=>CX(t,RV.Prefix)),!1),chipAmounts:this.props.chipAmounts,chipSelector:this.chipstack,DS:this.props.DS,positionsMap:{[iV.K8.Player]:Dn.TopRight,[iV.K8.PlayerPair]:Dn.TopLeft,[iV.K8.PlayerBonus]:Dn.TopLeft,[iV.K8.Banker]:Dn.TopRight,[iV.K8.BankerPair]:Dn.TopRight,[iV.K8.BankerBonus]:Dn.TopRight,[iV.K8.Tie]:Dn.TopRight,[iV.K8.PerfectPair]:Dn.TopLeft,[iV.K8.EitherPair]:Dn.TopRight,[iV.K8.SuperSix]:Dn.TopRight},shadowLightName:_V.Shadow})}createHandSpotNodes(t){const V={[zK.Banker]:SX.map((V=>FX(t,(t=>CX(t,V))))),[zK.Player]:sX.map((V=>FX(t,(t=>CX(t,V)))))};for(const X of[zK.Banker,zK.Player]){const[K,k]=V[X],A=G.Pq.Center(K.position,k.position);A.z-=.1;const $=new wC.V(`card_${X.toLowerCase()}_003-bottom`);$.parent=t,$.position.copyFrom(A),V[X].push($)}return V}createTableCenterPosition(t,V){const X=this.props.cardSize,K=FX(t,(t=>CX(t,yV.Label))),k=FX(t,(t=>CX(t,EV.Label))),{z:A}=e.getMeshSize(K);return e.globalToLocal(e.localToGlobal(new G.Pq(G.Pq.Center(k.position,K.position).x,K.position.y,K.position.z-A-X.z),K.parent),V)}}function Fq(t){const{scene:V,playCardsInHolderSound:X,playDeckOutOfShoeSound:K,playShoeSliderSound:k,chipAmounts:A,DS:$,balance:I,isChipSelectorShadowEnabled:C,tooltipManager:n,isPlaqueEnabled:q=!1,isMobile:R=!1,cardCreator:F}=t,s=F(iV.Zp.Clubs2),S=e.getMeshSize(s,!0),c=function(t){return new Rq(t)}({tableName:JC.Table01,scene:V,pivotName:uV,playCardsInHolderSound:X,playDeckOutOfShoeSound:K,playShoeSliderSound:k,chipAmounts:A,DS:$,balance:I,isChipSelectorShadowEnabled:C,tooltipManager:n,isPlaqueEnabled:q,isMobile:R,cardSize:S});s.dispose();const N=V.getMeshByName(oC);return N&&N.dispose(),c}var sq=X(253187);function Sq(t,V,X,K){if(!X.activeCamera)return G.Pq.Zero();const k=X.getEngine().getRenderingCanvasClientRect();if(!k)return G.Pq.Zero();const A=G.Pq.Unproject(new G.Pq(t,V,X.activeCamera.minZ),k.width,k.height,G.uq.Identity(),X.activeCamera.getViewMatrix(!0),X.activeCamera.getProjectionMatrix(!0));return K?e.globalToLocal(A,K):A}function cq(t){const V=t.getHierarchyBoundingVectors();return new G.Pq(V.max.x-V.min.x,V.max.y-V.min.y,V.max.z-V.min.z)}var Nq=X(498083),mq=X(648826);const vq="TombstoneBackground";Nq.M.ShadersStore[`${vq}VertexShader`]="precision highp float;attribute vec3 position;attribute vec2 uv;attribute vec3 normal;uniform mat4 worldViewProjection;uniform mat3 normalMatrix;varying vec3 vNormal;varying vec2 vUV;void main(){vUV=uv;vNormal=normalMatrix*normal;gl_Position=worldViewProjection*vec4(position,1.);}",Nq.M.ShadersStore[`${vq}FragmentShader`]="precision highp float;uniform float alpha;uniform vec4 color;uniform float width;uniform float radius;uniform float aspectRatio;varying vec2 vUV;varying vec3 vNormal;void main(){float edgeThreshold=1.-width;float ralpha=1.;if(vUV.x<width||vUV.x>edgeThreshold||vUV.y<width*aspectRatio||vUV.y>1.-width*aspectRatio){float distanceX=min(vUV.x,1.-vUV.x);float distanceY=min(vUV.y,1.-vUV.y)/aspectRatio;float distance=min(distanceX,distanceY);ralpha=distance/width;}gl_FragColor=vec4(color.rgb,alpha*ralpha*color.a);}";const Wq=500;class Zq extends mq.B{constructor(t,V="#000000",X=Wq){super(vq,t,{vertex:vq,fragment:vq},{needAlphaBlending:!0}),this.enabled=!1,this.ratio=1,this.appearanceStart=0,this.resolver=null,this.enable=()=>{this.enabled||(this.appearanceStart=Date.now(),this.enabled=!0,this.scene.registerBeforeRender(this.updateAppearance))},this.disable=async()=>{if(this.enabled)return new Promise((t=>{this.appearanceStart=Date.now(),this.enabled=!1,this.scene.registerBeforeRender(this.updateAppearance),this.resolver=t}))},this.updateAppearance=()=>{const t=(Date.now()-this.appearanceStart)/this.appearanceTime;if(t<1){const V=this.enabled?t:1-t;this.setFloat("alpha",jk.I()?.5:V)}else this.setFloat("alpha",this.enabled?1:0),this.scene.unregisterBeforeRender(this.updateAppearance),this.resolver&&(this.resolver(),this.resolver=null)},this.needDepthPrePass=!0,this.appearanceTime=X,this.scene=t,this.setFloat("width",.06),this.setFloat("aspectRatio",this.ratio),this.setFloat("alpha",0),this.setColor4("color",G.ov.FromHexString(V))}dispose(){super.dispose(),this.scene.unregisterBeforeRender(this.updateAppearance)}setAspectRatio(t){this.ratio=t,this.setFloat("aspectRatio",this.ratio)}}const Dq="root_tombstones";jk.I(),jk.I(),jk.I(),jk.I(),new G.ov(0,0,0,0);class yq extends wC.V{constructor(t){var V;super(Dq),this.props=t,this.sideMargin=10,this.count=0,this.cardSize=void 0,this._items=[],this.backgroundMaterial=null,this.backgroundMesh=null,this.props=t,this.orientation=t.orientation,this.updateParent(this.orientation),this.updatePosition(this.orientation),this.updateScaling(this.orientation,null===(V=this.cardSize)||void 0===V?void 0:V.x),this.availableCardsAmountOnFullLength=this.props.settings.availableCardsAmountOnFullLength,t.scene.getEngine().onResizeObservable.add(this.onResize.bind(this)),this.props.backgroundColor&&(this.backgroundMaterial=new Zq(this.getScene(),this.props.backgroundColor))}get items(){return this._items}dispose(){this.props.scene.getEngine().onResizeObservable.removeCallback(this.onResize),super.dispose()}async disposeAllInstances(){var t,V,X,K;null===(V=(t=this.props).onDisposeStart)||void 0===V||V.call(t),this.backgroundMaterial&&this.backgroundMaterial.disable().then((()=>{var t;return null===(t=this.backgroundMesh)||void 0===t?void 0:t.dispose()}));const k=[],A=this.props.needOrientationForDispose?this.orientation:void 0;for(const t of this.items)k.push(t.instance.dispose(A));await Promise.all(k),null===(K=(X=this.props).onDisposeEnd)||void 0===K||K.call(X),this.reset()}async addItems(t,V,X){var K,k,A,$;null===(k=(K=this.props).onMountStart)||void 0===k||k.call(K),this.count=t.length;for(const[K,k]of t.entries()){const A=this.props.createItem(K,k,this,this.orientation,this.props.animationConfig);this.cardSize||(this.cardSize=this.calculateCardSize(A.tombstone),this.updateScaling(this.orientation,this.cardSize.x)),A.size=this.cardSize,this._items.push({...k,instance:A}),A.setTombstonePosition({amount:t.length,offset:this.gap,orientation:this.orientation}),X&&await X(K,A),await A.start(K===t.length-1?()=>this.onTombstoneMounted(V):void 0)}null===($=(A=this.props).onMountEnd)||void 0===$||$.call(A)}get gap(){return this.props.settings.gap*(this.orientation===nt.t.Portrait?1:this.props.settings.scaling[Sn.DS.PLATFORM])}get containerLength(){return 2*Math.abs(Sq(this.sideMargin,0,this.getScene(),this.parent).x)}recalculateTombstonePositions(){if(this.count>0)for(const t of this._items)t.instance.setTombstonePosition({offset:this.gap,amount:this.count,orientation:this.orientation})}calculateCardSize(t){const{x:V,y:X,z:K}=cq(t),k=Math.sqrt(X**2+K**2);return new G.Pq(V,sq.A(k,2),K)}updatePosition(t){const V=this.props.settings.positions;if(t!==nt.t.Portrait)this.position=this.calculateLandscapePosition(V[t]);else{const{screenPoint:X}=V[t];this.position=this.calculatePortraitPosition(X)}}onResize(){var t;if(this.props.checkResize){const V=window.innerWidth>window.innerHeight?nt.t.Landscape:nt.t.Portrait;this.orientation!==V&&(this.orientation=V,this.updateParent(this.orientation),this.updatePosition(this.orientation),this.recalculateTombstonePositions()),this.updateScaling(this.orientation,null===(t=this.cardSize)||void 0===t?void 0:t.x)}}reset(){this._items=[],this.count=0}updateParent(t){this.parent=t===nt.t.Portrait?this.getScene().activeCamera:null}updateScaling(t,V){if(t!==nt.t.Portrait||!V)return void(this.scaling=G.Pq.One());const X=this.containerLength/this.availableCardsAmountOnFullLength/V;this.scaling=new G.Pq(X,X,X)}calculatePortraitPosition({getX:t,getY:V}){return Sq(t(window.innerWidth),V(window.innerHeight),this.getScene(),this.parent)}calculateLandscapePosition(t){const V=t[Sn.DS.PLATFORM];return V?V.clone():FX(this.getScene(),(t=>t.endsWith(jV.PlaceHolderPrefix))).position}addBackground(){if(!this.backgroundMaterial)return;const t=this.parent;this.parent=null,this.computeWorldMatrix(!0);const V=cq(this);this.parent=t;const X=1.1*V.x/this.scaling.x,K=V.y/this.scaling.x;this.backgroundMesh=d.QX.CreatePlane("tombstone-background",{width:X,height:K}),this.backgroundMesh.position.z+=.01,this.backgroundMesh.position.y-=K/4,this.backgroundMesh.material=this.backgroundMaterial,this.backgroundMesh.parent=this,this.backgroundMaterial.setAspectRatio(X/K),this.backgroundMaterial.enable()}onTombstoneMounted(t){this.props.backgroundColor&&this.addBackground(),t()}}var Eq=X(692913);class _q extends Eq.P{}class pq extends _q{}class Lq extends _q{}class Oq extends Lq{constructor(t){super(t),this.createFlyingFee=t=>{for(const V of Object.keys(t.payload)){const X=t.payload[V];X&&this.props.createFlyingFee(V,X)}},this.subscribeOnMessagesTo3D({[ZI.BetsAmountChanged]:this.createFlyingFee})}}class rq extends Lq{constructor(t){super(t),this.removeHighlightedBetSpots=()=>{this.highlightedBetSpots=[]},this.highlightBetSpot=t=>{var V,X;const K=null===(X=null===(V=this.props.tableManager.table)||void 0===V?void 0:V.bettingGrid)||void 0===X?void 0:X.getSpots();if(!K)return;const k=Object.values(K);for(const[V,X]of t.payload.cards.entries()){if(!this.props.tombstoneManager.items.find((t=>t.card===V)))return;k.filter((t=>X.has(t.spotName)&&!this.highlightedBetSpots.includes(t.spotName))).forEach((t=>{this.highlightedBetSpots.push(t.spotName),t.setHighlightSpot(Wn.Multiplied)}))}},this.scene=t.scene,this.highlightedBetSpots=[],this.subscribeOnMessagesTo3D({[ZI.LightningStrikeBettedSpots]:this.highlightBetSpot,[u.RemoveCards]:this.removeHighlightedBetSpots})}}class zq extends Eq.P{constructor(t){super(t),this.multipliers=new Map,this.subscribeOnMessagesTo3D({[ZI.SetSpotsMultipliers]:this.handleSetMultiplier.bind(this),[u.ChangeOrientation]:this.handleOrientation.bind(this)})}handleSetMultiplier(t){var V,X;const K=null===(X=null===(V=this.props.tablesManager.table)||void 0===V?void 0:V.bettingGrid)||void 0===X?void 0:X.getSpots();if(K){const V=Object.values(K);for(const X of V){const V=t.payload[X.spotName];if(this.multipliers.has(X.spotName)){const t=this.multipliers.get(X.spotName);if(V!==t.value)if(t.mesh.dispose(),V>1){const t=this.createText(`${String(V)}x`,X.mesh);this.multipliers.set(X.spotName,{mesh:t,value:V})}else this.multipliers.delete(X.spotName)}else if(V>1){const t=this.createText(`${String(V)}x`,X.mesh);this.multipliers.set(X.spotName,{value:V,mesh:t})}}}}createText(t,V){const X=this.props.createText(t);X.parent=V;const K=this.getMultiplierPosition(V.name);return K&&(X.position=K),X.rotation.x+=Math.PI/2,X.position.y=this.props.depth,X}getMultiplierPosition(t){return this.props.multiplierPositions[this.orientation][t]}repositionMultipliers(){const t=this.multipliers.keys();for(const V of t)this.multipliers.get(V).mesh.position=this.getMultiplierPosition(V)}handleOrientation(t){this.orientation=t.payload,this.repositionMultipliers()}}class wq extends Lq{constructor(t){super(t),this.handleUpdateTableState=({payload:t})=>{this.updateTableState(t.cardsInShoe,t.cardsInCardHolder)},this.subscribeOnMessagesTo3D({[u.UpdateTableState]:this.handleUpdateTableState})}updateTableState(t,V){const X=this.props.tableData;X.cardHolder.setCardCount(V),X.shoe.setCardCount(t),this.props.messageSender3d.from.updateTableStateDone()}}class bq extends Lq{constructor(t){super(t),this.allCartsDealt=!1,this.animations={},this.handleOrientation=t=>{this.orientation=t.payload},this.notifyTombstonesShowed=()=>{this.props.messageSender3d.from.showTombstonesDone()},this.initTombstones=()=>{this.props.preInitTombstones&&this.props.preInitTombstones()},this.sendAnimationsDoneMessage=()=>{!Object.values(this.animations).includes(!0)&&this.allCartsDealt&&(this.props.messageSender3d.from.multiplierCardsMatchAnimationsDone(),this.allCartsDealt=!1)},this.handleAllCardsDealt=()=>{this.allCartsDealt=!0,this.sendAnimationsDoneMessage()},this.removeCards=()=>{for(const t of this.props.tombstoneManager.items)t.instance.startRemoveCard()},this.openCard=async t=>{var V;const{placeHolder:X,cardPlace:K}=t.payload,k=null===(V=this.props.tablesManager.table)||void 0===V?void 0:V.cardsOnTable.getCardsForHandAt(X,K);if(k){const t=[];for(const V of this.props.tombstoneManager.items)k.name.startsWith(`${NV.ContainerPrefix}-${V.card}`)&&(this.animations[k.id]=!0,await nI(500),t.push(V.instance.setCardActive(!0,{destination:k,onTombstoneMatched:this.props.onTombstoneMatched,onAnimationEnd:async t=>{k.setActive(!1),this.allCartsDealt&&await(null!=t?t:nI(400)),this.animations[k.id]=!1,this.sendAnimationsDoneMessage()}})));await Promise.all(t)}},this.dealOpenCard=async t=>{var V;const{placeHolder:X,cardPlace:K}=t.payload,k=null===(V=this.props.tablesManager.table)||void 0===V?void 0:V.cardsOnTable.getCardsForHandAt(X,K);if(k)for(const t of this.props.tombstoneManager.items)k.name.startsWith(`${NV.ContainerPrefix}-${t.card}`)&&(t.instance.setCardActive(!0,{immediately:!0}),k.setActive(!1))},this.onHideTombstones=()=>{this.props.tombstoneManager.disposeAllInstances()},this.orientation=t.getOrientation(),this.subscribeOnMessagesTo3D({[ZI.ShowTombstones]:this.onShowTombstones.bind(this),[ZI.HideTombstones]:this.onHideTombstones,[u.ChangeOrientation]:this.handleOrientation.bind(this),[u.OpenCard]:this.openCard,[ZI.AllCardsDealt]:this.handleAllCardsDealt,[u.DealOpenCard]:this.dealOpenCard,[u.DealingPhaseStart]:this.initTombstones,[u.RemoveCards]:this.removeCards})}async onShowTombstones(t){this.props.tombstoneManager.items.length>0&&await this.props.tombstoneManager.disposeAllInstances(),await this.props.tombstoneManager.addItems(t.payload,(()=>{this.notifyTombstonesShowed()}))}}var aq,uq=X(850034),jq=X(199002);(function(t){t[t["Negative"]=-1]="Negative",t[t["Positive"]=1]="Positive"})(aq||(aq={}));var xq=X(228174);const eq="fadeInOut";Nq.M.ShadersStore[`${eq}FragmentShader`]="precision highp float;varying vec2 vUV;uniform sampler2D textureSampler;uniform vec3 fadeColor;uniform float opacity;void main(void){vec4 baseColor=texture2D(textureSampler,vUV)*opacity;gl_FragColor=vec4(baseColor.rgb+fadeColor*(1.-opacity),1.);}";class Yq extends uq.w{constructor(t){super(eq,eq,["opacity","fadeColor"],null,1,t.camera),this.direction=aq.Negative,this.postProcessId=null,this.fadePromise=null,this.opacity=t.opacity||{from:1,to:.1},this.fadeColor=t.fadeColor||G.v9.Black(),this.currentOpacity=this.opacity.from,this.disableAutoCameraDetachment=!!t.disableAutoCameraDetachment,this.speed=function(t,V,X=60){const K=Math.abs(t.to-t.from),k=X*V.total,A=xq.GB(k*V.rollInPercent,2),$=k-A;return{in:xq.GB(K/A,2),out:xq.GB(K/$,2)}}(this.opacity,t.duration),this.currentSpeed=this.speed.out,this.scene=this.getEngine().scenes[0],this.applyFadeInOutProps=this.applyFadeInOutProps.bind(this),this.onSceneRender=this.onSceneRender.bind(this),this.onApply=this.applyFadeInOutProps,this.scene.executeWhenReady((()=>{t.camera.detachPostProcess(this)}))}async fadeOutIn(t){var V,X;await this.fadeOut(),null===(V=null==t?void 0:t.onFadeOutReady)||void 0===V||V.call(t),await this.fadeIn(),null===(X=null==t?void 0:t.onReady)||void 0===X||X.call(t)}async fadeOut(){this.direction=aq.Negative,this.currentSpeed=this.speed.out,this.currentOpacity=this.opacity.from,await this.startSceneRender()}async fadeIn(){this.direction=aq.Positive,this.currentSpeed=this.speed.in,this.currentOpacity=this.opacity.to,await this.startSceneRender()}dispose(){this.rejectCurrentFadeInOutPromise(),this.detachCamera(),super.dispose(),this.scene=void 0}async startSceneRender(){var t;this.rejectCurrentFadeInOutPromise(),this.attachCamera();try{return this.fadePromise=new jq.h,this.scene.registerBeforeRender(this.onSceneRender),await this.fadePromise.unwrap()}finally{null===(t=this.scene)||void 0===t||t.unregisterBeforeRender(this.onSceneRender),this.fadePromise=null,this.disableAutoCameraDetachment||this.detachCamera()}}rejectCurrentFadeInOutPromise(){var t;null===(t=this.fadePromise)||void 0===t||t.reject("FadeInOutPostProcess: fade promise rejected")}attachCamera(){this.postProcessId||(this.postProcessId=this.getCamera().attachPostProcess(this))}detachCamera(){this.postProcessId&&(this.getCamera().detachPostProcess(this),this.postProcessId=null)}onSceneRender(){var t;this.currentOpacity+=this.currentSpeed*this.scene.getAnimationRatio()*this.direction;const V=this.direction===aq.Negative&&this.currentOpacity<=this.opacity.to,X=this.direction===aq.Positive&&this.currentOpacity>=this.opacity.from;(V||X)&&(null===(t=this.fadePromise)||void 0===t||t.resolve())}applyFadeInOutProps(t){t.setColor3("fadeColor",this.fadeColor),t.setFloat("opacity",this.currentOpacity)}}function Hq(t){return new Yq(t)}const hq=3,Tq=.5,Pq=1.5,Qq=1;class Jq extends Lq{constructor(t){super(t),this.flyToTable=({payload:t})=>{if(this.lastNonIdleTarget=Xt.TableFocus,t.instant)this.cameraManager.focusOn(this.lastNonIdleTarget),this.props.messageSender3d.from.cameraFlewToTableView();else{const t=()=>{this.props.messageSender3d.from.cameraFlewToTableView()};this.cameraManager.flyToTarget(this.lastNonIdleTarget,t,t)}},this.flyToDealView=()=>{const t=()=>this.props.messageSender3d.from.cameraFlewToDealView();this.lastNonIdleTarget=Xt.TableDealing,this.cameraManager.flyToTarget(this.lastNonIdleTarget,t,t)},this.flyToWinView=()=>{this.lastNonIdleTarget=Xt.TableWin;const t=()=>this.props.messageSender3d.from.cameraFlewToWinView();this.cameraManager.flyToTarget(this.lastNonIdleTarget,t,t)},this.cameraManager=t.cameraManager,this.scene=t.scene,this.getOrientation=t.getOrientation,this.scene.getEngine().onResizeObservable.add(this.resize.bind(this)),this.tableFadeInOut=Hq({camera:this.props.camera,duration:{total:hq,rollInPercent:Tq}}),this.tableFadeOut=Hq({camera:this.props.camera,duration:{total:Pq,rollInPercent:Qq}}),this.subscribeOnMessagesTo3D({[u.FlyToTable]:this.flyToTable,[u.FlyToDealView]:this.flyToDealView,[u.FlyToWinView]:this.flyToWinView}),this.lastNonIdleTarget=this.props.currentTarget,this.cameraManager.focusOn(this.lastNonIdleTarget)}resize(){var t,V;const X=this.getOrientation();null===(V=null===(t=this.cameraManager)||void 0===t?void 0:t.updateOrientation)||void 0===V||V.call(t,X)}dispose(){super.dispose(),this.tableFadeInOut.dispose(),this.tableFadeOut.dispose()}}var Uq=X(77724),lq=X(263601);class iq extends wC.V{constructor(t){super(t.namePrefix),this.updateRotation=()=>{this.textMesh.rotation.x=Math.PI/2-this.getScene().activeCamera.beta},this.textAnimations=t.animations,this.parent=t.parent,this.position=t.position,this.textMesh=t.createText(`${t.text}x`),this.textMesh.parent=this,this.camera=this.getScene().activeCamera,this.observer=this.camera.onViewMatrixChangedObservable.add(lq.A(this.updateRotation,100)),this.updateRotation(),this.updatePosition(t.textPosition);const V=this.textAnimations.mount(this.textMesh);this.getScene().beginDirectAnimation(this.textMesh,[V],0,V.getHighestFrame(),!1,1,(()=>{var V,X;null===(X=null===(V=t.sounds)||void 0===V?void 0:V.playSoundAfterMount)||void 0===X||X.call(V),this.startLiveAnimation(),t.notifyAppear(this)}))}updatePosition(t,V){t&&(this.textMesh.position=t.clone()),V&&(this.position=V.clone())}disposeCard(){if(this.camera.onViewMatrixChangedObservable.remove(this.observer),void 0===this.textMesh.visibility)return void this.disposeTransformNode();const t=this.textAnimations.dispose(this.textMesh);this.getScene().beginDirectAnimation(this.textMesh,[t],0,t.getHighestFrame(),!1,1.2,(()=>{super.dispose()}))}disposeTransformNode(){const t=this.textAnimations.dispose(this.textMesh),V=new Uq.k("card-multiplayer-disappear");for(const X of this.textMesh.getChildMeshes())void 0!==X.visibility&&V.addTargetedAnimation(t,X);V.targetedAnimations.length>0?(V.normalize(0,30),V.speedRatio=1.2,V.onAnimationEndObservable.add((()=>super.dispose())),V.play()):super.dispose()}startLiveAnimation(){const t=this.textAnimations.live(this.textMesh);this.getScene().beginDirectAnimation(this.textMesh,[t],0,t.getHighestFrame(),!0,1)}}class Gq extends Eq.P{constructor(t){super(t),this.multipliers=[],this.bubbleExist=!1,this.addTooltip=t=>{if(this.bubbleExist)return;this.bubbleExist=!0,this.props.multiplierBubbleManager.addElement("multiplier-bubble",t);const V=()=>this.props.messageSender3d.from.multiplierAdded();if(jk.I()){const t=setTimeout((()=>{V(),clearTimeout(t)}))}else V()},this.activeMultipliers=new Map,this.subscribeOnMessagesTo3D({[ZI.SetMultipliers]:this.handleSetMultiplier.bind(this),[ZI.MultipliersRemove]:this.disposeMultipliers.bind(this),[u.OpenCard]:this.openCard.bind(this),[u.DealOpenCard]:this.dealOpenCard.bind(this),[u.ChangeOrientation]:this.handleOrientation.bind(this)})}openCard(t){var V,X,K;const{placeHolder:k,cardPlace:A}=t.payload,$=null===(V=this.props.tablesManager.table)||void 0===V?void 0:V.cardsOnTable.getCardsForHandAt(k,A),I=this.getMultiplierValue($);if(I&&$){const t=null===(K=null===(X=this.props.relativePosition[this.orientation])||void 0===X?void 0:X[k])||void 0===K?void 0:K[A],V=$.position.clone();if(this.props.positionMultipliersOnTop){const t=.8*e.getMeshSize($,!0).z;V.z+=t}const C=new iq({text:String(I),position:V,textPosition:t,parent:$.parent,namePrefix:"card-multiplier",animations:this.props.animations,createText:this.props.createText,sounds:this.props.sounds,notifyAppear:this.addTooltip});this.activeMultipliers.set($,{hand:k,place:A,instance:C})}}dealOpenCard(t){var V,X,K;const{placeHolder:k,cardPlace:A}=t.payload,$=null===(V=this.props.tablesManager.table)||void 0===V?void 0:V.cardsOnTable.getCardsForHandAt(k,A),I=this.getMultiplierValue($);if(I&&$){const t=null===(K=null===(X=this.props.relativePosition[this.orientation])||void 0===X?void 0:X[k])||void 0===K?void 0:K[A],V=this.props.getCardPlaceholder(k,A,this.orientation);if(V){const X=V.absolutePosition.clone();if(this.props.positionMultipliersOnTop){const t=.8*e.getMeshSize($,!0).z;X.z+=t}const K=new iq({text:String(I),position:X,textPosition:t,parent:$.parent,namePrefix:"card-multiplier",animations:this.props.animations,createText:this.props.createText,notifyAppear:this.addTooltip});this.activeMultipliers.set($,{hand:k,place:A,instance:K})}}}getMultiplierValue(t){if(!t)return 0;const V=this.multipliers.find((({card:V})=>t.name.startsWith(`${NV.ContainerPrefix}-${V}`)));return V?V.value:0}async disposeMultipliers(t){this.bubbleExist=!1,this.props.multiplierBubbleManager.dispose();const V=t.payload,X=[];for(const[,t]of this.activeMultipliers.entries())if(this.props.multipliersAsParticles&&V){const{target:V,flyMultiplierAsParticleSystem:K,particlesSpeed:k,isMobile:A}=this.props.multipliersAsParticles;X.push(K(t,V,A,k,this.props.scene))}else t.instance.disposeCard();X.length>0&&await Promise.all(X),this.activeMultipliers.clear(),this.props.messageSender3d.from.multipliersRemoved()}handleSetMultiplier(t){this.multipliers=t.payload}handleOrientation(t){var V,X;const{relativePosition:K}=this.props;this.orientation=t.payload;for(const[,{hand:t,place:k,instance:A}]of this.activeMultipliers.entries()){const $=this.props.getCardPlaceholder(t,k,this.orientation),I=null===(X=null===(V=K[this.orientation])||void 0===V?void 0:V[t])||void 0===X?void 0:X[k];I&&A.updatePosition(null!=I?I:G.Pq.Zero(),null==$?void 0:$.position)}}}const dq=.3;class Mq extends Lq{constructor(t){var V;super(t),this.showTableLight=({payload:t})=>{t.instant?this.showLight():(this.setLightData(),this.toggleLight(this.intensity))},this.hideTableLight=()=>{this.toggleLight(0)},this.intensity=null!==(V=t.intensity)&&void 0!==V?V:dq,this.subscribeOnMessagesTo3D({[u.ShowTableLight]:this.showTableLight,[u.HideTableLight]:this.hideTableLight})}toggleLight(t){e.addShadowUpdateFor(this.props.light.getScene(),this.props.light.name),e.tweenTo({target:this.props.light,props:{intensity:t}},.6,{onComplete:()=>{e.removeShadowUpdateFor(this.props.light.getScene(),this.props.light.name)}})}setLightData(){const t=this.props.tables;this.props.light.position.copyFrom(t.position),this.props.light.direction.copyFrom(t.direction)}showLight(){this.setLightData(),this.props.light.intensity=this.intensity,e.forceShadowUpdate(this.props.light.getScene(),this.props.light.name)}}var Bq=X(604910);const oq={positionPoint:new Bq.Pq(0,4.2,2),targetPoint:new Bq.Pq(0,-.8,-.5)};function fq(t,V){return t.setTarget(V.target),t.setPosition(V.position),{target:V.target,alpha:e.convertToPositiveAngle(t.alpha),beta:t.beta,radius:t.radius,duration:V.duration,easingFunc:V.easingFunc,easingMode:V.easingMode,onComplete:V.onComplete,inTangent:V.inTangent,outTangent:V.outTangent}}function gq(t){const V=new ZC.L(M.S0.RandomId(),0,0,0,G.Pq.Zero(),t),X=[fq(V,{target:new G.Pq(0,1.2,1.4),position:new G.Pq(0,1.2,1.3),duration:7,easingFunc:new WC.vm,easingMode:WC.KA.EASINGMODE_EASEINOUT})];return V.dispose(),{common:X}}const tR={[iV.K8.Player]:new G.Pq(.118,.005,.115),[iV.K8.Banker]:new G.Pq(-.118,.005,.115),[iV.K8.PlayerPair]:new G.Pq(-.22,.005,.01),[iV.K8.BankerPair]:new G.Pq(.22,.005,.01),[iV.K8.Tie]:new G.Pq(0,.005,-.124)},VR={[nt.t.Portrait]:tR,[nt.t.Landscape]:tR},XR={[nt.t.Portrait]:{[zK.Banker]:[new G.Pq(0,.02,.08),new G.Pq(0,.02,.08),new G.Pq(0,.02,-.08)],[zK.Player]:[new G.Pq(0,.02,.08),new G.Pq(0,.02,.08),new G.Pq(0,.02,-.08)]},[nt.t.Landscape]:{[zK.Banker]:[new G.Pq(0,.05,0),new G.Pq(0,.05,0),new G.Pq(0,.05,0)],[zK.Player]:[new G.Pq(0,.05,0),new G.Pq(0,.05,0),new G.Pq(0,.05,0)]}};class KR extends e.CameraManager{constructor(t,V){super(t,V),this.camera=t,this.cameraTargets=V,this._hasActiveAnimation=!1}get hasActiveAnimation(){return this._hasActiveAnimation}set hasActiveAnimation(t){this._hasActiveAnimation=t}}const kR=16/9;class AR extends KR{constructor(t,V,X,K){super(t,V[X]),this.originalRadius=0,this.orientation=X,this.mobileTargets=V,this.needRadiusAdjustment=null==K||K}focusOn(t){this.currentTarget=t,this.camera.focusCameraOn({...this.cameraTargets[t],radius:this.getAdjustedRadius(this.cameraTargets[t].radius)})}flyTo(t){super.flyTo({...t,radius:this.getAdjustedRadius(t.radius)})}updateMobileTargets(t,V){this.mobileTargets={...this.mobileTargets,[V]:t},this.setCameraTargets(this.mobileTargets[V])}updateOrientation(t){if(this.orientation=t,this.cameraTargets=this.mobileTargets[t],this.currentTarget){const t=this.cameraTargets[this.currentTarget].target;t&&this.camera.setTargetPosition(t);const V=this.cameraTargets[this.currentTarget].radius;V&&this.camera.setRadius(this.getAdjustedRadius(V))}}getAdjustedRadius(t){if(t&&(this.originalRadius=t),!this.needRadiusAdjustment)return this.originalRadius;const V=this.camera.camera.getEngine().getRenderingCanvasClientRect();return V?function(t,V){const X=1.25*(V*kR-1);return t+t*Math.max(X,0)}(this.originalRadius,V.height/V.width):t||this.originalRadius}}var $R=X(147410),IR=X(755073);const CR={[nt.t.Portrait]:530,[nt.t.Landscape]:300};class nR{static getOrientation(){const t=$R.O();return t.height>t.width?nt.t.Portrait:nt.t.Landscape}constructor(t){this.props=t,this.clientRectTop=CR,this.resize=this.resize.bind(this),this.orientation=nR.getOrientation(),this.targetPositionInfo=function(t){const V=function(t){const V=t.getHierarchyBoundingVectors();return new G.Pq(V.max.x-V.min.x,V.max.y-V.min.y,V.max.z-V.min.z)}(t),X=t.getAbsolutePosition();return{size:V,left:X.x-V.x/2,right:X.x+V.x/2,top:X.z+V.z/2,bottom:X.z-V.z/2}}(this.props.targetMesh),this.adjustForScroll=t.adjustForScroll;const{target:V,radius:X}=this.calculateTarget();this.currentTargets=this.props.generateTargets(V,X,this.orientation),this.resizeDoubleChecker=((t=0)=>{let V=null;return X=>{V&&(window.clearTimeout(V),V=null),X(),t>0&&(V=window.setTimeout((()=>{X(),V=null}),t))}})(Sn.DS.IS_IOS_CHROME?350:1)}add(t){this.cameraManager=t,this.props.scene.getEngine().onResizeObservable.add(this.resize),this.resize()}resize(){this.orientation=nR.getOrientation(),this.props.onOrientationChange&&this.props.onOrientationChange(this.orientation),this.resizeDoubleChecker(this.updateTargets.bind(this)),this.orientation===nt.t.Portrait&&function(t){const V=IR.getGamePlayControlsElement();if(V){const X={attributes:!0,attributeFilter:["class"]};new MutationObserver(((V,X)=>{for(const K of V)"attributes"===K.type&&"class"===K.attributeName&&(t(),X.disconnect())})).observe(V,X)}}((()=>this.updateTargets()))}updateTargets(){const{target:t,radius:V}=this.calculateTarget();this.currentTargets=this.props.generateTargets(t,V,this.orientation),this.cameraManager&&(this.cameraManager.updateMobileTargets(this.currentTargets,this.orientation),this.props.getElementRect()&&this.props.renderer.forceRender())}calculateTarget(){var t;const V=this.props.scene.getEngine(),X=V.getHardwareScalingLevel(),K=V.getRenderWidth(!0)*X,k=V.getRenderHeight(!0)*X,A=this.props.getElementRect();(null==A?void 0:A.top)&&(this.clientRectTop[this.orientation]=null!==(t=A.top)&&void 0!==t?t:CR[this.orientation]);const $={top:0,bottom:this.clientRectTop[this.orientation]+this.getYOffset(),left:0,right:K},I=this.props.targetSettings[this.orientation].horizontalScale,C={...this.targetPositionInfo,left:this.targetPositionInfo.left*I,right:this.targetPositionInfo.right*I,bottom:this.targetPositionInfo.bottom-this.props.targetSettings[this.orientation].borderSize},n=e.getRadiusToFit(K,k,M.S0.ToRadians(this.props.baseFov),$,C),{height:q}=e.getVisibleArea(K,k,M.S0.ToRadians(this.props.baseFov),n),R=q/k*(k-$.bottom),F=C.bottom+q/2-R;return{[e.CameraPositionProps.Radius]:n,[e.CameraPositionProps.Target]:new G.Pq(0,this.props.targetMesh.absolutePosition.y+C.size.y/2,F)}}getYOffset(){return this.adjustForScroll?window.scrollY:0}}const qR=new G.Pq(0,-.005,0),RR=G.Pq.Zero();var FR=X(27230);class sR extends FR.e{constructor(t,V,X){super(t),this.back=V,this.front=X,this.active=!0,V.setParent(this),V.rotation.y=Math.PI,X.setParent(this),V.position.set(0,0,0),X.position.set(0,0,0)}getBackMaterial(){return this.back.material}getFrontMaterial(){return this.front.material}setActive(t){this.active=t}get isVisible(){var t,V;return null!==(V=null===(t=this.back)||void 0===t?void 0:t.isVisible)&&void 0!==V&&V}set isVisible(t){this.back&&this.front&&(this.back.isVisible=t,this.front.isVisible=t)}get visibility(){var t,V;return null!==(V=null===(t=this.front)||void 0===t?void 0:t.visibility)&&void 0!==V?V:0}set visibility(t){this.front&&(this.front.visibility=t)}unfreezeWorldMatrix(){return super.unfreezeWorldMatrix(),this.back&&this.back.unfreezeWorldMatrix(),this.front&&this.front.unfreezeWorldMatrix(),this}dispose(t,V){this.back&&!this.back.isDisposed()&&this.back.dispose(),this.front&&!this.front.isDisposed()&&(this.front.material&&this.front.material.dispose(!0),this.front.dispose(!1,!1)),super.dispose(t,V)}getNodeSize(t){return e.getMeshSize(this.back,t)}}const SR="card-back-material";function cR(t,V,X,K){return()=>{let k=t.getMaterialByName(SR);if(!k){const A=H.L.unwrap(X),$=new J.F(SR,t);$.diffuseTexture=mR(t,V,A,K),X instanceof H.L&&X.subscribe((X=>{$.diffuseTexture=mR(t,V,X,K)}),!1),$.specularColor.set(0,0,0),$.emissiveColor.set(1,1,1),$.forceDepthWrite=!0,k=$}return k}}function NR(t,V,X,K,k){const A=`card-${t}-front-material`,$=V.getMaterialByName(A);if($)return $;const I=new J.F(A,V);return I.diffuseTexture=mR(V,X,K,k),I.specularColor.set(0,0,0),I}function mR(t,V,X,K){const k=new x.g(X,t);return k.uScale=V.height/K.width,k.vScale=V.height/K.height,k.uOffset=V.x/K.width,k.vOffset=1-(V.y+2*V.height)/K.height,k}function vR(t,V){for(const X of t.meshes)X instanceof FR.e&&(X.name.endsWith(FV.CardStartPrefix)||X.name.endsWith(cV.TopPartPrefix))&&(X.material=V);e.swapSubMaterial(t,"riffle_deck_multi_mat","card_backside_materail_placeholder",V)}function WR(t,V){return new G.IU(t.x/V.width,1-(t.height+t.y)/V.height,t.width/V.width,t.height/V.height)}var ZR=X(600962);const DR=.5*-Math.PI,yR=.5*Math.PI,ER=-2e-4,_R=-.013;function pR(t,V,X={}){return new Promise((K=>{e.tweenTo({target:t,props:{position:V,rotation:new G.Pq(0,yR,0)}},.3,{onComplete:K,...X})}))}function LR(t,V){return zC(t,{position:new G.Pq(t.position.x,V,t.position.z)},.3)}var OR=X(340923);const rR=30,zR=2,wR=.06;function bR(t,V,X,K){const k=e.getMeshSize(t,!0);t.setParent(V);const A=t.position.clone(),$=e.createMultiStepAnimation({prop:"rotation",keys:[{frame:0,value:t.rotation.clone()},{frame:rR,value:new G.Pq(0,yR,M.S0.ToRadians(10))}]}),I=e.createMultiStepAnimation({prop:"position",keys:[{frame:0,value:A},{frame:rR/5,value:A.add(new G.Pq(0,-.03,0))},{frame:rR,value:new G.Pq(0,X,.5*K.x+.5*k.x+wR)}]}),C=$.getHighestFrame(),n=I.getHighestFrame();return new Promise((V=>{const X=new OR.p(C,(()=>{V()})),K=new OR.p(n/5,(()=>{t.getScene().beginDirectAnimation(t,[$],0,C,!1,zR)}));I.addEvent(K),I.addEvent(X),t.getScene().beginDirectAnimation(t,[I],0,n,!1,zR)}))}const aR=new G.Pq(.05,.2,0),uR=.15,jR=-.11,xR=.106,eR=.068,YR=new G.Pq(M.S0.ToRadians(-100),.5*Math.PI,0),HR=.5;e.AnimationFrameRate;class hR{constructor(t){this.autoCut=!1,this.waitForCut=!1,this.onDrag=(t,V)=>{const X=e.globalToLocal(V,this.deck);this.data.cutCards.front.position.y=UC.X.Clamp(X.y,ER,this.deckSize.y+_R),X.y=UC.X.Clamp(X.y,0,this.deckSize.y),t===e.DragState.Move&&this.onMove?this.onMove(this.calculateCutPlace(X)):t===e.DragState.End&&(this.cutHandler.notify(X),this.gesture.setPaused(!0))};const V=2.8;this.deck=t.straightDeck.deck,this.deckSize=t.straightDeck.fullDeckSize,this.deckButton=ZR.Jo.CreateBox(mV.CutAnimationButton,{width:this.deckSize.x*V,height:this.deckSize.y*V,depth:this.deckSize.z*V},this.deck.getScene()),this.deckButton.setParent(this.deck),this.deckButton.position.set(0,.5*this.deckSize.y,0),this.deckButton.rotation.set(0,0,0),this.deckButton.visibility=0,this.deckButton.isVisible=!1,this.gesture=e.addAction(this.deckButton.getScene(),new e.TapDrag({callback:this.onDrag,target:this.deckButton,DS:t.DS})),this.gesture.setPaused(!0),this.cutHandler=function(){let t;return{notify:V=>{t&&t(V)},onChange:V=>{t=V},unsubscribe:()=>{t=void 0}}}(),this.deckRotationWrapper=aC("deck_cutting"),this.playCuttingCardSound=t.playCuttingCardSound,this.playDeckInShoeSound=t.playDeckInShoeSound,this.playMoveDeckShortSound=t.playMoveDeckShortSound}async cutDeck(t,V){this.cutPercent=void 0,this.data=t,this.onMove=V.onMove,this.onStart=V.onStart,this.onWaitForInput=V.onWaitForInput,this.onAcquirePosition=V.onAcquirePosition,this.onEnd=V.onEnd,this.deckAnimationTangents=V.deckTangents,this.deckButton.isVisible=!0,this.deckButton.enablePointerMoveEvents=!0,this.deckButton.isPickable=!0,await this.playCutAnimation(),this.deckButton.enablePointerMoveEvents=!1,this.deckButton.isPickable=!1,this.deckButton.isVisible=!1,this.autoCut=!1,this.onMove=void 0,this.onStart=void 0,this.onWaitForInput=void 0,this.onAcquirePosition=void 0,void 0!==this.cutPercent&&V.onEnd(this.cutPercent),this.onEnd=void 0}cutAtRandomPlace(){this.autoCut=!0,this.waitForCut&&this.cutHandler.notify(this.createRandomCutPosition())}cutCardsAtPosition(t){if(this.autoCut=!1,this.waitForCut){const V=new G.Pq(0,this.percentToPosition(t),0);this.cutHandler.notify(V)}}moveCutCard(t){this.waitForCut&&(this.data.cutCards.front.position.y=this.percentToPosition(t))}cancel(){e.stopAnimationFor(this.data.cutCards.front,!1),e.stopAnimationFor(this.data.cutCards.back,!1),e.stopAnimationFor(this.deckRotationWrapper,!1),e.stopAnimationFor(this.data.straightDecks.left,!1),e.stopAnimationFor(this.data.straightDecks.total,!1),e.stopAnimationFor(this.data.straightDecks.right,!1),this.deckButton.enablePointerMoveEvents=!1,this.deckButton.isPickable=!1,this.deckButton.isVisible=!1,this.gesture.setPaused(!0),this.cutHandler.unsubscribe(),this.data.straightDecks.total.hide(),this.data.straightDecks.left.hide(),this.data.straightDecks.right.hide(),this.data.cutCards.back.isVisible=!1,this.data.cutCards.front.isVisible=!1,this.data.shoe.attachFrontCutCard(this.data.cutCards.front),this.data.cutCards.back.parent=null,this.onEnd&&void 0!==this.cutPercent&&this.onEnd(this.cutPercent),this.onEnd=void 0,this.onMove=void 0,this.onStart=void 0,this.onWaitForInput=void 0,this.onAcquirePosition=void 0,this.cutPercent=void 0}async playCutAnimation(){var t,V,X;const K=this.data.straightDecks.total,k=this.data.straightDecks.left,A=.5*this.deckSize.y;let $;var I,C,n,q,R,F;this.data.shoe.detachFrontCutCard(),this.data.shoe.detachBackCutCard(),this.data.shoe.setCardCount(0),this.data.holder.setCardCount(0),OC(this.deckRotationWrapper,this.data.placeholders.centre),this.deckRotationWrapper.position.x-=A,this.deckRotationWrapper.position.y+=.5*this.deckSize.x,OC(this.data.cutCards.front,this.data.placeholders.cutCardsPositions.front),OC(this.data.cutCards.back,this.data.placeholders.cutCardsPositions.back),e.changeVisibility(this.data.cutCards.front,!0,!0),e.changeVisibility(this.data.cutCards.back,!0,!0),K.deckHeight=this.deckSize.y,K.parent=this.deckRotationWrapper,K.position.set(this.deckSize.y,0,0),K.rotation.set(DR,yR,0),K.show(),k.deckHeight=this.deckSize.y,k.parent=this.deckRotationWrapper,k.position.set(0,0,0),k.rotation.copyFrom(K.rotation),k.hide(),await bR(this.data.cutCards.front,K,A,this.deckSize),this.autoCut?($=this.createRandomCutPosition(),this.cutPercent=this.calculateCutPlace($),null===(X=this.onAcquirePosition)||void 0===X||X.call(this,this.cutPercent),await LR(this.data.cutCards.front,$.y)):(this.waitForCut=!0,this.gesture.setPaused(!1),null===(t=this.onWaitForInput)||void 0===t||t.call(this),$=await this.waitForCutClick(),this.gesture.setPaused(!0),this.cutPercent=this.calculateCutPlace($),null===(V=this.onAcquirePosition)||void 0===V||V.call(this,this.cutPercent),this.waitForCut=!1,this.data.cutCards.front.position.y!==$.y&&await LR(this.data.cutCards.front,$.y)),await pR(this.data.cutCards.front,new G.Pq(KV.w7,$.y,KV.w7),{onStart:()=>{var t;null===(t=this.onStart)||void 0===t||t.call(this),this.playCuttingCardSound()}}),0!==$.y&&(k.deckHeight=this.deckSize.y-$.y,k.position.set(this.deckSize.y-$.y,0,0),this.data.cutCards.front.setParent(k),k.show(),this.data.cutCards.front.isVisible=!0,K.deckHeight=$.y,this.playMoveDeckShortSound(),await(R=this.deckRotationWrapper,F=-M.S0.ToRadians(25),new Promise((t=>{e.tweenTo({target:R,props:{"rotation.y":F}},.3,{onComplete:t})}))),await(I=k,C=K,n=this.deckSize,q=this.playMoveDeckShortSound,new Promise((t=>{const V=I.getScene(),X=.8*e.AnimationFrameRate,K=Math.floor(.85*X),k=[{frame:0,value:I.position.clone()},{frame:Math.floor(K/3),value:new G.Pq(I.position.x,I.position.y,I.position.z+n.z)},{frame:Math.floor(K/2),value:new G.Pq(I.position.x+C.deckHeight+I.deckHeight,0,I.position.z+n.z)},{frame:K,value:new G.Pq(I.position.x+C.deckHeight+I.deckHeight,0,I.position.z)},{frame:X,value:new G.Pq(I.position.x+C.deckHeight,0,I.position.z)}],A=e.createMultiStepAnimation({prop:"position",keys:k,easingMode:WC.KA.EASINGMODE_EASEINOUT,easingFunc:new WC.kc});e.addEventAtStart(A,q),e.addEventAt(A,Math.floor(K/3),q),e.addEventAt(A,Math.floor(K/2),q),e.addEventAt(A,K,q);const $=[{frame:0,value:C.position.clone()},{frame:K,value:C.position.clone()},{frame:X,value:C.position.subtract(new G.Pq(I.deckHeight,0,0))}];V.beginDirectAnimation(I,[A],0,X),V.beginDirectAnimation(C,[e.createMultiStepAnimation({prop:"position",keys:$,easingMode:WC.KA.EASINGMODE_EASEINOUT,easingFunc:new WC.kc})],0,X,!1,1,t)}))),K.deckHeight=this.deckSize.y,K.position.set(this.deckSize.y,0,0),k.hide());const s=this.deckSize.y/KV.UW;this.data.cutCards.front.setParent(K),this.data.cutCards.front.position.set(0,KV.w7,KV.w7),this.data.cutCards.front.isVisible=!0,await bR(this.data.cutCards.back,K,s,this.deckSize),await pR(this.data.cutCards.back,new G.Pq(KV.w7,s,KV.w7),{onStart:this.playCuttingCardSound}),this.data.shoe.setCardCount(KV.pP),this.data.shoe.deck.hide(),await async function(t,V,X,K,k){t.setParent(V.containerNode),await zC(t,{position:aR,rotation:YR},HR,{inTangent:null==k?void 0:k.inTangent,outTangent:null==k?void 0:k.outTangent}),await V.moveSliderToMax(),e.changeVisibility(t,!1,!0);const A=V.deck.position.clone();V.deck.position.y=uR,V.deck.position.x=jR,V.attachFrontCutCard(X.front);const $=X.front.position.clone();X.front.position.x+=eR,X.front.position.y+=xR,V.attachBackCutCard(X.back);const I=X.back.position.clone();X.back.position.x+=eR,X.back.position.y+=xR,V.deck.show(),await Promise.all([zC(V.deck,{position:A},.2,{onStart:K}),zC(X.back,{position:I},.2),zC(X.front,{position:$},.2)]),await V.moveSliderToDeck()}(K,this.data.shoe,this.data.cutCards,this.playDeckInShoeSound,this.deckAnimationTangents),e.changeVisibility(this.deckRotationWrapper,!1)}calculateCutPlace(t){return e.roundTo(1-t.y/this.deckSize.y,1)}percentToPosition(t){return UC.X.Clamp(e.roundTo(this.deckSize.y*(1-t),4),0,this.deckSize.y)}waitForCutClick(){return new Promise((t=>{this.cutHandler.onChange((V=>{t(V),this.cutHandler.unsubscribe()}))}))}createRandomCutPosition(){return new G.Pq(0,Tn.U4(0,this.deckSize.y,4),0)}}class TR extends pC{getNamePrefix(){return"GameResultHTMLMesh"}}function PR(t){return new TR({scene:t.scene,cameraManager:t.cameraManager,transportEmitters:t.emitters,content:{id:"game-result-message-3d"}})}class QR{constructor(t){this.gameResult=t.gameResult}setParent(t){t?(this.gameResult.mesh.parent=t,this.gameResult.show()):(this.gameResult.hide(),this.gameResult.mesh.parent=null)}dispose(){this.gameResult.dispose()}}class JR{constructor(t){this.onOrientationChange=()=>{if(!this.table)return;const t=this.props.getScoreNodes(this.table);if(this.nodes&&!i$.A(LX.A(this.nodes,(t=>t.id)),LX.A(t,(t=>t.id)))){this.nodes=t;for(const V of Object.keys(this.scores))this.scores[V].mesh.parent=t[V]}},this.props=t,this.scores=t.sides.reduce(((V,X)=>({...V,[X]:t.createScore({id:X})})),{}),t.shouldSubscribeOnResize&&t.scene.getEngine().onResizeObservable.add(this.onOrientationChange)}bindToTable(t){this.table=t,this.nodes=this.props.getScoreNodes(this.table);for(const t of Object.keys(this.scores))this.scores[t].mesh.parent=this.nodes[t],this.scores[t].show()}unbindFromTable(){this.table=void 0,this.nodes=void 0;for(const t of Object.keys(this.scores))this.scores[t].hide(),this.scores[t].mesh.parent=null}dispose(){this.props.shouldSubscribeOnResize&&this.props.scene.getEngine().onResizeObservable.removeCallback(this.onOrientationChange);for(const t of Object.values(this.scores))null==t||t.dispose()}}const UR=t=>V=>{let X;return X=t()===nt.t.Portrait?{[zK.Banker]:DV.RightScorePortrait,[zK.Player]:DV.LeftScorePortrait}:{[zK.Banker]:DV.RightScoreLandscapeMobile,[zK.Player]:DV.LeftScoreLandscapeMobile},LX.A(X,(t=>FX(V,(V=>V.endsWith(t)),!1)))};function lR(t){return LX.A({[zK.Banker]:DV.RightScoreLandscape,[zK.Player]:DV.LeftScoreLandscape},(V=>FX(t,(t=>t.endsWith(V)),!1)))}class iR extends pC{getNamePrefix(){return"ScoreMesh"}}function GR(t){return V=>new iR({id:V.id,scene:t.scene,cameraManager:t.cameraManager,transportEmitters:t.emitters,content:{id:V.id}})}class dR{constructor(t){this.elements={},this.props=t}dispose(){for(const t of Object.values(this.elements))t.dispose()}addElement(t,V){const X=this.props.createSkipCutCards({id:t});X.mesh.parent=V,X.show(),this.elements[t]=X}}class MR extends pC{getNamePrefix(){return"SkipCutCardsMesh"}}function BR(t){return V=>new MR({id:V.id,scene:t.scene,cameraManager:t.cameraManager,transportEmitters:t.emitters,content:{id:V.id}})}class oR{constructor(t){this.elements={},this.props=t}dispose(){for(const t of Object.values(this.elements))t.dispose()}addElement(t,V){const X=this.props.createTableBubble({id:t});X.mesh.parent=V,X.show(),this.elements[t]=X}}class fR extends pC{getNamePrefix(){return"TableButtonMesh"}}function gR(t){return V=>new fR({addReverseScale:!1,id:V.id,scene:t.scene,cameraManager:t.cameraManager,transportEmitters:t.emitters,content:{id:V.id}})}class tF extends e.Tooltip{constructor(t,V){super(t),this.isShow=!1,this.handleAfterHide=V.onAfterHideCallback,this.handleBeforeShow=V.onBeforeShowCallback}show(t){this.isShow||(this.isShow=!0,this.handleBeforeShow()),super.show(t)}hide(){super.hide(),this.isShow&&(this.isShow=!1,this.handleAfterHide())}getPositionOnScreen(){const t=super.getPositionOnScreen(),V=A.getReverseScale();return new G.Pq(t.x/V,t.y/V,t.z)}}const VF={[AI.Deal]:(XF=1,new class{constructor(t){this.value=t}getValue(){return this.value}setValue(t){this.value=t}}(XF))};var XF;class KF extends pq{constructor(t){super(t),this.setSpeedRatio=({payload:t})=>{this.props.ratios[t.speedRatioType].setValue(t.ratio),this.props.messageSender3d.from.speedRatioUpdated({speedRatioType:t.speedRatioType})},this.subscribeOnMessagesTo3D({[u.SetSpeedRatio]:this.setSpeedRatio})}}var kF=X(718284),AF=X(78350);function $F(t,V){const[X,K,k]=AF.K6(AF.E2(t,[255,255,255])),A=[Math.abs(X-10),Math.min(K+.8*K,100),Math.min(k+.5*(V-k),100)],[$,I,C]=AF.YL(A);return G.v9.FromInts($,I,C)}const IF=1,CF=60,nF=CF*IF,qF={[Wn.Idle]:0,[Wn.Multiplied]:1,[Wn.Hover]:.15,[Wn.Bet]:.23,[Wn.Win]:.48},RF=kF.A((function(t="#ffffff"){return{[Wn.Idle]:G.v9.White(),[Wn.Hover]:G.v9.White(),[Wn.Bet]:$F(t,75),[Wn.Multiplied]:G.v9.FromHexString("#ff7373"),[Wn.Win]:$F(t,38)}}));class FF{constructor(t,V,X="#ffffff",K,k,A){this.status=Wn.Idle,this.activeAnimations=[],this.mesh=t,this.basicMaterial=t.material,this.animationSettings=V,this.mesh.alphaIndex=.99,this.opacityMap=k?{...qF,...k}:qF;const $=RF(X);var I;this.colorConfig=A?{...$,...A}:$,this.pulsingAnimation=(I=this.opacityMap,e.createMultiStepAnimation({prop:"visibility",keys:[{frame:0,value:I[Wn.Bet]},{frame:.5*nF,value:I[Wn.Win]},{frame:nF,value:I[Wn.Bet]}],frameRate:CF})),this.mesh.visibility=this.opacityMap[this.status],this.dynamicHighlight=K,this.setHighlight(this.status)}setHighlight(t,V=!1,X){var K,k,A,$,I,C,n,q,R,F;if(this.status===Wn.Multiplied&&t===Wn.Multiplied&&this.dynamicHighlight)null===(k=null===(K=this.dynamicHighlight)||void 0===K?void 0:K.updateRunningAnimation)||void 0===k||k.call(K,X);else if((this.status!==t||V)&&(this.status!==Wn.Multiplied||t!==Wn.Bet)){if(this.status===Wn.Multiplied&&t===Wn.Win&&this.dynamicHighlight)return(null===($=null===(A=this.dynamicHighlight)||void 0===A?void 0:A.getMaterial)||void 0===$?void 0:$.call(A))||this.startColorTransitionAnimation(Wn.Idle,(()=>{this.changeMaterial(t),this.startPulsingAnimation()})),void(null===(C=(I=this.dynamicHighlight).restartAnimation)||void 0===C||C.call(I));t!==Wn.Multiplied&&this.status===Wn.Multiplied&&this.dynamicHighlight&&(null===(q=(n=this.dynamicHighlight).stopAnimation)||void 0===q||q.call(n)),this.stopActiveAnimations(),t===Wn.Win?this.startColorTransitionAnimation(Wn.Idle,(()=>{this.changeMaterial(t),this.startPulsingAnimation()})):t===Wn.Multiplied?(this.changeMaterial(t),null===(F=null===(R=this.dynamicHighlight)||void 0===R?void 0:R.startAnimation)||void 0===F||F.call(R,X),this.startColorTransitionAnimation(t)):t!==Wn.Idle||this.status!==Wn.Win&&this.status!==Wn.Multiplied&&this.status!==Wn.Bet?(this.changeMaterial(t),this.mesh.visibility=this.opacityMap[t]):this.startColorTransitionAnimation(t,(()=>{this.changeMaterial(t)})),this.status=t}}updateOrientation(){}dispose(){var t;this.stopActiveAnimations(),null===(t=this.dynamicHighlight)||void 0===t||t.dispose()}stopActiveAnimations(){for(const t of this.activeAnimations)t.stop();this.activeAnimations=[]}startColorTransitionAnimation(t,V){this.animationSettings.onStart();const X=e.tweenTo({target:this.mesh,props:{visibility:this.opacityMap[t]}},.5*IF,{onComplete:()=>{this.animationSettings.onComplete(),null==V||V()},onCancel:()=>{this.animationSettings.onComplete()}});this.activeAnimations.push(X)}startPulsingAnimation(){this.animationSettings.onStart(),this.stopActiveAnimations();const t=this.mesh.getScene().beginDirectAnimation(this.mesh,[this.pulsingAnimation],0,nF,!jk.I(),1,this.animationSettings.onComplete);this.activeAnimations.push(t)}changeMaterial(t){var V,X;const K=null===(X=null===(V=this.dynamicHighlight)||void 0===V?void 0:V.getMaterial)||void 0===X?void 0:X.call(V);if(t===Wn.Multiplied&&K)this.mesh.material=K;else{const V=this.basicMaterial;V.emissiveColor=this.colorConfig[t],this.mesh.material=V}}}class sF{constructor(t){this.time=Date.now(),this.trigger=()=>{this.time=Date.now()},this.threshold=t}get inProgress(){return Date.now()-this.time<this.threshold}}const SF=50;class cF extends pq{constructor(t){super(t),this.currentTable=null,this.needReceiveBalance=!1,this.handleOrientation=t=>{const V=this.props.tableManager.table;V&&this.updateSpotsOnOrientation(V,t.payload)},this.dragAction=(t,V,X)=>{var K;switch(t){case e.DragState.Start:this.props.messageSender3d.to.moveBetStart({betSpotFrom:V}),this.props.messageSender3d.from.moveBetStarted({betSpotFrom:V}),e.addShadowUpdateFor(this.props.scene,this.props.shadowLightName);break;case e.DragState.End:{const t=function(t){if(!t)return;const V=t.split(".");return V[V.length-2]}(null===(K=null==X?void 0:X.pickedMesh)||void 0===K?void 0:K.name);e.removeShadowUpdateFor(this.props.scene,this.props.shadowLightName),this.props.messageSender3d.from.moveBetDone({betSpotFrom:V,betSpotTo:null!=t?t:C.iG});break}case e.DragState.Cancel:e.removeShadowUpdateFor(this.props.scene,this.props.shadowLightName),this.props.messageSender3d.from.moveBetDone({betSpotFrom:V,betSpotTo:V})}},this.tooltipsChecker=new sF(SF),this.currentGridType=t.bettingGridType;const V={color:this.props.getClothColor(),animationSettings:(X=this.props.messageSender3d,{onStart:()=>X.to.highlightSpotStart(),onComplete:()=>X.from.highlightSpotDone()}),getBetSpotDynamicHighlight:t.getBetSpotDynamicHighlight,opacityMap:t.spotOpacityMap,colorConfig:t.highlightColorConfig};var X;this.highlightMaterialFactory=t.highlightMaterialFactoryCreator?t.highlightMaterialFactoryCreator(V):(({color:t,animationSettings:V,getBetSpotDynamicHighlight:X,opacityMap:K,colorConfig:k})=>A=>new FF(A,V,t,null==X?void 0:X(A),K,k))(V),this.initTableComponents(t.tableManager),this.subscribeOnMessagesTo3D({[u.AddTooltip]:this.updateTooltip.bind(this),[u.UpdateBets]:this.updateChips.bind(this),[u.UpdateLockedSpots]:this.updateLockedSpots.bind(this),[u.PlaceBet]:this.placeBet.bind(this),[u.TableReady]:this.setupTable.bind(this),[u.BalanceUpdate]:this.updateChipStack.bind(this),[u.SelectChip]:this.updateSelectedChip.bind(this),[u.ChangeBettingGridType]:this.updateBettingGrid.bind(this),[u.PulseWinning]:this.pulseWinning.bind(this),[u.SetBettingOpen]:this.setBettingOpen.bind(this),[u.PlaceChipsOnTable]:this.handlePlaceChipsOnTable.bind(this),[u.ChangeOrientation]:this.handleOrientation}),this.handleSelectedChipChange=this.handleSelectedChipChange.bind(this),this.handleChipStackSelectedAnimation=this.handleChipStackSelectedAnimation.bind(this),this.handleChipBreakAnimation=this.handleChipBreakAnimation.bind(this)}initTableComponents(t){t.table&&this.setupTableInfo(t.table)}setupTableInfo(t){var V,X,K;null===(V=t.chipstack)||void 0===V||V.selectChipStack(this.props.selectedChip),null===(X=t.bettingGrid)||void 0===X||X.setupBettingGrid({type:this.props.bettingGridType}),this.props.setupSpotsOnInit&&(null===(K=t.bettingGrid)||void 0===K||K.setupBettingGridSpots({tooltipManager:this.props.tooltipManager,highlightMaterialFactory:this.highlightMaterialFactory,actions:this.getSpotActions(),chipAnimationSettings:this.getFlyingChipsAnimationSettings()}))}updateSpotsOnOrientation(t,V){var X,K;const k=null===(K=null===(X=t.bettingGrid)||void 0===X?void 0:X.grid)||void 0===K?void 0:K.spots;k&&Object.values(k).forEach((t=>{t.updateOrientation(V)}))}updateTableChipstackAmount(t){var V;const X=this.props.tableManager.table;X&&(null===(V=X.chipstack)||void 0===V||V.updateAmount(t,!0))}setupBettingGridType(t){var V;const X=this.props.tableManager.table;X&&(null===(V=X.bettingGrid)||void 0===V||V.setupBettingGrid({type:t}))}setupTable(t){var V,X,K,k,A;const{chipValue:$,balance:I}=t.payload;if(this.disposeTable(),this.props.tableManager.table&&(this.currentTable=this.props.tableManager.table,null===(V=this.currentTable)||void 0===V?void 0:V.chipstack)){this.props.selectedChip=$,this.currentTable.chipstack.createUpdateUserSelect((t=>{var V;if(t===e.TapState.End&&(null===(V=this.currentTable)||void 0===V?void 0:V.chipstack)){const t=this.currentTable.chipstack.getSelectedChipStack();this.props.selectedChip=t,this.props.messageSender3d.from.selectedChip({chipValue:t})}}));const t=this.currentTable.chipstack;t.on(e.ChipSelectorEvent.ChipStackSelected,this.handleSelectedChipChange),t.on(e.ChipSelectorEvent.AnimationChipStackSelectedStart,this.handleChipStackSelectedAnimation),t.on(e.ChipSelectorEvent.AnimationChipStackSelectedEnd,this.handleChipStackSelectedAnimation),t.on(e.ChipSelectorEvent.AnimationChipBreakDownStart,this.handleChipBreakAnimation),t.on(e.ChipSelectorEvent.AnimationChipBreakDownEnd,this.handleChipBreakAnimation),I&&I>=$&&t.selectChipStack($),"number"==typeof I&&t.updateAmount(I),this.props.setupSpotsOnInit||null===(X=this.currentTable.bettingGrid)||void 0===X||X.setupBettingGridSpots({chipAnimationSettings:this.getFlyingChipsAnimationSettings(),actions:this.getSpotActions(),highlightMaterialFactory:this.highlightMaterialFactory,tooltipManager:this.props.tooltipManager}),null===(K=this.props.scoreManager)||void 0===K||K.bindToTable(this.currentTable.table);const V=FX(this.currentTable.table,(t=>t.endsWith(RV.SkipCutButtons)),!1);this.props.cutCardsSliderManager.addElement(vV.Slider,V),this.props.cutCardsSliderManager.addElement(RV.SkipShuffleButton,V),null===(k=this.props.tableBubbleManager)||void 0===k||k.addElement(RV.PlaceHolderPrefix,V);const C=FX(this.currentTable.table,(t=>t.endsWith(RV.WinMessage)),!1);null===(A=this.props.gameResultManager)||void 0===A||A.setParent(C),this.props.messageSender3d.to.placeChipsOnTable()}}updateChipStack(t){var V,X;const{balance:K}=t.payload;if("number"==typeof K){if(this.currentTable){this.lastReceivedBalance=K,this.needReceiveBalance||null===(V=this.currentTable.chipstack)||void 0===V||V.updateAmount(K);const t=this.props.selectedChip,k=null===(X=this.currentTable.chipstack)||void 0===X?void 0:X.getSelectedChipStack();t&&k!==t&&t<K&&this.props.messageSender3d.from.selectedChip({chipValue:t})}else this.updateTableChipstackAmount(K);this.props.messageSender3d.from.balanceUpdateDone()}}updateBettingGrid(t){var V,X;const{gridType:K}=t.payload;this.currentGridType!==K&&(this.props.tooltipManager.dispose(),this.currentGridType=K,this.setupBettingGridType(K),null===(X=null===(V=this.currentTable)||void 0===V?void 0:V.bettingGrid)||void 0===X||X.setupBettingGridSpots({tooltipManager:this.props.tooltipManager,highlightMaterialFactory:this.highlightMaterialFactory,actions:this.getSpotActions(),chipAnimationSettings:this.getFlyingChipsAnimationSettings()})),this.props.messageSender3d.from.changeBettingGridTypeDone()}handleChipBreakAnimation(t){t.type===e.ChipSelectorEvent.AnimationChipBreakDownStart?this.props.messageSender3d.to.breakDownChipAnimationStart():this.props.messageSender3d.from.breakDownChipAnimationEnd()}handleChipStackSelectedAnimation(t){t.type===e.ChipSelectorEvent.AnimationChipStackSelectedStart?this.props.messageSender3d.to.selectChipAnimationStart():this.props.messageSender3d.from.selectChipAnimationEnd()}handlePlaceChipsOnTable(){var t,V;null===(V=null===(t=this.currentTable)||void 0===t?void 0:t.chipstack)||void 0===V||V.animateChipsPlacement().then((()=>{this.props.messageSender3d.from.placeChipsOnTableDone()}))}updateTooltip(t){const V=t.payload.type,X=t.payload.label;if(this.currentTable&&V&&this.currentTable.bettingGrid){const t=this.currentTable.bettingGrid.getSpots();if(t){const K=t[V];if(!this.tooltipsChecker.inProgress)for(const V of Object.values(t))K!==V&&V.setTooltipState(!1);this.tooltipsChecker.trigger(),K&&(K.updateTooltip({label:X}),K.setTooltipState(!0))}}}pulseWinning(t){var V,X;const K=t.payload.winningBetSpots.reduce(((t,V)=>({...t,[V]:!0})),{}),k=null===(X=null===(V=this.currentTable)||void 0===V?void 0:V.bettingGrid)||void 0===X?void 0:X.getSpots();k&&Object.keys(k).forEach((t=>k[t].setPulsing(!!K[t])))}async placeBet(t){if(!this.currentTable)return;const{bets:V,locked:X}=t.payload;await this.updateBetSpotAmounts(V,X,!0),this.props.messageSender3d.from.placeBetDone()}async updateChips(t){var V,X;if(!this.currentTable)return void this.props.messageSender3d.from.updateBetsDone();const{bets:K,locked:k,winning:A}=t.payload;Object.keys(A).length&&(this.needReceiveBalance=!0),await this.updateBetSpotAmounts(K,k,!1);const $=null===(X=null===(V=this.currentTable)||void 0===V?void 0:V.bettingGrid)||void 0===X?void 0:X.getSpots();if($)for(const t of Object.values($)){const V=t.spotName;t.setWinning(A[V],A[V]?this.updateChipStackCallback.bind(this):void 0)}e.forceShadowUpdate(this.props.scene,this.props.shadowLightName),this.props.messageSender3d.from.updateBetsDone()}updateLockedSpots(t){if(!this.currentTable)return;const{locked:V}=t.payload;if(!this.currentTable.bettingGrid)return;const X=this.currentTable.bettingGrid.getSpots();if(X)for(const t of Object.values(X))t.setLocked(V.includes(t.spotName))}async updateBetSpotAmounts(t,V,X){var K,k;if(!this.currentTable)return;const A=null===(K=this.currentTable.bettingGrid)||void 0===K?void 0:K.getSpots();if(!A)return;const $=[];for(const K of Object.values(A))$.push(K.setAmount(null!==(k=t[K.spotName])&&void 0!==k?k:0,X)),K.setLocked(V.includes(K.spotName));await Promise.all($)}updateChipStackCallback(){var t,V;"number"==typeof this.lastReceivedBalance&&this.needReceiveBalance&&(this.props.sounds.playChipStackSound(),null===(V=null===(t=this.currentTable)||void 0===t?void 0:t.chipstack)||void 0===V||V.updateAmount(this.lastReceivedBalance),this.needReceiveBalance=!1)}updateSelectedChip(t){var V,X;const{chipValue:K}=t.payload;null===(X=null===(V=this.currentTable)||void 0===V?void 0:V.chipstack)||void 0===X||X.selectChipStack(K)}disposeTable(){var t,V,X,K;if(this.currentTable){null===(t=this.currentTable.chipstack)||void 0===t||t.disable(),null===(V=this.currentTable.bettingGrid)||void 0===V||V.dispose(),this.props.tooltipManager.dispose(),null===(X=this.props.scoreManager)||void 0===X||X.unbindFromTable(),this.props.cutCardsSliderManager.dispose(),null===(K=this.props.gameResultManager)||void 0===K||K.setParent();const k=this.currentTable.chipstack;if(!k)return;k.removeEvent(e.ChipSelectorEvent.ChipStackSelected,this.handleSelectedChipChange),k.removeEvent(e.ChipSelectorEvent.AnimationChipStackSelectedStart,this.handleChipStackSelectedAnimation),k.removeEvent(e.ChipSelectorEvent.AnimationChipStackSelectedEnd,this.handleChipStackSelectedAnimation),k.removeEvent(e.ChipSelectorEvent.AnimationChipBreakDownStart,this.handleChipBreakAnimation),k.removeEvent(e.ChipSelectorEvent.AnimationChipBreakDownEnd,this.handleChipBreakAnimation),this.currentTable=null}}getSpotActions(){return{hover:this.hoverAction.bind(this),tap:this.tapAction.bind(this),drag:this.dragAction.bind(this)}}getFlyingChipsAnimationSettings(){return{onStart:()=>{this.props.messageSender3d.to.flyingChipAnimationStart()},onComplete:()=>{this.props.messageSender3d.from.flyingChipAnimationDone()}}}hoverAction(t,V){V===e.HoverState.Over&&this.props.messageSender3d.to.hoverSpotStart(),V===e.HoverState.Out&&this.props.messageSender3d.from.hoverSpotDone()}tapAction(t){this.props.messageSender3d.from.betSpotPressed({betSpot:t})}handleSelectedChipChange(t){this.currentTable&&t.type===e.ChipSelectorEvent.ChipStackSelected&&this.props.messageSender3d.from.selectedChip({chipValue:t.payload,withoutSave:!0})}setBettingOpen(t){var V,X;null===(X=null===(V=this.currentTable)||void 0===V?void 0:V.bettingGrid)||void 0===X||X.setInteractions(t.payload.isBettingOpen)}}function NF(t,V,X){const K=t.clone();return X||(K.y+=Math.PI),V&&(K.y+=pn),X&&(K[mF(V)]=On),K}function mF(t){return t?"z":"x"}function vF(t,V){return jn*(V?2:1)*t}async function WF(t,V,X,K){const k=e.getMeshSize(t),A=mF(V),$=t.position.y,I=t.rotation[A],C=`rotation.${A}`,n={"position.y":$+k.z+.015,[C]:I+Ln},q={"position.y":$,[C]:I+On};await function(t,V,X,K={}){return new Promise((k=>{e.tweenTo({target:t,props:V,settings:{easingFunc:new WC.E8,easingMode:WC.KA.EASINGMODE_EASEIN}},$I(an,X),{...K,onComplete:()=>{var t;null===(t=K.onComplete)||void 0===t||t.call(K),k()}})}))}(t,n,X,{onStart:K}),await function(t,V,X){return new Promise((K=>{e.tweenTo({target:t,props:V,settings:{easingFunc:new WC.vm,easingMode:WC.KA.EASINGMODE_EASEOUT}},$I(un,X),{onComplete:K})}))}(t,q,X)}function ZF(t,V,X,K,k=zn,A){return new Promise(($=>{for(let I=0;I<t.length;I++){const C=t[I];C.setParent(V);const n=Math.round(C.rotation.z/Math.PI)*Math.PI,q={position:new G.Pq(0,rn*I,0)};X&&(q["rotation.y"]=0,q["rotation.z"]=n),e.tweenTo({target:C,props:q},k,{delay:.05*I,easingFunc:new WC.E8,easingMode:WC.KA.EASINGMODE_EASEINOUT,onStart:0===I?K:void 0,onComplete:I===t.length-1?()=>{A&&A(C),$()}:void 0})}}))}function DF(t,V,X,K,k){const A=e.durationToFrames(V),$=e.createMultiStepAnimation({prop:"position",keys:[{frame:0,value:e.globalToLocal(t.cardSlideStart.getAbsolutePosition(),X)},{frame:A,value:e.globalToLocal(t.cardSlideEnd.getAbsolutePosition(),X)}]}),I=e.createMultiStepAnimation({prop:"rotation",keys:[{frame:0,value:e.convertRotationSpace(t.cardSlideStart,X)},{frame:A,value:e.convertRotationSpace(t.cardSlideEnd,X)}]});return e.addEventAtStart($,K),e.addEventAtEnd($,k),{position:$,rotation:I}}function yF(t,V){for(const X of t)"position"===X.targetProperty?EF(X,V.position):"rotation"===X.targetProperty?EF(X,V.rotation):_F(X,V.position.getHighestFrame()+1);return t}function EF(t,V){const X=V.getHighestFrame()+1,K=V.getKeys(),k=V.getEvents(),A=t.getKeys(),$=t.getEvents();A.shift(),pF(A,X),LF($,X),t.setKeys(K.concat(A));for(const V of k)t.addEvent(V)}function _F(t,V){const X=t.getKeys(),K=t.getEvents(),k={frame:0,value:X[0].value};pF(X,V),LF(K,V),X.unshift(k)}function pF(t,V){for(const X of t)X.frame+=V}function LF(t,V){for(const X of t)X.frame+=V,X.isDone=!1}function OF(t,V,X,K,k,A,$,I){return new Promise((C=>{const n=e.globalToLocal(X.cardSlideEnd.getAbsolutePosition(),t.parent),q=e.convertRotationSpace(X.cardSlideEnd,t.parent),R=t.getScene(),F=Math.ceil(e.AnimationFrameRate*$),s=DF(X,A,t.parent,k,(()=>{X.decreaseCardCount(),I||C()})),S=[e.createMultiStepAnimation({prop:"position",keys:[{frame:0,value:n},{frame:F,value:V}]}),e.createMultiStepAnimation({prop:"rotation",keys:[{frame:0,value:q},{frame:F,value:NF(new G.Pq(0,0,K),!1,!1)}]})],c=e.addEasing(yF(S,s),new WC.E8,WC.KA.EASINGMODE_EASEIN);R.beginDirectAnimation(t,c,0,e.getAnimationLength(c),!1,1,I?C:void 0)}))}const rF=M.S0.ToRadians(2.9);class zF extends pq{constructor(t){super(t),this.handleBurnCards=({payload:t})=>{const{first:V,burned:X}=t;this.burnCards(V,X)},this.subscribeOnMessagesTo3D({[u.BurnCards]:this.handleBurnCards})}async burnCards(t,V){const X=this.props.tableManager.table;if(!X)return;const K=X.cardsOnTable,k=X.discardPile,A=X.tableCenterPosition,$=this.props.cardCreator(t),I=e.getMeshSize($,!0),C=.01,n=Math.min(I.x,I.z),q=n+C+.5*n*V,R=A.x-.5*q,F=R+n+C,s=new G.Pq(R,A.y,A.z),S=new G.Pq(F,A.y,A.z);e.addShadowUpdateFor(this.props.scene,this.props.shadowLight),K.addCardForHand($,this.props.leftHand),await this.animateFirstCard(X.shoe,$,s,X.table),await this.animateBurnedCards(t,S,V,X.table),await this.moveToPile(),e.removeShadowUpdateFor(this.props.scene,this.props.shadowLight),K.clearCards(),k.node.getChildren().forEach((t=>t.dispose())),k.node.position.copyFrom(k.position),k.node.rotation.copyFrom(k.rotation),k.node.scaling.copyFrom(k.scaling),this.props.messageSender3d.from.burnCardsDone()}async animateFirstCard(t,V,X,K){e.addMeshToShadowGenerator(V,this.props.shadowLight),V.setParent(K),await function(t,V,X,K,k){const A=e.globalToLocal(X.cardSlideEnd.getAbsolutePosition(),t.parent),$=e.convertRotationSpace(X.cardSlideEnd,t.parent),I=t.getScene(),C=e.getMeshSize(t),n=A.y+C.z+.01,q=Math.ceil(.5*e.AnimationFrameRate),R=Math.floor(.5*q),F=G.Pq.Lerp(A,V,.5);F.y=n;const s=DF(X,k,t.parent,K,(()=>{X.decreaseCardCount()})),S=[e.createMultiStepAnimation({prop:"position",keys:[{frame:0,value:A},{frame:R,value:F},{frame:q,value:V}]}),e.createMultiStepAnimation({prop:"rotation",keys:[{frame:0,value:$},{frame:q,value:new G.Pq(0,0,Math.PI)}]})],c=e.addEasing(yF(S,s),new WC.E8,WC.KA.EASINGMODE_EASEINOUT);return I.beginDirectAnimation(t,c,0,e.getAnimationLength(c),!1).waitAsync()}(V,X,t,this.props.playSlideCardFromShoeSound,bn)}async animateBurnedCards(t,V,X,K){const k=this.props.tableManager.table;if(!k)return;const{shoe:A,cardsOnTable:$}=k;for(let k=0;k<X;k++){const I=this.props.cardCreator(t);$.addCardForHand(I,this.props.rightHand);const C=e.getMeshSize(I);e.addMeshToShadowGenerator(I,this.props.shadowLight),I.setParent(K);const n=(C.y||rn)+8e-4,q=new G.Pq(C.x*k,0===k?n:n+.0025,0);await OF(I,V.add(q),A,0===k?0:rF,this.props.playSlideCardFromShoeSound,bn,.1,k===X-1)}}async moveToPile(){const t=this.props.tableManager.table;if(!t)return;const{discardPile:V,cardHolder:X,cardsOnTable:K}=t,k=K.getAllCards();V.node.isWorldMatrixFrozen&&V.node.unfreezeWorldMatrix(),await WF(K.getCardsForHandAt(this.props.leftHand,0),!1,this.props.speedRatio,this.props.playCardFlipSound),await ZF(k,V.node,!1,this.props.playCollectCardsSound,zn,(t=>{t.rotation.z=0})),await X.animateCardsToHolder(V.node,k.length,wn,!1)}}class wF extends pq{constructor(t){super(t),this.isCutting=!1,this.handleCutCard=({payload:t})=>{if(!this.isCutting){this.isCutting=!0;const{token:V,deckTangents:X}=t;this.cutCards(V,X)}},this.autoCut=()=>{this.props.animation.cutAtRandomPlace()},this.moveCutCard=({payload:t})=>{this.props.animation.moveCutCard(t.position),this.move(t.position)},this.cutCardsAtPosition=({payload:t})=>{this.props.animation.cutCardsAtPosition(t.position)},this.subscribeOnMessagesTo3D({[u.CutCards]:this.handleCutCard,[u.AutoCut]:this.autoCut,[u.MoveCutCard]:this.moveCutCard,[u.CutCardsAtPosition]:this.cutCardsAtPosition})}cutCards(t,V){t.onCancel((()=>{this.isCutting&&(this.isCutting=!1,this.props.animation.cancel(),e.removeShadowUpdateFor(this.props.scene,this.props.shadowLight),this.props.messageSender3d.from.cutCardsCancelled())})),e.addShadowUpdateFor(this.props.scene,this.props.shadowLight),this.props.animation.cutDeck(this.props.shuffleDataManager.deckCutAnimationData,{onStart:()=>{this.props.messageSender3d.from.cutCardsStart()},onMove:PA.A((t=>this.move(t)),50),onWaitForInput:()=>{this.props.messageSender3d.from.cutCardsWaitForInput()},onAcquirePosition:t=>{this.props.messageSender3d.from.cutCardsAquirePosition({position:t})},onEnd:t=>{this.isCutting=!1,e.removeShadowUpdateFor(this.props.scene,this.props.shadowLight),this.props.messageSender3d.from.cutCardsDone({position:t})},deckTangents:V})}move(t){this.props.messageSender3d.from.cutCardMove({position:t})}}function bF(t,V,X){const K=e.durationToFrames(X),k=G.Pq.Lerp(t.from,t.to,.5);return k.y+=.08,[e.createMultiStepAnimation({prop:"rotation",keys:[{frame:0,value:V.from},{frame:K,value:V.to}]}),e.createMultiStepAnimation({prop:"position",keys:[{frame:0,value:t.from},{frame:Math.floor(.5*K),value:k},{frame:K,value:t.to}]})]}function aF(t){return 2===t}class uF extends pq{constructor(t){super(t),this.lastAnimationData=[],this.dealCard=async({payload:t})=>{const{placeHolder:V,card:X}=t;this.currentDealState||(this.currentDealState={[zK.Player]:0,[zK.Banker]:0});const K=this.currentDealState[V];await this.playCardDealAnimation(X,V,K),this.currentDealState[V]=K+1,this.props.messageSender3d.from.cardDealt({card:X,placeHolder:V})},this.dealOpenCard=async({payload:t})=>{const{placeHolder:V,card:X,cardPlace:K}=t;await this.playCardDealAnimation(X,V,K,!0),this.props.messageSender3d.from.cardDealtOpen({card:X,placeHolder:V,cardPlace:K})},this.openCard=async({payload:t})=>{const{placeHolder:V,cardPlace:X}=t;await this.playCardOpenAnimation(X,V),this.props.messageSender3d.from.cardOpen({cardPlace:X,placeHolder:V})},this.removeCards=async({payload:t})=>{await this.playRemoveCardsAnimation(t.flip),this.props.messageSender3d.from.cardsRemoved()},this.changeOrientation=({payload:t})=>{this.onOrientationChange(t)},this.lastOrientation=t.orientation,this.subscribeOnMessagesTo3D({[u.DealCard]:this.dealCard,[u.DealOpenCard]:this.dealOpenCard,[u.OpenCard]:this.openCard,[u.RemoveCards]:this.removeCards,[u.ChangeOrientation]:this.changeOrientation}),this.cardPlaceholderPicker.bind(this)}cardPlaceholderPicker(t){const{hand:V,cardPlace:X}=t,K=this.props.tableManager.table;if(K)return this.lastOrientation===nt.t.Portrait&&2===X?K.handSpotNodes[V][X+1]:K.handSpotNodes[V][X]}onOrientationChange(t){if(this.lastOrientation!==t){this.lastOrientation=t;for(const t of this.lastAnimationData){t.animation.stop();const V=this.cardPlaceholderPicker(t);V&&(t.cardMesh.position.copyFrom(V.position),t.cardMesh.rotation.y=-Math.PI/2)}}}async playCardDealAnimation(t,V,X,K=!1){var k;const A=this.props.tableManager.table;if(!A)return;const $=this.props.cardCreator(t);e.addMeshToShadowGenerator($,this.props.shadowLight),e.addShadowUpdateFor(this.props.scene,this.props.shadowLight),A.cardsOnTable.addCardForHand($,V),$.setParent(A.table);const I=function(t,V,X,K,k,A,$,I,C){const n=V.shoe,q=C({hand:X,cardPlace:k});if(!q)return;const R=aF(k),F=e.globalToLocal(n.cardSlideEnd.getAbsolutePosition(),t.parent),s=e.globalToLocal(q.getAbsolutePosition(),t.parent),S=G.Pq.Distance(F,s),c=t.getScene(),N=$I(vF(S,A),K.speedRatio),m=e.convertRotationSpace(n.cardSlideEnd,t.parent),v=e.convertRotationSpace(q,t.parent),W=DF(n,I,t.parent,$,(()=>{n.decreaseCardCount()})),Z=bF({from:F,to:s},{from:m,to:NF(v,R,A)},N),D=e.addEasing(yF(Z,W),new WC.E8,WC.KA.EASINGMODE_EASEIN);return c.beginDirectAnimation(t,D,0,e.getAnimationLength(D),!1)}($,A,V,this.props,X,K,this.props.playSlideCardFromShoeSound,$I(bn,this.props.speedRatio),this.cardPlaceholderPicker.bind(this));I&&((null===(k=this.props.orientationDependentPositions)||void 0===k?void 0:k.includes(X))&&this.lastAnimationData.push({cardMesh:$,cardPlace:X,hand:V,animation:I}),await I.waitAsync(),e.removeShadowUpdateFor(this.props.scene,this.props.shadowLight))}async playCardOpenAnimation(t,V){const X=this.props.tableManager.table;if(!X)return;const K=X.cardsOnTable.getCardsForHandAt(V,t),k=aF(t);e.addShadowUpdateFor(this.props.scene,this.props.shadowLight),await WF(K,k,this.props.speedRatio,this.props.playCardFlipSound),e.removeShadowUpdateFor(this.props.scene,this.props.shadowLight)}async playRemoveCardsAnimation(t){const V=this.props.tableManager.table;if(!V)return;const X=V.discardPile;X.node.isWorldMatrixFrozen&&X.node.unfreezeWorldMatrix();const K=V.cardHolder,k=V.cardsOnTable.getAllCards();for(const t of k)t.getFrontMaterial().diffuseColor=G.v9.FromHexString("#FFFFFF");e.addShadowUpdateFor(this.props.scene,this.props.shadowLight),await ZF(k,X.node,!0,this.props.playCollectCardsSound,$I(zn,this.props.speedRatio)),await K.animateCardsToHolder(X.node,k.length,$I(wn,this.props.speedRatio),t),e.removeMeshFromShadowGenerator(X.node,this.props.shadowLight),e.removeShadowUpdateFor(this.props.scene,this.props.shadowLight),this.currentDealState=void 0,this.lastAnimationData=[],V.cardsOnTable.clearCards(),X.node.getChildren().forEach((t=>t.dispose())),X.node.position.copyFrom(X.position),X.node.rotation.copyFrom(X.rotation),X.node.scaling.copyFrom(X.scaling)}}const jF=new G.v9(.7,.7,.7),xF=new G.v9(.05,.05,.05);function eF(t){t.useEmissiveAsIllumination=!0;const V=new e.TweenGroup;return V.add(new e.Tween([{target:t,props:"emissiveColor"in t?{emissiveColor:jF}:{}}],.4,{easingFunc:new WC.vm,easingMode:WC.KA.EASINGMODE_EASEIN})).add(new e.Tween([{target:t,props:"emissiveColor"in t?{emissiveColor:xF}:{}}],1,{easingFunc:new WC.vm,easingMode:WC.KA.EASINGMODE_EASEOUT})).play(),V}class YF extends pq{constructor(t){super(t),this.handleHighlightHand=({payload:t})=>{this.highLightHand(t.hand)},this.handleDimHand=({payload:t})=>{this.dimHand(t.hand)},this.subscribeOnMessagesTo3D({[u.HighlightHand]:this.handleHighlightHand,[u.DimHand]:this.handleDimHand})}highLightHand(t){const V=this.props.tableManager.table;if(!V)return;const X=V.cardsOnTable.getCardsForHand(t);for(const t of X)eF(t.getFrontMaterial())}dimHand(t){const V=this.props.tableManager.table;if(!V)return;const X=V.cardsOnTable.getCardsForHand(t);for(const t of X)K=t.getFrontMaterial(),e.tweenTo({target:K,props:"diffuseColor"in K?{diffuseColor:G.v9.FromHexString("#BCBCBC")}:{}},.5,{easingFunc:new WC.vm,easingMode:WC.KA.EASINGMODE_EASEOUT});var K}}class HF extends pq{constructor(t){super(t),this.isShuffling=!1,this.handleShuffleCards=({payload:t})=>{if(!this.isShuffling){this.isShuffling=!0;const{shortShuffle:V,token:X}=t;this.cutCards=this.props.shuffleDataManager.shuffleBurnData.cutCards,this.shuffleCards(V,X)}},this.subscribeOnMessagesTo3D({[u.ShuffleCards]:this.handleShuffleCards})}async shuffleCards(t,V){V.onCancel((()=>{this.isShuffling&&(this.props.shuffleDataManager.deckShuffleAnimation.cancel(),e.removeShadowUpdateFor(this.props.scene,this.props.shadowLight),this.removeCutCardsFromShadowGenerator(),this.isShuffling=!1,this.props.messageSender3d.from.shuffleCardsDone())})),e.addShadowUpdateFor(this.props.scene,this.props.shadowLight),this.addCutCardsToShadowGenerator(),await this.props.shuffleDataManager.deckShuffleAnimation.playShuffleAnimation(t),this.isShuffling=!1,V.active&&(e.removeShadowUpdateFor(this.props.scene,this.props.shadowLight),this.removeCutCardsFromShadowGenerator(),this.props.messageSender3d.from.shuffleCardsDone())}addCutCardsToShadowGenerator(){e.addMeshToShadowGenerator(this.cutCards.front,this.props.shadowLight),e.addMeshToShadowGenerator(this.cutCards.back,this.props.shadowLight)}removeCutCardsFromShadowGenerator(){e.removeMeshFromShadowGenerator(this.cutCards.front,this.props.shadowLight),e.removeMeshFromShadowGenerator(this.cutCards.back,this.props.shadowLight)}}class hF extends pq{constructor(t){super(t),this.subscribeOnMessagesTo3D({[u.ChangeCursor]:this.handleChangeCursor.bind(this)}),this.observer=this.props.scene.onPointerObservable.add(this.handlePointerMove.bind(this)),t.DS.IS_DESKTOP&&e.addAction(t.scene,new e.CursorHover({DS:t.DS,exclude:[new RegExp(ZV.HighlightPrefix)]}))}dispose(){this.props.scene.onPointerObservable.remove(this.observer),super.dispose()}handlePointerMove(){var t;const{scene:V}=this.props,X=V.pick(V.pointerX,V.pointerY),K=this.props.scene.defaultCursor;let k;if(null==X?void 0:X.hit){const V=X.pickedMesh;if(!V)return;const A=null===(t=V.metadata)||void 0===t?void 0:t.cursor;A&&(k=A,K!==k&&(this.props.scene.defaultCursor=k))}}handleChangeCursor(t){var V,X;const{spots:K}=t.payload,k=null===(X=null===(V=this.props.tableManager.table)||void 0===V?void 0:V.bettingGrid)||void 0===X?void 0:X.getSpots();if(k)for(const t of Object.keys(k))k[t].setCursor(K[t])}}class TF extends pq{constructor(t){super(t),this.playCutCardDealAnimation=async()=>{const t=this.props.shuffleDataManager.shuffleBurnData,V=t.cutCards,X=t.placeholders.cutCardsPositions,K=this.props.tableManager.table;K&&(V.front.isWorldMatrixFrozen&&V.front.unfreezeWorldMatrix(),e.changeVisibility(V.front,!0,!0),e.addMeshToShadowGenerator(V.front,this.props.shadowLight),e.addShadowUpdateFor(this.props.scene,this.props.shadowLight),K.cardsOnTable.addCutCard(V.front),K.shoe.detachFrontCutCard(),V.front.setParent(K.table),await function(t,V,X,K,k,A){const $=V.shoe,I=e.globalToLocal($.cardSlideEnd.getAbsolutePosition(),t.parent),C=e.convertRotationSpace($.cardSlideEnd,t.parent),n=e.globalToLocal(X.getAbsolutePosition(),t.parent),q=e.convertRotationSpace(X,t.parent),R=G.Pq.Distance(I,n),F=t.getScene(),s=$I(vF(R,!1),K),S=DF($,A,t.parent,k,(()=>{$.detachFrontCutCard()})),c=bF({from:I,to:n},{from:C,to:NF(q,!1,!1)},s),N=e.addEasing(yF(c,S),new WC.E8,WC.KA.EASINGMODE_EASEIN);return F.beginDirectAnimation(t,N,0,e.getAnimationLength(N),!1).waitAsync()}(V.front,K,X.front.node,this.props.speedRatio,this.props.playSlideCardFromShoeSound,$I(bn,this.props.speedRatio)),this.props.messageSender3d.from.cutCardDealt(),e.removeShadowUpdateFor(this.props.scene,this.props.shadowLight))},this.subscribeOnMessagesTo3D({[u.DealCutCard]:this.playCutCardDealAnimation})}}var PF,QF=X(871539);class JF extends pq{constructor(t){var V;super(t),this.subscribeOnMessagesTo3D({[u.StartFlyCamera]:this.handleStartFly.bind(this),[u.StopFlyCamera]:this.handleStopFly.bind(this)}),this.target=FX(this.props.scene,(t=>"cameraTarget"===t)),this.initTargetPosition=this.target.position.clone(),this.initCameraName=(null===(V=this.props.scene.activeCamera)||void 0===V?void 0:V.name)||"ArcCamera"}handleStartFly(t){if(this.animation)return void this.animation.reset();this.props.cameraManager.hasActiveAnimation=!0;const V=YV(t.payload);this.flyCamera=new ZC.L("FlyCamera",0,0,0,G.Pq.Zero(),this.props.scene),this.flyCamera.minZ=.1,this.props.messageSender3d.to.startSceneRender()(),this.initTargetPosition=this.target.position.clone(),this.props.scene.setActiveCameraByName(this.flyCamera.name),this.flyCamera.setTarget(this.target),this.flyCamera.fov=V.fov;const X=V.camera.map((t=>{const V=new QF.X5(`fly-camera-${t.property}`,t.property,t.framePerSecond,t.dataType);return V.setKeys(t.keys),V})),K=V.target.map((t=>{const V=new QF.X5(`fly-target-${t.property}`,t.property,t.framePerSecond,t.dataType);return V.setKeys(t.keys),V}));this.animation=new Uq.k("FLYGROUP");for(const t of X)this.animation.addTargetedAnimation(t,this.flyCamera);for(const t of K)this.animation.addTargetedAnimation(t,this.target);this.animation.play(!1)}handleStopFly(){this.props.messageSender3d.from.endSceneRender()(),this.resetInitState()}resetInitState(){this.animation&&(this.animation.stop(),this.animation.dispose(),this.animation=void 0),this.flyCamera&&(this.flyCamera.dispose(),this.flyCamera=void 0),this.target.position=this.initTargetPosition,this.props.scene.setActiveCameraByName(this.initCameraName),this.props.cameraManager.hasActiveAnimation=!1}}class UF extends pq{constructor(t){var V;super(t),this.subscribeOnMessagesTo3D({[u.StartIdleAnimation]:this.handleStartAnimation.bind(this),[u.StopIdleAnimation]:this.handleStopAnimation.bind(this)});const{camera:X,target:K}=this.props.animation;this.props.cameraManager.hasActiveAnimation=!0;const k=FX(this.props.scene,(t=>"cameraTarget"===t)),A=X.map((t=>{const V=new QF.X5(`idle-camera-${t.property}`,t.property,t.framePerSecond,t.dataType);return V.setKeys(t.keys),V})),$=K.map((t=>{const V=new QF.X5(`idle-target-${t.property}`,t.property,t.framePerSecond,t.dataType);return V.setKeys(t.keys),V}));this.animation=new Uq.k("idle-animation");for(const t of A)this.animation.addTargetedAnimation(t,this.props.scene.activeCamera);for(const t of $)this.animation.addTargetedAnimation(t,k);this.animation.speedRatio=null!==(V=this.props.speedRatio)&&void 0!==V?V:1}handleStartAnimation(t){this.props.cameraManager.flyToTarget(t.payload.cameraTarget,(()=>{this.animation.play()}))}handleStopAnimation(){this.animation.stop(),this.props.cameraManager.flyToTarget(Xt.TableFocus,(()=>{this.props.messageSender3d.from.idleAnimationStopped()}))}}class lF extends pq{constructor(t){super(t),this.setPaused=({payload:t})=>{t.pause||this.props.messageSender3d.from.setResumeGame(),this.props.setPaused(t.pause)},this.subscribeOnMessagesTo3D({[u.SetPaused]:this.setPaused})}}(function(t){t["Shoe"]="shoe",t["Holder"]="holder",t["DeckAssemble"]="deckAssemble"})(PF||(PF={}));class iF extends pq{constructor(t){super(t),this.shuffling=!1,this.handleShuffleStart=()=>{this.shuffling=!0},this.handleShuffleDone=()=>{this.shuffling=!1},this.handleOrientation=({payload:t})=>{this.updateShoeHolderPosition(t)};const V=e.getMeshByName(sV.Prefix,this.props.scene),X=e.getMeshByName(FV.Prefix,this.props.scene),K=e.getMeshByName(mV.AssemblePlaceholderPrefix,this.props.scene),k=cq(X).x*Math.sin(X.rotation.y/2);this.offsets={[PF.Shoe]:{mesh:X,portrait:new G.Pq(.45,X.position.y,this.props.shoeMobilePortraitPositionZ),landscape:X.position.clone()},[PF.Holder]:{mesh:V,portrait:new G.Pq(-.29,V.position.y,this.props.shoeMobilePortraitPositionZ+k),landscape:V.position.clone()},[PF.DeckAssemble]:{mesh:K,portrait:new G.Pq(K.position.x-.3,K.position.y,K.position.z),landscape:K.position.clone()}},this.subscribeOnMessagesTo3D({[u.ChangeOrientation]:this.handleOrientation,[u.ShuffleCards]:this.handleShuffleStart}),this.subscribeOnMessagesFrom3D({[a.ShuffleCardsDone]:this.handleShuffleDone})}updateShoeHolderPosition(t){for(const V of Object.values(this.offsets))if(V.mesh.position.copyFrom(V[t]),V===this.offsets[PF.DeckAssemble]&&this.shuffling){const X=this.props.scene.getTransformNodeByName(CV(`cardDeck:${cV.ClonePrefix}`,1));X&&(X.position.x=V[t].x)}e.forceShadowUpdate(this.props.scene,_V.Shadow)}}class GF extends pq{constructor(t){super(t),this.registerToken=({payload:t})=>{this.tokens.push(t.token)},this.cancelToken=({payload:t})=>{this.cancelTokens(t.tokenGroups)},this.tokens=[],this.subscribeOnMessagesTo3D({[u.RegisterToken]:this.registerToken,[u.Cancel]:this.cancelToken})}cancelTokens(t){const V=Array.isArray(t)?t:[t];for(let t=this.tokens.length-1;t>=0;t--){const X=this.tokens[t],K=dF(X.groups,V);K&&X.cancel(),X.active&&!K||this.tokens.splice(t,1)}}}function dF(t,V){return V.filter((V=>t.includes(V))).length>0}class MF extends pq{constructor(t){super(t),this.loaded={},this.subscribeOnMessagesTo3D({[u.UploadMesh]:this.handleUploadMesh.bind(this),[u.LinkMesh]:this.handleLinkMesh.bind(this)})}handleLinkMesh(t){const V=t.payload.meshName||this.meshName;if(!V)return;const X=this.props.scene.getMeshByName(V);if(!X)return;const K=this.props.scene.meshes.find((V=>V.isEnabled()&&V.name===t.payload.parent));K&&(X.parent=K)}handleUploadMesh(t){const V=e.createAssetsManager(this.props.scene);for(const X of t.payload){const t=window.URL.createObjectURL(X);""!==X.type?this.loaded[X.name]=t:V.addMeshTask(M.S0.RandomId(),"",t,"").onSuccess=t=>{for(const V of t.loadedMeshes){V.parent||(this.meshName=V.name);const t=["diffuseTexture","emissiveTexture","metallicRoughnessTexture","baseTexture"];if(V.material)for(const X of t){const t=V.material[X];t&&this.loaded[t.name]&&t.updateURL(this.loaded[t.name])}}}}V.load()}}var BF=X(605283);const oF={};function fF(t,V,X){const K=V.position,k=V.scaling,A=V.visibility;return function(V){const $=(null==K?void 0:K[V])||oF,I=(null==k?void 0:k[V])||oF,C=(null==A?void 0:A[V])||oF,n=BF.A([...Object.keys(I),...Object.keys($),...Object.keys(C)]);for(const V of n){const X=t.getMeshByName(V);X&&(I[V]&&(X.scaling=I[V]),$[V]&&(X.position=$[V]),V in C&&X.setEnabled(C[V]))}e.forceShadowUpdate(t,X)}}class gF{constructor(t){if(this.props=t,this.transport3D=t.transport3D,this.messageSender3d=t.messageSender3d,this.engine=t.engine,this.scene=t.scene,this.camera=t.camera,this.renderer=t.renderer,this.initialState=t.initialState,this.orientation=t.orientation,this.bundle=t.bundle,this.systems=[],this.renderManager=this.initRenderManager(),this.props.DS.IS_DESKTOP)this.cameraManager=this.createCameraManager();else{this.cameraTargetsResizeObserver=this.createCameraTargetsResizeObserver();const t=new AR(this.camera,{[nt.t.Landscape]:this.cameraTargetsResizeObserver.currentTargets,[nt.t.Portrait]:this.cameraTargetsResizeObserver.currentTargets},this.orientation,!1);this.cameraManager=t,this.cameraTargetsResizeObserver.add(t)}this.cardCreator=this.createCardCreator(),this.tooltipManager=this.createTooltipManager(),this.chipSelectorTooltipManager=this.createChipSelectorTooltipManager(),this.initiateChips(this.props.initialState.chipAmounts,this.props.images.chip,this.props.images.plaque)}resize(){this.engine.resize(),this.renderer.forceRender()}setPaused(t){this.renderer.setGameIdle(t)}setOrientation(t){this.orientation=t}dispose(){this.transport3D.dispose(),this.renderManager.dispose(),this.renderer.dispose(),this.camera.dispose(),this.engine.dispose();for(const t of this.systems)t.dispose();this.systems.length=0,g()}setupScene(){this.registerAnimationSpeedRationSystem(),this.registerCursorsSystem(),this.registerCardDealSystem(),this.registerCardBurnSystem(),this.registerCardHighlightSystem(),this.registerUtilsSystems(),this.registerShoePositionSystem(),this.registerIdleAnimationSystem()}createTooltipManager(){const t=(V={cameraManager:this.cameraManager,scene:this.scene,emitters:this.props.initialState.tooltipTransportEmitters,onBeforeShowCallback:()=>this.messageSender3d.to.showTooltip(),onAfterHideCallback:()=>this.messageSender3d.from.hideTooltip(),transform:new G.Pq(0,0,.03)},t=>{const X=new tF({id:t.id,scene:V.scene,cameraManager:V.cameraManager,transportEmitters:V.emitters,content:t.content,autoHide:t.autoHide},{onBeforeShowCallback:V.onBeforeShowCallback,onAfterHideCallback:V.onAfterHideCallback});return t.parent&&(X.mesh.parent=t.parent),V.transform&&(X.mesh.position=X.mesh.position.add(V.transform)),X});var V;return new e.TooltipManager({createTooltip:t})}createChipSelectorTooltipManager(){const t=e.createTooltipFactory({cameraManager:this.cameraManager,scene:this.scene,emitters:this.props.initialState.tooltipTransportEmitters});return new e.TooltipManager({createTooltip:t})}createCardCreator(){return function(t,V){const X=e.meshExists(`${NV.FrontPrefix}${NV.ElasticPostfix}`,t);return function({bundle:t,backMeshName:V,frontMeshName:X},K){const{card:k,cardSprites:A}=t,$=(null==A?void 0:A.back)?cR(K,null==A?void 0:A.back.atlas,null==A?void 0:A.back.sprite,null==A?void 0:A.back.size):cR(K,k.atlas.Back,k.sprite,k.size),I=(null==A?void 0:A.faceUp)?function(t,V,X,K){return k=>NR(k,t,V[k],X,K)}(K,null==A?void 0:A.faceUp.atlas,null==A?void 0:A.faceUp.sprite,null==A?void 0:A.faceUp.size):function(t,V,X,K){return k=>NR(k,t,V[k],X,K)}(K,k.atlas,k.sprite,k.size);return vR(K,$()),function(t){return t.scaling&&(t.back.scaling.setAll(t.scaling),t.front.scaling.setAll(t.scaling)),t.back.material=t.backMaterialCreator(),t.back.setEnabled(!1),t.front.setEnabled(!1),V=>{const X=M.S0.RandomId(),K=t.back.clone(`${NV.Prefix}-${V}-back-${X}`);K.setEnabled(!0),K.isPickable=!1;const k=t.front.clone(`${NV.Prefix}-${V}-front-${X}`);k.setEnabled(!0);const A=t.frontMaterialCreator(V);return k.material=A.clone(`${A.name}-${X}`),new sR(`${NV.ContainerPrefix}-${V}-${X}`,K,k)}}({back:e.getMeshByName(V,K),front:e.getMeshByName(X,K),backMaterialCreator:$,frontMaterialCreator:I,scaling:k.scaling})}({bundle:V,frontMeshName:`${NV.FrontPrefix}${X?NV.ElasticPostfix:""}`,backMeshName:`${NV.BackPrefix}${X?NV.ElasticPostfix:""}`},t)}(this.scene,this.bundle)}createCameraTargetsResizeObserver(){return new nR({scene:this.scene,renderer:this.renderer,targetMesh:e.getMeshByName(RV.Prefix,this.props.scene),getElementRect:()=>{var t,V;return this.orientation===nt.t.Portrait?null===(t=IR.getGamePlayControlsElement())||void 0===t?void 0:t.getBoundingClientRect():null===(V=IR.getTableInfoElement())||void 0===V?void 0:V.getBoundingClientRect()},onOrientationChange:fF(this.scene,{scaling:this.bundle.meshScaling,position:this.bundle.meshPosition,visibility:this.bundle.meshVisibility},_V.Shadow),targetSettings:this.bundle.tableSizeOptions,generateTargets:(t=this.bundle.mobileCameraSettings,function(V,X,K){var k,A,$,I,C,n,q,R,F,s,S,c,N;const m=t[K],v=m[Xt.TableDealing];return{[Xt.RoomFocus]:{[e.CameraPositionProps.Alpha]:M.S0.ToRadians(270),[e.CameraPositionProps.Beta]:null!==(k=m[Xt.RoomFocus].beta)&&void 0!==k?k:M.S0.ToRadians(0),[e.CameraPositionProps.Radius]:5.4,[e.CameraPositionProps.Target]:V,[e.CameraPositionProps.Fov]:null!==(A=m[Xt.RoomFocus].fov)&&void 0!==A?A:M.S0.ToRadians(45)},[Xt.TableFocus]:{[e.CameraPositionProps.Alpha]:M.S0.ToRadians(270),[e.CameraPositionProps.Beta]:null!==($=m[Xt.TableFocus].beta)&&void 0!==$?$:M.S0.ToRadians(0),[e.CameraPositionProps.Radius]:X,[e.CameraPositionProps.Target]:V,[e.CameraPositionProps.Fov]:null!==(I=m[Xt.TableFocus].fov)&&void 0!==I?I:M.S0.ToRadians(45),animateFrom:{[Xt.RoomFocus]:{duration:5,easingFunc:new WC.kc,easingMode:WC.KA.EASINGMODE_EASEINOUT,inTangent:qR,outTangent:RR,needConstantDelta:!1},[Xt.TableIdle]:{duration:.5},[Xt.TableDealing]:{duration:1.5,easingFunc:new WC.kc,easingMode:WC.KA.EASINGMODE_EASEINOUT,needConstantDelta:!1},[Xt.TableWin]:{duration:1.5,easingFunc:new WC.kc,easingMode:WC.KA.EASINGMODE_EASEINOUT,needConstantDelta:!1}}},[Xt.TableDealing]:{[e.CameraPositionProps.Alpha]:M.S0.ToRadians(270),[e.CameraPositionProps.Beta]:null!==(C=v.beta)&&void 0!==C?C:M.S0.ToRadians(0),[e.CameraPositionProps.Radius]:X*(null!==(n=v.radius)&&void 0!==n?n:1),[e.CameraPositionProps.Target]:V.add(null!==(q=v.target)&&void 0!==q?q:G.Pq.Zero()),[e.CameraPositionProps.Fov]:M.S0.ToRadians(45),animateFrom:{[Xt.TableFocus]:{duration:null!==(F=null===(R=v.animateFrom)||void 0===R?void 0:R[Xt.TableFocus].duration)&&void 0!==F?F:1,easingFunc:new WC.kc,easingMode:WC.KA.EASINGMODE_EASEINOUT,needConstantDelta:!1}}},[Xt.TableIdle]:{[e.CameraPositionProps.Alpha]:M.S0.ToRadians(270),[e.CameraPositionProps.Beta]:null!==(s=m[Xt.TableIdle].beta)&&void 0!==s?s:M.S0.ToRadians(0),[e.CameraPositionProps.Radius]:X,[e.CameraPositionProps.Target]:V,[e.CameraPositionProps.Fov]:M.S0.ToRadians(45),animateFrom:{[Xt.TableFocus]:{duration:6,easingFunc:new WC.kc,easingMode:WC.KA.EASINGMODE_EASEINOUT}}},[Xt.TableWin]:{[e.CameraPositionProps.Alpha]:M.S0.ToRadians(270),[e.CameraPositionProps.Beta]:null!==(S=m[Xt.TableDealing].beta)&&void 0!==S?S:M.S0.ToRadians(0),[e.CameraPositionProps.Radius]:X*(null!==(c=m[Xt.TableWin].radius)&&void 0!==c?c:1),[e.CameraPositionProps.Target]:V.add(null!==(N=m[Xt.TableDealing].target)&&void 0!==N?N:G.Pq.Zero()),[e.CameraPositionProps.Fov]:M.S0.ToRadians(45),animateFrom:{[Xt.TableDealing]:{duration:.8,easingFunc:new WC.kc,easingMode:WC.KA.EASINGMODE_EASEINOUT,needConstantDelta:!1}}}}}),adjustForScroll:this.props.DS.IS_CHROME,baseFov:45});var t}initiateChips(t,V,X){const K=e.getMeshByName(WV.ChipPrefix,this.scene);e.initChips({amounts:t,chip:K,chipTexture:V,plaqueTexture:X,groups:[e.ChipGroup.Standard,e.ChipGroup.Moving,e.ChipGroup.ChipSelectorDisabled],needDepthPrePass:!0})}get isMobile(){return this.props.DS.IS_PHONE||this.props.DS.IS_TABLET}registerCardHighlightSystem(){this.registerSystem(new YF({tableManager:this.tableManager,transport3D:this.transport3D,scene:this.scene}))}registerBettingSystem(){const t=this.props.DS.IS_TABLET?void 0:PR({cameraManager:this.cameraManager,scene:this.scene,emitters:this.props.initialState.gameResultTransportEmitters}),V=!this.props.DS.IS_TABLET&&t?new QR({gameResult:t}):void 0;this.registerSystem(new cF({setupSpotsOnInit:!1,messageSender3d:this.messageSender3d,scoreManager:new JR({sides:Object.values(zK),shouldSubscribeOnResize:this.isMobile,scene:this.scene,getScoreNodes:this.isMobile?UR((()=>this.orientation)):lR,createScore:GR({cameraManager:this.cameraManager,scene:this.scene,emitters:this.props.initialState.scoresTransportEmitters})}),shadowLightName:_V.Shadow,cutCardsSliderManager:new dR({createSkipCutCards:BR({cameraManager:this.cameraManager,scene:this.scene,emitters:this.props.initialState.cutCardsSliderTransportEmitters})}),tableBubbleManager:new oR({createTableBubble:gR({cameraManager:this.cameraManager,scene:this.scene,emitters:this.props.initialState.tableBubbleTransportEmitters})}),gameResultManager:V,tooltipManager:this.tooltipManager,transport3D:this.transport3D,tableManager:this.tableManager,selectedChip:this.props.initialState.selectedChip,bettingGridType:this.props.initialState.bettingGridType,scene:this.scene,getClothColor:()=>"#ff0000",sounds:this.props.sounds}))}registerUtilsSystems(){this.registerSystem(new GF({transport3D:this.transport3D})),this.registerSystem(new JF({scene:this.scene,cameraManager:this.cameraManager,messageSender3d:this.messageSender3d,transport3D:this.transport3D})),this.registerSystem(new lF({setPaused:t=>this.setPaused(t),transport3D:this.transport3D,messageSender3d:this.messageSender3d})),this.registerSystem(new MF({scene:this.scene,transport3D:this.transport3D}))}registerCardBurnSystem(){this.registerSystem(new zF({cardCreator:this.cardCreator,messageSender3d:this.messageSender3d,transport3D:this.transport3D,scene:this.scene,tableManager:this.tableManager,shadowLight:_V.Shadow,leftHand:zK.Player,rightHand:zK.Banker,speedRatio:VF[AI.Deal],playCardFlipSound:this.props.sounds.playCardFlipSound,playSlideCardFromShoeSound:this.props.sounds.playSlideCardFromShoeSound,playCollectCardsSound:this.props.sounds.playMoveDeckShortSound}))}registerIdleAnimationSystem(){var t;this.registerSystem(new UF({scene:this.scene,messageSender3d:this.messageSender3d,transport3D:this.transport3D,cameraManager:this.cameraManager,animation:this.props.idleAnimation,speedRatio:null===(t=this.props.bundle.idleAnimation)||void 0===t?void 0:t.speedRatio}))}registerShuffleCutSystems(t){this.registerSystem(new HF({shuffleDataManager:t,transport3D:this.transport3D,messageSender3d:this.messageSender3d,scene:this.scene,shadowLight:_V.Shadow})),this.registerSystem(new wF({messageSender3d:this.messageSender3d,transport3D:this.transport3D,animation:new hR({straightDeck:t.straightDecks.total,DS:this.props.DS,playCuttingCardSound:this.props.sounds.playCutCardInDeckSound,playDeckInShoeSound:this.props.sounds.playDeckInShoeSound,playMoveDeckShortSound:this.props.sounds.playMoveDeckShortSound}),shuffleDataManager:t,scene:this.scene,shadowLight:_V.Shadow})),this.registerSystem(new TF({shuffleDataManager:t,messageSender3d:this.messageSender3d,transport3D:this.transport3D,scene:this.scene,shadowLight:_V.Shadow,speedRatio:VF[AI.Deal],playSlideCardFromShoeSound:this.props.sounds.playSlideCardFromShoeSound,tableManager:this.tableManager}))}registerShoePositionSystem(){this.props.DS.IS_PHONE&&this.registerSystem(new iF({scene:this.scene,transport3D:this.transport3D,orientation:this.orientation,shoeMobilePortraitPositionZ:this.bundle.shoeMobilePortraitPositionZ}))}registerCardDealSystem(){this.registerSystem(new uF({messageSender3d:this.messageSender3d,cardCreator:this.cardCreator,transport3D:this.transport3D,tableManager:this.tableManager,scene:this.scene,speedRatio:VF[AI.Deal],shadowLight:_V.Shadow,playCardFlipSound:this.props.sounds.playCardFlipSound,playSlideCardFromShoeSound:this.props.sounds.playSlideCardFromShoeSound,playCollectCardsSound:this.props.sounds.playMoveDeckSound,orientationDependentPositions:[2],orientation:this.orientation}))}registerAnimationSpeedRationSystem(){this.registerSystem(new KF({transport3D:this.transport3D,messageSender3d:this.messageSender3d,ratios:VF}))}registerCursorsSystem(){this.registerSystem(new hF({transport3D:this.transport3D,tableManager:this.tableManager,scene:this.scene,DS:this.props.DS}))}}class ts{constructor(t){var V,X;this.table=null,this.tableName=null,this.tableName=null!==(X=null===(V=t.tableInfo)||void 0===V?void 0:V.tableName)&&void 0!==X?X:null,this.table=t.tableInfo}}class Vs extends pq{constructor(t){super(t),this.goLive=()=>{let t;if(this.props.cameraManager.hasActiveAnimation=!0,this.props.wayPoints&&(t=this.props.wayPoints.common),this.props.animateGoLiveRoom){const V=t?t.map((t=>t.duration)).filter((t=>void 0!==t)):void 0,X=V?V.reduce(((t,V)=>t+(V||0)),0):void 0;this.props.animateGoLiveRoom(X,V)}t?Xs(this.props.cameraManager,t,0,(()=>this.complete())):this.complete()},this.subscribeOnMessagesTo3D({[u.GoLive]:this.goLive})}complete(){this.props.messageSender3d.from.goLiveReady(),this.props.cameraManager.hasActiveAnimation=!1}}function Xs(t,V,X,K){const k=V[X],A=V.length;t.flyTo({...k,onComplete:()=>{k.onComplete&&k.onComplete(),X+1===A?K():Xs(t,V,X+1,K)},onCancel:()=>{}})}var Ks=X(788213),ks=X(10203);const As="#d2982b",$s=.5,Is=0,Cs=.01,ns={color1:new G.ov(.8,.57,.2,1),color2:new G.ov(.89,.64,.2,1),colorDead:new G.ov(.72,.4,.05,1),minEmitPower:.5,maxEmitPower:1,updateSpeed:5e-4,minLifeTime:.1,maxLifeTime:.2,minSize:.005,maxSize:.02,emitRate:500,radius:.02,angle:Math.PI/3},qs={position:[{frame:0,value:new G.Pq(0,-.0024,0)},{frame:2,value:new G.Pq(0,-.0024,9e-4)},{frame:23,value:new G.Pq(.016,-.0114,.0389)},{frame:25,value:new G.Pq(.0168,-.0121,.0399)}],rotationQuaternion:[{frame:0,value:new G.PT(0,0,0,1)},{frame:13,value:new G.PT(0,0,0,1)},{frame:14,value:new G.PT(.0052,.0043,0,1)},{frame:15,value:new G.PT(.0194,.0162,-3e-4,.9997)},{frame:16,value:new G.PT(.0409,.0341,-.0014,.9986)},{frame:17,value:new G.PT(.0677,.0564,-.0038,.9961)},{frame:18,value:new G.PT(.098,.0816,-.0081,.9918)},{frame:20,value:new G.PT(.1611,.1339,-.0221,.9776)},{frame:21,value:new G.PT(.1902,.1579,-.031,.9685)},{frame:22,value:new G.PT(.2154,.1786,-.0401,.9592)},{frame:23,value:new G.PT(.2352,.1948,-.0482,.951)},{frame:24,value:new G.PT(.2481,.2053,-.0539,.9452)},{frame:25,value:new G.PT(.2527,.2091,-.056,.943)}]};var Rs,Fs=X(381810);(function(t){t["Open"]="open",t["Close"]="close"})(Rs||(Rs={}));const ss="data:image/webp;base64,UklGRqIBAABXRUJQVlA4TJYBAAAvIoAIAC/CNpIkJ3PqH1zwpE3+uWl1abiNJEmRGnZPYnztLXj1/TeKuV1Hkq0qc/Thvw4JkH82RODucuY/ACEEAEJcFE6lzEYovDihUCmhMJuowWxUSiiiBi9OpSBKTV6cSkXjIMJJpdo2QDhajnkFlAxg+Xx3PB7k3gcEweG17fJwXD8I7hv8PZB/bI+TBJ6ryOD7FIIMCNbzDIS4LKeBqi4Iieh+SwRA1ONBPwwJxHBYgCvJtk3nPNs2Y9tO5j+pVN1b4W9E/xW5bdvIp+zOT8D/0pzEgViiljGmn6AYlmWoJ+gJcrn0YAnA8IIky5LAMwCrAQ1IrXpTTlRUTdc1VRG5WX8JGJp1h6phWrZtmYY66k4BB27U2Tqu5/uea687Qw4HRlQ3jWYYxXEUtBsbVWQw4BXDbtVVmmVJWTcdQ+HRUIJqukG+O5wux10RuqYqUGhb0iwvSvbX2+26TyLP0iS0ycq67cfZ5f543M5Z7Nu6zL6ElxgvSXlFo5dc2Usu/jXP5zWP8CVP+fUfYoH1rcgF/HEB";class Ss{constructor(t){this.isOpen=!1,this.queue=0,this.open=()=>{this.lastCall!==Rs.Open&&(this.lastCall=Rs.Open,this.toggle(!0))},this.close=()=>{this.lastCall!==Rs.Close&&(this.lastCall=Rs.Close,this.toggle(!1))},this.show=()=>{this.node.setEnabled(!0),this.callbacks.onChangeVisibilityComplete()},this.hide=()=>{this.node.setEnabled(!1),this.callbacks.onChangeVisibilityComplete()},this.updatePosition=t=>{this.node.parent.position=t},this.addShadow=()=>{e.addMeshToShadowGenerator(this.node,_V.Shadow),this.animation.onAnimationGroupPlayObservable.add((()=>e.addShadowUpdateFor(this.top.getScene(),_V.Shadow))),this.animation.onAnimationGroupEndObservable.add((()=>e.removeShadowUpdateFor(this.top.getScene(),_V.Shadow)))},this.reverseAnimation=()=>{this.animation.speedRatio=-this.animation.speedRatio,this.animation.normalize(this.animation.to,this.animation.from),this.isOpen=this.animation.speedRatio<0,0!==this.queue?(this.toggle(!this.isOpen),this.queue-=1,this.callbacks.onAnimationDone()):(this.isOpen||this.callbacks.onAnimationDone(),this.callbacks.onChangeStateComplete())},this.toggle=t=>{var V;this.animation.isPlaying?this.queue+=1:this.isOpen!==t&&(this.playOpenBowl(),this.animation.play(!1),t?(null===(V=this.particles.getScene())||void 0===V?void 0:V.particlesEnabled)&&(this.callbacks.onAnimationStart(),this.particles.start()):(this.particles.reset(),this.particles.stop()))},this.lastCall=Rs.Close,this.node=t.node,this.callbacks=t.callbacks,this.top=FX(this.node,(t=>t===mC.TopContainerName));const V=FX(this.node,(t=>t===mC.BottomName)),X=FX(this.top,(t=>t===mC.TopName));this.animation=function(t){const V=new QF.X5(`animationPosition${M.S0.RandomId()}`,"position",30,QF.X5.ANIMATIONTYPE_VECTOR3,QF.X5.ANIMATIONLOOPMODE_CONSTANT);V.setKeys(qs.position);const X=new QF.X5(`animationRotation${M.S0.RandomId()}`,"rotationQuaternion",30,QF.X5.ANIMATIONTYPE_QUATERNION,QF.X5.ANIMATIONLOOPMODE_CONSTANT);X.setKeys(qs.rotationQuaternion);const K=new Uq.k(`bowl_animation_group${M.S0.RandomId()}`);return K.addTargetedAnimation(V,t),K.addTargetedAnimation(X,t),K}(this.top),this.playOpenBowl=t.playOpenBowl,this.base=this.createBase(),this.glow=this.createGlow(),this.glow.addIncludedOnlyMesh(this.base),this.glow.addIncludedOnlyMesh(X),this.glow.addIncludedOnlyMesh(V),this.particles=this.createParticles(),this.animation.onAnimationGroupEndObservable.add(this.reverseAnimation),this.addShadow()}createBase(){const t=this.node.getScene(),{y:V,x:X}=e.getMeshSize(this.node,!0),K=Ks.og.CreateCylinder(`${mC.Prefix}_cylinder`,{diameterTop:X,diameterBottom:0,height:V/2},t);K.visibility=Cs;const k=new J.F(`${mC.Prefix}_cylinder_material`,t);return k.emissiveColor=G.v9.FromHexString(As),K.material=k,K.parent=this.node,K.position.y-=.022,K}createGlow(){return function(t){const{scene:V,blurKernelSize:X=16,intensity:K=1.2}=t,k=new Fs.V(`${mC.Prefix}_glow_layer`,V,{mainTextureSamples:1,mainTextureRatio:1});return k.intensity=K,k.blurKernelSize=X,k}({scene:this.node.getScene(),intensity:$s,blurKernelSize:Is})}createParticles(){const t=this.node.getScene(),V=new ks.o("particles",2*ns.emitRate,t);return V.gravity=new G.Pq(0,-4.81,0),V.particleTexture=new x.g(ss,t),V.minAngularSpeed=0,V.maxAngularSpeed=Math.PI,V.emitter=this.base,V.color1=ns.color1,V.color2=ns.color2,V.colorDead=ns.colorDead,V.minSize=ns.minSize,V.maxSize=ns.maxSize,V.minLifeTime=ns.minLifeTime,V.maxLifeTime=ns.maxLifeTime,V.emitRate=ns.emitRate,V.createConeEmitter(ns.radius,ns.angle),V.startDirectionFunction=(t,V)=>{G.Pq.TransformNormalFromFloatsToRef(UC.X.RandomRange(-1,.5),UC.X.RandomRange(0,1),UC.X.RandomRange(0,-1),t,V)},V.minEmitPower=ns.minEmitPower,V.maxEmitPower=ns.maxEmitPower,V.updateSpeed=ns.updateSpeed,V}}var cs;(function(t){t["Gold"]="gold",t["Noise"]="noise",t["Normal"]="normal",t["Glow"]="glow"})(cs||(cs={}));const Ns="golden-glow";class ms extends sR{constructor(t,V,X,K,k){super(t,V,X),this.frontMaterial=K,X.material=this.frontMaterial,k&&(k.setParent(this),this.glow=k)}setActive(t){t!==this.active&&(super.setActive(t),"enableGold"in this.frontMaterial&&(this.glow&&this.glow.setEnabled(!t),this.frontMaterial.enableGold(!t)))}dispose(){var t;null===(t=this.glow)||void 0===t||t.dispose(),super.dispose()}}const vs="GoldenCard";Nq.M.ShadersStore[`${vs}VertexShader`]="precision highp float;attribute vec3 position;attribute vec2 uv;attribute vec3 normal;uniform mat4 worldViewProjection;uniform mat3 normalMatrix;varying vec3 vNormal;varying vec2 vUV;void main(){vUV=uv;vNormal=normalMatrix*normal;gl_Position=worldViewProjection*vec4(position,1.);}",Nq.M.ShadersStore[`${vs}FragmentShader`]="precision highp float;uniform float time;uniform sampler2D cardTexture;uniform sampler2D effectsTexture;uniform mat4 baseTextureMatrix;uniform vec4 normalTextureRect;uniform vec4 goldenTextureRect;uniform vec4 noiseTextureRect;uniform float goldIntensity;uniform float alpha;varying vec2 vUV;varying vec3 vNormal;vec2 spriteSheet(vec2 uv,vec4 spriteRect){return vec2(spriteRect.x+uv.x*spriteRect.z,spriteRect.y-(1.-uv.y)*spriteRect.w);}const vec3 lightOffset=vec3(0.,0.2,0.);const float lowestLuminosity=0.5;vec3 computeNormal(vec3 normalColor){float deviationCoefficient=(length(normalColor)/3.);vec3 normal=normalize(vNormal+vec3(normalColor));normal.x+=deviationCoefficient*(sin(normalColor.r*time*8.)*0.03+0.015);normal.y+=deviationCoefficient*0.1-0.05;normal.z+=deviationCoefficient*(cos(normalColor.b*time*8.)*0.03+0.015);return normal;}float computeGoldCoefficient(){vec4 perlinNoise=texture2D(effectsTexture,spriteSheet(vUV,noiseTextureRect));float goldenCoefficient=1.;if(goldIntensity<1.){goldenCoefficient=clamp(((goldIntensity*2.)-((perlinNoise.r+perlinNoise.g+perlinNoise.b)/3.)+goldIntensity),0.,1.);}return goldenCoefficient;}vec4 computeEmptyPixelColor(vec4 cardColor,float light,vec3 normalColor,vec3 normal){vec4 resultColor=cardColor;float goldenCoefficient=computeGoldCoefficient();if(goldenCoefficient==0.){return resultColor;}vec4 goldColor=texture2D(effectsTexture,spriteSheet(vUV,goldenTextureRect));resultColor=mix(cardColor,goldColor,goldenCoefficient);if(light==0.||length(normalColor)<=0.01){return resultColor;}float specular=0.;specular=pow(dot(normal,normalize(normal+lightOffset)),150.);resultColor+=specular*goldenCoefficient;resultColor*=light;return resultColor;}void main(void){vec3 normalColor=texture2D(effectsTexture,spriteSheet(vUV,normalTextureRect)).rgb;vec2 cardUV=vec2(baseTextureMatrix*vec4(vUV,1.,0.));vec4 cardColor=texture2D(cardTexture,cardUV);vec3 normal=computeNormal(normalColor);float light=dot(normal,normalize(normal+lightOffset));light=clamp(lowestLuminosity,1.,light);if(length(cardColor)<1.5){gl_FragColor=cardColor;}else{gl_FragColor=cardColor;gl_FragColor=computeEmptyPixelColor(cardColor,light,normalColor,normal);}}";const Ws=500;class Zs extends mq.B{constructor(t,V,X,K,k){var A;super(`golden-card-material-${V}`,t,{vertex:vs,fragment:vs}),this.baseTexture=X,this.vectors=K,this.goldEnabled=!1,this.timestamp=0,this.time=0,this.enableGold=t=>{this.goldEnabled=void 0===t?!this.goldEnabled:t,this.timestamp=Date.now(),this.scene.registerBeforeRender(this.updateSaturation),this.scene.registerBeforeRender(this.updateTime)},this.updateSaturation=()=>{const t=(jk.I()?600:Date.now()-this.timestamp)/Ws;t<1?this.setFloat("goldIntensity",this.goldEnabled?t:1-t):(this.setFloat("goldIntensity",this.goldEnabled?1:0),this.scene.unregisterBeforeRender(this.updateSaturation))},this.updateTime=()=>{const t=this.scene.getEngine().getDeltaTime();jk.I()||(this.time+=.001*t),this.setFloat("time",this.time)},this.scene=this.getScene(),this.setFloat("goldIntensity",0),this.setFloat("alpha",1),this.setFloat("time",this.time),this.setMatrix("baseTextureMatrix",this.baseTexture.getTextureMatrix()),this.setTexture("cardTexture",this.baseTexture),this.setTexture("effectsTexture",k),this.setVector4("normalTextureRect",(A=this.vectors[cs.Normal],jk.I()?A[0]:A[Math.floor(Math.random()*A.length)])),this.setVector4("goldenTextureRect",this.vectors[cs.Gold]),this.setVector4("noiseTextureRect",this.vectors[cs.Noise])}dispose(){super.dispose(),this.scene.unregisterBeforeRender(this.updateTime)}}function Ds(t,V){const{card:X,applyToDecks:K,backMeshName:k,frontMeshName:A}=t,$=X.effects,I=cR(V,X.atlas.Back,X.sprite,X.size);K&&vR(V,I());const C=e.getMeshByName(k,V),n=e.getMeshByName(A,V),q=function(t,V,X,K,k){const A=cq(V),$=d.QX.CreatePlane("golden-glow",{width:1.3*A.x,height:1.2*A.z}),I=new J.F(`${Ns}_mat`,t);return I.diffuseTexture=function(t,V,X,K){const k=new x.g(V,t);return k.uScale=X.width/K.width,k.vScale=X.height/K.height,k.uOffset=X.x/K.width,k.vOffset=1-(X.y/K.height+k.vScale),k}(t,X,K,k),I.diffuseTexture.hasAlpha=!0,I.useAlphaFromDiffuseTexture=!0,I.useSpecularOverAlpha=!0,I.alphaCutOff=1,$.material=I,$.rotation.x=-Math.PI/2,$.setEnabled(!0),$}(V,C,$.sprite,$.atlas[cs.Glow],$.size);X.scaling&&(C.scaling.setAll(X.scaling),n.scaling.setAll(X.scaling),q.scaling.setAll(X.scaling)),C.material=I(),C.setEnabled(!1),n.setEnabled(!1);const R=(F=$.atlas,$.sprite,s=$.size,[cs.Gold,cs.Noise,cs.Normal].reduce(((t,V)=>(V===cs.Normal?t[cs.Normal]=Object.keys(F).reduce(((t,V)=>(V.startsWith(cs.Normal)&&t.push(WR(F[V],s)),t)),[]):t[V]=WR(F[V],s),t)),{}));var F,s;const S=C.material.clone(`${C.material.name}_stub`);return t=>{const k=M.S0.RandomId(),A=C.clone(`${NV.Prefix}-${t}-back-${k}`);A.setEnabled(!0),A.isPickable=!1;const I=n.clone(`${NV.Prefix}-${t}-front-${k}`);I.setEnabled(!0);const F=t===iV.Zp.UnknownCard?S:new Zs(V,k,mR(V,X.atlas[t],X.sprite,X.size),R,new x.g($.sprite,V));return new ms(`${NV.ContainerPrefix}-${t}-${k}`,A,I,F,K?void 0:q.clone(`${I.name}_glow`))}}const ys=30,Es=1;function _s(t,V,X,K){return(t-(K-1)/2)*V*X}class ps{constructor(t){var V,X;this._size=G.Pq.One(),this.tombstone=t.originalMesh.clone(`Tombstone-${null!==(V=t.namePostfix)&&void 0!==V?V:M.S0.RandomId()}`,null!==(X=t.parent)&&void 0!==X?X:null),this.tombstone.setEnabled(!0),this.index=t.index,this.createText=t.createText,this.createCard=t.createCard,this.cardParent=FX(this.tombstone,(t=>t.endsWith(jV.CardName))),this.cardParent.rotation.x=3*Math.PI/2,this.cardParent.rotation.z=Math.PI,this.cardParent.scaling=new G.Pq(1.27,1.27,1.27),this.textParent=FX(this.tombstone,(t=>t.endsWith(jV.TextName))),this.animationConfig=t.animationConfig,this.init(t.data)}startRemoveCard(){}lightBorder(t){}set size(t){this._size=t}get size(){return this._size}init(t){this.initCard(t.card),this.initText(String(t.value))}dispose(t){t||this.tombstone.dispose()}setTombstonePosition({amount:t,offset:V}){const X=_s(this.index,this.size.x,V,t);this.tombstone.position=new G.Pq(X,0,0)}}var Ls=X(274090);function Os(t,V,X,K,k){return G.jj.CreateCubicBezier(t,V,X,K,k).getPoints().map(((t,V)=>({frame:V,value:t})))}const rs=X.p+"images/flake.a34f1020.svg";let zs=null;const ws=new G.ov(.8,.57,.2,1),bs=new G.ov(.89,.64,.2,1),as=new G.ov(.72,.4,.05,1);class us extends ks.o{constructor(t){const V=M.S0.RandomId();super(`comet-${V}`,t.capacity,t.scene),this.keyFrames=t.keyFrames,this.base=ZR.Jo.CreateBox(`comet-base-${V}`,{size:1e-4},this.getScene()),this.base.visibility=0,this.updateSpeed=.002,this.emitRate=5e3,this.minEmitPower=.2,this.maxEmitPower=.4,this.minLifeTime=.1,this.maxLifeTime=.15,this.minSize=.003,this.maxSize=.006,this.emitter=this.base,this.particleEmitterType=new Ls.Q(.003),this.color1=ws,this.color2=bs,this.colorDead=as,this.particleTexture=function(t){return zs||(zs=e.createSVGTexture(rs,t)),zs}(this.getScene()),this.playParticlesFly=t.playParticlesFly}async run(t=1){this.start();const V=e.createMultiStepAnimation({prop:"position",keys:this.keyFrames,frameRate:30});this.playParticlesFly(),await this.getScene().beginDirectAnimation(this.emitter,[V],0,V.getHighestFrame(),!1,t).waitAsync(),this.destroy()}async destroy(){this.emitRate=0,await nI(1e3),super.dispose(!1),this.base.dispose()}}class js extends ps{constructor(t){super(t),this.start=async t=>{var V;if(!this.cardParent||!this.text)return;const X=e.globalToLocal(this.initPosition,this.tombstone.parent);X.x-=this.tombstone.position.x,await function(t,V,X,K,k,A=4,$){const I=function(t){return(null==t?void 0:t[3])?t[3]:Es}(k);return new Promise((k=>{const C=ys*I,n=new OR.p(C/A,(()=>{k()})),q=new QF.X5(`animationPosition${M.S0.RandomId()}`,"position",ys,QF.X5.ANIMATIONTYPE_VECTOR3,QF.X5.ANIMATIONLOOPMODE_CONSTANT);q.addEvent(n);const R=t.position.clone(),F=[{frame:0,value:X}];$&&F.push({frame:C/2,value:$}),F.push({frame:C,value:R}),q.setKeys(F);const s=new QF.X5(`animationRotation${M.S0.RandomId()}`,"rotation",ys,QF.X5.ANIMATIONTYPE_VECTOR3,QF.X5.ANIMATIONLOOPMODE_CONSTANT);s.setKeys([{frame:0,value:new G.Pq(0,0,Math.PI)},{frame:C/2,value:new G.Pq(0,2*Math.PI,Math.PI)},{frame:C,value:t.rotation.clone()}]);const S=new QF.X5(`animationScaling${M.S0.RandomId()}`,"scaling",ys,QF.X5.ANIMATIONTYPE_VECTOR3,QF.X5.ANIMATIONLOOPMODE_CONSTANT);S.setKeys([{frame:0,value:G.Pq.Zero()},{frame:C,value:t.scaling}]);const c=new Uq.k(`card_fly_animation_group${M.S0.RandomId()}`);c.addTargetedAnimation(q,t),c.addTargetedAnimation(s,t),c.addTargetedAnimation(S,t),c.onAnimationGroupEndObservable.add((()=>{c.dispose(),V.setEnabled(!0);const t=function(t,V){const X=ys*V/2;return e.createMultiStepAnimation({prop:"scaling",keys:[{frame:0,value:G.Pq.Zero()},{frame:.85*X,value:t.scaling.multiplyByFloats(1.5,1.5,1.5)},{frame:X,value:t.scaling}]})}(V,I),X=t.getHighestFrame();if(K){const V=new OR.p(X,(()=>{K()}));t.addEvent(V)}V.getScene().beginDirectAnimation(V,[t],0,X)})),c.play(!1)}))}(this.cardParent,this.text,X,t,null===(V=this.animationConfig)||void 0===V?void 0:V.gameSpeedModeSettings,4,X.add(new G.Pq(-.2,.1,-.1)))};const V=this.tombstone.getScene().getMeshByName(mC.Prefix);this.initPosition=V.getAbsolutePosition().clone(),this.playParticlesFly=t.playParticlesFly}setTombstonePosition({amount:t,offset:V,orientation:X}){const K=_s(this.index,this.size.x,V,t),k=X===nt.t.Portrait?.55*-this.size.y:0;this.tombstone.position=new G.Pq(K,k,0)}async setCardActive(t,V){var X,K,k;const{immediately:A,destination:$,onAnimationEnd:I}=V;this.card&&(this.card.setActive(t),!A&&$&&await async function(t,V,X,K,k,A=1){const $=new us({capacity:1e3,scene:t,keyFrames:(I=[V,X],C=8,function(t,V){return G.jj.CreateCatmullRomSpline(t,V).getPoints().map(((t,V)=>({frame:V,value:t})))}(function(t,V){const[X,K]=t,k=G.Pq.Distance(X,K)/8,A=G.Pq.Center(X,K),$=V?k:-k,I=G.Pq.Center(A,X);I.x+=$;const C=G.Pq.Center(A,K);return C.x+=$,[X,I,C,K]}(I,Math.random()<.5),C)),playParticlesFly:K});var I,C;await $.run(A),await(null==k?void 0:k())}(this.tombstone.getScene(),this.card.absolutePosition,$.absolutePosition,this.playParticlesFly,I,null!==(k=null===(K=null===(X=this.animationConfig)||void 0===X?void 0:X.gameSpeedModeSettings)||void 0===K?void 0:K[2])&&void 0!==k?k:1))}initCard(t){this.card=this.createCard(t),this.setCardActive(!1,{immediately:!0}),this.card.parent=this.cardParent}async initText(t){this.text=this.createText(`${t}x`),this.text.parent=this.textParent,this.textParent.scaling.setAll(1.2),this.text.position.y-=.01,this.text.setEnabled(!1)}}var xs=X(250057);const es=25,Ys=50,Hs="CoinParticleSystem",hs=.025,Ts=1e3,Ps=new G.Pq(1e-4,5e-5,1e-4);class Qs extends xs.l{constructor(t){super(Hs,t.scene),this.promiseResolver={resolver:void 0},this.completedCoins=0,this.startTime=0,this.speeds=new G.Pq(0,0,0),this.acceleration=0,this.setup=()=>{this.mesh.position.copyFrom(this.props.source.getAbsolutePosition()),this.mesh.position.y+=hs,this.mesh.isVisible=!1;const t=this.props.destination[this.orientation].x-this.mesh.position.x,V=this.props.destination[this.orientation].z-this.mesh.position.z,X=G.Pq.Distance(this.props.destination[this.orientation],this.mesh.position);this.speeds.x=t/this.props.duration,this.speeds.z=V/this.props.duration,this.speeds.y=X/this.props.duration,this.acceleration=2*this.speeds.y/this.props.duration},this.run=async()=>{this.mesh.isVisible=!0,this.initParticles(),this.startTime=Date.now();const t=this.props.scene.onAfterRenderObservable.add((()=>{this.setParticles()}));await async function(t){await new Promise((V=>{t.resolver=V}))}(this.promiseResolver),this.onAnimationEnd(),this.props.scene.onAfterRenderObservable.remove(t)},this.updateOrientation=t=>{this.orientation!==t&&(this.orientation=t,this.setup())},this.updateParticle=t=>{var V,X;const K=this.engine.getDeltaTime(),k=Date.now();if(t.id*Ys>k-this.startTime)return t;if(t.position.y<0)t.isVisible&&(t.isVisible=!1,this.completedCoins+=1),this.completedCoins===es&&(null===(X=(V=this.promiseResolver).resolver)||void 0===X||X.call(V));else{t.isVisible=!0,t.velocity.y-=this.acceleration*K,t.position.y+=t.velocity.y*K,t.position.x+=t.velocity.x*K,t.position.z+=t.velocity.z*K;const V=t.idx%2-.5>0?1:-1;t.rotation.z+=.1*V,t.rotation.x+=.05*V,t.rotation.y+=.008*V}return t},this.initParticles=()=>{for(let t=0;t<this.nbParticles;t++)this.recycleParticle(this.particles[t])},this.recycleParticle=t=>(t.isVisible=!1,t.position.x=0,t.position.y=0,t.position.z=0,t.rotation.x=UC.X.RandomRange(-Math.PI,Math.PI),t.rotation.y=UC.X.RandomRange(-Math.PI,Math.PI),t.rotation.z=UC.X.RandomRange(-Math.PI,Math.PI),t.velocity.x=UC.X.RandomRange(this.speeds.x-Ps.x,this.speeds.x+Ps.x),t.velocity.y=UC.X.RandomRange(this.speeds.y-Ps.y,this.speeds.y+Ps.y),t.velocity.z=UC.X.RandomRange(this.speeds.z-Ps.z,this.speeds.z+Ps.z),t),this.onAnimationEnd=()=>{this.completedCoins=0,this.promiseResolver.resolver=void 0,this.props.onEnd()},this.engine=t.scene.getEngine(),this.props={...t,duration:t.duration||Ts},this.orientation=t.orientation,this.addShape(this.props.coin,es),this.buildMesh(),this.mesh.material=this.props.coin.material,this.setup()}}const Js="BlinkingStars";Nq.M.ShadersStore[`${Js}VertexShader`]="precision mediump float;\n#define PI               3.14159265\nattribute vec3 position;attribute vec2 uv;uniform mat4 worldViewProjection;uniform mat4 opacityTextureMatrix;uniform float textureScaleX;uniform float textureScaleY;uniform float textureMoveX;varying vec2 vUV;varying vec2 opacityTextureUV;varying vec4 baseColor;varying vec4 yellowColor;vec4 red=vec4(.478,.137,.137,1.);vec4 yellow=vec4(1.,.847,.455,1.);mat2 rotate2d(float angle){return mat2(cos(angle),-sin(angle),sin(angle),cos(angle));}mat2 scale2d(vec2 ratio){return mat2(ratio.x,0.,0.,ratio.y);}void main(){vUV=uv;yellowColor=yellow;vUV-=vec2(.5);vUV=scale2d(vec2(textureScaleY,textureScaleX))*vUV;vUV+=vec2(.5);vUV.x-=textureMoveX;vUV-=vec2(.5);vUV=rotate2d(PI*1.25)*vUV;vUV+=vec2(.5);baseColor=1.-mix(red,yellow,vec4(0.35));opacityTextureUV=vec2(opacityTextureMatrix*vec4(uv,1.,0.));gl_Position=worldViewProjection*vec4(position,1.);}",Nq.M.ShadersStore[`${Js}FragmentShader`]="precision mediump float;\n#define random(x)fract(1e4*sin(x*99.))\n#define flareRandom(x)(random(vec2(x,x+.1))*2.-1.)\nvarying vec2 vUV;varying vec2 opacityTextureUV;varying vec4 baseColor;varying vec4 yellowColor;uniform float time;uniform float textureScaleX;uniform float textureScaleY;uniform float textureMoveX;uniform float flareScale;uniform float starsCount;uniform float opacity;uniform sampler2D opacityTexture;uniform mat4 opacityTextureMatrix;float flareInnerRadius=0.007;mat2 raysMatrix=mat2(2.,.05,.05,2.);vec4 stars(vec4 fragColor,vec2 uv){vec2 centerCoord=(uv+uv-1.);for(float i=0.;i<starsCount;i++){vec2 coord=centerCoord-flareRandom(i);coord=abs(coord)*raysMatrix/flareScale;float flare=flareInnerRadius/abs(coord.x*coord.y)*(1.-length(coord));fragColor+=flare*pow(.5+.5*sin(((5.*random(i+.06))*time)+(random(i+.3)*6.)),3.);}fragColor/=3.;return fragColor;}void main(void){vec4 opacityColor=vec4(texture2D(opacityTexture,opacityTextureUV));vec4 starsColor=stars(baseColor,vUV);gl_FragColor=mix(yellowColor,starsColor,baseColor);gl_FragColor.a=(opacityColor.r-.01)*opacity;}";class Us extends mq.B{constructor(t,V,X,K){super(`blinking-stars-material-${t}`,V,{vertex:Js,fragment:Js},{attributes:["position","uv"],uniforms:["worldViewProjection"],needAlphaBlending:!0}),this.time=0,this.opacity=0,this.opacityCoefficient=1,this.updateTime=()=>{const t=this.scene.getEngine().getDeltaTime();if(this.time+=.002*t,this.setFloat("time",this.time),this.opacity<=0&&-1===this.opacityCoefficient)return this.time=0,void this.scene.unregisterBeforeRender(this.updateTime);this.opacity>=1&&1===this.opacityCoefficient||(this.opacity+=.1*this.opacityCoefficient,this.setFloat("opacity",this.opacity))},this.scene=this.getScene(),this.setTexture("opacityTexture",X),this.setMatrix("opacityTextureMatrix",X.getTextureMatrix()),this.alpha=.99,this.setFloat("time",this.time),this.setFloat("textureScaleX",K.textureScaleX),this.setFloat("textureScaleY",K.textureScaleY),this.setFloat("textureMoveX",K.textureMoveX),this.setFloat("flareScale",K.flareScale),this.setFloat("starsCount",K.starsCount),this.setFloat("opacity",this.opacity)}dispose(){this.scene.unregisterBeforeRender(this.updateTime),super.dispose()}stop(){this.opacityCoefficient=-1}start(){this.opacityCoefficient=1,this.scene.registerBeforeRender(this.updateTime)}}const ls={[iV.K8.Tie]:{textureScaleY:.8,textureScaleX:.8,textureMoveX:0,flareScale:.8,starsCount:70},[iV.K8.Banker]:{textureScaleX:.75,textureScaleY:1.5,textureMoveX:.3,flareScale:.5,starsCount:130},[iV.K8.Player]:{textureScaleX:.75,textureScaleY:1.5,textureMoveX:.3,flareScale:.5,starsCount:130},[iV.K8.PlayerPair]:{textureScaleX:.8,textureScaleY:2.5,textureMoveX:.2,flareScale:.5,starsCount:100},[iV.K8.BankerPair]:{textureScaleX:.8,textureScaleY:2.5,textureMoveX:.2,flareScale:.5,starsCount:100}};class is{constructor(t,V){const X=V.name.split(".")[0],K=V.material,k=ls[X];this.material=new Us(X,t,K.opacityTexture,k)}startAnimation(){this.material.start()}stopAnimation(){this.material.stop()}getMaterial(){return this.material}dispose(){this.material.dispose()}}class Gs extends _q{}function ds(t,V,X,K){return{control1:new G.Pq(t.x,V.y+X,V.z-K),control2:new G.Pq(V.x,V.y+X,V.z-K)}}class Ms extends Gs{constructor(t){super(t),this.multipliers=[],this.saveMultipliedCard=t=>{var V;const{placeHolder:X,cardPlace:K}=t.payload,k=null===(V=this.props.tablesManager.table)||void 0===V?void 0:V.cardsOnTable.getCardsForHandAt(X,K);k&&this.multipliers.find((({card:t})=>k.name.startsWith(`${NV.ContainerPrefix}-${t}`)))&&this.cards.push({cardModel:k,cardPlace:K,placeHolder:X})},this.flyFromCardToBowl=t=>{const V=t.cardModel.getAbsolutePosition(),X=this.destination.getAbsolutePosition().clone(),{control1:K,control2:k}=ds(V,X,.08,.2);return this.props.playParticlesFly(),t.cardModel.setActive(!0),async function(t,V,X,K,k,A,$){const I=new us({capacity:1e3,scene:t,keyFrames:Os(V,X,K,k,15),playParticlesFly:$});await I.run(A)}(this.scene,V,K,k,X,this.speed,this.props.playParticlesFly)},this.saveMultipliers=t=>{this.multipliers=t.payload},this.removeParticles=async()=>{const t=[];for(const V of this.cards)t.push(this.flyFromCardToBowl(V)),await nI(100);await Promise.all(t),this.cards=[],this.props.transport3D.sendFrom3dWorld({type:vI.MultipliersRemoved,payload:void 0})},this.scene=t.scene,this.destination=e.getMeshByName(mC.Prefix,this.scene),this.cards=[],this.speed=t.speed||1,this.subscribeOnMessagesTo3D({[u.OpenCard]:this.saveMultipliedCard,[ZI.SetMultipliers]:this.saveMultipliers,[ZI.MultipliersRemove]:this.removeParticles})}}class Bs extends Gs{constructor(t){super(t),this.handleBowlState=t=>{t.payload?this.props.bowl.open():this.props.bowl.close()},this.handleBowlHide=t=>{t.payload&&this.props.bowl.hide()},this.handleBowlShow=()=>{this.props.bowl.show()},this.handleOrientation=t=>{const V=t.payload;this.props.bowl.updatePosition(this.props.positions[V])},this.subscribeOnMessagesTo3D({[rI.SetBowlState]:this.handleBowlState,[ZI.SetShuffleStarted]:this.handleBowlHide,[ZI.SendBurnDone]:this.handleBowlShow,[u.ChangeOrientation]:this.handleOrientation})}}const os=t=>()=>{t.sendFrom3dWorld({type:WI.SetBowlVisibilityDone,payload:void 0})};var fs=X(659268);const gs=6,tS=new G.ov(.69,.52,.28,1);function VS(t,V,X,K,k){const A=new fs.y(`multiplierParticles${M.S0.RandomId()}`,3,k),$=t.instance.getChildren()[0],I=X?200:450;$.getChildMeshes().map((t=>FX($,(V=>V===t.name)).instantiateHierarchy())).forEach((t=>{A.addSurfacePoints(t,I,fs.q.Stated,tS,.3)})),A.buildMeshAsync().then((()=>{t.instance.setEnabled(!1),t.instance.disposeCard()}));let C=0,n=0;const q=A.particles.sort(((V,X)=>"Banker"===t.hand?V.position.x-X.position.x:X.position.x-V.position.x)).reduce(((t,X,k)=>{const A=function(t,V){return Math.floor((gs-V)*(t/100+2*Math.random()))}(k,K),$=function(t,V,X){const{control1:K,control2:k}=ds(t,V,UC.X.RandomRange(.14,.16),UC.X.RandomRange(.15,.2));return G.jj.CreateCubicBezier(t,K,k,V,X).getPoints()}(X.position,V.getAbsolutePosition(),A);return t.set(X,$),n<A&&(n=A),t}),new Map);return A.updateParticle=t=>{const V=q.get(t);return V[C]&&(t.position=V[C]),t},new Promise((t=>{k.registerBeforeRender((()=>{C<n?(A.setParticles(),C++):(A.dispose(),t())}))}))}class XS extends Gs{constructor(t){super(t),this.handleOrientation=t=>{const V=t.payload;this.props.winningCoins.updateOrientation(V)},this.handleStartWinningCoins=()=>{this.props.winningCoins.run()},this.subscribeOnMessagesTo3D({[u.ChangeOrientation]:this.handleOrientation,[rI.WinningCoinsStart]:this.handleStartWinningCoins})}}const KS=[...KI,{start:ZI.CommonAnimationStart,stop:vI.CommonAnimationDone},{start:ZI.TombstoneAnimationStart,stop:vI.TombstoneAnimationDone},{start:rI.SetBowlVisibility,stop:WI.SetBowlVisibilityDone}],kS=30;var AS;function $S(t){const{scene:V,messageSender3d:X,tableManager:K,getEndPosition:k,createText:A,feePercent:$,currency:I,scale:C,sameY:n=!0,playFeePercent:q,disableFee:R}=t;return async(t,F)=>{var s,S,c;const N=null===(s=K.table)||void 0===s?void 0:s.bettingGrid;if(!(null==R?void 0:R())&&N){const K=null===(c=null===(S=N.getSpots())||void 0===S?void 0:S[t].mesh.absolutePosition)||void 0===c?void 0:c.clone();if(K){const t=k(),R=A(HX.ej(xX.J0.multiply(F,$/100),{currencySymbol:I}));R.scaling.setAll(C());const s=V.activeCamera;R.rotation.x+=s.beta,t.y+=.01,t.z-=.01,n&&(K.y=t.y);const S=e.createMultiStepAnimation({prop:"position",keys:[{frame:0,value:K},{frame:4,value:K},{frame:20,value:t}],easingMode:WC.KA.EASINGMODE_EASEOUT,easingFunc:new WC.fA}),c=new G.Pq(.3,.3,.3),N=e.createMultiStepAnimation({prop:"scaling",keys:[{frame:0,value:R.scaling},{frame:10,value:R.scaling},{frame:20,value:c}],easingMode:WC.KA.EASINGMODE_EASEOUT,easingFunc:new WC.fA}),m=e.createMultiStepAnimation({prop:"visibility",keys:[{frame:0,value:0},{frame:4,value:0},{frame:8,value:1},{frame:16,value:1},{frame:20,value:0}],easingMode:WC.KA.EASINGMODE_EASEOUT,easingFunc:new WC.fA});X.to.commonAnimationStart(),q(),await V.beginDirectAnimation(R,[S,m,N],0,S.getHighestFrame()).waitAsync(),X.from.commonAnimationDone()}}}}(function(t){t["Bonsai"]="bonsai",t["RoomGoLive"]="room_golive"})(AS||(AS={}));class IS{static prepareNumbers(t){return t.getChildMeshes(!0).reduce(((t,V)=>{const X=e.getMeshSize(V,!0);return t[V.name.slice(-1)]={node:V,width:X.x,height:X.z},t}),{})}constructor(t){this.cacheDict={},this.id=t.id,this.dict=IS.prepareNumbers(t.sample),this.cacheContainer=new wC.V(`Text3d-cache-${this.id}`)}createText(t){let V=this.cacheDict[t];if(!V){const X=t.split("");this.validate(X),V=new FR.e(`Text3d-${t}-${this.id}`,void 0,this.cacheContainer),V.isVisible=!1,this.cacheDict[t]=V;let K=-X.reduce(((t,V)=>t+this.dict[V].width),0)/2;for(const t of X)if(this.dict[t]){const X=this.dict[t].node.clone(this.dict[t].node.name,null);X&&(X.parent=V,X.position.x=K+this.dict[t].width/2,K+=this.dict[t].width)}}return V.instantiateHierarchy(null,{doNotInstantiate:!0})}validate(t){for(const V of t)if(!this.dict[V])throw new Error(`Text3d: char ${V} doesn't exist in ${Object.keys(this.dict)}`)}}const CS=[[0,"#f3db9c"],[.25,"#ecd9a7"],[.35,"#ffecc9"],[.4,"#deb658"],[1,"#daac3e"]];function nS(t,V=[{value:0,data:CS}]){return X=>{const K=function(t,V){let X=V[0].data;return V.forEach((({value:V,data:K})=>{t>=V&&(X=K)})),X}(function(t){const V=t.match(/(\d+)/);if(V)return parseInt(V[0],10);throw new Error(`Can't convert ${t} to number`)}(X),V);return IX(t,{id:`multiplier-${X}`,text:X,fontWeight:kX.Bold,fontFamily:"Inter, Arial, sans-serif",color:"#e2a306",alpha:1,meshWidth:.08,threshold:1,meshRatio:2,shadow:!0,gradient:{position:[0,0,0,100],waypoints:K}})}}function qS(t){const V=[{frame:0,value:t.position.y},{frame:20,value:t.position.y+.01},{frame:40,value:t.position.y}];return e.createMultiStepAnimation({prop:"position.y",keys:V,easingFunc:new WC.fA,easingMode:WC.KA.EASINGMODE_EASEINOUT,loopMode:QF.X5.ANIMATIONLOOPMODE_CYCLE})}function RS(t,V){const X=void 0===V?!t.visibility:V,K=[{frame:0,value:X?0:1},{frame:20,value:X?1:0}];return e.createMultiStepAnimation({prop:"visibility",keys:K,easingFunc:new WC.fA,easingMode:WC.KA.EASINGMODE_EASEINOUT,loopMode:QF.X5.ANIMATIONLOOPMODE_CONSTANT})}class FS extends gF{constructor(t){super(t),this.props=t,this.systems=[],this.initialState=t.initialState,this.bundle=t.bundle,this.transport3D=t.transport3D,this.messageSender3d=t.messageSender3d,this.flatCardCreator=Ds({card:this.bundle.flatCard,frontMeshName:NV.FrontPrefix,backMeshName:NV.BackPrefix,applyToDecks:!1},this.scene),this.tableManager=this.createTableManager(),this.createMultiplierText=function(t,V,X=1){const K=new IS({sample:V,id:t});return t=>{const V=K.createText(t);return V.scaling.setAll(X),V}}("multiplier",e.getMeshByName(jV.Numbers,this.scene),.3),this.bowlNode=FX(this.scene,(t=>t===mC.Prefix)),this.bowlNodeParent=this.bowlNode.parent,this.setupScene()}createCardCreator(){return Ds({card:this.bundle.card,frontMeshName:`${NV.FrontPrefix}${NV.ElasticPostfix}`,backMeshName:`${NV.BackPrefix}${NV.ElasticPostfix}`,applyToDecks:!0},this.scene)}setupScene(){super.setupScene(),this.registerCameraSystem(),this.registerBettingSystem(),this.registerShuffleCutSystems(),this.registerDynamicShadowSystem(),this.registerGoLiveSystem(),this.registerTableStateUpdateSystem(),this.registerBowlSystem(),this.registerFlyingFeeSystem(),this.registerWinningCoinsSystem(),this.registerTombstoneSystem(),this.registerSpotHighlightSystem(),this.registerSpotMultiplierSystem(),this.registerMultiplierSystem(),this.registerBowlCometsSystem()}registerShuffleCutSystems(){const t=this.isMobile?function(t){return function(t){return new GC(t)}(t)}({scene:this.scene,tableInfo:this.tableManager.table,sounds:this.props.sounds}):function(t){return new dC(t)}({scene:this.scene,tableManager:this.tableManager,sounds:this.props.sounds});super.registerShuffleCutSystems(t)}createTableManager(){return function(t){return new ts(t)}({tableInfo:Fq({scene:this.scene,playCardsInHolderSound:this.props.sounds.playCardsInHolderSound,playDeckOutOfShoeSound:this.props.sounds.playDeckOutOfShoeSound,playShoeSliderSound:this.props.sounds.playShoeSliderSound,chipAmounts:this.initialState.chipAmounts,DS:this.props.DS,balance:this.initialState.balance,isChipSelectorShadowEnabled:!1,tooltipManager:this.chipSelectorTooltipManager,isPlaqueEnabled:!1,isMobile:this.isMobile,cardCreator:this.cardCreator})})}createCameraManager(){var t,V;return new KR(this.camera,function({scene:t,states:V,initialTargets:X,idle:{cameraPosition:K,targetPosition:k,animateFromDuration:A}}){var $;const I=new ZC.L(M.S0.RandomId(),0,0,0,G.Pq.Zero(),t),C={[Xt.RoomFocus]:X},n=FX(e.getMeshByName(uV,t),(t=>CX(t,nV.Prefix)));return I.setTarget(e.localToGlobal(V.betting.target,n)),I.setPosition(e.localToGlobal(V.betting.position,n)),C[Xt.TableFocus]={target:I.target.clone(),alpha:e.convertToPositiveAngle(I.alpha),beta:I.beta,radius:I.radius,animateFrom:{[Xt.RoomFocus]:{duration:EC,easingFunc:new WC.kc,easingMode:WC.KA.EASINGMODE_EASEINOUT,inTangent:DC,outTangent:yC,needConstantDelta:!1},[Xt.TableDealing]:{duration:1.5,easingFunc:new WC.kc,easingMode:WC.KA.EASINGMODE_EASEINOUT},[Xt.TableWin]:{duration:1.5,easingFunc:new WC.kc,easingMode:WC.KA.EASINGMODE_EASEINOUT},[Xt.TableIdle]:{duration:.5}}},I.setTarget(k),I.setPosition(K),C[Xt.TableIdle]={target:I.target.clone(),alpha:e.convertToPositiveAngle(I.alpha),beta:I.beta,radius:I.radius,animateFrom:{[Xt.TableFocus]:{duration:A,easingFunc:new WC.kc,easingMode:WC.KA.EASINGMODE_EASEINOUT,onCancel:()=>{}}}},I.setTarget(e.localToGlobal(V.deal.target,n)),I.setPosition(e.localToGlobal(V.deal.position,n)),C[Xt.TableDealing]={target:I.target.clone(),alpha:e.convertToPositiveAngle(I.alpha),beta:I.beta,radius:I.radius,animateFrom:{[Xt.TableFocus]:{duration:null!==($=V.deal.duration)&&void 0!==$?$:2,easingFunc:new WC.kc,easingMode:WC.KA.EASINGMODE_EASEINOUT}}},I.setTarget(e.localToGlobal(V.win.target,n)),I.setPosition(e.localToGlobal(V.win.position,n)),C[Xt.TableWin]={target:I.target.clone(),alpha:e.convertToPositiveAngle(I.alpha),beta:I.beta,radius:I.radius,animateFrom:{[Xt.TableDealing]:{duration:.8,easingFunc:new WC.kc,easingMode:WC.KA.EASINGMODE_EASEINOUT}}},C[Xt.RoomFocus].animateFrom||(C[Xt.RoomFocus].animateFrom={}),C[Xt.RoomFocus].animateFrom[Xt.TableIdle]={duration:EC,easingFunc:new WC.kc,easingMode:WC.KA.EASINGMODE_EASEINOUT,inTangent:yC,outTangent:DC,needConstantDelta:!1},C[Xt.RoomFocus].animateFrom[Xt.TableFocus]={duration:EC,easingFunc:new WC.kc,easingMode:WC.KA.EASINGMODE_EASEINOUT,inTangent:yC,outTangent:DC,needConstantDelta:!1},I.dispose(),C}({scene:this.scene,states:this.bundle.desktopCameraInfo,initialTargets:this.bundle.desktopInitialCamera,idle:{cameraPosition:this.props.idleAnimation.cameraPosition,targetPosition:this.props.idleAnimation.targetPosition,animateFromDuration:null!==(V=null===(t=this.props.bundle.idleAnimation)||void 0===t?void 0:t.firstFrameDuration)&&void 0!==V?V:15}}))}initRenderManager(){return e.createRenderManager({transport:this.transport3D,renderer:this.renderer,rules:KS})}registerSystem(t){return this.systems.push(t),this}registerBettingSystem(){const t=this.props.DS.IS_TABLET?void 0:PR({cameraManager:this.cameraManager,scene:this.scene,emitters:this.props.initialState.gameResultTransportEmitters}),V=!this.props.DS.IS_TABLET&&t?new QR({gameResult:t}):void 0;this.registerSystem(new cF({setupSpotsOnInit:!1,messageSender3d:this.messageSender3d,scoreManager:new JR({sides:Object.values(zK),shouldSubscribeOnResize:this.isMobile,scene:this.scene,getScoreNodes:this.isMobile?UR((()=>this.orientation)):lR,createScore:GR({cameraManager:this.cameraManager,scene:this.scene,emitters:this.props.initialState.scoresTransportEmitters})}),shadowLightName:_V.Shadow,cutCardsSliderManager:new dR({createSkipCutCards:BR({cameraManager:this.cameraManager,scene:this.scene,emitters:this.props.initialState.cutCardsSliderTransportEmitters})}),tableBubbleManager:new oR({createTableBubble:gR({cameraManager:this.cameraManager,scene:this.scene,emitters:this.props.initialState.tableBubbleTransportEmitters})}),gameResultManager:V,tooltipManager:this.tooltipManager,transport3D:this.transport3D,tableManager:this.tableManager,selectedChip:this.props.initialState.selectedChip,bettingGridType:this.props.initialState.bettingGridType,scene:this.scene,getClothColor:()=>"#ff1f1f",sounds:this.props.sounds,getBetSpotDynamicHighlight:t=>new is(this.scene,t)}))}registerBowlSystem(){var t;this.registerSystem(new Bs({transport3D:this.transport3D,scene:this.scene,bowl:new Ss({node:this.bowlNode,callbacks:{onChangeStateComplete:(t=this.transport3D,()=>{t.sendFrom3dWorld({type:WI.SetBowlStateDone,payload:void 0})}),onChangeVisibilityComplete:os(this.transport3D),onAnimationStart:()=>this.messageSender3d.to.commonAnimationStart(),onAnimationDone:()=>this.messageSender3d.from.commonAnimationDone()},playOpenBowl:this.props.sounds.playOpenBowl}),positions:{[nt.t.Portrait]:this.bowlNodeParent.position.add(new G.Pq(0,0,-.24)),[nt.t.Landscape]:this.bowlNodeParent.position.clone()}}))}registerFlyingFeeSystem(){this.registerSystem(new Oq({scene:this.scene,transport3D:this.transport3D,tablesManager:this.tableManager,createFlyingFee:$S({scene:this.scene,messageSender3d:this.messageSender3d,tableManager:this.tableManager,getEndPosition:()=>this.scene.getMeshByName(mC.Prefix).absolutePosition.clone(),createText:nS(this.scene),feePercent:this.props.fee.percentage,currency:this.initialState.currencySymbol,scale:()=>.7,playFeePercent:this.props.sounds.playFeeFly,disableFee:()=>this.props.DS.IS_PHONE&&this.orientation===nt.t.Landscape})}))}registerWinningCoinsSystem(){var t,V;this.registerSystem(new XS({scene:this.scene,transport3D:this.transport3D,winningCoins:new Qs({duration:null!==(V=null===(t=this.initialState.gameSpeedModeSettings)||void 0===t?void 0:t[5])&&void 0!==V?V:1e3,name:"winningCoinsMesh",source:this.bowlNodeParent,coin:FX(this.scene,(t=>"coin_win"===t)),capacity:20,scene:this.scene,onEnd:()=>this.messageSender3d.from.winningCoinsDone(),orientation:this.orientation,destination:{[nt.t.Landscape]:new G.Pq(-.48,.9,-.73),[nt.t.Portrait]:new G.Pq(-.22,.9,-.78)}})}))}registerTombstoneSystem(){const t=function(t){const{Tombstone:V,originalMesh:X,createCard:K,createText:k,colors:A,scaling:$,animationLandscapeYOffsets:I,onAppear:C,playParticlesFly:n}=t;return(t,q,R,F,s)=>new V({index:t,colors:A,originalMesh:X,createCard:K,createText:k,parent:R,data:q,orientation:F,animationConfig:s,scaling:$,animationLandscapeYOffsets:I,onAppear:C,playParticlesFly:n})}({originalMesh:FX(this.scene,(t=>t===jV.Prefix)),Tombstone:js,createText:this.createMultiplierText,createCard:this.flatCardCreator,animationConfig:{gameSpeedModeSettings:this.initialState.gameSpeedModeSettings},scaling:this.bundle.tombstoneSettings.scaling,animationLandscapeYOffsets:this.bundle.tombstoneSettings.animationLandscapeYOffsets,onAppear:this.props.sounds.playMultiplierAppear,playParticlesFly:this.props.sounds.playParticlesFly}),V={scene:this.scene,createItem:t,checkResize:!this.props.DS.IS_DESKTOP,orientation:this.orientation,needOrientationForDispose:!1,settings:this.bundle.tombstoneSettings,onMountStart:this.props.sounds.playMultipliersAppear,onDisposeStart:()=>this.messageSender3d.to.tombstoneAnimationStart(),onDisposeEnd:()=>this.messageSender3d.from.tombstoneAnimationDone(),backgroundColor:void 0};this.tombstoneManager=new yq(V);const X={scene:this.scene,getOrientation:()=>this.orientation,onTombstoneMatched:void 0,messageSender3d:this.messageSender3d,transport3D:this.transport3D,tombstoneManager:this.tombstoneManager,tablesManager:this.tableManager};this.registerSystem(new bq(X))}registerSpotHighlightSystem(){this.registerSystem(new rq({scene:this.scene,transport3D:this.transport3D,tableManager:this.tableManager,tombstoneManager:this.tombstoneManager}))}registerSpotMultiplierSystem(){this.registerSystem(new zq({transport3D:this.transport3D,tablesManager:this.tableManager,createText:this.createMultiplierText,multiplierPositions:VR,depth:0}))}registerMultiplierSystem(){var t,V;const X=function(t){const V=t.getChildren((t=>t.name.includes(yV.PlaceHolderPrefix)),!1),X=t.getChildren((t=>t.name.includes(EV.PlaceHolderPrefix)),!1);return{[zK.Player]:V.sort(),[zK.Banker]:X.sort()}}(this.tableManager.table.table);var K;this.registerSystem(new Gq({animations:{mount:t=>RS(t,!0),dispose:t=>RS(t,!1),live:qS},transport3D:this.transport3D,messageSender3d:this.messageSender3d,tablesManager:this.tableManager,scene:this.scene,createText:this.createMultiplierText,relativePosition:XR,getCardPlaceholder:(t,V,K)=>X[t][2===V&&K===nt.t.Portrait?V+1:V],sounds:{playSoundAfterMount:this.props.sounds.playMultiplierAppear},positionMultipliersOnTop:this.props.DS.IS_DESKTOP,multiplierBubbleManager:new _C({createMultiplierBubble:(K={cameraManager:this.cameraManager,scene:this.scene,emitters:this.props.initialState.multiplierBubbleTransportEmitters},t=>new LC({id:t.id,addReverseScale:!1,scene:K.scene,cameraManager:K.cameraManager,transportEmitters:K.emitters,content:{id:t.id}}))}),multipliersAsParticles:{target:FX(this.scene,(t=>t===mC.Prefix)),particlesSpeed:null!==(V=null===(t=this.initialState.gameSpeedModeSettings)||void 0===t?void 0:t[4])&&void 0!==V?V:1,isMobile:!this.props.DS.IS_DESKTOP,flyMultiplierAsParticleSystem:VS}}))}registerBowlCometsSystem(){var t;this.registerSystem(new Ms({scene:this.scene,transport3D:this.transport3D,tablesManager:this.tableManager,playParticlesFly:this.props.sounds.playParticlesFly,speed:null===(t=this.initialState.gameSpeedModeSettings)||void 0===t?void 0:t[4]}))}registerTableStateUpdateSystem(){this.registerSystem(new wq({transport3D:this.transport3D,messageSender3d:this.messageSender3d,tableData:this.tableManager.table}))}registerGoLiveSystem(){this.registerSystem(new Vs({messageSender3d:this.messageSender3d,transport3D:this.transport3D,cameraManager:this.cameraManager,wayPoints:this.isMobile?void 0:gq(this.scene),animateGoLiveRoom:t=>function(t,V=7){var X;const K=30;(function(t,V=7,X=[2,1]){const K=new J.F("go-live-plane-material",t);K.diffuseColor=new G.v9(0,0,0),K.disableLighting=!0,K.alpha=0;const k=d.QX.CreatePlane("go-live-plane",{height:1,width:1});k.position.z=t.activeCamera.minZ+.001,k.material=K,k.parent=t.activeCamera;const A=new QF.X5(`${M.S0.RandomId()}`,"alpha",kS,QF.X5.ANIMATIONTYPE_FLOAT,0);A.setKeys([{frame:0,value:0},{frame:kS*(V-X[0]),value:0},{frame:kS*(V-X[1]),value:1}]),t.beginDirectAnimation(K,[A],0,A.getHighestFrame(),!1)})(t,V);const k=[{materialName:AS.RoomGoLive,valueTo:1.2},{materialName:AS.Bonsai,valueTo:1.2}];for(const A of k){const k=t.getMaterialByName(A.materialName),$=(null===(X=k.diffuseTexture)||void 0===X?void 0:X.level)||0,I=e.createMultiStepAnimation({prop:"diffuseTexture.level",frameRate:K,loopMode:QF.X5.ANIMATIONTYPE_FLOAT,keys:[{frame:0,value:$},{frame:K*(V-5),value:$+.8*(A.valueTo-$)},{frame:K*(V-3),value:A.valueTo}]});t.beginDirectAnimation(k,[I],0,I.getHighestFrame(),!1)}}(this.scene,t)}))}registerDynamicShadowSystem(){var t,V;this.tableManager.table&&this.registerSystem(new Mq({light:this.scene.getLightByName(_V.Shadow),tables:(t=this.tableManager.table,function({tablePivot:t,generateLightCustomTransforms:V}){const X=FX(t,(t=>CX(t,nV.Prefix))),K=FX(X,(t=>CX(t,nV.ClothPrefix))),k=FX(X,(t=>CX(t,FV.Prefix))),A=FX(X,(t=>CX(t,sV.Prefix)));V&&V(X),e.addMeshToShadowGenerator(A,_V.Shadow),e.addMeshToShadowGenerator(k,_V.Shadow);const $=e.localToGlobal(oq.positionPoint,X),I=Bq.Pq.Normalize(e.localToGlobal(K.position.add(oq.targetPoint),K.parent).subtract($));return I.y=-1,{position:$,direction:I}}({tablePivot:t.table,generateLightCustomTransforms:V})),transport3D:this.transport3D}))}registerCameraSystem(){const t={getOrientation:()=>this.orientation,cameraManager:this.cameraManager,scene:this.scene,transport3D:this.transport3D,messageSender3d:this.messageSender3d,camera:this.props.camera.camera,isMobile:!this.props.DS.IS_DESKTOP,currentTarget:this.getInitialCameraTarget(!this.props.DS.IS_DESKTOP)};this.registerSystem(new Jq(t))}getInitialCameraTarget(t){return t?Xt.TableFocus:Xt.RoomFocus}}function sS(t){return pV.U({taskName:"createGameTask",execute:(V,X)=>{const K=function(t){return new FS(t)}({...t,engine:V.engine,scene:V.scene,camera:V.camera,renderer:V.renderer,images:V.images,idleAnimation:V.idleAnimation,sounds:t.initialState.sounds,fee:t.initialState.fee});X({game:K})}})}function SS({transport3d:t,messageSender3d:V,params:X,checkIsGameDisposed:K}){return async k=>{const A=(await async function(){const t=await async function(){return{...await async function(){return{cardHolder:{resource3dPath:st},cardShoe:{resource3dPath:St},riffleDeck:{resource3dPath:Dt},straightDeck:{resource3dPath:yt},card:{mesh:{resource3dPath:ct},size:{width:2048,height:2048},sprite:Nt,atlas:$t,scaling:.012},decor:{resource3dPath:[{value:Et,condition:Rt}]},chip:{resource3dPath:vt},chipHighlight:{resource3dPath:mt},plaque:{resource3dPath:pt},images:{chip:Wt,plaque:Lt},cutCard:{resource3dPath:Zt,materials:{cutcard:{emissiveColor:"#ff0900"}}},preLoad:{table_cloth:{diffuse:Ot}},environment:{level:1,texturePath:Ft,rotation:[0,M.S0.ToRadians(115),0]},shoeMobilePortraitPositionZ:.45,idleAnimation:{path:_t,speedRatio:.08,firstFrameDuration:15},desktopCameraInfo:{betting:{position:new G.Pq(0,1.64,-1.32),target:new G.Pq(0,.672,-.1)},deal:{position:new G.Pq(-.00357,1.69718,-.8),target:new G.Pq(-.0046,.672,-.05)},win:{position:new G.Pq(-.00357,1.69718,-.8),target:new G.Pq(-.0046,.672,-.05)}},desktopInitialCamera:{[e.CameraPositionProps.Target]:new G.Pq(-.007,.4423,2.0858),[e.CameraPositionProps.Alpha]:M.S0.ToRadians(212.28),[e.CameraPositionProps.Beta]:M.S0.ToRadians(69.8),[e.CameraPositionProps.Radius]:19.09},tableSizeOptions:{[nt.t.Portrait]:{borderSize:.09,horizontalScale:.65},[nt.t.Landscape]:{borderSize:.05,horizontalScale:1.5}},mobileCameraSettings:{[nt.t.Portrait]:{[Xt.RoomFocus]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(30)},[Xt.TableIdle]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(30)},[Xt.TableFocus]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(30),[e.CameraPositionProps.Fov]:M.S0.ToRadians(45)},[Xt.TableDealing]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(10),[e.CameraPositionProps.Target]:new G.Pq(0,0,.22),[e.CameraPositionProps.Radius]:.85},[Xt.TableWin]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(10),[e.CameraPositionProps.Target]:new G.Pq(0,0,.22),[e.CameraPositionProps.Radius]:.85}},[nt.t.Landscape]:{[Xt.RoomFocus]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(48)},[Xt.TableIdle]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(48)},[Xt.TableFocus]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(48)},[Xt.TableDealing]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(35),[e.CameraPositionProps.Target]:new G.Pq(0,0,.1)},[Xt.TableWin]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(35),[e.CameraPositionProps.Target]:new G.Pq(0,0,.1)}}}}}(),card:{mesh:{resource3dPath:ct},sprite:xt,atlas:jt.frames,size:jt.meta.size,scaling:.012,effects:{sprite:ut,atlas:at.J,size:at.m.E}},flatCard:{mesh:{resource3dPath:et},sprite:xt,atlas:jt.frames,size:jt.meta.size,effects:{sprite:ut,atlas:at.J,size:at.m.E}},bettingGrid:{resource3dPath:wt},chip:{resource3dPath:vt},bowl:{resource3dPath:bt},multipliers:{resource3dPath:ht,materials:{multipliers:{diffuse:{level:1.5,path:[{value:Tt,condition:qt},{value:Pt,condition:At.Fr}]}}}},coin:{resource3dPath:Yt,materials:{coin_win:{roughnessValue:.6,metallicValue:1,diffuseColor:"#FFC239"}}},chipHighlight:{resource3dPath:mt},plaque:{resource3dPath:pt},room:{resource3dPath:Qt,materials:{room:{diffuse:{level:1.2,path:[{value:lt,condition:qt},{value:it,condition:At.Fr}]}},room_golive:{diffuse:{level:.3,path:[{value:Jt,condition:qt},{value:Ut,condition:At.Fr}]}}}},images:{chip:Wt,plaque:Lt},table:{resource3dPath:Gt,materials:{table:{diffuse:{level:1.1,path:[{value:dt,condition:qt},{value:Mt,condition:At.Fr}]}},player_tag:{opacity:ot},banker_tag:{opacity:Bt}}},tombstone:{resource3dPath:ft},excludeMesh:{[Vt.TableLogo]:!0},disposeMesh:{[rt.RimLowerMobileL]:[{value:!0,condition:At.xl}],[rt.RimLowerMobileR]:[{value:!0,condition:At.xl}],[rt.PositionChipstackMobile]:[{value:!0,condition:At.xl}],[rt.RimLowerDesktopL]:[{value:!0,condition:At.Fr}],[rt.RimLowerDesktopR]:[{value:!0,condition:At.Fr}],[rt.PositionChipstackDesktop]:[{value:!0,condition:At.Fr}]},environment:{level:1,texturePath:Ft,rotation:[0,M.S0.ToRadians(115),0]},shoeMobilePortraitPositionZ:.36,preLoad:{room:{diffuse:it},room_golive:{diffuse:Ut,emissive:Ut},multipliers:{diffuse:Pt,emissive:Pt},table:{diffuse:Mt}},idleAnimation:{path:Ht,speedRatio:.1,firstFrameDuration:15},desktopCameraInfo:{betting:{position:new G.Pq(0,1.68,-1.56),target:new G.Pq(0,.73,.1)},deal:{position:new G.Pq(0,1.8326,-1.1637),target:new G.Pq(0,.65,.35)},win:{position:new G.Pq(0,1.8326,-1.1637),target:new G.Pq(0,.65,.35)}},desktopInitialCamera:{[e.CameraPositionProps.Target]:new G.Pq(0,.72,.32),[e.CameraPositionProps.Alpha]:M.S0.ToRadians(270),[e.CameraPositionProps.Beta]:M.S0.ToRadians(72),[e.CameraPositionProps.Radius]:5.871},tableSizeOptions:{[nt.t.Portrait]:{borderSize:.13,horizontalScale:.65},[nt.t.Landscape]:{borderSize:.05,horizontalScale:1.7}},mobileCameraSettings:{[nt.t.Portrait]:{[Xt.RoomFocus]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(30)},[Xt.TableIdle]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(30)},[Xt.TableFocus]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(30),[e.CameraPositionProps.Fov]:M.S0.ToRadians(45)},[Xt.TableDealing]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(15),[e.CameraPositionProps.Target]:new G.Pq(0,0,.2),[e.CameraPositionProps.Radius]:.8},[Xt.TableWin]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(15),[e.CameraPositionProps.Target]:new G.Pq(0,0,.2),[e.CameraPositionProps.Radius]:.8}},[nt.t.Landscape]:{[Xt.RoomFocus]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(60)},[Xt.TableIdle]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(60)},[Xt.TableFocus]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(60)},[Xt.TableDealing]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(60),[e.CameraPositionProps.Target]:new G.Pq(0,0,.16),[e.CameraPositionProps.Radius]:.9},[Xt.TableWin]:{[e.CameraPositionProps.Beta]:M.S0.ToRadians(57),[e.CameraPositionProps.Target]:new G.Pq(0,0,.16),[e.CameraPositionProps.Radius]:.9}}},tombstoneSettings:{gap:1.1,scaling:{[zt.OD.Desktop]:1,[zt.OD.Tablet]:1,[zt.OD.Phone]:1},availableCardsAmountOnFullLength:6,positions:{[nt.t.Portrait]:{screenPoint:{getX:t=>.5*t,getY:()=>0}},[nt.t.Landscape]:{[zt.OD.Desktop]:new G.Pq(0,1,.563)}}}}}();return V=>Y.dl(t,V)}())({ds:k.DS}),$=X.tableConfig,I=new T({bundle:A,condition:()=>k.initialState.isNetworkSpeedSlow,options:{beforeLoad:V.to.startSceneRender(),afterLoad:V.from.endSceneRender()}}),C=function({sceneFeatures:t={},materialFeatures:V={},checkIsGameDisposed:X,...K}){var k;const A=e.createDefaultEngineOptions(K.DS),$=e.createDefaultEngineFeatures(K.DS),I=tV([new RegExp(Vt.FloorPrefix)]);return lV.e([(n={...e.createDefaultMaterialFeatures(),...V},pV.U({taskName:"setMaterialFeaturesTask",execute:(t,V)=>{(function(t){e.setMaterialFeatures(t),void 0!==t.DiffuseTextureEnabled&&(J.F.DiffuseTextureEnabled=t.DiffuseTextureEnabled),void 0!==t.EmissiveTextureEnabled&&(J.F.EmissiveTextureEnabled=t.EmissiveTextureEnabled),void 0!==t.BumpTextureEnabled&&(J.F.BumpTextureEnabled=t.BumpTextureEnabled),void 0!==t.OpacityTextureEnabled&&(J.F.OpacityTextureEnabled=t.OpacityTextureEnabled)})(n),V()}})),e.createEngineTask(K.canvas,A,{...$,renderEvenInBackground:!0}),xV({...e.createDefaultSceneFeatures(),renderTargetsEnabled:!0,skeletonsEnabled:!0,postProcessesEnabled:!0,spritesEnabled:!0,...t,clearColor:G.ov.FromColor3(G.v9.Black())}),[eV({fov:.5632,minZ:.4}),e.skipAnimations(K.initialState.skipAnimations),e.createRendererTask(),e.loadImagesTask(K.bundle.images),e.loadMeshesTask(e.getMeshesToLoad(K.bundle)),(C=(null===(k=K.bundle.idleAnimation)||void 0===k?void 0:k.path)||"",pV.U({taskName:"loadTextFileTask",execute:(t,V,X)=>{C||X({errorId:hV.Q.AssetNotLoaded});const K=e.createAssetsManager(t.scene);K.addTextFileTask("idleAnimation",C),K.onTaskSuccess=t=>{const X=t.text;if(X&&function(t){try{JSON.parse(t)}catch(t){return!1}return!0}(X)){const t=YV(JSON.parse(X));V({idleAnimation:t})}},K.onTaskError=()=>{X({errorId:hV.Q.AssetNotLoaded})},K.load()}})),e.loadEnvironmentTextureTask(K.bundle.environment)],UV({pcfFilter:!0,setupTableShadows:aV}),vC(uV,K.DS,K.initialState.tiePayout),e.enhanceMeshesTask([{enhance:e.makeMeshNonPickable},{enhance:e.makeMeshDisable,test:tV(VV(K.bundle.excludeMesh).map((t=>new RegExp(t))))},{enhance:gt,test:tV(VV(K.bundle.disposeMesh).map((t=>new RegExp(t))))}]),(q=_V.Shadow,pV.U({taskName:"setupShuffleProcedure",execute:(t,V)=>{const{scene:X}=t,K=e.getMeshByName(cV.Prefix,X),k=e.getMeshByName(SV.Prefix,X),A=e.getMeshByName(SV.AnimationPrefix,X),$=e.getMeshByName(vV.Prefix,X);$V($.material);const I=t.table,C=$.clone(`${I.name}.${vV.BackPrefix}`),n=$;n.name=`${I.name}.${vV.FrontPrefix}`,n.setParent(I),n.position.set(0,0,0),n.rotation.set(0,0,0),e.changeVisibility(n,!1,!0),C.setParent(I),C.position.set(0,0,0),C.rotation.set(0,0,0),e.changeVisibility(C,!1,!0),LV(K,cV.ClonePrefix,KV.Rm,q,!0),LV(k,SV.ClonePrefix,KV.cr,q,!1,A.skeleton),V()}})),e.waitForSceneReadyTask(),sS(K),e.debugToolsTask(K.transport3D),[XV.B(K.bundle)],e.enhanceMeshesTask([{enhance:e.freezeMesh,test:I}]),e.pauseRendererTask(),e.waitForSceneReadyTask()],{},X);var C,n,q}({bundle:A,sceneFeatures:Q($),materialFeatures:l($),checkIsGameDisposed:K,canvas:k.canvas,DS:k.DS,transport3D:t,initialState:k.initialState,messageSender3d:V,orientation:k.orientation}),{game:n,scene:q,renderer:R}=await C;return C.catch((()=>g())),I.postLoad(q),function(t){kt.ZQ()&&(window.__devTools__={setPaused3D:t.setPaused.bind(t)})}(n),n}}const cS="baccarat.rng.goldenWealth";var NS=X(734065),mS=X(763048),vS=X(427377),WS=X(869558),ZS=X(63912),DS=X(617886),yS=X(523219),ES=X(9533),_S=X(525620),pS=X(377810),LS=X.t(pS,2),OS=X(732319);const rS=()=>I.Pj(),zS=_S.PA((()=>{const t=rS(),V=OS.v(t.reference.bubble.set,bK.MultiplierCards);return $.jsx("div",{ref:V,style:{display:"inline-block"}})}));var wS=X(968776),bS=X(691951);const aS=_S.PA((({isAvailable:t})=>{const V=wS.P(),X=pS.useCallback((t=>{t&&V.sounds.playClickButtonSound(),V.cutCardsSlider.cutCards()}),[V.cutCardsSlider,V.sounds]),K=pS.useCallback((t=>{V.cutCardsSlider.setCutCardsSliderPosition(t),V.cutCardsSlider.moveCutCard(t)}),[V.cutCardsSlider]);return $.jsx(bS._,{cutPosition:V.cutCardsSlider.position,timeleftSec:V.cutCardsSlider.timeLeft,hasAnimation:!0,orientation:V.device.orientation,isMobile:!V.device.isDesktop,isTablet:V.device.isTablet,isVisible:V.cutCardsSlider.isSliderShown&&t,onCut:X,onMoveCutCard:K})}));var uS=X(301983);const jS="container--71dc9",xS=()=>$.jsxs("div",{className:jS,"data-role":"skip-cut-cards",children:[$.jsx(aS,{isAvailable:!0}),$.jsx(uS.B,{})]}),eS="htmlMeshElement--a681e";function YS({TombstoneBubble:t,...V}){return $.jsx(e.HTMLMeshContainer,{Element:t,elementClassName:eS,...V})}const HS=_S.PA((()=>{const t=wS.P(),V=OS.v(t.reference.bubble.set,rK.BettingGrid);return $.jsx("div",{ref:V,style:{display:"inline-block"}})})),hS="htmlMeshElement--d60cb";function TS(t){return $.jsx(e.HTMLMeshContainer,{Element:HS,elementClassName:hS,...t})}function PS(t){const{GameResultComponent:V}=t;return $.jsx(e.HTMLMeshContainer,{Element:V,elementClassName:eS,...t})}var QS=X(699695);const JS="score--bde91",US="text--36a63",lS="hide--1ab6d",iS={[zt.OD.Phone]:.5,[zt.OD.Desktop]:.8*1.2,[zt.OD.Tablet]:.6},GS=_S.PA((t=>{const V=pS.useRef(0),X=wS.P(),K=X.table.cardsNotEmpty,k=X.cards.getScore(t.id),A={"--size":WK._m(iS[X.device.platform])};return pS.useEffect((()=>{void 0!==k&&(V.current=k)}),[k]),$.jsx("div",{className:QS.A(JS,{[lS]:void 0===k||!K}),style:A,children:$.jsx("span",{className:US,children:null!=k?k:V.current})})})),dS=t=>$.jsx(e.HTMLMeshContainer,{Element:GS,...t}),MS=()=>$.jsxs("div",{className:jS,"data-role":"skip-cut-cards",children:[$.jsx(aS,{isAvailable:!0}),$.jsx(uS.B,{})]}),BS=t=>{const{SkipCutComponent:V}=t;return $.jsx(e.HTMLMeshContainer,{Element:null!=V?V:MS,...t})};var oS=X(991548),fS=X(827424),gS=X(48415),tc=X(872197),Vc=X(600686),Xc=X(494475),Kc=X(13799);const kc=Xc.Oe((({state:t,ownProps:V})=>{var X,K;const k=Kc.md(t),A=Kc.uD(t),{isLargeScreen:$}=fS.Qo(gS.Q.size.value),I=!jk.I()&&($||A.IS_IOS||A.IS_ANDROID5_0_0_PLUS||!1);let C=null!==(X=V.displayStars)&&void 0!==X?X:I,n=null!==(K=V.displayCoins)&&void 0!==K?K:I;return void 0!==V.winType&&(C=I&&tc.D0(V.winType),n=I&&tc.il(V.winType)),{displayStars:C,displayCoins:n,useLiteRenderMode:k!==zt.OD.Desktop}}),(()=>[gS.Q.size])),Ac=kc(Vc.pb);var $c;(function(t){t["Winner"]="game-result-winner",t["Message"]="winning-message",t["Text"]="winning-message-text",t["Amount"]="winning-message-amount"})($c||($c={}));const Ic=(Cc=({winType:t,scale:V})=>$.jsx(Ac,{winType:t,scale:V}),nc={Phone:.5},_S.PA((t=>{var V;const X=I.Pj(),K=null!==(V=nc[X.ag.platform])&&void 0!==V?V:1;return $.jsx(Cc,{...t,scale:K})})));var Cc,nc,qc;(function(t){t["DarkSemicircle"]="darkSemicircle",t["Big"]="big"})(qc||(qc={}));var Rc=X(148999);function Fc(t=[]){return t.map((t=>$.jsx(t,{},Rc.MZ())))}function sc(t,V){const[X,K,k]=Array.isArray(t)?t:[t,t,t];return{"--gradientColor0":`rgba(${X}, 0)`,"--gradientColor1":`rgba(${K}, ${V})`,"--gradientColor2":`rgba(${k}, 0)`}}var Sc=X(757069),cc=X(663078);const Nc=0;var mc;(function(t){t["Idle"]="idle",t["Waiting"]="waiting",t["Ready"]="ready",t["InProgress"]="in_progress"})(mc||(mc={}));class vc{constructor(t,V){this.fps=30,this.options={from:Nc,to:Nc},this.duration=t,this.delay=V||0,this.status=this.delay>0?mc.Idle:mc.Ready}get state(){return this.status}get frameTime(){return 1e3/this.fps}run(t){t.from!==t.to&&(this.status===mc.InProgress&&this.finish(),this.options=t,this.status!==mc.Idle?this.status===mc.Ready&&this.start():this.wait((()=>this.start())))}dispose(){var t,V;this.delayTimeoutId&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=void 0),this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=void 0,null===(V=(t=this.options).onFinish)||void 0===V||V.call(t))}wait(t){this.status=mc.Waiting,this.delayTimeoutId=setTimeout((()=>{this.status=mc.Ready,t()}),this.delay)}start(){var t,V;this.status=mc.InProgress,this.rafId=requestAnimationFrame((t=>this.animate(t))),null===(V=(t=this.options).onStart)||void 0===V||V.call(t)}shouldEmitChangeInCurrentFrame(t){if(void 0===this.lastFrameTimestamp)return this.lastFrameTimestamp=t,!1;const V=t+16,X=this.lastFrameTimestamp+this.frameTime;return X<=V&&(this.lastFrameTimestamp=X,!0)}animate(t){this.startTimestamp||(this.startTimestamp=t);const V=(t-this.startTimestamp)/this.duration;if(V>=1)this.finish();else{if(this.shouldEmitChangeInCurrentFrame(t)){const t=this.computeNextValue(V);this.emit(t)}this.rafId=requestAnimationFrame((t=>this.animate(t)))}}computeNextValue(t){const{from:V,to:X}=this.options,K=V+(X-V)*t,k=function(t){const V=t.toString(),X=V.indexOf(".");return-1===X?0:V.length-X-1}(X),A=10**k;return Math.round(K*A)/A}emit(t){var V,X;this.previousValue!==t&&(this.previousValue=t,null===(X=(V=this.options).onChange)||void 0===X||X.call(V,t))}finish(){this.dispose(),this.emit(this.options.to),this.lastFrameTimestamp=void 0,this.startTimestamp=void 0,this.status=mc.Ready}}const{useState:Wc,useRef:Zc}=LS,Dc=pS.memo((({children:t,duration:V,value:X,delay:K,disabled:k,forceFromInitialValue:A,onStart:$,onFinish:I,skipSetTargetValueWhenDisabled:C=!1})=>{const n=jk.I()?0:V,q=Zc(new vc(n,K)),[R,F]=Wc(Nc),s=Sc.Z(X);k&&R!==X&&!C&&F(X),pS.useEffect((()=>{k||q.current.run({from:A?Nc:null!=s?s:Nc,to:X,onChange:F,onStart:$,onFinish:I})}),[k,I,$,X,s,A]),cc.i((()=>q.current.dispose()));const S=t(R,R===X);return S&&pS.Children.only(S)}));function yc(t,V,X,K){const k=X?Math.floor(V):V;return HX.ej(k,{currencySymbol:t,maximumDecimalCount:K})}const Ec="appearing--1f7c1",_c=1540,pc=({amount:t,isAnimated:V,currency:X,currencyDecimals:K,onCounterAnimationStart:k,onCounterAnimationEnd:A,scale:I})=>{const[C,n]=pS.useState(!0);function q(){n(!1)}return V?$.jsx(Dc,{duration:_c,value:t,disabled:C,onStart:k,onFinish:A,forceFromInitialValue:!0,skipSetTargetValueWhenDisabled:!0,children:V=>$.jsx("div",{className:Ec,onAnimationEnd:q,style:{"--scale":I},children:yc(X,C?0:V,t!==V,K)})}):$.jsx($.Fragment,{children:yc(X,t,!1,K)})},Lc=_S.PA((t=>{const V=I.Pj(),X=pS.useMemo((()=>V.device.isDesktop?t.scales.isDesktop:V.device.isTablet?t.scales.isTablet:V.device.isLandscape?t.scales.phoneLandscape:t.scales.phonePortrait),[V.device.isDesktop,V.device.isTablet,V.device.isLandscape,t.scales]);return $.jsx(pc,{...t,currency:V.settings.currencySymbol,currencyDecimals:V.settings.currencyDecimals,scale:X})})),Oc="effects--28df4",rc="isDesktop--a8e7d",zc="isTablet--5ae0b",wc="isMobile--d2fa5",bc="isLandscape--02131",ac="gameResultElements--81495",uc="hasWin--ce559",jc="alignedTop--e592c",xc="gameResultContainer--374ad",ec="isLargeDevice--710cc",Yc="isPortrait--01bd0",Hc="shiftBottom--027e5",hc="winner--6aa50",Tc="genericPhrase--d0b15",Pc="golden--8dfe8",Qc="message--f7a3d",Jc="noResultLabel--5f200",Uc="amount--47c0e",lc="big--0a4b6",ic="multiplay--4bb1b",Gc="bold--1a72c",dc="winAnimationWrapper--313ed",Mc={[qc.DarkSemicircle]:{themeGameResultElements:"themeGameResultElements--d90ac",messageBackground:"messageBackground--98a5a",themeMessage:"themeMessage--f3b49",winner:"winner--4ac67",genericPhrase:"genericPhrase--8bc03",amount:"amount--ea642",isDesktop:"isDesktop--0942a",isMobile:"isMobile--8e692",isTablet:"isTablet--0a9c8",isLandscape:"isLandscape--2d274",noResultLabel:"noResultLabel--bf155",scales:{isDesktop:4,phonePortrait:2.4,phoneLandscape:2.4,isTablet:2.4}}},Bc={isDesktop:2.5,phonePortrait:1,phoneLandscape:1,isTablet:1},oc=({amount:t,resultLabel:V,isPhone:X,isTablet:K,isPortrait:k,shiftBottomMobile:A,winType:I,isAmountBold:C,theme:n,isBig:R=!1,isMultiplay:F=!1,isLargeDevice:s=!1,animation:S,backgroundColors:c,backgroundOpacity:N="0.9",setConsecutiveWinsCount:m,hideResultLabel:v,winAnimationStarted:W,resultCounterAnimated:Z=!1,alignedTop:D=!1,onCounterAnimationStart:y,onCounterAnimationEnd:E,WinAnimationComponent:_=Ic,Overlays:p=[],Effects:L,WinAmountComponent:O=Lc})=>{var r,z,w,b,a,u,j,x;const e=n?Mc[n]:void 0,Y=pS.useMemo((()=>!!V&&!v),[V,v]),H=pS.useMemo((()=>t>0),[t]);pS.useEffect((()=>{W&&H&&I!==SA.R.None&&W()}),[W,H,I]),pS.useEffect((()=>{Y&&H&&m&&m(I)}),[Y,H,m,I]);const h=pS.useMemo((()=>L&&S&&!v&&$.jsx("div",{className:Oc,children:$.jsx(L,{animation:S})})),[S,L,v]);if(!Y&&!H)return null;const T=QS.A(xc,{[ic]:F,[lc]:R,[null!==(r=null==e?void 0:e.isDesktop)&&void 0!==r?r:rc]:!K&&!X,[null!==(z=null==e?void 0:e.isTablet)&&void 0!==z?z:zc]:K,[null!==(w=null==e?void 0:e.isMobile)&&void 0!==w?w:wc]:X,[null!==(b=null==e?void 0:e.isLandscape)&&void 0!==b?b:bc]:!k,[null!==(a=null==e?void 0:e.noResultLabel)&&void 0!==a?a:Jc]:v,[Yc]:k,[uc]:H,[Jc]:v,[ec]:s&&!R,[Hc]:A});return $.jsxs($.Fragment,{children:[$.jsxs("div",{className:T,children:[$.jsxs("div",{className:QS.A(ac,null==e?void 0:e.themeGameResultElements,{[jc]:D}),children:[Y&&$.jsx("div",{className:null!==(u=null==e?void 0:e.winner)&&void 0!==u?u:hc,style:sc(c,N),children:$.jsx("span",{className:QS.A(null!==(j=null==e?void 0:e.genericPhrase)&&void 0!==j?j:Tc,{[Pc]:!!S}),"data-role":$c.Winner,children:V})}),H&&$.jsxs($.Fragment,{children:[(null==e?void 0:e.messageBackground)&&$.jsx("div",{className:null==e?void 0:e.messageBackground}),$.jsxs("div",{className:QS.A(Qc,null==e?void 0:e.themeMessage),"data-role":$c.Message,children:[$.jsx("div",{"data-role":$c.Text,children:I!==SA.R.None?q.Tl("youWin"):""}),$.jsx("div",{className:QS.A(null!==(x=null==e?void 0:e.amount)&&void 0!==x?x:Uc,{[Gc]:C}),"data-role":$c.Amount,children:$.jsx(O,{amount:t,isAnimated:Z,onCounterAnimationStart:y,onCounterAnimationEnd:E,scales:(null==e?void 0:e.scales)||Bc})})]})]})]}),Fc(p),h]}),F?null:$.jsx("div",{className:QS.A(dc,{[wc]:X,[Yc]:k,[bc]:!k,[ec]:s&&!R,[lc]:R}),children:$.jsx(_,{winType:I})})]})},fc=_S.PA((t=>{const V=I.Pj(),X=V.layout.hideYouWin?void 0:t.WinAnimationComponent,K=V.layout.hideYouWin?void 0:t.Overlays,k=V.layout.hideYouWin?void 0:t.Effects,A=V.layout.hideYouWin?SA.R.Small:V.gameResult.winType;return $.jsx(oc,{...t,Overlays:K,Effects:k,WinAnimationComponent:X,isLargeDevice:V.device.isLargeDevice,amount:V.gameResult.amount,winType:A,resultLabel:V.gameResult.resultLabel,isPhone:V.device.isPhone,isTablet:V.device.isTablet,isPortrait:V.device.isPortrait,hideResultLabel:V.layout.isDesktopClassic,backgroundColors:V.gameResult.color,setConsecutiveWinsCount:oS.Br})})),gc=()=>I.Pj(),tN="gameResultArea--c3b01",VN="isLandscape--5d753",XN="isDesktop--41ce7",KN="isTablet--b1d42",kN="gameResult--6be98",AN="isPortrait--0e5db",$N="noFullScreen--30a20",IN="isPhone--048e0",CN="withCoins--8fc7d",nN=_S.PA((()=>{const{gameResult:t,device:V,ag:X,sounds:K,multipliers:k}=gc(),A=tc.D0(t.winType),I=t.winningBetSpots.some((V=>t.betsAcceptedBetSpots.includes(V))),C=t.winningBetSpots.some((t=>!!k.getBetSpotMultiplier(t))),n=t.amount>0&&C&&I;return $.jsx("div",{className:QS.A(tN,{[VN]:V.isLandscape,[AN]:V.isPortrait,[KN]:V.isTablet,[XN]:V.isDesktop,[IN]:V.isPhone}),children:$.jsx("div",{className:QS.A(kN,{[IN]:V.isPhone,[CN]:A,[KN]:V.isTablet,[XN]:V.isDesktop,[VN]:V.isLandscape,[AN]:V.isPortrait,[$N]:!X.values.isInFullscreen}),children:$.jsx(fc,{isBig:!0,resultCounterAnimated:n,WinAnimationComponent:Ic,onCounterAnimationStart:K.playWinCountUpLoopStart,onCounterAnimationEnd:K.playWinCountUpLoopEnd})})})}));function qN(t=!1){return t?function(){let t=[];const V={...j};return{onMessageFrom3dWorld:V=>(t.push(V),()=>{t=t.filter((t=>t!==V))}),onMessageTo3dWorld:()=>()=>{},sendFrom3dWorld:()=>{},getValueFrom3d:()=>{},getValueTo3d:()=>{},sendTo3dWorld:X=>{X.type in V&&t.forEach((t=>t({type:V[X.type],payload:X.payload})))},dispose:()=>{}}}():ES.d({log:!1})}function RN({params:t,initComponentsMap:V,skip3D:X,gameLayout:K,onGame3DLoaded:k,lobby:A,mockBalanceManager:C,bubbleEnabled:n}){const q=Sn.DS.IS_DESKTOP&&n,R=qN(X),F=function(){const t=function({SkipCutCards:t,GameResult:V}){const X=e.createHTMLMeshTransport(),K=e.createHTMLMeshTransport(),k=e.createHTMLMeshTransport(),A=e.createHTMLMeshTransport(),I=e.createHTMLMeshTransport();return{tooltipTransportEmitters:X.emitters,scoresTransportEmitters:k.emitters,cutCardsSliderTransportEmitters:A.emitters,gameResultTransportEmitters:K.emitters,tableBubbleTransportEmitters:I.emitters,MeshContainers:()=>$.jsxs($.Fragment,{children:[$.jsx(e.TooltipContainer,{...X.observables}),$.jsx(dS,{...k.observables}),$.jsx(BS,{...A.observables,SkipCutComponent:t}),$.jsx(TS,{...I.observables}),$.jsx(PS,{...K.observables,GameResultComponent:V})]})}}({SkipCutCards:xS,GameResult:nN}),V=e.createHTMLMeshTransport();return{...t,multiplierBubbleTransportEmitters:V.emitters,MeshContainers:()=>$.jsxs($.Fragment,{children:[$.jsx(t.MeshContainers,{}),$.jsx(YS,{...V.observables,TombstoneBubble:zS})]})}}(),{setup:s,styles:S,tableConfig:c}=t,N=yS.W0._init(s,S,c,DS.o0())._extend(L);let m=!1;const{getCustomLogEnhancers:v,resolveCustomLogEnhancers:W}=function(){let t;const V=new Promise((V=>{t=V}));return{getCustomLogEnhancers:()=>V,resolveCustomLogEnhancers(V){t(V.log.getCustomEnhancers())}}}(),Z={config:{layout:{initialLayout:K.layoutType,isGoLiveButtonUnderMenu:!1,layouts:{[K.layoutType]:K.layoutConfig},layoutClassicIsHidden:!1},helpNamespace:t.gameType,showOnboardingHintsOptionInSettings:q,chipstack:{disabledComponents:"chips"},soundSettings:{dealerVoice:{enabled:!0}}},settings:N,game:{preferenceConfiguration:b(N,cS),createMiddlewares:()=>[NS.H(k)],getCustomLogEnhancers:v,loader:t,mockBalanceManager:C,preferencesPrefix:w},lobby:A},{store:D,getReactRoot:y,transport:E,chatTransport:_,dispose:p,ag:O}=WS.S(Z,void 0,!0),r=function(t){return new NC(t)}({ag:O,transport:E,settings:N,DS:Sn.DS,bubblesEnabled:q,transport3d:R});O.preferences.initialization.then((()=>{ZS.F().then((t=>{t||D.dispatch(mS.l())}))})),W(r),A&&A.then((t=>{t.onLobbyVisible((()=>r.lobby.setIsVisible(!0))),t.onLobbyClosed((()=>r.lobby.setIsVisible(!1)))}));const z=vS.Y({selectors:{selectInitialGameState:()=>({balance:r.ag.availableBalance,chipAmounts:r.settings.chipAmounts,branding:r.settings.branding,currencySymbol:r.settings.currencySymbol,skipAnimations:r.settings.skipAnimations,gameSpeedModeSettings:r.settings.gameSpeedModeSettings,tiePayout:r.betSpot.tiePayout,selectedChip:r.chips.currentChip,isNetworkSpeedSlow:r.settings.isNetworkSpeedSlow,bettingGridType:r.bettingGrid.gridType,tooltipTransportEmitters:F.tooltipTransportEmitters,scoresTransportEmitters:F.scoresTransportEmitters,cutCardsSliderTransportEmitters:F.cutCardsSliderTransportEmitters,gameResultTransportEmitters:F.gameResultTransportEmitters,tableBubbleTransportEmitters:F.tableBubbleTransportEmitters,multiplierBubbleTransportEmitters:F.multiplierBubbleTransportEmitters,sounds:r.sounds,fee:r.fee,getRef:r.reference.common.get})},factory:SS({transport3d:R,messageSender3d:r.messageSender3d,params:t,checkIsGameDisposed:()=>m}),transport3D:R,skip3D:X}),a=y(r.device.isDesktop?V():V({Overlay3D:z,MeshContainers:F.MeshContainers}));return{layout:I.jU(r,(()=>$.jsx(a,{children:r.device.isDesktop&&$.jsx(z,{children:$.jsx(F.MeshContainers,{})})}))),ag:O,transport:E,chatTransport:_,dispose:async()=>{r.dispose(),R.dispose(),m=!0,await p()}}}var FN=X(119313),sN=X(653677);function SN(t,V){const X=[];for(let K=0;K<t;K++)X.push(V);return X}function cN({icons:t,rows:V,columns:X}){var K;const k=[];for(let $=0;$<X;$++)for(let X=0;X<V;X++)(null===(K=t[$])||void 0===K?void 0:K[X])&&k.push({x:$,y:X,props:{roadType:A.RoadType.Big,...t[$][X]}});return k}const NN=cN({icons:[SN(2,{winnerType:A.WinnerTypeBaccarat.Player,additionalType:A.AdditionalTypeBaccarat.Tie}),[...SN(3,{winnerType:A.WinnerTypeBaccarat.Banker}),...SN(2,{winnerType:A.WinnerTypeBaccarat.Banker,additionalType:A.AdditionalTypeBaccarat.Tie})],SN(1,{winnerType:A.WinnerTypeBaccarat.Player}),SN(10,{winnerType:A.WinnerTypeBaccarat.Banker}),SN(4,{winnerType:A.WinnerTypeBaccarat.Player}),SN(2,{winnerType:A.WinnerTypeBaccarat.Banker}),SN(6,{winnerType:A.WinnerTypeBaccarat.Player}),SN(2,{winnerType:A.WinnerTypeBaccarat.Banker}),SN(3,{winnerType:A.WinnerTypeBaccarat.Player}),SN(5,{winnerType:A.WinnerTypeBaccarat.Banker}),SN(1,{winnerType:A.WinnerTypeBaccarat.Player}),SN(3,{winnerType:A.WinnerTypeBaccarat.Banker})],rows:6,columns:15}),mN=cN({icons:[SN(2,{winnerType:A.WinnerTypeBaccarat.Player,additionalType:A.AdditionalTypeBaccarat.Tie}),SN(3,{winnerType:A.WinnerTypeBaccarat.Banker}),SN(1,{winnerType:A.WinnerTypeBaccarat.Player})],rows:3,columns:3}),vN=[{x:11,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:11,y:1,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:11,y:2,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:10,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:9,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:9,y:1,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:9,y:2,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:9,y:3,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:9,y:4,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:8,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:8,y:1,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:8,y:2,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:7,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:7,y:1,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:7,y:4,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:7,y:5,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:6,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:6,y:1,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:6,y:2,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:6,y:3,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:6,y:4,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:6,y:5,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:5,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:5,y:1,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:5,y:5,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:4,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:4,y:1,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:4,y:2,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:4,y:3,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:4,y:5,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:3,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:3,y:1,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:3,y:2,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:3,y:3,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:3,y:4,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:3,y:5,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:2,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:1,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:1,y:1,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:1,y:2,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:1,y:3,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker,additionalType:6}},{x:1,y:4,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker,additionalType:6}},{x:0,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player,additionalType:6}},{x:0,y:1,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player,additionalType:6}}],WN="container--1f8f1",ZN="isMobile--fc8c9",DN="label--c2fdc",yN=t=>{const{color:V,fill:X,stroke:K,isMobile:k,isLive:I=!1,IconShapeComponent:C}=t,n=k?(t=>({columnCount:3,rowCount:3,strokeWidth:.1,icons:A.mapIconsToRoadItemsBaccarat(mN,t)}))(I):(t=>({columnCount:15,rowCount:6,strokeWidth:.1,icons:A.mapIconsToRoadItemsBaccarat(t?NN:vN,t)}))(I);return $.jsxs("div",{className:QS.A(WN,{[ZN]:k}),children:[$.jsx(A.GridView,{IconShapeComponent:C,...n,icons:n.icons,fill:X,stroke:K}),$.jsx("span",{className:DN,children:V})]})},EN="container--38690",_N="isMobile--9c478",pN="isFlattened--f0f23",LN="selectorHolder--e2807",ON="heading--e73d1",rN={[A.ScorecardThemeNames.WhiteSolid]:({isDesktop:t,isRng:V})=>$.jsx(yN,{fill:A.getScorecardTheme(A.ScorecardThemeNames.WhiteSolid).fill,stroke:A.getScorecardTheme(A.ScorecardThemeNames.WhiteSolid).stroke,color:q.Tl("settings.scorecards.background.classic"),isMobile:!t,isLive:!V}),[A.ScorecardThemeNames.BlackDot]:({isDesktop:t,isRng:V})=>$.jsx(yN,{IconShapeComponent:A.EmptyRoadItem,fill:A.getScorecardTheme(A.ScorecardThemeNames.BlackDot).fill,stroke:A.getScorecardTheme(A.ScorecardThemeNames.BlackDot).stroke,color:q.Tl("settings.scorecards.background.immersive"),isMobile:!t,isLive:!V})},zN=[A.ScorecardThemeNames.WhiteSolid,A.ScorecardThemeNames.BlackDot],wN=({scorecardTheme:t,setScorecardTheme:V,isDesktop:X,isFlattened:K=!1,themes:k=zN,isRng:A})=>{const I=pS.useMemo((()=>function({isDesktop:t,themes:V,isRng:X}){return V.map((V=>({value:V,component:rN[V]({isDesktop:t,isRng:X})})))}({isDesktop:X,themes:k,isRng:A})),[X,A,k]);return $.jsxs("div",{className:QS.A(EN,{[_N]:!X,[pN]:K}),children:[$.jsx(sN.q,{className:QS.A(ON,{[pN]:K}),children:`settings.scorecards.${X?"background":"background_uppercase"}`}),$.jsx("div",{className:LN,children:$.jsx(FN.P,{setValue:V,value:t,options:I,variant:"with-anchor-cell"})})]})},bN=_S.PA((({isFlattened:t,isRng:V=!1})=>{var X;const K=I.Pj(),k=pS.useCallback((t=>{K.preferences.updatePreferenceValue(O.Background,t),K.log.clientPressedSetting(O.Background,t)}),[K]);return $.jsx(wN,{isRng:null!==(X=K.settings.isRng)&&void 0!==X?X:V,setScorecardTheme:k,isDesktop:K.device.isDesktop,scorecardTheme:K.preferences.scorecardTheme,themes:C.LH,isFlattened:t})})),aN=[{component:bN,labelTranslationId:"settings.scorecards",tabId:"SCORECARDS"}],uN="maxPayoutAmount--26b83",jN=pS.memo((({footNotes:t})=>$.jsx("div",{"data-role":"max-payout-amount",className:uN,children:t.map(((t,V)=>{const X=`footnote-${V}`;return $.jsx("div",{children:t},X)}))})));var xN=X(712269),eN=X(204908);class YN extends pS.Component{render(){const{limitRows:t}=this.props;return t.map(((t,V)=>{const X=`${V}`,{isDesktop:K}=this.props;if(function(t){return void 0===t.content&&void 0===t.betKey}(t))return $.jsx(xN.q,{isMobile:!K},X);if(function(t){return void 0!==t.betKey}(t)){const{min:V,max:k,betTitle:A}=t,$=void 0===V&&void 0===k;return pS.createElement(xN.q,{...t,key:X,isIndented:$,betTitle:A,isMobile:!K})}return function(t){return void 0!==t.content}(t)?$.jsx(eN.z,{isMobile:!K,children:t.content},X):null}))}}const HN=_S.PA((()=>{const t=wS.P(),{betLimitsRows:V,footnotes:X}=t.limits,{isDesktop:K}=t.device,k=pS.useMemo((()=>{return{content:(t=X,$.jsx(jN,{footNotes:t})),isMobile:!K};var t}),[K,X]);return $.jsx(YN,{limitRows:[...V,k],isDesktop:K})})),hN=pS.memo((()=>$.jsx("tbody",{children:$.jsx(HN,{})})));var TN=X(710928),PN=X(430264);const QN=_S.PA((t=>{const V=wS.P(),X=V.betProcessor.repeat,K=V.deal.isDealAllowed,k=V.deal.isDealHotKeyEnabled,A=V.betProcessor.isRepeatEnabled.enabled,I=!V.device.isDesktop,C=V.device.isPortrait,n=V.device.isLowPerformanceDevice,q=V.deal.isButtonHidden,R=V.device.isTablet,F=V.gamePhase.isBetsOpen,s=V.deal.tooltipTranslationKey,S=pS.useCallback((()=>{V.deal.setDeal(!0)}),[V.deal]);return $.jsx(PN.O,{...t,onRepeat:X,isDealAllowed:K,isDealHotKeyEnabled:k,isRepeatAllowed:A,isMobile:I,isPortrait:C,isLowPerformanceDevice:n,isHidden:q,isTablet:R,isTooltipAllowed:F,tooltipKey:s,onDeal:S,tooltipPositionHorizontal:TN.hV.Center})}));var JN;(function(t){t["Banker"]="banker_reductions",t["Player"]="player_reductions",t["Tie"]="tie_reductions",t["PerfectPair"]="perfect_pair_reductions",t["EitherPair"]="either_pair_reductions",t["PlayerBonus"]="player_bonus_reductions",t["PlayerPair"]="player_pair_reductions",t["BankerBonus"]="banker_bonus_reductions",t["BankerPair"]="banker_pair_reductions",t["SuperSix"]="super_six_reductions"})(JN||(JN={}));const UN=[JN.Banker,JN.Player,JN.Tie,JN.PerfectPair,JN.EitherPair,JN.PlayerBonus,JN.PlayerPair,JN.BankerBonus,JN.BankerPair,JN.SuperSix],lN=[JN.Banker,JN.Player,JN.Tie,JN.SuperSix];function iN(t,V,X){const K=function(t,V="commission",X=UN){return("true"===t.rawConfig.main_bets_only?X.filter((t=>lN.includes(t))):X).reduce(((X,K)=>{const k=V?[V,K].join("."):K,A=t.rawConfig[k];return A&&(X[K]=A.split(";").reduce(((t,V)=>{const[X,K]=V.split(":");return t[Number(X)]=100*Number(K),t}),{})),X}),{})}(t,V),k=Object.keys(K);return{reductions:K,notes:UN.filter((t=>k.includes(t)&&X.includes(t)))}}var GN=X(528981),dN=X(99210);const MN=async(t,V,{customConfig:K,currencyCode:k,currencySymbol:A,customizableButton:I,gameTheme:C})=>{const{GameRulesChapter:n,GameObjectiveChapter:R,PayoutsChapter:F,ReturnToPlayerChapter:s,ScorecardsChapter:S}=await X.e(97471).then(X.bind(X,417837)),{SideBetsChapter:c}=await X.e(97471).then(X.bind(X,893438)),{PlaceBetsChapter:N}=await X.e(97471).then(X.bind(X,338537)),{DepositAndWithdrawChapter:m,DisconnectionPolicyChapter:v,GameHistoryChapter:W,MoreGamesChapter:Z,ResponsibleGamingChapter:D,SoundChapter:y,SettingsChapter:E}=await X.e(50967).then(X.bind(X,321502));if(!K)throw new Error("Please provide all necessary props for customConfig");const{minLimit:_,maxLimit:p,freeHandLimit:L,scorecardTheme:O,coefficientReductionsConfig:r,isNoMaxPayoutLimitInfo:z=!1,isRtpProbabilityV2:w,volatility:b}=K,a=V.useRedesignedDrawerHelp(),u=Math.max(0,V.payoutLimit()),j=HX.ej(u,{currencySymbol:A}),x=t===zt.OD.Desktop,e={id:"GameObjective",title:q.Tl("help.gameObjective.title"),content:$.jsx(R,{})},Y={id:"GameRules",title:q.Tl("help.gameRules.title"),content:$.jsx(n,{freeHandLimit:L,scorecardTheme:O,isHelpRedesigned:a,currencyCode:k,currencySymbol:A})},H={id:"Payouts",title:q.Tl("help.payouts.title"),content:$.jsx(F,{isHelpRedesigned:!x&&a,payoutLimit:j,isNoMaxPayoutLimitInfo:z})},h={id:"Sidebets",title:q.Tl("help.sideBets.title"),content:$.jsx(c,{perfectPairEnabled:!1,eitherPairEnabled:!1,superSixEnabled:!1,playerBankerBonusEnabled:!1,playerBankerPairEnabled:!0,coefficientReductionsConfig:r,isHelpRedesigned:a})},T={id:"ReturnToPlayer",title:q.Tl("help.returnToPlayer.title"),content:$.jsx(s,{isHelpRedesigned:a,payoutLimit:j,probabilityPrizeForTie:w?"help.returnToPlayer.probabilityPrizeForTieV2":"help.returnToPlayer.probabilityPrizeForTie.new",volatility:b})},{reductions:P,notes:Q}=iN(V,"no_commission",[JN.SuperSix]),J={id:"PlaceBets",title:q.Tl("help.placeBets.title"),content:$.jsx(N,{platform:t,settings:V,minLimit:_,maxLimit:p,dynamicLimits:P,dynamicLimitsNotes:Q,dynamicOrder:UN,currencySymbol:A})},U={id:"ScoreCards",title:q.Tl("help.scorecards.title"),content:$.jsx(S,{scorecardTheme:O,platform:t})},l={id:GN.t.DisconnectionPolicy,title:q.Tl("help.disconnectionPolicy.title"),content:$.jsx(v,{translationKey:"help.disconnectionPolicy.rng"})},i=V.hasRngLobby(),G={id:GN.t.MoreGames,title:q.Tl("help.moreGames.title"),content:$.jsx(Z,{platform:t,goLiveButtonEnabled:!0,gameTranslationKey:`help.gameSubTypeNames.live_${r$.l}`,showLobbyButton:i,isRng:!0,gameTheme:C,isHelpRedesigned:a})},d={id:GN.t.Sound,title:q.Tl("help.sound.title"),content:$.jsx(y,{buttonType:"secondaryGold",isRngGame:!0,isHelpRedesigned:a})},M={id:GN.t.GameHistory,title:q.Tl("help.gameHistory.title"),content:$.jsx(W,{platform:t,customizableButton:I,isHelpRedesigned:a})},B={id:GN.t.DepositAndWithdraw,title:q.Tl("help.depositWithdraw.title"),content:$.jsx(m,{platform:t,buttonType:"secondaryGold",currencyCode:k,isHelpRedesigned:a})},o={id:GN.t.ResponsibleGaming,title:q.Tl("help.responsibleGaming.title"),content:$.jsx(D,{platform:t,isUKGC:V.isUKGC(),buttonType:"secondaryGold"})},f={id:GN.t.Settings,title:q.Tl("help.settings.title"),content:$.jsx(E,{platform:t,buttonType:I.all?"customizable":"secondaryGold",isHelpRedesigned:!0})},g=[e,Y,H,T,J,GN.t.LiveSupport,U,d,M,f,B,o,GN.t.InformazioniAams,l,G,GN.t.Home,GN.t.ShortcutKeys];return g.splice(2,0,h),g},BN=async({settings:t,customConfig:V,currencySymbol:K,currencyCode:k})=>{const{GameRulesChapter:A,GameObjectiveChapter:I,PayoutsChapter:C,ReturnToPlayerChapter:n,ScorecardsChapter:R}=await X.e(97471).then(X.bind(X,417837)),{SideBetsChapter:F}=await X.e(97471).then(X.bind(X,893438)),{PlaceBetsChapter:s}=await X.e(97471).then(X.bind(X,338537));if(!V)throw new Error("Please provide all necessary props for customConfig");const{minLimit:S,maxLimit:c,freeHandLimit:N,scorecardTheme:m,coefficientReductionsConfig:v,isNoMaxPayoutLimitInfo:W=!1,isRtpProbabilityV2:Z,volatility:D}=V,y=t.useRedesignedDrawerHelp(),E=Math.max(0,t.payoutLimit()),_=HX.ej(E,{currencySymbol:K}),p=t.DeviceSupport.PLATFORM,{reductions:L,notes:O}=iN(t,"no_commission",[JN.SuperSix]);return{overrideDefaultChapters:{[dN.C.DisconnectionPolicy]:{chapterProps:{translationKey:"help.disconnectionPolicy.rng"}}},customChapters:{gameDetails:[{chapters:[{id:"GameObjective",title:q.Tl("help.gameObjective.title"),content:$.jsx(I,{})},{id:"GameRules",title:q.Tl("help.gameRules.title"),content:$.jsx(A,{freeHandLimit:N,scorecardTheme:m,isHelpRedesigned:y,currencyCode:k,currencySymbol:K})},{id:"Sidebets",title:q.Tl("help.sideBets.title"),content:$.jsx(F,{perfectPairEnabled:!1,eitherPairEnabled:!1,superSixEnabled:!1,playerBankerBonusEnabled:!1,playerBankerPairEnabled:!0,coefficientReductionsConfig:v,isHelpRedesigned:y})},{id:"PlaceBets",title:q.Tl("help.placeBets.title"),content:$.jsx(s,{platform:p,settings:t,minLimit:S,maxLimit:c,dynamicLimits:L,dynamicLimitsNotes:O,dynamicOrder:UN,currencySymbol:K})},{id:"Payouts",title:q.Tl("help.payouts.title"),content:$.jsx(C,{isHelpRedesigned:y,payoutLimit:_,isNoMaxPayoutLimitInfo:W})},{id:"ReturnToPlayer",title:q.Tl("help.returnToPlayer.title"),content:$.jsx(n,{isHelpRedesigned:y,payoutLimit:_,probabilityPrizeForTie:Z?"help.returnToPlayer.probabilityPrizeForTieV2":"help.returnToPlayer.probabilityPrizeForTie.new",volatility:D})},{id:"ScoreCards",title:q.Tl("help.scorecards.title"),content:$.jsx(R,{scorecardTheme:m,platform:p})}]}]},commonProps:{isRng:!0,buttonType:"secondaryGold"},filterMap:{overrideDefault:{[dN.C.SpeedMode]:!1},custom:{Sidebets:!0}}}};var oN=X(872061);const fN="freeHandButtonsContainer--42b2f",gN="phone--16d2f",tm="roundedCorners--564bb",Vm="portrait--27602",Xm="tablet--b41d9",Km="actionButton--8ff60",km="desktop--1234d",Am="overRoads--b5459",$m=_S.PA((({ClearTableButton:t,PlayFreeGameButton:V})=>{const{device:{isPortrait:X,isTablet:K,isPhone:k,isDesktop:A,DS:I}}=wS.P(),{HAS_ROUNDED_CORNERS:C}=I,n=K||A?TN.Ne.Bottom:TN.Ne.Top;return $.jsxs("div",{className:QS.A(fN,{[Am]:X,[Xm]:K,[gN]:k,[Vm]:X,[tm]:C}),children:[$.jsx("div",{className:QS.A(Km,{[Xm]:K,[gN]:k,[Vm]:X,[km]:A}),children:$.jsx(t,{tooltipPositionVertical:n})}),$.jsx("div",{className:QS.A(Km,{[Xm]:K,[gN]:k,[Vm]:X,[km]:A}),children:$.jsx(V,{tooltipPositionVertical:n})})]})}));var Im=X(952618);const Cm=_S.PA((()=>{const t=rS(),{animation:V,gamePhase:X,device:K}=t,k=!V.isShuffleCardsActive&&X.isBetsOpen,A=pS.useCallback((()=>{Y$(t)}),[t]);return $.jsx(Im.M,{tooltipPositionVertical:TN.Ne.Bottom,clearTable:A,buttonsEnabled:k,isPortrait:K.isPortrait,isPhone:K.isPhone,isDesktop:K.isDesktop})}));var nm=X(381450);const qm={ClearTableButton:Cm,PlayFreeGameButton:_S.PA((()=>{const t=rS(),{animation:V,gamePhase:X,device:K,sounds:k}=t,A=!V.isShuffleCardsActive&&X.isBetsOpen,I=pS.useCallback((()=>{t.log.freeGamePressed(),k.playClickButtonSound(),function(t){t.ag.balanceTotalBet>0&&t.betProcessor.undoAll(),t.gamePhase.setPhase(iV.Qc.BetsClosed),t.messageSender.playFreeGame({tableId:t.settings.tableId,virtualTableId:t.settings.virtualTableId,shoeName:t.table.table.shoeId})}(t)}),[t,k]);return $.jsx(nm.X,{tooltipPositionVertical:TN.Ne.Bottom,playFreeGame:I,buttonsEnabled:A,isPortrait:K.isPortrait,isPhone:K.isPhone,isDesktop:K.isDesktop})}))},Rm=()=>$.jsx($m,{...qm});var Fm=X(71665),sm=X(261504);const Sm=_S.PA((({tooltipPositionVertical:t})=>{const{device:{isPhone:V,isTablet:X,isLandscape:K,isDesktop:k},shoe:A}=wS.P(),I=Fm.mW(A.stats,A.beadRoadMode,k,!1);return $.jsx(sm.u,{largeIcons:!0,isPhone:V,isTablet:X,isLandscape:K,showTooltips:k,statistics:I,tooltipPositionVertical:t,roadPredictionTheme:sm.H.FaceLiftBright,isDesktop:k})}));var cm=X(118812);const Nm=_S.PA((({tooltip:t,tooltipPositionVertical:V,tooltipPositionHorizontal:X,winnerType:K})=>{const k=I.Pj(),C=Fm.Ot(k.shoe.beadRoadMode,K)||K.charAt(0),n=pS.useCallback((t=>{t?(k.prediction.setPrediction(t),k.log.clientPrediction(t)):k.prediction.resetPrediction()}),[k.log,k.prediction]);return $.jsx(cm.P,{winnerType:K,probe:k.shoe.roads.probes[K],withTooltip:!!t,tooltip:t,tooltipPositionVertical:V,tooltipPositionHorizontal:X,isDesktop:k.device.isDesktop,isTablet:k.device.isTablet,scorecardTheme:k.preferences.scorecardTheme,mapColorToWinnerType:A.getWinnerTypeBaccarat,RoadItem:A.RoadItemBaccarat,symbol:C,roadPredictionTheme:sm.H.FaceLiftBright,probesWinner:k.prediction.winner,ignoreButtonSpacing:k.settings.isRng,wideButton:k.settings.isRng,setProbesWinner:n,onInteraction:k.sounds.playClickButtonSound})}));function mm({tooltip:t,tooltipPositionVertical:V,tooltipPositionHorizontal:X}){const K=A.WinnerTypeBaccarat.Banker;return $.jsx(Nm,{winnerType:K,tooltip:t,tooltipPositionVertical:V,tooltipPositionHorizontal:X})}function vm({tooltip:t,tooltipPositionVertical:V,tooltipPositionHorizontal:X}){const K=A.WinnerTypeBaccarat.Player;return $.jsx(Nm,{winnerType:K,tooltip:t,tooltipPositionVertical:V,tooltipPositionHorizontal:X})}const Wm={left:0,top:0,width:0,height:0,x:0,y:0};var Zm=X(15621);const Dm=new Map([[R.I.Chinese,"chinese"],[R.I.Normal,"normal"],[R.I.Korean,"korean"],[R.I.Number,"number"]]),ym="beadRoad--9fce3";function Em(t){switch(t){case FA.DesktopImmersive:return 26;case FA.DesktopClassic:return 21;case FA.TabletLive:case FA.PhoneLandscapeLive:return 10;case FA.PhonePortraitLive:return 26;case FA.ExtraLargeLandscape:return 15;case FA.LargeLandscape:return 10;case FA.SmallLandscape:return 8;case FA.PhonePortrait:return 5;default:Zm.xb(t)}}function _m(t){return{columnCount:Em(t),rowCount:6}}function pm(t,V){return V[(V.indexOf(t)+1)%V.length]}const Lm=pS.memo((({withTooltip:t,displayMode:V,gridIcons:X,scorecardTheme:K,mode:k,modes:I,onModeChanged:C,hideTooltip:n,showTooltip:q,skipFirstLastLines:R,columnsCount:F,scorecardThemesOverrides:s,IconShapeComponent:S})=>{const c=()=>{n&&n()},{rowCount:N}=_m(V),m={rowCount:N,columnCount:F,scorecardTheme:K,gridIcons:X,isInterlacedMode:!1,IconShapeComponent:S,skipFirstLastLines:R,defaultIconId:"bead-road",scorecardThemesOverrides:s},v={onClick:V=>{V.preventDefault();const X=pm(k,I);C({mode:X}),t&&c()}};return t&&(v.onMouseEnter=t=>{if(q){const V=pm(k,I);q(`tooltip.beadRoad.${Dm.get(V)}`,function(t,V=1){if(t){const X=t.getBoundingClientRect();return{left:X.left/V,top:X.top/V,width:X.width/V,height:X.height/V,x:X.x/V,y:X.y/V}}return Wm}(t.currentTarget))}},v.onMouseLeave=c),$.jsx("svg",{...v,"data-role":`${A.RoadType.Bead}-road`,"data-mode":k,viewBox:`0 0 ${F} ${N}`,className:ym,children:$.jsx(A.RoadMemo,{...m,...v})})}),i$.A);var Om=X(819101);const rm=_S.PA((({columnsCount:t,isLive:V=!0,showTooltip:X,hideTooltip:K})=>{const k=I.Pj(),C=k.layout.beadRoadDisplayMode,n=k.device.isDesktop,q=k.shoe.beadRoadMode,R=_m(C),F=t||R.columnCount,s=n?2:1,S=Om.K0(F-s,R.rowCount,k.shoe.history,q,C===FA.PhonePortrait,k.prediction.winner),c=A.mapIconsToRoadItemsBaccarat(S,V,void 0,k.shoe.resolveMultiplierTheme),N=k.preferences.isWhiteScorecardTheme?A.ScorecardThemeNames.WhiteSolid:A.ScorecardThemeNames.BlackDot,m=pS.useCallback((t=>{k.shoe.setBeadRoadMode(t.mode),k.sounds.playClickButtonSound(),k.log.clientBeadRoad(t.mode)}),[k.log,k.shoe,k.sounds]);return $.jsx(Lm,{columnsCount:F,displayMode:C,mode:q,modes:k.shoe.availableBeadRoadModes,gridIcons:c,IconShapeComponent:A.EmptyRoadItem,scorecardTheme:N,onModeChanged:m,showTooltip:X,hideTooltip:K,withTooltip:k.device.isDesktop})})),zm=_S.PA((({type:t,scorecardTheme:V,emptyIconShape:X,extraShapes:K,probeExtraShapes:k,rowCount:C,columnCount:n,isInterlacedMode:q,isLive:R})=>{const F=I.Pj(),s=F.shoe.getRoadItems(t);return $.jsx(A.RoadBaccarat,{type:t,scorecardTheme:V||F.preferences.scorecardTheme,roadItems:K?s.map((t=>({...t,extraShapes:t.extraShapes?[...t.extraShapes,...K]:K}))):s,probes:F.shoe.roads.probes,probesWinnerType:F.prediction.winner,isLive:R,emptyIconShape:X,probeExtraShapes:k,rowCount:C,columnCount:n,isInterlacedMode:q,multiplierThemeResolver:F.shoe.resolveMultiplierTheme})})),wm=400;function bm(t){return function({containerWidth:t,containerHeight:V,containerPadding:X=0,spaceBetweenBigDerivatives:K=0},k=Math.ceil){const $=9+K,I=6,C=I+K,n=3,q=3*k(t/V*($+X)/3),R=q/3,F=q-2*R;return{container:{width:q,height:$},roads:{[A.RoadType.Big]:{x:0,y:0,width:q,height:I,interlaced:!1},[A.RoadType.BigEye]:{x:0,y:C,width:R,height:n,interlaced:!0},[A.RoadType.Small]:{x:R,y:C,width:F,height:n,interlaced:!0},[A.RoadType.Cockroach]:{x:R+F,y:C,width:R,height:n,interlaced:!0},[A.RoadType.Bead]:{x:0,y:0,width:0,height:0,interlaced:!0}}}}(t)}var am;function um(t,V){return hn.A(Object.keys(V).map((X=>{const K=t.roads[X];return Ym(K,xm(K,t.container,V[X]),X)})))}(function(t){t["Idle"]="Idle",t["ZoomingIn"]="ZoomingIn",t["ZoomingOut"]="ZoomingOut",t["Zoomed"]="Zoomed"})(am||(am={}));const jm=.8;function xm(t,V,X){const K=V.height/t.height*t.width,k=K*(Number.isNaN(X)?0:X)/100;let A=0;if(K<V.width)A=(V.width-K)/2;else if(k>V.width*jm){const X=K/t.width,$=Math.ceil((V.width*jm-k)/X)*X;A=Math.max(V.width-K,$)}return{x:A,y:0,height:V.height,width:K,interlaced:t.interlaced}}const em=["x","y","width","height"];function Ym(t,V,X,K){return em.filter((X=>t[X]!==V[X])).map((k=>({from:t[k],to:V[k],attr:k,disabled:!!K,target:X,key:X+k+String(t[k]>V[k])}))).filter((({to:t,from:V})=>!Number.isNaN(t)&&!Number.isNaN(V)))}function Hm(t,V,X={}){var K;const k=(null!==(K=Number(X.strokeWidth))&&void 0!==K?K:0)/2;switch(t){case A.RoadType.Big:return $.jsx("line",{x1:0,y1:V.height,x2:V.width,y2:V.height,...X},`${t}-bottom`);case A.RoadType.BigEye:return $.jsxs($.Fragment,{children:[$.jsx("line",{x1:V.x,y1:V.y,x2:V.width,y2:V.y,...X},`${t}-top`),$.jsx("line",{x1:V.width,y1:V.y,x2:V.width,y2:V.y+V.height,...X},`${t}-right`)]});case A.RoadType.Small:return $.jsxs($.Fragment,{children:[$.jsx("line",{x1:V.x,y1:V.y,x2:V.x+V.width,y2:V.y,...X},`${t}-top`),$.jsx("line",{x1:V.x,y1:V.y+k,x2:V.x,y2:V.y+V.height,...X},`${t}-left`),$.jsx("line",{x1:V.x+V.width,y1:V.y+k,x2:V.x+V.width,y2:V.y+V.height,...X},`${t}-right`)]});case A.RoadType.Cockroach:return $.jsxs($.Fragment,{children:[$.jsx("line",{x1:V.x,y1:V.y,x2:V.x+V.width,y2:V.y,...X},`${t}-top`),$.jsx("line",{x1:V.x,y1:V.y+k,x2:V.x,y2:V.y+V.height,...X},`${t}-left`)]})}return null}function hm(t=[],V,X){const K=[...t].sort(((t,V)=>V.col-t.col)),k=K.length?K[0].col:0,A=X?2*V:V;let $=0;return k>A?$=100:($=Math.ceil(k/A*100),$=Number.isNaN($)?0:$),$}const Tm=pS.memo((function({roads:t,roadsProgress:V,showTooltip:X,hideTooltip:K,layout:k,onFocusedRoadChange:A,isStatic:I=!1,uniqId:C,zoomRoadOverflow:n=!1,framesAroundRoadsStyles:q,RoadContainer:R,onClick:F}){const[s,S]=pS.useState(void 0),[c,N]=pS.useState(t),m=pS.useRef(null!=C?C:String(Math.random())),[v,W,Z]=function(t,V,X){const[K,k]=pS.useState(um(V,X)),[A,$]=pS.useState(V.roads),[I,C]=function(t){const[V,X]=pS.useState(void 0),[K,k]=pS.useState(am.Idle);return pS.useEffect((()=>{K===am.Idle&&t?(X(t),k(am.ZoomingIn),setTimeout((()=>k(am.Zoomed)),wm)):K!==am.Zoomed||t||(k(am.ZoomingOut),setTimeout((()=>{k(am.Idle),X(void 0)}),wm))}),[K,t]),[V,K]}(t);return pS.useEffect((()=>{if(C===am.ZoomingIn){const t=V.roads[I],K=xm(t,V.container,X[I]);k(Ym(t,K,I,!0))}else if(C===am.Zoomed){const t=V.roads[I],K=xm(t,V.container,X[I]),A={...V.roads,[I]:K};k(Ym(K,t,I)),$(A)}else if(C===am.ZoomingOut){const t=V.roads[I],K=xm(t,V.container,X[I]);k(Ym(K,t,I,!0))}else C===am.Idle&&($(V.roads),k(um(V,X)))}),[I,V,C,X]),[A,K,C===am.Idle||C===am.Zoomed]}(s,k,V),D=pS.useCallback((t=>()=>{if(null==F||F(),Z){N((V=>[...V.filter((V=>V!==t)),t]));const V=s?void 0:t;S(V),A&&A(V),null==K||K()}}),[K,A,s,Z,F]),y=pS.useCallback((t=>V=>{if(X){const K=s===t?"tooltip.clickToMinimize":"tooltip.clickToEnlarge",k=V.currentTarget.getBoundingClientRect();X(K,k)}}),[X,s]);return $.jsxs("svg",{viewBox:`0 0 ${k.container.width} ${k.container.height}`,xmlns:"http://www.w3.org/2000/svg",children:[c.map((t=>{const V=n&&s&&s!==t,X=q&&s!==t;return $.jsxs("g",{children:[$.jsx(R,{x:v[t].x,y:v[t].y,onMouseEnter:I?void 0:y(t),onMouseLeave:I?void 0:K,onClick:I?void 0:D(t),id:`${t}-${m.current}`,width:v[t].width,height:v[t].height,hidden:V,layout:k,roadType:t,focusedRoad:s},`${t}`),X&&Hm(t,v[t],q)]},t)})),!I&&W.map((({target:t,attr:V,from:X,to:K,disabled:k,key:A})=>$.jsx("animate",{xlinkHref:`#${t}-${m.current}`,from:X,to:K,attributeName:V,dur:`${wm}ms`,begin:k?"indefinite":"click",fill:"freeze"},A)))]})}),i$.A),Pm=_S.PA((({roads:t,roadsData:V,zoomRoadOverflow:X,gridLayout:K,showTooltip:k,hideTooltip:C,RoadContainer:n,framesAroundRoadsStyles:q,onFocusedRoadChange:R})=>{const F=I.Pj(),s=Object.keys(K.roads).reduce(((t,X)=>Object.assign(t,{[X]:hm(V[X],K.roads[X].width,K.roads[X].interlaced)})),{}),S=pS.useCallback((t=>{const V=function(t){switch(t){case A.RoadType.Big:return gK.Big;case A.RoadType.Small:return gK.SmallEye;case A.RoadType.Cockroach:return gK.Cockroach;case A.RoadType.BigEye:return gK.BigEye;default:return}}(t),X=t?tk.Enlarged:tk.Original;null==R||R(t),F.log.clientFourRoad(X,V)}),[R,F.log]),c=pS.useCallback((()=>{F.sounds.playClickButtonSound()}),[F.sounds]);return $.jsx(Tm,{roads:t,layout:K,roadsProgress:s,isStatic:!1,onFocusedRoadChange:S,zoomRoadOverflow:X,showTooltip:k,hideTooltip:C,RoadContainer:n,onClick:c,framesAroundRoadsStyles:q})})),Qm="gridCreator--5315b",Jm="roadGrid--63c12",Um="notFocused--ed94c",lm="focused--02d03";function im(t){switch(t){case A.RoadType.Big:return A.RoadType.Big;case A.RoadType.BigEye:return A.RoadType.BigEye;case A.RoadType.Small:return A.RoadType.Small;case A.RoadType.Cockroach:return A.RoadType.Cockroach}}function Gm({id:t,onMouseEnter:V,onMouseLeave:X,onClick:K,x:k,y:A=0,width:I,height:C,hidden:n,roadType:q,layout:R,focusedRoad:F}){const s=R.roads[q],[S,c]=pS.useState(!1),N=pS.useCallback((t=>{c(!0),null==V||V(t)}),[V]),m=pS.useCallback((t=>{c(!1),null==X||X(t)}),[X]);return $.jsx("svg",{className:QS.A({[lm]:F&&F===q&&S,[Um]:F&&F!==q&&S}),onMouseEnter:N,onMouseLeave:m,onClick:K,id:t,x:k,y:A,width:I,height:C,"data-role":`${q}-road`,style:n?{opacity:0}:void 0,children:$.jsx(zm,{type:im(q),columnCount:s.width,rowCount:s.height,isInterlacedMode:s.interlaced,defaultIconId:q,isLive:!1})})}const dm=[A.RoadType.Big,A.RoadType.BigEye,A.RoadType.Small,A.RoadType.Cockroach],Mm=_S.PA((({roadContainerLayout:t,zoomRoadOverflow:V,beadRight:X,beadColumns:K,isVerticalBead:k,wrapperPadding:I,spaceBetweenBlocks:C})=>{const n=wS.P(),q=pS.useCallback(((t,V)=>{n.device.isDesktop&&n.tooltip.showRoadGridTooltip(t,V)}),[n.device.isDesktop,n.tooltip]),R=pS.useCallback((()=>{n.device.isDesktop&&n.tooltip.hideRoadGridTooltip()}),[n.device.isDesktop,n.tooltip]),F=pS.useCallback(((t,V)=>{n.device.isDesktop&&n.tooltip.showBeadRoadTooltip(t,V)}),[n.device.isDesktop,n.tooltip]),s=pS.useCallback((()=>{n.device.isDesktop&&n.tooltip.hideBeadRoadTooltip()}),[n.device.isDesktop,n.tooltip]),{roads:S,container:c}=t,N=2*I,m=c.height+N,v=m*S[A.RoadType.Bead].width/c.width,W=k?S[A.RoadType.Bead].height+v+C:m,Z=0!==S[A.RoadType.Bead].width&&0!==S[A.RoadType.Bead].height,D=k?c.width:c.width+N,y=S[A.RoadType.Bead].width+N,E=k?S[A.RoadType.Bead].width:D+y+C;return $.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${E} ${W}`,className:Qm,children:[I?k?$.jsx(fm,{width:E,height:W,radius:I}):$.jsxs($.Fragment,{children:[$.jsx(fm,{x:X?0:y+C,width:D,height:W,radius:I}),$.jsx(fm,{x:X?D+C:0,width:y,height:W,radius:I})]}):null,Z&&$.jsx("svg",{x:X?D+C+I:I,y:I,width:k?S[A.RoadType.Bead].width-N:S[A.RoadType.Bead].width,height:S[A.RoadType.Bead].height,children:$.jsx(rm,{isLive:!1,columnsCount:K,showTooltip:F,hideTooltip:s})}),$.jsx("svg",{x:k||X?I:y+C+I,y:k?S[A.RoadType.Bead].height+C:0,width:k?E-N:c.width,height:k?v:void 0,children:$.jsx(Pm,{roads:dm,roadsData:n.shoe.roads,zoomRoadOverflow:V,gridLayout:t,showTooltip:q,hideTooltip:R,RoadContainer:Gm})})]})})),Bm=pS.memo(Mm,i$.A),om=_S.PA((()=>{const t=wS.P(),V=pS.useRef(null),[X,K]=pS.useState(void 0),k=t.layout.beadRoadDisplayMode,{columnCount:I,rowCount:C}=_m(k),[n,q]=pS.useState(void 0),R=t.shoe.history.length,F=t.preferences.scorecardTheme,s=t.preferences.isWhiteScorecardTheme,S=F===A.ScorecardThemeNames.BlackDot?.5:0,c=k===FA.PhonePortrait,N=pS.useRef(I),{height:m,width:v}=$R.O(),W=t.layout.roadsDisplayMode,Z=sA.TwoLinesPortrait===W||k===FA.PhonePortrait;return pS.useEffect((()=>{if(q("100%"),null!==V.current){if(0===V.current.clientWidth||0===V.current.clientHeight)return;const t=V.current.clientHeight/6;if(c)N.current=Math.ceil(V.current.clientWidth/1.55/t);else{const X=.2*V.current.clientWidth;N.current=Math.ceil(X/t)}K(function({containerWidth:t,containerHeight:V,beadColumns:X,beadRows:K,directionRow:k,containerPadding:$=0,spaceBetweenBlocks:I=0,spaceBetweenBigDerivatives:C=0}){const n=9+(k?C:0);if(k){const k=n*X/K,I=bm({containerWidth:t-V*k/n,containerHeight:V,containerPadding:$,spaceBetweenBigDerivatives:C});return I.roads[A.RoadType.Bead].width=k,I.roads[A.RoadType.Bead].height=n,I}const q=X*n/K,R=V-t/X*K,F=bm({containerWidth:t,containerHeight:R-V/(n+n*q/(3*Math.ceil(t/R*n/3))+I)*I,containerPadding:$,spaceBetweenBigDerivatives:C});return F.roads[A.RoadType.Bead].width=q,F.roads[A.RoadType.Bead].height=n,F}({containerWidth:V.current.clientWidth,containerHeight:V.current.clientHeight,beadColumns:N.current,beadRows:C,directionRow:!0,spaceBetweenBigDerivatives:S}))}}),[m,v,I,C,R,c,n,S]),$.jsx("div",{ref:V,className:Jm,style:{height:n},children:X&&$.jsx(Bm,{roadContainerLayout:X,zoomRoadOverflow:!s,beadRight:Z,beadColumns:N.current,isVerticalBead:!1,wrapperPadding:0,spaceBetweenBlocks:0})})})),fm=({x:t=0,y:V=0,width:X,height:K,radius:k,fill:A="#fff"})=>$.jsx("rect",{width:X,height:K,rx:k,fill:A,x:t,y:V}),gm="roadsLayout--7944c",tv="landscape--c0cec",Vv="reverse--dd727",Xv="top--bce0e",Kv="offsetBottom--9a87f",kv="left--470e6",Av="right--4392f",$v="bottom--8159d",Iv="withoutBackground--ee224",Cv="middleStatistic--ccb93",nv="roundedCorners--bab98",qv="middleStatisticPhone--ca0a4",Rv="withSpacing--46ad0",Fv=_S.PA((t=>{const{statistics:V,prediction:X,roads:K,isLandscape:k,shouldAddOffsetForLandscape:A}=t,{device:{isPhone:I,DS:C}}=wS.P(),{HAS_ROUNDED_CORNERS:n}=C;return k?$.jsxs("div",{className:QS.A(gm,tv,{[Vv]:!I}),children:[$.jsx("div",{className:QS.A(Xv,tv,{[Kv]:A}),children:$.jsx("div",{className:QS.A(kv),children:K})}),$.jsxs("div",{className:QS.A(Xv,{[Rv]:!I}),children:[V&&$.jsx("div",{className:QS.A(kv,Cv,{[qv]:I,[nv]:n}),children:V}),$.jsx("div",{className:Av,children:X})]})]}):$.jsxs("div",{className:QS.A(gm,Iv),children:[$.jsxs("div",{className:QS.A(Xv,Rv),children:[V&&$.jsx("div",{className:kv,children:V}),$.jsx("div",{className:Av,children:X})]}),$.jsx("div",{className:$v,children:K})]})}));var sv=X(25581);const Sv="roadStatistic--01c0f",cv="predictions--9b916",Nv="desktop--1b711",mv="tablet--666a2",vv="phone--7ae93",Wv="statistic--6a75a",Zv="small--2701f",Dv="large--7dc6b",yv="predictionButton--050fc",Ev="roundedButtonCorners--307fb",_v="alignRight--025e8",pv="roadsContainer--aa721",Lv="roads--15ad6",Ov="thinRoads--03423",rv="fourRoads--7229f",zv="borderWrapper--426dc",wv="borderWrapperDark--c5bfe",bv="rightShadow--e55bc",av="leftShadow--47eb7",uv="roundedCorners--acf24",jv="withScroll--9d8ee",xv=_S.PA((({scaledWidth:t,GameStatistics:V,PlayerPredictionButton:X,BankerPredictionButton:K,FourRoads:k,FreeHandButtons:I,roadThemeName:C,thinRoads:n})=>{const q=pS.useRef(null),[R,F]=pS.useState(null),[s,S]=pS.useState(!1),{device:{isLandscape:c,isTablet:N,isPhone:m,isDesktop:v,DS:W}}=wS.P(),{HAS_ROUNDED_CORNERS:Z}=W,D=A.getScorecardTheme(C),y=C===A.ScorecardThemeNames.WhiteSolid?D.fill:"none",E=!c,_=E?"190%":"auto",p=N||v||!c?TN.Ne.Bottom:TN.Ne.Top,L=pS.useCallback((()=>{null!==R&&S(R.scrollLeft>0)}),[R,S]),O=()=>$.jsx("div",{className:QS.A(Lv,{[uv]:c,[mv]:N,[Nv]:v,[Ov]:n}),ref:q,style:{width:_,background:y},children:$.jsx("div",{className:rv,children:$.jsx(k,{})})});return $.jsx("div",{className:QS.A(Sv,{[zv]:c,[wv]:N||v}),style:{width:t},children:$.jsx(Fv,{isLandscape:c,shouldAddOffsetForLandscape:C===A.ScorecardThemeNames.WhiteSolid,statistics:$.jsx("div",{className:QS.A(Wv,{[Zv]:m,[Dv]:N,[Nv]:v}),children:$.jsx(V,{tooltipPositionVertical:p})}),prediction:$.jsxs("div",{className:QS.A(cv,{[_v]:!0,[vv]:m,[mv]:N,[Nv]:v}),children:[c&&$.jsx(I,{}),$.jsx("div",{className:QS.A({[yv]:!0,[Ev]:Z}),children:$.jsx(X,{tooltip:"tooltip.clickToSeeNextValue",tooltipPositionVertical:p})}),$.jsx("div",{className:QS.A({[yv]:!0,[Ev]:Z}),children:$.jsx(K,{tooltip:"tooltip.clickToSeeNextValue",tooltipPositionVertical:p})})]}),roads:$.jsxs("div",{className:pv,children:[E?$.jsx(sv.y,{refCallback:F,onPositionChanged:L,className:jv,children:O()}):O(),!c&&$.jsx("div",{className:bv}),!c&&s&&$.jsx("div",{className:av}),!c&&$.jsx(I,{})]})})})})),ev=pS.memo(xv,i$.A),Yv=_S.PA((()=>{const{device:t,preferences:V}=rS(),X=t.isDesktop?"39%":"100%";return $.jsx(ev,{scaledWidth:X,FourRoads:om,thinRoads:!1,BankerPredictionButton:mm,PlayerPredictionButton:vm,FreeHandButtons:Rm,GameStatistics:Sm,roadThemeName:V.scorecardTheme})}));var Hv=X(496904);function hv(t,V,X=!0){const K=Math.ceil(Math.min(t,V)),k=Math.floor(Math.max(K,V)),A=Math.random()*(k-K+1);return(X?Math.floor(A):A)+K}function Tv({id:t,size:V=35,duration:X=1}){return $.jsxs("svg",{width:V,height:V,viewBox:"0 0 35 35",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[$.jsxs("g",{id:`flake_group-${t}`,children:[$.jsx("path",{d:"M18 27C23.5228 27 28 22.5228 28 17C28 11.4772 23.5228 7 18 7C12.4772 7 8 11.4772 8 17C8 22.5228 12.4772 27 18 27Z",fill:"url(#flake0_radial)",fillOpacity:"0.7"}),$.jsx("path",{transform:"rotate(45 18 17)",fillRule:"evenodd",clipRule:"evenodd",d:"M18 18.7142L7 28L16.2858 17L7 6L18 15.2858L29 6L19.7142 17L29 28L18 18.7142Z",fill:"url(#flake1_linear)",fillOpacity:"0.5"}),$.jsx("path",{d:"M18 21C20.2091 21 22 19.2091 22 17C22 14.7909 20.2091 13 18 13C15.7909 13 14 14.7909 14 17C14 19.2091 15.7909 21 18 21Z",fill:"url(#flake2_radial)",fillOpacity:"0.9"})]}),$.jsx("animate",{xlinkHref:`#flake_group-${t}`,attributeType:"CSS",attributeName:"opacity",values:"0;1;0",dur:`${X}s`,repeatCount:"indefinite"}),$.jsxs("defs",{children:[$.jsxs("radialGradient",{id:"flake0_radial",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(18 17) rotate(90) scale(10)",children:[$.jsx("stop",{stopColor:"white",stopOpacity:"0.69"}),$.jsx("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})]}),$.jsxs("linearGradient",{id:"flake1_linear",x1:"16.9852",y1:"22.1059",x2:"17.037",y2:"10.775",gradientUnits:"userSpaceOnUse",children:[$.jsx("stop",{stopColor:"#FFDEA9"}),$.jsx("stop",{offset:"0.199723",stopColor:"#f6f3ee"}),$.jsx("stop",{offset:"0.457501",stopColor:"#fff"}),$.jsx("stop",{offset:"0.852331",stopColor:"#f6f3ee"}),$.jsx("stop",{offset:"1",stopColor:"#EBC963"})]}),$.jsxs("radialGradient",{id:"flake2_radial",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(18 17) rotate(90) scale(3)",children:[$.jsx("stop",{stopColor:"white",stopOpacity:"0.56"}),$.jsx("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})]})]})]})}const Pv="container--863df",Qv="showSparkles--67c12",Jv="starsContainer--7490b",Uv="backgroundFee--4ea3e",lv="starContainer--4a320",iv=Array.from({length:Sn.DS.IS_PHONE?50:70},((t,V)=>V)).map((t=>$.jsx("div",{className:lv,style:{top:hv(0,120,!1),left:hv(0,700,!1)},children:$.jsx(Tv,{id:t,size:hv(15,25,!1),duration:hv(.1,.3,!1)})},t))),Gv=pS.memo((({animation:t,onAnimation:V})=>{pS.useEffect((()=>{null==V||V(t)}),[t,V]);const X=t===bI.V.AnimationStart;return $.jsxs("div",{className:QS.A(Pv,{[Qv]:X}),children:[$.jsx("div",{className:QS.A(Uv)}),$.jsx("div",{className:QS.A(Jv),children:iv})]})}));var dv=X(78886),Mv=X(70193);const Bv="container--68dda",ov="imgContainer--4c38b",fv="img--a3551",gv=X.p+"images/flake.99e1acd4.svg",tW=35,VW=10;function XW({left:t,top:V,bottom:X,delay:K,duration:k,scale:A,onAnimationEnd:I}){const C=0?0:Mv.A(t-VW,t+VW);return $.jsx("div",{className:ov,style:{left:C,top:V,bottom:X,transform:`scale(${A})`},children:$.jsx("img",{src:gv,className:fv,style:{animationDelay:`${K}ms`,animationDuration:`${k}ms`},onAnimationEnd:I})})}function KW(t){return"string"!=typeof t}const kW=pS.memo((({dimensions:t})=>{const V=KW(t)?t.scale:1,X=KW(t)?t.reverseScale:1,[K,k]=pS.useState(KW(t)?t.scaledWidth:"100%"),[A,I]=pS.useState(KW(t)?t.scaledHeight:t),C=pS.useRef(null);pS.useEffect((()=>{if(null!==C.current){if(0===C.current.clientWidth||0===C.current.clientHeight)return;const t=C.current.parentElement;if(!t)return;k(t.clientWidth),I(t.clientHeight)}}),[V]);const[n,q]=pS.useState(1),R=pS.useCallback((()=>{q((t=>t+1))}),[]),F=pS.useMemo((()=>{var t,k;if("string"!=typeof K&&"string"!=typeof A)return(t=K,k=tW/2,[{delay:100,duration:700,left:Math.floor(.2*t),bottom:-k-1.5},{delay:800,duration:700,left:Math.floor(.8*t),top:-k},{delay:1500,duration:500,left:Math.floor(.6*t),bottom:-k-1.5},{delay:1550,duration:500,left:Math.floor(.3*t),top:-k},{delay:2050,duration:700,left:Math.floor(.1*t),bottom:-k-1.5},{delay:2150,duration:700,left:Math.floor(.55*t),top:-k},{delay:3e3,duration:700,left:Math.floor(.7*t),bottom:-k-1.5}]).map(((t,K,k)=>{const A=K===k.length-1;return pS.createElement(XW,{...t,scale:V/X,key:n+t.delay,onAnimationEnd:A?R:void 0})}))}),[X,K,V,n,A,R]);return $.jsx("div",{ref:C,style:{width:K,height:"number"==typeof A?`${A}px`:A},className:Bv,children:F})})),AW="container--f8462",$W="golden-fee",IW=pS.memo((t=>{const V=t.animation===bI.V.BetPlaced;return $.jsxs("div",{className:AW,children:[V&&$.jsx(kW,{dimensions:t.dimensions}),$.jsx(dv.c,{...t,role:$W})]})})),CW=_S.PA((({dimensions:t})=>{const V=gc(),{key:X,mappings:K}=V.fee.tooltipText,k=q.Tl(X,K);return $.jsx(IW,{feeAmount:V.fee.value,feePercentage:V.fee.percentage,currency:V.settings.currencySymbol,orientation:V.device.orientation,tooltipLabel:k,animation:V.fee.animation,dimensions:t,isVisible:0===V.multipliers.mapValues.size,withAnimation:!0,animationDuration:0===V.multipliers.mapValues.size?100:1200,animationDelay:0,Effects:Gv,feeThemes:Hv.t,registerReference:V.reference.common.set})})),nW="fee--8f062",qW="isDesktop--7be1a",RW=_S.PA((({height:t})=>{const{device:V}=wS.P(),X=V.isDesktop;return $.jsx("div",{className:QS.A(nW,{[qW]:X}),children:$.jsx(CW,{dimensions:t})})})),FW="overlay--5a113",sW="roads--fc993",SW="noTransform--b11d2",cW="hiding--0363c",NW="fastHiding--b8e1d",mW="showing--30343",vW=_S.PA((()=>{const t=gc(),V=t.gamePhase.isBetsOpen,X=t.goLive.isGoingLive,K=t.gameInfo.gameStarted,k=t.ag.values.gameDimensions.reverseScale,A=t.bets.hasBets,I=t.gamePhase.isBetsClosed,C=X||!A&&I;return $.jsxs("div",{className:FW,children:[$.jsx("div",{className:QS.A(sW,{[SW]:V&&!X}),children:K&&$.jsx("div",{children:$.jsx(Yv,{})})}),K&&$.jsx("div",{style:{"--reverseScale":null!=k?k:1},className:QS.A(cW,{[mW]:V&&!X,[NW]:C}),children:$.jsx(RW,{height:WK._m(2.9*1.2)})})]})})),WW=()=>({PreferencesTabs:aN,SpinNowComponent:QN,TopLeftCloseGame:oN.Q,GameOverlays:vW,LayoutBetLimitsBody:hN,HelpComponentListCreator:MN,HelpCreator:BN});var ZW=X(296693);const DW=_S.PA((()=>{const t=rS(),V=t.tableConfig.tableLimitsSettings,X=V.min>0&&V.max>0&&t.settings.displayTableLimit;return $.jsx(ZW.e,{tableName:t.settings.tableName,currencySymbol:t.settings.currencySymbol,betMinLimit:t.ag.values.tableLimitsMin,betMaxLimit:t.ag.values.tableLimitsMax,tableMinLimit:X?V.min:void 0,tableMaxLimit:X?V.max:void 0,tBodyComponent:$.jsx(hN,{}),isTablet:t.device.isTablet})}));var yW=X(636874),EW=X(850449),_W=X(137832),pW=X(94501);function LW(t){const V=_W.P(EW.SJ),X=q.sU();return $.jsx(pW.a,{...t,gameTheme:V,isRtl:X})}var OW=X(127793);const rW=cN({icons:[SN(2,{winnerType:A.WinnerTypeBaccarat.Player,additionalType:A.AdditionalTypeBaccarat.Tie}),[...SN(3,{winnerType:A.WinnerTypeBaccarat.Banker}),...SN(1,{winnerType:A.WinnerTypeBaccarat.Banker,additionalType:A.AdditionalTypeBaccarat.Tie})],SN(1,{winnerType:A.WinnerTypeBaccarat.Player}),SN(4,{winnerType:A.WinnerTypeBaccarat.Banker}),SN(4,{winnerType:A.WinnerTypeBaccarat.Player}),SN(2,{winnerType:A.WinnerTypeBaccarat.Banker}),SN(4,{winnerType:A.WinnerTypeBaccarat.Player}),SN(2,{winnerType:A.WinnerTypeBaccarat.Banker})],rows:4,columns:8}),zW=[{x:0,y:0,props:{roadType:A.RoadType.Cockroach,winnerType:A.WinnerTypeBaccarat.Tie}},{x:0,y:1,props:{roadType:A.RoadType.Cockroach,winnerType:A.WinnerTypeBaccarat.Tie}},{x:1,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:1,y:1,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:2,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:2,y:1,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:2,y:2,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:3,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:4,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:5,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:5,y:1,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:5,y:2,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:5,y:3,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Player}},{x:6,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}},{x:7,y:0,props:{roadType:A.RoadType.Big,winnerType:A.WinnerTypeBaccarat.Banker}}],wW="container--3e726",bW="gridWrap--5bb13",aW="isSelected--32eda",uW="golden--67604",jW=({color:t,fill:V,stroke:X,isLive:K=!1,IconShapeComponent:k,theme:I,scorecardTheme:C,gameTheme:n,background:q})=>{const R=pS.useMemo((()=>(t=>({columnCount:8,rowCount:4,strokeWidth:.1,icons:A.mapIconsToRoadItemsBaccarat(t?rW:zW,t)}))(K)),[K]),F=I===C;return $.jsxs("div",{className:wW,"data-role":"scorecard-theme-option-container",children:[$.jsx("div",{style:{background:q},className:QS.A(bW,{[aW]:F,[uW]:n===OW.q.Golden}),children:$.jsx(A.GridView,{IconShapeComponent:k,...R,icons:R.icons,fill:V,stroke:X,redesigned:!0})}),I&&$.jsx(LW,{id:t,role:t,value:I,bulletPosition:"left",isChecked:F,isDesktop:!1,children:t})]})},xW={[A.ScorecardThemeNames.BlackDot]:({isRng:t,theme:V,scorecardTheme:X,gameTheme:K})=>$.jsx(jW,{IconShapeComponent:A.EmptyRoadItem,fill:A.getScorecardTheme(A.ScorecardThemeNames.BlackDot).fill,stroke:A.getScorecardTheme(A.ScorecardThemeNames.BlackDot).stroke,color:q.Tl("settings.gameSpecifics.scorecards.immersive"),isLive:!t,theme:V,scorecardTheme:X,gameTheme:K,background:A.getScorecardTheme(A.ScorecardThemeNames.BlackDot).background}),[A.ScorecardThemeNames.WhiteSolid]:({isRng:t,theme:V,scorecardTheme:X,gameTheme:K})=>$.jsx(jW,{fill:A.getScorecardTheme(A.ScorecardThemeNames.WhiteSolid).fill,stroke:A.getScorecardTheme(A.ScorecardThemeNames.WhiteSolid).stroke,color:q.Tl("settings.gameSpecifics.scorecards.classic"),isLive:!t,theme:V,scorecardTheme:X,gameTheme:K,background:A.getScorecardTheme(A.ScorecardThemeNames.WhiteSolid).background})},eW=[A.ScorecardThemeNames.BlackDot,A.ScorecardThemeNames.WhiteSolid],YW=({gameTheme:t,scorecardTheme:V,setScorecardTheme:X,themes:K=eW,isRng:k,isRtl:A})=>{const I=pS.useMemo((()=>function({themes:t,isRng:V,scorecardTheme:X,gameTheme:K}){return t.map((t=>({value:t,component:xW[t]({isRng:V,scorecardTheme:X,theme:t,gameTheme:K})})))}({themes:K,isRng:k,scorecardTheme:V,gameTheme:t})),[k,K,V,t]);return $.jsxs($.Fragment,{children:[$.jsx(yW.m,{isRtl:!!A,label:q.Tl("settings.gameSpecifics.scorecards")}),$.jsx(FN.P,{setValue:X,value:V,options:I,variant:"simple"})]})},HW=_S.PA((({isRng:t=!1})=>{const V=I.Pj(),X=pS.useCallback((t=>{V.preferences.updatePreferenceValue(O.Background,t),V.log.clientPressedSetting(O.Background,t)}),[V]);return $.jsx(YW,{gameTheme:V.ag.gameTheme,isRng:t,setScorecardTheme:X,scorecardTheme:V.preferences.scorecardTheme,themes:C.DC,isRtl:q.sU()})})),hW=pS.memo((()=>$.jsx(HW,{isRng:!0})));hW.displayName="CustomGameSpecificSettings";const TW="tableInfoBackground--8aefe",PW=_S.PA((()=>{const t=wS.P().device.isLandscape,[V,X]=pS.useState(0);return pS.useEffect((()=>{const t=IR.getTableInfoElement();t&&X(t.getBoundingClientRect().height)}),[t]),t?$.jsx("div",{className:TW,style:{height:`${1.5*V}px`}}):null})),QW=_S.PA((()=>gc().device.isTablet?$.jsx(nN,{}):null)),JW="mobilePortraitContainer--8befa",UW="withBottomPadding--a6806",lW="overlaysContainer--30258",iW="underlayContainer--29f31",GW="statisticsContainerTop--d4067",dW="animatedTopContainer--ed4a3",MW="noTransform--53f1c",BW="roadsUnderlay--1cd2b",oW="animatedBottomContainerHide--4821c",fW="animatedBottomContainerHideFastHide--f1b9d",gW="animatedBottomContainerShow--ce130",tZ=_S.PA((()=>{const t=gc(),V=t.gamePhase.isBetsOpen,X=t.device.DS.IS_ANDROID,K=t.device.DS.IS_IPHONE10_OR_NEWER,k=t.ag.values.isInFullscreen,A=t.goLive.isGoingLive,I=t.bets.hasBets,C=t.gamePhase.isBetsClosed,n=A||!I&&C,q=QS.A(dW,{[MW]:V&&!A}),R=QS.A(oW,{[gW]:V&&!A,[fW]:n});return $.jsxs($.Fragment,{children:[$.jsx("div",{className:iW,children:$.jsx("div",{className:q,children:$.jsx("div",{className:QS.A(BW)})})}),$.jsx(IR.MobileSafeContainerConnected,{isRng:!0,children:$.jsx("div",{className:QS.A(JW,{[UW]:X||K&&k}),children:$.jsxs("div",{className:lW,children:[$.jsx("div",{className:q,children:$.jsx("div",{className:QS.A(GW),children:$.jsx(Yv,{})})}),$.jsx("div",{className:R,children:$.jsx(RW,{height:WK._m(2.9)})})]})})})]})})),VZ="shadowOverlay--b63c0",XZ="hidden--0e51f",KZ="shadow-overlay",kZ=t=>{const{visible:V}=t;return $.jsx("div",{className:QS.A(VZ,{[XZ]:!V}),"data-role":KZ})},AZ=_S.PA((()=>{const t=rS();return $.jsx(kZ,{visible:t.gamePhase.isBetsOpen})})),$Z=pS.memo(AZ);var IZ=X(460121);const CZ="mobileLandscapeContainer--99be1",nZ="contentContainer--0bc05",qZ="middleContainer--6e689",RZ="leftContainer--6715c",FZ="rightContainer--5c737",sZ="buttonsContainer--630b5",SZ="animatedTopContainer--3173d",cZ="controlContainer--a3888",NZ="hidden--f92c4",mZ="noTransform--75fc9",vZ="animatedBottomContainerHide--a3a9a",WZ="animatedBottomContainerHideFastHide--dd0b1",ZZ="animatedBottomContainerShow--360d8",DZ=_S.PA((()=>{const t=gc(),V=t.gamePhase.isBetsOpen,X=t.freeGame.isAvailable,K=t.goLive.isGoingLive,k=t.bets.hasBets,A=t.gamePhase.isBetsClosed,I=K||!k&&A,C=QS.A(nZ),n=QS.A(qZ),q=QS.A(FZ,{[NZ]:!V||!X}),R=QS.A(SZ,{[mZ]:V&&!K}),F=QS.A(vZ,{[ZZ]:V&&!K,[WZ]:I});return $.jsxs($.Fragment,{children:[$.jsx($Z,{}),$.jsx(IR.MobileSafeContainerConnected,{isRng:!0,ignoreBottomSafeArea:!0,children:$.jsx("div",{className:CZ,children:$.jsxs("div",{className:C,children:[$.jsx("div",{className:RZ}),$.jsxs("div",{className:n,style:{width:void 0},children:[$.jsx("div",{className:R,children:$.jsx(Yv,{})}),$.jsx("div",{className:F,children:$.jsx(RW,{height:WK._m(2.9)})})]}),$.jsx("div",{className:q,children:$.jsxs("div",{className:sZ,children:[$.jsx("div",{className:cZ,children:$.jsx(tK.kg,{size:"S"})}),$.jsx("div",{className:cZ,children:$.jsx(QN,{})}),$.jsx("div",{className:cZ,children:$.jsx(IZ.eR,{size:"S",tooltipPositionHorizontal:TN.hV.Left})})]})})]})})})]})})),yZ="tabletLandscapeContainer--aaf71",EZ="contentContainer--a8a88",_Z="middleContainer--ca008",pZ="leftContainer--9439c",LZ="rightContainer--d4489",OZ="buttonsContainer--b0eac",rZ="animatedTopContainer--36590",zZ="controlContainer--ed6b7",wZ="hidden--f38a7",bZ="noTransform--b3826",aZ="animatedBottomContainerHide--9bb11",uZ="animatedBottomContainerHideFastHide--1c3d8",jZ="animatedBottomContainerShow--d18a9",xZ=_S.PA((()=>{const t=gc(),V=t.gamePhase.isBetsOpen,X=t.freeGame.isAvailable,K=t.goLive.isGoingLive,k=t.bets.hasBets,A=t.gamePhase.isBetsClosed,I=K||!k&&A,C=QS.A(EZ),n=QS.A(rZ,{[bZ]:V&&!K}),q=QS.A(aZ,{[jZ]:V&&!K,[uZ]:I}),R=QS.A(_Z),F=QS.A(LZ,{[wZ]:!V||!X});return $.jsxs($.Fragment,{children:[$.jsx($Z,{}),$.jsx(IR.MobileSafeContainerConnected,{isRng:!0,ignoreBottomSafeArea:!0,children:$.jsx("div",{className:yZ,children:$.jsxs("div",{className:C,children:[$.jsx("div",{className:pZ}),$.jsxs("div",{className:R,children:[$.jsx("div",{className:n,children:$.jsx(Yv,{})}),$.jsx("div",{className:q,children:$.jsx(RW,{height:WK._m(3)})})]}),$.jsx("div",{className:F,children:$.jsxs("div",{className:OZ,children:[$.jsx("div",{className:zZ,children:$.jsx(tK.kg,{size:"S"})}),$.jsx("div",{className:zZ,children:$.jsx(QN,{})}),$.jsx("div",{className:zZ,children:$.jsx(IZ.eR,{size:"S",tooltipPositionHorizontal:TN.hV.Left})})]})})]})})})]})})),eZ=_S.PA((t=>{const{PhonePortraitComponent:V,PhoneLandscapeComponent:X,TabletLandscapeComponent:K,deferGameLoaded:k=!1}=t,A=gc();(function(){const[,t]=pS.useState(!1),V=pS.useRef(!1),X=pS.useCallback((()=>{V.current=!V.current,t(V.current)}),[]);pS.useEffect((()=>(window.addEventListener("resize",X),()=>window.removeEventListener("resize",X))),[X])})();const I=A.gameInfo.gameStarted,C=A.device.isPortrait;let n=null;return k&&!I?n:(A.device.isPhone&&(n=C?V:X),A.device.isTablet&&(n=K),n?$.jsx(n,{}):null)})),YZ=(HZ={PhonePortraitComponent:tZ,PhoneLandscapeComponent:DZ,TabletLandscapeComponent:xZ},pS.memo((()=>$.jsx(eZ,{...HZ}))));var HZ;const hZ=t=>{const V=[YZ,PW];t&&V.push(t.MeshContainers);const X={MobileRngGameControlsPlayButton:QN,MobileMenuNavigationMap:{betLimits:DW},MobileSettings:{CustomGameSpecific:hW},HelpComponentListCreator:MN,HelpCreator:BN,MobileLayoutOverlays:V,MobileRngGameResultContainer:QW};return t&&(X.MobileGameOverlayContainer=t.Overlay3D),X};var TZ=X(809024),PZ=X(357947);window.EVO_LOADER.publishApplication("/frontend/evo/r2/","rng-baccarat.goldenWealth",{initialize:async function(t){q.JL(t.i18nData,["baccarat","rng-baccarat"]);const V=new jq.h,X=PZ.K({gameLoaderParams:t,isRng:!0}),{layout:$,ag:I,dispose:C}=function({params:t,deviceSupport:V,onGame3DLoaded:X,lobby:K}){const $=V.IS_DESKTOP,I=$?{labelTranslationId:"tooltip.threeDView",isFooterGradientVisible:!1,layoutButtonTypeOverride:"customizable",tableNameMaxWidth:k.aZ.WithRoads}:{layoutButtonTypeOverride:"customizable"},C=$?A.LayoutType.ImmersiveV2:A.LayoutType.PhoneRng;return RN({params:t,lobby:K,onGame3DLoaded:X,initComponentsMap:$?WW:hZ,bubbleEnabled:!0,skip3D:!1,gameLayout:{layoutType:C,layoutConfig:I},deviceSupport:V})}({params:t,deviceSupport:Sn.DS,onGame3DLoaded:V,lobby:X});await I.preferences.initialization;const n=K.H(t.getRoot());return n.render($),await V,{abstractGameDispose:C,root:n}},dispose:TZ.L,applicationType:"game"})},82266:(t,V,X)=>{X.d(V,{T:()=>C});var K=X(297413),k=X(776326),A=X(379014),$=X(460791),I=X(231369);function C(){const t=K.C2(K.o4),V=k.gO(t),X=K.C2(K.gR),C=k.gO(X),n=A.Rt(A.LE),q=k.gO(n),R=A.Rt(A.Tn),F=k.gO(R),s={base:V,moving:q,arrowsStyle:$.F,pulseColor:"#f4e584",labelAlpha:.9},S={...s,base:k.gO(K.C2(K.tx)),moving:k.gO(A.Rt(A.KQ,!0)),labelFillStyle:"#535353"};return{[I._i.Default]:s,[I._i.Hovered]:{...s,base:C,moving:F,labelAlpha:1},[I._i.Disabled]:S}}},300335:(t,V,X)=>{X.d(V,{v:()=>k});var K=X(64922);const k=()=>K.jsx("svg",{height:"100%",viewBox:"0 0 18 18",fill:"none",children:K.jsx("path",{opacity:.8,d:"M16.09 0L8.94 7.15C8.07 6.7 7.03 6.6 6.18 7.14C5.88 7.33 5.57 7.52 5.27 7.71C3.76 8.66 2.14 9.45 0.32 9.8C0.21 9.82 0.11 9.84 0 9.86C0.15 10.54 0.36 11.19 0.64 11.8L3.8 10.26L1.04 12.6C1.42 13.28 1.87 13.9 2.39 14.47L5.35 12.18L3.04 15.13C3.59 15.63 4.19 16.07 4.83 16.44L7.18 13.66L5.63 16.84C6.28 17.13 6.95 17.37 7.66 17.52C7.7 17.35 7.73 17.17 7.77 17C8.14 15.35 8.87 13.86 9.74 12.46C9.97 12.1 10.19 11.73 10.42 11.36C10.96 10.49 10.84 9.43 10.37 8.55L17.5 1.41C17.08 0.89 16.6 0.42 16.09 0Z",fill:"white"})})},952618:(t,V,X)=>{X.d(V,{M:()=>R});var K=X(64922),k=X(699695),A=(X(377810),X(822381)),$=X(539025),I=X(794435),C=X(300335);const n="clearButtonIcon--16d5b",q="disabled--0ee8a",R=t=>{const{clearTable:V,buttonsEnabled:X,tooltipPositionVertical:R,isPortrait:F,isPhone:s,isDesktop:S}=t;let c;c=S||!s?3:F?2.75:2;const N={iconComponent:K.jsx("div",{className:n,children:K.jsx(C.v,{})}),style:{height:A._m(c),fontSize:A._m(c)},labelPosition:"Inside",onClick:V,state:X?"Default":"Disabled",tooltip:X?"tooltip.clear":void 0,tooltipPositionVertical:R,role:"clear-table-button"},m=F?K.jsx(I.B,{...N}):K.jsx($.p,{...N,isPhone:s,isTablet:!s&&!S});return K.jsx("div",{className:k.A({[q]:!X}),children:m})}},430264:(t,V,X)=>{X.d(V,{O:()=>O});var K=X(64922),k=X(699695),A=X(377810),$=X(297413),I=X(776326),C=X(379014),n=X(231369),q=X(82266),R=X(762923),F=X(346160),s=X(710928);const S="animation--d4ced",c="leftCardAnimation--25f0d",N="rightCardAnimation--24f7c",m={strokeFrom:"#FBEDB1",strokeTo:"#93742D",fillFrom:"#FAEDB2",fillTo:"#94762D"},v={strokeFrom:"#3D3D3D",strokeTo:"#1E1D1A",fillFrom:"#1D1D1D",fillTo:"#252525"},W=({cardColors:t,hovered:V})=>{const X=0?0:Math.random();return K.jsxs("svg",{width:"73",height:"72",viewBox:"0 0 73 72",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:"100%"},children:[K.jsx("g",{filter:`url(#filterShadow-${X})`,className:k.A(S,{[N]:V}),children:K.jsx("path",{d:"M43.4695 62.6074L18.4816 53.2843C16.7881 52.6525 15.9145 50.7789 16.5191 49.0755L29.986 11.1346C30.5976 9.41165 32.49 8.51069 34.213 9.12223C34.2296 9.12815 34.2463 9.13421 34.2629 9.14039L59.2507 18.4634C60.9442 19.0953 61.8178 20.9688 61.2132 22.6722L47.7463 60.6132C47.1348 62.3361 45.2423 63.2371 43.5194 62.6255C43.5027 62.6196 43.4861 62.6136 43.4695 62.6074Z",fill:"black"})}),K.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M45.7733 61.9145C45.1569 62.2079 44.4286 62.2662 43.744 62.0233L18.7063 52.6821C18.0239 52.4275 17.5068 51.9228 17.2211 51.3101C16.9354 50.6975 16.8812 49.9769 17.1249 49.2905L30.5917 11.3496C30.8381 10.6554 31.3426 10.1268 31.959 9.8333C32.5754 9.53984 33.3038 9.48153 33.9883 9.72442L59.026 19.0656C59.7084 19.3202 60.2255 19.8249 60.5112 20.4376C60.7969 21.0503 60.8511 21.7709 60.6075 22.4573L47.1406 60.3982C46.8942 61.0924 46.3897 61.621 45.7733 61.9145Z",fill:`url(#fillRadial2-${X})`,stroke:`url(#strokeLinear2-${X})`,strokeWidth:"1.28546",className:k.A(S,{[N]:V})}),K.jsx("g",{filter:`url(#filterShadow2-${X})`,className:k.A(S,{[c]:V}),children:K.jsx("path",{d:"M43.3557 58.4054L16.8539 58.3483C15.0312 58.3444 13.5546 56.8677 13.5507 55.045L13.465 14.9483C13.4611 13.1201 14.94 11.6348 16.7682 11.6309C16.773 11.6309 16.7777 11.6309 16.7824 11.6309L43.2842 11.688C45.107 11.6919 46.5836 13.1685 46.5875 14.9912L46.6732 55.088C46.6771 56.9162 45.1981 58.4015 43.3699 58.4054C43.3652 58.4054 43.3604 58.4054 43.3557 58.4054Z",fill:"black"})}),K.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M45.2531 56.9773C44.7714 57.4611 44.1052 57.7611 43.3713 57.7626L16.8553 57.7056C16.1209 57.704 15.4562 57.4057 14.9747 56.9242C14.4932 56.4428 14.195 55.7781 14.1934 55.0437L14.1077 14.9469C14.1061 14.2103 14.4033 13.5427 14.885 13.059C15.3667 12.5752 16.033 12.2752 16.7668 12.2736L43.2829 12.3307C44.0173 12.3323 44.682 12.6305 45.1634 13.112C45.6449 13.5935 45.9432 14.2582 45.9447 14.9926L46.0304 55.0893C46.032 55.826 45.7348 56.4935 45.2531 56.9773Z",fill:`url(#fillRadial-${X})`,stroke:`url(#strokeLinear-${X})`,strokeWidth:"1.28546",className:k.A(S,{[c]:V})}),K.jsxs("defs",{children:[K.jsxs("filter",{id:`filterShadow-${X}`,x:"5.00102",y:"0.564761",width:"67.7303",height:"70.6182",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[K.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),K.jsx("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),K.jsx("feOffset",{}),K.jsx("feGaussianBlur",{stdDeviation:"1"}),K.jsx("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.8 0"}),K.jsx("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow"}),K.jsx("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"})]}),K.jsxs("filter",{id:`filterShadow2-${X}`,x:"0.775759",y:"2.26427",width:"58.5866",height:"65.5077",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[K.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),K.jsx("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),K.jsx("feOffset",{}),K.jsx("feGaussianBlur",{stdDeviation:"1"}),K.jsx("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.8 0"}),K.jsx("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow"}),K.jsx("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"})]}),K.jsxs("radialGradient",{id:`fillRadial2-${X}`,cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(128.51 33.7286) rotate(-61.9653) scale(32.5499 35.4995)",children:[K.jsx("stop",{stopColor:t.fillFrom}),K.jsx("stop",{offset:"1",stopColor:t.fillTo})]}),K.jsxs("linearGradient",{id:`strokeLinear2-${X}`,x1:"31.8818",y1:"9.80778",x2:"45.7956",y2:"61.735",gradientUnits:"userSpaceOnUse",children:[K.jsx("stop",{stopColor:t.strokeFrom}),K.jsx("stop",{offset:"1",stopColor:t.strokeTo})]}),K.jsxs("radialGradient",{id:`fillRadial-${X}`,cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(93.8422 34.3054) rotate(-86.1575) scale(24.2543 35.4485)",children:[K.jsx("stop",{stopColor:t.fillFrom}),K.jsx("stop",{offset:"1",stopColor:t.fillTo})]}),K.jsxs("linearGradient",{id:`strokeLinear-${X}`,x1:"23.4687",y1:"10.3851",x2:"36.6175",y2:"59.4574",gradientUnits:"userSpaceOnUse",children:[K.jsx("stop",{stopColor:t.strokeFrom}),K.jsx("stop",{offset:"1",stopColor:t.strokeTo})]})]})]})},Z="hideable--acbc0",D="hidden--58d2c",y="dealRebetButton--1f06d",E="mobile--4887b",_="portrait--b57a3",p="tablet--98899",L=({children:t,opacity:V,fontSize:X})=>K.jsx("div",{style:{position:"absolute",opacity:V},children:K.jsx("div",{style:{width:X},children:t})}),O=({tooltipPositionHorizontal:t,onDeal:V,onRepeat:X,isDealAllowed:S,isDealHotKeyEnabled:c,isRepeatAllowed:N,isMobile:O,isPortrait:r,isLowPerformanceDevice:z,isHidden:w,isTablet:b,isTooltipAllowed:a,tooltipKey:u})=>{const j=N?function(){const t=$.C2($.o4),V=I.gO(t),X=C.Rt(C.Ix),K=I.gO(X),k=C.Rt(C.Go),A=I.gO(k),q={base:V,moving:K,arrowsStyle:{gradient1Color1:"#9DDFFF",gradient1Color2:"#9DDFFF",gradient2Color1:"#9DDFFF",gradient2Color2:"#9DDFFF",opacity:1},pulseColor:"#00C5FF",labelAlpha:.9};return{[n._i.Default]:q,[n._i.Hovered]:{...q,base:V,moving:A,labelAlpha:1},[n._i.Disabled]:{...n.s$,base:I.gO($.C2($.u))}}}():q.T(),x=F.Tl(N?"button.rebet":"button.deal"),e=!S&&!N,Y=A.useCallback((t=>{if(N&&!S&&R.gN(t)){const t=setTimeout((()=>{X(),clearTimeout(t)}),0)}c&&S&&R.pu(t)&&V()}),[N,S,c,X,V]),H=A.useCallback((()=>!a),[a]),h=N?X:V;return A.useEffect((()=>{const t=window.setTimeout((()=>{window.addEventListener("keyup",Y,!1),window.clearTimeout(t)}));return()=>{window.removeEventListener("keyup",Y)}}),[Y]),K.jsx("div",{className:k.A(y,Z,{[D]:w,[E]:O,[p]:b,[_]:r}),children:K.jsx(n.fl,{isMobile:O,isLowPerformanceDevice:z,label:x,role:"multi-button",useTimer:!1,timerDuration:0,onClick:h,disabled:e,theme:j,IconComponent:N?void 0:({hovered:t})=>K.jsx(L,{opacity:e?1:.3,fontSize:"6em",children:K.jsx(W,{cardColors:e?v:m,hovered:t||!1})}),hideArrows:!N,scaleDisabled:e,disablePulsing:!0,tooltip:u,forceHideTooltip:H,tooltipPositionHorizontal:null!=t?t:r?s.hV.Center:s.hV.Left,hideTooltipAfterClick:!e,calculateMultilineText:!0})})}},381450:(t,V,X)=>{X.d(V,{X:()=>R});var K=X(64922),k=X(699695),A=X(539025),$=X(794435),I=X(822381),C=X(191706);const n="playFreeGamesButtonIcon--8cc35",q="disabled--9c1d7",R=t=>{const{playFreeGame:V,buttonsEnabled:X,tooltipPositionVertical:R,isPortrait:F,isPhone:s,isDesktop:S}=t;let c;c=S||!s?3:F?2.75:2;const N={iconComponent:K.jsx("div",{className:n,children:K.jsx(C.K,{})}),labelPosition:"Inside",onClick:V,state:X?"Default":"Disabled",tooltip:X?"tooltip.dealFreeHand":void 0,tooltipPositionVertical:R,style:{height:I._m(c),fontSize:I._m(c)},role:"play-free-game-button"},m=F?K.jsx($.B,{...N}):K.jsx(A.p,{...N,isPhone:s,isTablet:!s&&!S});return K.jsx("div",{className:k.A({[q]:!X}),children:m})}},191706:(t,V,X)=>{X.d(V,{K:()=>k});var K=X(64922);X(377810);const k=({height:t="100%",opacity:V=.8})=>K.jsx("svg",{height:t,viewBox:"0 0 15 14",fill:"none",style:{position:"relative"},children:K.jsx("path",{opacity:V,fillRule:"evenodd",clipRule:"evenodd",d:"M14.7 0V13.7H12.63V2.07H12.55L9.27002 4.21V2.23L12.69 0H14.7ZM4.75 5.96V2.72H3.25V5.96H0V7.46H3.25V10.72H4.75V7.46H8V5.96H4.75Z",fill:"#FFF"})})},539025:(t,V,X)=>{X.d(V,{p:()=>R});var K=X(64922),k=X(699695),A=X(525620),$=(X(377810),X(414697));const I="button--3a150",C="buttonStateDefault--8c9b7",n="buttonStateActivated--5f9b7",q="buttonStateDisabled--bc828",R=A.PA((({state:t,...V})=>K.jsx($.H,{state:t,className:k.A(I,{[C]:"Default"===t,[q]:"Disabled"===t,[n]:"Activated"===t}),...V})))},691951:(t,V,X)=>{X.d(V,{_:()=>b});var K=X(64922),k=X(699695),A=X(377810),$=X(715907);const I=t=>K.jsx($.$,{...t});var C=X(436794),n=X(822381),q=X(607439),R=X(236042),F=X(795192);const s="container--3d3f7",S="controlArea--d1f90",c="arc--55041",N="track--da326",m="control--7e902",v="arrowLeft--5b75c",W="arrowRight--a8eef",Z=[-15,15],D={[C.t.Landscape]:.07,[C.t.Portrait]:.05},y=({progress:t,moveCutCard:V,onTouchEnd:X,orientation:$=C.t.Landscape})=>{const I=A.useRef(t),n=A.useRef(null),y=A.useRef(null),E=A.useCallback(R.A((t=>{if(y.current){const{left:X,width:K}=y.current.getBoundingClientRect(),k=F.eS((t-X)/K);k!==I.current&&(I.current=k,V(function(t,V){return q.A(t,D[V],1)}(k,$)))}}),40,{trailing:!1}),[]),_=A.useCallback((t=>{t.defaultPrevented&&t.preventDefault(),E(t.touches[0].clientX)}),[E]),p=A.useCallback((()=>{V(I.current),X()}),[V,X]),L=A.useCallback((t=>{E(t.clientX)}),[E]);return A.useEffect((()=>{if(n.current){const V=function(t,V){const X=Math.abs(V[0])+Math.abs(V[1]);return q.A(Math.round(V[0]+X*t),V[0],V[1])}(t,Z);n.current.style.transform=`translate(-50%) translateZ(0) rotate(${V}deg)`}}),[t]),K.jsxs(K.Fragment,{children:[K.jsx("div",{className:s,children:K.jsx("div",{className:k.A(N,c)})}),K.jsx("div",{ref:y,onMouseMove:L,className:k.A(s,S),"data-role":"slider-area",children:K.jsx("div",{ref:n,className:c,children:K.jsxs("div",{className:m,onTouchMoveCapture:_,onTouchEnd:p,children:[K.jsx("span",{className:v}),K.jsx("span",{className:W})]})})})]})},E="sliderContainer--d575e",_="isMobile--2f567",p="isTablet--ed322",L="slider--0048c",O="disappearing--be405",r="sliderButton--d7fc0";var z;(function(t){t[t["Disappearing"]=1]="Disappearing",t[t["Blinking"]=3]="Blinking"})(z||(z={}));const w="cut-cards-slider",b=({cutPosition:t,isVisible:V,isMobile:X,isTablet:q,timeleftSec:R,onCut:F,hasAnimation:s,onMoveCutCard:S,orientation:c=C.t.Landscape})=>{const{blinking:N,disappearing:m}=function(t,V){const[X,K]=A.useState(!1),[k,$]=A.useState(!1);return A.useEffect((()=>{t&&(V<=z.Blinking&&!X?K(!0):V>z.Blinking&&X&&K(!1),V<=z.Disappearing&&!k?$(!0):V>z.Disappearing&&k&&$(!1))}),[V,X,k,t]),{blinking:X,disappearing:k}}(s,R),v=A.useCallback((()=>F(!0)),[F]),W=A.useCallback((()=>F(!1)),[F]);return V?K.jsxs("div",{className:k.A(E,{[_]:X,[p]:q}),"data-role":w,children:[K.jsx("div",{className:k.A(L,{[O]:m}),children:K.jsx(y,{progress:t,moveCutCard:S,onTouchEnd:W,orientation:c})}),K.jsx("div",{className:k.A(r,{[O]:m}),children:A.createElement(N?I:$.$,{labelPosition:"Inside",label:"button.cutDeck",onClick:v,...!N&&{type:"secondaryGold"},style:{fontSize:n._m(4.4),height:n._m(4.4)}},null)})]}):null}},301983:(t,V,X)=>{X.d(V,{B:()=>q,m:()=>n});var K=X(64922),k=X(525620),A=X(377810),$=X(968776),I=X(996496),C=X(715907);const n=({skip:t,visible:V})=>V?K.jsx(C.$,{labelPosition:"Inside",label:"button.skip",onClick:t,type:"secondaryGold"}):null,q=k.PA((()=>{const t=$.P(),V=t.animation.isShuffleCardsActive,X=A.useCallback((()=>{t.log.skipShufflePressed(),t.sounds.playClickButtonSound(),t.messageSender3d.to.cancelToken({tokenGroups:I.b.ShuffleCards})}),[t.log,t.messageSender3d.to,t.sounds]);return K.jsx(n,{skip:X,visible:V})}))},794435:(t,V,X)=>{X.d(V,{B:()=>A});var K=X(64922),k=(X(377810),X(715907));const A=t=>K.jsx(k.g,{type:"borderless",...t})},968776:(t,V,X)=>{X.d(V,{P:()=>k});var K=X(731675);const k=()=>K.Pj()},704184:(t,V,X)=>{X.d(V,{AN:()=>I,Ay:()=>K,C3:()=>F,KM:()=>c,Qo:()=>k,Rm:()=>q,UW:()=>A,aI:()=>S,cr:()=>C,fh:()=>s,pP:()=>$,w7:()=>R,xX:()=>n});const K=52,k=K,A=8,$=K*A,I=$-K,C=6,n=5,q=3,R=.001,F=5e-4,s=.003,S=$-100,c={stats:{gameCount:0,playerWins:0,bankerWins:0,ties:0,playerPairs:0,bankerPairs:0},history_v2:[],tableId:""}},629474:(t,V,X)=>{var K;X.d(V,{y:()=>K}),function(t){t["Shuffled"]="Shuffled",t["Cut"]="Cut",t["Burned"]="Burned",t["Finished"]="Finished"}(K||(K={}))},991922:(t,V,X)=>{function K(t,V){return new k(t,V)}X.d(V,{U:()=>K});class k{constructor(t,V){this.token=t,this.messageSender3d=V,this.steps=[],t.onDispose((()=>{this.dispose()}))}addStep(t){return this.steps.push(t),this}execute(){return this.messageSender3d.to.registerToken({token:this.token}),this.executeStep(0)}onCancel(t){return this.token.onCancel(t),this}executeStep(t){if(t<this.steps.length){const V=(0,this.steps[t])();if(V)return V.then((()=>{if(this.token.active)return this.executeStep(t+1)}));if(this.token.active)return this.executeStep(t+1)}else this.token.dispose();return Promise.resolve()}dispose(){this.steps.length=0}}},757712:(t,V,X)=>{X.d(V,{Gr:()=>k,Ti:()=>A});var K=X(996496);function k(){return $(K.b.ShuffleCards)}function A(){return $(K.b.CutCards)}function $(t){return new I(t)}class I{constructor(t){this.isActive=!0,Array.isArray(t)?this.groups=t:this.groups=[t],this.onCancelListeners=[],this.onReadyListeners=[],this.onDisposeListeners=[]}get active(){return this.isActive}cancel(){if(this.active){this.isActive=!1;for(const t of this.onCancelListeners)t();this.dispose()}}onCancel(t){return this.isActive?(this.onCancelListeners.push(t),this):this}onReady(t){return this.isActive?(this.onReadyListeners.push(t),this):this}onDispose(t){return this.isActive?(this.onDisposeListeners.push(t),this):this}ready(){if(this.active){this.isActive=!1;for(const t of this.onReadyListeners)t();this.dispose()}}dispose(){this.isActive=!1;for(const t of this.onDisposeListeners)t();this.onCancelListeners.length=0,this.onReadyListeners.length=0,this.onDisposeListeners.length=0}}},996496:(t,V,X)=>{var K;X.d(V,{b:()=>K}),function(t){t["ShuffleCards"]="TokenGroup.ShuffleCards",t["CutCards"]="TokenGroup.CutCards"}(K||(K={}))},138059:(t,V,X)=>{X.d(V,{d:()=>K,l:()=>k});const K=20,k="goldenwealth"},210166:(t,V,X)=>{function K(t,V){if(void 0!==t)return void 0===V?t:t+V}X.d(V,{X:()=>A});var k=X(104128);class A{constructor(t,V){this.camera=t,this.cameraTargets=V,this.currentTarget=null}setCameraTargets(t){if(this.cameraTargets===t)return;this.cameraTargets=t;const V=this.flyingToTarget||this.currentTarget;V&&this.focusOn(V)}focusOn(t){this.currentTarget=t,this.camera.focusCameraOn(this.cameraTargets[t])}focusOnWithOffset(t,V){this.currentTarget=t;const X=this.cameraTargets[t];this.camera.focusCameraOn({alpha:K(X.alpha,V.alpha),beta:K(X.beta,V.beta),radius:K(X.radius,V.radius),target:X.target})}flyTo(t){const V=t.needConstantDelta&&void 0===t.constantDelta?k.v(this.camera.camera.getScene()):void 0;this.camera.flyTo({constantDelta:V,...t})}flyToOffsetAngle(t){return new Promise((V=>{const X=this.currentTarget;if(!X)throw new Error("There is no current target. Make sure that focusOn is called before calling flyToOffset");const k=this.cameraTargets[X];this.flyTo({duration:t.duration,alpha:K(k.alpha,t.alpha),beta:K(k.beta,t.beta),radius:K(k.radius,t.radius),onComplete:V})}))}flyToTarget(t,V,X){const K=this.cameraTargets[t].animateFrom,k=this.flyingToTarget||this.currentTarget;if(!k)throw new Error("There is no current target. Make sure that focusOn is called before calling flyToTarget");const A=null==K?void 0:K[k];if(!K||!A)throw new Error(`There is no animation data for flying from ${k} to ${t}`);this.flyingToTarget=t,this.flyTo({alpha:this.cameraTargets[t].alpha,beta:this.cameraTargets[t].beta,radius:this.cameraTargets[t].radius,target:this.cameraTargets[t].target,fov:this.cameraTargets[t].fov,...A,onComplete:()=>{A.onComplete&&A.onComplete(),V&&V(),this.currentTarget=t,this.flyingToTarget=void 0},onCancel:()=>{A.onCancel&&A.onCancel(),X&&X(),this.flyingToTarget=void 0}})}flyToTargetAsync(t){return new Promise(((V,X)=>{this.flyToTarget(t,V,(()=>X(new Error("flyToTargetAsync failed"))))}))}flyThroughWaypoints(t){return this.camera.flyThroughWaypoints(t)}toggleFreeMode(t){t?this.camera.camera.attachControl(this.getCanvas(),!1):this.camera.camera.detachControl()}getWheelDeltaPercentage(){return this.camera.camera.wheelDeltaPercentage}setWheelDeltaPercentage(t){this.camera.camera.wheelDeltaPercentage=t}getCurrentTarget(){return this.currentTarget}setCurrentTarget(t){this.currentTarget=t}getFlyingToTarget(){return this.flyingToTarget}subscribeOnCameraMovement(t){return this.camera.camera.onViewMatrixChangedObservable.add(t),()=>{this.camera.camera.onViewMatrixChangedObservable.removeCallback(t)}}getCanvas(){return this.camera.camera.getEngine().getRenderingCanvas()}}},32035:(t,V,X)=>{X.d(V,{Iy:()=>K,OL:()=>L,WN:()=>N,_O:()=>O,hU:()=>m,sC:()=>z,zb:()=>r,zk:()=>p});var K,k=X(121669),A=X(718284),$=X(221770),I=X(433161),C=X(74643),n=X(722726);(function(t){t["Standard"]="ChipGroup.Standard",t["Losing"]="ChipGroup.Losing",t["Winning"]="ChipGroup.Winning",t["Moving"]="ChipGroup.Moving",t["Disabled"]="ChipGroup.Disabled",t["ChipSelector"]="ChipGroup.ChipSelector",t["ChipSelectorDisabled"]="ChipGroup.ChipSelectorDisabled",t["GhostChip"]="ChipGroup.GhostChip"})(K||(K={}));const q="#fff",R="#fff",F="#000",s=128,S=28;let c;function N({amounts:t,chip:V,chipTexture:X,plaqueTexture:k,renderingGroup:$,groups:C=[K.Standard],needDepthPrePass:n=!1,useGroupsForMaterialsAndTextures:q=!1,currencyMultiplier:R=1,diffuseColor:F}){c&&function(){if(Z={},c){c.chipGroups&&function(t){const V=Object.keys(t);let X,K;for(const k of V){X=t[k],K=Object.keys(X);for(const t of K)X[t].dispose(!1,!0)}}(c.chipGroups),c.chipPrototype&&c.chipPrototype.dispose(!1,!0),c.availableAmounts&&(c.availableAmounts.length=0);const t=Object.keys(c);for(const V of t)c[V]=void 0;c=void 0}}(),c={chipPrototype:V,chipDiffuseImage:X,plaqueDiffuseImage:k,size:V.getBoundingInfo().boundingBox.extendSize.scale(2),chipsRenderingGroup:$,availableAmounts:[...t].sort(((t,V)=>V-t)),chipGroups:{},chipLabelCanvas:document.createElement("canvas"),currencyMultiplier:R},c.chipLabelCanvas.width=s,c.chipLabelCanvas.height=s,c.chipPrototype.material.unfreeze();const S=A.A(((t,V,K,k)=>{const A=W(t,V,k);return y(K,I.IL(K,void 0,R),A.diffuseTexture,X),F&&(A.diffuseColor=F),A.allowShaderHotSwapping=!1,A}),((t,V,X,K)=>`${t}-${X}-${K}`));t.forEach((t=>{const V=t.toString(),X=`chip-${V}`;C.forEach((K=>{const k=S(X,c.chipPrototype.material,t,q?K:void 0);c.chipGroups[K]||(c.chipGroups[K]={});const A=v(`${X}-${K}`,c.chipPrototype);A.material=k,A.material.needDepthPrePass=n,A.setEnabled(!1);const $=c.chipGroups[K];$&&($[V]=A)}))})),c.chipPrototype.setEnabled(!1),c.chipsRenderingGroup&&V.getScene().setRenderingAutoClearDepthStencil(c.chipsRenderingGroup,!1,!1,!1)}function m(t=1){return I.y(c.size,c.chipPrototype.scaling,t)}function v(t,V){const X=V.clone(t);return X.makeGeometryUnique(),X.isPickable=!1,void 0!==c.chipsRenderingGroup&&(X.renderingGroupId=c.chipsRenderingGroup),X}function W(t,V,X){const K=V.clone(`${t}-material-${X}`);return K.diffuseTexture=D(t,V.getScene(),X),K}let Z={};function D(t,V,X){const K=`${t}-texture-${X}`;if(!Z[K]){const t=new k.R(K,c.chipLabelCanvas,V,!0);t.coordinatesMode=0,t.wrapV=1,t.wrapU=1,t.coordinatesIndex=0,Z[K]=t}return Z[K]}function y(t,V,X,K,k=!0){const A=$.i(t),C=I.h2(A,s),n=X.getContext();n.clearRect(0,0,s,s),function(t,V,X){t.fillStyle=V,t.fillRect(0,0,X,X)}(n,V,s),E(n,K,s),k&&_(n,A,C,q,.5*s,.5*s,-.035),X.update()}function E(t,V,X){t.drawImage(V,0,0,V.width,V.height,0,0,X,X)}function _(t,V,X,K,k,A,$=0,I){t.save(),t.translate(k,A),t.rotate($),t.font=`600 ${X}px sans-serif`,t.fillStyle=K,t.textAlign="center",t.textBaseline="middle",I&&(t.strokeStyle=I,t.lineWidth=2,t.strokeText(V,0,0)),t.fillText(V,0,0),t.restore()}function p(t,V,X=K.Standard){const k=c.chipGroups[X][V],A=new w(k.createInstance(t));return X===K.Losing&&(A.mesh.alphaIndex=c.chipGroups[K.Standard][V].alphaIndex),A.mesh.material&&(A.mesh.material.needDepthPrePass=!1),A.setAmount(V),A}function L(t,V){return new w(V.createInstance(t))}function O(t){var V;const X=v(t,c.chipPrototype);return X.setEnabled(!0),X.material=W(`label-${t}`,c.chipPrototype.material),new b(X,null!==(V=c.currencyMultiplier)&&void 0!==V?V:1)}function r(t){const V=t.material;return V.diffuseTexture=D(V.name,V.getScene()),new a(t)}function z(t){for(const V of Object.values(function(t){const V=c.chipGroups[t];if(!V)throw new Error(`Chip group ${t} not initialised`);return V}(K.ChipSelectorDisabled)))V.visibility=t}class w{constructor(t){this.isGhost=!1,this.isChipVisible=!0,t.isPickable=!1,this.base=t,this.freezeWorldMatrix=this.freezeWorldMatrix.bind(this)}get mesh(){return this.base}get isPickable(){return this.base.isPickable}set isPickable(t){this.base.isPickable=t}get isVisible(){return this.isChipVisible}set isVisible(t){this.isChipVisible=t,this.base&&(this.base.isVisible=t)}setAbsolutePosition(t){this.base.setAbsolutePosition(t)}setEnabled(t){this.base.setEnabled(t)}freezeWorldMatrix(){this.base.freezeWorldMatrix()}unfreezeWorldMatrix(){this.base.unfreezeWorldMatrix()}getSize(){return C.Ts(this.base,!0)}setAmount(t){this.amount=t}getAmount(){return this.amount}dispose(){this.base&&!this.base.isDisposed()&&(this.base.dispose(),this.base=void 0)}isDisposed(){return void 0===this.mesh||this.mesh.isDisposed()}}class b extends w{constructor(t,V){super(t),this.material=t.material,this.texture=this.material.diffuseTexture,this.currencyMultiplier=V}setAmount(t,V=!0){const X=this.base.isWorldMatrixFrozen;X&&this.unfreezeWorldMatrix(),super.setAmount(t),y(t,I.IL(t,c.availableAmounts,this.currencyMultiplier),this.texture,c.chipDiffuseImage,V),this.texture.update(),X&&n.K(this.base.getScene(),this.freezeWorldMatrix)}dispose(){super.dispose(),this.material.dispose(),this.material=void 0,this.texture=void 0}}class a extends w{constructor(t){super(t),this.texture=t.material.diffuseTexture}setAmount(t){super.setAmount(t),c.plaqueDiffuseImage&&function(t,V,X){const K=$.i(t),k=Math.min(S,I.h2(K,s)),A=V.getContext();A.clearRect(0,0,s,s),E(A,X,s),_(A,K,k,R,.5*s,.7*s,0,F),V.update()}(t,this.texture,c.plaqueDiffuseImage),this.texture.update()}dispose(){this.texture.dispose(),super.dispose()}}},771528:(t,V,X)=>{X.d(V,{FU:()=>m,er:()=>L,kZ:()=>_}),X(371020);var K=X(948733),k=X(814566),A=X(328910),$=X(433161),I=X(609859),C=X(131208),n=X(204596),q=X(359767),R=X(32035);const F=1,s=.2,S=.2,c=new K.Pq(0,.0025/s,.005/s),N=new K.Pq(0,-.001/s,-.0025/s);function m(t,V,X,K,$,I,C,n,q,R){const F=[];let s=[];const S=X.getChips();for(let k=0;k<$;k++){const A=t/V,n=S[S.length-1-k],q=v(X.getTopChipPosition(),C.height,$-k-1,n),c=W(A,t,V,K.getTopChipPosition(),C,k),N=Z(q,c,C.height),m=y(A,k,V,N,I,K,X.getChipGroup(),R),_=D(q,N,t,I,k,X,X.getChipGroup(),n),p=E(m,c,k,$,K);F.push(_,p),s=s.concat(m)}const c=k.h({onComplete:()=>{for(const t of s)R&&t.mesh&&A.PP(t.mesh,R),t.dispose();n()},onCancel:()=>{for(const t of s)R&&t.mesh&&A.PP(t.mesh,R),t.dispose();q()}});for(const t of F)c.add(t);return c}function v(t,V,X,k){return k?k.mesh.getAbsolutePosition().clone():new K.Pq(t.x,t.y+V*(1+X),t.z)}function W(t,V,X,k,A,I){const C=[],n=V/X;for(let V=0;V<n;V++){const X=V+1+I*n,q=X===t*n,R=k.add(new K.Pq(q?0:$.jE(X,A.diameter),(A.height+.05*A.height)*X-A.height/2-.05*A.height,q?0:$.jE(X,A.diameter,!0)));C.push(R)}return C}function Z(t,V,X){const k=(t.x+V[0].x)/2,A=(t.z+V[0].z)/2,$=Math.max(t.y,V[0].y);return new K.Pq(k,$+15*X,A)}function D(t,V,X,K,k,A,$,n){const q=[],S=R.zk(`chip-break-down-${X}-${k}`,X,$);S.mesh.scaling.setAll(F),S.mesh.parent=A,S.setAbsolutePosition(t),S.mesh.rotation.y=K,n&&(n.isVisible=!1),q.push({target:S.mesh,props:{position:I._t(V,A)},settings:{inTangent:c,outTangent:N}});const m=()=>{S.dispose()};return new C.K(q,s,{onComplete:m,onCancel:m})}function y(t,V,X,K,k,$,I,C){const n=[];for(let q=0;q<t;q++){const t=R.zk(`chip-break-down-shrapnel-${V}-${q}`,X,I);t.mesh.scaling.setAll(F),t.isVisible=!1,t.mesh.rotation.y=k,t.mesh.parent=$,t.setAbsolutePosition(K),n.push(t),C&&A.jN(t.mesh,C)}return n}function E(t,V,X,k,A){const n=t.map(((C,n)=>{const q=t.length,R=n+q*X,F=R+1===q*k,s=C.mesh.rotation.y+(F?0:$.s8(R+1));return{target:C.mesh,props:{position:I._t(V[n],A),"rotation.y":s},settings:{inTangent:new K.Pq(0,(-.1+.05*(1-n))/S,-.25/S).scale(.01),outTangent:new K.Pq(0,(.25-.05*(1-n))/S,.1/S).scale(.01)}}}));return new C.K(n,S,{onStart:()=>{for(const V of t)V.isVisible=!0}})}function _(t){const V=t.mesh.position,X=t.mesh.rotation;return[n.aZ({prop:"position",keys:[{frame:0,value:V},{frame:6,value:new K.Pq(V.x,V.y+.03,V.z)},{frame:12,value:V}],frameRate:q.q}),n.aZ({prop:"rotation",keys:[{frame:0,value:X},{frame:2,value:new K.Pq(X.x,X.y,X.z-Math.PI/10)},{frame:4,value:new K.Pq(X.x-Math.PI/10,X.y,X.z)},{frame:6,value:new K.Pq(X.x,X.y,X.z+Math.PI/10)},{frame:8,value:new K.Pq(X.x+Math.PI/12,X.y,X.z)},{frame:10,value:new K.Pq(X.x,X.y,X.z-Math.PI/16)},{frame:12,value:X}],frameRate:q.q})]}var p;(function(t){t[t["From"]=1]="From",t[t["To"]=.7]="To"})(p||(p={}));const L=[{frame:0,value:p.From},{frame:Math.round(.8*q.q),value:p.To},{frame:Math.round(1.6*q.q),value:p.From}]},682710:(t,V,X)=>{X.d(V,{$N:()=>W,IW:()=>p});var K=X(948733),k=X(600962),A=X(523737),$=X(76748),I=X(949642),C=X(56195),n=X(328910),q=X(433161),R=X(74643),F=X(513024),s=X(204596),S=X(32035),c=X(771528),N=X(884084),m=X(10783),v=X(719080);const W=10,Z=.02,D=1.45,y="chip-selector",E="chip-stack",_=5e3;class p{constructor(t){this.chipDimensions=S.hU(D),this.chipStacks={},this.buttons={},this.chipAmountsPerChipStack={},this.amount=0,this.plaqueAmount=0,this.eventMap={[v.e.ChipStackSelected]:[],[v.e.AnimationChipStackSelectedStart]:[],[v.e.AnimationChipStackSelectedEnd]:[],[v.e.AnimationChipBreakDownStart]:[],[v.e.AnimationChipBreakDownEnd]:[]},this.animating={tween:void 0,amount:0},this.lastUsedChip=0,this.chipBreakDownFinished=()=>{this.stopAnimating(),this.shadow&&n.tZ(this.scene,this.shadow),this.chipSelectorShouldBeUpdated()?this.updateAmount(this.amount):this.isChipStackEmpty(this.selectedChipStack)&&this.selectNonEmptyChipStack()},this.onHoverChipStack=(t,V)=>{if(V){const X=Number(V.name.split("-").pop()||this.chipList[0]),K=this.chipStacks[X];t===$.A.Over?this.isChipStackEmpty(X)?K.showTooltip(!0,{label:{translationId:"tooltip.balanceTooLow"},hasAnchor:!0}):X>_&&K.showTooltip(!0,{label:X.toString(),hasAnchor:!0}):t===$.A.Out&&K.hideTooltip()}},this.tooltipManager=t.tooltipManager,this.scene=t.scene,this.amount=t.amount,this.chipAmountsPerChipStack=q.h6(this.amount,t.chipList,W),this.scaling=t.scale?(new K.Pq).setAll(t.scale):K.Pq.One(),this.chipList=t.chipList.filter(((t,V)=>{let X=!(V>6);return V>5&&(X=X&&!!this.chipAmountsPerChipStack[t]),X})),this.meshName=t.namePrefix?`${t.namePrefix}.${y}`:y,this.plaqueDenomination=this.chipList[this.chipList.length-1]*W,this.maxAmountOnChipSelector=this.chipList.reduce(((t,V)=>t+V*W),0),this.mesh=this.createContainer(this.chipDimensions),this.buttons=this.initButtons(this.chipDimensions,this.chipList,this.mesh),this.mesh.scaling=this.scaling,t.isPlaqueEnabled&&t.plaqueSourceMesh&&(this.plaque=this.createPlaque(t.plaqueSourceMesh,t.layout,this.mesh,this.chipList.length,this.chipDimensions.diameter)),this.positionChipStacks(t.layout,this.chipList,this.chipDimensions.diameter),this.chipStacks=this.initChipStacks(this.chipList),this.chipStackHighlight=this.createChipHighlight(this.chipDimensions.diameter),A.J0.isLessThan(this.amount,this.chipList[0])&&this.chipStackHighlight.hide(),this.selectedChipStack=this.chipList[Math.floor(.5*this.chipList.length)],this.moveRingToSelectedStack(),this.createDisabledChips(this.buttons),this.tapEvent=I.i(t.scene,new C.C({callback:this.createOnTapChipStack(t.DS),target:()=>R.Nq(t.scene,`${this.meshName}-button-`),DS:t.DS})),t.DS.IS_DESKTOP&&(this.hoverEvent=I.i(t.scene,new $.t({callback:this.onHoverChipStack,target:t=>!!(null==t?void 0:t.name.includes(`${this.meshName}-button`)),DS:t.DS}))),this.renderChips()}on(t,V){this.eventMap[t].includes(V)||this.eventMap[t].push(V)}getSelectedChipStack(){return this.selectedChipStack}removeEvent(t,V){const X=this.eventMap[t].indexOf(V);-1!==X&&this.eventMap[t].splice(X,1)}dispose(){var t,V;this.isAnimating()&&this.stopAnimating(!0),null===(t=this.hoverEvent)||void 0===t||t.destroy(),this.tapEvent.destroy(),null===(V=this.plaque)||void 0===V||V.dispose();for(const t of Object.values(this.eventMap))t.length=0;for(const t of Object.values(this.chipStacks))t.dispose();for(const t of Object.values(this.buttons))t.dispose();this.chipStackHighlight.dispose()}updateAmount(t,V=!1){let X=V;const K=A.J0.subtract(t,this.amount);if(this.amount=t,this.lastUsedChip!==this.selectedChipStack&&this.chipStacks[this.lastUsedChip]&&t&&(this.selectedChipStack=this.lastUsedChip,this.moveRingToSelectedStack()),0!==K){A.J0.isLessThan(this.amount,this.chipList[0])?this.chipStackHighlight.hide():this.chipStackHighlight.show();const t=q.xv(this.chipAmountsPerChipStack,this.plaqueAmount,this.plaqueDenomination,K);for(const V of Object.keys(t.chips)){const K=V;this.chipAmountsPerChipStack[K]+=t.chips[K];const k=-this.chipAmountsPerChipStack[K]*K;(this.isAnimating()&&k>this.animating.amount||A.J0.isGreaterThan(this.animating.amount,this.amount)||t.plaque)&&(X=!0)}X?(this.renderChips(),this.stopAnimating(!0)):this.renderChipMeshes(this.chipAmountsPerChipStack)}if(!X){const t=this.chipList.find(((t,V)=>{const X=this.chipList[V+1];return this.chipAmountsPerChipStack[t]<=0&&this.chipAmountsPerChipStack[X]>0}));t?(this.breakPlaqueDown(),this.breakChipsDown(t)):(this.breakPlaqueDown(),this.mergeChipsToNextDenomination(),this.renderChipMeshes(this.chipAmountsPerChipStack),this.isChipStackEmpty(this.selectedChipStack)&&this.selectNonEmptyChipStack(this.selectedChipStack!==this.lastUsedChip))}}async hideChipSelector(t=!0){const V=this.mesh.scaling.clone(),{x:X,y:k,z:A}=V;0!==X&&0!==k&&0!==A&&(this.scaling=V,t?await F.K([{target:this.mesh,props:{scaling:K.Pq.Zero()}}],.1):this.mesh.scaling.setAll(0))}async showChipSelector(t=!0){t?await F.K([{target:this.mesh,props:{scaling:this.scaling}}],.1):this.mesh.scaling=this.scaling}getChipStackPositions(){return Object.keys(this.buttons).reduce(((t,V)=>(t[V]=this.buttons[V].getAbsolutePosition().clone(),t)),{})}getLocalChipStackPositions(){return Object.keys(this.buttons).reduce(((t,V)=>(t[V]=this.buttons[V].position.clone(),t)),{})}getChipStackTopChipsPositions(){return Object.keys(this.chipStacks).reduce(((t,V)=>(t[V]=this.chipStacks[V].getTopChipPosition(),t)),{})}getChipSelectorAmounts(){return Object.keys(this.chipStacks).reduce(((t,V)=>(t[V]=this.chipStacks[V].getChipAmounts().length,t)),{})}setChipsOrientationY(t){for(const V of Object.values(this.buttons))V.rotation.y=t}selectChipStack(t,V){this.updateSelectedChipStack(t,V)}addShadowLight(t){this.shadow=t;for(const V of Object.values(this.chipStacks))V.addShadowLight(t)}createChipHighlight(t){const V=new m.pl;return V.initMesh(t,this.mesh,this.mesh.name),V}updateSelectedChipStack(t,V=!1,X=!1){t!==this.selectedChipStack&&this.chipStacks[t]&&(this.lastUsedChip=t),t!==this.selectedChipStack&&this.chipStacks[t]&&!this.isChipStackEmpty(t)&&(this.selectedChipStack=t,this.moveRingToSelectedStack(),V&&!this.isAnimating()&&(this.notify({type:v.e.AnimationChipStackSelectedStart,payload:void 0}),this.animateSelectedChipStack(t,(()=>{this.notify({type:v.e.AnimationChipStackSelectedEnd,payload:void 0})}))),X&&this.notify({type:v.e.ChipStackSelected,payload:t}))}setDisabledChipsVisibility(t=.3){S.sC(t)}moveRingToSelectedStack(){const{position:t}=this.buttons[this.selectedChipStack.toString()];this.chipStackHighlight.updatePosition(t.clone())}renderChips(){const{chipSelectorAmount:t,plaqueAmount:V}=q.YO(this.amount,this.plaqueDenomination,this.maxAmountOnChipSelector);this.plaqueAmount=V,this.chipAmountsPerChipStack=q.h6(t,this.chipList,W),this.renderChipMeshes(this.chipAmountsPerChipStack),this.isChipStackEmpty(this.selectedChipStack)&&this.selectNonEmptyChipStack(),this.plaque&&(A.J0.isGreaterThan(V,0)?(this.plaque.setAmount(V),this.plaque.setEnabled(!0)):this.plaque.setEnabled(!1))}mergeChipsToNextDenomination(){this.chipList.forEach(((t,V)=>{var X;if(this.chipAmountsPerChipStack[t]>W){const K=Math.floor((this.chipAmountsPerChipStack[t]-1)/W);if(V===this.chipList.length-1){this.chipAmountsPerChipStack[t]-=W*K;const V=this.plaqueAmount+this.plaqueDenomination*K;null===(X=this.plaque)||void 0===X||X.setAmount(V)}else{const X=this.chipList[V+1],k=X/t;k!==Math.floor(k)?this.renderChips():(this.chipAmountsPerChipStack[X]+=K,this.chipAmountsPerChipStack[t]-=k*K)}}}))}breakPlaqueDown(){var t,V;const X=this.chipList[this.chipList.length-1];A.J0.isGreaterThan(this.plaqueAmount,0)&&this.chipAmountsPerChipStack[X]<=0&&(this.plaqueAmount=A.J0.subtract(this.plaqueAmount,this.plaqueDenomination),null===(t=this.plaque)||void 0===t||t.setAmount(this.plaqueAmount),0===this.plaqueAmount&&(null===(V=this.plaque)||void 0===V||V.setEnabled(!1)),this.chipAmountsPerChipStack[X]+=this.plaqueDenomination/X,this.renderChipMeshes(this.chipAmountsPerChipStack),this.chipSelectorShouldBeUpdated()&&this.updateAmount(this.amount))}breakChipsDown(t){if(this.isAnimating())return;const V=this.chipList.indexOf(t),X=this.chipList[V+1]||null;if(X&&this.chipAmountsPerChipStack[X]>0){const V=Math.floor(W*t/X),K=Math.min(V,this.chipAmountsPerChipStack[X]),k=X*K/t;if(k!==Math.floor(k)||k>W||!k)this.renderChips(),this.stopAnimating();else{const A=this.chipStacks[X],$=R.NV(A),I=S.hU($.x);this.chipAmountsPerChipStack[X]=Math.max(this.chipAmountsPerChipStack[X]-V,0);const C=c.FU(X,t,A,this.chipStacks[t],K,0,I,(()=>{this.renderChipMeshes(this.chipAmountsPerChipStack),this.chipBreakDownFinished(),this.notify({type:v.e.AnimationChipBreakDownEnd,payload:void 0})}),this.chipBreakDownFinished,this.shadow);this.chipAmountsPerChipStack[t]+=k,this.shadow&&n.Al(this.scene,this.shadow),this.startAnimating(K*X,C),this.notify({type:v.e.AnimationChipBreakDownStart,payload:void 0}),C.play()}}else this.chipBreakDownFinished()}startAnimating(t,V){this.animating.amount=t,this.animating.tween=V}chipSelectorShouldBeUpdated(){return q.lX(this.chipList,this.chipAmountsPerChipStack,this.plaqueAmount,this.amount)}stopAnimating(t=!1){this.animating.tween&&t&&this.animating.tween.stop(),this.animating.tween=void 0,this.animating.amount=0}renderChipMeshes(t){for(const V of this.chipList){const X=V*t[V];X!==this.chipStacks[V].getAmount()&&this.chipStacks[V].setAmount(X)}}isAnimating(){return 0!==this.animating.amount}initChipStacks(t){return t.reduce(((t,V)=>(t[V.toString()]=new N.XB({name:`${this.meshName}-${E}-${V}`,chipAmounts:[V],parent:this.buttons[V.toString()],scale:D,isPickable:!0,tooltipManager:this.tooltipManager}),t)),{})}createPlaque(t,V,X,k,A){const $=S.zb(t);R.RE($.mesh,K.Pq.Up()),$.mesh.parent=X;const I="function"==typeof V.plaqueTransformData?V.plaqueTransformData(k,A,$.getSize()):V.plaqueTransformData;return $.mesh.position.copyFrom(I.position),$.mesh.rotation.copyFrom(I.rotation),$.mesh.scaling.copyFrom(I.scaling),$.setAmount(0),$}notify(t){for(const V of this.eventMap[t.type])V(t)}createOnTapChipStack(t){return(V,X)=>{if(V===C.z.End&&X){const V=Number(X.name.split("-").pop()||this.chipList[0]);this.updateSelectedChipStack(V,!0,!0),!t.IS_DESKTOP&&this.isChipStackEmpty(V)&&this.chipStacks[V].showTooltip(!0,{label:{translationId:"tooltip.balanceTooLow"},hasAnchor:!1})}}}initButtons(t,V,X){const K={size:1,width:t.diameter,depth:t.diameter,height:8*t.height};let A;return V.reduce(((t,V,$)=>{let I;return $?I=A.createInstance(`${this.meshName}-button-${V}`):(A=k.Jo.CreateBox(`${this.meshName}-button-${V}`,K,this.scene),A.visibility=0,I=A),I.enablePointerMoveEvents=!0,I.parent=X,t[V.toString()]=I,t}),{})}positionChipStacks(t,V,X){const{getChipStackPosition:K}=t;V.forEach(((t,k)=>{this.buttons[t].position=K(k,V.length,X)}))}isChipStackEmpty(t){return 0===this.chipAmountsPerChipStack[t]&&this.animating.amount<t}selectNonEmptyChipStack(t=!0){const V=q.K3(this.chipList,this.chipAmountsPerChipStack);V&&this.updateSelectedChipStack(V,t,!0)}createContainer(t){const V=this.chipList.length,X={size:1,width:t.diameter*V+Z*(V-1),depth:t.diameter,height:8*t.height},K=k.Jo.CreateBox(this.meshName,X,this.scene);return K.isPickable=!1,K.isVisible=!1,K}createDisabledChips(t){const V=Object.keys(t).reduce(((V,X)=>{const K=t[X],k=Number(X),A=S.zk(`${this.meshName}-disabled-${k}`,k,S.Iy.ChipSelectorDisabled);return A.mesh.parent=K,A.mesh.scaling.setAll(D),A.mesh.isPickable=!1,V[X]=A,V}),{});return this.setDisabledChipsVisibility(),V}animateSelectedChipStack(t,V){const X=this.chipStacks[t].getChips(),K=X[X.length-1];this.scene.stopAnimation(K.mesh);const k=K.mesh.position.clone(),A=K.mesh.rotation.clone(),$=c.kZ(K);this.scene.beginDirectAnimation(K.mesh,$,0,s.vu($),!1,1,(()=>{K.mesh&&(K.mesh.position=k,K.mesh.rotation=A),V&&V(t)}))}}},884084:(t,V,X)=>{X.d(V,{XB:()=>N,Xp:()=>s});var K=X(948733),k=X(898973),A=X(771528),$=X(523737),I=X(275866),C=X(433161),n=X(74643),q=X(328910),R=X(27230);class F extends R.e{constructor(t){super(t.name,t.scene),this.tooltipManager=t.tooltipManager,this.tooltipText=t.tooltipText,this.initTooltip()}showTooltip(t,V){var X;null===(X=this.tooltip)||void 0===X||X.show(!0,V)}hideTooltip(){var t;null===(t=this.tooltip)||void 0===t||t.hide()}initTooltip(){this.tooltipManager&&(this.tooltip=this.tooltipManager.addTooltip({id:`${this.name}.tooltip`,parent:this,content:{label:this.tooltipText||""},autoHide:!0}))}}var s,S=X(32035);(function(t){t[t["TotalAmount"]=1]="TotalAmount",t[t["Standard"]=2]="Standard"})(s||(s={}));const c="chipStackItem";class N extends F{constructor(t){var V;super(t),this.chipScale=1;const{name:X,chipAmounts:k,parent:A=null,labels:$=s.Standard,group:I=S.Iy.Standard,scale:C=1,isPickable:n=!1,maxChipsCount:q=1/0}=t;this.chips=[],this.availableAmounts=[...k],this.amount=0,this.labels=$,this.group=I,this.name=X,this.parent=A,this.isPickable=n,this.maxChipsCount=q,1!==C&&this.scaleChips(C),null===(V=this.tooltip)||void 0===V||V.mesh.position.addInPlace(new K.Pq(0,0,3))}initTopChip(){this.labels===s.TotalAmount&&(this.topChip||this.createTopChip())}getAmount(){return this.amount}getChips(){return this.chips}detachChips(t=this.chips.length){const V=Math.min(this.chips.length,t),X=V>0?this.chips.slice(-V):[];if(V>0){for(const t of X){const V=t.mesh.getAbsolutePosition();this.removeChild(t.mesh),t.mesh.setAbsolutePosition(V)}this.topChip&&(this.topChip=void 0),this.chips.length-=V}return X}getAvailableAmounts(){return this.availableAmounts.slice()}getChipAmounts(){const t=C.xG(this.amount,this.availableAmounts);return t.splice(0,t.length-this.maxChipsCount),t}setAmount(t,V){this.amount=t,V&&(this.labels=V),this.topChip&&!this.topChip.isDisposed()||!$.J0.isGreaterThan(this.amount,0)||this.labels!==s.TotalAmount||this.createTopChip(),this.disposeChips(),this.shadow&&this.removeShadowCasters(this.shadow),$.J0.isGreaterThan(this.amount,0)?(this.createChips(this.amount,this.labels,this.group),this.labels===s.TotalAmount&&this.topChip?(this.topChip.isVisible=!0,this.topChip.setAmount(this.amount)):this.topChip&&(this.topChip.isVisible=!1),this.positionChips(this.chips),this.shadow&&this.addShadowCasters(this.shadow)):this.topChip&&(this.topChip.isVisible=!1)}scaleChips(t){this.chipScale!==t&&(this.chipScale=t,this.scaling.setAll(t))}freezeWorldMatrix(){return super.freezeWorldMatrix(),this.chips.forEach((t=>t.freezeWorldMatrix())),this.topChip&&this.topChip.freezeWorldMatrix(),this}unfreezeWorldMatrix(){return super.unfreezeWorldMatrix(),this.chips.forEach((t=>t.unfreezeWorldMatrix())),this.topChip&&this.topChip.unfreezeWorldMatrix(),this}dispose(){this.shadow&&this.removeShadowCasters(this.shadow),this.disposeChips(),this.topChip&&(this.chips=[],this.topChip.dispose(),this.topChip=void 0),this.availableAmounts=void 0,super.dispose()}getTopChipPosition(){const t=this.getChips();return 0===t.length?this.getAbsolutePosition().clone():t[t.length-1].mesh.getAbsolutePosition().clone()}getTopChip(){return this.topChip}getChipGroup(){return this.group}updateGroup(t){this.group=t,this.setAmount(this.amount,this.labels)}addShadowLight(t){this.shadow&&this.shadow===t||(this.shadow&&this.removeShadowCasters(t),this.shadow=t,$.J0.isGreaterThan(this.amount,0)&&this.addShadowCasters(t))}positionChips(t){const V=t.length;let X,K,k=0,A=0;for(let $=0;$<V;$++)X=t[$],0===k&&(K=X.getSize(),k=K.y,A=K.x),X.mesh.position.set(C.jE($+1,A),(k+.05*k)*$+k/2,C.jE($+1,A,!0)),$!==V-1&&(X.mesh.rotation.y=C.s8($+1)),X.mesh.parent=this}animateTopChip(){var t;(null===(t=this.topChip)||void 0===t?void 0:t.mesh.material)&&(this.topChip.mesh.material.alpha=I.Y(A.er,performance.now()))}createTopChip(){this.topChip=function(t,V,X,K=!1,k=!1){const A=S._O(`${V}-${t}-top-chip`);return A.mesh.parent=X,A.isVisible=!1,A.mesh.renderingGroupId=X.renderingGroupId,A.mesh.isPickable=K,k&&(A.isGhost=!0,A.mesh.material&&(A.mesh.material.needDepthPrePass=!0)),A}(this.name,this.amount,this,this.isPickable)}createChips(t,V,X){const K=C.xG(t,this.availableAmounts);this.labels===s.TotalAmount&&(K.reverse(),K.pop());const A=this.labels===s.TotalAmount?1:0;K.splice(0,K.length-this.maxChipsCount+A);for(let t=0;t<K.length;t++){const V=K[t],A=S.zk(`${V}-${this.name}-${c}-${t}-${k.S0.RandomId()}`,V,X);A.isPickable=this.isPickable,n.B$(A.mesh,this.renderingGroupId),this.chips.push(A)}V===s.TotalAmount&&this.topChip&&this.chips.push(this.topChip)}disposeChips(){for(const t of this.chips)t&&t!==this.topChip&&t.dispose();this.chips.length=0}addShadowCasters(t){q.jN(this,t,!0)}removeShadowCasters(t){q.PP(this,t,!0)}}},10783:(t,V,X)=>{X.d(V,{pl:()=>n});var K=X(32138),k=X(948733),A=X(922002),$=X(74643);const I="selected-stack-highlight",C="selected-stack-torus";class n{initMesh(t,V,X){if(this.ring)return;const n=V.getScene(),q=1.2*t,R=t/58,F=new K.F("selected-stack-ring-material",n);F.diffuseColor.set(255,255,0),F.emissiveColor.set(255,255,0);const s=A.vt.CreateTorus(`${X}.${C}`,{thickness:q/32,tessellation:32,diameter:q},n);s.parent=V,s.isPickable=!1,s.scaling=new k.Pq(1,.001,1),s.material=F,s.rotation.x=Math.PI,s.receiveShadows=!0,s.position.y+=R,$.RE(s,new k.Pq(0,1,0));const S=A.vt.CreateTorus(`${X}.${I}`,{thickness:q/10,tessellation:32,diameter:q},n);S.parent=s,S.isPickable=!1,S.scaling=new k.Pq(1,.001,1),S.visibility=.25,S.receiveShadows=!0,S.material=F,S.position.y+=R,this.ring=s,this.highlight=S}dispose(){this.ring.dispose()}updatePosition(t){this.ring.position=t}getSize(){return $.Ts(this.ring,!0)}show(){this.ring.isVisible=!0,this.highlight.isVisible=!0}hide(){this.ring.isVisible=!1,this.highlight.isVisible=!1}}},631693:(t,V,X)=>{X.d(V,{$N:()=>$.$N,IW:()=>$.IW,Iy:()=>K.Iy,WN:()=>K.WN,XB:()=>A.XB,Xp:()=>A.Xp,ed:()=>k.e,hU:()=>K.hU});var K=X(32035),k=X(719080),A=X(884084),$=X(682710)},719080:(t,V,X)=>{var K;X.d(V,{e:()=>K}),function(t){t["ChipStackSelected"]="chip-stack-selected",t["AnimationChipStackSelectedStart"]="animation-chip-stack-selected-start",t["AnimationChipStackSelectedEnd"]="animation-chip-stack-selected-end",t["AnimationChipBreakDownStart"]="animation-chip-break-down-start",t["AnimationChipBreakDownEnd"]="animation-chip-break-down-end"}(K||(K={}))},608178:(t,V,X)=>{X.d(V,{v:()=>I});var K=X(948733),k=X(633727),A=X(898973),$=X(609859);class I{constructor(t){var V,X;this.needsUpdate=!0,this.currentPosition=K.Pq.Zero(),this.markAsNeedsUpdate=()=>{this.needsUpdate=!0},this.onAfterRender=()=>{this.mesh.isEnabled()&&this.mesh.computeWorldMatrix(),this.needsUpdate&&(this.updateHTMLElement(),this.needsUpdate=!1)},this.id=null!==(V=t.id)&&void 0!==V?V:A.S0.RandomId(),this.scene=t.scene,this.mesh=new k.V(`${this.getNamePrefix()}-${this.id}`,this.scene),this.mesh.setEnabled(!1),this.transportEmitters=t.transportEmitters,this.cameraManager=t.cameraManager,this.addReverseScale=null===(X=t.addReverseScale)||void 0===X||X,this.transportEmitters.add({id:this.id,content:t.content}),this.subscribePositionUpdate(),this.scene.registerAfterRender(this.onAfterRender)}show(){this.mesh.setEnabled(!0),this.updateHTMLElement()}hide(){this.mesh.setEnabled(!1),this.updateHTMLElement()}updateContentProps(t){this.transportEmitters.updateContent({id:this.id,content:t})}dispose(){this.unsubscribePositionUpdate(),this.transportEmitters.remove(this.id),this.mesh.dispose()}isVisible(){return!!this.currentVisibility}subscribePositionUpdate(){this.unsubscribeFromCameraMovement=this.cameraManager.subscribeOnCameraMovement(this.markAsNeedsUpdate),this.mesh.onAfterWorldMatrixUpdateObservable.add(this.markAsNeedsUpdate),this.scene.getEngine().onResizeObservable.add(this.markAsNeedsUpdate)}unsubscribePositionUpdate(){var t;null===(t=this.unsubscribeFromCameraMovement)||void 0===t||t.call(this),this.mesh.onAfterWorldMatrixUpdateObservable.removeCallback(this.markAsNeedsUpdate),this.scene.getEngine().onResizeObservable.removeCallback(this.markAsNeedsUpdate)}updateHTMLElement(){const t=this.mesh.isEnabled();if(this.currentVisibility!==t&&(this.currentVisibility=t,this.transportEmitters.updateVisibility({id:this.id,isVisible:t})),t){const t=this.getPositionOnScreen();this.currentPosition.equals(t)||(this.currentPosition.copyFrom(t),this.transportEmitters.updatePosition({id:this.id,positionX:t.x,positionY:t.y}))}}getPositionOnScreen(){return $.$1($._L(this.mesh.getAbsolutePosition(),this.scene,!0,this.addReverseScale),2)}getNamePrefix(){return"HTMLMesh"}}},963419:(t,V,X)=>{X.d(V,{E:()=>n});var K=X(64922),k=X(699695),A=X(377810);function $(t,V){return`translate3d(${t}px, ${V}px, 0)`}const I="htmlMeshContainer--034fa",C="htmlMeshElement--fa4f7";class n extends A.Component{constructor(t){super(t),this.elementsData={},this.onAddElement=t=>{this.elementsData[t.id]={position:$(0,0),opacity:"0",registerElement:this.registerElement.bind(this,t.id)},this.setState((V=>({elements:[...V.elements,{id:t.id,props:t.content}]})))},this.onRemove=t=>{this.setState((V=>({elements:V.elements.filter((V=>V.id!==t))}))),delete this.elementsData[t]},this.onUpdatePosition=t=>{const V=$(t.positionX,t.positionY);this.elementsData[t.id].position=V;const X=this.elementsData[t.id].htmlElement;X&&(X.style.transform=V)},this.onUpdateVisibility=t=>{const V=t.isVisible?"1":"0";this.elementsData[t.id].opacity=V;const X=this.elementsData[t.id].htmlElement;X&&(X.style.opacity=V)},this.onUpdateContent=t=>{this.setState((V=>{for(const X of V.elements)if(X.id===t.id){Object.assign(X.props,t.content);break}return V}))},this.state={elements:[]},this.unsubscribers=[t.onAdd(this.onAddElement),t.onRemove(this.onRemove),t.onUpdatePosition(this.onUpdatePosition),t.onUpdateVisibility(this.onUpdateVisibility),t.onUpdateContent(this.onUpdateContent)]}render(){const{Element:t,elementClassName:V}=this.props,{elements:X}=this.state;return K.jsx("div",{className:I,children:X.map((X=>K.jsx("div",{ref:this.elementsData[X.id].registerElement,className:k.A(C,V),children:K.jsx(t,{...X.props})},X.id)))})}componentWillUnmount(){for(const t of this.unsubscribers)t();this.elementsData={}}registerElement(t,V){if(null!==V){const X=this.elementsData[t];X.htmlElement=V,V.style.transform=X.position,V.style.opacity=X.opacity}}}},662519:(t,V,X)=>{X.d(V,{vh:()=>k.v,Eh:()=>I.E,e$:()=>$});var K,k=X(608178),A=X(93199);function $(){const t=new A.Z;function V(V,X){const K=t=>{t.type===V&&X(t.payload)};return t.onValue(K),()=>t.offValue(K)}return{observables:{onAdd:t=>V(K.Add,t),onRemove:t=>V(K.Remove,t),onUpdatePosition:t=>V(K.UpdatePosition,t),onUpdateVisibility:t=>V(K.UpdateVisibility,t),onUpdateContent:t=>V(K.UpdateContent,t)},emitters:{add(V){t.emit({type:K.Add,payload:V})},remove(V){t.emit({type:K.Remove,payload:V})},updatePosition(V){t.emit({type:K.UpdatePosition,payload:V})},updateVisibility(V){t.emit({type:K.UpdateVisibility,payload:V})},updateContent(V){t.emit({type:K.UpdateContent,payload:V})}},dispose(){t.end()}}}(function(t){t["Add"]="Add",t["Remove"]="Remove",t["UpdatePosition"]="UpdatePosition",t["UpdateVisibility"]="UpdateVisibility",t["UpdateContent"]="UpdateContent"})(K||(K={}));var I=X(963419)},414945:(t,V,X)=>{X.d(V,{h:()=>I});var K=X(908059),k=X(717437),A=X(26543);let $;class I{constructor(t,V,X,I,C=K.z){var n,q;this.isEnabled=!0,this.segmentUpdates=[],this.playLightningAnimation=this.playLightningAnimation.bind(this),this.scene=t,this.endPoint=X,this.startPoint=V,this.options={...k.V1(I),segmentUpdateFrequencies:null!==(n=I.segmentUpdateFrequencies)&&void 0!==n?n:[],freezeAnimations:null!==(q=I.freezeAnimations)&&void 0!==q&&q},this.segmentUpdates=this.options.segmentUpdateFrequencies.map((t=>({iterationNumber:t.iterationNumber,updateDuration:1e3/t.updatesPerSecond,timeSinceLastUpdate:0}))).sort(((t,V)=>t.iterationNumber-V.iterationNumber)),this.lightningFractals=this.options.freezeAnimations?$:A.Q(V,X,this.options);const R=k.dA(t,this.lightningFractals,this.options,C);this.lightningBranches=this.lightningFractals.map(((t,V)=>({pointPositions:t.points,sequenceNumber:t.sequenceNumber,tube:R[V]}))),this.disable()}changeLightningColor(t){this.lightningBranches.forEach((V=>{k.ie(V.tube,this.scene,t)}))}dispose(){this.cancelAnimation(),this.lightningBranches.forEach((t=>{t.tube.dispose()}))}startAnimation(){this.enable(),this.show(),this.scene.registerBeforeRender(this.playLightningAnimation)}stopAnimation(){this.scene.unregisterBeforeRender(this.playLightningAnimation),this.disable()}cancelAnimation(){this.stopAnimation()}setParent(t){for(const V of this.lightningBranches)V.tube.parent=t}setRenderingGroup(t){for(const V of this.lightningBranches)V.tube.renderingGroupId=t}moveTo(t,V){this.enable(),this.startPoint=t,this.endPoint=V;const X=this.options.freezeAnimations?$:this.getNewLightningPoints(),K=this.lightningBranches.length;for(let t=0;t<K;t++)this.lightningBranches[t].pointPositions=X[t].points,k.fd(this.scene,this.lightningBranches[t].tube,X[t].points)}enable(){if(!this.isEnabled){for(const t of this.lightningBranches)t.tube.unfreezeWorldMatrix(),t.tube.setEnabled(!0);this.isEnabled=!0}}disable(){if(this.isEnabled){this.hide();for(const t of this.lightningBranches)t.tube.freezeWorldMatrix(),t.tube.setEnabled(!1);this.isEnabled=!1}}show(){const t=this.lightningBranches.length;for(let V=0;V<t;V++)this.showBranch(this.lightningBranches[V])}hide(){const t=this.lightningBranches.length;for(let V=0;V<t;V++)this.hideBranch(this.lightningBranches[V])}showBranch(t){t.tube.isVisible=!0}hideBranch(t){t.tube.isVisible=!1}flickerLightning(){const t=this.getNewLightningPoints(),V=this.lightningBranches.length;for(let X=0;X<V;X++)k.fd(this.scene,this.lightningBranches[X].tube,t[X].points),this.lightningBranches[X].pointPositions=t[X].points}getNewLightningPoints(){return this.segmentUpdates.length?this.partiallyUpdatePoints():this.lightningFractals=this.options.freezeAnimations?$:A.Q(this.startPoint,this.endPoint,this.options),this.lightningFractals}playLightningAnimation(){this.flickerLightning()}partiallyUpdatePoints(){let t;const V=this.scene.getEngine().getDeltaTime();for(const X of this.segmentUpdates)X.timeSinceLastUpdate+=V,X.timeSinceLastUpdate>=X.updateDuration&&(void 0===t||X.iterationNumber<t)&&(t=X.iterationNumber),X.timeSinceLastUpdate%=X.updateDuration;if(void 0!==t){const V={...this.options,existingLightningPoints:{branches:this.lightningFractals,updateAfterIteration:t}};this.lightningFractals=this.options.freezeAnimations?$:A.Q(this.startPoint,this.endPoint,V)}}}},506855:(t,V,X)=>{X.d(V,{$:()=>C});var K,k=X(908059),A=X(414945),$=X(717437);(function(t){t[t["Expanding"]=1]="Expanding",t[t["Flickering"]=2]="Flickering",t[t["Shrinking"]=3]="Shrinking",t[t["Stopped"]=4]="Stopped"})(K||(K={}));const I=60;class C extends A.h{constructor(t,V,X,A,I=k.z){var C;super(t,V,X,A,I),this.currentFrame=0,this.animationStatus=K.Stopped,this.options={...$.V1(A),segmentUpdateFrequencies:null!==(C=A.segmentUpdateFrequencies)&&void 0!==C?C:[],expandTime:A.expandTime||0,shrinkTime:A.shrinkTime||0,flickerWhenStriking:A.flickerWhenStriking||!1}}startAnimation(t){return new Promise((V=>{this.enable(),this.currentFrame=0,this.animationStatus=K.Expanding,this.onHitCallback=()=>{null==t||t(),V()},this.scene.registerBeforeRender(this.playLightningAnimation)}))}stopAnimation(t){return this.animationStatus!==K.Flickering&&this.animationStatus!==K.Expanding?Promise.resolve():new Promise((V=>{this.onStopCallback=()=>{null==t||t(),V()},this.currentFrame=0,this.animationStatus=K.Shrinking}))}cancelAnimation(){this.animationStatus!==K.Stopped&&(this.animationStatus=K.Stopped,this.scene.unregisterBeforeRender(this.playLightningAnimation),this.hide(),this.currentFrame=0,this.disable(),this.onStopCallback&&(this.onStopCallback(),this.onStopCallback=void 0),this.onHitCallback&&(this.onHitCallback=void 0))}playLightningAnimation(){switch(this.currentFrame+=Math.round(this.scene.getAnimationRatio()),this.animationStatus){case K.Expanding:this.expandLightning();break;case K.Flickering:this.flickerLightning();break;case K.Shrinking:this.shrinkLightning()}}expandLightning(){var t;const V=this.getFrameCount(this.options.expandTime),X=null!==(t=window.freezeAnimations)&&void 0!==t&&t;this.currentFrame<V?this.setLightningExpansionFrame(this.currentFrame,V):(X||(this.animationStatus=K.Flickering,this.resetBoltSize(),this.show(),this.currentFrame=0),this.onHitCallback&&(this.onHitCallback(),this.onHitCallback=void 0))}setLightningExpansionFrame(t,V){var X;const K=t/V,k=null!==(X=window.freezeAnimations)&&void 0!==X&&X,A=k?30:Math.floor(this.lightningBranches[0].pointPositions.length*K);this.options.flickerWhenStriking&&this.updateLightningPoints();const I=this.lightningBranches.length;for(let t=0;t<I;t++){const V=this.lightningBranches[t];if(V.sequenceNumber<A&&(this.showBranch(V),!k)){const t=[],X=V.pointPositions.length;for(let K=0;K<X;K++){const X=V.sequenceNumber+K<A?V.pointPositions[K]:V.pointPositions[A-V.sequenceNumber];t.push(X)}$.fd(this.scene,V.tube,t)}}}shrinkLightning(){var t;const V=this.getFrameCount(this.options.shrinkTime),X=null!==(t=window.freezeAnimations)&&void 0!==t&&t;V&&this.currentFrame<V&&!X?this.setLightningShrinkingFrame(this.currentFrame,V):this.cancelAnimation()}setLightningShrinkingFrame(t,V){this.options.flickerWhenStriking&&this.updateLightningPoints();const X=t/V,K=Math.floor(this.lightningBranches[0].pointPositions.length*X),k=this.lightningBranches.length;for(let t=0;t<k;t++){const V=this.lightningBranches[t];if(V.sequenceNumber+V.pointPositions.length>K){const t=[],X=V.pointPositions.length;for(let k=0;k<X;k++){const X=V.sequenceNumber+k>K?V.pointPositions[k]:V.pointPositions[K-V.sequenceNumber];t.push(X)}$.fd(this.scene,V.tube,t)}else this.hideBranch(V)}}updateLightningPoints(){const t=this.getNewLightningPoints();this.lightningBranches.forEach(((V,X)=>{V.pointPositions=t[X].points}))}getFrameCount(t){return t*I}resetBoltSize(){for(const t of this.lightningBranches)$.fd(this.scene,t.tube,t.pointPositions)}}},908059:(t,V,X)=>{X.d(V,{z:()=>K});const K="lightning-lines-"},729899:(t,V,X)=>{X.d(V,{$0:()=>K.$});var K=X(506855)},717437:(t,V,X)=>{X.d(V,{V1:()=>R,dA:()=>F,fd:()=>c,ie:()=>N});var K=X(32138),k=X(948733),A=X(149445),$=X(815781),I=X(898973),C=X(614203),n=(X(609859),X(26543));const q={color:new k.ov(1,1,.5,1),branchMinimumOpacity:.25,thickness:1,branchOpacityEasingPower:1};function R(t){return{...q,...t,...n.wt(C.A(t,Object.keys(n.pn)))}}function F(t,V,X,K){const{color:C,branchOpacityEasingPower:n,branchMinimumOpacity:q,segmentSplitCount:R,thickness:F}=X;return V.map(((V,X)=>{const c=function(t,V,X,K){const k=V-1;return X+(1-X)*((k-t)/k)**K}(V.branchLevel,R,q,n),N={path:V.points,radius:F*c,tessellation:3,updatable:!0},m=$.a.CreateTube(`${K}${X}-${I.S0.RandomId()}`,N,t),v=new k.ov(C.r,C.g,C.b,C.a*c),W=new Array(V.points.length).fill(v);m.updateVerticesData(A.R.ColorKind,W),m.freezeNormals();const Z=s(v),D=t.getMaterialByName(Z);return D?m.material=D:(m.material=S(Z,C,t),m.material.freeze()),m}))}function s(t){return`lightningMaterial-rgba${t.r};${t.g};${t.b};${t.a}`}function S(t,V,X){const A=new K.F(t,X);return A.emissiveColor=new k.v9(V.r,V.g,V.b),A}function c(t,V,X){$.a.CreateTube(V.name,{path:X,instance:V},t)}function N(t,V,X){var K,A;const $=null!==(A=null===(K=t.material)||void 0===K?void 0:K.alpha)&&void 0!==A?A:1,I=new k.ov(X.r,X.g,X.b,$),C=s(I),n=V.getMaterialByName(C);t.material=n||S(C,I,V)}},26543:(t,V,X)=>{X.d(V,{Q:()=>n,pn:()=>$,wt:()=>I});var K=X(948733),k=X(615473),A=X(609859);const $={segmentSplitCount:5,branchProbability:0,branchProportion:.7,minIterationForBranchGeneration:0,maxDeviation:.125,waypoints:[],waypointDeviation:0,deviationReductionIteration:0,minimumPositions:{x:-1/0,y:-1/0,z:-1/0},maximumPositions:{x:1/0,y:1/0,z:1/0},branchSeed:0,existingLightningPoints:void 0};function I(t){return{...$,...t}}class C{constructor(t){this.results=[0,.3,.7,.4,.6,.2,.8,.1,.9,.5],this.index=Math.floor(10*t)}generate(){return this.index=this.index===this.results.length-1?0:this.index+1,this.results[this.index]}advanceIndex(t){this.index=(this.index+t)%this.results.length}}function n(t,V,X){var k;const{segmentSplitCount:A,branchProportion:$,maxDeviation:n,deviationReductionIteration:R,waypoints:S,waypointDeviation:c,minimumPositions:N,maximumPositions:m,branchProbability:v,branchSeed:W,existingLightningPoints:Z,minIterationForBranchGeneration:D}=I(X),y=function(t,V,X,k){const A=K.Pq.Center(t,V),$=[];for(const t of X){const V=A.add(t);$.push(s(V,k))}return $}(t,V,S,c);let E=Z?function(t,V){const{branches:X,updateAfterIteration:K}=t,k=[];for(const t of X)t.branchLevel<=K&&k.push(t);const A=V-K,$=2**A,I=[];for(const t of k){const V=[];for(let X=0;X<t.points.length;X++)X%$||V.push(t.points[X]);I.push({branchLevel:t.branchLevel,sequenceNumber:t.sequenceNumber/2**A,points:V})}return I}(Z,A):[{branchLevel:0,sequenceNumber:0,points:[t,...y,V]}];const _={splitPointDeviation:n,minimumPositions:N,maximumPositions:m},p=new C(W||0),L={branchProbability:v,branchGenerator:p,minIterationForBranchGeneration:D};Z&&(function(t,V,X){let K=0;for(const t of V){const V=0===t.branchLevel?0:1;let k=t.points.length-1;for(let t=0;t<X&&(k*=.5,!(k<V));t++)K+=k}t.advanceIndex(K)}(p,E,Z.updateAfterIteration),_.splitPointDeviation=function(t,V,X){return X>=V?t/2**(X+1-V):t}(_.splitPointDeviation,R,Z.updateAfterIteration));for(let t=null!==(k=null==Z?void 0:Z.updateAfterIteration)&&void 0!==k?k:0;t<A;t++){const V=[];for(const X of E){X.sequenceNumber*=2;const{points:K,pointsWithNewBranch:k}=q(X,t,_,L);X.points=K;for(const X of k)V.push({sequenceNumber:X.sequenceNumber,branchLevel:t+1,points:F(X.previousPointPosition,X.position,$)})}E=E.concat(V),_.splitPointDeviation/=R>t+1?1:2}return E}function q(t,V,X,K){const k=t.points.length,A=[],$=[];for(let I=0;I<k;I++){const C=t.points[I];if(A.push(C),I+1<k){const{newPoint:k,newBranch:C}=R(t,V,I,X,K);A.push(k),C&&$.push(C)}}return{points:A,pointsWithNewBranch:$}}function R(t,V,X,k,A){const $=t.points[X],I=function(t,V,X){const k=K.Pq.Center(t,V),{splitPointDeviation:A,minimumPositions:$,maximumPositions:I}=X;return s(k,A,$,I)}($,t.points[X+1],k),C={newPoint:I,newBranch:void 0};return function(t,V){const{branchGenerator:X,branchProbability:K,minIterationForBranchGeneration:k}=t;return X.generate()<K&&V>=k}(A,V)&&(C.newBranch={sequenceNumber:t.sequenceNumber+2*X+1,previousPointPosition:$,position:I}),C}function F(t,V,X){const K=V.subtract(t).multiplyByFloats(X,X,X),k=V.add(K);return[V,k]}function s(t,V,X,$){const I=Math.random()*A.qy,C=Math.random()*A.qy,n=t.x+V*Math.cos(I)*Math.sin(C),q=t.y+V*Math.sin(I)*Math.sin(C),R=t.z+V*Math.cos(C);return X&&$?new K.Pq(k.X.Clamp(n,X.x,$.x),k.X.Clamp(q,X.y,$.y),k.X.Clamp(R,X.z,$.z)):new K.Pq(n,q,R)}},678489:(t,V,X)=>{X.d(V,{m:()=>A});var K=X(710928),k=X(608178);class A extends k.v{constructor(t){var V;super({...t,content:{...t.content,onTransitionEnd:V=>{var X,K;null===(K=(X=t.content).onTransitionEnd)||void 0===K||K.call(X,V),this.onTransitionEnd(V)}}}),this.onTransitionEnd=t=>{t||super.hide()},this.onAutoHide=()=>{this.hide()},this.autoHide=null!==(V=t.autoHide)&&void 0!==V&&V}show(t,V={}){this.clearAutoHideDelay(),super.show(),V.isVisible=!0,this.updateContentProps(V),(t||this.autoHide)&&(this.autoHideDelay=setTimeout(this.onAutoHide,K.p_))}hide(){this.updateContentProps({isVisible:!1}),this.clearAutoHideDelay()}dispose(){super.dispose(),this.clearAutoHideDelay()}getNamePrefix(){return"TooltipMesh"}clearAutoHideDelay(){clearTimeout(this.autoHideDelay),this.autoHideDelay=void 0}}},887374:(t,V,X)=>{X.d(V,{J:()=>K});class K{constructor(t){this.tooltipData=[],this.createTooltip=t.createTooltip}addTooltip(t,V){const X=this.createTooltip(t);return this.tooltipData.push({id:t.id,tooltip:X,group:V}),X}disposeTooltip(t){const V=this.tooltipData.findIndex((V=>"string"==typeof t?V.id===t:V.tooltip===t));if(-1!==V){const{tooltip:t}=this.tooltipData[V];t.dispose(),this.tooltipData.splice(V,1)}}hideTooltipsByGroup(t){for(const V of this.tooltipData)V.group===t&&V.tooltip.hide()}hideAllTooltips(){for(const t of this.tooltipData)t.tooltip.hide()}dispose(){for(const t of this.tooltipData)t.tooltip.dispose();this.tooltipData.length=0}}},244853:(t,V,X)=>{X.d(V,{h:()=>C});var K=X(64922),k=(X(377810),X(963419)),A=X(346160),$=X(710928);const I=t=>{const{label:V,horizontalPosition:X=$.hV.Center,verticalPosition:k=$.Ne.Top,isVisible:I=!1,hasAnchor:C=!1,onTransitionEnd:n}=t,q=function(t){return"object"==typeof t&&"translationId"in t}(V)?A.Tl(V.translationId):V;return K.jsx($.m_,{horizontalPosition:X,verticalPosition:k,isVisible:I,label:q,onTransitionEnd:n,hasAnchor:C})},C=t=>K.jsx(k.E,{Element:I,...t})},152103:(t,V,X)=>{X.d(V,{k:()=>k});var K=X(678489);function k(t){return V=>{const X=new K.m({id:V.id,scene:t.scene,cameraManager:t.cameraManager,transportEmitters:t.emitters,content:V.content,autoHide:V.autoHide});return V.parent&&(X.mesh.parent=V.parent),X}}},601662:(t,V,X)=>{X.d(V,{r:()=>I});var K=X(938480),k=X(706211),A=X(517323),$=X(913239);class I extends A.q{constructor({DS:t,exclude:V=[]}){super({triggerOptions:K.m.NothingTrigger,DS:t}),this.exclude=V,this.onPointer=this.onPointer.bind(this)}_prepare(){super._prepare(),this.scene=this._actionManager.getScene(),this.scene.onPointerObservable.add(this.onPointer)}onPointer(t){t.type===k.Zp.POINTERMOVE&&t.pickInfo&&this.handleMove(t.event,t.pickInfo)}handleMove(t,V){const X=V.pickedMesh;X&&this.isExcludedMesh(X)||$.s(t)&&!this.paused&&this.processMeshUnderPointer(X)}isExcludedMesh(t){return 0!==this.exclude.length&&this.exclude.some((V=>V.test(t.name)))}processMeshUnderPointer(t){(null==t?void 0:t.isPickable)?this.setCursor("pointer"):this.setCursor("auto")}setCursor(t){if(!this.scene)return;this.scene.defaultCursor!==t&&(this.scene.defaultCursor=t);const V=this.scene.getEngine().getRenderingCanvas();V.style.cursor!==t&&(V.style.cursor=t)}}},880453:(t,V,X)=>{X.d(V,{Y:()=>q,m:()=>K});var K,k=X(938480),A=X(706211),$=X(948733),I=X(938868),C=X(517323),n=X(913239);(function(t){t[t["Start"]=1]="Start",t[t["Move"]=2]="Move",t[t["End"]=3]="End",t[t["Cancel"]=4]="Cancel"})(K||(K={}));class q extends C.q{constructor(t){super({triggerOptions:k.m.NothingTrigger,DS:t.DS}),this.currentPosition=$.Pq.Zero(),this.isDocumentEventListenerActive=!1,this.onPlayerTouchedDocument=t=>{this.scene&&(this.scene.getEngine().getRenderingCanvas()===t.target||(this.currentTouches=[],this.callback(K.Cancel,$.Pq.Zero(),null,void 0),this.removeDocumentListener()))},this.callback=t.callback,this.mesh=t.target,this.onPointer=this.onPointer.bind(this),this.currentTouches=[]}_prepare(){super._prepare(),this.scene=this._actionManager.getScene();let t=null;if("string"==typeof this.mesh){if(t=this.scene.getMeshByName(this.mesh),!t)throw new Error(`TapDrag: Mesh not found ${this.mesh}`)}else this.mesh instanceof I.u?t=this.mesh:this.picker=this.mesh;t&&(t.enablePointerMoveEvents=!0,this.picker=V=>!!V&&!!t&&V.name===t.name),this.scene.onPointerObservable.add(this.handlePointerEvent)}destroy(){this.scene&&this.scene.onPointerObservable.removeCallback(this.handlePointerEvent)}onPointer(t){t.type===A.Zp.POINTERMOVE?this.handleMove(t.event,t.pickInfo):t.type===A.Zp.POINTERUP?this.handleUp(t.event,t.pickInfo):t.type===A.Zp.POINTERDOWN&&this.handleDown(t.event,t.pickInfo)}handleDown(t,V){this.picker&&V&&!this.paused&&0===this.currentTouches.length&&this.picker(V.pickedMesh)&&V.pickedPoint&&(this.addDocumentListener(),this.currentTouches.push(this.getPointerId(t)),this.callback(K.Start,V.pickedPoint,V,t),this.currentPosition=V.pickedPoint)}handleMove(t,V){const X=this.currentTouches.includes(this.getPointerId(t)),k=n.s(t);(X||k)&&!this.paused&&V&&(V.pickedPoint&&(this.currentPosition=V.pickedPoint),this.callback(K.Move,this.currentPosition,V,t))}handleUp(t,V){const X=this.getPointerId(t);if(!this.currentTouches.includes(X))return;const k=(null==V?void 0:V.pickedPoint)||this.currentPosition;this.callback(K.End,k,V,t),this.clearTouch(X),this.currentTouches.length||this.removeDocumentListener()}clearTouch(t){this.currentTouches.splice(this.currentTouches.indexOf(t),1)}addDocumentListener(){this.isDocumentEventListenerActive||(this.isDocumentEventListenerActive=!0,document.addEventListener("touchend",this.onPlayerTouchedDocument))}removeDocumentListener(){this.isDocumentEventListenerActive&&(this.isDocumentEventListenerActive=!1,document.removeEventListener("touchend",this.onPlayerTouchedDocument))}}},497568:(t,V,X)=>{function K(t){t.setEnabled(!1)}X.d(V,{s:()=>K})},512521:(t,V,X)=>{function K(t){t.isWorldMatrixFrozen||t.freezeWorldMatrix()}X.d(V,{t:()=>K})},677735:(t,V,X)=>{function K(t){t.isPickable=!1}X.d(V,{i:()=>K})},674324:(t,V,X)=>{X.d(V,{p:()=>$});var K=X(540362);const k=2;class A{constructor(t,V){this.engine=t,this.render=V,this.isGameIdle=!1,this.haveActiveTasks=!0,this.waitExtraFrame=!1,this.framesToWait=k,this.renderGame=()=>{this.willRender&&(this.framesToWait>0?this.framesToWait--:(this.waitExtraFrame=!1,this.framesToWait=this.getFramesToWait()),this.render())},this.onFocus=()=>{this.isGameIdle||this.forceRender()},this.engine.runRenderLoop(this.renderGame),window.addEventListener("focus",this.onFocus)}get needToRender(){return this.haveActiveTasks}get willRender(){return!this.isGameIdle&&this.haveActiveTasks||this.waitExtraFrame}forceRender(){this.waitExtraFrame=!0,this.framesToWait=this.getFramesToWait()}setGameIdle(t){this.isGameIdle=t,t||this.forceRender()}setNeedToRender(t){this.waitExtraFrame=!0,this.framesToWait=this.getFramesToWait(),this.haveActiveTasks=t}dispose(){this.engine.stopRenderLoop(this.renderGame),window.removeEventListener("focus",this.onFocus)}getFramesToWait(){return k-1}}function $(){return K.U({taskName:"createRendererTask",execute:(t,V)=>{var X;V({renderer:(X={engine:t.engine,render:()=>{t.scene.render()}},new A(X.engine,X.render))})}})}},571928:(t,V,X)=>{X.d(V,{B:()=>k});var K=X(540362);function k(){return K.U({taskName:"pauseRendererTask",execute:(t,V)=>{t.renderer.setNeedToRender(!1),V()}})}},706726:(t,V,X)=>{X.d(V,{l:()=>A});var K=X(540362),k=X(131208);function A(t){return K.U({taskName:"skipAnimations",execute:(V,X)=>{if(t){const t=V.scene;k.K.SkipAnimations=!0;const X=t.beginAnimation.bind(t);t.beginAnimation=(t,V,K,k,A,$,I,C,n,q)=>X(t,K,K,k,A,$,I,C,n,q);const K=t.beginDirectAnimation.bind(t);t.beginDirectAnimation=(t,V,X,k,A,$,I,C)=>{const n=K(t,V,k,k,A,$,I,C);for(const t of V){const V=t.getEvents();for(const t of V)t.frame!==k&&t.action(t.frame)}return n};const A=t.beginHierarchyAnimation.bind(t);t.beginHierarchyAnimation=(t,V,X,K,k,$,I,C,n,q,R)=>A(t,V,K,K,k,$,I,C,n,q,R);const $=t.beginDirectHierarchyAnimation.bind(t);t.beginDirectHierarchyAnimation=(t,V,X,K,k,A,I,C,n)=>$(t,V,X,k,k,A,I,C,n)}X()}})}},663025:(t,V,X)=>{X.d(V,{T:()=>k});var K=X(365865);function k(t,V){const X={type:K.T.AddRenderTask,payload:{task:V}};t.sendTo3dWorld(X)}},787134:(t,V,X)=>{X.d(V,{W:()=>k});var K=X(365865);function k(t,V){const X={type:K.T.RemoveRenderTask,payload:{task:V}};t.sendTo3dWorld(X)}},365865:(t,V,X)=>{var K;X.d(V,{T:()=>K}),function(t){t["AddRenderTask"]="RendererMessageTo3D.AddRenderTask",t["RemoveRenderTask"]="RendererMessageTo3D.RemoveRenderTask"}(K||(K={}))},275866:(t,V,X)=>{X.d(V,{Y:()=>$});var K=X(948733),k=X(615473),A=X(359767);function $(t,V=Date.now()){if(t.length<2)throw new Error("Animation needs at least two keyframes.");const X=t[t.length-1].frame,$=X/A.q*1e3,I=V%$,C=Math.round(I/$*X);let n=t[0].value,q=n,R=0;for(let V=1;V<t.length;V++){const X=t[V];if(C<=X.frame){const K=t[V-1];n=K.value,q=X.value,R=(C-K.frame)/(X.frame-K.frame);break}}return"number"==typeof n?k.X.Lerp(n,q,R):K.v9.Lerp(n,q,R)}},433161:(t,V,X)=>{X.d(V,{IL:()=>q,K3:()=>W,YO:()=>m,h2:()=>R,h6:()=>N,jE:()=>I,lX:()=>Z,s8:()=>$,xG:()=>c,xv:()=>v,y:()=>C});var K=X(615473),k=X(523737),A=X(171526);function $(t){return(t%2/2-t%3/3+t%4/4-t%5/5)/Math.PI*2+.3*Math.PI}function I(t,V,X=!1){const K=X?t%4<2?-1:1:t%2?-1:1;return K*(-t%2/2+t%3/3+t%4/4-t%5/5)*(V/50)+K*(V/100)}function C(t,V,X=1){return{diameter:t.x*V.x*X,height:t.y*V.y*X}}const n=A.W1.map((t=>t[0])).sort(((t,V)=>V-t));function q(t,V,X=1){var K;const k=V?V.map((t=>t/X)):n,$=function(t,V){const X=V.slice().sort(((t,V)=>V-t));for(const V of X)if(V<=t)return V;return X[V.length-1]}(t/X,k),I=A.W1.find((t=>$>=t[0]));return null!==(K=null==I?void 0:I[1])&&void 0!==K?K:A.lr}function R(t,V){const X=t.includes(".")||t.includes(","),k=t.includes("M");let A,$=t.length;return X&&($-=1),A=V/(1.7+K.X.Clamp($-1,1,1/0)),(X||k)&&(A-=.2*A),Math.round(A)}function F(t,V){return V-t}function s(t,V){return 0===t.chip||t.amount>V.amount||t.amount===V.amount&&t.chip<V.chip?V:t}function S(t,V){return V.filter((V=>k.J0.isLessThanOrEqual(V,t))).sort(F).map((V=>({chip:V,amount:k.J0.floor(k.J0.divide(t,V)),remainder:k.J0.modulo(t,V)}))).reduce(s,{chip:0,amount:0,remainder:0})}function c(t,V){let X=t;const K=[];do{const t=S(X,V);X=t.remainder;for(let V=0;V<t.amount;V++)K.push(t.chip)}while(k.J0.isGreaterThan(X,0));return K}function N(t,V,X){let K=t;const A=V.reduce(((t,V)=>(t[V]=0,t)),{});for(const t of V){const V=Math.floor(X/2);for(let X=0;X<V;X++)k.J0.isGreaterThanOrEqual(K,t)&&(A[t]++,K=k.J0.subtract(K,t))}for(let t=V.length-1;t>=0;t--){const $=V[t],I=Math.min(X-A[$],k.J0.floor(k.J0.divide(K,$)));K=k.J0.subtract(K,I*$),A[$]+=I}return A}function m(t,V,X){let K=t;if(k.J0.isGreaterThan(t,X)){const A=k.J0.modulo(t,V),$=k.J0.floor(k.J0.divide(k.J0.subtract(X,A),V));K=k.J0.add(A,$*V)}return{chipSelectorAmount:K,plaqueAmount:k.J0.subtract(t,K)}}function v(t,V,X,K){const A={};let $=0,I=0,C=K;V&&k.J0.isLessThan(C,X)&&($+=k.J0.ceil(k.J0.divide(C,X)),C=k.J0.subtract(C,$*X)),Object.keys(t).map(Number).sort(((t,V)=>V-t)).forEach(((n,q,R)=>{0===q&&(I=n);let F=0;k.J0.isGreaterThanOrEqual(Math.abs(C),n)&&(k.J0.isGreaterThan(K,0)?F=k.J0.floor(k.J0.divide(C,n)):k.J0.isLessThan(K,0)&&(F=k.J0.ceil(k.J0.divide(C,n)),Math.abs(F)>t[n])&&(V+$*X||R.slice(0,q).some((V=>t[V]+A[V]>0))||(F=-t[n]||0))),A[n]=F,C=k.J0.subtract(C,F*n)}));const n=(t[I]+A[I])*I;return n>X&&($+=Math.floor(n/X),A[I]-=$*X/I),{chips:A,plaque:$}}function W(t,V){for(let X=t.length-1;X>=0;X--){const K=t[X];if(V[K]>0)return K}}function Z(t,V,X,K){const A=t[0];let $=X||0,I=!1;t.forEach(((K,k)=>{const A=V[K],C=t[k+1],n=V[C];(A<=0&&C&&n>0||A<=0&&!C&&X)&&(I=!0),$+=V[K]*K}));const C=k.J0.subtract(K,$);return I||k.J0.isGreaterThanOrEqual(C,A)}},708018:(t,V,X)=>{X.d(V,{xG:()=>K.xG});var K=X(433161)},909150:(t,V,X)=>{function K(t,V,X,K,k){const A=2*Math.tan(X/2),$=Math.abs(K.bottom-K.top),I=Math.abs(k.bottom-k.top)*V/$/A,C=Math.abs(K.right-K.left),n=Math.abs(k.right-k.left)*t/C/(t/V)/A;return Math.max(n,I)}X.d(V,{n:()=>K})},696624:(t,V,X)=>{function K(t,V,X,K){const k=2*K*Math.tan(X/2);return{width:k*t/V,height:k}}X.d(V,{I:()=>K})},346137:(t,V,X)=>{function K(t,V,X,K){let k=null;for(const X of t.multiMaterials)if(X.name===V){k=X;break}if(k)for(let t=0;t<k.subMaterials.length;t++){const V=k.subMaterials[t];V&&V.name===X&&(k.subMaterials[t]=K,V.dispose(!0,!0))}}X.d(V,{V:()=>K})},451336:(t,V,X)=>{X.d(V,{A:()=>k});var K=X(365865);function k(t){return new A(t.renderer,t.transport,t.rules)}class A{constructor(t,V,X){this.renderer=t,this.activeActionsCount=0,this.onMessagesFrom3D=t=>{let V=!1,X=!1;for(const X of this.renderRules)if(X.stop===t.type){const t=this.activeActions[X.start];void 0!==t&&t>0&&(this.activeActions[X.start]=t-1,this.activeActionsCount--,V=!0)}for(const V of this.forceRenderRules)if(V.forceOn===t.type){X=!0;break}(V||X)&&this.validateActions(X)},this.onMessagesTo3D=t=>{switch(t.type){case K.T.AddRenderTask:{const V=this.activeActions[t.payload.task];this.activeActions[t.payload.task]=void 0===V?1:V+1,this.activeActionsCount++,this.validateActions(!1);break}case K.T.RemoveRenderTask:{const V=this.activeActions[t.payload.task];void 0!==V&&V>0&&(this.activeActions[t.payload.task]=V-1,this.activeActionsCount--,this.validateActions(!1));break}default:{let V=!1,X=!1;for(const X of this.renderRules)if(X.start===t.type){const t=this.activeActions[X.start];this.activeActions[X.start]=void 0===t?1:t+1,this.activeActionsCount++,V=!0}for(const V of this.forceRenderRules)if(V.forceOn===t.type){X=!0;break}(V||X)&&this.validateActions(X)}}},this.onRenderStartCallbacks=[],this.onRenderEndCallbacks=[],this.activeActions={},this.renderRules=X.filter((t=>"start"in t&&"stop"in t)),this.forceRenderRules=X.filter((t=>"forceOn"in t)),this.unsubscribeFrom3D=V.onMessageFrom3dWorld(this.onMessagesFrom3D),this.unsubscribeTo3D=V.onMessageTo3dWorld(this.onMessagesTo3D)}onRenderStart(t){return this.onRenderStartCallbacks.push(t),()=>{this.onRenderStartCallbacks.splice(this.onRenderStartCallbacks.indexOf(t),1)}}onRenderEnd(t){return this.onRenderEndCallbacks.push(t),()=>{this.onRenderEndCallbacks.splice(this.onRenderEndCallbacks.indexOf(t),1)}}dispose(){this.onRenderStartCallbacks.length=0,this.onRenderEndCallbacks.length=0,this.unsubscribeFrom3D(),this.unsubscribeTo3D(),this.forceRenderRules.length=0,this.renderRules.length=0}validateActions(t){if(this.activeActionsCount>0&&!this.renderer.needToRender){for(const t of this.onRenderStartCallbacks)t();this.renderer.setNeedToRender(!0)}else if(0===this.activeActionsCount&&this.renderer.needToRender){for(const t of this.onRenderEndCallbacks)t();this.renderer.setNeedToRender(!1)}t&&this.renderer.forceRender()}}},595986:(t,V,X)=>{X.d(V,{F1:()=>K.F});var K=X(814566)},513024:(t,V,X)=>{X.d(V,{K:()=>k});var K=X(131208);function k(...[t,V,X={}]){return new Promise(((k,A)=>{K.Zs(t,V,{...X,onComplete:()=>{X.onComplete&&X.onComplete(),k()},onCancel:()=>{X.onCancel&&X.onCancel(),A("tweenTo cancelled")}})}))}},855276:(t,V,X)=>{X.d(V,{BQ:()=>k.UH,Dc:()=>F.I,Dr:()=>I.w,G6:()=>R.h8,S3:()=>k.S3,YY:()=>K.N,d0:()=>n.W,he:()=>A.uu,pj:()=>A.Qm,xD:()=>C.U,yQ:()=>q.x,z6:()=>$.G});var K=X(924740),k=X(977638),A=X(999289),$=X(700367),I=X(74329),C=X(20629),n=X(329232),q=X(572532),R=X(676700),F=X(800355)},924740:(t,V,X)=>{X.d(V,{N:()=>q});var K=X(64922),k=X(377810),A=X(470800),$=X(965460),I=X(113364),C=X(329232),n=X(20629);function q({roadItems:t,type:V,columnCount:X,rowCount:q,probes:R,probesWinnerType:F,scorecardTheme:s,isInterlacedMode:S=!1,isLive:c,emptyIconShape:N=!1,probeExtraShapes:m,patternScheme:v,multiplierThemeResolver:W,scorecardThemesOverrides:Z,skipFirstLastLines:D,registerProbeRef:y,pulsingAnimationDelay:E,isProbePulsing:_,registerLastRoadRef:p,currentWinnerType:L}){const O=k.useMemo((()=>{const K=C.W(X*(S?2:1),V,t,R,F,m,v,E,_,L);return n.U(K,c,s,W,y,p)}),[X,E,S,V,t,R,F,m,c,s,v,W,y,_,p]);return K.jsx(A.V,{gridIcons:O,scorecardTheme:s,columnCount:X,rowCount:q,isInterlacedMode:S,scorecardThemesOverrides:Z,skipFirstLastLines:D,IconShapeComponent:N||s!==$.a.BlackDot?void 0:I.p})}},977638:(t,V,X)=>{X.d(V,{UH:()=>p,S3:()=>E});var K=X(64922),k=X(377810);const A=`\n    M265 759 c-201 -65 -310 -283 -245 -490 64 -205 283 -315 491 -249\n    205 64 315 283 249 491 -65 205 -286 316 -495 248z\n`,$=`\n    M308 768 c-27 -5 -48 -14 -48 -18 0 -4 7 -24 15 -43 56 -135 -71\n    -282 -215 -249 -25 6 -47 8 -50 5 -3 -2 -5 -40 -4 -84 1 -69 5 -87 37 -152 44\n    -90 103 -147 195 -190 59 -27 78 -31 152 -31 74 0 93 4 152 31 92 43 151 100\n    195 191 34 69 37 81 37 162 0 81 -3 93 -37 162 -44 89 -103 148 -190 188 -71\n    34 -166 45 -239 28z\n`,I=`\n    M312 770 c-64 -13 -157 -67 -203 -117 -22 -24 -55 -74 -72 -111 -27\n    -59 -31 -78 -31 -152 0 -74 4 -93 31 -152 78 -167 244 -259 416 -228 37 6 67\n    15 67 20 0 4 -7 24 -15 43 -56 135 71 282 215 249 25 -6 47 -8 50 -5 3 2 5 40\n    4 84 -1 69 -5 87 -37 152 -44 88 -103 147 -190 187 -69 33 -165 45 -235 30z\n`,C=`\n    M290 769 c-19 -6 -36 -12 -38 -13 -1 -2 5 -19 13 -39 48 -114 -25\n    -243 -144 -255 -27 -2 -63 0 -80 6 -36 13 -41 4 -41 -78 0 -212 175 -390 383\n    -390 54 0 147 17 147 27 0 2 -8 15 -17 30 -23 35 -23 118 1 167 12 23 38 50\n    65 68 40 25 54 29 101 25 30 -2 62 -7 71 -11 14 -6 18 1 24 42 21 156 -80 329\n    -232 399 -65 30 -190 41 -253 22z\n`,n=`\n    M275 764 c-103 -37 -194 -110 -228 -184 -81 -174 -56 -342 67 -466\n    154 -153 398 -153 552 0 123 124 148 292 67 466 -21 44 -109 132 -153 153\n    -105 48 -221 60 -305 31z m179 -123 c3 -4 19 -11 36 -15 40 -8 128 -96 136\n    -136 4 -17 11 -33 15 -36 5 -3 9 -32 9 -64 0 -32 -4 -61 -9 -64 -4 -3 -11 -19\n    -15 -36 -8 -40 -96 -128 -136 -136 -17 -4 -33 -11 -36 -15 -3 -5 -32 -9 -64\n    -9 -32 0 -61 4 -64 9 -3 4 -19 11 -36 15 -40 8 -128 96 -136 136 -4 17 -11 33\n    -15 36 -12 7 -12 121 0 128 4 3 11 19 15 36 8 40 96 128 136 136 17 4 33 11\n    36 15 3 5 32 9 64 9 32 0 61 -4 64 -9z\n`,q=`\n    M288 767 c-28 -11 -38 -40 -18 -52 6 -3 10 -22 10 -41 0 -37 22 -56\n    43 -35 13 13 123 15 131 2 3 -4 19 -11 36 -15 40 -8 128 -96 136 -136 4 -17\n    11 -33 15 -36 5 -3 9 -32 9 -64 0 -32 -4 -61 -9 -64 -4 -3 -11 -19 -15 -36 -8\n    -40 -96 -128 -136 -136 -17 -4 -33 -11 -36 -15 -7 -12 -121 -12 -128 0 -3 4\n    -19 11 -36 15 -38 7 -127 94 -136 133 -4 15 -11 33 -16 40 -5 6 -8 37 -7 67 1\n    31 1 57 -2 60 -2 2 -32 6 -67 10 l-62 7 0 -73 c0 -115 37 -206 114 -284 154\n    -153 398 -153 552 0 153 154 153 398 0 552 -52 52 -84 71 -166 98 -51 18 -171\n    19 -212 3z\n`,R=`\n    M275 764 c-78 -28 -110 -48 -161 -98 -123 -124 -148 -292 -67 -466\n    21 -44 109 -132 153 -153 102 -47 215 -61 287 -35 32 12 45 40 23 53 -5 3 -10\n    22 -10 41 0 37 -22 56 -43 35 -13 -13 -123 -15 -131 -2 -3 4 -19 11 -36 15\n    -40 8 -128 96 -136 136 -4 17 -11 33 -15 36 -12 7 -12 121 0 128 4 3 11 19 15\n    36 8 40 96 128 136 136 17 4 33 11 36 15 3 5 32 9 64 9 32 0 61 -4 64 -9 3 -4\n    19 -11 36 -15 38 -7 127 -94 136 -133 4 -15 11 -33 16 -40 5 -6 8 -37 7 -67\n    -1 -31 -1 -57 2 -60 2 -2 32 -6 67 -10 l62 -7 0 73 c0 115 -37 206 -114 284\n    -52 52 -84 71 -166 98 -55 19 -171 19 -225 0z\n`,F=`\n    M283 767 c-36 -12 -42 -27 -18 -47 9 -7 15 -29 15 -51 0 -32 4 -39\n    19 -39 11 0 23 5 26 10 8 12 122 13 129 1 3 -4 19 -11 36 -15 38 -7 127 -94\n    136 -133 4 -15 11 -33 16 -40 5 -6 8 -38 7 -70 l-3 -58 58 -8 c32 -5 61 -5 65\n    -2 10 11 6 137 -7 182 -34 121 -137 227 -259 266 -57 19 -169 20 -220 4z\n`,s=`\n    M0 398 c1 -187 107 -329 291 -387 47 -15 154 -14 196 1 32 12 43 31\n    24 43 -6 3 -13 26 -17 50 -6 43 -24 59 -39 35 -8 -12 -122 -13 -129 -1 -3 4\n    -19 11 -36 15 -38 7 -127 94 -136 133 -4 15 -11 33 -16 40 -5 6 -8 37 -7 67 1\n    31 1 57 -2 60 -2 2 -32 6 -66 10 l-63 7 0 -73z\n`,S=`\n    M260 360 l-255 -255 60 -60 60 -60 410 410 255 255 -60 60 -60 60\n`;var c=X(471065),N=X(965460),m=X(999289);function v(t,V){if(V)switch(t){case m.Qm.Player:return"#2E83FF";case m.Qm.Banker:return"#EC2024";case m.Qm.Tie:return"#159252";case m.Qm.Legend:return"#9B9B9B";default:return"transparent"}switch(t){case m.Qm.Player:return"#185CC6";case m.Qm.Banker:return"#C52123";case m.Qm.Tie:return"#51A548";case m.Qm.Legend:return"#a7a9ac";default:return"transparent"}}function W(t,V,X){return{path:t,color:v(V,X)}}var Z=X(32991);const D="roadItem",y="lightning-circle",E={colors:["lightningCircleGradient","#956723","#c69844","#f4e584"],faceliftColors:["lightningCircleGradientFaceLift","#dcb51b","#ffffff","#c8a311"]},_=[A,n,R,q,I,$,C,s,F],p=({lightning:t,multiplier:V,extraShapes:X,roadType:p,winnerType:L,isLive:O,animate:r,additionalType:z,pulsingAnimationDelay:w=0,isPulsing:b=!1,isHidden:a=!1,multiplierThemeResolver:u,theme:j,symbol:x,registerRef:e})=>{const Y=k.useRef(null);k.useLayoutEffect((()=>{if(e)return e(p,Y.current),()=>{e(p,null)}}),[e,p,L]);const H=[],h=[],T=[],P=t||V&&V>0;if(X&&H.push(...X),(p===c.t.Bead||p===c.t.Small||p===c.t.Big&&P)&&(h[0]=W(A,L,O)),p===c.t.Bead||p===c.t.Big&&P)switch(z){case m.uu.Banker:h[0]=W(I,L,O);break;case m.uu.Player:h[0]=W($,L,O);break;case m.uu.BankerPlayer:case m.uu.TieBankerPlayer:h[0]=W(C,L,O)}if((p===c.t.Big&&!P||p===c.t.BigEye)&&(h[0]=W(n,L,O)),p===c.t.Bead&&P){const t=(u&&V?u(V):E).faceliftColors;switch(T.push(K.jsxs("linearGradient",{x1:"50%",y1:"0%",x2:"50%",y2:"100%",id:t[0],children:[K.jsx("stop",{stopColor:t[1],offset:"0%"}),K.jsx("stop",{stopColor:t[2],offset:"46.0800918%"}),K.jsx("stop",{stopColor:t[3],offset:"100%"})]},t[0])),h[1]={path:"M40,390a350,350 0 1,0 700,0a350,350 0 1,0 -700,0",color:"none",stroke:`url(#${t[0]})`,strokeWidth:80},z){case m.uu.Banker:h[1].strokeDasharray="1175, 350";break;case m.uu.Player:h[1].strokeDasharray="75, 350, 1800";break;case m.uu.BankerPlayer:case m.uu.TieBankerPlayer:h[1].strokeDasharray="80, 340, 760, 340, 730"}}if(p===c.t.Big&&!P)switch(z){case m.uu.Banker:case m.uu.TieBanker:h[0]=W(R,L,O);break;case m.uu.Player:case m.uu.TiePlayer:h[0]=W(q,L,O);break;case m.uu.BankerPlayer:case m.uu.TieBankerPlayer:h[0]=W(F,L,O),h[1]=W(s,L,O)}if(p===c.t.Big&&P){const t=(u&&V?u(V):E).colors;h.forEach((V=>{_.includes(V.path)&&(V.color=`url(#${t[0]})`)})),T.push(K.jsxs("linearGradient",{x1:"50%",y1:"0%",x2:"50%",y2:"100%",id:t[0],children:[K.jsx("stop",{stopColor:t[1],offset:"0%"}),K.jsx("stop",{stopColor:t[2],offset:"56%"}),K.jsx("stop",{stopColor:t[3],offset:"100%"})]},t[0]))}H.push(K.jsx("g",{transform:"translate(0,78) scale(0.1,-0.1)",fill:v(L,O),stroke:"none","data-type":"roadItemColor",children:h.map(((t,V)=>K.jsx("path",{d:t.path,fill:t.color,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeDasharray:t.strokeDasharray},V)))},"BankerPlayer")),p===c.t.Big&&P&&H.push(K.jsx("circle",{"data-type":y,fill:v(L,O),cx:"39",cy:"39",r:"22"},y)),(p===c.t.Cockroach||p===c.t.Big&&[m.uu.TieBanker,m.uu.TiePlayer,m.uu.TieBankerPlayer,m.uu.Tie].some((t=>t===z)))&&H.push(K.jsx("g",{transform:"translate(0,78) scale(0.1,-0.1)",fill:v(L,O),stroke:"none","data-type":"roadItemColor",children:K.jsx("path",{d:S,fill:v(p===c.t.Cockroach?L:m.Qm.Tie,O)},"SLASH")},"BankerPlayerSlash")),[m.uu.Banker,m.uu.TieBanker,m.uu.BankerPlayer,m.uu.TieBankerPlayer].some((t=>t===z))&&H.push(K.jsx("circle",{cx:"67",cy:"63",r:"10",fill:v(m.Qm.Banker,O)},"circle-banker")),[m.uu.Player,m.uu.TiePlayer,m.uu.BankerPlayer,m.uu.TieBankerPlayer].some((t=>t===z))&&H.push(K.jsx("circle",{cx:"10",cy:"14",r:"10",fill:v(m.Qm.Player,O)},"circle-player")),(p===c.t.Bead||p===c.t.Big&&void 0!==x)&&H.push(K.jsx("text",{x:"50%",y:"75%",textAnchor:"middle",fontSize:55,fill:p===c.t.Bead||j===N.a.BlackDot?"white":"black",children:x},"symbol"));const Q=[Z.A.svg],J={};a&&Q.push(Z.A.isHidden,"isHidden"),r&&Q.push(Z.A.animate,"animate"),b&&(Q.push(Z.A.pulsing,"pulsing"),w&&(J.animationDelay=`${w}s`));const U=void 0!==z?` ${m.uu[z]}`:"",l=`${m.Qm[L]}${U}`;return K.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:Q.join(" "),viewBox:"0 0 80 80","data-type":D,name:l,ref:e?Y:null,children:[K.jsx("defs",{children:T}),K.jsx("g",{style:J,children:K.jsx("svg",{width:"68px",height:"68px",x:"6",y:"6",viewBox:"0 0 80 80",children:H})})]})}},999289:(t,V,X)=>{var K,k,A;X.d(V,{Qm:()=>K,uu:()=>k,vc:()=>A}),function(t){t["Player"]="Player",t["Banker"]="Banker",t["Tie"]="Tie",t["Legend"]="Legend",t["None"]="None"}(K||(K={})),function(t){t[t["Banker"]=0]="Banker",t[t["Player"]=1]="Player",t[t["BankerPlayer"]=2]="BankerPlayer",t[t["TieBanker"]=3]="TieBanker",t[t["TiePlayer"]=4]="TiePlayer",t[t["TieBankerPlayer"]=5]="TieBankerPlayer",t[t["Tie"]=6]="Tie"}(k||(k={})),function(t){t["Blue"]="Blue",t["Red"]="Red",t["None"]="None",t["Green"]="Green"}(A||(A={}))},572532:(t,V,X)=>{X.d(V,{x:()=>k});var K=X(999289);function k(t,V=!1){return t.reduce(((t,X)=>{var k,A,$,I;const C=t.length,n=function(t){switch(t.winner){case K.Qm.Banker:return K.vc.Red;case K.Qm.Player:return K.vc.Blue;default:return K.vc.None}}(X),q=t[0],R=X.playerPair||X.bankerPair?{playerPair:X.playerPair,bankerPair:X.bankerPair}:void 0;if(n===K.vc.None&&C>0)t[C-1].ties+=1,t[C-1].pairsOrder&&R&&V&&(t[C-1].pairsOrder=[...null!==(k=t[C-1].pairsOrder)&&void 0!==k?k:[],R]),q.color===K.vc.None?t[0]={...t[0],bankerPair:q.bankerPair||X.bankerPair,playerPair:q.playerPair||X.playerPair,natural:q.natural||X.natural,lightning:q.lightning||X.lightning,multiplier:q.multiplier||X.multiplier,row:0,col:0,pairsOrder:V&&R?[...null!==(A=t[0].pairsOrder)&&void 0!==A?A:[],R]:void 0}:(t[C-1].bankerPair=t[C-1].bankerPair||X.bankerPair,t[C-1].playerPair=t[C-1].playerPair||X.playerPair,t[C-1].lightning=t[C-1].lightning||X.lightning,t[C-1].multiplier=t[C-1].multiplier||X.multiplier,t[C-1].pairsOrder=V&&R?[...null!==($=t[C-1].pairsOrder)&&void 0!==$?$:[],R]:void 0);else if(q&&q.color===K.vc.None)t[0]={ties:q.ties,playerPair:X.playerPair||q.playerPair,bankerPair:X.bankerPair||q.bankerPair,natural:X.natural,lightning:X.lightning||q.lightning,multiplier:X.multiplier||q.multiplier,color:n,row:0,col:0,pairsOrder:V&&R?[...null!==(I=t[0].pairsOrder)&&void 0!==I?I:[],R]:void 0};else{const k={ties:n===K.vc.None?1:0,playerPair:X.playerPair,bankerPair:X.bankerPair,color:n,natural:X.natural,lightning:X.lightning,multiplier:X.multiplier,row:0,col:0,pairsOrder:V&&R?[R]:void 0};t.push(k)}return t}),[])}},700367:(t,V,X)=>{X.d(V,{G:()=>k});var K=X(999289);function k(t,V,X){return t&&V?X?K.uu.TieBankerPlayer:K.uu.BankerPlayer:t?X?K.uu.TieBanker:K.uu.Banker:V?X?K.uu.TiePlayer:K.uu.Player:X?K.uu.Tie:void 0}},800355:(t,V,X)=>{X.d(V,{I:()=>k});var K=X(999289);function k(t,V){const X=function(t){let V;return t.reduce(((t,X)=>(0===t.length||X.color!==V?t=t.concat([[X]]):t[t.length-1]=t[t.length-1].concat(X),V=X.color,t)),[])}(t);return X.reduce(((t,k,A)=>(k.forEach(((k,$)=>{if(A<V)return;if(A===V&&0===$)return;if(k.color===K.vc.None)return;let I;I=0===$?X[A-1].length===X[A-(V+1)].length?K.vc.Red:K.vc.Blue:!X[A-V][$-1]==!X[A-V][$]?K.vc.Red:K.vc.Blue;const C={color:I,col:0,row:0};t.push(C)})),t)),[])}},74329:(t,V,X)=>{X.d(V,{w:()=>k});var K=X(999289);function k(t){switch(t){case"Red":return K.Qm.Banker;case"Blue":return K.Qm.Player;case"Green":return K.Qm.Tie;case"None":return K.Qm.None;default:return K.Qm.Legend}}},20629:(t,V,X)=>{X.d(V,{U:()=>A});var K=X(64922),k=X(977638);function A(t,V,X,A,$,I){return t?t.map(((C,n)=>({x:C.x||0,y:C.y||0,withDefaultIcon:($||I)&&C.props.withDefaultIcon,jsx:K.jsx(k.UH,{...C.props,theme:X,pulsingAnimationDelay:C.props.pulsingAnimationDelay,registerRef:C.props.isPulsing?$:I&&n===t.length-1?I:void 0,isLive:V,multiplierThemeResolver:A})}))):[]}},329232:(t,V,X)=>{X.d(V,{W:()=>$});var K=X(999289);const k=(t,V,X)=>({...t[K.Qm[V]][X],isProbe:!0});var A=X(841026);function $(t,V,X,K,$,I,C,n,q,R){const F=V.charAt(0).toLowerCase()+V.slice(1),s=[...X||[]],S=t-1-4;if(K&&void 0!==$){const t=k(K,$,F);t.pulsingAnimationDelay=n,I&&(t.extraShapes=I),s.push(t)}const c=s.map((t=>t.col)),N=Math.max(...c),m=Math.floor(S-N>0?0:N-S);return s.filter((t=>!m||t.col>m-1)).map((t=>{const X=t.col-m,K=t.row,k=!!(null==C?void 0:C.find((t=>t.x===X&&t.y===K))),$=A.j(V,t,k,q,R);return{x:X,y:K,props:$}}))}},841026:(t,V,X)=>{X.d(V,{j:()=>I});var K=X(471065),k=X(999289),A=X(700367),$=X(74329);function I(t,V,X,I,C){var n,q;const R=V.isHidden&&!(C===k.Qm.Tie&&t!==K.t.Big),F=V.ties||0,s=R&&C===k.Qm.Tie&&1===F,S=(null==V?void 0:V.pairsOrder)?V.pairsOrder.pop():void 0,c=R&&(null==S?void 0:S.playerPair)&&!(null===(n=null==V?void 0:V.pairsOrder)||void 0===n?void 0:n.find((({playerPair:t})=>!!t))),N=R&&(null==S?void 0:S.bankerPair)&&!(null===(q=null==V?void 0:V.pairsOrder)||void 0===q?void 0:q.find((({bankerPair:t})=>!!t))),m={roadType:t,winnerType:R&&C!==k.Qm.Tie?k.Qm.None:$.w(V.color),additionalType:A.G(!N&&V.bankerPair,!c&&V.playerPair,s?0:F),animate:V.isProbe&&!I,isPulsing:V.isProbe&&I,withDefaultIcon:V.isProbe&&I||R||s,isHidden:R&&!F,pulsingAnimationDelay:V.pulsingAnimationDelay,lightning:V.lightning,multiplier:V.multiplier,extraShapes:X?void 0:V.extraShapes},v=R&&C===k.Qm.Tie&&F>1?F-1:F;return(v>1||m.winnerType===k.Qm.Tie)&&(m.symbol=v),m}},676700:(t,V,X)=>{X.d(V,{h8:()=>A});const K=52*4;function k(t,V){return t*K+V}function A(t){const V=6;let X=0,K=0,A=0,$=null,I=!1;const C=(t,V,X)=>(t.row=V,t.col=X,t),n=t.reduce(((t,k)=>{if(0===t.length)return A++,t.concat(C(k,0,0));const n=t[t.length-1];if(k.color===n.color){if(A++,!$){const k=t.find((t=>t.col===X&&t.row===K+1));(K===V-1||k)&&($=X,I=!0)}I?X+=1:K+=1}else{if(I=!1,null!==$)for(0!==K&&(X=$),$=null;t.find((t=>0===t.row&&t.col===X));)X+=1;else X+=1;A=1,K=0}return t.push(C(k,K,X)),t}),[]);return{list:n,weight:k(A,n.length)}}},113364:(t,V,X)=>{X.d(V,{p:()=>A});var K=X(64922),k=X(32991);const A=()=>K.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:k.A.svg,viewBox:"0 0 80 80","data-type":"emptyRoadItem",children:K.jsx("svg",{height:"100",width:"100",children:K.jsx("circle",{cx:"40",cy:"40",r:"8",fill:"rgba(255,255,255,0.15)"})})})},470800:(t,V,X)=>{X.d(V,{N:()=>C,V:()=>n});var K=X(64922),k=X(266600),A=X(377810),$=X(239956),I=X(965460);const C=({scorecardTheme:t,columnCount:V,rowCount:X,isInterlacedMode:k,gridIcons:A,IconShapeComponent:C,defaultIconId:n,scorecardThemesOverrides:q,skipFirstLastLines:R})=>{const F=I.Aw(t,q);return K.jsx($.gf,{columnCount:V*(k?2:1),rowCount:X*(k?2:1),icons:A,isInterlacedMode:k,strokeWidth:k?.1:.05,...F,IconShapeComponent:C,defaultIconId:n,skipFirstLastLines:R})},n=A.memo(C,k.A)},782437:(t,V,X)=>{X.d(V,{G:()=>k});var K=X(64922);const k=X(377810).memo((({rowCount:t,columnCount:V,isInterlacedMode:X,strokeWidth:k,stroke:A,redesigned:$,skipFirstLastLines:I})=>{const C=[],n=k/2;for(let q=0;q<=t;q++){if(X&&q%2!=0)continue;const R=0===q,F=q===t;if(($||I)&&(R||F))continue;const s=R?n:F?-n:0;C.push(K.jsx("line",{x1:0,x2:V,y1:q+s,y2:q+s,stroke:A,style:{strokeWidth:k}},`h-${q}`))}for(let q=0;q<=V;q++){if(X&&q%2!=0)continue;const R=0===q,F=q===V;if(($||I)&&(R||F))continue;const s=R?n:F?-n:0;C.push(K.jsx("line",{x1:q+s,x2:q+s,y1:0,y2:t,stroke:A,style:{strokeWidth:k}},`v-${q}`))}return K.jsx(K.Fragment,{children:C})}))},239956:(t,V,X)=>{X.d(V,{gf:()=>c});var K=X(64922),k=X(699695),A=X(929468),$=X(377810);const I=$.memo((({column:t,row:V,iconId:X})=>K.jsx("use",{xlinkHref:`#${X}`,x:t,y:V})),((t,V)=>t.column===V.column&&t.row===V.row&&t.iconId===V.iconId)),C=$.memo((({rowCount:t,columnCount:V,IconShapeComponent:X,icons:k,defaultIconId:C})=>{const n=$.useRef(C||A.A()),q=[];for(let X=0;X<t;X++)for(let t=0;t<V;t++)k.some((V=>V.x===t&&V.y===X))||q.push(K.jsx(I,{column:t,row:X,iconId:n.current},`default-icon-usage-${t}-${X}-${n.current}`));return K.jsxs(K.Fragment,{children:[K.jsx("defs",{children:K.jsx("svg",{id:`${n.current}`,width:1,height:1,children:K.jsx(X,{})},`default-icon-shape-${n.current}`)}),q]})}),((t,V)=>t.rowCount===V.rowCount&&t.columnCount===V.columnCount&&t.icons.length===V.icons.length&&t.defaultIconId===V.defaultIconId));var n=X(782437);const q="svg--eb430",R="fitToWidth--3e2d4",F="fitToHeight--761b3",s="coordinates";var S;(function(t){t[t["Height"]=0]="Height",t[t["Width"]=1]="Width"})(S||(S={}));const c=({fill:t="transparent",stroke:V="#000000",icons:X=[],strokeWidth:A=0,translate:$,size:I=1,isInterlacedMode:c=!1,skipFirstLastLines:N=!1,fitTo:m,onClick:v,columnCount:W,rowCount:Z,IconShapeComponent:D,defaultIconId:y,redesigned:E})=>{const _=W,p=Z,L=`0 0 ${_} ${p}`,O=null!=$?$:A,r=[];for(const t of X){const{x:V,y:X,jsx:k,key:$=`icon-${t.x}-${t.y}`}=t;r.push(K.jsx("svg",{width:I-A,height:I-A,x:V-(I-1)+O,y:X-(I-1)+O,"data-type":s,"data-x":V,"data-y":X,children:k},$))}const z=k.A(q,{[R]:m===S.Width,[F]:m===S.Height}),w=X.filter((t=>!t.withDefaultIcon));return K.jsxs("svg",{className:z,viewBox:L,onClick:v,children:[K.jsx("rect",{x:"0",y:"0",rx:E?"0.3":void 0,fill:t,width:_,height:p,stroke:E?V:void 0,strokeWidth:E?A:void 0}),D&&K.jsx(C,{rowCount:Z,columnCount:W,IconShapeComponent:D,icons:w,defaultIconId:y}),A&&K.jsx(n.G,{isInterlacedMode:c,skipFirstLastLines:N,rowCount:Z,columnCount:W,strokeWidth:A,stroke:V,redesigned:E}),r]})}},786532:(t,V,X)=>{X.d(V,{gf:()=>K.gf});var K=X(239956)},106944:(t,V,X)=>{X.d(V,{Aw:()=>A.Aw,Np:()=>k.N,V4:()=>k.V,a:()=>A.a,gf:()=>I.gf,p3:()=>K.p,tb:()=>$.t});var K=X(113364),k=X(470800),A=X(965460),$=X(471065),I=X(786532)},965460:(t,V,X)=>{var K;X.d(V,{Aw:()=>A,a:()=>K}),function(t){t["WhiteSolid"]="WhiteSolid",t["WhiteTransparent"]="WhiteTransparent",t["BlackTransparent"]="BlackTransparent",t["Transparent"]="Transparent",t["BlackDot"]="BlackDot"}(K||(K={}));const k={[K.WhiteSolid]:{fill:"#ffffff",stroke:"rgba(167, 169, 172, 0.5)",symbolColor:"#ffffff",background:"rgba(255, 255, 255, 0.97)"},[K.WhiteTransparent]:{fill:"transparent",stroke:"transparent",strokeWidth:0,symbolColor:"#ffffff"},[K.BlackTransparent]:{fill:"#1A1A1A",stroke:"#4A4A4A",symbolColor:"#ffffff"},[K.Transparent]:{fill:"#1A1A1A",stroke:"#4A4A4A",symbolColor:"#ffffff",predictionBackground:"transparent"},[K.BlackDot]:{fill:"transparent",stroke:"transparent",strokeWidth:0,symbolColor:"#ffffff",predictionBackground:"transparent",emptyIconColor:"rgba(255,255,255,0.15)",background:"rgba(255, 255, 255, 0.05)"}};function A(t,V={}){const X={...k,...V};return X[t]||X[K.WhiteSolid]}},471065:(t,V,X)=>{var K;X.d(V,{t:()=>K}),function(t){t["Bead"]="Bead",t["Big"]="Big",t["BigEye"]="BigEye",t["Small"]="Small",t["Cockroach"]="Cockroach"}(K||(K={}))},47363:(t,V,X)=>{t.exports=X.p+"images/fivespotsg.352795d5.jpg"},212858:(t,V,X)=>{t.exports=X.p+"images/highlightm.4e87bb1d.jpg"},254566:(t,V,X)=>{t.exports=X.p+"images/highlights.6fde2866.jpg"},392089:(t,V,X)=>{t.exports=X.p+"images/highlightt.4d67f700.jpg"},732037:(t,V,X)=>{t.exports=X.p+"images/bowlbottom.024f9763.jpg"},938654:(t,V,X)=>{t.exports=X.p+"images/bowltopbas.b44e7c26.jpg"},251898:(t,V,X)=>{t.exports=X.p+"images/bowltoprou.34627fb8.jpg"},27696:(t,V,X)=>{t.exports=X.p+"images/cardholder.0562eda8.jpg"},136818:(t,V,X)=>{t.exports=X.p+"images/cardholder.4b57c772.jpg"},118022:(t,V,X)=>{t.exports=X.p+"images/cardshoe.a2425ebc.jpg"},320164:(t,V,X)=>{t.exports=X.p+"images/cardshoeop.e6512b40.jpg"},536299:(t,V,X)=>{t.exports=X.p+"images/cardstack.525f4c21.jpg"},595361:(t,V,X)=>{t.exports=X.p+"images/chipstackg.343744a1.jpg"},489021:(t,V,X)=>{t.exports=X.p+"images/coinlowcoi.de02aeed.jpg"},428688:(t,V,X)=>{t.exports=X.p+"images/coinlowcoi.d90bd31f.jpg"},711831:(t,V,X)=>{t.exports=X.p+"images/coinlowcoi.5578f8b5.jpg"},346804:(t,V,X)=>{t.exports=X.p+"images/cuttingcar.dee31a21.jpg"},202054:(t,V,X)=>{t.exports=X.p+"images/cardstackd.59c4746e.jpg"},655516:(t,V,X)=>{t.exports=X.p+"images/cardstackn.2b257662.jpg"},950738:(t,V,X)=>{t.exports=X.p+"images/cardstackd.d6efbf7f.jpg"},887848:(t,V,X)=>{t.exports=X.p+"images/cardstackn.2b257662.jpg"},136750:(t,V,X)=>{t.exports=X.p+"images/tabledecor.240c5727.jpg"},683017:(t,V,X)=>{t.exports=X.p+"images/opticalfib.aa116480.jpg"},88085:(t,V,X)=>{t.exports=X.p+"images/bonsai.eead6b68.jpg"},719875:(t,V,X)=>{t.exports=X.p+"images/bonsaiop.cb77b7b9.jpg"},932494:(t,V,X)=>{t.exports=X.p+"images/coinswall.3ec44963.jpg"},683334:(t,V,X)=>{t.exports=X.p+"images/coinswallo.5fde2066.jpg"},183656:(t,V,X)=>{t.exports=X.p+"images/fin.59129dfd.jpg"},206574:(t,V,X)=>{X.d(V,{A:()=>K});const K=function(t,V,X,K){var k=-1,A=null==t?0:t.length;for(K&&A&&(X=t[++k]);++k<A;)X=V(X,t[k],k,t);return X}},534636:(t,V,X)=>{X.d(V,{A:()=>K});const K=function(t){return function(V){return null==t?void 0:t[V]}}},75047:(t,V,X)=>{X.d(V,{A:()=>I});var K=X(206574),k=X(343228),A=X(914861),$=RegExp("['’]","g");const I=function(t){return function(V){return K.A(A.A(k.A(V).replace($,"")),t,"")}}},253187:(t,V,X)=>{X.d(V,{A:()=>K});const K=X(628585).A("ceil")},872017:(t,V,X)=>{X.d(V,{A:()=>C});var K=X(415420),k=X(56988),A=X(510405),$=Math.ceil,I=Math.max;const C=function(t,V,X){V=(X?k.A(t,V,X):void 0===V)?1:I(A.A(V),0);var C=null==t?0:t.length;if(!C||V<1)return[];for(var n=0,q=0,R=Array($(C/V));n<C;)R[q++]=K.A(t,n,n+=V);return R}},343228:(t,V,X)=>{X.d(V,{A:()=>I});const K=X(534636).A({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"});var k=X(957842),A=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,$=RegExp("["+"\\u0300-\\u036f"+"\\ufe20-\\ufe2f"+"\\u20d0-\\u20ff"+"]","g");const I=function(t){return(t=k.A(t))&&t.replace(A,K).replace($,"")}},515200:(t,V,X)=>{X.d(V,{A:()=>$});var K=X(608292),k=X(693653),A=X(436897);const $=function(t,V){var X={};return V=A.A(V,3),k.A(t,(function(t,k,A){K.A(X,k,V(t,k,A))})),X}},156256:(t,V,X)=>{X.d(V,{A:()=>K});const K=X(75047).A((function(t,V,X){return t+(X?"_":"")+V.toLowerCase()}))},929468:(t,V,X)=>{X.d(V,{A:()=>A});var K=X(957842),k=0;const A=function(t){var V=++k;return K.A(t)+V}},914861:(t,V,X)=>{X.d(V,{A:()=>z});var K=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var k=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var A=X(957842),$="\\ud800-\\udfff",I="\\u2700-\\u27bf",C="a-z\\xdf-\\xf6\\xf8-\\xff",n="A-Z\\xc0-\\xd6\\xd8-\\xde",q="\\xac\\xb1\\xd7\\xf7"+"\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf"+"\\u2000-\\u206f"+" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",R="['’]",F="["+q+"]",s="\\d+",S="["+I+"]",c="["+C+"]",N="[^"+$+q+s+I+C+n+"]",m="(?:\\ud83c[\\udde6-\\uddff]){2}",v="[\\ud800-\\udbff][\\udc00-\\udfff]",W="["+n+"]",Z="(?:"+c+"|"+N+")",D="(?:"+W+"|"+N+")",y="(?:"+R+"(?:d|ll|m|re|s|t|ve))?",E="(?:"+R+"(?:D|LL|M|RE|S|T|VE))?",_="(?:"+"["+"\\u0300-\\u036f"+"\\ufe20-\\ufe2f"+"\\u20d0-\\u20ff"+"]"+"|"+"\\ud83c[\\udffb-\\udfff]"+")"+"?",p="["+"\\ufe0e\\ufe0f"+"]?",L=p+_+"(?:"+"\\u200d"+"(?:"+["[^"+$+"]",m,v].join("|")+")"+p+_+")*",O="(?:"+[S,m,v].join("|")+")"+L,r=RegExp([W+"?"+c+"+"+y+"(?="+[F,W,"$"].join("|")+")",D+"+"+E+"(?="+[F,W+Z,"$"].join("|")+")",W+"?"+Z+"+"+y,W+"+"+E,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",s,O].join("|"),"g");const z=function(t,V,X){return t=A.A(t),void 0===(V=X?void 0:V)?function(t){return k.test(t)}(t)?function(t){return t.match(r)||[]}(t):function(t){return t.match(K)||[]}(t):t.match(V)||[]}},431906:(t,V,X)=>{X.d(V,{p:()=>W});var K=X(297809),k=X(760998),A=X(898973),$=X(638113),I=X(332290),C=X(395726),n=X(23987),q=X(432050),R=X(888413),F=X(55973),s=X(554014),S=X(522208),c=X(964061),N=X(651577),m=X(855300),v=X(104270);class W{get camera(){return this._effectLayerOptions.camera}get renderingGroupId(){return this._effectLayerOptions.renderingGroupId}set renderingGroupId(t){this._effectLayerOptions.renderingGroupId=t}get mainTexture(){return this._mainTexture}get shaderLanguage(){return this._shaderLanguage}setMaterialForRendering(t,V){if(this._mainTexture.setMaterialForRendering(t,V),Array.isArray(t))for(let X=0;X<t.length;++X){const K=t[X];V?this._materialForRendering[K.uniqueId]=[K,V]:delete this._materialForRendering[K.uniqueId]}else V?this._materialForRendering[t.uniqueId]=[t,V]:delete this._materialForRendering[t.uniqueId]}getEffectIntensity(t){var V;return null!==(V=this._effectIntensity[t.uniqueId])&&void 0!==V?V:1}setEffectIntensity(t,V){this._effectIntensity[t.uniqueId]=V}constructor(t,V,X=!1){this._vertexBuffers={},this._maxSize=0,this._mainTextureDesiredSize={width:0,height:0},this._shouldRender=!0,this._postProcesses=[],this._textures=[],this._emissiveTextureAndColor={texture:null,color:new I.ov},this._effectIntensity={},this.neutralColor=new I.ov,this.isEnabled=!0,this.disableBoundingBoxesFromEffectLayer=!1,this.onDisposeObservable=new $.cP,this.onBeforeRenderMainTextureObservable=new $.cP,this.onBeforeComposeObservable=new $.cP,this.onBeforeRenderMeshToEffect=new $.cP,this.onAfterRenderMeshToEffect=new $.cP,this.onAfterComposeObservable=new $.cP,this.onSizeChangedObservable=new $.cP,this._shaderLanguage=0,this._materialForRendering={},this._shadersLoaded=!1,this.name=t,this._scene=V||C.q.LastCreatedScene,W._SceneComponentInitialization(this._scene),!this._scene.getEngine().isWebGPU||X||W.ForceGLSL||(this._shaderLanguage=1),this._engine=this._scene.getEngine(),this._maxSize=this._engine.getCaps().maxTextureSize,this._scene.effectLayers.push(this),this._mergeDrawWrapper=[],this._generateIndexBuffer(),this._generateVertexBuffer()}_numInternalDraws(){return 1}_init(t){this._effectLayerOptions={mainTextureRatio:.5,alphaBlendingMode:2,camera:null,renderingGroupId:-1,mainTextureType:0,generateStencilBuffer:!1,...t},this._setMainTextureSize(),this._createMainTexture(),this._createTextureAndPostProcesses()}_generateIndexBuffer(){const t=[];t.push(0),t.push(1),t.push(2),t.push(0),t.push(2),t.push(3),this._indexBuffer=this._engine.createIndexBuffer(t)}_generateVertexBuffer(){const t=[];t.push(1,1),t.push(-1,1),t.push(-1,-1),t.push(1,-1);const V=new n.R(this._engine,t,n.R.PositionKind,!1,!1,2);this._vertexBuffers[n.R.PositionKind]=V}_setMainTextureSize(){this._effectLayerOptions.mainTextureFixedSize?(this._mainTextureDesiredSize.width=this._effectLayerOptions.mainTextureFixedSize,this._mainTextureDesiredSize.height=this._effectLayerOptions.mainTextureFixedSize):(this._mainTextureDesiredSize.width=this._engine.getRenderWidth()*this._effectLayerOptions.mainTextureRatio,this._mainTextureDesiredSize.height=this._engine.getRenderHeight()*this._effectLayerOptions.mainTextureRatio,this._mainTextureDesiredSize.width=this._engine.needPOTTextures?v.R(this._mainTextureDesiredSize.width,this._maxSize):this._mainTextureDesiredSize.width,this._mainTextureDesiredSize.height=this._engine.needPOTTextures?v.R(this._mainTextureDesiredSize.height,this._maxSize):this._mainTextureDesiredSize.height),this._mainTextureDesiredSize.width=Math.floor(this._mainTextureDesiredSize.width),this._mainTextureDesiredSize.height=Math.floor(this._mainTextureDesiredSize.height)}_createMainTexture(){this._mainTexture=new R.$("EffectLayerMainRTT",{width:this._mainTextureDesiredSize.width,height:this._mainTextureDesiredSize.height},this._scene,!1,!0,this._effectLayerOptions.mainTextureType,!1,q.g.TRILINEAR_SAMPLINGMODE,!0,this._effectLayerOptions.generateStencilBuffer),this._mainTexture.activeCamera=this._effectLayerOptions.camera,this._mainTexture.wrapU=q.g.CLAMP_ADDRESSMODE,this._mainTexture.wrapV=q.g.CLAMP_ADDRESSMODE,this._mainTexture.anisotropicFilteringLevel=1,this._mainTexture.updateSamplingMode(q.g.BILINEAR_SAMPLINGMODE),this._mainTexture.renderParticles=!1,this._mainTexture.renderList=null,this._mainTexture.ignoreCameraViewport=!0;for(const t in this._materialForRendering){const[V,X]=this._materialForRendering[t];this._mainTexture.setMaterialForRendering(V,X)}if(this._mainTexture.customIsReadyFunction=(t,V,X)=>{if((X||0===V)&&t.subMeshes)for(let V=0;V<t.subMeshes.length;++V){const X=t.subMeshes[V],K=X.getMaterial(),k=X.getRenderingMesh();if(!K)continue;const A=k._getInstancesRenderList(X._id,!!X.getReplacementMesh()).hardwareInstancedRendering[X._id]||k.hasThinInstances;if(this._setEmissiveTextureAndColor(k,X,K),!this._isReady(X,A,this._emissiveTextureAndColor.texture))return!1}return!0},this._mainTexture.customRenderFunction=(t,V,X,K)=>{let k;this.onBeforeRenderMainTextureObservable.notifyObservers(this);const A=this._scene.getEngine();if(K.length){for(A.setColorWrite(!1),k=0;k<K.length;k++)this._renderSubMesh(K.data[k]);A.setColorWrite(!0)}for(k=0;k<t.length;k++)this._renderSubMesh(t.data[k]);for(k=0;k<V.length;k++)this._renderSubMesh(V.data[k]);const $=A.getAlphaMode();for(k=0;k<X.length;k++){const t=X.data[k],V=t.getMaterial();if(V&&V.needDepthPrePass){const X=V.getScene().getEngine();X.setColorWrite(!1),this._renderSubMesh(t),X.setColorWrite(!0)}this._renderSubMesh(t,!0)}A.setAlphaMode($)},this._mainTexture.onClearObservable.add((t=>{t.clear(this.neutralColor,!0,!0,!0)})),this._scene.getBoundingBoxRenderer){const t=this._scene.getBoundingBoxRenderer().enabled;this._mainTexture.onBeforeBindObservable.add((()=>{this._scene.getBoundingBoxRenderer().enabled=!this.disableBoundingBoxesFromEffectLayer&&t})),this._mainTexture.onAfterUnbindObservable.add((()=>{this._scene.getBoundingBoxRenderer().enabled=t}))}}_addCustomEffectDefines(t){}_isReady(t,V,X){var K;const k=this._scene.getEngine(),A=t.getMesh(),$=null===(K=A._internalAbstractMeshDataInfo._materialForRenderPass)||void 0===K?void 0:K[k.currentRenderPassId];if($)return $.isReadyForSubMesh(A,t,V);const I=t.getMaterial();if(!I)return!1;if(this._useMeshMaterial(t.getRenderingMesh()))return I.isReadyForSubMesh(t.getMesh(),t,V);const C=[],q=[n.R.PositionKind];let R=!1,s=!1;if(I){const t=I.needAlphaTesting(),V=I.getAlphaTestTexture(),X=V&&V.hasAlpha&&(I.useAlphaFromDiffuseTexture||I._useAlphaFromAlbedoTexture);V&&(t||X)&&(C.push("#define DIFFUSE"),A.isVerticesDataPresent(n.R.UV2Kind)&&1===V.coordinatesIndex?(C.push("#define DIFFUSEUV2"),s=!0):A.isVerticesDataPresent(n.R.UVKind)&&(C.push("#define DIFFUSEUV1"),R=!0),t&&(C.push("#define ALPHATEST"),C.push("#define ALPHATESTVALUE 0.4")),V.gammaSpace||C.push("#define DIFFUSE_ISLINEAR"));const K=I.opacityTexture;K&&(C.push("#define OPACITY"),A.isVerticesDataPresent(n.R.UV2Kind)&&1===K.coordinatesIndex?(C.push("#define OPACITYUV2"),s=!0):A.isVerticesDataPresent(n.R.UVKind)&&(C.push("#define OPACITYUV1"),R=!0))}X&&(C.push("#define EMISSIVE"),A.isVerticesDataPresent(n.R.UV2Kind)&&1===X.coordinatesIndex?(C.push("#define EMISSIVEUV2"),s=!0):A.isVerticesDataPresent(n.R.UVKind)&&(C.push("#define EMISSIVEUV1"),R=!0),X.gammaSpace||C.push("#define EMISSIVE_ISLINEAR")),A.useVertexColors&&A.isVerticesDataPresent(n.R.ColorKind)&&A.hasVertexAlpha&&I.transparencyMode!==F.i.MATERIAL_OPAQUE&&(q.push(n.R.ColorKind),C.push("#define VERTEXALPHA")),R&&(q.push(n.R.UVKind),C.push("#define UV1")),s&&(q.push(n.R.UV2Kind),C.push("#define UV2"));const c=new S.J;if(A.useBones&&A.computeBonesUsingShaders){q.push(n.R.MatricesIndicesKind),q.push(n.R.MatricesWeightsKind),A.numBoneInfluencers>4&&(q.push(n.R.MatricesIndicesExtraKind),q.push(n.R.MatricesWeightsExtraKind)),C.push("#define NUM_BONE_INFLUENCERS "+A.numBoneInfluencers);const t=A.skeleton;t&&t.isUsingTextureForMatrices?C.push("#define BONETEXTURE"):C.push("#define BonesPerMesh "+(t?t.bones.length+1:0)),A.numBoneInfluencers>0&&c.addCPUSkinningFallback(0,A)}else C.push("#define NUM_BONE_INFLUENCERS 0");const v=A.morphTargetManager;let W=0;v&&(W=v.numMaxInfluencers||v.numInfluencers,W>0&&(C.push("#define MORPHTARGETS"),C.push("#define NUM_MORPH_INFLUENCERS "+W),v.isUsingTextureForTargets&&C.push("#define MORPHTARGETS_TEXTURE"),m.MF(q,A,W))),V&&(C.push("#define INSTANCES"),m.te(q),t.getRenderingMesh().hasThinInstances&&C.push("#define THIN_INSTANCES")),N.tv(I,this._scene,C),this._addCustomEffectDefines(C);const Z=t._getDrawWrapper(void 0,!0),D=Z.defines,y=C.join("\n");if(D!==y){const t=["world","mBones","viewProjection","glowColor","morphTargetInfluences","morphTargetCount","boneTextureWidth","diffuseMatrix","emissiveMatrix","opacityMatrix","opacityIntensity","morphTargetTextureInfo","morphTargetTextureIndices","glowIntensity"];N.TV(t),Z.setEffect(this._engine.createEffect("glowMapGeneration",q,t,["diffuseSampler","emissiveSampler","opacitySampler","boneSampler","morphTargets"],y,c,void 0,void 0,{maxSimultaneousMorphTargets:W},this._shaderLanguage,this._shadersLoaded?void 0:async()=>{await this._importShadersAsync(),this._shadersLoaded=!0}),y)}return Z.effect.isReady()}async _importShadersAsync(){1===this._shaderLanguage?await Promise.all([X.e(85604).then(X.bind(X,685604)),X.e(70254).then(X.bind(X,670254))]):await Promise.all([X.e(35391).then(X.bind(X,835391)),X.e(37109).then(X.bind(X,737109))])}render(){for(let t=0;t<this._postProcesses.length;t++)if(!this._postProcesses[t].isReady())return;const t=this._scene.getEngine(),V=this._numInternalDraws();let X=!0;for(let t=0;t<V;++t){let V=this._mergeDrawWrapper[t];V||(V=this._mergeDrawWrapper[t]=new c.E(this._engine),V.setEffect(this._createMergeEffect())),X=X&&V.effect.isReady()}if(!X)return;this.onBeforeComposeObservable.notifyObservers(this);const K=t.getAlphaMode();for(let X=0;X<V;++X){const V=this._mergeDrawWrapper[X];t.enableEffect(V),t.setState(!1),t.bindBuffers(this._vertexBuffers,this._indexBuffer,V.effect),t.setAlphaMode(this._effectLayerOptions.alphaBlendingMode),this._internalRender(V.effect,X)}t.setAlphaMode(K),this.onAfterComposeObservable.notifyObservers(this);const k=this._mainTexture.getSize();this._setMainTextureSize(),k.width===this._mainTextureDesiredSize.width&&k.height===this._mainTextureDesiredSize.height||0===this._mainTextureDesiredSize.width||0===this._mainTextureDesiredSize.height||(this.onSizeChangedObservable.notifyObservers(this),this._disposeTextureAndPostProcesses(),this._createMainTexture(),this._createTextureAndPostProcesses())}hasMesh(t){return-1===this.renderingGroupId||t.renderingGroupId===this.renderingGroupId}shouldRender(){return this.isEnabled&&this._shouldRender}_shouldRenderMesh(t){return!0}_canRenderMesh(t,V){return!V.needAlphaBlendingForMesh(t)}_shouldRenderEmissiveTextureForMesh(){return!0}_renderSubMesh(t,V=!1){var X;if(!this.shouldRender())return;const K=t.getMaterial(),k=t.getMesh(),A=t.getReplacementMesh(),$=t.getRenderingMesh(),I=t.getEffectiveMesh(),C=this._scene,n=C.getEngine();if(I._internalAbstractMeshDataInfo._isActiveIntermediate=!1,!K)return;if(!this._canRenderMesh($,K))return;let q=K._getEffectiveOrientation($);I._getWorldMatrixDeterminant()<0&&(q=q===F.i.ClockWiseSideOrientation?F.i.CounterClockWiseSideOrientation:F.i.ClockWiseSideOrientation);const R=q===F.i.ClockWiseSideOrientation;n.setState(K.backFaceCulling,K.zOffset,void 0,R,K.cullBackFaces,void 0,K.zOffsetUnits);const s=$._getInstancesRenderList(t._id,!!A);if(s.mustReturn)return;if(!this._shouldRenderMesh($))return;const S=s.hardwareInstancedRendering[t._id]||$.hasThinInstances;if(this._setEmissiveTextureAndColor($,t,K),this.onBeforeRenderMeshToEffect.notifyObservers(k),this._useMeshMaterial($))$.render(t,V,A||void 0);else if(this._isReady(t,S,this._emissiveTextureAndColor.texture)){const k=null===(X=I._internalAbstractMeshDataInfo._materialForRenderPass)||void 0===X?void 0:X[n.currentRenderPassId];let A=t._getDrawWrapper();if(!A&&k&&(A=k._getDrawWrapper()),!A)return;const q=A.effect;if(n.enableEffect(A),S||$._bind(t,q,K.fillMode),k?k.bindForSubMesh(I.getWorldMatrix(),I,t):(q.setMatrix("viewProjection",C.getTransformMatrix()),q.setMatrix("world",I.getWorldMatrix()),q.setFloat4("glowColor",this._emissiveTextureAndColor.color.r,this._emissiveTextureAndColor.color.g,this._emissiveTextureAndColor.color.b,this._emissiveTextureAndColor.color.a)),!k){const t=K.needAlphaTesting(),X=K.getAlphaTestTexture(),k=X&&X.hasAlpha&&(K.useAlphaFromDiffuseTexture||K._useAlphaFromAlbedoTexture);if(X&&(t||k)){q.setTexture("diffuseSampler",X);const t=X.getTextureMatrix();t&&q.setMatrix("diffuseMatrix",t)}const A=K.opacityTexture;if(A){q.setTexture("opacitySampler",A),q.setFloat("opacityIntensity",A.level);const t=A.getTextureMatrix();t&&q.setMatrix("opacityMatrix",t)}if(this._emissiveTextureAndColor.texture&&(q.setTexture("emissiveSampler",this._emissiveTextureAndColor.texture),q.setMatrix("emissiveMatrix",this._emissiveTextureAndColor.texture.getTextureMatrix())),$.useBones&&$.computeBonesUsingShaders&&$.skeleton){const t=$.skeleton;if(t.isUsingTextureForMatrices){const V=t.getTransformMatrixTexture($);if(!V)return;q.setTexture("boneSampler",V),q.setFloat("boneTextureWidth",4*(t.bones.length+1))}else q.setMatrices("mBones",t.getTransformMatrices($))}m.nR($,q),$.morphTargetManager&&$.morphTargetManager.isUsingTextureForTargets&&$.morphTargetManager._bind(q),V&&n.setAlphaMode(K.alphaMode),q.setFloat("glowIntensity",this.getEffectIntensity($)),N.gS(q,K,C)}$._processRendering(I,t,q,K.fillMode,s,S,((t,V)=>q.setMatrix("world",V)))}else this._mainTexture.resetRefreshCounter();this.onAfterRenderMeshToEffect.notifyObservers(k)}_useMeshMaterial(t){return!1}_rebuild(){const t=this._vertexBuffers[n.R.PositionKind];t&&t._rebuild(),this._generateIndexBuffer()}_disposeTextureAndPostProcesses(){this._mainTexture.dispose();for(let t=0;t<this._postProcesses.length;t++)this._postProcesses[t]&&this._postProcesses[t].dispose();this._postProcesses=[];for(let t=0;t<this._textures.length;t++)this._textures[t]&&this._textures[t].dispose();this._textures=[]}dispose(){const t=this._vertexBuffers[n.R.PositionKind];t&&(t.dispose(),this._vertexBuffers[n.R.PositionKind]=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null);for(const t of this._mergeDrawWrapper)t.dispose();this._mergeDrawWrapper=[],this._disposeTextureAndPostProcesses();const V=this._scene.effectLayers.indexOf(this,0);V>-1&&this._scene.effectLayers.splice(V,1),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onBeforeRenderMainTextureObservable.clear(),this.onBeforeComposeObservable.clear(),this.onBeforeRenderMeshToEffect.clear(),this.onAfterRenderMeshToEffect.clear(),this.onAfterComposeObservable.clear(),this.onSizeChangedObservable.clear()}getClassName(){return"EffectLayer"}static Parse(t,V,X){return A.S0.Instantiate(t.customType).Parse(t,V,X)}}W.ForceGLSL=!1,W._SceneComponentInitialization=t=>{throw s.n("EffectLayerSceneComponent")},K.Cg([k.lK()],W.prototype,"name",void 0),K.Cg([k.qK()],W.prototype,"neutralColor",void 0),K.Cg([k.lK()],W.prototype,"isEnabled",void 0),K.Cg([k.fW()],W.prototype,"camera",null),K.Cg([k.lK()],W.prototype,"renderingGroupId",null),K.Cg([k.lK()],W.prototype,"disableBoundingBoxesFromEffectLayer",void 0)},466837:(t,V,X)=>{X.d(V,{U:()=>C});var K=X(564135),k=X(122030),A=X(431906),$=X(837475),I=X(395726);$.d.AddParser(k.v.NAME_EFFECTLAYER,((t,V,X,K)=>{if(t.effectLayers){X.effectLayers||(X.effectLayers=[]);for(let k=0;k<t.effectLayers.length;k++){const $=A.p.Parse(t.effectLayers[k],V,K);X.effectLayers.push($)}}})),$.d.prototype.removeEffectLayer=function(t){const V=this.effectLayers.indexOf(t);return-1!==V&&this.effectLayers.splice(V,1),V},$.d.prototype.addEffectLayer=function(t){this.effectLayers.push(t)};class C{constructor(t){this.name=k.v.NAME_EFFECTLAYER,this._renderEffects=!1,this._needStencil=!1,this._previousStencilState=!1,this.scene=t||I.q.LastCreatedScene,this.scene&&(this._engine=this.scene.getEngine(),this.scene.effectLayers=[])}register(){this.scene._isReadyForMeshStage.registerStep(k.v.STEP_ISREADYFORMESH_EFFECTLAYER,this,this._isReadyForMesh),this.scene._cameraDrawRenderTargetStage.registerStep(k.v.STEP_CAMERADRAWRENDERTARGET_EFFECTLAYER,this,this._renderMainTexture),this.scene._beforeCameraDrawStage.registerStep(k.v.STEP_BEFORECAMERADRAW_EFFECTLAYER,this,this._setStencil),this.scene._afterRenderingGroupDrawStage.registerStep(k.v.STEP_AFTERRENDERINGGROUPDRAW_EFFECTLAYER_DRAW,this,this._drawRenderingGroup),this.scene._afterCameraDrawStage.registerStep(k.v.STEP_AFTERCAMERADRAW_EFFECTLAYER,this,this._setStencilBack),this.scene._afterCameraDrawStage.registerStep(k.v.STEP_AFTERCAMERADRAW_EFFECTLAYER_DRAW,this,this._drawCamera)}rebuild(){const t=this.scene.effectLayers;for(const V of t)V._rebuild()}serialize(t){t.effectLayers=[];const V=this.scene.effectLayers;for(const X of V)X.serialize&&t.effectLayers.push(X.serialize())}addFromContainer(t){t.effectLayers&&t.effectLayers.forEach((t=>{this.scene.addEffectLayer(t)}))}removeFromContainer(t,V){t.effectLayers&&t.effectLayers.forEach((t=>{this.scene.removeEffectLayer(t),V&&t.dispose()}))}dispose(){const t=this.scene.effectLayers;for(;t.length;)t[0].dispose()}_isReadyForMesh(t,V){const X=this._engine.currentRenderPassId,K=this.scene.effectLayers;for(const k of K){if(!k.hasMesh(t))continue;const K=k._mainTexture;this._engine.currentRenderPassId=K.renderPassId;for(const K of t.subMeshes)if(!k.isReady(K,V))return this._engine.currentRenderPassId=X,!1}return this._engine.currentRenderPassId=X,!0}_renderMainTexture(t){this._renderEffects=!1,this._needStencil=!1;let V=!1;const X=this.scene.effectLayers;if(X&&X.length>0){this._previousStencilState=this._engine.getStencilBuffer();for(const k of X)if(k.shouldRender()&&(!k.camera||k.camera.cameraRigMode===K.i.RIG_MODE_NONE&&t===k.camera||k.camera.cameraRigMode!==K.i.RIG_MODE_NONE&&k.camera._rigCameras.indexOf(t)>-1)){this._renderEffects=!0,this._needStencil=this._needStencil||k.needStencil();const t=k._mainTexture;t._shouldRender()&&(this.scene.incrementRenderId(),t.render(!1,!1),V=!0)}this.scene.incrementRenderId()}return V}_setStencil(){this._needStencil&&this._engine.setStencilBuffer(!0)}_setStencilBack(){this._needStencil&&this._engine.setStencilBuffer(this._previousStencilState)}_draw(t){if(this._renderEffects){this._engine.setDepthBuffer(!1);const V=this.scene.effectLayers;for(let X=0;X<V.length;X++){const K=V[X];K.renderingGroupId===t&&K.shouldRender()&&K.render()}this._engine.setDepthBuffer(!0)}}_drawCamera(){this._renderEffects&&this._draw(-1)}_drawRenderingGroup(t){!this.scene._isInIntermediateRendering()&&this._renderEffects&&this._draw(t)}}A.p._SceneComponentInitialization=t=>{let V=t._getComponent(k.v.NAME_EFFECTLAYER);V||(V=new C(t),t._addComponent(V))}},381810:(t,V,X)=>{X.d(V,{V:()=>m});var K=X(297809),k=X(760998),A=X(604910),$=X(23987),I=X(432050),C=X(888413),n=X(55973),q=X(958413),R=X(431906),F=X(837475),s=X(310035),S=X(332290),c=(X(466837),X(337776)),N=X(104270);F.d.prototype.getGlowLayerByName=function(t){var V;for(let X=0;X<(null===(V=this.effectLayers)||void 0===V?void 0:V.length);X++)if(this.effectLayers[X].name===t&&this.effectLayers[X].getEffectName()===m.EffectName)return this.effectLayers[X];return null};class m extends R.p{set blurKernelSize(t){if(t===this._options.blurKernelSize)return;this._options.blurKernelSize=t;const V=this._getEffectiveBlurKernelSize();this._horizontalBlurPostprocess1.kernel=V,this._verticalBlurPostprocess1.kernel=V,this._horizontalBlurPostprocess2.kernel=V,this._verticalBlurPostprocess2.kernel=V}get blurKernelSize(){return this._options.blurKernelSize}set intensity(t){this._intensity=t}get intensity(){return this._intensity}constructor(t,V,X){super(t,V),this._intensity=1,this._includedOnlyMeshes=[],this._excludedMeshes=[],this._meshesUsingTheirOwnMaterials=[],this.neutralColor=new S.ov(0,0,0,1),this._options={mainTextureRatio:m.DefaultTextureRatio,blurKernelSize:32,mainTextureFixedSize:void 0,camera:null,mainTextureSamples:1,renderingGroupId:-1,ldrMerge:!1,alphaBlendingMode:1,mainTextureType:0,generateStencilBuffer:!1,...X},this._init({alphaBlendingMode:this._options.alphaBlendingMode,camera:this._options.camera,mainTextureFixedSize:this._options.mainTextureFixedSize,mainTextureRatio:this._options.mainTextureRatio,renderingGroupId:this._options.renderingGroupId,mainTextureType:this._options.mainTextureType,generateStencilBuffer:this._options.generateStencilBuffer})}async _importShadersAsync(){1===this._shaderLanguage?await Promise.all([X.e(43102).then(X.bind(X,43102)),X.e(10548).then(X.bind(X,710548)),X.e(58610).then(X.bind(X,58610))]):await Promise.all([X.e(34087).then(X.bind(X,434087)),X.e(38337).then(X.bind(X,238337)),X.e(1773).then(X.bind(X,701773))]),await super._importShadersAsync()}getEffectName(){return m.EffectName}_createMergeEffect(){let t="#define EMISSIVE \n";return this._options.ldrMerge&&(t+="#define LDR \n"),this._engine.createEffect("glowMapMerge",[$.R.PositionKind],["offset"],["textureSampler","textureSampler2"],t,void 0,void 0,void 0,void 0,this.shaderLanguage,this._shadersLoaded?void 0:async()=>{await this._importShadersAsync(),this._shadersLoaded=!0})}_createTextureAndPostProcesses(){let t=this._mainTextureDesiredSize.width,V=this._mainTextureDesiredSize.height;t=this._engine.needPOTTextures?N.R(t,this._maxSize):t,V=this._engine.needPOTTextures?N.R(V,this._maxSize):V;let X=0;X=this._engine.getCaps().textureHalfFloatRender?2:0,this._blurTexture1=new C.$("GlowLayerBlurRTT",{width:t,height:V},this._scene,!1,!0,X),this._blurTexture1.wrapU=I.g.CLAMP_ADDRESSMODE,this._blurTexture1.wrapV=I.g.CLAMP_ADDRESSMODE,this._blurTexture1.updateSamplingMode(I.g.BILINEAR_SAMPLINGMODE),this._blurTexture1.renderParticles=!1,this._blurTexture1.ignoreCameraViewport=!0;const K=Math.floor(t/2),k=Math.floor(V/2);this._blurTexture2=new C.$("GlowLayerBlurRTT2",{width:K,height:k},this._scene,!1,!0,X),this._blurTexture2.wrapU=I.g.CLAMP_ADDRESSMODE,this._blurTexture2.wrapV=I.g.CLAMP_ADDRESSMODE,this._blurTexture2.updateSamplingMode(I.g.BILINEAR_SAMPLINGMODE),this._blurTexture2.renderParticles=!1,this._blurTexture2.ignoreCameraViewport=!0,this._textures=[this._blurTexture1,this._blurTexture2];const $=this._getEffectiveBlurKernelSize();this._horizontalBlurPostprocess1=new q.j("GlowLayerHBP1",new A.I9(1,0),$,{width:t,height:V},null,I.g.BILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1,X),this._horizontalBlurPostprocess1.width=t,this._horizontalBlurPostprocess1.height=V,this._horizontalBlurPostprocess1.externalTextureSamplerBinding=!0,this._horizontalBlurPostprocess1.onApplyObservable.add((t=>{t.setTexture("textureSampler",this._mainTexture)})),this._verticalBlurPostprocess1=new q.j("GlowLayerVBP1",new A.I9(0,1),$,{width:t,height:V},null,I.g.BILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1,X),this._horizontalBlurPostprocess2=new q.j("GlowLayerHBP2",new A.I9(1,0),$,{width:K,height:k},null,I.g.BILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1,X),this._horizontalBlurPostprocess2.width=K,this._horizontalBlurPostprocess2.height=k,this._horizontalBlurPostprocess2.externalTextureSamplerBinding=!0,this._horizontalBlurPostprocess2.onApplyObservable.add((t=>{t.setTexture("textureSampler",this._blurTexture1)})),this._verticalBlurPostprocess2=new q.j("GlowLayerVBP2",new A.I9(0,1),$,{width:K,height:k},null,I.g.BILINEAR_SAMPLINGMODE,this._scene.getEngine(),!1,X),this._postProcesses=[this._horizontalBlurPostprocess1,this._verticalBlurPostprocess1,this._horizontalBlurPostprocess2,this._verticalBlurPostprocess2],this._postProcesses1=[this._horizontalBlurPostprocess1,this._verticalBlurPostprocess1],this._postProcesses2=[this._horizontalBlurPostprocess2,this._verticalBlurPostprocess2],this._mainTexture.samples=this._options.mainTextureSamples,this._mainTexture.onAfterUnbindObservable.add((()=>{const t=this._blurTexture1.renderTarget;if(t){this._scene.postProcessManager.directRender(this._postProcesses1,t,!0);const V=this._blurTexture2.renderTarget;V&&this._scene.postProcessManager.directRender(this._postProcesses2,V,!0),this._engine.unBindFramebuffer(null!=V?V:t,!0)}})),this._postProcesses.map((t=>{t.autoClear=!1}))}_getEffectiveBlurKernelSize(){return this._options.blurKernelSize/2}isReady(t,V){const X=t.getMaterial(),K=t.getRenderingMesh();if(!X||!K)return!1;const k=X.emissiveTexture;return super._isReady(t,V,k)}needStencil(){return!1}_canRenderMesh(t,V){return!0}_internalRender(t){t.setTexture("textureSampler",this._blurTexture1),t.setTexture("textureSampler2",this._blurTexture2),t.setFloat("offset",this._intensity);const V=this._engine,X=V.getStencilBuffer();V.setStencilBuffer(!1),V.drawElementsType(n.i.TriangleFillMode,0,6),V.setStencilBuffer(X)}_setEmissiveTextureAndColor(t,V,X){var K;let k=1;this.customEmissiveTextureSelector?this._emissiveTextureAndColor.texture=this.customEmissiveTextureSelector(t,V,X):X?(this._emissiveTextureAndColor.texture=X.emissiveTexture,this._emissiveTextureAndColor.texture&&(k=this._emissiveTextureAndColor.texture.level)):this._emissiveTextureAndColor.texture=null,this.customEmissiveColorSelector?this.customEmissiveColorSelector(t,V,X,this._emissiveTextureAndColor.color):X.emissiveColor?(k*=null!==(K=X.emissiveIntensity)&&void 0!==K?K:1,this._emissiveTextureAndColor.color.set(X.emissiveColor.r*k,X.emissiveColor.g*k,X.emissiveColor.b*k,X.alpha)):this._emissiveTextureAndColor.color.set(this.neutralColor.r,this.neutralColor.g,this.neutralColor.b,this.neutralColor.a)}_shouldRenderMesh(t){return this.hasMesh(t)}_addCustomEffectDefines(t){t.push("#define GLOW")}addExcludedMesh(t){-1===this._excludedMeshes.indexOf(t.uniqueId)&&this._excludedMeshes.push(t.uniqueId)}removeExcludedMesh(t){const V=this._excludedMeshes.indexOf(t.uniqueId);-1!==V&&this._excludedMeshes.splice(V,1)}addIncludedOnlyMesh(t){-1===this._includedOnlyMeshes.indexOf(t.uniqueId)&&this._includedOnlyMeshes.push(t.uniqueId)}removeIncludedOnlyMesh(t){const V=this._includedOnlyMeshes.indexOf(t.uniqueId);-1!==V&&this._includedOnlyMeshes.splice(V,1)}hasMesh(t){return!!super.hasMesh(t)&&(this._includedOnlyMeshes.length?-1!==this._includedOnlyMeshes.indexOf(t.uniqueId):!this._excludedMeshes.length||-1===this._excludedMeshes.indexOf(t.uniqueId))}_useMeshMaterial(t){return 0!=this._meshesUsingTheirOwnMaterials.length&&this._meshesUsingTheirOwnMaterials.indexOf(t.uniqueId)>-1}referenceMeshToUseItsOwnMaterial(t){t.resetDrawCache(this._mainTexture.renderPassId),this._meshesUsingTheirOwnMaterials.push(t.uniqueId),t.onDisposeObservable.add((()=>{this._disposeMesh(t)}))}unReferenceMeshFromUsingItsOwnMaterial(t){let V=this._meshesUsingTheirOwnMaterials.indexOf(t.uniqueId);for(;V>=0;)this._meshesUsingTheirOwnMaterials.splice(V,1),V=this._meshesUsingTheirOwnMaterials.indexOf(t.uniqueId);t.resetDrawCache(this._mainTexture.renderPassId)}_disposeMesh(t){this.removeIncludedOnlyMesh(t),this.removeExcludedMesh(t)}getClassName(){return"GlowLayer"}serialize(){const t=c.p.Serialize(this);let V;if(t.customType="BABYLON.GlowLayer",t.includedMeshes=[],this._includedOnlyMeshes.length)for(V=0;V<this._includedOnlyMeshes.length;V++){const X=this._scene.getMeshByUniqueId(this._includedOnlyMeshes[V]);X&&t.includedMeshes.push(X.id)}if(t.excludedMeshes=[],this._excludedMeshes.length)for(V=0;V<this._excludedMeshes.length;V++){const X=this._scene.getMeshByUniqueId(this._excludedMeshes[V]);X&&t.excludedMeshes.push(X.id)}return t}static Parse(t,V,X){const K=c.p.Parse((()=>new m(t.name,V,t.options)),t,V,X);let k;for(k=0;k<t.excludedMeshes.length;k++){const X=V.getMeshById(t.excludedMeshes[k]);X&&K.addExcludedMesh(X)}for(k=0;k<t.includedMeshes.length;k++){const X=V.getMeshById(t.includedMeshes[k]);X&&K.addIncludedOnlyMesh(X)}return K}}m.EffectName="GlowLayer",m.DefaultBlurKernelSize=32,m.DefaultTextureRatio=.5,K.Cg([k.lK()],m.prototype,"blurKernelSize",null),K.Cg([k.lK()],m.prototype,"intensity",null),K.Cg([k.lK("options")],m.prototype,"_options",void 0),s.Y5("BABYLON.GlowLayer",m)},788213:(t,V,X)=>{X.d(V,{ZS:()=>q,og:()=>F,zk:()=>R});var K=X(604910),k=X(332290),A=X(27230),$=X(818696),I=X(889460),C=X(690096),n=X(158548);function q(t){const V=t.height||2;let X=0===t.diameterTop?0:t.diameterTop||t.diameter||1,I=0===t.diameterBottom?0:t.diameterBottom||t.diameter||1;X=X||1e-5,I=I||1e-5;const q=0|(t.tessellation||24),R=0|(t.subdivisions||1),F=!!t.hasRings,s=!!t.enclose,S=0===t.cap?0:t.cap||A.e.CAP_ALL,c=t.arc&&(t.arc<=0||t.arc>1)?1:t.arc||1,N=0===t.sideOrientation?0:t.sideOrientation||$.P.DEFAULTSIDE,m=t.faceUV||new Array(3),v=t.faceColors,W=2+(1+(1!==c&&s?2:0))*(F?R:1);let Z;for(Z=0;Z<W;Z++)v&&void 0===v[Z]&&(v[Z]=new k.ov(1,1,1,1));for(Z=0;Z<W;Z++)m&&void 0===m[Z]&&(m[Z]=new K.IU(0,0,1,1));const D=[],y=[],E=[],_=[],p=[],L=2*Math.PI*c/q;let O,r,z;const w=(I-X)/2/V,b=K.Pq.Zero(),a=K.Pq.Zero(),u=K.Pq.Zero(),j=K.Pq.Zero(),x=K.Pq.Zero(),e=C._0.Y;let Y,H,h,T=1,P=1,Q=0,J=0;for(Y=0;Y<=R;Y++)for(r=Y/R,z=(r*(X-I)+I)/2,T=F&&0!==Y&&Y!==R?2:1,h=0;h<T;h++){for(F&&(P+=h),s&&(P+=2*h),H=0;H<=q;H++)O=H*L,b.x=Math.cos(-O)*z,b.y=-V/2+r*V,b.z=Math.sin(-O)*z,0===X&&Y===R?(a.x=E[E.length-3*(q+1)],a.y=E[E.length-3*(q+1)+1],a.z=E[E.length-3*(q+1)+2]):(a.x=b.x,a.z=b.z,a.y=Math.sqrt(a.x*a.x+a.z*a.z)*w,a.normalize()),0===H&&(u.copyFrom(b),j.copyFrom(a)),y.push(b.x,b.y,b.z),E.push(a.x,a.y,a.z),J=F?Q!==P?m[P].y:m[P].w:m[P].y+(m[P].w-m[P].y)*r,_.push(m[P].x+(m[P].z-m[P].x)*H/q,n.rX?1-J:J),v&&p.push(v[P].r,v[P].g,v[P].b,v[P].a);1!==c&&s&&(y.push(b.x,b.y,b.z),y.push(0,b.y,0),y.push(0,b.y,0),y.push(u.x,u.y,u.z),K.Pq.CrossToRef(e,a,x),x.normalize(),E.push(x.x,x.y,x.z,x.x,x.y,x.z),K.Pq.CrossToRef(j,e,x),x.normalize(),E.push(x.x,x.y,x.z,x.x,x.y,x.z),J=F?Q!==P?m[P+1].y:m[P+1].w:m[P+1].y+(m[P+1].w-m[P+1].y)*r,_.push(m[P+1].x,n.rX?1-J:J),_.push(m[P+1].z,n.rX?1-J:J),J=F?Q!==P?m[P+2].y:m[P+2].w:m[P+2].y+(m[P+2].w-m[P+2].y)*r,_.push(m[P+2].x,n.rX?1-J:J),_.push(m[P+2].z,n.rX?1-J:J),v&&(p.push(v[P+1].r,v[P+1].g,v[P+1].b,v[P+1].a),p.push(v[P+1].r,v[P+1].g,v[P+1].b,v[P+1].a),p.push(v[P+2].r,v[P+2].g,v[P+2].b,v[P+2].a),p.push(v[P+2].r,v[P+2].g,v[P+2].b,v[P+2].a))),Q!==P&&(Q=P)}const U=1!==c&&s?q+4:q;for(Y=0,P=0;P<R;P++){let t=0,V=0,X=0,K=0;for(H=0;H<q;H++)t=Y*(U+1)+H,V=(Y+1)*(U+1)+H,X=Y*(U+1)+(H+1),K=(Y+1)*(U+1)+(H+1),D.push(t,V,X),D.push(K,X,V);1!==c&&s&&(D.push(t+2,V+2,X+2),D.push(K+2,X+2,V+2),D.push(t+4,V+4,X+4),D.push(K+4,X+4,V+4)),Y=F?Y+2:Y+1}const l=t=>{const k=t?X/2:I/2;if(0===k)return;let A,$,C;const R=t?m[W-1]:m[0];let F=null;v&&(F=t?v[W-1]:v[0]);const s=y.length/3,S=t?V/2:-V/2,N=new K.Pq(0,S,0);y.push(N.x,N.y,N.z),E.push(0,t?1:-1,0);const Z=R.y+.5*(R.w-R.y);_.push(R.x+.5*(R.z-R.x),n.rX?1-Z:Z),F&&p.push(F.r,F.g,F.b,F.a);const L=new K.I9(.5,.5);for(C=0;C<=q;C++){A=2*Math.PI*C*c/q;const V=Math.cos(-A),X=Math.sin(-A);$=new K.Pq(V*k,S,X*k);const I=new K.I9(V*L.x+.5,X*L.y+.5);y.push($.x,$.y,$.z),E.push(0,t?1:-1,0);const s=R.y+(R.w-R.y)*I.y;_.push(R.x+(R.z-R.x)*I.x,n.rX?1-s:s),F&&p.push(F.r,F.g,F.b,F.a)}for(C=0;C<q;C++)t?(D.push(s),D.push(s+(C+2)),D.push(s+(C+1))):(D.push(s),D.push(s+(C+1)),D.push(s+(C+2)))};S!==A.e.CAP_START&&S!==A.e.CAP_ALL||l(!1),S!==A.e.CAP_END&&S!==A.e.CAP_ALL||l(!0),$.P._ComputeSides(N,y,D,E,_,t.frontUVs,t.backUVs);const i=new $.P;return i.indices=D,i.positions=y,i.normals=E,i.uvs=_,v&&(i.colors=p),i}function R(t,V={},X){const K=new A.e(t,X);return V.sideOrientation=A.e._GetDefaultSideOrientation(V.sideOrientation),K._originalBuilderSideOrientation=V.sideOrientation,q(V).applyToMesh(K,V.updatable),K}const F={CreateCylinder:R};$.P.CreateCylinder=q,A.e.CreateCylinder=(t,V,X,K,k,$,C,n,q)=>(void 0!==C&&C instanceof I.Z||(void 0!==C&&(q=n||A.e.DEFAULTSIDE,n=C),C=$,$=1),R(t,{height:V,diameterTop:X,diameterBottom:K,tessellation:k,subdivisions:$,sideOrientation:q,updatable:n},C))},858004:(t,V,X)=>{X.d(V,{OD:()=>$,WA:()=>I,x3:()=>C});var K=X(27230),k=X(818696),A=X(158548);function $(t){const V=[],X=[],K=[],$=[],I=t.radius||.5,C=t.tessellation||64,n=t.arc&&(t.arc<=0||t.arc>1)?1:t.arc||1,q=0===t.sideOrientation?0:t.sideOrientation||k.P.DEFAULTSIDE;V.push(0,0,0),$.push(.5,.5);const R=2*Math.PI*n,F=1===n?R/C:R/(C-1);let s=0;for(let t=0;t<C;t++){const t=Math.cos(s),X=Math.sin(s),K=(t+1)/2,k=(1-X)/2;V.push(I*t,I*X,0),$.push(K,A.rX?1-k:k),s+=F}1===n&&(V.push(V[3],V[4],V[5]),$.push($[2],A.rX?1-$[3]:$[3]));const S=V.length/3;for(let t=1;t<S-1;t++)X.push(t+1,0,t);k.P.ComputeNormals(V,X,K),k.P._ComputeSides(q,V,X,K,$,t.frontUVs,t.backUVs);const c=new k.P;return c.indices=X,c.positions=V,c.normals=K,c.uvs=$,c}function I(t,V={},X=null){const k=new K.e(t,X);return V.sideOrientation=K.e._GetDefaultSideOrientation(V.sideOrientation),k._originalBuilderSideOrientation=V.sideOrientation,$(V).applyToMesh(k,V.updatable),k}const C={CreateDisc:I};k.P.CreateDisc=$,K.e.CreateDisc=(t,V,X,K=null,k,A)=>I(t,{radius:V,tessellation:X,sideOrientation:A,updatable:k},K)},815781:(t,V,X)=>{X.d(V,{V:()=>I,a:()=>C});var K=X(604910),k=X(27230),A=X(233687),$=X(808966);function I(t,V,X=null){const I=V.path;let C=V.instance,n=1;void 0!==V.radius?n=V.radius:C&&(n=C._creationDataStorage.radius);const q=V.tessellation||64|0,R=V.radiusFunction||null;let F=V.cap||k.e.NO_CAP;const s=V.invertUV||!1,S=V.updatable,c=k.e._GetDefaultSideOrientation(V.sideOrientation);V.arc=V.arc&&(V.arc<=0||V.arc>1)?1:V.arc||1;const N=(t,V,X,A,$,I,C,n)=>{const q=V.getTangents(),R=V.getNormals(),F=V.getDistances(),s=2*Math.PI/$*n,S=I||(()=>A);let c,N,m,v;const W=K.AA.Matrix[0];let Z=C===k.e.NO_CAP||C===k.e.CAP_END?0:2;for(let V=0;V<t.length;V++){N=S(V,F[V]),c=Array(),m=R[V];for(let X=0;X<$;X++)K.uq.RotationAxisToRef(q[V],s*X,W),v=c[X]?c[X]:K.Pq.Zero(),K.Pq.TransformCoordinatesToRef(m,W,v),v.scaleInPlace(N).addInPlace(t[V]),c[X]=v;X[Z]=c,Z++}const D=(V,X)=>{const K=Array();for(let k=0;k<V;k++)K.push(t[X]);return K};switch(C){case k.e.NO_CAP:break;case k.e.CAP_START:X[0]=D($,0),X[1]=X[2].slice(0);break;case k.e.CAP_END:X[Z]=X[Z-1].slice(0),X[Z+1]=D($,t.length-1);break;case k.e.CAP_ALL:X[0]=D($,0),X[1]=X[2].slice(0),X[Z]=X[Z-1].slice(0),X[Z+1]=D($,t.length-1)}return X};let m,v;if(C){const t=C._creationDataStorage,X=V.arc||t.arc;return m=t.path3D.update(I),v=N(I,m,t.pathArray,n,t.tessellation,R,t.cap,X),C=A.fv("",{pathArray:v,instance:C}),t.path3D=m,t.pathArray=v,t.arc=X,t.radius=n,C}m=new $.tO(I),F=F<0||F>3?0:F,v=N(I,m,new Array,n,q,R,F,V.arc);const W=A.fv(t,{pathArray:v,closePath:!0,closeArray:!1,updatable:S,sideOrientation:c,invertUV:s,frontUVs:V.frontUVs,backUVs:V.backUVs},X);return W._creationDataStorage.pathArray=v,W._creationDataStorage.path3D=m,W._creationDataStorage.tessellation=q,W._creationDataStorage.cap=F,W._creationDataStorage.arc=V.arc,W._creationDataStorage.radius=n,W}const C={CreateTube:I};k.e.CreateTube=(t,V,X,K,k,A,$,C,n,q)=>I(t,{path:V,radius:X,tessellation:K,radiusFunction:k,arc:1,cap:A,updatable:C,sideOrientation:n,instance:q},$)},149445:(t,V,X)=>{X.d(V,{R:()=>K.R});var K=X(23987)},381955:(t,V,X)=>{X.d(V,{SV:()=>$,aC:()=>k,li:()=>A,vB:()=>I});var K=X(332290);class k{constructor(t,V,X){this.gradient=t,this.color1=V,this.color2=X}getColorToRef(t){this.color2?K.ov.LerpToRef(this.color1,this.color2,Math.random(),t):t.copyFrom(this.color1)}}class A{constructor(t,V){this.gradient=t,this.color=V}}class ${constructor(t,V,X){this.gradient=t,this.factor1=V,this.factor2=X}getFactor(){return void 0===this.factor2||this.factor2===this.factor1?this.factor1:this.factor1+(this.factor2-this.factor1)*Math.random()}}class I{static GetCurrentGradient(t,V,X){if(V[0].gradient>t)return void X(V[0],V[0],1);for(let K=0;K<V.length-1;K++){const k=V[K],A=V[K+1];if(t>=k.gradient&&t<=A.gradient)return void X(k,A,(t-k.gradient)/(A.gradient-k.gradient))}const K=V.length-1;X(V[K],V[K],1)}}},137594:(t,V,X)=>{X.d(V,{K:()=>$});var K=X(604910),k=X(241082),A=X(607552);class ${constructor(){this.direction1=new K.Pq(0,1,0),this.direction2=new K.Pq(0,1,0),this.minEmitBox=new K.Pq(-.5,-.5,-.5),this.maxEmitBox=new K.Pq(.5,.5,.5)}startDirectionFunction(t,V,X,A){const $=k.VD(this.direction1.x,this.direction2.x),I=k.VD(this.direction1.y,this.direction2.y),C=k.VD(this.direction1.z,this.direction2.z);if(A)return V.x=$,V.y=I,void(V.z=C);K.Pq.TransformNormalFromFloatsToRef($,I,C,t,V)}startPositionFunction(t,V,X,A){const $=k.VD(this.minEmitBox.x,this.maxEmitBox.x),I=k.VD(this.minEmitBox.y,this.maxEmitBox.y),C=k.VD(this.minEmitBox.z,this.maxEmitBox.z);if(A)return V.x=$,V.y=I,void(V.z=C);K.Pq.TransformCoordinatesFromFloatsToRef($,I,C,t,V)}clone(){const t=new $;return A.r.DeepCopy(this,t),t}applyToShader(t){t.setVector3("direction1",this.direction1),t.setVector3("direction2",this.direction2),t.setVector3("minEmitBox",this.minEmitBox),t.setVector3("maxEmitBox",this.maxEmitBox)}buildUniformLayout(t){t.addUniform("direction1",3),t.addUniform("direction2",3),t.addUniform("minEmitBox",3),t.addUniform("maxEmitBox",3)}getEffectDefines(){return"#define BOXEMITTER"}getClassName(){return"BoxParticleEmitter"}serialize(){const t={};return t.type=this.getClassName(),t.direction1=this.direction1.asArray(),t.direction2=this.direction2.asArray(),t.minEmitBox=this.minEmitBox.asArray(),t.maxEmitBox=this.maxEmitBox.asArray(),t}parse(t){K.Pq.FromArrayToRef(t.direction1,0,this.direction1),K.Pq.FromArrayToRef(t.direction2,0,this.direction2),K.Pq.FromArrayToRef(t.minEmitBox,0,this.minEmitBox),K.Pq.FromArrayToRef(t.maxEmitBox,0,this.maxEmitBox)}}},645912:(t,V,X)=>{X.d(V,{A:()=>$,g:()=>I});var K=X(607552),k=X(604910),A=X(615473);class ${get radius(){return this._radius}set radius(t){this._radius=t,this._buildHeight()}get angle(){return this._angle}set angle(t){this._angle=t,this._buildHeight()}_buildHeight(){0!==this._angle?this._height=this._radius/Math.tan(this._angle/2):this._height=1}constructor(t=1,V=Math.PI,X=0){this.directionRandomizer=X,this.radiusRange=1,this.heightRange=1,this.emitFromSpawnPointOnly=!1,this.angle=V,this.radius=t}startDirectionFunction(t,V,X,K){K?k.AA.Vector3[0].copyFrom(X._localPosition).normalize():X.position.subtractToRef(t.getTranslation(),k.AA.Vector3[0]).normalize();const $=A.X.RandomRange(0,this.directionRandomizer),I=A.X.RandomRange(0,this.directionRandomizer),C=A.X.RandomRange(0,this.directionRandomizer);V.x=k.AA.Vector3[0].x+$,V.y=k.AA.Vector3[0].y+I,V.z=k.AA.Vector3[0].z+C,V.normalize()}startPositionFunction(t,V,X,K){const $=A.X.RandomRange(0,2*Math.PI);let I;this.emitFromSpawnPointOnly?I=1e-4:(I=A.X.RandomRange(0,this.heightRange),I=1-I*I);let C=this._radius-A.X.RandomRange(0,this._radius*this.radiusRange);C*=I;const n=C*Math.sin($),q=C*Math.cos($),R=I*this._height;if(K)return V.x=n,V.y=R,void(V.z=q);k.Pq.TransformCoordinatesFromFloatsToRef(n,R,q,t,V)}clone(){const t=new $(this._radius,this._angle,this.directionRandomizer);return K.r.DeepCopy(this,t),t}applyToShader(t){t.setFloat2("radius",this._radius,this.radiusRange),t.setFloat("coneAngle",this._angle),t.setFloat2("height",this._height,this.heightRange),t.setFloat("directionRandomizer",this.directionRandomizer)}buildUniformLayout(t){t.addUniform("radius",2),t.addUniform("coneAngle",1),t.addUniform("height",2),t.addUniform("directionRandomizer",1)}getEffectDefines(){let t="#define CONEEMITTER";return this.emitFromSpawnPointOnly&&(t+="\n#define CONEEMITTERSPAWNPOINT"),t}getClassName(){return"ConeParticleEmitter"}serialize(){const t={};return t.type=this.getClassName(),t.radius=this._radius,t.angle=this._angle,t.directionRandomizer=this.directionRandomizer,t.radiusRange=this.radiusRange,t.heightRange=this.heightRange,t.emitFromSpawnPointOnly=this.emitFromSpawnPointOnly,t}parse(t){this.radius=t.radius,this.angle=t.angle,this.directionRandomizer=t.directionRandomizer,this.radiusRange=void 0!==t.radiusRange?t.radiusRange:1,this.heightRange=void 0!==t.radiusRange?t.heightRange:1,this.emitFromSpawnPointOnly=void 0!==t.emitFromSpawnPointOnly&&t.emitFromSpawnPointOnly}}class I extends ${constructor(t=1,V=Math.PI,X=new k.Pq(0,1,0),K=new k.Pq(0,1,0)){super(t,V),this.direction1=X,this.direction2=K}startDirectionFunction(t,V){const X=A.X.RandomRange(this.direction1.x,this.direction2.x),K=A.X.RandomRange(this.direction1.y,this.direction2.y),$=A.X.RandomRange(this.direction1.z,this.direction2.z);k.Pq.TransformNormalFromFloatsToRef(X,K,$,t,V)}clone(){const t=new I(this.radius,this.angle,this.direction1,this.direction2);return K.r.DeepCopy(this,t),t}applyToShader(t){t.setFloat("radius",this.radius),t.setFloat("radiusRange",this.radiusRange),t.setVector3("direction1",this.direction1),t.setVector3("direction2",this.direction2)}buildUniformLayout(t){t.addUniform("radius",1),t.addUniform("radiusRange",1),t.addUniform("direction1",3),t.addUniform("direction2",3)}getEffectDefines(){return"#define CONEEMITTER\n#define DIRECTEDCONEEMITTER"}getClassName(){return"ConeDirectedParticleEmitter"}serialize(){const t=super.serialize();return t.direction1=this.direction1.asArray(),t.direction2=this.direction2.asArray(),t}parse(t){super.parse(t),this.direction1.copyFrom(t.direction1),this.direction2.copyFrom(t.direction2)}}},881544:(t,V,X)=>{X.d(V,{A:()=>A});var K=X(607552),k=X(604910);class A{constructor(){this.particlePositionGenerator=()=>{},this.particleDestinationGenerator=()=>{}}startDirectionFunction(t,V,X,K){const A=k.AA.Vector3[0];if(this.particleDestinationGenerator){this.particleDestinationGenerator(-1,X,A);const t=k.AA.Vector3[1];A.subtractToRef(X.position,t),t.scaleToRef(1/X.lifeTime,A)}else A.set(0,0,0);K?V.copyFrom(A):k.Pq.TransformNormalToRef(A,t,V)}startPositionFunction(t,V,X,K){const A=k.AA.Vector3[0];this.particlePositionGenerator?this.particlePositionGenerator(-1,X,A):A.set(0,0,0),K?V.copyFrom(A):k.Pq.TransformCoordinatesToRef(A,t,V)}clone(){const t=new A;return K.r.DeepCopy(this,t),t}applyToShader(t){}buildUniformLayout(t){}getEffectDefines(){return"#define CUSTOMEMITTER"}getClassName(){return"CustomParticleEmitter"}serialize(){const t={};return t.type=this.getClassName(),t.particlePositionGenerator=this.particlePositionGenerator,t.particleDestinationGenerator=this.particleDestinationGenerator,t}parse(t){t.particlePositionGenerator&&(this.particlePositionGenerator=t.particlePositionGenerator),t.particleDestinationGenerator&&(this.particleDestinationGenerator=t.particleDestinationGenerator)}}},843355:(t,V,X)=>{X.d(V,{J:()=>I,l:()=>$});var K=X(604910),k=X(615473),A=X(607552);class ${constructor(t=1,V=1,X=1,k=0){this.radius=t,this.height=V,this.radiusRange=X,this.directionRandomizer=k,this._tempVector=K.Pq.Zero()}startDirectionFunction(t,V,X,A,$){X.position.subtractToRef(t.getTranslation(),this._tempVector),this._tempVector.normalize(),K.Pq.TransformNormalToRef(this._tempVector,$,this._tempVector);const I=k.X.RandomRange(-this.directionRandomizer/2,this.directionRandomizer/2);let C=Math.atan2(this._tempVector.x,this._tempVector.z);C+=k.X.RandomRange(-Math.PI/2,Math.PI/2)*this.directionRandomizer,this._tempVector.y=I,this._tempVector.x=Math.sin(C),this._tempVector.z=Math.cos(C),this._tempVector.normalize(),A?V.copyFrom(this._tempVector):K.Pq.TransformNormalFromFloatsToRef(this._tempVector.x,this._tempVector.y,this._tempVector.z,t,V)}startPositionFunction(t,V,X,A){const $=k.X.RandomRange(-this.height/2,this.height/2),I=k.X.RandomRange(0,2*Math.PI),C=k.X.RandomRange((1-this.radiusRange)*(1-this.radiusRange),1),n=Math.sqrt(C)*this.radius,q=n*Math.cos(I),R=n*Math.sin(I);A?V.copyFromFloats(q,$,R):K.Pq.TransformCoordinatesFromFloatsToRef(q,$,R,t,V)}clone(){const t=new $(this.radius,this.directionRandomizer);return A.r.DeepCopy(this,t),t}applyToShader(t){t.setFloat("radius",this.radius),t.setFloat("height",this.height),t.setFloat("radiusRange",this.radiusRange),t.setFloat("directionRandomizer",this.directionRandomizer)}buildUniformLayout(t){t.addUniform("radius",1),t.addUniform("height",1),t.addUniform("radiusRange",1),t.addUniform("directionRandomizer",1)}getEffectDefines(){return"#define CYLINDEREMITTER"}getClassName(){return"CylinderParticleEmitter"}serialize(){const t={};return t.type=this.getClassName(),t.radius=this.radius,t.height=this.height,t.radiusRange=this.radiusRange,t.directionRandomizer=this.directionRandomizer,t}parse(t){this.radius=t.radius,this.height=t.height,this.radiusRange=t.radiusRange,this.directionRandomizer=t.directionRandomizer}}class I extends ${constructor(t=1,V=1,X=1,k=new K.Pq(0,1,0),A=new K.Pq(0,1,0)){super(t,V,X),this.direction1=k,this.direction2=A}startDirectionFunction(t,V,X,A){const $=k.X.RandomRange(this.direction1.x,this.direction2.x),I=k.X.RandomRange(this.direction1.y,this.direction2.y),C=k.X.RandomRange(this.direction1.z,this.direction2.z);A?V.copyFromFloats($,I,C):K.Pq.TransformNormalFromFloatsToRef($,I,C,t,V)}clone(){const t=new I(this.radius,this.height,this.radiusRange,this.direction1,this.direction2);return A.r.DeepCopy(this,t),t}applyToShader(t){t.setFloat("radius",this.radius),t.setFloat("height",this.height),t.setFloat("radiusRange",this.radiusRange),t.setVector3("direction1",this.direction1),t.setVector3("direction2",this.direction2)}buildUniformLayout(t){t.addUniform("radius",1),t.addUniform("height",1),t.addUniform("radiusRange",1),t.addUniform("direction1",3),t.addUniform("direction2",3)}getEffectDefines(){return"#define CYLINDEREMITTER\n#define DIRECTEDCYLINDEREMITTER"}getClassName(){return"CylinderDirectedParticleEmitter"}serialize(){const t=super.serialize();return t.direction1=this.direction1.asArray(),t.direction2=this.direction2.asArray(),t}parse(t){super.parse(t),K.Pq.FromArrayToRef(t.direction1,0,this.direction1),K.Pq.FromArrayToRef(t.direction2,0,this.direction2)}}},15634:(t,V,X)=>{X.d(V,{w:()=>$});var K=X(607552),k=X(604910),A=X(615473);class ${constructor(t=1,V=1,X=0){this.radius=t,this.radiusRange=V,this.directionRandomizer=X}startDirectionFunction(t,V,X,K){const $=X.position.subtract(t.getTranslation()).normalize(),I=A.X.RandomRange(0,this.directionRandomizer),C=A.X.RandomRange(0,this.directionRandomizer),n=A.X.RandomRange(0,this.directionRandomizer);$.x+=I,$.y+=C,$.z+=n,$.normalize(),K?V.copyFrom($):k.Pq.TransformNormalFromFloatsToRef($.x,$.y,$.z,t,V)}startPositionFunction(t,V,X,K){const $=this.radius-A.X.RandomRange(0,this.radius*this.radiusRange),I=A.X.RandomRange(0,1),C=A.X.RandomRange(0,2*Math.PI),n=Math.acos(2*I-1),q=$*Math.cos(C)*Math.sin(n),R=$*Math.cos(n),F=$*Math.sin(C)*Math.sin(n);K?V.copyFromFloats(q,Math.abs(R),F):k.Pq.TransformCoordinatesFromFloatsToRef(q,Math.abs(R),F,t,V)}clone(){const t=new $(this.radius,this.directionRandomizer);return K.r.DeepCopy(this,t),t}applyToShader(t){t.setFloat("radius",this.radius),t.setFloat("radiusRange",this.radiusRange),t.setFloat("directionRandomizer",this.directionRandomizer)}buildUniformLayout(t){t.addUniform("radius",1),t.addUniform("radiusRange",1),t.addUniform("directionRandomizer",1)}getEffectDefines(){return"#define HEMISPHERICEMITTER"}getClassName(){return"HemisphericParticleEmitter"}serialize(){const t={};return t.type=this.getClassName(),t.radius=this.radius,t.radiusRange=this.radiusRange,t.directionRandomizer=this.directionRandomizer,t}parse(t){this.radius=t.radius,this.radiusRange=t.radiusRange,this.directionRandomizer=t.directionRandomizer}}},11142:(t,V,X)=>{X.d(V,{u:()=>I});var K=X(607552),k=X(604910),A=X(615473),$=X(23987);class I{get mesh(){return this._mesh}set mesh(t){this._mesh!==t&&(this._mesh=t,t?(this._indices=t.getIndices(),this._positions=t.getVerticesData($.R.PositionKind),this._normals=t.getVerticesData($.R.NormalKind)):(this._indices=null,this._positions=null,this._normals=null))}constructor(t=null){this._indices=null,this._positions=null,this._normals=null,this._storedNormal=k.Pq.Zero(),this._mesh=null,this.direction1=new k.Pq(0,1,0),this.direction2=new k.Pq(0,1,0),this.useMeshNormalsForDirection=!0,this.mesh=t}startDirectionFunction(t,V,X,K){if(this.useMeshNormalsForDirection&&this._normals)return void k.Pq.TransformNormalToRef(this._storedNormal,t,V);const $=A.X.RandomRange(this.direction1.x,this.direction2.x),I=A.X.RandomRange(this.direction1.y,this.direction2.y),C=A.X.RandomRange(this.direction1.z,this.direction2.z);K?V.copyFromFloats($,I,C):k.Pq.TransformNormalFromFloatsToRef($,I,C,t,V)}startPositionFunction(t,V,X,K){if(!this._indices||!this._positions)return;const A=3*Math.random()*(this._indices.length/3)|0,$=Math.random(),I=Math.random()*(1-$),C=1-$-I,n=this._indices[A],q=this._indices[A+1],R=this._indices[A+2],F=k.AA.Vector3[0],s=k.AA.Vector3[1],S=k.AA.Vector3[2],c=k.AA.Vector3[3];k.Pq.FromArrayToRef(this._positions,3*n,F),k.Pq.FromArrayToRef(this._positions,3*q,s),k.Pq.FromArrayToRef(this._positions,3*R,S),c.x=$*F.x+I*s.x+C*S.x,c.y=$*F.y+I*s.y+C*S.y,c.z=$*F.z+I*s.z+C*S.z,K?V.copyFromFloats(c.x,c.y,c.z):k.Pq.TransformCoordinatesFromFloatsToRef(c.x,c.y,c.z,t,V),this.useMeshNormalsForDirection&&this._normals&&(k.Pq.FromArrayToRef(this._normals,3*n,F),k.Pq.FromArrayToRef(this._normals,3*q,s),k.Pq.FromArrayToRef(this._normals,3*R,S),this._storedNormal.x=$*F.x+I*s.x+C*S.x,this._storedNormal.y=$*F.y+I*s.y+C*S.y,this._storedNormal.z=$*F.z+I*s.z+C*S.z)}clone(){const t=new I(this.mesh);return K.r.DeepCopy(this,t),t}applyToShader(t){t.setVector3("direction1",this.direction1),t.setVector3("direction2",this.direction2)}buildUniformLayout(t){t.addUniform("direction1",3),t.addUniform("direction2",3)}getEffectDefines(){return""}getClassName(){return"MeshParticleEmitter"}serialize(){var t;const V={};return V.type=this.getClassName(),V.direction1=this.direction1.asArray(),V.direction2=this.direction2.asArray(),V.meshId=null===(t=this.mesh)||void 0===t?void 0:t.id,V.useMeshNormalsForDirection=this.useMeshNormalsForDirection,V}parse(t,V){k.Pq.FromArrayToRef(t.direction1,0,this.direction1),k.Pq.FromArrayToRef(t.direction2,0,this.direction2),t.meshId&&V&&(this.mesh=V.getLastMeshById(t.meshId)),this.useMeshNormalsForDirection=t.useMeshNormalsForDirection}}},265427:(t,V,X)=>{X.d(V,{H:()=>$});var K=X(607552),k=X(604910),A=X(615473);class ${constructor(){this.direction1=new k.Pq(0,1,0),this.direction2=new k.Pq(0,1,0)}startDirectionFunction(t,V,X,K){const $=A.X.RandomRange(this.direction1.x,this.direction2.x),I=A.X.RandomRange(this.direction1.y,this.direction2.y),C=A.X.RandomRange(this.direction1.z,this.direction2.z);K?V.copyFromFloats($,I,C):k.Pq.TransformNormalFromFloatsToRef($,I,C,t,V)}startPositionFunction(t,V,X,K){K?V.copyFromFloats(0,0,0):k.Pq.TransformCoordinatesFromFloatsToRef(0,0,0,t,V)}clone(){const t=new $;return K.r.DeepCopy(this,t),t}applyToShader(t){t.setVector3("direction1",this.direction1),t.setVector3("direction2",this.direction2)}buildUniformLayout(t){t.addUniform("direction1",3),t.addUniform("direction2",3)}getEffectDefines(){return"#define POINTEMITTER"}getClassName(){return"PointParticleEmitter"}serialize(){const t={};return t.type=this.getClassName(),t.direction1=this.direction1.asArray(),t.direction2=this.direction2.asArray(),t}parse(t){k.Pq.FromArrayToRef(t.direction1,0,this.direction1),k.Pq.FromArrayToRef(t.direction2,0,this.direction2)}}},274090:(t,V,X)=>{X.d(V,{Q:()=>$,c:()=>I});var K=X(604910),k=X(615473),A=X(607552);class ${constructor(t=1,V=1,X=0){this.radius=t,this.radiusRange=V,this.directionRandomizer=X}startDirectionFunction(t,V,X,A){const $=X.position.subtract(t.getTranslation()).normalize(),I=k.X.RandomRange(0,this.directionRandomizer),C=k.X.RandomRange(0,this.directionRandomizer),n=k.X.RandomRange(0,this.directionRandomizer);$.x+=I,$.y+=C,$.z+=n,$.normalize(),A?V.copyFrom($):K.Pq.TransformNormalFromFloatsToRef($.x,$.y,$.z,t,V)}startPositionFunction(t,V,X,A){const $=this.radius-k.X.RandomRange(0,this.radius*this.radiusRange),I=k.X.RandomRange(0,1),C=k.X.RandomRange(0,2*Math.PI),n=Math.acos(2*I-1),q=$*Math.cos(C)*Math.sin(n),R=$*Math.cos(n),F=$*Math.sin(C)*Math.sin(n);A?V.copyFromFloats(q,R,F):K.Pq.TransformCoordinatesFromFloatsToRef(q,R,F,t,V)}clone(){const t=new $(this.radius,this.directionRandomizer);return A.r.DeepCopy(this,t),t}applyToShader(t){t.setFloat("radius",this.radius),t.setFloat("radiusRange",this.radiusRange),t.setFloat("directionRandomizer",this.directionRandomizer)}buildUniformLayout(t){t.addUniform("radius",1),t.addUniform("radiusRange",1),t.addUniform("directionRandomizer",1)}getEffectDefines(){return"#define SPHEREEMITTER"}getClassName(){return"SphereParticleEmitter"}serialize(){const t={};return t.type=this.getClassName(),t.radius=this.radius,t.radiusRange=this.radiusRange,t.directionRandomizer=this.directionRandomizer,t}parse(t){this.radius=t.radius,this.radiusRange=t.radiusRange,this.directionRandomizer=t.directionRandomizer}}class I extends ${constructor(t=1,V=new K.Pq(0,1,0),X=new K.Pq(0,1,0)){super(t),this.direction1=V,this.direction2=X}startDirectionFunction(t,V){const X=k.X.RandomRange(this.direction1.x,this.direction2.x),A=k.X.RandomRange(this.direction1.y,this.direction2.y),$=k.X.RandomRange(this.direction1.z,this.direction2.z);K.Pq.TransformNormalFromFloatsToRef(X,A,$,t,V)}clone(){const t=new I(this.radius,this.direction1,this.direction2);return A.r.DeepCopy(this,t),t}applyToShader(t){t.setFloat("radius",this.radius),t.setFloat("radiusRange",this.radiusRange),t.setVector3("direction1",this.direction1),t.setVector3("direction2",this.direction2)}buildUniformLayout(t){t.addUniform("radius",1),t.addUniform("radiusRange",1),t.addUniform("direction1",3),t.addUniform("direction2",3)}getEffectDefines(){return"#define SPHEREEMITTER\n#define DIRECTEDSPHEREEMITTER"}getClassName(){return"SphereDirectedParticleEmitter"}serialize(){const t=super.serialize();return t.direction1=this.direction1.asArray(),t.direction2=this.direction2.asArray(),t}parse(t){super.parse(t),this.direction1.copyFrom(t.direction1),this.direction2.copyFrom(t.direction2)}}},761339:(t,V,X)=>{X.d(V,{L:()=>C});var K=X(604910),k=X(527335);class A extends k.M{constructor(){super(),this.IMAGEPROCESSING=!1,this.VIGNETTE=!1,this.VIGNETTEBLENDMODEMULTIPLY=!1,this.VIGNETTEBLENDMODEOPAQUE=!1,this.TONEMAPPING=0,this.CONTRAST=!1,this.COLORCURVES=!1,this.COLORGRADING=!1,this.COLORGRADING3D=!1,this.SAMPLER3DGREENDEPTH=!1,this.SAMPLER3DBGRMAP=!1,this.DITHER=!1,this.IMAGEPROCESSINGPOSTPROCESS=!1,this.EXPOSURE=!1,this.SKIPFINALCOLORCLAMP=!1,this.rebuild()}}var $=X(332290),I=(X(80157),X(310035));class C{get noiseTexture(){return this._noiseTexture}set noiseTexture(t){this._noiseTexture!==t&&(this._noiseTexture=t,this._reset())}get isAnimationSheetEnabled(){return this._isAnimationSheetEnabled}set isAnimationSheetEnabled(t){this._isAnimationSheetEnabled!=t&&(this._isAnimationSheetEnabled=t,this._reset())}get useLogarithmicDepth(){return this._useLogarithmicDepth}set useLogarithmicDepth(t){this._useLogarithmicDepth=t&&this.getScene().getEngine().getCaps().fragmentDepthSupported}getScene(){return this._scene}_hasTargetStopDurationDependantGradient(){return this._startSizeGradients&&this._startSizeGradients.length>0||this._emitRateGradients&&this._emitRateGradients.length>0||this._lifeTimeGradients&&this._lifeTimeGradients.length>0}getDragGradients(){return this._dragGradients}getLimitVelocityGradients(){return this._limitVelocityGradients}getColorGradients(){return this._colorGradients}getSizeGradients(){return this._sizeGradients}getColorRemapGradients(){return this._colorRemapGradients}getAlphaRemapGradients(){return this._alphaRemapGradients}getLifeTimeGradients(){return this._lifeTimeGradients}getAngularSpeedGradients(){return this._angularSpeedGradients}getVelocityGradients(){return this._velocityGradients}getStartSizeGradients(){return this._startSizeGradients}getEmitRateGradients(){return this._emitRateGradients}get direction1(){return this.particleEmitterType.direction1?this.particleEmitterType.direction1:K.Pq.Zero()}set direction1(t){this.particleEmitterType.direction1&&(this.particleEmitterType.direction1=t)}get direction2(){return this.particleEmitterType.direction2?this.particleEmitterType.direction2:K.Pq.Zero()}set direction2(t){this.particleEmitterType.direction2&&(this.particleEmitterType.direction2=t)}get minEmitBox(){return this.particleEmitterType.minEmitBox?this.particleEmitterType.minEmitBox:K.Pq.Zero()}set minEmitBox(t){this.particleEmitterType.minEmitBox&&(this.particleEmitterType.minEmitBox=t)}get maxEmitBox(){return this.particleEmitterType.maxEmitBox?this.particleEmitterType.maxEmitBox:K.Pq.Zero()}set maxEmitBox(t){this.particleEmitterType.maxEmitBox&&(this.particleEmitterType.maxEmitBox=t)}get billboardMode(){return this._billboardMode}set billboardMode(t){this._billboardMode!==t&&(this._billboardMode=t,this._reset())}get isBillboardBased(){return this._isBillboardBased}set isBillboardBased(t){this._isBillboardBased!==t&&(this._isBillboardBased=t,this._reset())}get imageProcessingConfiguration(){return this._imageProcessingConfiguration}set imageProcessingConfiguration(t){this._attachImageProcessingConfiguration(t)}_attachImageProcessingConfiguration(t){t!==this._imageProcessingConfiguration&&(!t&&this._scene?this._imageProcessingConfiguration=this._scene.imageProcessingConfiguration:this._imageProcessingConfiguration=t)}_reset(){}_removeGradientAndTexture(t,V,X){if(!V)return this;let K=0;for(const X of V){if(X.gradient===t){V.splice(K,1);break}K++}return X&&X.dispose(),this}constructor(t){this.animations=[],this.renderingGroupId=0,this.emitter=K.Pq.Zero(),this.emitRate=10,this.manualEmitCount=-1,this.updateSpeed=.01,this.targetStopDuration=0,this.disposeOnStop=!1,this.minEmitPower=1,this.maxEmitPower=1,this.minLifeTime=1,this.maxLifeTime=1,this.minSize=1,this.maxSize=1,this.minScaleX=1,this.maxScaleX=1,this.minScaleY=1,this.maxScaleY=1,this.minInitialRotation=0,this.maxInitialRotation=0,this.minAngularSpeed=0,this.maxAngularSpeed=0,this.layerMask=268435455,this.customShader=null,this.preventAutoStart=!1,this.applyFog=!1,this._wasDispatched=!1,this._rootUrl="",this.noiseStrength=new K.Pq(10,10,10),this.onAnimationEnd=null,this.blendMode=C.BLENDMODE_ONEONE,this.forceDepthWrite=!1,this.preWarmCycles=0,this.preWarmStepOffset=1,this.spriteCellChangeSpeed=1,this.startSpriteCellID=0,this.endSpriteCellID=0,this.spriteCellWidth=0,this.spriteCellHeight=0,this.spriteCellLoop=!0,this.spriteRandomStartCell=!1,this.translationPivot=new K.I9(0,0),this.beginAnimationOnStart=!1,this.beginAnimationFrom=0,this.beginAnimationTo=60,this.beginAnimationLoop=!1,this.worldOffset=new K.Pq(0,0,0),this._useLogarithmicDepth=!1,this.gravity=K.Pq.Zero(),this._colorGradients=null,this._sizeGradients=null,this._lifeTimeGradients=null,this._angularSpeedGradients=null,this._velocityGradients=null,this._limitVelocityGradients=null,this._dragGradients=null,this._emitRateGradients=null,this._startSizeGradients=null,this._rampGradients=null,this._colorRemapGradients=null,this._alphaRemapGradients=null,this.startDelay=0,this.limitVelocityDamping=.4,this.color1=new $.ov(1,1,1,1),this.color2=new $.ov(1,1,1,1),this.colorDead=new $.ov(0,0,0,1),this.textureMask=new $.ov(1,1,1,1),this._isSubEmitter=!1,this._billboardMode=7,this._isBillboardBased=!0,this._imageProcessingConfigurationDefines=new A,this.id=t,this.name=t}createPointEmitter(t,V){throw new Error("Method not implemented.")}createHemisphericEmitter(t=1,V=1){throw new Error("Method not implemented.")}createSphereEmitter(t=1,V=1){throw new Error("Method not implemented.")}createDirectedSphereEmitter(t=1,V=new K.Pq(0,1,0),X=new K.Pq(0,1,0)){throw new Error("Method not implemented.")}createCylinderEmitter(t=1,V=1,X=1,K=0){throw new Error("Method not implemented.")}createDirectedCylinderEmitter(t=1,V=1,X=1,k=new K.Pq(0,1,0),A=new K.Pq(0,1,0)){throw new Error("Method not implemented.")}createConeEmitter(t=1,V=Math.PI/4){throw new Error("Method not implemented.")}createDirectedConeEmitter(t=1,V=Math.PI/4,X=new K.Pq(0,1,0),k=new K.Pq(0,1,0)){throw new Error("Method not implemented.")}createBoxEmitter(t,V,X,K){throw new Error("Method not implemented.")}}C.BLENDMODE_ONEONE=0,C.BLENDMODE_STANDARD=1,C.BLENDMODE_ADD=2,C.BLENDMODE_MULTIPLY=3,C.BLENDMODE_MULTIPLYADD=4,I.Y5("BABYLON.BaseParticleSystem",C)},482148:(t,V,X)=>{X.d(V,{M:()=>k,x:()=>A});var K=X(948733);class k{constructor(t,V,X,k,A){this.idx=0,this.color=new K.ov(1,1,1,1),this.position=K.Pq.Zero(),this.rotation=K.Pq.Zero(),this.uv=new K.I9(0,0),this.velocity=K.Pq.Zero(),this.pivot=K.Pq.Zero(),this.translateFromPivot=!1,this._pos=0,this._ind=0,this.groupId=0,this.idxInGroup=0,this._stillInvisible=!1,this._rotationMatrix=[1,0,0,0,1,0,0,0,1],this.parentId=null,this._globalPosition=K.Pq.Zero(),this.idx=t,this._group=V,this.groupId=X,this.idxInGroup=k,this._pcs=A}get size(){return this.size}set size(t){this.size=t}get quaternion(){return this.rotationQuaternion}set quaternion(t){this.rotationQuaternion=t}intersectsMesh(t,V){if(!t.hasBoundingInfo)return!1;if(!this._pcs.mesh)throw new Error("Point Cloud System doesnt contain the Mesh");if(V)return t.getBoundingInfo().boundingSphere.intersectsPoint(this.position.add(this._pcs.mesh.position));const X=t.getBoundingInfo().boundingBox,K=X.maximumWorld.x,k=X.minimumWorld.x,A=X.maximumWorld.y,$=X.minimumWorld.y,I=X.maximumWorld.z,C=X.minimumWorld.z,n=this.position.x+this._pcs.mesh.position.x,q=this.position.y+this._pcs.mesh.position.y,R=this.position.z+this._pcs.mesh.position.z;return k<=n&&n<=K&&$<=q&&q<=A&&C<=R&&R<=I}getRotationMatrix(t){let V;if(this.rotationQuaternion)V=this.rotationQuaternion;else{V=K.AA.Quaternion[0];const t=this.rotation;K.PT.RotationYawPitchRollToRef(t.y,t.x,t.z,V)}V.toRotationMatrix(t)}}class A{get groupID(){return this.groupId}set groupID(t){this.groupId=t}constructor(t,V){this.groupId=t,this._positionFunction=V}}},658731:(t,V,X)=>{X.d(V,{J:()=>$});var K=X(604910),k=X(332290),A=X(241082);class ${constructor(t){this.particleSystem=t,this.position=K.Pq.Zero(),this.direction=K.Pq.Zero(),this.color=new k.ov(0,0,0,0),this.colorStep=new k.ov(0,0,0,0),this.lifeTime=1,this.age=0,this.size=0,this.scale=new K.I9(1,1),this.angle=0,this.angularSpeed=0,this.cellIndex=0,this._attachedSubEmitters=null,this._currentColor1=new k.ov(0,0,0,0),this._currentColor2=new k.ov(0,0,0,0),this._currentSize1=0,this._currentSize2=0,this._currentAngularSpeed1=0,this._currentAngularSpeed2=0,this._currentVelocity1=0,this._currentVelocity2=0,this._currentLimitVelocity1=0,this._currentLimitVelocity2=0,this._currentDrag1=0,this._currentDrag2=0,this.id=$._Count++,this.particleSystem.isAnimationSheetEnabled&&this._updateCellInfoFromSystem()}_updateCellInfoFromSystem(){this.cellIndex=this.particleSystem.startSpriteCellID}updateCellIndex(){let t=this.age,V=this.particleSystem.spriteCellChangeSpeed;this.particleSystem.spriteRandomStartCell&&(void 0===this._randomCellOffset&&(this._randomCellOffset=Math.random()*this.lifeTime),0===V?(V=1,t=this._randomCellOffset):t+=this._randomCellOffset);const X=this._initialEndSpriteCellID-this._initialStartSpriteCellID+1;let K;K=this._initialSpriteCellLoop?A.OQ(t*V%this.lifeTime/this.lifeTime):A.OQ(t*V/this.lifeTime),this.cellIndex=this._initialStartSpriteCellID+K*X|0}_inheritParticleInfoToSubEmitter(t){if(t.particleSystem.emitter.position){const V=t.particleSystem.emitter;if(V.position.copyFrom(this.position),t.inheritDirection){const t=K.AA.Vector3[0];this.direction.normalizeToRef(t),V.setDirection(t,0,Math.PI/2)}}else t.particleSystem.emitter.copyFrom(this.position);this.direction.scaleToRef(t.inheritedVelocityAmount/2,K.AA.Vector3[0]),t.particleSystem._inheritedVelocityOffset.copyFrom(K.AA.Vector3[0])}_inheritParticleInfoToSubEmitters(){this._attachedSubEmitters&&this._attachedSubEmitters.length>0&&this._attachedSubEmitters.forEach((t=>{this._inheritParticleInfoToSubEmitter(t)}))}_reset(){this.age=0,this.id=$._Count++,this._currentColorGradient=null,this._currentSizeGradient=null,this._currentAngularSpeedGradient=null,this._currentVelocityGradient=null,this._currentLimitVelocityGradient=null,this._currentDragGradient=null,this.cellIndex=this.particleSystem.startSpriteCellID,this._randomCellOffset=void 0}copyTo(t){t.position.copyFrom(this.position),this._initialDirection?t._initialDirection?t._initialDirection.copyFrom(this._initialDirection):t._initialDirection=this._initialDirection.clone():t._initialDirection=null,t.direction.copyFrom(this.direction),this._localPosition&&(t._localPosition?t._localPosition.copyFrom(this._localPosition):t._localPosition=this._localPosition.clone()),t.color.copyFrom(this.color),t.colorStep.copyFrom(this.colorStep),t.lifeTime=this.lifeTime,t.age=this.age,t._randomCellOffset=this._randomCellOffset,t.size=this.size,t.scale.copyFrom(this.scale),t.angle=this.angle,t.angularSpeed=this.angularSpeed,t.particleSystem=this.particleSystem,t.cellIndex=this.cellIndex,t.id=this.id,t._attachedSubEmitters=this._attachedSubEmitters,this._currentColorGradient&&(t._currentColorGradient=this._currentColorGradient,t._currentColor1.copyFrom(this._currentColor1),t._currentColor2.copyFrom(this._currentColor2)),this._currentSizeGradient&&(t._currentSizeGradient=this._currentSizeGradient,t._currentSize1=this._currentSize1,t._currentSize2=this._currentSize2),this._currentAngularSpeedGradient&&(t._currentAngularSpeedGradient=this._currentAngularSpeedGradient,t._currentAngularSpeed1=this._currentAngularSpeed1,t._currentAngularSpeed2=this._currentAngularSpeed2),this._currentVelocityGradient&&(t._currentVelocityGradient=this._currentVelocityGradient,t._currentVelocity1=this._currentVelocity1,t._currentVelocity2=this._currentVelocity2),this._currentLimitVelocityGradient&&(t._currentLimitVelocityGradient=this._currentLimitVelocityGradient,t._currentLimitVelocity1=this._currentLimitVelocity1,t._currentLimitVelocity2=this._currentLimitVelocity2),this._currentDragGradient&&(t._currentDragGradient=this._currentDragGradient,t._currentDrag1=this._currentDrag1,t._currentDrag2=this._currentDrag2),this.particleSystem.isAnimationSheetEnabled&&(t._initialStartSpriteCellID=this._initialStartSpriteCellID,t._initialEndSpriteCellID=this._initialEndSpriteCellID,t._initialSpriteCellLoop=this._initialSpriteCellLoop),this.particleSystem.useRampGradients&&(t.remapData&&this.remapData?t.remapData.copyFrom(this.remapData):t.remapData=new K.IU(0,0,0,0)),this._randomNoiseCoordinates1&&(t._randomNoiseCoordinates1?(t._randomNoiseCoordinates1.copyFrom(this._randomNoiseCoordinates1),t._randomNoiseCoordinates2.copyFrom(this._randomNoiseCoordinates2)):(t._randomNoiseCoordinates1=this._randomNoiseCoordinates1.clone(),t._randomNoiseCoordinates2=this._randomNoiseCoordinates2.clone()))}}$._Count=0},206749:(t,V,X)=>{X.d(V,{DG:()=>S,Iu:()=>R,PQ:()=>s,Pp:()=>n,gQ:()=>F,kH:()=>c,s5:()=>N,wb:()=>q});var K=X(604910),k=X(265427),A=X(15634),$=X(274090),I=X(843355),C=X(645912);function n(t,V){const X=new k.H;return X.direction1=t,X.direction2=V,X}function q(t=1,V=1){return new A.w(t,V)}function R(t=1,V=1){return new $.Q(t,V)}function F(t=1,V=new K.Pq(0,1,0),X=new K.Pq(0,1,0)){return new $.c(t,V,X)}function s(t=1,V=1,X=1,K=0){return new I.l(t,V,X,K)}function S(t=1,V=1,X=1,k=new K.Pq(0,1,0),A=new K.Pq(0,1,0)){return new I.J(t,V,X,k,A)}function c(t=1,V=Math.PI/4){return new C.A(t,V)}function N(t=1,V=Math.PI/4,X=new K.Pq(0,1,0),k=new K.Pq(0,1,0)){return new C.g(t,V,X,k)}},10203:(t,V,X)=>{X.d(V,{o:()=>b});var K=X(381955),k=X(638113),A=X(604910),$=X(23987),I=X(376976),C=X(395726),n=X(761339),q=X(658731),R=X(964061),F=X(332290),s=(X(889630),X(651577)),S=X(855300),c=X(137594),N=X(241082),m=X(309229);class v extends n.L{set onDispose(t){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(t)}get useRampGradients(){return this._useRampGradients}set useRampGradients(t){this._useRampGradients!==t&&(this._useRampGradients=t,this._resetEffect())}get particles(){return this._particles}get shaderLanguage(){return this._shaderLanguage}getActiveCount(){return this._particles.length}getClassName(){return"ParticleSystem"}isStopping(){return this._stopped&&this.isAlive()}getCustomEffect(t=0){var V,X;return null!==(X=null===(V=this._customWrappers[t])||void 0===V?void 0:V.effect)&&void 0!==X?X:this._customWrappers[0].effect}_getCustomDrawWrapper(t=0){var V;return null!==(V=this._customWrappers[t])&&void 0!==V?V:this._customWrappers[0]}setCustomEffect(t,V=0){this._customWrappers[V]=new R.E(this._engine),this._customWrappers[V].effect=t,this._customWrappers[V].drawContext&&(this._customWrappers[V].drawContext.useInstancing=this._useInstancing)}get onBeforeDrawParticlesObservable(){return this._onBeforeDrawParticlesObservable||(this._onBeforeDrawParticlesObservable=new k.cP),this._onBeforeDrawParticlesObservable}get vertexShaderName(){return"particles"}get vertexBuffers(){return this._vertexBuffers}get indexBuffer(){return this._indexBuffer}constructor(t,V,X,$=null,I=!1,n=.01){super(t),this._emitterInverseWorldMatrix=A.uq.Identity(),this._inheritedVelocityOffset=new A.Pq,this.onDisposeObservable=new k.cP,this.onStoppedObservable=new k.cP,this._particles=new Array,this._stockParticles=new Array,this._newPartsExcess=0,this._vertexBuffers={},this._scaledColorStep=new F.ov(0,0,0,0),this._colorDiff=new F.ov(0,0,0,0),this._scaledDirection=A.Pq.Zero(),this._scaledGravity=A.Pq.Zero(),this._currentRenderId=-1,this._useInstancing=!1,this._started=!1,this._stopped=!1,this._actualFrame=0,this._currentEmitRate1=0,this._currentEmitRate2=0,this._currentStartSize1=0,this._currentStartSize2=0,this.updateInAnimate=!0,this._rawTextureWidth=256,this._useRampGradients=!1,this.isLocal=!1,this.isGPU=!1,this._shaderLanguage=0,this._onBeforeDrawParticlesObservable=null,this._emitFromParticle=t=>{},this.recycleParticle=t=>{const V=this._particles.pop();V!==t&&V.copyTo(t),this._stockParticles.push(V)},this._createParticle=()=>{let t;return 0!==this._stockParticles.length?(t=this._stockParticles.pop(),t._reset()):t=new q.J(this),this._prepareParticle(t),t},this._shadersLoaded=!1,this._capacity=V,this._epsilon=n,this._isAnimationSheetEnabled=I,X&&"Scene"!==X.getClassName()?(this._engine=X,this.defaultProjectionMatrix=A.uq.PerspectiveFovLH(.8,1,.1,100,this._engine.isNDCHalfZRange)):(this._scene=X||C.q.LastCreatedScene,this._engine=this._scene.getEngine(),this.uniqueId=this._scene.getUniqueId(),this._scene.particleSystems.push(this)),this._engine.getCaps().vertexArrayObject&&(this._vertexArrayObject=null),this._initShaderSourceAsync(),this._attachImageProcessingConfiguration(null),this._customWrappers={0:new R.E(this._engine)},this._customWrappers[0].effect=$,this._drawWrappers=[],this._useInstancing=this._engine.getCaps().instancedArrays,this._createIndexBuffer(),this._createVertexBuffers(),this.particleEmitterType=new c.K;let s=null;this.updateFunction=t=>{var V;let X=null;this.noiseTexture&&(X=this.noiseTexture.getSize(),null===(V=this.noiseTexture.getContent())||void 0===V||V.then((t=>{s=t})));const k=t===this._particles;for(let V=0;V<t.length;V++){const $=t[V];let I=this._scaledUpdateSpeed;const C=$.age;if($.age+=I,$.age>$.lifeTime){const t=$.age-C;I=($.lifeTime-C)*I/t,$.age=$.lifeTime}const n=$.age/$.lifeTime;this._colorGradients&&this._colorGradients.length>0?K.vB.GetCurrentGradient(n,this._colorGradients,((t,V,X)=>{t!==$._currentColorGradient&&($._currentColor1.copyFrom($._currentColor2),V.getColorToRef($._currentColor2),$._currentColorGradient=t),F.ov.LerpToRef($._currentColor1,$._currentColor2,X,$.color)})):($.colorStep.scaleToRef(I,this._scaledColorStep),$.color.addInPlace(this._scaledColorStep),$.color.a<0&&($.color.a=0)),this._angularSpeedGradients&&this._angularSpeedGradients.length>0&&K.vB.GetCurrentGradient(n,this._angularSpeedGradients,((t,V,X)=>{t!==$._currentAngularSpeedGradient&&($._currentAngularSpeed1=$._currentAngularSpeed2,$._currentAngularSpeed2=V.getFactor(),$._currentAngularSpeedGradient=t),$.angularSpeed=N.cP($._currentAngularSpeed1,$._currentAngularSpeed2,X)})),$.angle+=$.angularSpeed*I;let q=I;if(this._velocityGradients&&this._velocityGradients.length>0&&K.vB.GetCurrentGradient(n,this._velocityGradients,((t,V,X)=>{t!==$._currentVelocityGradient&&($._currentVelocity1=$._currentVelocity2,$._currentVelocity2=V.getFactor(),$._currentVelocityGradient=t),q*=N.cP($._currentVelocity1,$._currentVelocity2,X)})),$.direction.scaleToRef(q,this._scaledDirection),this._limitVelocityGradients&&this._limitVelocityGradients.length>0&&K.vB.GetCurrentGradient(n,this._limitVelocityGradients,((t,V,X)=>{t!==$._currentLimitVelocityGradient&&($._currentLimitVelocity1=$._currentLimitVelocity2,$._currentLimitVelocity2=V.getFactor(),$._currentLimitVelocityGradient=t);const K=N.cP($._currentLimitVelocity1,$._currentLimitVelocity2,X);$.direction.length()>K&&$.direction.scaleInPlace(this.limitVelocityDamping)})),this._dragGradients&&this._dragGradients.length>0&&K.vB.GetCurrentGradient(n,this._dragGradients,((t,V,X)=>{t!==$._currentDragGradient&&($._currentDrag1=$._currentDrag2,$._currentDrag2=V.getFactor(),$._currentDragGradient=t);const K=N.cP($._currentDrag1,$._currentDrag2,X);this._scaledDirection.scaleInPlace(1-K)})),this.isLocal&&$._localPosition?($._localPosition.addInPlace(this._scaledDirection),A.Pq.TransformCoordinatesToRef($._localPosition,this._emitterWorldMatrix,$.position)):$.position.addInPlace(this._scaledDirection),s&&X&&$._randomNoiseCoordinates1){const t=this._fetchR($._randomNoiseCoordinates1.x,$._randomNoiseCoordinates1.y,X.width,X.height,s),V=this._fetchR($._randomNoiseCoordinates1.z,$._randomNoiseCoordinates2.x,X.width,X.height,s),K=this._fetchR($._randomNoiseCoordinates2.y,$._randomNoiseCoordinates2.z,X.width,X.height,s),k=A.AA.Vector3[0],C=A.AA.Vector3[1];k.copyFromFloats((2*t-1)*this.noiseStrength.x,(2*V-1)*this.noiseStrength.y,(2*K-1)*this.noiseStrength.z),k.scaleToRef(I,C),$.direction.addInPlace(C)}this.gravity.scaleToRef(I,this._scaledGravity),$.direction.addInPlace(this._scaledGravity),this._sizeGradients&&this._sizeGradients.length>0&&K.vB.GetCurrentGradient(n,this._sizeGradients,((t,V,X)=>{t!==$._currentSizeGradient&&($._currentSize1=$._currentSize2,$._currentSize2=V.getFactor(),$._currentSizeGradient=t),$.size=N.cP($._currentSize1,$._currentSize2,X)})),this._useRampGradients&&(this._colorRemapGradients&&this._colorRemapGradients.length>0&&K.vB.GetCurrentGradient(n,this._colorRemapGradients,((t,V,X)=>{const K=N.cP(t.factor1,V.factor1,X),k=N.cP(t.factor2,V.factor2,X);$.remapData.x=K,$.remapData.y=k-K})),this._alphaRemapGradients&&this._alphaRemapGradients.length>0&&K.vB.GetCurrentGradient(n,this._alphaRemapGradients,((t,V,X)=>{const K=N.cP(t.factor1,V.factor1,X),k=N.cP(t.factor2,V.factor2,X);$.remapData.z=K,$.remapData.w=k-K}))),this._isAnimationSheetEnabled&&$.updateCellIndex(),$._inheritParticleInfoToSubEmitters(),$.age>=$.lifeTime&&(this._emitFromParticle($),$._attachedSubEmitters&&($._attachedSubEmitters.forEach((t=>{t.particleSystem.disposeOnStop=!0,t.particleSystem.stop()})),$._attachedSubEmitters=null),this.recycleParticle($),k&&V--)}}}serialize(t){throw new Error("Method not implemented.")}clone(t,V,X=!1){throw new Error("Method not implemented.")}_addFactorGradient(t,V,X,k){const A=new K.SV(V,X,k);t.push(A),t.sort(((t,V)=>t.gradient<V.gradient?-1:t.gradient>V.gradient?1:0))}_removeFactorGradient(t,V){if(!t)return;let X=0;for(const K of t){if(K.gradient===V){t.splice(X,1);break}X++}}addLifeTimeGradient(t,V,X){return this._lifeTimeGradients||(this._lifeTimeGradients=[]),this._addFactorGradient(this._lifeTimeGradients,t,V,X),this}removeLifeTimeGradient(t){return this._removeFactorGradient(this._lifeTimeGradients,t),this}addSizeGradient(t,V,X){return this._sizeGradients||(this._sizeGradients=[]),this._addFactorGradient(this._sizeGradients,t,V,X),this}removeSizeGradient(t){return this._removeFactorGradient(this._sizeGradients,t),this}addColorRemapGradient(t,V,X){return this._colorRemapGradients||(this._colorRemapGradients=[]),this._addFactorGradient(this._colorRemapGradients,t,V,X),this}removeColorRemapGradient(t){return this._removeFactorGradient(this._colorRemapGradients,t),this}addAlphaRemapGradient(t,V,X){return this._alphaRemapGradients||(this._alphaRemapGradients=[]),this._addFactorGradient(this._alphaRemapGradients,t,V,X),this}removeAlphaRemapGradient(t){return this._removeFactorGradient(this._alphaRemapGradients,t),this}addAngularSpeedGradient(t,V,X){return this._angularSpeedGradients||(this._angularSpeedGradients=[]),this._addFactorGradient(this._angularSpeedGradients,t,V,X),this}removeAngularSpeedGradient(t){return this._removeFactorGradient(this._angularSpeedGradients,t),this}addVelocityGradient(t,V,X){return this._velocityGradients||(this._velocityGradients=[]),this._addFactorGradient(this._velocityGradients,t,V,X),this}removeVelocityGradient(t){return this._removeFactorGradient(this._velocityGradients,t),this}addLimitVelocityGradient(t,V,X){return this._limitVelocityGradients||(this._limitVelocityGradients=[]),this._addFactorGradient(this._limitVelocityGradients,t,V,X),this}removeLimitVelocityGradient(t){return this._removeFactorGradient(this._limitVelocityGradients,t),this}addDragGradient(t,V,X){return this._dragGradients||(this._dragGradients=[]),this._addFactorGradient(this._dragGradients,t,V,X),this}removeDragGradient(t){return this._removeFactorGradient(this._dragGradients,t),this}addEmitRateGradient(t,V,X){return this._emitRateGradients||(this._emitRateGradients=[]),this._addFactorGradient(this._emitRateGradients,t,V,X),this}removeEmitRateGradient(t){return this._removeFactorGradient(this._emitRateGradients,t),this}addStartSizeGradient(t,V,X){return this._startSizeGradients||(this._startSizeGradients=[]),this._addFactorGradient(this._startSizeGradients,t,V,X),this}removeStartSizeGradient(t){return this._removeFactorGradient(this._startSizeGradients,t),this}_createRampGradientTexture(){if(!this._rampGradients||!this._rampGradients.length||this._rampGradientsTexture||!this._scene)return;const t=new Uint8Array(4*this._rawTextureWidth),V=F.IG.Color3[0];for(let X=0;X<this._rawTextureWidth;X++){const k=X/this._rawTextureWidth;K.vB.GetCurrentGradient(k,this._rampGradients,((K,k,A)=>{F.v9.LerpToRef(K.color,k.color,A,V),t[4*X]=255*V.r,t[4*X+1]=255*V.g,t[4*X+2]=255*V.b,t[4*X+3]=255}))}this._rampGradientsTexture=I.I.CreateRGBATexture(t,this._rawTextureWidth,1,this._scene,!1,!1,1)}getRampGradients(){return this._rampGradients}forceRefreshGradients(){this._syncRampGradientTexture()}_syncRampGradientTexture(){this._rampGradients&&(this._rampGradients.sort(((t,V)=>t.gradient<V.gradient?-1:t.gradient>V.gradient?1:0)),this._rampGradientsTexture&&(this._rampGradientsTexture.dispose(),this._rampGradientsTexture=null),this._createRampGradientTexture())}addRampGradient(t,V){this._rampGradients||(this._rampGradients=[]);const X=new K.li(t,V);return this._rampGradients.push(X),this._syncRampGradientTexture(),this}removeRampGradient(t){return this._removeGradientAndTexture(t,this._rampGradients,this._rampGradientsTexture),this._rampGradientsTexture=null,this._rampGradients&&this._rampGradients.length>0&&this._createRampGradientTexture(),this}addColorGradient(t,V,X){this._colorGradients||(this._colorGradients=[]);const k=new K.aC(t,V,X);return this._colorGradients.push(k),this._colorGradients.sort(((t,V)=>t.gradient<V.gradient?-1:t.gradient>V.gradient?1:0)),this}removeColorGradient(t){if(!this._colorGradients)return this;let V=0;for(const X of this._colorGradients){if(X.gradient===t){this._colorGradients.splice(V,1);break}V++}return this}resetDrawCache(){for(const t of this._drawWrappers)if(t)for(const V of t)null==V||V.dispose();this._drawWrappers=[]}_fetchR(t,V,X,K,k){return k[4*(((t=.5*Math.abs(t)+.5)*X%X|0)+((V=.5*Math.abs(V)+.5)*K%K|0)*X)]/255}_reset(){this._resetEffect()}_resetEffect(){this._vertexBuffer&&(this._vertexBuffer.dispose(),this._vertexBuffer=null),this._spriteBuffer&&(this._spriteBuffer.dispose(),this._spriteBuffer=null),this._vertexArrayObject&&(this._engine.releaseVertexArrayObject(this._vertexArrayObject),this._vertexArrayObject=null),this._createVertexBuffers()}_createVertexBuffers(){this._vertexBufferSize=this._useInstancing?10:12,this._isAnimationSheetEnabled&&(this._vertexBufferSize+=1),this._isBillboardBased&&8!==this.billboardMode&&9!==this.billboardMode||(this._vertexBufferSize+=3),this._useRampGradients&&(this._vertexBufferSize+=4);const t=this._engine,V=this._vertexBufferSize*(this._useInstancing?1:4);this._vertexData=new Float32Array(this._capacity*V),this._vertexBuffer=new $.h(t,this._vertexData,!0,V);let X=0;const K=this._vertexBuffer.createVertexBuffer($.R.PositionKind,X,3,this._vertexBufferSize,this._useInstancing);this._vertexBuffers[$.R.PositionKind]=K,X+=3;const k=this._vertexBuffer.createVertexBuffer($.R.ColorKind,X,4,this._vertexBufferSize,this._useInstancing);this._vertexBuffers[$.R.ColorKind]=k,X+=4;const A=this._vertexBuffer.createVertexBuffer("angle",X,1,this._vertexBufferSize,this._useInstancing);this._vertexBuffers["angle"]=A,X+=1;const I=this._vertexBuffer.createVertexBuffer("size",X,2,this._vertexBufferSize,this._useInstancing);if(this._vertexBuffers["size"]=I,X+=2,this._isAnimationSheetEnabled){const t=this._vertexBuffer.createVertexBuffer("cellIndex",X,1,this._vertexBufferSize,this._useInstancing);this._vertexBuffers["cellIndex"]=t,X+=1}if(!this._isBillboardBased||8===this.billboardMode||9===this.billboardMode){const t=this._vertexBuffer.createVertexBuffer("direction",X,3,this._vertexBufferSize,this._useInstancing);this._vertexBuffers["direction"]=t,X+=3}if(this._useRampGradients){const t=this._vertexBuffer.createVertexBuffer("remapData",X,4,this._vertexBufferSize,this._useInstancing);this._vertexBuffers["remapData"]=t,X+=4}let C;if(this._useInstancing){const V=new Float32Array([0,0,1,0,0,1,1,1]);this._spriteBuffer=new $.h(t,V,!1,2),C=this._spriteBuffer.createVertexBuffer("offset",0,2)}else C=this._vertexBuffer.createVertexBuffer("offset",X,2,this._vertexBufferSize,this._useInstancing),X+=2;this._vertexBuffers["offset"]=C,this.resetDrawCache()}_createIndexBuffer(){if(this._useInstancing)return void(this._linesIndexBufferUseInstancing=this._engine.createIndexBuffer(new Uint32Array([0,1,1,3,3,2,2,0,0,3])));const t=[],V=[];let X=0;for(let K=0;K<this._capacity;K++)t.push(X),t.push(X+1),t.push(X+2),t.push(X),t.push(X+2),t.push(X+3),V.push(X,X+1,X+1,X+2,X+2,X+3,X+3,X,X,X+3),X+=4;this._indexBuffer=this._engine.createIndexBuffer(t),this._linesIndexBuffer=this._engine.createIndexBuffer(V)}getCapacity(){return this._capacity}isAlive(){return this._alive}isStarted(){return this._started}_preStart(){}start(t=this.startDelay){var V;if(!this.targetStopDuration&&this._hasTargetStopDurationDependantGradient())throw"Particle system started with a targetStopDuration dependant gradient (eg. startSizeGradients) but no targetStopDuration set";if(t)setTimeout((()=>{this.start(0)}),t);else{if(this._started=!0,this._stopped=!1,this._actualFrame=0,this._preStart(),this._emitRateGradients&&(this._emitRateGradients.length>0&&(this._currentEmitRateGradient=this._emitRateGradients[0],this._currentEmitRate1=this._currentEmitRateGradient.getFactor(),this._currentEmitRate2=this._currentEmitRate1),this._emitRateGradients.length>1&&(this._currentEmitRate2=this._emitRateGradients[1].getFactor())),this._startSizeGradients&&(this._startSizeGradients.length>0&&(this._currentStartSizeGradient=this._startSizeGradients[0],this._currentStartSize1=this._currentStartSizeGradient.getFactor(),this._currentStartSize2=this._currentStartSize1),this._startSizeGradients.length>1&&(this._currentStartSize2=this._startSizeGradients[1].getFactor())),this.preWarmCycles){-1!==(null===(V=this.emitter)||void 0===V?void 0:V.getClassName().indexOf("Mesh"))&&this.emitter.computeWorldMatrix(!0);const t=this.noiseTexture;if(t&&t.onGeneratedObservable)t.onGeneratedObservable.addOnce((()=>{setTimeout((()=>{for(let V=0;V<this.preWarmCycles;V++)this.animate(!0),t.render()}))}));else for(let t=0;t<this.preWarmCycles;t++)this.animate(!0)}this.beginAnimationOnStart&&this.animations&&this.animations.length>0&&this._scene&&this._scene.beginAnimation(this,this.beginAnimationFrom,this.beginAnimationTo,this.beginAnimationLoop)}}stop(t=!0){this._stopped||(this.onStoppedObservable.notifyObservers(this),this._stopped=!0,this._postStop(t))}_postStop(t){}reset(){this._stockParticles.length=0,this._particles.length=0}_appendParticleVertex(t,V,X,K){let k=t*this._vertexBufferSize;if(this._vertexData[k++]=V.position.x+this.worldOffset.x,this._vertexData[k++]=V.position.y+this.worldOffset.y,this._vertexData[k++]=V.position.z+this.worldOffset.z,this._vertexData[k++]=V.color.r,this._vertexData[k++]=V.color.g,this._vertexData[k++]=V.color.b,this._vertexData[k++]=V.color.a,this._vertexData[k++]=V.angle,this._vertexData[k++]=V.scale.x*V.size,this._vertexData[k++]=V.scale.y*V.size,this._isAnimationSheetEnabled&&(this._vertexData[k++]=V.cellIndex),this._isBillboardBased)8!==this.billboardMode&&9!==this.billboardMode||(this._vertexData[k++]=V.direction.x,this._vertexData[k++]=V.direction.y,this._vertexData[k++]=V.direction.z);else if(V._initialDirection){let t=V._initialDirection;this.isLocal&&(A.Pq.TransformNormalToRef(t,this._emitterWorldMatrix,A.AA.Vector3[0]),t=A.AA.Vector3[0]),0===t.x&&0===t.z&&(t.x=.001),this._vertexData[k++]=t.x,this._vertexData[k++]=t.y,this._vertexData[k++]=t.z}else{let t=V.direction;this.isLocal&&(A.Pq.TransformNormalToRef(t,this._emitterWorldMatrix,A.AA.Vector3[0]),t=A.AA.Vector3[0]),0===t.x&&0===t.z&&(t.x=.001),this._vertexData[k++]=t.x,this._vertexData[k++]=t.y,this._vertexData[k++]=t.z}this._useRampGradients&&V.remapData&&(this._vertexData[k++]=V.remapData.x,this._vertexData[k++]=V.remapData.y,this._vertexData[k++]=V.remapData.z,this._vertexData[k++]=V.remapData.w),this._useInstancing||(this._isAnimationSheetEnabled&&(0===X?X=this._epsilon:1===X&&(X=1-this._epsilon),0===K?K=this._epsilon:1===K&&(K=1-this._epsilon)),this._vertexData[k++]=X,this._vertexData[k++]=K)}_prepareParticle(t){}_update(t){if(this._alive=this._particles.length>0,this.emitter.position){const t=this.emitter;this._emitterWorldMatrix=t.getWorldMatrix()}else{const t=this.emitter;this._emitterWorldMatrix=A.uq.Translation(t.x,t.y,t.z)}let V;this._emitterWorldMatrix.invertToRef(this._emitterInverseWorldMatrix),this.updateFunction(this._particles);for(let X=0;X<t&&this._particles.length!==this._capacity;X++){if(V=this._createParticle(),this._particles.push(V),this.targetStopDuration&&this._lifeTimeGradients&&this._lifeTimeGradients.length>0){const t=N.OQ(this._actualFrame/this.targetStopDuration);K.vB.GetCurrentGradient(t,this._lifeTimeGradients,((X,K)=>{const k=X,A=K,$=k.getFactor(),I=A.getFactor(),C=(t-k.gradient)/(A.gradient-k.gradient);V.lifeTime=N.cP($,I,C)}))}else V.lifeTime=N.VD(this.minLifeTime,this.maxLifeTime);const t=N.VD(this.minEmitPower,this.maxEmitPower);if(this.startPositionFunction?this.startPositionFunction(this._emitterWorldMatrix,V.position,V,this.isLocal):this.particleEmitterType.startPositionFunction(this._emitterWorldMatrix,V.position,V,this.isLocal),this.isLocal&&(V._localPosition?V._localPosition.copyFrom(V.position):V._localPosition=V.position.clone(),A.Pq.TransformCoordinatesToRef(V._localPosition,this._emitterWorldMatrix,V.position)),this.startDirectionFunction?this.startDirectionFunction(this._emitterWorldMatrix,V.direction,V,this.isLocal):this.particleEmitterType.startDirectionFunction(this._emitterWorldMatrix,V.direction,V,this.isLocal,this._emitterInverseWorldMatrix),0===t?V._initialDirection?V._initialDirection.copyFrom(V.direction):V._initialDirection=V.direction.clone():V._initialDirection=null,V.direction.scaleInPlace(t),this._sizeGradients&&0!==this._sizeGradients.length?(V._currentSizeGradient=this._sizeGradients[0],V._currentSize1=V._currentSizeGradient.getFactor(),V.size=V._currentSize1,this._sizeGradients.length>1?V._currentSize2=this._sizeGradients[1].getFactor():V._currentSize2=V._currentSize1):V.size=N.VD(this.minSize,this.maxSize),V.scale.copyFromFloats(N.VD(this.minScaleX,this.maxScaleX),N.VD(this.minScaleY,this.maxScaleY)),this._startSizeGradients&&this._startSizeGradients[0]&&this.targetStopDuration){const t=this._actualFrame/this.targetStopDuration;K.vB.GetCurrentGradient(t,this._startSizeGradients,((t,X,K)=>{t!==this._currentStartSizeGradient&&(this._currentStartSize1=this._currentStartSize2,this._currentStartSize2=X.getFactor(),this._currentStartSizeGradient=t);const k=N.cP(this._currentStartSize1,this._currentStartSize2,K);V.scale.scaleInPlace(k)}))}if(this._angularSpeedGradients&&0!==this._angularSpeedGradients.length?(V._currentAngularSpeedGradient=this._angularSpeedGradients[0],V.angularSpeed=V._currentAngularSpeedGradient.getFactor(),V._currentAngularSpeed1=V.angularSpeed,this._angularSpeedGradients.length>1?V._currentAngularSpeed2=this._angularSpeedGradients[1].getFactor():V._currentAngularSpeed2=V._currentAngularSpeed1):V.angularSpeed=N.VD(this.minAngularSpeed,this.maxAngularSpeed),V.angle=N.VD(this.minInitialRotation,this.maxInitialRotation),this._velocityGradients&&this._velocityGradients.length>0&&(V._currentVelocityGradient=this._velocityGradients[0],V._currentVelocity1=V._currentVelocityGradient.getFactor(),this._velocityGradients.length>1?V._currentVelocity2=this._velocityGradients[1].getFactor():V._currentVelocity2=V._currentVelocity1),this._limitVelocityGradients&&this._limitVelocityGradients.length>0&&(V._currentLimitVelocityGradient=this._limitVelocityGradients[0],V._currentLimitVelocity1=V._currentLimitVelocityGradient.getFactor(),this._limitVelocityGradients.length>1?V._currentLimitVelocity2=this._limitVelocityGradients[1].getFactor():V._currentLimitVelocity2=V._currentLimitVelocity1),this._dragGradients&&this._dragGradients.length>0&&(V._currentDragGradient=this._dragGradients[0],V._currentDrag1=V._currentDragGradient.getFactor(),this._dragGradients.length>1?V._currentDrag2=this._dragGradients[1].getFactor():V._currentDrag2=V._currentDrag1),this._colorGradients&&0!==this._colorGradients.length)V._currentColorGradient=this._colorGradients[0],V._currentColorGradient.getColorToRef(V.color),V._currentColor1.copyFrom(V.color),this._colorGradients.length>1?this._colorGradients[1].getColorToRef(V._currentColor2):V._currentColor2.copyFrom(V.color);else{const t=N.VD(0,1);F.ov.LerpToRef(this.color1,this.color2,t,V.color),this.colorDead.subtractToRef(V.color,this._colorDiff),this._colorDiff.scaleToRef(1/V.lifeTime,V.colorStep)}this._isAnimationSheetEnabled&&(V._initialStartSpriteCellID=this.startSpriteCellID,V._initialEndSpriteCellID=this.endSpriteCellID,V._initialSpriteCellLoop=this.spriteCellLoop),V.direction.addInPlace(this._inheritedVelocityOffset),this._useRampGradients&&(V.remapData=new A.IU(0,1,0,1)),this.noiseTexture&&(V._randomNoiseCoordinates1?(V._randomNoiseCoordinates1.copyFromFloats(Math.random(),Math.random(),Math.random()),V._randomNoiseCoordinates2.copyFromFloats(Math.random(),Math.random(),Math.random())):(V._randomNoiseCoordinates1=new A.Pq(Math.random(),Math.random(),Math.random()),V._randomNoiseCoordinates2=new A.Pq(Math.random(),Math.random(),Math.random()))),V._inheritParticleInfoToSubEmitters()}}static _GetAttributeNamesOrOptions(t=!1,V=!1,X=!1){const K=[$.R.PositionKind,$.R.ColorKind,"angle","offset","size"];return t&&K.push("cellIndex"),V||K.push("direction"),X&&K.push("remapData"),K}static _GetEffectCreationOptions(t=!1,V=!1,X=!1){const K=["invView","view","projection","textureMask","translationPivot","eyePosition"];return s.TV(K),t&&K.push("particlesInfos"),V&&K.push("logarithmicDepthConstant"),X&&(K.push("vFogInfos"),K.push("vFogColor")),K}fillDefines(t,V,X=!0){if(this._scene&&(s.tv(this,this._scene,t),this.applyFog&&this._scene.fogEnabled&&0!==this._scene.fogMode&&t.push("#define FOG")),this._isAnimationSheetEnabled&&t.push("#define ANIMATESHEET"),this.useLogarithmicDepth&&t.push("#define LOGARITHMICDEPTH"),V===n.L.BLENDMODE_MULTIPLY&&t.push("#define BLENDMULTIPLYMODE"),this._useRampGradients&&t.push("#define RAMPGRADIENT"),this._isBillboardBased)switch(t.push("#define BILLBOARD"),this.billboardMode){case 2:t.push("#define BILLBOARDY");break;case 8:case 9:t.push("#define BILLBOARDSTRETCHED"),9===this.billboardMode&&t.push("#define BILLBOARDSTRETCHED_LOCAL");break;case 7:t.push("#define BILLBOARDMODE_ALL")}X&&this._imageProcessingConfiguration&&(this._imageProcessingConfiguration.prepareDefines(this._imageProcessingConfigurationDefines),t.push(this._imageProcessingConfigurationDefines.toString()))}fillUniformsAttributesAndSamplerNames(t,V,X){V.push(...v._GetAttributeNamesOrOptions(this._isAnimationSheetEnabled,this._isBillboardBased&&8!==this.billboardMode&&9!==this.billboardMode,this._useRampGradients)),t.push(...v._GetEffectCreationOptions(this._isAnimationSheetEnabled,this.useLogarithmicDepth,this.applyFog)),X.push("diffuseSampler","rampSampler"),this._imageProcessingConfiguration&&(m._(t,this._imageProcessingConfigurationDefines),m.C(X,this._imageProcessingConfigurationDefines))}_getWrapper(t){const V=this._getCustomDrawWrapper(t);if(null==V?void 0:V.effect)return V;const X=[];this.fillDefines(X,t);const K=this._engine._features.supportRenderPasses?this._engine.currentRenderPassId:0;let k=this._drawWrappers[K];k||(k=this._drawWrappers[K]=[]);let A=k[t];A||(A=new R.E(this._engine),A.drawContext&&(A.drawContext.useInstancing=this._useInstancing),k[t]=A);const $=X.join("\n");if(A.defines!==$){const t=[],V=[],X=[];this.fillUniformsAttributesAndSamplerNames(V,t,X),A.setEffect(this._engine.createEffect("particles",t,V,X,$,void 0,void 0,void 0,void 0,this._shaderLanguage),$)}return A}animate(t=!1){var V;if(!this._started)return;if(!t&&this._scene){if(!this.isReady())return;if(this._currentRenderId===this._scene.getFrameId())return;this._currentRenderId=this._scene.getFrameId()}let X;if(this._scaledUpdateSpeed=this.updateSpeed*(t?this.preWarmStepOffset:(null===(V=this._scene)||void 0===V?void 0:V.getAnimationRatio())||1),this.manualEmitCount>-1)X=this.manualEmitCount,this._newPartsExcess=0,this.manualEmitCount=0;else{let t=this.emitRate;if(this._emitRateGradients&&this._emitRateGradients.length>0&&this.targetStopDuration){const V=this._actualFrame/this.targetStopDuration;K.vB.GetCurrentGradient(V,this._emitRateGradients,((V,X,K)=>{V!==this._currentEmitRateGradient&&(this._currentEmitRate1=this._currentEmitRate2,this._currentEmitRate2=X.getFactor(),this._currentEmitRateGradient=V),t=N.cP(this._currentEmitRate1,this._currentEmitRate2,K)}))}X=t*this._scaledUpdateSpeed>>0,this._newPartsExcess+=t*this._scaledUpdateSpeed-X}if(this._newPartsExcess>1&&(X+=this._newPartsExcess>>0,this._newPartsExcess-=this._newPartsExcess>>0),this._alive=!1,this._stopped?X=0:(this._actualFrame+=this._scaledUpdateSpeed,this.targetStopDuration&&this._actualFrame>=this.targetStopDuration&&this.stop()),this._update(X),this._stopped&&(this._alive||(this._started=!1,this.onAnimationEnd&&this.onAnimationEnd(),this.disposeOnStop&&this._scene&&this._scene._toBeDisposed.push(this))),!t){let t=0;for(let V=0;V<this._particles.length;V++){const X=this._particles[V];this._appendParticleVertices(t,X),t+=this._useInstancing?1:4}this._vertexBuffer&&this._vertexBuffer.updateDirectly(this._vertexData,0,this._particles.length)}0===this.manualEmitCount&&this.disposeOnStop&&this.stop()}_appendParticleVertices(t,V){this._appendParticleVertex(t++,V,0,0),this._useInstancing||(this._appendParticleVertex(t++,V,1,0),this._appendParticleVertex(t++,V,1,1),this._appendParticleVertex(t++,V,0,1))}rebuild(){var t;this._engine.getCaps().vertexArrayObject&&(this._vertexArrayObject=null),this._createIndexBuffer(),null===(t=this._spriteBuffer)||void 0===t||t._rebuild(),this._createVertexBuffers(),this.resetDrawCache()}async _initShaderSourceAsync(){this._engine.isWebGPU&&!v.ForceGLSL?(this._shaderLanguage=1,await Promise.all([X.e(21676).then(X.bind(X,21676)),X.e(38470).then(X.bind(X,38470))])):await Promise.all([X.e(47687).then(X.bind(X,547687)),X.e(87821).then(X.bind(X,887821))]),this._shadersLoaded=!0}isReady(){if(!this._shadersLoaded)return!1;if(!this.emitter||this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.isReady()||!this.particleTexture||!this.particleTexture.isReady())return!1;if(this.blendMode!==n.L.BLENDMODE_MULTIPLYADD){if(!this._getWrapper(this.blendMode).effect.isReady())return!1}else{if(!this._getWrapper(n.L.BLENDMODE_MULTIPLY).effect.isReady())return!1;if(!this._getWrapper(n.L.BLENDMODE_ADD).effect.isReady())return!1}return!0}_render(t){var V,X,K,k,$,I,C,q;const R=this._getWrapper(t),F=R.effect,c=this._engine;c.enableEffect(R);const N=null!==(V=this.defaultViewMatrix)&&void 0!==V?V:this._scene.getViewMatrix();if(F.setTexture("diffuseSampler",this.particleTexture),F.setMatrix("view",N),F.setMatrix("projection",null!==(X=this.defaultProjectionMatrix)&&void 0!==X?X:this._scene.getProjectionMatrix()),this._isAnimationSheetEnabled&&this.particleTexture){const t=this.particleTexture.getBaseSize();F.setFloat3("particlesInfos",this.spriteCellWidth/t.width,this.spriteCellHeight/t.height,this.spriteCellWidth/t.width)}if(F.setVector2("translationPivot",this.translationPivot),F.setFloat4("textureMask",this.textureMask.r,this.textureMask.g,this.textureMask.b,this.textureMask.a),this._isBillboardBased&&this._scene){const t=this._scene.activeCamera;F.setVector3("eyePosition",t.globalPosition)}this._rampGradientsTexture&&(this._rampGradients&&this._rampGradients.length||(this._rampGradientsTexture.dispose(),this._rampGradientsTexture=null),F.setTexture("rampSampler",this._rampGradientsTexture));const m=F.defines;switch(this._scene&&(s.gS(F,this,this._scene),this.applyFog&&S.Yy(this._scene,void 0,F)),m.indexOf("#define BILLBOARDMODE_ALL")>=0&&(N.invertToRef(A.AA.Matrix[0]),F.setMatrix("invView",A.AA.Matrix[0])),void 0!==this._vertexArrayObject?(null===(K=this._scene)||void 0===K?void 0:K.forceWireframe)?c.bindBuffers(this._vertexBuffers,this._linesIndexBufferUseInstancing,F):(this._vertexArrayObject||(this._vertexArrayObject=this._engine.recordVertexArrayObject(this._vertexBuffers,null,F)),this._engine.bindVertexArrayObject(this._vertexArrayObject,(null===(k=this._scene)||void 0===k?void 0:k.forceWireframe)?this._linesIndexBufferUseInstancing:this._indexBuffer)):this._indexBuffer?c.bindBuffers(this._vertexBuffers,(null===(I=this._scene)||void 0===I?void 0:I.forceWireframe)?this._linesIndexBuffer:this._indexBuffer,F):c.bindBuffers(this._vertexBuffers,(null===($=this._scene)||void 0===$?void 0:$.forceWireframe)?this._linesIndexBufferUseInstancing:null,F),this.useLogarithmicDepth&&this._scene&&S.DL(m,F,this._scene),this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.applyByPostProcess&&this._imageProcessingConfiguration.bind(F),t){case n.L.BLENDMODE_ADD:c.setAlphaMode(1);break;case n.L.BLENDMODE_ONEONE:c.setAlphaMode(6);break;case n.L.BLENDMODE_STANDARD:c.setAlphaMode(2);break;case n.L.BLENDMODE_MULTIPLY:c.setAlphaMode(4)}return this._onBeforeDrawParticlesObservable&&this._onBeforeDrawParticlesObservable.notifyObservers(F),this._useInstancing?(null===(C=this._scene)||void 0===C?void 0:C.forceWireframe)?c.drawElementsType(6,0,10,this._particles.length):c.drawArraysType(7,0,4,this._particles.length):(null===(q=this._scene)||void 0===q?void 0:q.forceWireframe)?c.drawElementsType(1,0,10*this._particles.length):c.drawElementsType(0,0,6*this._particles.length),this._particles.length}render(){if(!this.isReady()||!this._particles.length)return 0;const t=this._engine;t.setState&&(t.setState(!1),this.forceDepthWrite&&t.setDepthWrite(!0));let V=0;return V=this.blendMode===n.L.BLENDMODE_MULTIPLYADD?this._render(n.L.BLENDMODE_MULTIPLY)+this._render(n.L.BLENDMODE_ADD):this._render(this.blendMode),this._engine.unbindInstanceAttributes(),this._engine.setAlphaMode(0),V}_onDispose(t=!1,V=!1){}dispose(t=!0,V=!1,X=!1){if(this.resetDrawCache(),this._vertexBuffer&&(this._vertexBuffer.dispose(),this._vertexBuffer=null),this._spriteBuffer&&(this._spriteBuffer.dispose(),this._spriteBuffer=null),this._indexBuffer&&(this._engine._releaseBuffer(this._indexBuffer),this._indexBuffer=null),this._linesIndexBuffer&&(this._engine._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null),this._linesIndexBufferUseInstancing&&(this._engine._releaseBuffer(this._linesIndexBufferUseInstancing),this._linesIndexBufferUseInstancing=null),this._vertexArrayObject&&(this._engine.releaseVertexArrayObject(this._vertexArrayObject),this._vertexArrayObject=null),t&&this.particleTexture&&(this.particleTexture.dispose(),this.particleTexture=null),t&&this.noiseTexture&&(this.noiseTexture.dispose(),this.noiseTexture=null),this._rampGradientsTexture&&(this._rampGradientsTexture.dispose(),this._rampGradientsTexture=null),this._onDispose(V,X),this._onBeforeDrawParticlesObservable&&this._onBeforeDrawParticlesObservable.clear(),this._scene){const t=this._scene.particleSystems.indexOf(this);t>-1&&this._scene.particleSystems.splice(t,1),this._scene._activeParticleSystems.dispose()}this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onStoppedObservable.clear(),this.reset()}}v.ForceGLSL=!1;var W=X(466281),Z=X(33321),D=X(310035),y=X(337776),E=X(11142),_=X(881544),p=X(265427),L=X(15634),O=X(274090),r=X(843355),z=X(645912),w=X(206749);class b extends v{constructor(){super(...arguments),this._disposeEmitterOnDispose=!1,this._emitFromParticle=t=>{if(!this._subEmitters||0===this._subEmitters.length)return;const V=Math.floor(Math.random()*this._subEmitters.length);this._subEmitters[V].forEach((V=>{if(1===V.type){const X=V.clone();t._inheritParticleInfoToSubEmitter(X),X.particleSystem._rootParticleSystem=this,this.activeSubSystems.push(X.particleSystem),X.particleSystem.start()}}))}}createPointEmitter(t,V){const X=w.Pp(t,V);return this.particleEmitterType=X,X}createHemisphericEmitter(t=1,V=1){const X=w.wb(t,V);return this.particleEmitterType=X,X}createSphereEmitter(t=1,V=1){const X=w.Iu(t,V);return this.particleEmitterType=X,X}createDirectedSphereEmitter(t=1,V=new A.Pq(0,1,0),X=new A.Pq(0,1,0)){const K=w.gQ(t,V,X);return this.particleEmitterType=K,K}createCylinderEmitter(t=1,V=1,X=1,K=0){const k=w.PQ(t,V,X,K);return this.particleEmitterType=k,k}createDirectedCylinderEmitter(t=1,V=1,X=1,K=new A.Pq(0,1,0),k=new A.Pq(0,1,0)){const $=w.DG(t,V,X,K,k);return this.particleEmitterType=$,$}createConeEmitter(t=1,V=Math.PI/4){const X=w.kH(t,V);return this.particleEmitterType=X,X}createDirectedConeEmitter(t=1,V=Math.PI/4,X=new A.Pq(0,1,0),K=new A.Pq(0,1,0)){const k=w.s5(t,V,X,K);return this.particleEmitterType=k,k}createBoxEmitter(t,V,X,K){const k=new c.K;return this.particleEmitterType=k,this.direction1=t,this.direction2=V,this.minEmitBox=X,this.maxEmitBox=K,k}_prepareSubEmitterInternalArray(){this._subEmitters=new Array,this.subEmitters&&this.subEmitters.forEach((t=>{t instanceof b?this._subEmitters.push([new W.z(t)]):t instanceof W.z?this._subEmitters.push([t]):t instanceof Array&&this._subEmitters.push(t)}))}_stopSubEmitters(){this.activeSubSystems&&(this.activeSubSystems.forEach((t=>{t.stop(!0)})),this.activeSubSystems=[])}_removeFromRoot(){if(!this._rootParticleSystem)return;const t=this._rootParticleSystem.activeSubSystems.indexOf(this);-1!==t&&this._rootParticleSystem.activeSubSystems.splice(t,1),this._rootParticleSystem=null}_preStart(){this._prepareSubEmitterInternalArray(),this._subEmitters&&0!=this._subEmitters.length&&(this.activeSubSystems=[])}_postStop(t){t&&this._stopSubEmitters()}_prepareParticle(t){if(this._subEmitters&&this._subEmitters.length>0){const V=this._subEmitters[Math.floor(Math.random()*this._subEmitters.length)];t._attachedSubEmitters=[],V.forEach((V=>{if(0===V.type){const X=V.clone();t._attachedSubEmitters.push(X),X.particleSystem.start()}}))}}_onDispose(t=!1,V=!1){var X;if(this._removeFromRoot(),this.subEmitters&&!this._subEmitters&&this._prepareSubEmitterInternalArray(),t&&(null===(X=this.particles)||void 0===X||X.forEach((t=>{if(t._attachedSubEmitters)for(let V=t._attachedSubEmitters.length-1;V>=0;V-=1)t._attachedSubEmitters[V].dispose()}))),V&&this.activeSubSystems)for(let t=this.activeSubSystems.length-1;t>=0;t-=1)this.activeSubSystems[t].dispose();if(this._subEmitters&&this._subEmitters.length){for(let t=0;t<this._subEmitters.length;t++)for(const V of this._subEmitters[t])V.dispose();this._subEmitters=[],this.subEmitters=[]}this._disposeEmitterOnDispose&&this.emitter&&this.emitter.dispose&&this.emitter.dispose(!0)}static _Parse(t,V,X,K){var k,$,I;let C;C=X instanceof Z.$?null:X;const n=D.n9("BABYLON.Texture");if(n&&C&&(t.texture?V.particleTexture=n.Parse(t.texture,C,K):t.textureName&&(V.particleTexture=new n(K+t.textureName,C,!1,void 0===t.invertY||t.invertY),V.particleTexture.name=t.textureName)),t.emitterId||0===t.emitterId||void 0!==t.emitter?t.emitterId&&C?V.emitter=C.getLastMeshById(t.emitterId):V.emitter=A.Pq.FromArray(t.emitter):V.emitter=A.Pq.Zero(),V.isLocal=!!t.isLocal,void 0!==t.renderingGroupId&&(V.renderingGroupId=t.renderingGroupId),void 0!==t.isBillboardBased&&(V.isBillboardBased=t.isBillboardBased),void 0!==t.billboardMode&&(V.billboardMode=t.billboardMode),void 0!==t.useLogarithmicDepth&&(V.useLogarithmicDepth=t.useLogarithmicDepth),t.animations){for(let X=0;X<t.animations.length;X++){const K=t.animations[X],k=D.n9("BABYLON.Animation");k&&V.animations.push(k.Parse(K))}V.beginAnimationOnStart=t.beginAnimationOnStart,V.beginAnimationFrom=t.beginAnimationFrom,V.beginAnimationTo=t.beginAnimationTo,V.beginAnimationLoop=t.beginAnimationLoop}if(t.autoAnimate&&C&&C.beginAnimation(V,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,t.autoAnimateSpeed||1),V.startDelay=0|t.startDelay,V.minAngularSpeed=t.minAngularSpeed,V.maxAngularSpeed=t.maxAngularSpeed,V.minSize=t.minSize,V.maxSize=t.maxSize,t.minScaleX&&(V.minScaleX=t.minScaleX,V.maxScaleX=t.maxScaleX,V.minScaleY=t.minScaleY,V.maxScaleY=t.maxScaleY),void 0!==t.preWarmCycles&&(V.preWarmCycles=t.preWarmCycles,V.preWarmStepOffset=t.preWarmStepOffset),void 0!==t.minInitialRotation&&(V.minInitialRotation=t.minInitialRotation,V.maxInitialRotation=t.maxInitialRotation),V.minLifeTime=t.minLifeTime,V.maxLifeTime=t.maxLifeTime,V.minEmitPower=t.minEmitPower,V.maxEmitPower=t.maxEmitPower,V.emitRate=t.emitRate,V.gravity=A.Pq.FromArray(t.gravity),t.noiseStrength&&(V.noiseStrength=A.Pq.FromArray(t.noiseStrength)),V.color1=F.ov.FromArray(t.color1),V.color2=F.ov.FromArray(t.color2),V.colorDead=F.ov.FromArray(t.colorDead),V.updateSpeed=t.updateSpeed,V.targetStopDuration=t.targetStopDuration,V.blendMode=t.blendMode,t.colorGradients)for(const X of t.colorGradients)V.addColorGradient(X.gradient,F.ov.FromArray(X.color1),X.color2?F.ov.FromArray(X.color2):void 0);if(t.rampGradients){for(const X of t.rampGradients)V.addRampGradient(X.gradient,F.v9.FromArray(X.color));V.useRampGradients=t.useRampGradients}if(t.colorRemapGradients)for(const X of t.colorRemapGradients)V.addColorRemapGradient(X.gradient,void 0!==X.factor1?X.factor1:X.factor,X.factor2);if(t.alphaRemapGradients)for(const X of t.alphaRemapGradients)V.addAlphaRemapGradient(X.gradient,void 0!==X.factor1?X.factor1:X.factor,X.factor2);if(t.sizeGradients)for(const X of t.sizeGradients)V.addSizeGradient(X.gradient,void 0!==X.factor1?X.factor1:X.factor,X.factor2);if(t.angularSpeedGradients)for(const X of t.angularSpeedGradients)V.addAngularSpeedGradient(X.gradient,void 0!==X.factor1?X.factor1:X.factor,X.factor2);if(t.velocityGradients)for(const X of t.velocityGradients)V.addVelocityGradient(X.gradient,void 0!==X.factor1?X.factor1:X.factor,X.factor2);if(t.dragGradients)for(const X of t.dragGradients)V.addDragGradient(X.gradient,void 0!==X.factor1?X.factor1:X.factor,X.factor2);if(t.emitRateGradients)for(const X of t.emitRateGradients)V.addEmitRateGradient(X.gradient,void 0!==X.factor1?X.factor1:X.factor,X.factor2);if(t.startSizeGradients)for(const X of t.startSizeGradients)V.addStartSizeGradient(X.gradient,void 0!==X.factor1?X.factor1:X.factor,X.factor2);if(t.lifeTimeGradients)for(const X of t.lifeTimeGradients)V.addLifeTimeGradient(X.gradient,void 0!==X.factor1?X.factor1:X.factor,X.factor2);if(t.limitVelocityGradients){for(const X of t.limitVelocityGradients)V.addLimitVelocityGradient(X.gradient,void 0!==X.factor1?X.factor1:X.factor,X.factor2);V.limitVelocityDamping=t.limitVelocityDamping}if(t.noiseTexture&&C){const X=D.n9("BABYLON.ProceduralTexture");V.noiseTexture=X.Parse(t.noiseTexture,C,K)}let q;if(t.particleEmitterType){switch(t.particleEmitterType.type){case"SphereParticleEmitter":q=new O.Q;break;case"SphereDirectedParticleEmitter":q=new O.c;break;case"ConeEmitter":case"ConeParticleEmitter":q=new z.A;break;case"ConeDirectedParticleEmitter":q=new z.g;break;case"CylinderParticleEmitter":q=new r.l;break;case"CylinderDirectedParticleEmitter":q=new r.J;break;case"HemisphericParticleEmitter":q=new L.w;break;case"PointParticleEmitter":q=new p.H;break;case"MeshParticleEmitter":q=new E.u;break;case"CustomParticleEmitter":q=new _.A;break;default:q=new c.K}q.parse(t.particleEmitterType,C)}else q=new c.K,q.parse(t,C);V.particleEmitterType=q,V.startSpriteCellID=t.startSpriteCellID,V.endSpriteCellID=t.endSpriteCellID,V.spriteCellLoop=null===(k=t.spriteCellLoop)||void 0===k||k,V.spriteCellWidth=t.spriteCellWidth,V.spriteCellHeight=t.spriteCellHeight,V.spriteCellChangeSpeed=t.spriteCellChangeSpeed,V.spriteRandomStartCell=t.spriteRandomStartCell,V.disposeOnStop=null!==($=t.disposeOnStop)&&void 0!==$&&$,V.manualEmitCount=null!==(I=t.manualEmitCount)&&void 0!==I?I:-1}static Parse(t,V,X,K=!1,k){const $=t.name;let I,C,n=null,q=null;if(V instanceof Z.$?I=V:(C=V,I=C.getEngine()),t.customShader&&I.createEffectForParticles){q=t.customShader;const V=q.shaderOptions.defines.length>0?q.shaderOptions.defines.join("\n"):"";n=I.createEffectForParticles(q.shaderPath.fragmentElement,q.shaderOptions.uniforms,q.shaderOptions.samplers,V)}const R=new b($,k||t.capacity,V,n,t.isAnimationSheetEnabled);if(R.customShader=q,R._rootUrl=X,t.id&&(R.id=t.id),t.subEmitters){R.subEmitters=[];for(const K of t.subEmitters){const t=[];for(const k of K)t.push(W.z.Parse(k,V,X));R.subEmitters.push(t)}}return b._Parse(t,R,V,X),t.textureMask&&(R.textureMask=F.ov.FromArray(t.textureMask)),t.worldOffset&&(R.worldOffset=A.Pq.FromArray(t.worldOffset)),t.preventAutoStart&&(R.preventAutoStart=t.preventAutoStart),K||R.preventAutoStart||R.start(),R}serialize(t=!1){const V={};if(b._Serialize(V,this,t),V.textureMask=this.textureMask.asArray(),V.customShader=this.customShader,V.preventAutoStart=this.preventAutoStart,V.worldOffset=this.worldOffset.asArray(),this.subEmitters){V.subEmitters=[],this._subEmitters||this._prepareSubEmitterInternalArray();for(const X of this._subEmitters){const K=[];for(const V of X)K.push(V.serialize(t));V.subEmitters.push(K)}}return V}static _Serialize(t,V,X){if(t.name=V.name,t.id=V.id,t.capacity=V.getCapacity(),t.disposeOnStop=V.disposeOnStop,t.manualEmitCount=V.manualEmitCount,V.emitter.position){const X=V.emitter;t.emitterId=X.id}else{const X=V.emitter;t.emitter=X.asArray()}V.particleEmitterType&&(t.particleEmitterType=V.particleEmitterType.serialize()),V.particleTexture&&(X?t.texture=V.particleTexture.serialize():(t.textureName=V.particleTexture.name,t.invertY=!!V.particleTexture._invertY)),t.isLocal=V.isLocal,y.p.AppendSerializedAnimations(V,t),t.beginAnimationOnStart=V.beginAnimationOnStart,t.beginAnimationFrom=V.beginAnimationFrom,t.beginAnimationTo=V.beginAnimationTo,t.beginAnimationLoop=V.beginAnimationLoop,t.startDelay=V.startDelay,t.renderingGroupId=V.renderingGroupId,t.isBillboardBased=V.isBillboardBased,t.billboardMode=V.billboardMode,t.minAngularSpeed=V.minAngularSpeed,t.maxAngularSpeed=V.maxAngularSpeed,t.minSize=V.minSize,t.maxSize=V.maxSize,t.minScaleX=V.minScaleX,t.maxScaleX=V.maxScaleX,t.minScaleY=V.minScaleY,t.maxScaleY=V.maxScaleY,t.minEmitPower=V.minEmitPower,t.maxEmitPower=V.maxEmitPower,t.minLifeTime=V.minLifeTime,t.maxLifeTime=V.maxLifeTime,t.emitRate=V.emitRate,t.gravity=V.gravity.asArray(),t.noiseStrength=V.noiseStrength.asArray(),t.color1=V.color1.asArray(),t.color2=V.color2.asArray(),t.colorDead=V.colorDead.asArray(),t.updateSpeed=V.updateSpeed,t.targetStopDuration=V.targetStopDuration,t.blendMode=V.blendMode,t.preWarmCycles=V.preWarmCycles,t.preWarmStepOffset=V.preWarmStepOffset,t.minInitialRotation=V.minInitialRotation,t.maxInitialRotation=V.maxInitialRotation,t.startSpriteCellID=V.startSpriteCellID,t.spriteCellLoop=V.spriteCellLoop,t.endSpriteCellID=V.endSpriteCellID,t.spriteCellChangeSpeed=V.spriteCellChangeSpeed,t.spriteCellWidth=V.spriteCellWidth,t.spriteCellHeight=V.spriteCellHeight,t.spriteRandomStartCell=V.spriteRandomStartCell,t.isAnimationSheetEnabled=V.isAnimationSheetEnabled,t.useLogarithmicDepth=V.useLogarithmicDepth;const K=V.getColorGradients();if(K){t.colorGradients=[];for(const V of K){const X={gradient:V.gradient,color1:V.color1.asArray()};V.color2?X.color2=V.color2.asArray():X.color2=V.color1.asArray(),t.colorGradients.push(X)}}const k=V.getRampGradients();if(k){t.rampGradients=[];for(const V of k){const X={gradient:V.gradient,color:V.color.asArray()};t.rampGradients.push(X)}t.useRampGradients=V.useRampGradients}const A=V.getColorRemapGradients();if(A){t.colorRemapGradients=[];for(const V of A){const X={gradient:V.gradient,factor1:V.factor1};void 0!==V.factor2?X.factor2=V.factor2:X.factor2=V.factor1,t.colorRemapGradients.push(X)}}const $=V.getAlphaRemapGradients();if($){t.alphaRemapGradients=[];for(const V of $){const X={gradient:V.gradient,factor1:V.factor1};void 0!==V.factor2?X.factor2=V.factor2:X.factor2=V.factor1,t.alphaRemapGradients.push(X)}}const I=V.getSizeGradients();if(I){t.sizeGradients=[];for(const V of I){const X={gradient:V.gradient,factor1:V.factor1};void 0!==V.factor2?X.factor2=V.factor2:X.factor2=V.factor1,t.sizeGradients.push(X)}}const C=V.getAngularSpeedGradients();if(C){t.angularSpeedGradients=[];for(const V of C){const X={gradient:V.gradient,factor1:V.factor1};void 0!==V.factor2?X.factor2=V.factor2:X.factor2=V.factor1,t.angularSpeedGradients.push(X)}}const n=V.getVelocityGradients();if(n){t.velocityGradients=[];for(const V of n){const X={gradient:V.gradient,factor1:V.factor1};void 0!==V.factor2?X.factor2=V.factor2:X.factor2=V.factor1,t.velocityGradients.push(X)}}const q=V.getDragGradients();if(q){t.dragGradients=[];for(const V of q){const X={gradient:V.gradient,factor1:V.factor1};void 0!==V.factor2?X.factor2=V.factor2:X.factor2=V.factor1,t.dragGradients.push(X)}}const R=V.getEmitRateGradients();if(R){t.emitRateGradients=[];for(const V of R){const X={gradient:V.gradient,factor1:V.factor1};void 0!==V.factor2?X.factor2=V.factor2:X.factor2=V.factor1,t.emitRateGradients.push(X)}}const F=V.getStartSizeGradients();if(F){t.startSizeGradients=[];for(const V of F){const X={gradient:V.gradient,factor1:V.factor1};void 0!==V.factor2?X.factor2=V.factor2:X.factor2=V.factor1,t.startSizeGradients.push(X)}}const s=V.getLifeTimeGradients();if(s){t.lifeTimeGradients=[];for(const V of s){const X={gradient:V.gradient,factor1:V.factor1};void 0!==V.factor2?X.factor2=V.factor2:X.factor2=V.factor1,t.lifeTimeGradients.push(X)}}const S=V.getLimitVelocityGradients();if(S){t.limitVelocityGradients=[];for(const V of S){const X={gradient:V.gradient,factor1:V.factor1};void 0!==V.factor2?X.factor2=V.factor2:X.factor2=V.factor1,t.limitVelocityGradients.push(X)}t.limitVelocityDamping=V.limitVelocityDamping}V.noiseTexture&&(t.noiseTexture=V.noiseTexture.serialize())}clone(t,V,X=!1){const K={...this._customWrappers};let k=null;const A=this._engine;if(A.createEffectForParticles&&null!=this.customShader){k=this.customShader;const t=k.shaderOptions.defines.length>0?k.shaderOptions.defines.join("\n"):"",V=A.createEffectForParticles(k.shaderPath.fragmentElement,k.shaderOptions.uniforms,k.shaderOptions.samplers,t);K[0]?K[0].effect=V:this.setCustomEffect(V,0)}const $=this.serialize(X),I=b.Parse($,this._scene||this._engine,this._rootUrl);return I.name=t,I.customShader=k,I._customWrappers=K,void 0===V&&(V=this.emitter),this.noiseTexture&&(I.noiseTexture=this.noiseTexture.clone()),I.emitter=V,this.preventAutoStart||I.start(),I}}b.BILLBOARDMODE_Y=2,b.BILLBOARDMODE_ALL=7,b.BILLBOARDMODE_STRETCHED=8,b.BILLBOARDMODE_STRETCHED_LOCAL=9,W.z._ParseParticleSystem=b.Parse},659268:(t,V,X)=>{X.d(V,{q:()=>K,y:()=>N});var K,k=X(948733),A=X(604910),$=X(706400),I=X(23987),C=X(818696),n=X(27230),q=X(395726),R=X(482148),F=X(988514),s=X(32138),S=X(194373),c=X(615473);(function(t){t[t["Color"]=2]="Color",t[t["UV"]=1]="UV",t[t["Random"]=0]="Random",t[t["Stated"]=3]="Stated"})(K||(K={}));class N{get positions(){return this._positions32}get colors(){return this._colors32}get uvs(){return this._uvs32}constructor(t,V,X,K){this.particles=new Array,this.nbParticles=0,this.counter=0,this.vars={},this._promises=[],this._positions=new Array,this._indices=new Array,this._normals=new Array,this._colors=new Array,this._uvs=new Array,this._updatable=!0,this._isVisibilityBoxLocked=!1,this._alwaysVisible=!1,this._groups=new Array,this._groupCounter=0,this._computeParticleColor=!0,this._computeParticleTexture=!0,this._computeParticleRotation=!0,this._computeBoundingBox=!1,this._isReady=!1,this.name=t,this._size=V,this._scene=X||q.q.LastCreatedScene,K&&void 0!==K.updatable?this._updatable=K.updatable:this._updatable=!0}buildMeshAsync(t){return Promise.all(this._promises).then((()=>(this._isReady=!0,this._buildMesh(t))))}_buildMesh(t){0===this.nbParticles&&this.addPoints(1),this._positions32=new Float32Array(this._positions),this._uvs32=new Float32Array(this._uvs),this._colors32=new Float32Array(this._colors);const V=new C.P;V.set(this._positions32,I.R.PositionKind),this._uvs32.length>0&&V.set(this._uvs32,I.R.UVKind);let X=0;this._colors32.length>0&&(X=1,V.set(this._colors32,I.R.ColorKind));const K=new n.e(this.name,this._scene);V.applyToMesh(K,this._updatable),this.mesh=K,this._positions=null,this._uvs=null,this._colors=null,this._updatable||(this.particles.length=0);let A=t;return A||(A=new s.F("point cloud material",this._scene),A.emissiveColor=new k.v9(X,X,X),A.disableLighting=!0,A.pointsCloud=!0,A.pointSize=this._size),K.material=A,new Promise((t=>t(K)))}_addParticle(t,V,X,K){const k=new R.M(t,V,X,K,this);return this.particles.push(k),k}_randomUnitVector(t){t.position=new A.Pq(Math.random(),Math.random(),Math.random()),t.color=new k.ov(1,1,1,1)}_getColorIndicesForCoord(t,V,X,K){const A=t._groupImageData,$=X*(4*K)+4*V,I=[$,$+1,$+2,$+3],C=I[1],n=I[2],q=I[3],R=A[I[0]],F=A[C],s=A[n],S=A[q];return new k.ov(R/255,F/255,s/255,S)}_setPointsColorOrUV(t,V,X,K,$,C,n,q){q=null!=q?q:0,X&&t.updateFacetData();const R=2*t.getBoundingInfo().boundingSphere.radius;let s=t.getVerticesData(I.R.PositionKind);const S=t.getIndices(),N=t.getVerticesData(I.R.UVKind+(q?q+1:"")),m=t.getVerticesData(I.R.ColorKind),v=A.Pq.Zero();t.computeWorldMatrix();const W=t.getWorldMatrix();if(!W.isIdentity()){s=s.slice(0);for(let t=0;t<s.length/3;t++)A.Pq.TransformCoordinatesFromFloatsToRef(s[3*t],s[3*t+1],s[3*t+2],W,v),s[3*t]=v.x,s[3*t+1]=v.y,s[3*t+2]=v.z}let Z=0,D=0,y=0,E=0,_=0,p=0,L=0,O=0,r=0,z=0,w=0,b=0,a=0;const u=A.Pq.Zero(),j=A.Pq.Zero(),x=A.Pq.Zero(),e=A.Pq.Zero(),Y=A.Pq.Zero();let H=0,h=0,T=0,P=0,Q=0,J=0;const U=A.I9.Zero(),l=A.I9.Zero(),i=A.I9.Zero(),G=A.I9.Zero(),d=A.I9.Zero();let M=0,B=0,o=0,f=0,g=0,tt=0,Vt=0,Xt=0,Kt=0,kt=0,At=0,$t=0;const It=A.IU.Zero(),Ct=A.IU.Zero(),nt=A.IU.Zero(),qt=A.IU.Zero(),Rt=A.IU.Zero();let Ft,st,St=0,ct=0;n=n||0;let Nt=new A.IU(0,0,0,0),mt=A.Pq.Zero(),vt=A.Pq.Zero(),Wt=A.Pq.Zero(),Zt=0,Dt=A.Pq.Zero(),yt=0,Et=0;const _t=new F.R(A.Pq.Zero(),new A.Pq(1,0,0));let pt,Lt=A.Pq.Zero();for(let I=0;I<S.length/3;I++){let q,F,v,W,Ot,rt,zt,wt;D=S[3*I],y=S[3*I+1],E=S[3*I+2],_=s[3*D],p=s[3*D+1],L=s[3*D+2],O=s[3*y],r=s[3*y+1],z=s[3*y+2],w=s[3*E],b=s[3*E+1],a=s[3*E+2],u.set(_,p,L),j.set(O,r,z),x.set(w,b,a),j.subtractToRef(u,e),x.subtractToRef(j,Y),N&&(H=N[2*D],h=N[2*D+1],T=N[2*y],P=N[2*y+1],Q=N[2*E],J=N[2*E+1],U.set(H,h),l.set(T,P),i.set(Q,J),l.subtractToRef(U,G),i.subtractToRef(l,d)),m&&K&&(M=m[4*D],B=m[4*D+1],o=m[4*D+2],f=m[4*D+3],g=m[4*y],tt=m[4*y+1],Vt=m[4*y+2],Xt=m[4*y+3],Kt=m[4*E],kt=m[4*E+1],At=m[4*E+2],$t=m[4*E+3],It.set(M,B,o,f),Ct.set(g,tt,Vt,Xt),nt.set(Kt,kt,At,$t),Ct.subtractToRef(It,qt),nt.subtractToRef(Ct,Rt));const bt=new k.v9(0,0,0),at=new k.v9(0,0,0);let ut,jt;for(let s=0;s<V._groupDensity[I];s++)Z=this.particles.length,this._addParticle(Z,V,this._groupCounter,I+s),jt=this.particles[Z],St=Math.sqrt(c.X.RandomRange(0,1)),ct=c.X.RandomRange(0,1),Ft=u.add(e.scale(St)).add(Y.scale(St*ct)),X&&(mt=t.getFacetNormal(I).normalize().scale(-1),vt=e.clone().normalize(),Wt=A.Pq.Cross(mt,vt),Zt=c.X.RandomRange(0,2*Math.PI),Dt=vt.scale(Math.cos(Zt)).add(Wt.scale(Math.sin(Zt))),Zt=c.X.RandomRange(.1,Math.PI/2),Lt=Dt.scale(Math.cos(Zt)).add(mt.scale(Math.sin(Zt))),_t.origin=Ft.add(Lt.scale(1e-5)),_t.direction=Lt,_t.length=R,pt=_t.intersectsMesh(t),pt.hit&&(Et=pt.pickedPoint.subtract(Ft).length(),yt=c.X.RandomRange(0,1)*Et,Ft.addInPlace(Lt.scale(yt)))),jt.position=Ft.clone(),this._positions.push(jt.position.x,jt.position.y,jt.position.z),void 0!==K?N&&(st=U.add(G.scale(St)).add(d.scale(St*ct)),K?$&&null!==V._groupImageData?(q=V._groupImgWidth,F=V._groupImgHeight,ut=this._getColorIndicesForCoord(V,Math.round(st.x*q),Math.round(st.y*F),q),jt.color=ut,this._colors.push(ut.r,ut.g,ut.b,ut.a)):m?(Nt=It.add(qt.scale(St)).add(Rt.scale(St*ct)),jt.color=new k.ov(Nt.x,Nt.y,Nt.z,Nt.w),this._colors.push(Nt.x,Nt.y,Nt.z,Nt.w)):(Nt=It.set(Math.random(),Math.random(),Math.random(),1),jt.color=new k.ov(Nt.x,Nt.y,Nt.z,Nt.w),this._colors.push(Nt.x,Nt.y,Nt.z,Nt.w)):(jt.uv=st.clone(),this._uvs.push(jt.uv.x,jt.uv.y))):(C?(bt.set(C.r,C.g,C.b),v=c.X.RandomRange(-n,n),W=c.X.RandomRange(-n,n),wt=bt.toHSV(),Ot=wt.r,rt=wt.g+v,zt=wt.b+W,rt<0&&(rt=0),rt>1&&(rt=1),zt<0&&(zt=0),zt>1&&(zt=1),k.v9.HSVtoRGBToRef(Ot,rt,zt,at),Nt.set(at.r,at.g,at.b,1)):Nt=It.set(Math.random(),Math.random(),Math.random(),1),jt.color=new k.ov(Nt.x,Nt.y,Nt.z,Nt.w),this._colors.push(Nt.x,Nt.y,Nt.z,Nt.w))}}_colorFromTexture(t,V,X){if(null===t.material)return $.V.Warn(t.name+"has no material."),V._groupImageData=null,void this._setPointsColorOrUV(t,V,X,!0,!1);const K=t.material.getActiveTextures();if(0===K.length)return $.V.Warn(t.name+"has no usable texture."),V._groupImageData=null,void this._setPointsColorOrUV(t,V,X,!0,!1);const k=t.clone();k.setEnabled(!1),this._promises.push(new Promise((t=>{S.t.WhenAllReady(K,(()=>{let A=V._textureNb;A<0&&(A=0),A>K.length-1&&(A=K.length-1);const $=()=>{V._groupImgWidth=K[A].getSize().width,V._groupImgHeight=K[A].getSize().height,this._setPointsColorOrUV(k,V,X,!0,!0,void 0,void 0,K[A].coordinatesIndex),k.dispose(),t()};V._groupImageData=null;const I=K[A].readPixels();I?I.then((t=>{V._groupImageData=t,$()})):$()}))})))}_calculateDensity(t,V,X){let K,k,$,I,C,n,q,R,F,s,S,c;const N=A.Pq.Zero(),m=A.Pq.Zero(),v=A.Pq.Zero(),W=A.Pq.Zero(),Z=A.Pq.Zero(),D=A.Pq.Zero();let y;const E=[];let _=0;const p=X.length/3;for(let t=0;t<p;t++)K=X[3*t],k=X[3*t+1],$=X[3*t+2],I=V[3*K],C=V[3*K+1],n=V[3*K+2],q=V[3*k],R=V[3*k+1],F=V[3*k+2],s=V[3*$],S=V[3*$+1],c=V[3*$+2],N.set(I,C,n),m.set(q,R,F),v.set(s,S,c),m.subtractToRef(N,W),v.subtractToRef(m,Z),A.Pq.CrossToRef(W,Z,D),y=.5*D.length(),_+=y,E[t]=_;const L=new Array(p);let O=t;for(let t=p-1;t>0;t--){const V=E[t];if(0===V)L[t]=0;else{const X=(V-E[t-1])/V*O,K=Math.floor(X),k=X-K,A=K+Number(Math.random()<k);L[t]=A,O-=A}}return L[0]=O,L}addPoints(t,V=this._randomUnitVector){const X=new R.x(this._groupCounter,V);let K,k=this.nbParticles;for(let V=0;V<t;V++)K=this._addParticle(k,X,this._groupCounter,V),X&&X._positionFunction&&X._positionFunction(K,k,V),this._positions.push(K.position.x,K.position.y,K.position.z),K.color&&this._colors.push(K.color.r,K.color.g,K.color.b,K.color.a),K.uv&&this._uvs.push(K.uv.x,K.uv.y),k++;return this.nbParticles+=t,this._groupCounter++,this._groupCounter}addSurfacePoints(t,V,X,K,A){let $=X||0;(isNaN($)||$<0||$>3)&&($=0);const C=t.getVerticesData(I.R.PositionKind),n=t.getIndices();this._groups.push(this._groupCounter);const q=new R.x(this._groupCounter,null);switch(q._groupDensity=this._calculateDensity(V,C,n),2===$?q._textureNb=K||0:K=K||new k.ov(1,1,1,1),$){case 2:this._colorFromTexture(t,q,!1);break;case 1:this._setPointsColorOrUV(t,q,!1,!1,!1);break;case 0:this._setPointsColorOrUV(t,q,!1);break;case 3:this._setPointsColorOrUV(t,q,!1,void 0,void 0,K,A)}return this.nbParticles+=V,this._groupCounter++,this._groupCounter-1}addVolumePoints(t,V,X,K,A){let $=X||0;(isNaN($)||$<0||$>3)&&($=0);const C=t.getVerticesData(I.R.PositionKind),n=t.getIndices();this._groups.push(this._groupCounter);const q=new R.x(this._groupCounter,null);switch(q._groupDensity=this._calculateDensity(V,C,n),2===$?q._textureNb=K||0:K=K||new k.ov(1,1,1,1),$){case 2:this._colorFromTexture(t,q,!0);break;case 1:this._setPointsColorOrUV(t,q,!0,!1,!1);break;case 0:this._setPointsColorOrUV(t,q,!0);break;case 3:this._setPointsColorOrUV(t,q,!0,void 0,void 0,K,A)}return this.nbParticles+=V,this._groupCounter++,this._groupCounter-1}setParticles(t=0,V=this.nbParticles-1,X=!0){var K,k;if(!this._updatable||!this._isReady)return this;this.beforeUpdateParticles(t,V,X);const $=A.AA.Matrix[0],C=this.mesh,n=this._colors32,q=this._positions32,R=this._uvs32,F=A.AA.Vector3,s=F[5].copyFromFloats(1,0,0),S=F[6].copyFromFloats(0,1,0),c=F[7].copyFromFloats(0,0,1),N=F[8].setAll(Number.MAX_VALUE),m=F[9].setAll(-Number.MAX_VALUE);A.uq.IdentityToRef($);let v=0;if((null===(K=this.mesh)||void 0===K?void 0:K.isFacetDataEnabled)&&(this._computeBoundingBox=!0),V=V>=this.nbParticles?this.nbParticles-1:V,this._computeBoundingBox&&(0!=t||V!=this.nbParticles-1)){const t=null===(k=this.mesh)||void 0===k?void 0:k.getBoundingInfo();t&&(N.copyFrom(t.minimum),m.copyFrom(t.maximum))}v=0;let W=0,Z=0,D=0;for(let X=t;X<=V;X++){const t=this.particles[X];v=t.idx,W=3*v,Z=4*v,D=2*v,this.updateParticle(t);const V=t._rotationMatrix,K=t.position,k=t._globalPosition;if(this._computeParticleRotation&&t.getRotationMatrix($),null!==t.parentId){const X=this.particles[t.parentId],A=X._rotationMatrix,I=X._globalPosition,C=K.x*A[1]+K.y*A[4]+K.z*A[7],n=K.x*A[0]+K.y*A[3]+K.z*A[6],q=K.x*A[2]+K.y*A[5]+K.z*A[8];if(k.x=I.x+n,k.y=I.y+C,k.z=I.z+q,this._computeParticleRotation){const t=$.m;V[0]=t[0]*A[0]+t[1]*A[3]+t[2]*A[6],V[1]=t[0]*A[1]+t[1]*A[4]+t[2]*A[7],V[2]=t[0]*A[2]+t[1]*A[5]+t[2]*A[8],V[3]=t[4]*A[0]+t[5]*A[3]+t[6]*A[6],V[4]=t[4]*A[1]+t[5]*A[4]+t[6]*A[7],V[5]=t[4]*A[2]+t[5]*A[5]+t[6]*A[8],V[6]=t[8]*A[0]+t[9]*A[3]+t[10]*A[6],V[7]=t[8]*A[1]+t[9]*A[4]+t[10]*A[7],V[8]=t[8]*A[2]+t[9]*A[5]+t[10]*A[8]}}else if(k.x=0,k.y=0,k.z=0,this._computeParticleRotation){const t=$.m;V[0]=t[0],V[1]=t[1],V[2]=t[2],V[3]=t[4],V[4]=t[5],V[5]=t[6],V[6]=t[8],V[7]=t[9],V[8]=t[10]}const A=F[11];t.translateFromPivot?A.setAll(0):A.copyFrom(t.pivot);const I=F[0];I.copyFrom(t.position);const C=I.x-t.pivot.x,n=I.y-t.pivot.y,R=I.z-t.pivot.z;let y=C*V[0]+n*V[3]+R*V[6],E=C*V[1]+n*V[4]+R*V[7],_=C*V[2]+n*V[5]+R*V[8];y+=A.x,E+=A.y,_+=A.z;const p=q[W]=k.x+s.x*y+S.x*E+c.x*_,L=q[W+1]=k.y+s.y*y+S.y*E+c.y*_,O=q[W+2]=k.z+s.z*y+S.z*E+c.z*_;if(this._computeBoundingBox&&(N.minimizeInPlaceFromFloats(p,L,O),m.maximizeInPlaceFromFloats(p,L,O)),this._computeParticleColor&&t.color){const V=t.color,X=this._colors32;X[Z]=V.r,X[Z+1]=V.g,X[Z+2]=V.b,X[Z+3]=V.a}if(this._computeParticleTexture&&t.uv){const V=t.uv,X=this._uvs32;X[D]=V.x,X[D+1]=V.y}}return C&&(X&&(this._computeParticleColor&&C.updateVerticesData(I.R.ColorKind,n,!1,!1),this._computeParticleTexture&&C.updateVerticesData(I.R.UVKind,R,!1,!1),C.updateVerticesData(I.R.PositionKind,q,!1,!1)),this._computeBoundingBox&&(C.hasBoundingInfo?C.getBoundingInfo().reConstruct(N,m,C._worldMatrix):C.buildBoundingInfo(N,m,C._worldMatrix))),this.afterUpdateParticles(t,V,X),this}dispose(){var t;null===(t=this.mesh)||void 0===t||t.dispose(),this.vars=null,this._positions=null,this._indices=null,this._normals=null,this._uvs=null,this._colors=null,this._indices32=null,this._positions32=null,this._uvs32=null,this._colors32=null}refreshVisibleSize(){var t;return this._isVisibilityBoxLocked||null===(t=this.mesh)||void 0===t||t.refreshBoundingInfo(),this}setVisibilityBox(t){if(!this.mesh)return;const V=t/2;this.mesh.buildBoundingInfo(new A.Pq(-V,-V,-V),new A.Pq(V,V,V))}get isAlwaysVisible(){return this._alwaysVisible}set isAlwaysVisible(t){this.mesh&&(this._alwaysVisible=t,this.mesh.alwaysSelectAsActiveMesh=t)}set computeParticleRotation(t){this._computeParticleRotation=t}set computeParticleColor(t){this._computeParticleColor=t}set computeParticleTexture(t){this._computeParticleTexture=t}get computeParticleColor(){return this._computeParticleColor}get computeParticleTexture(){return this._computeParticleTexture}set computeBoundingBox(t){this._computeBoundingBox=t}get computeBoundingBox(){return this._computeBoundingBox}initParticles(){}recycleParticle(t){return t}updateParticle(t){return t}beforeUpdateParticles(t,V,X){}afterUpdateParticles(t,V,X){}}},485588:(t,V,X)=>{X.d(V,{XU:()=>n,ZA:()=>q,em:()=>R,gA:()=>C});var K=X(604910),k=X(332290),A=X(59036),$=X(214601),I=X(938868);class C{getBoundingInfo(){return this._boundingInfo}get hasBoundingInfo(){return null!==this._boundingInfo}constructor(t,V,X,$,C,n,q,R,F=null,s=null){this.idx=0,this.id=0,this.color=new k.ov(1,1,1,1),this.position=K.Pq.Zero(),this.rotation=K.Pq.Zero(),this.scaling=K.Pq.One(),this.uvs=new K.IU(0,0,1,1),this.velocity=K.Pq.Zero(),this.pivot=K.Pq.Zero(),this.translateFromPivot=!1,this.alive=!0,this.isVisible=!0,this._pos=0,this._ind=0,this.shapeId=0,this.idxInShape=0,this._stillInvisible=!1,this._rotationMatrix=[1,0,0,0,1,0,0,0,1],this.parentId=null,this.materialIndex=null,this.props=null,this.cullingStrategy=I.u.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY,this._globalPosition=K.Pq.Zero(),this.idx=t,this.id=V,this._pos=X,this._ind=$,this._model=C,this.shapeId=n,this.idxInShape=q,this._sps=R,F&&(this._modelBoundingInfo=F,this._boundingInfo=new A.j(F.minimum,F.maximum)),null!==s&&(this.materialIndex=s)}copyToRef(t){return t.position.copyFrom(this.position),t.rotation.copyFrom(this.rotation),this.rotationQuaternion&&(t.rotationQuaternion?t.rotationQuaternion.copyFrom(this.rotationQuaternion):t.rotationQuaternion=this.rotationQuaternion.clone()),t.scaling.copyFrom(this.scaling),this.color&&(t.color?t.color.copyFrom(this.color):t.color=this.color.clone()),t.uvs.copyFrom(this.uvs),t.velocity.copyFrom(this.velocity),t.pivot.copyFrom(this.pivot),t.translateFromPivot=this.translateFromPivot,t.alive=this.alive,t.isVisible=this.isVisible,t.parentId=this.parentId,t.cullingStrategy=this.cullingStrategy,null!==this.materialIndex&&(t.materialIndex=this.materialIndex),this}get scale(){return this.scaling}set scale(t){this.scaling=t}get quaternion(){return this.rotationQuaternion}set quaternion(t){this.rotationQuaternion=t}intersectsMesh(t){return!(!this._boundingInfo||!t.hasBoundingInfo)&&(this._sps._bSphereOnly?$.i.Intersects(this._boundingInfo.boundingSphere,t.getBoundingInfo().boundingSphere):this._boundingInfo.intersects(t.getBoundingInfo(),!1))}isInFrustum(t){return null!==this._boundingInfo&&this._boundingInfo.isInFrustum(t,this.cullingStrategy)}getRotationMatrix(t){let V;if(this.rotationQuaternion)V=this.rotationQuaternion;else{V=K.AA.Quaternion[0];const t=this.rotation;K.PT.RotationYawPitchRollToRef(t.y,t.x,t.z,V)}V.toRotationMatrix(t)}}class n{get shapeID(){return this.shapeId}set shapeID(t){this.shapeId=t}constructor(t,V,X,K,k,A,$,I,C){this._indicesLength=0,this.shapeId=t,this._shape=V,this._indices=X,this._indicesLength=X.length,this._shapeUV=A,this._shapeColors=k,this._normals=K,this._positionFunction=$,this._vertexFunction=I,this._material=C}}class q{constructor(t,V,X,K){this.idx=0,this.ind=0,this.indicesLength=0,this.sqDistance=0,this.materialIndex=0,this.idx=t,this.ind=V,this.indicesLength=X,this.materialIndex=K}}class R{constructor(){this.position=K.Pq.Zero(),this.color=new k.ov(1,1,1,1),this.uv=K.I9.Zero()}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}get z(){return this.position.z}set z(t){this.position.z=t}}},250057:(t,V,X)=>{X.d(V,{l:()=>N});var K=X(604910),k=X(332290),A=X(23987),$=X(818696),I=X(27230),C=X(858004),n=X(395726),q=X(485588),R=X(59036),F=X(690096),s=X(374216),S=X(32138),c=X(234412);class N{constructor(t,V,X){this.particles=new Array,this.nbParticles=0,this.billboard=!1,this.recomputeNormals=!1,this.counter=0,this.vars={},this._bSphereOnly=!1,this._bSphereRadiusFactor=1,this._positions=new Array,this._indices=new Array,this._normals=new Array,this._colors=new Array,this._uvs=new Array,this._index=0,this._updatable=!0,this._pickable=!1,this._isVisibilityBoxLocked=!1,this._alwaysVisible=!1,this._depthSort=!1,this._expandable=!1,this._shapeCounter=0,this._copy=new q.gA(0,0,0,0,null,0,0,this),this._color=new k.ov(0,0,0,0),this._computeParticleColor=!0,this._computeParticleTexture=!0,this._computeParticleRotation=!0,this._computeParticleVertex=!1,this._computeBoundingBox=!1,this._autoFixFaceOrientation=!1,this._depthSortParticles=!0,this._mustUnrotateFixedNormals=!1,this._particlesIntersect=!1,this._needs32Bits=!1,this._isNotBuilt=!0,this._lastParticleId=0,this._idxOfId=[],this._multimaterialEnabled=!1,this._useModelMaterial=!1,this._depthSortFunction=(t,V)=>V.sqDistance-t.sqDistance,this._materialSortFunction=(t,V)=>t.materialIndex-V.materialIndex,this._autoUpdateSubMeshes=!1,this._recomputeInvisibles=!1,this.name=t,this._scene=V||n.q.LastCreatedScene,this._camera=V.activeCamera,this._pickable=!!X&&X.isPickable,this._depthSort=!!X&&X.enableDepthSort,this._multimaterialEnabled=!!X&&X.enableMultiMaterial,this._useModelMaterial=!!X&&X.useModelMaterial,this._multimaterialEnabled=!!this._useModelMaterial||this._multimaterialEnabled,this._expandable=!!X&&X.expandable,this._particlesIntersect=!!X&&X.particleIntersection,this._bSphereOnly=!!X&&X.boundingSphereOnly,this._bSphereRadiusFactor=X&&X.bSphereRadiusFactor?X.bSphereRadiusFactor:1,this._computeBoundingBox=!!(null==X?void 0:X.computeBoundingBox)&&X.computeBoundingBox,this._autoFixFaceOrientation=!!(null==X?void 0:X.autoFixFaceOrientation)&&X.autoFixFaceOrientation,X&&void 0!==X.updatable?this._updatable=X.updatable:this._updatable=!0,this._pickable&&(this.pickedBySubMesh=[[]],this.pickedParticles=this.pickedBySubMesh[0]),(this._depthSort||this._multimaterialEnabled)&&(this.depthSortedParticles=[]),this._multimaterialEnabled&&(this._multimaterial=new c.F(this.name+"MultiMaterial",this._scene),this._materials=[],this._materialIndexesById={}),this._tmpVertex=new q.em}buildMesh(){if(!this._isNotBuilt&&this.mesh)return this.mesh;if(0===this.nbParticles&&!this.mesh){const t=C.WA("",{radius:1,tessellation:3},this._scene);this.addShape(t,1),t.dispose()}if(this._indices32=this._needs32Bits?new Uint32Array(this._indices):new Uint16Array(this._indices),this._positions32=new Float32Array(this._positions),this._uvs32=new Float32Array(this._uvs),this._colors32=new Float32Array(this._colors),!this.mesh){const t=new I.e(this.name,this._scene);this.mesh=t}!this._updatable&&this._multimaterialEnabled&&this._sortParticlesByMaterial(),this.recomputeNormals&&$.P.ComputeNormals(this._positions32,this._indices32,this._normals),this._normals32=new Float32Array(this._normals),this._fixedNormal32=new Float32Array(this._normals),this._mustUnrotateFixedNormals&&this._unrotateFixedNormals();const t=new $.P;if(t.indices=this._depthSort?this._indices:this._indices32,t.set(this._positions32,A.R.PositionKind),t.set(this._normals32,A.R.NormalKind),this._uvs32.length>0&&t.set(this._uvs32,A.R.UVKind),this._colors32.length>0&&t.set(this._colors32,A.R.ColorKind),t.applyToMesh(this.mesh,this._updatable),this.mesh.isPickable=this._pickable,this._pickable){let t=0;for(let V=0;V<this.nbParticles;V++){const X=this.particles[V],K=X._model._indicesLength;for(let V=0;V<K;V++)if(0==V%3){const V={idx:X.idx,faceId:t};this.pickedParticles[t]=V,t++}}}return this._multimaterialEnabled&&this.setMultiMaterial(this._materials),this._expandable||(this._depthSort||this._multimaterialEnabled||this._autoFixFaceOrientation||(this._indices=null),this._positions=null,this._normals=null,this._uvs=null,this._colors=null,this._updatable||(this.particles.length=0)),this._isNotBuilt=!1,this.recomputeNormals=!1,this._recomputeInvisibles=!0,this.mesh}_getUVKind(t,V){var X,K;return-1===V&&((null===(X=t.material)||void 0===X?void 0:X.diffuseTexture)?V=t.material.diffuseTexture.coordinatesIndex:(null===(K=t.material)||void 0===K?void 0:K.albedoTexture)&&(V=t.material.albedoTexture.coordinatesIndex)),"uv"+(V?V+1:"")}digest(t,V){var X;let k=V&&V.facetNb||1,$=V&&V.number||0,I=V&&V.delta||0;const C=t.getVerticesData(A.R.PositionKind),n=t.getIndices(),F=t.getVerticesData(this._getUVKind(t,null!==(X=null==V?void 0:V.uvKind)&&void 0!==X?X:0)),s=t.getVerticesData(A.R.ColorKind),S=t.getVerticesData(A.R.NormalKind),c=V&&V.storage?V.storage:null;let N=0;const m=n.length/3;$?($=$>m?m:$,k=Math.round(m/$),I=0):k=k>m?m:k;const v=[],W=[],Z=[],D=[],y=[],E=K.Pq.Zero(),_=k;for(;N<m;){k=_+Math.floor((1+I)*Math.random()),N>m-k&&(k=m-N),v.length=0,W.length=0,Z.length=0,D.length=0,y.length=0;let V=0;for(let t=3*N;t<3*(N+k);t++){Z.push(V);const X=n[t],K=3*X;if(v.push(C[K],C[K+1],C[K+2]),W.push(S[K],S[K+1],S[K+2]),F){const t=2*X;D.push(F[t],F[t+1])}if(s){const t=4*X;y.push(s[t],s[t+1],s[t+2],s[t+3])}V++}let X=this.nbParticles;const A=this._posToShape(v),$=this._uvsToShapeUV(D),p=Z.slice(),L=y.slice(),O=W.slice();let r;for(E.copyFromFloats(0,0,0),r=0;r<A.length;r++)E.addInPlace(A[r]);E.scaleInPlace(1/A.length);const z=new K.Pq(1/0,1/0,1/0),w=new K.Pq(-1/0,-1/0,-1/0);for(r=0;r<A.length;r++)A[r].subtractInPlace(E),z.minimizeInPlaceFromFloats(A[r].x,A[r].y,A[r].z),w.maximizeInPlaceFromFloats(A[r].x,A[r].y,A[r].z);let b;this._particlesIntersect&&(b=new R.j(z,w));let a=null;this._useModelMaterial&&(a=t.material?t.material:this._setDefaultMaterial());const u=new q.XU(this._shapeCounter,A,p,O,L,$,null,null,a),j=this._positions.length,x=this._indices.length;this._meshBuilder(this._index,x,A,this._positions,p,this._indices,D,this._uvs,L,this._colors,O,this._normals,X,0,null,u),this._addParticle(X,this._lastParticleId,j,x,u,this._shapeCounter,0,b,c),this.particles[this.nbParticles].position.addInPlace(E),c||(this._index+=A.length,X++,this.nbParticles++,this._lastParticleId++),this._shapeCounter++,N+=k}return this._isNotBuilt=!0,this}_unrotateFixedNormals(){let t=0,V=0;const X=K.AA.Vector3[0],k=K.AA.Quaternion[0],A=K.AA.Matrix[0];for(let $=0;$<this.particles.length;$++){const I=this.particles[$],C=I._model._shape;if(I.rotationQuaternion)I.rotationQuaternion.conjugateToRef(k);else{const t=I.rotation;K.PT.RotationYawPitchRollToRef(t.y,t.x,t.z,k),k.conjugateInPlace()}k.toRotationMatrix(A);for(let k=0;k<C.length;k++)V=t+3*k,K.Pq.TransformNormalFromFloatsToRef(this._normals32[V],this._normals32[V+1],this._normals32[V+2],A,X),X.toArray(this._fixedNormal32,V);t=V+3}}_resetCopy(){const t=this._copy;t.position.setAll(0),t.rotation.setAll(0),t.rotationQuaternion=null,t.scaling.setAll(1),t.uvs.copyFromFloats(0,0,1,1),t.color=null,t.translateFromPivot=!1,t.shapeId=0,t.materialIndex=null}_meshBuilder(t,V,X,k,A,$,I,C,n,R,F,s,S,c,N,m){let v,W=0,Z=0,D=0;this._resetCopy();const y=this._copy,E=!(!N||!N.storage);if(y.idx=S,y.idxInShape=c,y.shapeId=m.shapeId,this._useModelMaterial){const t=m._material.uniqueId,V=this._materialIndexesById;Object.prototype.hasOwnProperty.call(V,t)||(V[t]=this._materials.length,this._materials.push(m._material));const X=V[t];y.materialIndex=X}if(N&&N.positionFunction&&(N.positionFunction(y,S,c),this._mustUnrotateFixedNormals=!0),E)return y;const _=K.AA.Matrix[0],p=this._tmpVertex,L=p.position,O=p.color,r=p.uv,z=K.AA.Vector3[1],w=K.AA.Vector3[2],b=K.AA.Vector3[3];K.uq.IdentityToRef(_),y.getRotationMatrix(_),y.pivot.multiplyToRef(y.scaling,b),y.translateFromPivot?w.setAll(0):w.copyFrom(b);const a=N&&N.vertexFunction;for(v=0;v<X.length;v++){if(L.copyFrom(X[v]),y.color&&O.copyFrom(y.color),I&&r.copyFromFloats(I[W],I[W+1]),a&&N.vertexFunction(y,p,v),L.multiplyInPlace(y.scaling).subtractInPlace(b),K.Pq.TransformCoordinatesToRef(L,_,z),z.addInPlace(w).addInPlace(y.position),k.push(z.x,z.y,z.z),I){const t=y.uvs;C.push((t.z-t.x)*r.x+t.x,(t.w-t.y)*r.y+t.y),W+=2}if(y.color)this._color.copyFrom(O);else{const t=this._color;n&&void 0!==n[Z]?(t.r=n[Z],t.g=n[Z+1],t.b=n[Z+2],t.a=n[Z+3]):(t.r=1,t.g=1,t.b=1,t.a=1)}R.push(this._color.r,this._color.g,this._color.b,this._color.a),Z+=4,!this.recomputeNormals&&F&&(K.Pq.TransformNormalFromFloatsToRef(F[D],F[D+1],F[D+2],_,L),s.push(L.x,L.y,L.z),D+=3)}for(v=0;v<A.length;v++){const V=t+A[v];$.push(V),V>65535&&(this._needs32Bits=!0)}if(this._depthSort||this._multimaterialEnabled){const t=null!==y.materialIndex?y.materialIndex:0;this.depthSortedParticles.push(new q.ZA(S,V,A.length,t))}return y}_posToShape(t){const V=[];for(let X=0;X<t.length;X+=3)V.push(K.Pq.FromArray(t,X));return V}_uvsToShapeUV(t){const V=[];if(t)for(let X=0;X<t.length;X++)V.push(t[X]);return V}_addParticle(t,V,X,K,k,A,$,I=null,C=null){const n=new q.gA(t,V,X,K,k,A,$,this,I);return(C||this.particles).push(n),n}addShape(t,V,X){const K=t.getVerticesData(A.R.PositionKind),k=t.getIndices(),$=t.getVerticesData(A.R.UVKind),I=t.getVerticesData(A.R.ColorKind),C=t.getVerticesData(A.R.NormalKind);this.recomputeNormals=!C;const n=Array.from(k),R=C?Array.from(C):[],F=I?Array.from(I):[],s=X&&X.storage?X.storage:null;let S=null;this._particlesIntersect&&(S=t.getBoundingInfo());const c=this._posToShape(K),N=this._uvsToShapeUV($),m=X?X.positionFunction:null,v=X?X.vertexFunction:null;let W=null;this._useModelMaterial&&(W=t.material?t.material:this._setDefaultMaterial());const Z=new q.XU(this._shapeCounter,c,n,R,F,N,m,v,W);for(let t=0;t<V;t++)this._insertNewParticle(this.nbParticles,t,Z,c,k,$,I,C,S,s,X);return this._shapeCounter++,this._isNotBuilt=!0,this._shapeCounter-1}_rebuildParticle(t,V=!1){this._resetCopy();const X=this._copy;t._model._positionFunction&&t._model._positionFunction(X,t.idx,t.idxInShape);const k=K.AA.Matrix[0],A=K.AA.Vector3[0],$=K.AA.Vector3[1],I=K.AA.Vector3[2],C=K.AA.Vector3[3];X.getRotationMatrix(k),t.pivot.multiplyToRef(t.scaling,C),X.translateFromPivot?I.copyFromFloats(0,0,0):I.copyFrom(C);const n=t._model._shape;for(let V=0;V<n.length;V++)A.copyFrom(n[V]),t._model._vertexFunction&&t._model._vertexFunction(X,A,V),A.multiplyInPlace(X.scaling).subtractInPlace(C),K.Pq.TransformCoordinatesToRef(A,k,$),$.addInPlace(I).addInPlace(X.position).toArray(this._positions32,t._pos+3*V);V&&(t.position.setAll(0),t.rotation.setAll(0),t.rotationQuaternion=null,t.scaling.setAll(1),t.uvs.setAll(0),t.pivot.setAll(0),t.translateFromPivot=!1,t.parentId=null)}rebuildMesh(t=!1){for(let V=0;V<this.particles.length;V++)this._rebuildParticle(this.particles[V],t);return this.mesh.updateVerticesData(A.R.PositionKind,this._positions32,!1,!1),this}removeParticles(t,V){const X=V-t+1;if(!this._expandable||X<=0||X>=this.nbParticles||!this._updatable)return[];const K=this.particles,k=this.nbParticles;if(V<k-1){const X=V+1,A=K[X]._pos-K[t]._pos,$=K[X]._ind-K[t]._ind;for(let t=X;t<k;t++){const V=K[t];V._pos-=A,V._ind-=$}}const A=K.splice(t,X);this._positions.length=0,this._indices.length=0,this._colors.length=0,this._uvs.length=0,this._normals.length=0,this._index=0,this._idxOfId.length=0,(this._depthSort||this._multimaterialEnabled)&&(this.depthSortedParticles=[]);let $=0;const I=K.length;for(let t=0;t<I;t++){const V=K[t],X=V._model,k=X._shape,A=X._indices,I=X._normals,C=X._shapeColors,n=X._shapeUV;V.idx=t,this._idxOfId[V.id]=t,this._meshBuilder(this._index,$,k,this._positions,A,this._indices,n,this._uvs,C,this._colors,I,this._normals,V.idx,V.idxInShape,null,X),this._index+=k.length,$+=A.length}return this.nbParticles-=X,this._isNotBuilt=!0,A}insertParticlesFromArray(t){if(!this._expandable)return this;let V=0,X=t[0].shapeId;const K=t.length;for(let k=0;k<K;k++){const K=t[k],A=K._model,$=A._shape,I=A._indices,C=A._shapeUV,n=A._shapeColors,q=A._normals,R=!q;this.recomputeNormals=R||this.recomputeNormals;const F=K.getBoundingInfo(),s=this._insertNewParticle(this.nbParticles,V,A,$,I,C,n,q,F,null,null);K.copyToRef(s),V++,X!=K.shapeId&&(X=K.shapeId,V=0)}return this._isNotBuilt=!0,this}_insertNewParticle(t,V,X,K,k,A,$,I,C,n,q){const R=this._positions.length,F=this._indices.length,s=this._meshBuilder(this._index,F,K,this._positions,k,this._indices,A,this._uvs,$,this._colors,I,this._normals,t,V,q,X);let S=null;return this._updatable&&(S=this._addParticle(this.nbParticles,this._lastParticleId,R,F,X,this._shapeCounter,V,C,n),S.position.copyFrom(s.position),S.rotation.copyFrom(s.rotation),s.rotationQuaternion&&(S.rotationQuaternion?S.rotationQuaternion.copyFrom(s.rotationQuaternion):S.rotationQuaternion=s.rotationQuaternion.clone()),s.color&&(S.color?S.color.copyFrom(s.color):S.color=s.color.clone()),S.scaling.copyFrom(s.scaling),S.uvs.copyFrom(s.uvs),null!==s.materialIndex&&(S.materialIndex=s.materialIndex),this.expandable&&(this._idxOfId[S.id]=S.idx)),n||(this._index+=K.length,this.nbParticles++,this._lastParticleId++),S}setParticles(t=0,V=this.nbParticles-1,X=!0){if(!this._updatable||this._isNotBuilt)return this;this.beforeUpdateParticles(t,V,X);const k=K.AA.Matrix[0],I=K.AA.Matrix[1],C=this.mesh,n=this._colors32,q=this._positions32,R=this._normals32,s=this._uvs32,S=this._indices32,c=this._indices,N=this._fixedNormal32,m=this._depthSort&&this._depthSortParticles,v=K.AA.Vector3,W=v[5].copyFromFloats(1,0,0),Z=v[6].copyFromFloats(0,1,0),D=v[7].copyFromFloats(0,0,1),y=v[8].setAll(Number.MAX_VALUE),E=v[9].setAll(-Number.MAX_VALUE),_=v[10].setAll(0),p=this._tmpVertex,L=p.position,O=p.color,r=p.uv;if((this.billboard||this._depthSort)&&(this.mesh.computeWorldMatrix(!0),this.mesh._worldMatrix.invertToRef(I)),this.billboard){const t=v[0];this._camera.getDirectionToRef(F._0.Z,t),K.Pq.TransformNormalToRef(t,I,D),D.normalize();const V=this._camera.getViewMatrix(!0);K.Pq.TransformNormalFromFloatsToRef(V.m[1],V.m[5],V.m[9],I,Z),K.Pq.CrossToRef(Z,D,W),Z.normalize(),W.normalize()}this._depthSort&&K.Pq.TransformCoordinatesToRef(this._camera.globalPosition,I,_),K.uq.IdentityToRef(k);let z=0,w=0,b=0,a=0,u=0,j=0,x=0;if(this.mesh.isFacetDataEnabled&&(this._computeBoundingBox=!0),V=V>=this.nbParticles?this.nbParticles-1:V,this._computeBoundingBox&&(0!=t||V!=this.nbParticles-1)){const t=this.mesh.getBoundingInfo();t&&(y.copyFrom(t.minimum),E.copyFrom(t.maximum))}w=this.particles[t]._pos;const e=w/3|0;a=4*e,j=2*e;for(let X=t;X<=V;X++){const t=this.particles[X];this.updateParticle(t);const V=t._model._shape,A=t._model._shapeUV,$=t._rotationMatrix,I=t.position,F=t.rotation,S=t.scaling,c=t._globalPosition;if(m){const V=this.depthSortedParticles[X];V.idx=t.idx,V.ind=t._ind,V.indicesLength=t._model._indicesLength,V.sqDistance=K.Pq.DistanceSquared(t.position,_)}if(t.alive&&(!t._stillInvisible||t.isVisible||this._recomputeInvisibles)){if(t.isVisible){t._stillInvisible=!1;const X=v[12];if(t.pivot.multiplyToRef(S,X),this.billboard&&(F.x=0,F.y=0),(this._computeParticleRotation||this.billboard)&&t.getRotationMatrix(k),null!==t.parentId){const V=this.getParticleById(t.parentId);if(V){const t=V._rotationMatrix,X=V._globalPosition,K=I.x*t[1]+I.y*t[4]+I.z*t[7],A=I.x*t[0]+I.y*t[3]+I.z*t[6],C=I.x*t[2]+I.y*t[5]+I.z*t[8];if(c.x=X.x+A,c.y=X.y+K,c.z=X.z+C,this._computeParticleRotation||this.billboard){const V=k.m;$[0]=V[0]*t[0]+V[1]*t[3]+V[2]*t[6],$[1]=V[0]*t[1]+V[1]*t[4]+V[2]*t[7],$[2]=V[0]*t[2]+V[1]*t[5]+V[2]*t[8],$[3]=V[4]*t[0]+V[5]*t[3]+V[6]*t[6],$[4]=V[4]*t[1]+V[5]*t[4]+V[6]*t[7],$[5]=V[4]*t[2]+V[5]*t[5]+V[6]*t[8],$[6]=V[8]*t[0]+V[9]*t[3]+V[10]*t[6],$[7]=V[8]*t[1]+V[9]*t[4]+V[10]*t[7],$[8]=V[8]*t[2]+V[9]*t[5]+V[10]*t[8]}}else t.parentId=null}else if(c.x=I.x,c.y=I.y,c.z=I.z,this._computeParticleRotation||this.billboard){const t=k.m;$[0]=t[0],$[1]=t[1],$[2]=t[2],$[3]=t[4],$[4]=t[5],$[5]=t[6],$[6]=t[8],$[7]=t[9],$[8]=t[10]}const K=v[11];for(t.translateFromPivot?K.setAll(0):K.copyFrom(X),x=0;x<V.length;x++){z=w+3*x,b=a+4*x,u=j+2*x;const k=2*x,I=k+1;L.copyFrom(V[x]),this._computeParticleColor&&t.color&&O.copyFrom(t.color),this._computeParticleTexture&&r.copyFromFloats(A[k],A[I]),this._computeParticleVertex&&this.updateParticleVertex(t,p,x);const C=L.x*S.x-X.x,n=L.y*S.y-X.y,F=L.z*S.z-X.z;let m=C*$[0]+n*$[3]+F*$[6],v=C*$[1]+n*$[4]+F*$[7],_=C*$[2]+n*$[5]+F*$[8];m+=K.x,v+=K.y,_+=K.z;const e=q[z]=c.x+W.x*m+Z.x*v+D.x*_,Y=q[z+1]=c.y+W.y*m+Z.y*v+D.y*_,H=q[z+2]=c.z+W.z*m+Z.z*v+D.z*_;if(this._computeBoundingBox&&(y.minimizeInPlaceFromFloats(e,Y,H),E.maximizeInPlaceFromFloats(e,Y,H)),!this._computeParticleVertex){const t=N[z],V=N[z+1],X=N[z+2],K=t*$[0]+V*$[3]+X*$[6],k=t*$[1]+V*$[4]+X*$[7],A=t*$[2]+V*$[5]+X*$[8];R[z]=W.x*K+Z.x*k+D.x*A,R[z+1]=W.y*K+Z.y*k+D.y*A,R[z+2]=W.z*K+Z.z*k+D.z*A}if(this._computeParticleColor&&t.color){const t=this._colors32;t[b]=O.r,t[b+1]=O.g,t[b+2]=O.b,t[b+3]=O.a}if(this._computeParticleTexture){const V=t.uvs;s[u]=r.x*(V.z-V.x)+V.x,s[u+1]=r.y*(V.w-V.y)+V.y}}}else for(t._stillInvisible=!0,x=0;x<V.length;x++){if(z=w+3*x,b=a+4*x,u=j+2*x,q[z]=q[z+1]=q[z+2]=0,R[z]=R[z+1]=R[z+2]=0,this._computeParticleColor&&t.color){const V=t.color;n[b]=V.r,n[b+1]=V.g,n[b+2]=V.b,n[b+3]=V.a}if(this._computeParticleTexture){const V=t.uvs;s[u]=A[2*x]*(V.z-V.x)+V.x,s[u+1]=A[2*x+1]*(V.w-V.y)+V.y}}if(this._particlesIntersect){const V=t.getBoundingInfo(),X=V.boundingBox,K=V.boundingSphere,k=t._modelBoundingInfo;if(!this._bSphereOnly){const t=k.boundingBox.vectors,V=v[1],K=v[2];V.setAll(Number.MAX_VALUE),K.setAll(-Number.MAX_VALUE);for(let X=0;X<8;X++){const k=t[X].x*S.x,A=t[X].y*S.y,C=t[X].z*S.z,n=k*$[0]+A*$[3]+C*$[6],q=k*$[1]+A*$[4]+C*$[7],R=k*$[2]+A*$[5]+C*$[8],F=I.x+W.x*n+Z.x*q+D.x*R,s=I.y+W.y*n+Z.y*q+D.y*R,c=I.z+W.z*n+Z.z*q+D.z*R;V.minimizeInPlaceFromFloats(F,s,c),K.maximizeInPlaceFromFloats(F,s,c)}X.reConstruct(V,K,C._worldMatrix)}const A=k.minimum.multiplyToRef(S,v[1]),n=k.maximum.multiplyToRef(S,v[2]),q=n.addToRef(A,v[3]).scaleInPlace(.5).addInPlace(c),R=n.subtractToRef(A,v[4]).scaleInPlace(.5*this._bSphereRadiusFactor),F=q.subtractToRef(R,v[1]),s=q.addToRef(R,v[2]);K.reConstruct(F,s,C._worldMatrix)}w=z+3,a=b+4,j=u+2}else x=V.length,w+=3*x,a+=4*x,j+=2*x}if(X){if(this._computeParticleColor){const t=C.getVertexBuffer(A.R.ColorKind);t&&!C.isPickable?t.updateDirectly(n,0):C.updateVerticesData(A.R.ColorKind,n,!1,!1)}if(this._computeParticleTexture){const t=C.getVertexBuffer(A.R.UVKind);t&&!C.isPickable?t.updateDirectly(s,0):C.updateVerticesData(A.R.UVKind,s,!1,!1)}const t=C.getVertexBuffer(A.R.PositionKind);if(t&&!C.isPickable?t.updateDirectly(q,0):C.updateVerticesData(A.R.PositionKind,q,!1,!1),!C.areNormalsFrozen||C.isFacetDataEnabled){if(this._computeParticleVertex||C.isFacetDataEnabled){const t=C.isFacetDataEnabled?C.getFacetDataParameters():null;$.P.ComputeNormals(q,S,R,t);for(let t=0;t<R.length;t++)N[t]=R[t]}if(!C.areNormalsFrozen){const t=C.getVertexBuffer(A.R.NormalKind);t&&!C.isPickable?t.updateDirectly(R,0):C.updateVerticesData(A.R.NormalKind,R,!1,!1)}}if(m){const t=this.depthSortedParticles;t.sort(this._depthSortFunction);const V=t.length;let X=0,K=0;for(let k=0;k<V;k++){const V=t[k],A=V.indicesLength,$=V.ind;for(let t=0;t<A;t++)if(S[X]=c[$+t],X++,this._pickable&&0==t%3){const t=this.pickedParticles[K];t.idx=V.idx,t.faceId=K,K++}}}if(this._autoFixFaceOrientation){let t=0;for(let V=0;V<this.particles.length;V++){const X=m?this.particles[this.depthSortedParticles[V].idx]:this.particles[V];if(X.scale.x*X.scale.y*X.scale.z<0)for(let V=0;V<X._model._indicesLength;V+=3){const K=c[X._ind+V];S[t+V]=c[X._ind+V+1],S[t+V+1]=K}t+=X._model._indicesLength}}(m||this._autoFixFaceOrientation)&&C.updateIndices(S)}return this._computeBoundingBox&&(C.hasBoundingInfo?C.getBoundingInfo().reConstruct(y,E,C._worldMatrix):C.buildBoundingInfo(y,E,C._worldMatrix)),this._autoUpdateSubMeshes&&this.computeSubMeshes(),this._recomputeInvisibles=!1,this.afterUpdateParticles(t,V,X),this}dispose(){this.mesh.dispose(),this.vars=null,this._positions=null,this._indices=null,this._normals=null,this._uvs=null,this._colors=null,this._indices32=null,this._positions32=null,this._normals32=null,this._fixedNormal32=null,this._uvs32=null,this._colors32=null,this.pickedParticles=null,this.pickedBySubMesh=null,this._materials=null,this._materialIndexes=null,this._indicesByMaterial=null,this._idxOfId=null}pickedParticle(t){if(t.hit){const V=t.subMeshId,X=t.faceId-this.mesh.subMeshes[V].indexStart/3,K=this.pickedBySubMesh;if(K[V]&&K[V][X])return K[V][X]}return null}getParticleById(t){const V=this.particles[t];if(V&&V.id==t)return V;const X=this.particles,K=this._idxOfId[t];if(void 0!==K)return X[K];let k=0;const A=this.nbParticles;for(;k<A;){const V=X[k];if(V.id==t)return V;k++}return null}getParticlesByShapeId(t){const V=[];return this.getParticlesByShapeIdToRef(t,V),V}getParticlesByShapeIdToRef(t,V){V.length=0;for(let X=0;X<this.nbParticles;X++){const K=this.particles[X];K.shapeId==t&&V.push(K)}return this}computeSubMeshes(){if(!this.mesh||!this._multimaterialEnabled)return this;const t=this.depthSortedParticles;if(this.particles.length>0)for(let V=0;V<this.particles.length;V++){const X=this.particles[V];X.materialIndex||(X.materialIndex=0);const K=t[V];K.materialIndex=X.materialIndex,K.ind=X._ind,K.indicesLength=X._model._indicesLength,K.idx=X.idx}this._sortParticlesByMaterial();const V=this._indicesByMaterial,X=this._materialIndexes,K=this.mesh;K.subMeshes=[];const k=K.getTotalVertices();for(let t=0;t<X.length;t++){const A=V[t],$=V[t+1]-A,I=X[t];new s.K(I,0,k,A,$,K)}return this}_sortParticlesByMaterial(){const t=[0];this._indicesByMaterial=t;const V=[];this._materialIndexes=V;const X=this.depthSortedParticles;X.sort(this._materialSortFunction);const K=X.length,k=this._indices32,A=this._indices;let $=0,I=0,C=0,n=X[0].materialIndex;V.push(n),this._pickable&&(this.pickedBySubMesh=[[]],this.pickedParticles=this.pickedBySubMesh[0]);for(let q=0;q<K;q++){const K=X[q],R=K.indicesLength,F=K.ind;K.materialIndex!==n&&(n=K.materialIndex,t.push(C),V.push(n),this._pickable&&($++,this.pickedBySubMesh[$]=[],I=0));let s=0;for(let t=0;t<R;t++){if(k[C]=A[F+t],this._pickable&&0==t%3){const t=this.pickedBySubMesh[$][I];t?(t.idx=K.idx,t.faceId=s):this.pickedBySubMesh[$][I]={idx:K.idx,faceId:s},I++,s++}C++}}return t.push(k.length),this._updatable&&this.mesh.updateIndices(k),this}_setMaterialIndexesById(){this._materialIndexesById={};for(let t=0;t<this._materials.length;t++){const V=this._materials[t].uniqueId;this._materialIndexesById[V]=t}}_filterUniqueMaterialId(t){return t.filter((function(t,V,X){return X.indexOf(t)===V}))}_setDefaultMaterial(){return this._defaultMaterial||(this._defaultMaterial=new S.F(this.name+"DefaultMaterial",this._scene)),this._defaultMaterial}refreshVisibleSize(){return this._isVisibilityBoxLocked||this.mesh.refreshBoundingInfo(),this}setVisibilityBox(t){const V=t/2;this.mesh.buildBoundingInfo(new K.Pq(-V,-V,-V),new K.Pq(V,V,V))}get isAlwaysVisible(){return this._alwaysVisible}set isAlwaysVisible(t){this._alwaysVisible=t,this.mesh.alwaysSelectAsActiveMesh=t}set isVisibilityBoxLocked(t){this._isVisibilityBoxLocked=t,this.mesh.getBoundingInfo().isLocked=t}get isVisibilityBoxLocked(){return this._isVisibilityBoxLocked}set computeParticleRotation(t){this._computeParticleRotation=t}set computeParticleColor(t){this._computeParticleColor=t}set computeParticleTexture(t){this._computeParticleTexture=t}set computeParticleVertex(t){this._computeParticleVertex=t}set computeBoundingBox(t){this._computeBoundingBox=t}set depthSortParticles(t){this._depthSortParticles=t}get computeParticleRotation(){return this._computeParticleRotation}get computeParticleColor(){return this._computeParticleColor}get computeParticleTexture(){return this._computeParticleTexture}get computeParticleVertex(){return this._computeParticleVertex}get computeBoundingBox(){return this._computeBoundingBox}get depthSortParticles(){return this._depthSortParticles}get expandable(){return this._expandable}get multimaterialEnabled(){return this._multimaterialEnabled}get useModelMaterial(){return this._useModelMaterial}get materials(){return this._materials}setMultiMaterial(t){this._materials=this._filterUniqueMaterialId(t),this._setMaterialIndexesById(),this._multimaterial&&this._multimaterial.dispose(),this._multimaterial=new c.F(this.name+"MultiMaterial",this._scene);for(let t=0;t<this._materials.length;t++)this._multimaterial.subMaterials.push(this._materials[t]);this.computeSubMeshes(),this.mesh.material=this._multimaterial}get multimaterial(){return this._multimaterial}set multimaterial(t){this._multimaterial=t}get autoUpdateSubMeshes(){return this._autoUpdateSubMeshes}set autoUpdateSubMeshes(t){this._autoUpdateSubMeshes=t}initParticles(){}recycleParticle(t){return t}updateParticle(t){return t}updateParticleVertex(t,V,X){return this}beforeUpdateParticles(t,V,X){}afterUpdateParticles(t,V,X){}}},466281:(t,V,X)=>{X.d(V,{R:()=>K,z:()=>I});var K,k=X(604910),A=X(554014),$=X(310035);(function(t){t[t["ATTACHED"]=0]="ATTACHED",t[t["END"]=1]="END"})(K||(K={}));class I{constructor(t){if(this.particleSystem=t,this.type=1,this.inheritDirection=!1,this.inheritedVelocityAmount=0,!t.emitter||!t.emitter.dispose){const V=$.n9("BABYLON.AbstractMesh");t.emitter=new V("SubemitterSystemEmitter",t.getScene()),t._disposeEmitterOnDispose=!0}}clone(){let t=this.particleSystem.emitter;t?t instanceof k.Pq?t=t.clone():-1!==t.getClassName().indexOf("Mesh")&&(t=new($.n9("BABYLON.Mesh"))("",t.getScene()),t.isVisible=!1):t=new k.Pq;const V=new I(this.particleSystem.clone(this.particleSystem.name,t));return V.particleSystem.name+="Clone",V.type=this.type,V.inheritDirection=this.inheritDirection,V.inheritedVelocityAmount=this.inheritedVelocityAmount,V.particleSystem._disposeEmitterOnDispose=!0,V.particleSystem.disposeOnStop=!0,V}serialize(t=!1){const V={};return V.type=this.type,V.inheritDirection=this.inheritDirection,V.inheritedVelocityAmount=this.inheritedVelocityAmount,V.particleSystem=this.particleSystem.serialize(t),V}static _ParseParticleSystem(t,V,X,K=!1){throw A.n("ParseParticle")}static Parse(t,V,X){const K=t.particleSystem,k=new I(I._ParseParticleSystem(K,V,X,!0));return k.type=t.type,k.inheritDirection=t.inheritDirection,k.inheritedVelocityAmount=t.inheritedVelocityAmount,k.particleSystem._isSubEmitter=!0,k}dispose(){this.particleSystem.dispose()}}}},C={};function n(t){var V=C[t];if(void 0!==V)return V.exports;var X=C[t]={id:t,loaded:!1,exports:{}};return I[t].call(X.exports,X,X.exports,n),X.loaded=!0,X.exports}n.m=I,t=[],n.O=(V,X,K,k)=>{if(!X){var A=1/0;for(q=0;q<t.length;q++){for(var[X,K,k]=t[q],$=!0,I=0;I<X.length;I++)(!1&k||A>=k)&&Object.keys(n.O).every((t=>n.O[t](X[I])))?X.splice(I--,1):($=!1,k<A&&(A=k));if($){t.splice(q--,1);var C=K();void 0!==C&&(V=C)}}return V}k=k||0;for(var q=t.length;q>0&&t[q-1][2]>k;q--)t[q]=t[q-1];t[q]=[X,K,k]},n.n=t=>{var V=t&&t.__esModule?()=>t["default"]:()=>t;return n.d(V,{a:V}),V},X=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,n.t=function(t,K){if(1&K&&(t=this(t)),8&K)return t;if("object"==typeof t&&t){if(4&K&&t.__esModule)return t;if(16&K&&"function"==typeof t.then)return t}var k=Object.create(null);n.r(k);var A={};V=V||[null,X({}),X([]),X(X)];for(var $=2&K&&t;"object"==typeof $&&!~V.indexOf($);$=X($))Object.getOwnPropertyNames($).forEach((V=>A[V]=()=>t[V]));return A["default"]=()=>t,n.d(k,A),k},n.d=(t,V)=>{for(var X in V)n.o(V,X)&&!n.o(t,X)&&Object.defineProperty(t,X,{enumerable:!0,get:V[X]})},n.f={},n.e=t=>Promise.all(Object.keys(n.f).reduce(((V,X)=>(n.f[X](t,V),V)),[])),n.u=t=>"js/"+({3474:"evo-promotions.SpinGiftsFrame",3863:"testTools",17474:"evo-game.mobileChat",22421:"testTools.PixiDevToolsPlugin",24622:"evo-promotions.SpinGiftsWheelAnimation",26203:"baccaratDevToolsPanels",30164:"game-client-history-round-info",31424:"debug.babylonjs_017397ff",36302:"evo-promotions.SpinGiftsCampaignRules",39340:"history.roundView",44806:"gameTestToolsPlugins",47290:"evo-promotions.SpinGiftsTermsConditions",50967:"help.common",54504:"evo-promotions.cashGifts",58676:"debug.babylonjs_34e3da0c",59760:"evo-game.chat",66703:"gameTestToolsSafeAreaPlugin",66885:"native-utilities",73375:"evo-promotions.spinGifts",73460:"evo-promotions.giftsWheel",77821:"evo-game.emojiMenu",80616:"video-lib-local",82668:"debug.babylonjs_09167c63",85687:"testTools.why-did-you-render",94003:"debug.BJSToolsPlugin",97471:"help.rng-baccarat"}[t]||t)+"."+{1773:"53c9260f",3474:"1a89cdcf",3863:"c68406f1",5310:"a4eb3e49",7075:"5fafa4e8",8873:"370c17c7",10036:"49f00cff",10228:"2c4ae3c0",10306:"a97cff13",10548:"6f0b477e",11187:"710afa56",11300:"ba52e1b8",12235:"5fddbd18",14291:"2f77c6ae",14855:"512ae6f6",17474:"36703dd7",18674:"df2a9114",18680:"f9a60ee2",21676:"2f4b82d7",22421:"0fea869a",23998:"0da5bd06",24622:"c19aa584",26089:"76d45190",26203:"322bb3e7",27171:"d86d5013",27672:"21b8bdb0",28276:"b062ce9d",29251:"9be939bb",30164:"81c32c92",31424:"d7a83342",32184:"a21bca64",34087:"56cede08",35214:"3cb54832",35391:"862bf95f",36302:"63c3f631",37109:"8ef0b131",37927:"b03e4e3d",38337:"c0bd3b5b",38410:"a6cb3863",38470:"8ee2f365",39340:"87393490",39920:"0952ac21",40310:"9ec0fe1d",42447:"0fe47cec",43102:"dce9a787",44639:"689fa1f7",44806:"0741de9d",44830:"ad207c2b",45444:"ef538133",47290:"25d266d1",47687:"296c8d07",49620:"eeee5d15",49920:"321c7b92",50883:"5b6a2dad",50967:"2b6414a9",51871:"e5213593",53273:"2378b42b",53566:"6c66d06a",54504:"de8d33cf",56926:"449679f9",57151:"9ab72021",57758:"294d08bd",58047:"bdb2d050",58610:"0ff55608",58676:"6d987e3a",59603:"a0e07762",59760:"c5c3f75e",60079:"528459c9",61681:"5b09874a",66691:"4564fa54",66703:"d22f8b42",66885:"cf7c7b01",67412:"62e79ea2",70254:"3433eb69",70775:"9dfc379c",71635:"a805e905",72923:"a34d72a9",73375:"74edf8f6",73460:"b312a388",74706:"920d2620",76488:"e1d1ceb4",77821:"cadc9005",80616:"10095eb7",82668:"8135b629",82689:"8ce7f80b",85604:"f066c607",85687:"8dab9d33",87821:"adc26c11",87843:"cfff40b7",88918:"ffb24211",92838:"9df31eff",94003:"8b9bf97f",96838:"b7583272",97471:"14f24d33",98180:"59d717d2",99697:"83fb1ab8"}[t]+".js",n.miniCssF=t=>3863===t?"styles/testtools.c68406f1.css":36302===t?"styles/evopromoti.spingiftsc.63c3f631.css":47290===t?"styles/evopromoti.spingiftst.25d266d1.css":50967===t?"styles/help.common.2b6414a9.css":30164===t?"styles/gameclient.81c32c92.css":39340===t?"styles/history.roundview.87393490.css":17474===t?"styles/evogame.mobilechat.36703dd7.css":59760===t?"styles/evogame.chat.c5c3f75e.css":54504===t?"styles/evopromoti.cashgifts.de8d33cf.css":73375===t?"styles/evopromoti.spingifts.74edf8f6.css":77821===t?"styles/evogame.emojimenu.cadc9005.css":44806===t?"styles/gametestto.0741de9d.css":94003===t?"styles/debug.bjstoolspl.8b9bf97f.css":97471===t?"styles/help.rngbaccara.14f24d33.css":26203===t?"styles/baccaratde.322bb3e7.css":73460===t?"styles/evopromoti.giftswheel.b312a388.css":24622===t?"styles/evopromoti.spingiftsw.c19aa584.css":3474===t?"styles/evopromoti.spingiftsf.1a89cdcf.css":22421===t?"styles/testtools.pixidevtoo.0fea869a.css":66703===t?"styles/gametestto.d22f8b42.css":82446===t?"styles/debug.babylonjsa.6204a96e.css":void 0,n.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),n.o=(t,V)=>Object.prototype.hasOwnProperty.call(t,V),K={},k="/frontend/evo/r2/:",n.l=(t,V,X,A)=>{if(K[t])K[t].push(V);else{var $,I;if(void 0!==X)for(var C=document.getElementsByTagName("script"),q=0;q<C.length;q++){var R=C[q];if(R.getAttribute("src")==t||R.getAttribute("data-webpack")==k+X){$=R;break}}$||(I=!0,($=document.createElement("script")).charset="utf-8",$.timeout=NaN,n.nc&&$.setAttribute("nonce",n.nc),$.setAttribute("data-webpack",k+X),$.src=t),K[t]=[V];var F=(V,X)=>{$.onerror=$.onload=null,clearTimeout(s);var k=K[t];if(delete K[t],$.parentNode&&$.parentNode.removeChild($),k&&k.forEach((t=>t(X))),V)return V(X)},s=setTimeout(F.bind(null,void 0,{type:"timeout",target:$}),window.EVO_CDN?15e3:6e4);$.onerror=F.bind(null,$.onerror),$.onload=F.bind(null,$.onload),I&&document.head.appendChild($)}},n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),n.j=83188,n.p=(globalThis.EVO_CDN||"")+"/frontend/evo/r2/",A=t=>new Promise(((V,X)=>{var K=n.miniCssF(t),k=n.p+K;if(((t,V)=>{for(var X=document.getElementsByTagName("link"),K=0;K<X.length;K++){var k=($=X[K]).getAttribute("data-href")||$.getAttribute("href");if("stylesheet"===$.rel&&(k===t||k===V))return $}var A=document.getElementsByTagName("style");for(K=0;K<A.length;K++){var $;if((k=($=A[K]).getAttribute("data-href"))===t||k===V)return $}})(K,k))return V();((t,V,X,K)=>{var k=document.createElement("link");k.setAttribute("data-sandbox","ignore"),k.rel="stylesheet",k.type="text/css",k.onerror=k.onload=A=>{if(k.onerror=k.onload=null,"load"===A.type)X();else{var $=A&&("load"===A.type?"missing":A.type),I=A&&A.target&&A.target.href||V,C=new Error("Loading CSS chunk "+t+" failed.\n("+I+")");C.code="CSS_CHUNK_LOAD_FAILED",C.type=$,C.request=I,k.parentNode.removeChild(k),K(C)}},k.href=V,document.head.appendChild(k)})(t,k,V,X)})),$={83188:0},n.f.miniCss=(t,V)=>{$[t]?V.push($[t]):0!==$[t]&&{3474:1,3863:1,17474:1,22421:1,24622:1,26203:1,30164:1,36302:1,39340:1,44806:1,47290:1,50967:1,54504:1,59760:1,66703:1,73375:1,73460:1,77821:1,82446:1,94003:1,97471:1}[t]&&V.push($[t]=A(t).then((()=>{$[t]=0}),(V=>{throw delete $[t],V})))},(()=>{var t={83188:0};n.f.j=(V,X)=>{var K=n.o(t,V)?t[V]:void 0;if(0!==K)if(K)X.push(K[2]);else if(82446!=V){var k=new Promise(((X,k)=>K=t[V]=[X,k]));X.push(K[2]=k);var A=n.p+n.u(V),$=new Error;n.l(A,(X=>{if(n.o(t,V)&&(0!==(K=t[V])&&(t[V]=void 0),K)){var k=X&&("load"===X.type?"missing":X.type),A=X&&X.target&&X.target.src;$.message="Loading chunk "+V+" failed.\n("+k+": "+A+")",$.name="ChunkLoadError",$.type=k,$.request=A,K[1]($)}}),"chunk-"+V,V)}else t[V]=0},n.O.j=V=>0===t[V];var V=(V,X)=>{var K,k,[A,$,I]=X,C=0;if(A.some((V=>0!==t[V]))){for(K in $)n.o($,K)&&(n.m[K]=$[K]);if(I)var q=I(n)}for(V&&V(X);C<A.length;C++)k=A[C],n.o(t,k)&&t[k]&&t[k][0](),t[k]=0;return n.O(q)},X=self["webpackChunk_frontend_evo_r2_"]=self["webpackChunk_frontend_evo_r2_"]||[];X.forEach(V.bind(null,0)),X.push=V.bind(null,X.push.bind(X))})(),n.O(void 0,[35375,79949,86448],(()=>n(515924)));var q=n.O(void 0,[35375,79949,86448],(()=>n(403562)));q=n.O(q)})();
//# sourceMappingURL=https://sourcemaps.egcdn.com/frontend/evo/r2/js/rngbaccara.goldenweal.5ea80087.js.map